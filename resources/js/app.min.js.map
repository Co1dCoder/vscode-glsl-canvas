{"version":3,"sources":["resources/js/app.js"],"names":["Vector","x","y","z","this","prototype","negative","add","v","subtract","multiply","divide","equals","dot","cross","length","Math","sqrt","unit","min","max","toAngles","theta","atan2","phi","asin","angleTo","a","acos","toArray","n","slice","clone","init","b","c","fromAngles","cos","sin","randomDirection","random","PI","lerp","fraction","fromArray","angleBetween","window","CameraService","radius","service","RAD","down","mouse","move","up","wheel","d","render","glsl","vector","toVector","array","Float32Array","update","method","type","name","value","u","uniforms","location","gl","getUniformLocation","program","apply","concat","e","console","log","fromVector","atan","camera","spr","CaptureService","set","canvas","record","MediaRecorder","captureStream","capture","chunks","stream","options","mimeType","recorder","ondataavailable","data","size","push","resolve","blob","Blob","getTracks","forEach","track","stop","removeTrack","extension","start","promise","Promise","reject","snapshot","queue","snapshotRender","url","toDataURL","bytes","atob","buffer","Uint8Array","i","charCodeAt","Parser","tuple","tuples","2","3","4","keys","r","filter","enumerate","prefix","getter","key","obj","p","Array","isArray","undefined","get","Object","map","GuiService","callback","closed","hidden","pool","differs","JSON","stringify","copy","parse","merge","_merge","hasOwnProperty","loop","params","onChange","folder","addFolder","randomize","_randomize","__controllers","initialValue","__min","__max","property","updateDisplay","f","__folders","load","gui","locals","changed","destroy","dat","GUI","hide","show","_callback","domElement","style","display","TrailsService","history","trails","fill","t","tx","friction","shift","_push","func","wait","context","args","result","timeout","previous","later","leading","getNow","now","remaining","arguments","clearTimeout","trailing","setTimeout","Date","getTime","onLoad","onUpdateUniforms","setUniforms","document","querySelector","setAttribute","uri","o","vertex","trim","fragment","removeStats","textures","uniformTexture","filtering","repeat","resize","w","content","offsetWidth","h","offsetHeight","width","height","forceRender","then","video","URL","createObjectURL","link","createElement","href","download","click","revokeObjectURL","output","togglePause","flags","pause","paused","timePause","timePrev","timeLoad","play","buttons","toggleRecord","toggleStats","statsTick","stats","requestAnimationFrame","statsdom","visibility","Stats","showPanel","dom","body","appendChild","createShader","parent","postMessage","command","onMessage","event","onResize","ri","onDown","onMove","onUp","onWheel","wheelDelta","abs","create","toggle","GlslCanvas","premultipliedAlpha","preserveDrawingBuffer","backgroundColor","on","onGlslError","addEventListener","message","errors","warnings","error","replace","m","l","li","encodeURI","Number","join","innerHTML"],"mappings":"CAAC,WACG,YAEA,IAAIA,GAAS,WAET,QAASA,GAAOC,EAAGC,EAAGC,GAClBC,KAAKH,EAAIA,GAAK,EACdG,KAAKF,EAAIA,GAAK,EACdE,KAAKD,EAAIA,GAAK,EAsKlB,MAhKAH,GAAOK,WACHC,SAAU,WACN,MAAO,IAAIN,IAAQI,KAAKH,GAAIG,KAAKF,GAAIE,KAAKD,IAE9CI,IAAK,SAAUC,GACX,MAAIA,aAAaR,GAAe,GAAIA,GAAOI,KAAKH,EAAIO,EAAEP,EAAGG,KAAKF,EAAIM,EAAEN,EAAGE,KAAKD,EAAIK,EAAEL,GACtE,GAAIH,GAAOI,KAAKH,EAAIO,EAAGJ,KAAKF,EAAIM,EAAGJ,KAAKD,EAAIK,IAE5DC,SAAU,SAAUD,GAChB,MAAIA,aAAaR,GAAe,GAAIA,GAAOI,KAAKH,EAAIO,EAAEP,EAAGG,KAAKF,EAAIM,EAAEN,EAAGE,KAAKD,EAAIK,EAAEL,GACtE,GAAIH,GAAOI,KAAKH,EAAIO,EAAGJ,KAAKF,EAAIM,EAAGJ,KAAKD,EAAIK,IAE5DE,SAAU,SAAUF,GAChB,MAAIA,aAAaR,GAAe,GAAIA,GAAOI,KAAKH,EAAIO,EAAEP,EAAGG,KAAKF,EAAIM,EAAEN,EAAGE,KAAKD,EAAIK,EAAEL,GACtE,GAAIH,GAAOI,KAAKH,EAAIO,EAAGJ,KAAKF,EAAIM,EAAGJ,KAAKD,EAAIK,IAE5DG,OAAQ,SAAUH,GACd,MAAIA,aAAaR,GAAe,GAAIA,GAAOI,KAAKH,EAAIO,EAAEP,EAAGG,KAAKF,EAAIM,EAAEN,EAAGE,KAAKD,EAAIK,EAAEL,GACtE,GAAIH,GAAOI,KAAKH,EAAIO,EAAGJ,KAAKF,EAAIM,EAAGJ,KAAKD,EAAIK,IAE5DI,OAAQ,SAAUJ,GACd,MAAOJ,MAAKH,IAAMO,EAAEP,GAAKG,KAAKF,IAAMM,EAAEN,GAAKE,KAAKD,IAAMK,EAAEL,GAE5DU,IAAK,SAAUL,GACX,MAAOJ,MAAKH,EAAIO,EAAEP,EAAIG,KAAKF,EAAIM,EAAEN,EAAIE,KAAKD,EAAIK,EAAEL,GAEpDW,MAAO,SAAUN,GACb,MAAO,IAAIR,GACPI,KAAKF,EAAIM,EAAEL,EAAIC,KAAKD,EAAIK,EAAEN,EAC1BE,KAAKD,EAAIK,EAAEP,EAAIG,KAAKH,EAAIO,EAAEL,EAC1BC,KAAKH,EAAIO,EAAEN,EAAIE,KAAKF,EAAIM,EAAEP,IAGlCc,OAAQ,WACJ,MAAOC,MAAKC,KAAKb,KAAKS,IAAIT,QAE9Bc,KAAM,WACF,MAAOd,MAAKO,OAAOP,KAAKW,WAE5BI,IAAK,WACD,MAAOH,MAAKG,IAAIH,KAAKG,IAAIf,KAAKH,EAAGG,KAAKF,GAAIE,KAAKD,IAEnDiB,IAAK,WACD,MAAOJ,MAAKI,IAAIJ,KAAKI,IAAIhB,KAAKH,EAAGG,KAAKF,GAAIE,KAAKD,IAEnDkB,SAAU,WACN,OACIC,MAAON,KAAKO,MAAMnB,KAAKD,EAAGC,KAAKH,GAC/BuB,IAAKR,KAAKS,KAAKrB,KAAKF,EAAIE,KAAKW,YAGrCW,QAAS,SAAUC,GACf,MAAOX,MAAKY,KAAKxB,KAAKS,IAAIc,IAAMvB,KAAKW,SAAWY,EAAEZ,YAEtDc,QAAS,SAAUC,GACf,OAAQ1B,KAAKH,EAAGG,KAAKF,EAAGE,KAAKD,GAAG4B,MAAM,EAAGD,GAAK,IAElDE,MAAO,WACH,MAAO,IAAIhC,GAAOI,KAAKH,EAAGG,KAAKF,EAAGE,KAAKD,IAE3C8B,KAAM,SAAUhC,EAAGC,EAAGC,GAIlB,MAHAC,MAAKH,EAAIA,EACTG,KAAKF,EAAIA,EACTE,KAAKD,EAAIA,EACFC,OAOfJ,EAAOM,SAAW,SAAUqB,EAAGO,GAI3B,MAHAA,GAAEjC,GAAK0B,EAAE1B,EACTiC,EAAEhC,GAAKyB,EAAEzB,EACTgC,EAAE/B,GAAKwB,EAAExB,EACF+B,GAEXlC,EAAOO,IAAM,SAAUoB,EAAGO,EAAGC,GAUzB,MATID,aAAalC,IACbmC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EAAEjC,EACdkC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EAAEhC,EACdiC,EAAEhC,EAAIwB,EAAExB,EAAI+B,EAAE/B,IAEdgC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EACZC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EACZC,EAAEhC,EAAIwB,EAAExB,EAAI+B,GAETC,GAEXnC,EAAOS,SAAW,SAAUkB,EAAGO,EAAGC,GAU9B,MATID,aAAalC,IACbmC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EAAEjC,EACdkC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EAAEhC,EACdiC,EAAEhC,EAAIwB,EAAExB,EAAI+B,EAAE/B,IAEdgC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EACZC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EACZC,EAAEhC,EAAIwB,EAAExB,EAAI+B,GAETC,GAEXnC,EAAOU,SAAW,SAAUiB,EAAGO,EAAGC,GAU9B,MATID,aAAalC,IACbmC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EAAEjC,EACdkC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EAAEhC,EACdiC,EAAEhC,EAAIwB,EAAExB,EAAI+B,EAAE/B,IAEdgC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EACZC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EACZC,EAAEhC,EAAIwB,EAAExB,EAAI+B,GAETC,GAEXnC,EAAOW,OAAS,SAAUgB,EAAGO,EAAGC,GAU5B,MATID,aAAalC,IACbmC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EAAEjC,EACdkC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EAAEhC,EACdiC,EAAEhC,EAAIwB,EAAExB,EAAI+B,EAAE/B,IAEdgC,EAAElC,EAAI0B,EAAE1B,EAAIiC,EACZC,EAAEjC,EAAIyB,EAAEzB,EAAIgC,EACZC,EAAEhC,EAAIwB,EAAExB,EAAI+B,GAETC,GAEXnC,EAAOc,MAAQ,SAAUa,EAAGO,EAAGC,GAI3B,MAHAA,GAAElC,EAAI0B,EAAEzB,EAAIgC,EAAE/B,EAAIwB,EAAExB,EAAI+B,EAAEhC,EAC1BiC,EAAEjC,EAAIyB,EAAExB,EAAI+B,EAAEjC,EAAI0B,EAAE1B,EAAIiC,EAAE/B,EAC1BgC,EAAEhC,EAAIwB,EAAE1B,EAAIiC,EAAEhC,EAAIyB,EAAEzB,EAAIgC,EAAEjC,EACnBkC,GAEXnC,EAAOkB,KAAO,SAAUS,EAAGO,GACvB,GAAInB,GAASY,EAAEZ,QAIf,OAHAmB,GAAEjC,EAAI0B,EAAE1B,EAAIc,EACZmB,EAAEhC,EAAIyB,EAAEzB,EAAIa,EACZmB,EAAE/B,EAAIwB,EAAExB,EAAIY,EACLmB,GAEXlC,EAAOoC,WAAa,SAAUd,EAAOE,GACjC,MAAO,IAAIxB,GAAOgB,KAAKqB,IAAIf,GAASN,KAAKqB,IAAIb,GAAMR,KAAKsB,IAAId,GAAMR,KAAKsB,IAAIhB,GAASN,KAAKqB,IAAIb,KAEjGxB,EAAOuC,gBAAkB,WACrB,MAAOvC,GAAOoC,WAAWpB,KAAKwB,SAAWxB,KAAKyB,GAAK,EAAGzB,KAAKS,KAAqB,EAAhBT,KAAKwB,SAAe,KAExFxC,EAAOmB,IAAM,SAAUQ,EAAGO,GACtB,MAAO,IAAIlC,GAAOgB,KAAKG,IAAIQ,EAAE1B,EAAGiC,EAAEjC,GAAIe,KAAKG,IAAIQ,EAAEzB,EAAGgC,EAAEhC,GAAIc,KAAKG,IAAIQ,EAAExB,EAAG+B,EAAE/B,KAE9EH,EAAOoB,IAAM,SAAUO,EAAGO,GACtB,MAAO,IAAIlC,GAAOgB,KAAKI,IAAIO,EAAE1B,EAAGiC,EAAEjC,GAAIe,KAAKI,IAAIO,EAAEzB,EAAGgC,EAAEhC,GAAIc,KAAKI,IAAIO,EAAExB,EAAG+B,EAAE/B,KAE9EH,EAAO0C,KAAO,SAAUf,EAAGO,EAAGS,GAC1B,MAAOT,GAAEzB,SAASkB,GAAGjB,SAASiC,GAAUpC,IAAIoB,IAEhD3B,EAAO4C,UAAY,SAAUjB,GACzB,MAAO,IAAI3B,GAAO2B,EAAE,GAAIA,EAAE,GAAIA,EAAE,KAEpC3B,EAAO6C,aAAe,SAAUlB,EAAGO,GAC/B,MAAOP,GAAED,QAAQQ,IAGdlC,IAGX8C,QAAO9C,OAASA,KAKnB,WACG,YAEA,IAAI+C,GAAgB,WAKhB,QAASA,GAAczB,EAAOE,EAAKwB,GAC/B,GAAIC,GAAU7C,IACd6C,GAAQ3B,OAASA,GAAS,IAAM4B,EAChCD,EAAQzB,KAAOA,GAAO,IAAM0B,EAC5BD,EAAQD,OAASA,GAAU,EAiB/B,QAASG,GAAKlD,EAAGC,GACCE,KACNgD,OACJnD,EAAGA,EACHC,EAAGA,GAIX,QAASmD,GAAKpD,EAAGC,GACb,GAAI+C,GAAU7C,KACVgD,EAAQH,EAAQG,KACpB,IAAIA,EAAO,CACP,GAAI9B,GAAwB,KAAfrB,EAAImD,EAAMnD,GAAWiD,EAC9B1B,EAAsB,KAAf4B,EAAMlD,EAAIA,GAAWgD,CAChCE,GAAMnD,EAAIA,EACVmD,EAAMlD,EAAIA,EACV+C,EAAQ3B,OAASA,EACjB2B,EAAQzB,KAAOA,GAIvB,QAAS8B,GAAGrD,EAAGC,GACGE,KACNgD,MAAQ,KAGpB,QAASG,GAAMC,GACX,GAAIP,GAAU7C,IACd6C,GAAQD,OAAShC,KAAKI,IAAI,IAAM6B,EAAQD,OAAa,IAAJQ,GAGrD,QAASC,GAAOC,GACZ,GAAIT,GAAU7C,KACVuD,EAASZ,EAAca,SAASX,GAChCY,EAAQ,GAAIC,eAAcH,EAAO1D,EAAG0D,EAAOzD,EAAGyD,EAAOxD,GACzD8C,GAAQc,OAAOL,EAAM,MAAO,OAAQ,WAAYG,GAGpD,QAASE,GAAOL,EAAMM,EAAQC,EAAMC,EAAMC,GACtC,IACI,GAAIC,GAAIV,EAAKW,SAASH,GAAQR,EAAKW,SAASH,MAC5CE,GAAEF,KAAOA,EACTE,EAAED,MAAQA,EACVC,EAAEH,KAAOA,EACTG,EAAEJ,OAAS,UAAYA,EACvBI,EAAEE,SAAWZ,EAAKa,GAAGC,mBAAmBd,EAAKe,QAASP,GACtDR,EAAKa,GAAGH,EAAEJ,QAAQU,MAAMhB,EAAKa,IAAKH,EAAEE,UAAUK,OAAOP,EAAED,QACzD,MAAOS,GACLC,QAAQC,IAAI,aAAcF,IAMlC,QAASG,GAAWpB,GAChB,GAAIX,GAASW,EAAO5C,QAGpB,OAAO,IAAIgC,GAFC/B,KAAKY,KAAK+B,EAAOzD,EAAI8C,GACvBhC,KAAKgE,KAAKrB,EAAO1D,EAAI0D,EAAOxD,GACD6C,GAGzC,QAASY,GAASqB,GACd,GAAIC,GAAMlE,KAAKsB,IAAI2C,EAAOzD,KAAOyD,EAAOjC,OACpC/C,EAAIiF,EAAMlE,KAAKsB,IAAI2C,EAAO3D,OAC1BpB,EAAIc,KAAKqB,IAAI4C,EAAOzD,KAAOyD,EAAOjC,OAClC7C,EAAI+E,EAAMlE,KAAKqB,IAAI4C,EAAO3D,MAC9B,OAAO,IAAItB,QAAOC,EAAGC,EAAGC,GA1F5B,GAAIsC,GAAKzB,KAAKyB,GACVS,EAAMT,EAAK,GA4Ff,OAnFAM,GAAc1C,WACV8C,KAAMA,EACNE,KAAMA,EACNC,GAAIA,EACJC,MAAOA,EACPE,OAAQA,EACRM,OAAQA,GAGZhB,EAAcgC,WAAaA,EAC3BhC,EAAca,SAAWA,EAyElBb,IAIXD,QAAOC,cAAgBA,KAS1B,WACG,YAEA,SAASoC,MAUT,QAASC,GAAIC,GACKjF,KACNiF,OAASA,EAsBrB,QAASC,KACL,GAAIrC,GAAU7C,IACd,IAAoC,kBAAzB0C,QAAOyC,gBAAiCtC,EAAQoC,QAAkD,kBAAjCpC,GAAQoC,OAAOG,cAEvF,MADAX,SAAQC,IAAI,kGACL,CACJ,IAAI7B,EAAQwC,QAEf,MADAZ,SAAQC,IAAI,iFACL,CAEX,KACI,GAAIW,MACAC,KACAC,EAAS1C,EAAQoC,OAAOG,gBACxBI,GACAC,SAAU,cAEVC,EAAW,GAAIP,eAAcI,EAAQC,EACzCE,GAASC,gBAAkB,SAAUnB,GAKjC,GAJIA,EAAEoB,KAAKC,KAAO,GACdP,EAAOQ,KAAKtB,EAAEoB,MAGdP,EAAQU,QAAS,CACjB,GAAIC,GAAO,GAAIC,MAAKX,GAChBzB,KAAM2B,EAAQC,UAElB,IAAIF,EAAQ,EACKA,EAAOW,iBACbC,QAAQ,SAAUC,GACrBA,EAAMC,OACNd,EAAOe,YAAYF,KAG3Bb,EAAS,KACT1C,EAAQ6C,SAAW,KACnB7C,EAAQwC,QAAU,KAClBA,EAAQU,SACJC,KAAMA,EACNO,UAAW,YAIvB1D,EAAQwC,QAAUA,EAClBxC,EAAQ6C,SAAWA,EACnBA,EAASc,QACX,MAAOhC,GAIL,MAHA3B,GAAQwC,QAAU,KAClBxC,EAAQ6C,SAAW,KACnBjB,QAAQC,IAAI,oCAAqCF,IAC1C,EAEX,OAAO,EAGX,QAAS6B,KACL,GAAIxD,GAAU7C,IACd,OAAK6C,GAAQwC,SAIbxC,EAAQwC,QAAQoB,QAAU,GAAIC,SAAQ,SAAUX,EAASY,GACrD9D,EAAQwC,QAAQU,QAAUA,EAC1BlD,EAAQwC,QAAQsB,OAASA,IAE7B9D,EAAQ6C,SAASW,OACVxD,EAAQwC,QAAQoB,UARnBhC,QAAQC,IAAI,kFACLgC,QAAQX,aAUvB,QAASa,KACL,GAAI/D,GAAU7C,IACd,OAAI6C,GAAQgE,MACDhE,EAAQgE,MAAMJ,SAEzB5D,EAAQgE,SACRhE,EAAQgE,MAAMJ,QAAU,GAAIC,SAAQ,SAAUX,EAASY,GACnD9D,EAAQgE,MAAMd,QAAUA,EACxBlD,EAAQgE,MAAMF,OAASA,IAEpB9D,EAAQgE,MAAMJ,SAGzB,QAASK,KACL,GAAIjE,GAAU7C,IACd,IAAI6C,EAAQgE,MAAO,CAOf,IAAK,GAHDE,GAAMlE,EAAQoC,OAAO+B,UAAU,aAC/BC,EAAQC,KAAKH,EAAIpF,MAAM,KACvBwF,EAAS,GAAIC,YAAWH,EAAMtG,QACzB0G,EAAI,EAAGA,EAAIJ,EAAMtG,SAAU0G,EAChCF,EAAOE,GAAKJ,EAAMK,WAAWD,EAEjC,IAAIrB,GAAO,GAAIC,OAAMkB,IACjBtD,KAAM,aAEVhB,GAAQgE,MAAMd,SACVC,KAAMA,EACNO,UAAW,SAEf1D,EAAQgE,MAAQ,MApIxB9B,EAAe9E,WACX+E,IAAKA,EACL4B,SAAUA,EACVE,eAAgBA,EAChB5B,OAAQA,EACRmB,KAAMA,GAmIV3D,OAAOqC,eAAiBA,KAI3B,WACG,YAEA,IAAIwC,GAAS,WAOT,QAASC,GAAM/D,GACX,GAAIgE,IACAC,GAAI,IAAK,KACTC,GAAI,IAAK,IAAK,KACdC,GAAI,IAAK,IAAK,IAAK,MAEnBC,EAAOJ,EAAOhE,EAAM9C,QACpBmH,IAIJ,OAHArE,GAAMsE,OAAO,SAAU3H,EAAGiH,GACtBS,EAAED,EAAKR,IAAMjH,IAEV0H,EAGX,QAASE,GAAUvE,EAAOwE,GACtB,GAAIH,KAIJ,OAHArE,GAAMsE,OAAO,SAAU3H,EAAGiH,GACtBS,EAAEG,EAASZ,GAAKjH,IAEb0H,EAGX,QAASI,GAAO9H,GACZ,MAAO,UAAU+H,GACb,MAAO/H,GAAE+H,IAIjB,QAASnD,GAAIoD,GACT,GAAIxC,KACJ,KAAK,GAAIyC,KAAKD,GAAK,CACf,GAAIhI,GAAIgI,EAAIC,EACZ,IAAIC,MAAMC,QAAQnI,GACd,GAAIA,EAAEO,OAAS,EACX,aAAeP,GAAE,IACb,IAAK,SACGA,EAAEO,OAAS,IACXiF,EAAKyC,GAAKb,EAAMpH,GAEpB,MACJ,KAAK,UACDwF,EAAKyC,GAAKL,EAAU5H,EAAG,QACvB,MACJ,KAAK,SACDwF,EAAKyC,GAAKL,EAAU5H,EAAG,WACvB,MACJ,KAAK,SACDwF,EAAKyC,GAAKL,EAAU5H,EAAG,eAGxBA,GAAEO,SACTiF,EAAKyC,GAAKjI,EAAE,aAEHoI,KAANpI,GAAyB,OAANA,IAC1BwF,EAAKyC,GAAKjI,GAGlB,MAAOwF,GAGX,QAAS6C,GAAIL,GACT,GAAIxC,KACJ,KAAK,GAAIyC,KAAKD,GAAK,CACf,GAAIhI,GAAIgI,EAAIC,EACZ,cAAejI,IACX,IAAK,WACD,KACJ,KAAK,SACL,IAAK,UACL,IAAK,SACDwF,EAAKyC,GAAKjI,CACV,MACJ,SACI,GAAIyH,GAAOa,OAAOb,KAAKzH,EACvBwF,GAAKyC,GAAKR,EAAKc,IAAIT,EAAO9H,KAKtC,MAAOwF,GAqBX,OAxGIZ,IAAKA,EACLyD,IAAKA,MA2GTG,EAAa,WAEb,QAASA,GAAWC,GAChB7I,KAAK8I,QAAS,EACd9I,KAAK+I,QAAS,EACd/I,KAAK6I,SAAWA,GAAY,WACxBpE,QAAQC,IAAI,wBAEhB1E,KAAKgJ,QAYT,QAASC,GAAQ1H,EAAGO,GAEhB,MAAOoH,MAAKC,UAAU5H,KAAO2H,KAAKC,UAAUrH,GAGhD,QAASsH,GAAKhB,GACV,MAAOc,MAAKG,MAAMH,KAAKC,UAAUf,IAGrC,QAASkB,GAAM/H,EAAGO,GACd,QAASyH,GAAOhI,EAAGO,GACf,IAAK,GAAIqG,KAAO5G,GACRO,EAAE0H,eAAerB,KACK,gBAAX5G,GAAE4G,GACT5G,EAAE4G,GAAOrG,EAAEqG,GACa,gBAAV5G,GAAE4G,IAAoBO,OAAOb,KAAKtG,EAAE4G,IAAMxH,OAAS,GACjE4I,EAAOhI,EAAE4G,GAAMrG,EAAEqG,KAUjC,MALI5G,KACAA,EAAI6H,EAAK7H,GAETgI,EAAOhI,EAAGO,IAEPP,EAGX,QAASkI,GAAKrB,EAAKsB,EAAQb,GACvB,GACIR,GADAR,IAEJ,KAAKQ,IAAKqB,GACN7B,EAAK/B,KAAKuC,EAEdR,GAAKE,OAAO,SAAUI,GAClB,GAAIpE,GAAQ2F,EAAOvB,EACnB,IAAqB,gBAAVpE,GACPsE,EAAID,EAAIjI,IAAIuJ,EAAQvB,EAAK,EAAK,GAC9BE,EAAEsB,SAASd,OACR,IAAqB,gBAAV9E,IAAsB2E,OAAOb,KAAK9D,GAAOpD,OAAS,EAAG,CACnE0H,EAAI,IACJ,IAAIuB,GAASxB,EAAIyB,UAAU1B,EAC3BsB,GAAKG,EAAQ7F,EAAO8E,OAEpBR,GAAID,EAAIjI,IAAIuJ,EAAQvB,GACpBE,EAAEsB,SAASd,KAKvB,QAASiB,GAAU1B,EAAKsB,EAAQb,GAE5B,QAASkB,GAAW3B,EAAKsB,GACrBtB,EAAI4B,cAAcjC,OAAO,SAAUhG,GAC/B,GAA8B,gBAAnBA,GAAEkI,cAAgD,gBAAZlI,GAAEmI,OAAyC,gBAAZnI,GAAEoI,MAAoB,CAClG,GAAIpG,GAAQhC,EAAEmI,OAASnI,EAAEoI,MAAQpI,EAAEmI,OAAStJ,KAAKwB,QACjDsH,GAAO3H,EAAEqI,UAAYrG,EACrBhC,EAAEsI,kBAGV,KAAK,GAAIC,KAAKlC,GAAImC,UACdR,EAAW3B,EAAImC,UAAUD,GAAIZ,EAAOY,IAG5CP,EAAW3B,EAAKsB,GAChBb,IAKJ,QAAS2B,GAAKd,GACV,GAAI7G,GAAU7C,KACVyK,EAAM5H,EAAQ4H,IACdC,EAAS7H,EAAQ6H,OACjBC,EAAU1B,EAAQS,EAAQgB,EAgB9B,IAfID,GAAOE,IACP9H,EAAQiG,OAAS2B,EAAI3B,OACrB2B,EAAIG,UACJH,EAAM,MAELA,IACDA,EAAM,GAAII,KAAIC,IACdL,EAAI3B,OAASjG,EAAQiG,OACrBjG,EAAQ4H,IAAMA,EACV5H,EAAQkG,OACRlG,EAAQkI,OAERlI,EAAQmI,QAGZL,EAAS,CACTD,EAAStB,EAAKM,GACd7G,EAAQ6H,OAASA,CACjB,IAAI1B,GAAOzB,EAAOvC,IAAI0E,EACtBV,GAAOM,EAAMN,EAAMnG,EAAQmG,MAC3BnG,EAAQmG,KAAOA,CACf,IAAIiC,GAAY,WACZpI,EAAQgG,SAASG,GAErBS,GAAKgB,EAAKzB,EAAMiC,GAChBjC,EAAKc,UAAY,WACbA,EAAUW,EAAKzB,EAAMiC,IAEzBR,EAAItK,IAAI6I,EAAM,cAItB,QAAS+B,KACL,GAAIlI,GAAU7C,IACd6C,GAAQkG,QAAS,CACjB,IAAI0B,GAAM5H,EAAQ4H,GACdA,KACAA,EAAIS,WAAWC,MAAMC,QAAU,QAKvC,QAASJ,KACL,GAAInI,GAAU7C,KACV0K,EAAS7H,EAAQ6H,OACjBD,EAAM5H,EAAQ4H,GACdA,IAAO/B,OAAOb,KAAK6C,GAAQ/J,SAC3B8J,EAAIS,WAAWC,MAAMC,QAAU,IAEnCvI,EAAQkG,QAAS,EAGrB,QAAS9E,KACL,GAAIpB,GAAU7C,KACVgJ,EAAOnG,EAAQmG,IACnB,OAAOzB,GAAOkB,IAAIO,GAGtB,MA/IAJ,GAAW3I,WACPuK,KAAMA,EACNO,KAAMA,EACNC,KAAMA,EACN/G,SAAUA,GA2IP2E,IAGXlG,QAAOkG,WAAaA,KAKvB,WACG,YAEA,IAAIyC,GAAgB,WAEhB,QAASA,KACL,GAAIxI,GAAU7C,IACd6C,GAAQG,MAAQ,GAAIU,eAAc,EAAK,IACvCb,EAAQyI,WACRzI,EAAQ0I,OAAS,GAAIjD,OAAM,IAAIkD,KAAK,MAAM7C,IAAI,WAC1C,MAAO,IAAIjF,eAAc,EAAK,MA0DtC,QAASL,GAAOC,GASZ,IARA,GAAIT,GAAU7C,KACVuL,EAAS1I,EAAQ0I,OACjBD,EAAUzI,EAAQyI,QAClBtI,EAAQH,EAAQG,MAEhBqE,EAAI,EACJoE,EAAIF,EAAO5K,OACX+K,EAAKJ,EAAQ3K,OAAS2K,EAAQ,GAAKtI,EAChCqE,EAAIoE,GAAG,CACV,GAAIjH,GAAK6C,EAAI,EAAIkE,EAAOlE,EAAI,GAAKqE,EAC7BtL,EAAImL,EAAOlE,GACXsE,EAAW,GAAO,EAAMtE,EAC5BjH,GAAE,KAAOoE,EAAE,GAAKpE,EAAE,IAAMuL,EACxBvL,EAAE,KAAOoE,EAAE,GAAKpE,EAAE,IAAMuL,EACxB9I,EAAQc,OAAOL,EAAM,MAAO,OAAQ,YAAc+D,EAAI,IAAKjH,GAC3DiH,IAEAiE,EAAQ3K,QACR2K,EAAQM,QAIhB,QAAS3I,GAAKpD,EAAGC,GACb,GAAI+C,GAAU7C,KACVgD,EAAQH,EAAQG,KACpBA,GAAM,GAAKnD,EACXmD,EAAM,GAAKlD,EACX+C,EAAQiD,OAGZ,QAAS+F,KACL,GAAIhJ,GAAU7C,IACd6C,GAAQyI,QAAQxF,KAAK,GAAIpC,cAAab,EAAQG,QAGlD,QAASW,GAAOL,EAAMM,EAAQC,EAAMC,EAAMC,GACtC,IACI,GAAIC,GAAIV,EAAKW,SAASH,GAAQR,EAAKW,SAASH,MAC5CE,GAAEF,KAAOA,EACTE,EAAED,MAAQA,EACVC,EAAEH,KAAOA,EACTG,EAAEJ,OAAS,UAAYA,EACvBI,EAAEE,SAAWZ,EAAKa,GAAGC,mBAAmBd,EAAKe,QAASP,GACtDR,EAAKa,GAAGH,EAAEJ,QAAQU,MAAMhB,EAAKa,IAAKH,EAAEE,UAAUK,OAAOP,EAAED,QACzD,MAAOS,GACLC,QAAQC,IAAI,aAAcF,IApGlC6G,EAAcpL,WACVoD,OAAQA,EACRJ,KAAMA,EACN6C,KAUJ,SAAkBgG,EAAMC,EAAMvG,GAM1B,GAAIwG,GAASC,EAAMC,EACfC,EAAU,KACVC,EAAW,CACV5G,KAASA,KACd,IAAI6G,GAAQ,WACRD,GAA+B,IAApB5G,EAAQ8G,QAAoB,EAAIC,IAC3CJ,EAAU,KACVD,EAASJ,EAAKxH,MAAM0H,EAASC,GACxBE,IAASH,EAAUC,EAAO,MAEnC,OAAO,YACH,GAAIO,GAAMD,GACLH,KAAgC,IAApB5G,EAAQ8G,UAAmBF,EAAWI,EACvD,IAAIC,GAAYV,GAAQS,EAAMJ,EAc9B,OAbAJ,GAAUhM,KACViM,EAAOS,UACHD,GAAa,GAAKA,EAAYV,GAC1BI,IACAQ,aAAaR,GACbA,EAAU,MAEdC,EAAWI,EACXN,EAASJ,EAAKxH,MAAM0H,EAASC,GACxBE,IAASH,EAAUC,EAAO,OACvBE,IAAgC,IAArB3G,EAAQoH,WAC3BT,EAAUU,WAAWR,EAAOI,IAEzBP,IA3CIL,EAAO,IAAO,IAC7BlI,OAAQA,EAKZ,IAAI4I,GAASO,KAAKN,KAAO,WACrB,OAAO,GAAIM,OAAOC,UA8FtB,OAAO1B,KAGX3I,QAAO2I,cAAgBA,KAK1B,WACG,YAEA,SAAS2B,KAwCL,QAASC,GAAiBvD,GACtB,GAAIzF,GAAWwG,EAAIxG,UAInBX,GAAK4J,YAAYjJ,GAQrB,QAASuG,KACL2C,SAASC,cAAc,WAAWC,aAAa,QAAS,UACxDF,SAASC,cAAc,YAAYC,aAAa,QAAU7H,QAAQ8H,IAAM,UAAY,iBACpF,IAAIC,GAAI7K,OAAO8C,OACf+H,GAAEC,OAASD,EAAEC,OAAOC,OAAO9M,OAAS,EAAI4M,EAAEC,OAAS,KACnDD,EAAEG,SAAWH,EAAEG,SAASD,OAAO9M,OAAS,EAAI4M,EAAEG,SAAW,KACrDH,EAAEG,UAAYH,EAAEC,OAChBL,SAASC,cAAc,QAAQC,aAAa,QAAS,UAErDF,SAASC,cAAc,QAAQC,aAAa,QAAS,SACrDM,KAEJrK,EAAKkH,KAAK+C,EAAEG,SAAUH,EAAEC,OACxB,KAAK,GAAI/B,KAAK8B,GAAEK,SACZtK,EAAKuK,eAAe,aAAepC,EAAG8B,EAAEK,SAASnC,IAC7CqC,UAAW,SACXC,QAAQ,GAGhBtD,GAAID,KAAK+C,EAAEtJ,UACXX,EAAK4J,YAAYzC,EAAIxG,YAGzB,QAAS+J,GAAOnM,GACZ,GAAIoM,GAAIC,EAAQC,YACZC,EAAIF,EAAQG,YAChBpJ,GAAOkG,MAAMmD,MAAQL,EAAI,KACzBhJ,EAAOkG,MAAMoD,OAASH,EAAI,KACtBvM,GACAoD,EAAOqJ,MAAQL,EACfhJ,EAAOsJ,OAASH,GAEhB9K,EAAK0K,SAUb,QAAS9I,KACL5B,EAAKkL,aAAc,EACnBlL,EAAKD,SACDgC,EAAQH,SAKhB,QAASmB,KACLhB,EAAQgB,OAAOoI,KAAK,SAAUC,GAI1B,GAAI3H,GAAM4H,IAAIC,gBAAgBF,EAAM1I,MAChC6I,EAAO1B,SAAS2B,cAAc,IAClCD,GAAKE,KAAOhI,EACZ8H,EAAKG,SAAW,SAAWN,EAAMnI,UACjCsI,EAAKI,QACLpC,WAAW,WACPnK,OAAOiM,IAAIO,gBAAgBC,SAC5B,OAIX,QAASC,KACLC,EAAMC,OAASD,EAAMC,MAEjBhM,EAAKiM,QACDjM,EAAKkM,YACLlM,EAAKmM,SAAW,GAAI3C,MACpBxJ,EAAKoM,UAAapM,EAAKmM,SAAWnM,EAAKkM,WAE3ClM,EAAKqM,OACLC,EAAQN,MAAMlC,cAAc,KAAKC,aAAa,QAAS,gBAEvD/J,EAAKgM,QACLhM,EAAKkM,UAAY,GAAI1C,MACrB8C,EAAQN,MAAMlC,cAAc,KAAKC,aAAa,QAAS,cAI/D,QAASwC,KACLR,EAAMnK,QAAUmK,EAAMnK,OAElBmK,EAAMnK,QACN0K,EAAQ1K,OAAOmI,aAAa,QAAS,yBACrCuC,EAAQ1K,OAAOkI,cAAc,KAAKC,aAAa,QAAS,aACxDnI,MAEA0K,EAAQ1K,OAAOmI,aAAa,QAAS,kBACrCuC,EAAQ1K,OAAOkI,cAAc,KAAKC,aAAa,QAAS,eACxDhH,KAIR,QAASyJ,KAGL,QAASC,KACLC,EAAMrM,SACF0L,EAAMW,OACNC,sBAAsBF,GAL9BV,EAAMW,OAASX,EAAMW,MAQjBX,EAAMW,OACDE,EAQDA,EAAS/E,MAAMgF,WAAa,WAP5BH,EAAQ,GAAII,OACZJ,EAAMK,UAAU,GAChBH,EAAWF,EAAMM,IACjBJ,EAAS7C,aAAa,QAAS,SAE/BF,SAASoD,KAAKC,YAAYR,EAAMM,MAIpCL,sBAAsBF,GACtBtF,EAAIO,OACJ4E,EAAQI,MAAM3C,aAAa,QAAS,yBAEpCM,IAIR,QAASA,KACDuC,IACAA,EAAS/E,MAAMgF,WAAa,UAEhC1F,EAAIM,OACJ6E,EAAQI,MAAM3C,aAAa,QAAS,iBACpCgC,EAAMW,OAAQ,EAGlB,QAASS,GAAajM,GAElB9B,OAAOgO,OAAOC,aACVC,QAAS,iBACThL,KAAM,oCAAsCsD,KAAKC,WAAW3D,QAAQ8H,OACrE,WAGP,QAASuD,GAAUC,GACfpO,OAAO8C,QAAU0D,KAAKG,MAAMyH,EAAMlL,MAGlC4E,IAKJ,QAASuG,KACDC,GACArE,aAAaqE,GAEjBA,EAAKnE,WAAWmB,EAAQ,IAc5B,QAASiD,GAAOzM,GACZ,GAAIzD,GAAMH,KAAKG,IAAImN,EAAQC,YAAaD,EAAQG,aAChDxJ,GAAO9B,KAAKyB,EAAE3E,EAAIkB,EAAKyD,EAAE1E,EAAIiB,GAGjC,QAASmQ,GAAO1M,GACZ,GAAIzD,GAAMH,KAAKG,IAAImN,EAAQC,YAAaD,EAAQG,aAChDxJ,GAAO5B,KAAKuB,EAAE3E,EAAIkB,EAAKyD,EAAE1E,EAAIiB,GAC7BwK,EAAOtI,KAAKuB,EAAE3E,EAAGqO,EAAQG,aAAe7J,EAAE1E,GAG9C,QAASqR,GAAK3M,GACV,GAAIzD,GAAMH,KAAKG,IAAImN,EAAQC,YAAaD,EAAQG,aAChDxJ,GAAO3B,GAAGsB,EAAE3E,EAAIkB,EAAKyD,EAAE1E,EAAIiB,GAG/B,QAASqQ,GAAQ5M,GACbK,EAAO1B,MAAMqB,EAAE6M,WAAazQ,KAAK0Q,IAAI9M,EAAE6M,aA9O3C,GAAIrB,GAAOE,EAEPhC,EAAUf,SAASC,cAAc,YACjCnI,EAASkI,SAASC,cAAc,WAChCwC,GACAN,MAAOnC,SAASC,cAAc,cAC9BlI,OAAQiI,SAASC,cAAc,eAC/B4C,MAAO7C,SAASC,cAAc,cAC9BmE,OAAQpE,SAASC,cAAc,gBAE/BiC,GACAmC,QAAQ,EACRtM,QAAQ,EACR8K,OAAO,EAGXhC,IAAO,EAEP,IAAI1K,GAAO,GAAImO,YAAWxM,GACtByM,oBAAoB,EACpBC,uBAAuB,EACvBC,gBAAiB,iBAErBtO,GAAKuO,GAAG,QAASC,EAEjB,IAAIzM,GAAU,GAAIN,eAClBM,GAAQL,IAAIC,EAEZ,IAAIJ,GAAS,GAAIlC,eAEb4I,EAAS,GAAIF,cAEjB/H,GAAKuO,GAAG,SAAU,WACdxM,EAAQyB,iBACRjC,EAAOxB,OAAOC,GACdiI,EAAOlI,OAAOC,GACdA,EAAKkL,aAAc,GAYvB,IAAI/D,GAAM,GAAI7B,YAAWqE,EAEzBzC,IAuJA,IAAIwG,EAwCJ/L,GAAO8M,iBAAiB,WAAY3C,GACpCnK,EAAO8M,iBAAiB,YAAad,GACrChM,EAAO8M,iBAAiB,YAAab,GACrCxO,OAAOqP,iBAAiB,UAAWZ,GACnCzO,OAAOqP,iBAAiB,aAAcX,GACtCxB,EAAQN,MAAMyC,iBAAiB,YAAa3C,GAC5CQ,EAAQ1K,OAAO6M,iBAAiB,YAAalC,GAC7CD,EAAQI,MAAM+B,iBAAiB,YAAajC,GAC5CF,EAAQ2B,OAAOQ,iBAAiB,QAAStB,GACzC/N,OAAOqP,iBAAiB,UAAWlB,GAAW,GAC9CnO,OAAOqP,iBAAiB,SAAUhB,GAElC/C,IAGJ,QAAS8D,GAAYE,GAEjB,GAAIxM,GAAU9C,OAAO8C,QACjByM,KACAC,IACJF,GAAQG,MAAMC,QAAQ,qCAAsC,SAAUC,EAAGC,EAAGlS,EAAGqL,GAC3E,GAAIuG,GAAU,UAAY5R,EAAI,KAAOqL,EACjC8G,EAAK,2CAA6CC,UAAU,sCAAwCtJ,KAAKC,WAAW3D,EAAQ8H,IAAKmF,OAAOH,GAAIN,KAAa,mCAAqCS,OAAOH,GAAK,sCAAwClS,EAAI,KAAOA,EAAI,qCAAuCqL,EAAI,KAAOA,EAAI,kBAE3T,OADAwG,GAAOnM,KAAKyM,GACLA,IAEXP,EAAQG,MAAMC,QAAQ,iDAAkD,SAAUC,EAAGC,EAAGlS,EAAGqL,GACvF,GAAI8G,GAAK,6CAA+CC,UAAU,sCAAwCtJ,KAAKC,WAAW3D,EAAQ8H,IAAKmF,OAAOH,GAAIN,KAAa,kCAAoCS,OAAOH,GAAK,qCAAuC7G,EAAI,KAAOA,EAAI,kBAErQ,OADAyG,GAASpM,KAAKyM,GACPA,GAEX,IAAIpD,GAAS,yDACbA,IAAU8C,EAAOS,KAAK,MACtBvD,GAAU+C,EAASQ,KAAK,MACxBvD,GAAU,cACVhC,SAASC,cAAc,WAAWC,aAAa,QAAS,iBACxDF,SAASC,cAAc,WAAWuF,UAAYxD,EAC9ChC,SAASC,cAAc,QAAQC,aAAa,QAAS,QAGzD3K,OAAOqP,iBAAiB,OAAQ/E","file":"resources/js/app.min.js","sourcesContent":["(function () {\r\n    'use strict';\r\n\r\n    var Vector = function () {\r\n\r\n        function Vector(x, y, z) {\r\n            this.x = x || 0;\r\n            this.y = y || 0;\r\n            this.z = z || 0;\r\n        }\r\n\r\n        // Instance Methods\r\n        // The methods add(), subtract(), multiply(), and divide() can all take either a vector or a number as an argument.\r\n\r\n        Vector.prototype = {\r\n            negative: function () {\r\n                return new Vector(-this.x, -this.y, -this.z);\r\n            },\r\n            add: function (v) {\r\n                if (v instanceof Vector) return new Vector(this.x + v.x, this.y + v.y, this.z + v.z);\r\n                else return new Vector(this.x + v, this.y + v, this.z + v);\r\n            },\r\n            subtract: function (v) {\r\n                if (v instanceof Vector) return new Vector(this.x - v.x, this.y - v.y, this.z - v.z);\r\n                else return new Vector(this.x - v, this.y - v, this.z - v);\r\n            },\r\n            multiply: function (v) {\r\n                if (v instanceof Vector) return new Vector(this.x * v.x, this.y * v.y, this.z * v.z);\r\n                else return new Vector(this.x * v, this.y * v, this.z * v);\r\n            },\r\n            divide: function (v) {\r\n                if (v instanceof Vector) return new Vector(this.x / v.x, this.y / v.y, this.z / v.z);\r\n                else return new Vector(this.x / v, this.y / v, this.z / v);\r\n            },\r\n            equals: function (v) {\r\n                return this.x === v.x && this.y === v.y && this.z === v.z;\r\n            },\r\n            dot: function (v) {\r\n                return this.x * v.x + this.y * v.y + this.z * v.z;\r\n            },\r\n            cross: function (v) {\r\n                return new Vector(\r\n                    this.y * v.z - this.z * v.y,\r\n                    this.z * v.x - this.x * v.z,\r\n                    this.x * v.y - this.y * v.x\r\n                );\r\n            },\r\n            length: function () {\r\n                return Math.sqrt(this.dot(this));\r\n            },\r\n            unit: function () {\r\n                return this.divide(this.length());\r\n            },\r\n            min: function () {\r\n                return Math.min(Math.min(this.x, this.y), this.z);\r\n            },\r\n            max: function () {\r\n                return Math.max(Math.max(this.x, this.y), this.z);\r\n            },\r\n            toAngles: function () {\r\n                return {\r\n                    theta: Math.atan2(this.z, this.x),\r\n                    phi: Math.asin(this.y / this.length())\r\n                };\r\n            },\r\n            angleTo: function (a) {\r\n                return Math.acos(this.dot(a) / (this.length() * a.length()));\r\n            },\r\n            toArray: function (n) {\r\n                return [this.x, this.y, this.z].slice(0, n || 3);\r\n            },\r\n            clone: function () {\r\n                return new Vector(this.x, this.y, this.z);\r\n            },\r\n            init: function (x, y, z) {\r\n                this.x = x;\r\n                this.y = y;\r\n                this.z = z;\r\n                return this;\r\n            }\r\n        };\r\n\r\n        // Static Methods\r\n        // Vector.randomDirection() returns a vector with a length of 1 and a statistically uniform direction. Vector.lerp() performs linear interpolation between two vectors.\r\n\r\n        Vector.negative = function (a, b) {\r\n            b.x = -a.x;\r\n            b.y = -a.y;\r\n            b.z = -a.z;\r\n            return b;\r\n        };\r\n        Vector.add = function (a, b, c) {\r\n            if (b instanceof Vector) {\r\n                c.x = a.x + b.x;\r\n                c.y = a.y + b.y;\r\n                c.z = a.z + b.z;\r\n            } else {\r\n                c.x = a.x + b;\r\n                c.y = a.y + b;\r\n                c.z = a.z + b;\r\n            }\r\n            return c;\r\n        };\r\n        Vector.subtract = function (a, b, c) {\r\n            if (b instanceof Vector) {\r\n                c.x = a.x - b.x;\r\n                c.y = a.y - b.y;\r\n                c.z = a.z - b.z;\r\n            } else {\r\n                c.x = a.x - b;\r\n                c.y = a.y - b;\r\n                c.z = a.z - b;\r\n            }\r\n            return c;\r\n        };\r\n        Vector.multiply = function (a, b, c) {\r\n            if (b instanceof Vector) {\r\n                c.x = a.x * b.x;\r\n                c.y = a.y * b.y;\r\n                c.z = a.z * b.z;\r\n            } else {\r\n                c.x = a.x * b;\r\n                c.y = a.y * b;\r\n                c.z = a.z * b;\r\n            }\r\n            return c;\r\n        };\r\n        Vector.divide = function (a, b, c) {\r\n            if (b instanceof Vector) {\r\n                c.x = a.x / b.x;\r\n                c.y = a.y / b.y;\r\n                c.z = a.z / b.z;\r\n            } else {\r\n                c.x = a.x / b;\r\n                c.y = a.y / b;\r\n                c.z = a.z / b;\r\n            }\r\n            return c;\r\n        };\r\n        Vector.cross = function (a, b, c) {\r\n            c.x = a.y * b.z - a.z * b.y;\r\n            c.y = a.z * b.x - a.x * b.z;\r\n            c.z = a.x * b.y - a.y * b.x;\r\n            return c;\r\n        };\r\n        Vector.unit = function (a, b) {\r\n            var length = a.length();\r\n            b.x = a.x / length;\r\n            b.y = a.y / length;\r\n            b.z = a.z / length;\r\n            return b;\r\n        };\r\n        Vector.fromAngles = function (theta, phi) {\r\n            return new Vector(Math.cos(theta) * Math.cos(phi), Math.sin(phi), Math.sin(theta) * Math.cos(phi));\r\n        };\r\n        Vector.randomDirection = function () {\r\n            return Vector.fromAngles(Math.random() * Math.PI * 2, Math.asin(Math.random() * 2 - 1));\r\n        };\r\n        Vector.min = function (a, b) {\r\n            return new Vector(Math.min(a.x, b.x), Math.min(a.y, b.y), Math.min(a.z, b.z));\r\n        };\r\n        Vector.max = function (a, b) {\r\n            return new Vector(Math.max(a.x, b.x), Math.max(a.y, b.y), Math.max(a.z, b.z));\r\n        };\r\n        Vector.lerp = function (a, b, fraction) {\r\n            return b.subtract(a).multiply(fraction).add(a);\r\n        };\r\n        Vector.fromArray = function (a) {\r\n            return new Vector(a[0], a[1], a[2]);\r\n        };\r\n        Vector.angleBetween = function (a, b) {\r\n            return a.angleTo(b);\r\n        };\r\n\r\n        return Vector;\r\n    }();\r\n\r\n    window.Vector = Vector;\r\n\r\n}());\n/* global window, console, Vector */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var CameraService = function () {\r\n\r\n        var PI = Math.PI;\r\n        var RAD = PI / 180;\r\n\r\n        function CameraService(theta, phi, radius) {\r\n            var service = this;\r\n            service.theta = (theta || 45) * RAD;\r\n            service.phi = (phi || 45) * RAD;\r\n            service.radius = radius || 1.0;\r\n        }\r\n\r\n        CameraService.prototype = {\r\n            down: down,\r\n            move: move,\r\n            up: up,\r\n            wheel: wheel,\r\n            render: render,\r\n            update: update,\r\n        };\r\n\r\n        CameraService.fromVector = fromVector;\r\n        CameraService.toVector = toVector;\r\n\r\n        // publics\r\n\r\n        function down(x, y) {\r\n            var service = this;\r\n            service.mouse = {\r\n                x: x,\r\n                y: y,\r\n            };\r\n        }\r\n\r\n        function move(x, y) {\r\n            var service = this,\r\n                mouse = service.mouse;\r\n            if (mouse) {\r\n                var theta = (x - mouse.x) * 180 * RAD;\r\n                var phi = (mouse.y - y) * 180 * RAD;\r\n                mouse.x = x;\r\n                mouse.y = y;\r\n                service.theta += theta;\r\n                service.phi += phi;\r\n            }\r\n        }\r\n\r\n        function up(x, y) {\r\n            var service = this;\r\n            service.mouse = null;\r\n        }\r\n\r\n        function wheel(d) {\r\n            var service = this;\r\n            service.radius = Math.max(0.01, service.radius + d * 0.02);\r\n        }\r\n\r\n        function render(glsl) {\r\n            var service = this;\r\n            var vector = CameraService.toVector(service);\r\n            var array = new Float32Array([vector.x, vector.y, vector.z]);\r\n            service.update(glsl, '3fv', 'vec3', 'u_camera', array);\r\n        }\r\n\r\n        function update(glsl, method, type, name, value) {\r\n            try {\r\n                var u = glsl.uniforms[name] = glsl.uniforms[name] || {};\r\n                u.name = name;\r\n                u.value = value;\r\n                u.type = type;\r\n                u.method = 'uniform' + method;\r\n                u.location = glsl.gl.getUniformLocation(glsl.program, name);\r\n                glsl.gl[u.method].apply(glsl.gl, [u.location].concat(u.value));\r\n            } catch (e) {\r\n                console.log('fastUpdate', e);\r\n            }\r\n        }\r\n\r\n        // statics\r\n\r\n        function fromVector(vector) {\r\n            var radius = vector.length();\r\n            var theta = Math.acos(vector.y / radius); //theta\r\n            var phi = Math.atan(vector.x / vector.z); //phi\r\n            return new CameraService(theta, phi, radius);\r\n        }\r\n\r\n        function toVector(camera) {\r\n            var spr = Math.sin(camera.phi) * camera.radius;\r\n            var x = spr * Math.sin(camera.theta);\r\n            var y = Math.cos(camera.phi) * camera.radius;\r\n            var z = spr * Math.cos(camera.theta);\r\n            return new Vector(x, y, z);\r\n        }\r\n\r\n        return CameraService;\r\n\r\n    }();\r\n\r\n    window.CameraService = CameraService;\r\n\r\n}());\n/* global window, document, console, GlslCanvas */\r\n/* \r\nAuthor: Brett Camper (@professorlemeza)\r\nURL: https://github.com/tangrams/tangram/blob/master/src/utils/media_capture.js\r\n*/\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    function CaptureService() {}\r\n\r\n    CaptureService.prototype = {\r\n        set: set,\r\n        snapshot: snapshot,\r\n        snapshotRender: snapshotRender,\r\n        record: record,\r\n        stop: stop,\r\n    };\r\n\r\n    function set(canvas) {\r\n        var service = this;\r\n        service.canvas = canvas;\r\n    }\r\n\r\n    /*\r\n    var mimeTypes = [\r\n        'video/webm\\;codecs=h264',\r\n        'video/webm\\;codecs=vp8',\r\n        'video/webm\\;codecs=daala',\r\n        'video/webm',\r\n        'audio/webm\\;codecs=opus',\r\n        'audio/webm',\r\n        'video/mpeg',\r\n    ];\r\n    var options = {\r\n        videoBitsPerSecond: 2500000,\r\n        audioBitsPerSecond: 128000,\r\n        mimeType: 'video/webm',\r\n        extension: '.webm',\r\n    };\r\n    // MediaRecorder.isTypeSupported(mimeTypes[0])\r\n    */\r\n\r\n    function record() {\r\n        var service = this;\r\n        if (typeof window.MediaRecorder !== 'function' || !service.canvas || typeof service.canvas.captureStream !== 'function') {\r\n            console.log('warn: Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser');\r\n            return false;\r\n        } else if (service.capture) {\r\n            console.log('warn: Video capture already in progress, call Scene.stopVideoCapture() first');\r\n            return false;\r\n        }\r\n        try {\r\n            var capture = {};\r\n            var chunks = [];\r\n            var stream = service.canvas.captureStream();\r\n            var options = {\r\n                mimeType: 'video/webm', // 'video/webm\\;codecs=h264'\r\n            };\r\n            var recorder = new MediaRecorder(stream, options);\r\n            recorder.ondataavailable = function (e) {\r\n                if (e.data.size > 0) {\r\n                    chunks.push(e.data);\r\n                }\r\n                // Stopped recording? Create the final capture file blob\r\n                if (capture.resolve) {\r\n                    var blob = new Blob(chunks, {\r\n                        type: options.mimeType,\r\n                    });\r\n                    if (stream) {\r\n                        var tracks = stream.getTracks() || [];\r\n                        tracks.forEach(function (track) {\r\n                            track.stop();\r\n                            stream.removeTrack(track);\r\n                        });\r\n                    }\r\n                    stream = null;\r\n                    service.recorder = null;\r\n                    service.capture = null;\r\n                    capture.resolve({\r\n                        blob: blob,\r\n                        extension: '.webm',\r\n                    });\r\n                }\r\n            };\r\n            service.capture = capture;\r\n            service.recorder = recorder;\r\n            recorder.start();\r\n        } catch (e) {\r\n            service.capture = null;\r\n            service.recorder = null;\r\n            console.log('error: Scene video capture failed', e);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function stop() {\r\n        var service = this;\r\n        if (!service.capture) {\r\n            console.log('warn: No scene video capture in progress, call Scene.startVideoCapture() first');\r\n            return Promise.resolve({});\r\n        }\r\n        service.capture.promise = new Promise(function (resolve, reject) {\r\n            service.capture.resolve = resolve;\r\n            service.capture.reject = reject;\r\n        });\r\n        service.recorder.stop();\r\n        return service.capture.promise;\r\n    }\r\n\r\n    function snapshot() {\r\n        var service = this;\r\n        if (service.queue) {\r\n            return service.queue.promise;\r\n        }\r\n        service.queue = {};\r\n        service.queue.promise = new Promise(function (resolve, reject) {\r\n            service.queue.resolve = resolve;\r\n            service.queue.reject = reject;\r\n        });\r\n        return service.queue.promise;\r\n    }\r\n\r\n    function snapshotRender() {\r\n        var service = this;\r\n        if (service.queue) {\r\n            // Get data URL, convert to blob\r\n            // Strip host/mimetype/etc., convert base64 to binary without UTF-8 mangling\r\n            // Adapted from: https://gist.github.com/unconed/4370822\r\n            var url = service.canvas.toDataURL('image/png');\r\n            var bytes = atob(url.slice(22));\r\n            var buffer = new Uint8Array(bytes.length);\r\n            for (var i = 0; i < bytes.length; ++i) {\r\n                buffer[i] = bytes.charCodeAt(i);\r\n            }\r\n            var blob = new Blob([buffer], {\r\n                type: 'image/png',\r\n            });\r\n            service.queue.resolve({\r\n                blob: blob,\r\n                extension: '.png',\r\n            });\r\n            service.queue = null;\r\n        }\r\n    }\r\n\r\n    window.CaptureService = CaptureService;\r\n}());\n/* global window, document, console */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var Parser = function () {\r\n\r\n        var Parser = {\r\n            set: set,\r\n            get: get,\r\n        };\r\n\r\n        function tuple(array) {\r\n            var tuples = {\r\n                2: ['x', 'y'],\r\n                3: ['x', 'y', 'z'],\r\n                4: ['r', 'g', 'b', 'a']\r\n            };\r\n            var keys = tuples[array.length];\r\n            var r = {};\r\n            array.filter(function (v, i) {\r\n                r[keys[i]] = v;\r\n            });\r\n            return r;\r\n        }\r\n\r\n        function enumerate(array, prefix) {\r\n            var r = {};\r\n            array.filter(function (v, i) {\r\n                r[prefix + i] = v;\r\n            });\r\n            return r;\r\n        }\r\n\r\n        function getter(v) {\r\n            return function (key) {\r\n                return v[key];\r\n            };\r\n        }\r\n\r\n        function set(obj) {\r\n            var data = {};\r\n            for (var p in obj) {\r\n                var v = obj[p];\r\n                if (Array.isArray(v)) {\r\n                    if (v.length > 1) {\r\n                        switch (typeof v[0]) {\r\n                            case 'number':\r\n                                if (v.length < 5) {\r\n                                    data[p] = tuple(v);\r\n                                }\r\n                                break;\r\n                            case 'boolean':\r\n                                data[p] = enumerate(v, 'bool_');\r\n                                break;\r\n                            case 'string':\r\n                                data[p] = enumerate(v, 'texture_');\r\n                                break;\r\n                            case 'object':\r\n                                data[p] = enumerate(v, 'struct_');\r\n                                break;\r\n                        }\r\n                    } else if (v.length) {\r\n                        data[p] = v[0];\r\n                    }\r\n                } else if (v !== undefined && v !== null) {\r\n                    data[p] = v;\r\n                }\r\n            }\r\n            return data;\r\n        }\r\n\r\n        function get(obj) {\r\n            var data = {};\r\n            for (var p in obj) {\r\n                var v = obj[p];\r\n                switch (typeof v) {\r\n                    case 'function':\r\n                        break;\r\n                    case 'number':\r\n                    case 'boolean':\r\n                    case 'string':\r\n                        data[p] = v;\r\n                        break;\r\n                    default:\r\n                        var keys = Object.keys(v);\r\n                        data[p] = keys.map(getter(v));\r\n                        break;\r\n                }\r\n            }\r\n            // console.log('Parser.get', data);\r\n            return data;\r\n        }\r\n\r\n        /*\r\n        float                                   <--- typeof U === 'number'\r\n        bool                                    <--- typeof U === 'boolean'\r\n        sampler2D                               <--- typeof U === 'string'\r\n        Structure                               <--- typeof U === 'object'\r\n        ARRAYS of                               <--- Array.isArray(U)\r\n            number                              <--- typeof U[0] === 'number'\r\n                float                           <--- U.length === 1\r\n                vec2, vec3, vec4                <--- U.length > 1 && U.length < 5\r\n                float[]                         <--- U.length > 4\r\n            sampler2D[]                         <--- typeof U[0] === 'string'\r\n            vec2[], vec3[], vec4[]              <--- Array.isArray(U[0]) && typeof U[0][0] === 'number'\r\n            Structure[]                         <--- typeof U[0] === 'object'\r\n        \r\n            TODO: assume matrix for (typeof == Float32Array && length == 16)\r\n        TODO: support other non-float types? (int, etc.)\r\n        */\r\n\r\n        return Parser;\r\n\r\n    }();\r\n\r\n    var GuiService = function () {\r\n\r\n        function GuiService(callback) {\r\n            this.closed = true;\r\n            this.hidden = true;\r\n            this.callback = callback || function () {\r\n                console.log('GuiService.onChange');\r\n            };\r\n            this.pool = {};\r\n        }\r\n\r\n        GuiService.prototype = {\r\n            load: load,\r\n            hide: hide,\r\n            show: show,\r\n            uniforms: uniforms,\r\n        };\r\n\r\n        // statics\r\n\r\n        function differs(a, b) {\r\n            // console.log('differs', JSON.stringify(a), JSON.stringify(b));\r\n            return JSON.stringify(a) !== JSON.stringify(b);\r\n        }\r\n\r\n        function copy(obj) {\r\n            return JSON.parse(JSON.stringify(obj));\r\n        }\r\n\r\n        function merge(a, b) {\r\n            function _merge(a, b) {\r\n                for (var key in a) {\r\n                    if (b.hasOwnProperty(key)) {\r\n                        if (typeof a[key] === 'number') {\r\n                            a[key] = b[key];\r\n                        } else if (typeof a[key] == 'object' && Object.keys(a[key]).length > 0) {\r\n                            _merge(a[key], b[key]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (a) {\r\n                a = copy(a);\r\n\r\n                _merge(a, b);\r\n            }\r\n            return a;\r\n        }\r\n\r\n        function loop(obj, params, callback) {\r\n            var keys = [],\r\n                p;\r\n            for (p in params) {\r\n                keys.push(p);\r\n            }\r\n            keys.filter(function (key) {\r\n                var value = params[key];\r\n                if (typeof value === 'number') {\r\n                    p = obj.add(params, key, 0.0, 1.0);\r\n                    p.onChange(callback);\r\n                } else if (typeof value === 'object' && Object.keys(value).length > 0) {\r\n                    p = null;\r\n                    var folder = obj.addFolder(key);\r\n                    loop(folder, value, callback);\r\n                } else {\r\n                    p = obj.add(params, key);\r\n                    p.onChange(callback);\r\n                }\r\n            });\r\n        }\r\n\r\n        function randomize(obj, params, callback) {\r\n\r\n            function _randomize(obj, params) {\r\n                obj.__controllers.filter(function (c) {\r\n                    if (typeof c.initialValue === 'number' && typeof c.__min === 'number' && typeof c.__max === 'number') {\r\n                        var value = c.__min + (c.__max - c.__min) * Math.random();\r\n                        params[c.property] = value;\r\n                        c.updateDisplay();\r\n                    }\r\n                });\r\n                for (var f in obj.__folders) {\r\n                    _randomize(obj.__folders[f], params[f]);\r\n                }\r\n            }\r\n            _randomize(obj, params);\r\n            callback();\r\n        }\r\n\r\n        // publics\r\n\r\n        function load(params) {\r\n            var service = this;\r\n            var gui = service.gui;\r\n            var locals = service.locals;\r\n            var changed = differs(params, locals);\r\n            if (gui && changed) {\r\n                service.closed = gui.closed;\r\n                gui.destroy();\r\n                gui = null;\r\n            }\r\n            if (!gui) {\r\n                gui = new dat.GUI();\r\n                gui.closed = service.closed;\r\n                service.gui = gui;\r\n                if (service.hidden) {\r\n                    service.hide();\r\n                } else {\r\n                    service.show();\r\n                }\r\n            }\r\n            if (changed) {\r\n                locals = copy(params);\r\n                service.locals = locals;\r\n                var pool = Parser.set(params);\r\n                pool = merge(pool, service.pool);\r\n                service.pool = pool;\r\n                var _callback = function () {\r\n                    service.callback(pool);\r\n                };\r\n                loop(gui, pool, _callback);\r\n                pool.randomize = function () {\r\n                    randomize(gui, pool, _callback);\r\n                };\r\n                gui.add(pool, 'randomize');\r\n            }\r\n        }\r\n\r\n        function hide() {\r\n            var service = this;\r\n            service.hidden = true;\r\n            var gui = service.gui;\r\n            if (gui) {\r\n                gui.domElement.style.display = 'none';\r\n                // dat.GUI.toggleHide();\r\n            }\r\n        }\r\n\r\n        function show() {\r\n            var service = this;\r\n            var locals = service.locals;\r\n            var gui = service.gui;\r\n            if (gui && Object.keys(locals).length) {\r\n                gui.domElement.style.display = '';\r\n            }\r\n            service.hidden = false;\r\n        }\r\n\r\n        function uniforms() {\r\n            var service = this;\r\n            var pool = service.pool;\r\n            return Parser.get(pool);\r\n        }\r\n\r\n        return GuiService;\r\n    }();\r\n\r\n    window.GuiService = GuiService;\r\n\r\n}());\n/* global window, document, console */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    var TrailsService = function () {\r\n\r\n        function TrailsService() {\r\n            var service = this;\r\n            service.mouse = new Float32Array([0.0, 0.0]);\r\n            service.history = [];\r\n            service.trails = new Array(10).fill(null).map(function () {\r\n                return new Float32Array([0.0, 0.0]);\r\n            });\r\n        }\r\n\r\n        TrailsService.prototype = {\r\n            render: render,\r\n            move: move,\r\n            push: throttle(_push, 1000 / 60),\r\n            update: update,\r\n        };\r\n\r\n        // statics\r\n\r\n        var getNow = Date.now || function () {\r\n            return new Date().getTime();\r\n        };\r\n\r\n        function throttle(func, wait, options) {\r\n            // Returns a function, that, when invoked, will only be triggered at most once\r\n            // during a given window of time. Normally, the throttled function will run\r\n            // as much as it can, without ever going more than once per `wait` duration;\r\n            // but if you'd like to disable the execution on the leading edge, pass\r\n            // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n            var context, args, result;\r\n            var timeout = null;\r\n            var previous = 0;\r\n            if (!options) options = {};\r\n            var later = function () {\r\n                previous = options.leading === false ? 0 : getNow();\r\n                timeout = null;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            };\r\n            return function () {\r\n                var now = getNow();\r\n                if (!previous && options.leading === false) previous = now;\r\n                var remaining = wait - (now - previous);\r\n                context = this;\r\n                args = arguments;\r\n                if (remaining <= 0 || remaining > wait) {\r\n                    if (timeout) {\r\n                        clearTimeout(timeout);\r\n                        timeout = null;\r\n                    }\r\n                    previous = now;\r\n                    result = func.apply(context, args);\r\n                    if (!timeout) context = args = null;\r\n                } else if (!timeout && options.trailing !== false) {\r\n                    timeout = setTimeout(later, remaining);\r\n                }\r\n                return result;\r\n            };\r\n        }\r\n\r\n        // publics\r\n\r\n        var ti = 0;\r\n\r\n        function render(glsl) {\r\n            var service = this;\r\n            var trails = service.trails,\r\n                history = service.history,\r\n                mouse = service.mouse;\r\n\r\n            var i = 0,\r\n                t = trails.length;\r\n            var tx = history.length ? history[0] : mouse;\r\n            while (i < t) {\r\n                var e = (i > 0 ? trails[i - 1] : tx);\r\n                var v = trails[i];\r\n                var friction = 1.0 / (5.0 + i);\r\n                v[0] += (e[0] - v[0]) * friction;\r\n                v[1] += (e[1] - v[1]) * friction;\r\n                service.update(glsl, '2fv', 'vec2', 'u_trails[' + i + ']', v);\r\n                i++;\r\n            }\r\n            if (history.length) {\r\n                history.shift();\r\n            }\r\n        }\r\n\r\n        function move(x, y) {\r\n            var service = this,\r\n                mouse = service.mouse;\r\n            mouse[0] = x;\r\n            mouse[1] = y;\r\n            service.push();\r\n        }\r\n\r\n        function _push() {\r\n            var service = this;\r\n            service.history.push(new Float32Array(service.mouse));\r\n        }\r\n\r\n        function update(glsl, method, type, name, value) {\r\n            try {\r\n                var u = glsl.uniforms[name] = glsl.uniforms[name] || {};\r\n                u.name = name;\r\n                u.value = value;\r\n                u.type = type;\r\n                u.method = 'uniform' + method;\r\n                u.location = glsl.gl.getUniformLocation(glsl.program, name);\r\n                glsl.gl[u.method].apply(glsl.gl, [u.location].concat(u.value));\r\n            } catch (e) {\r\n                console.log('fastUpdate', e);\r\n            }\r\n        }\r\n\r\n        return TrailsService;\r\n    }();\r\n\r\n    window.TrailsService = TrailsService;\r\n\r\n}());\n/* global window, document, console, GlslCanvas, CaptureService, GuiService, TrailsService, CameraService, Stats, dat */\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    function onLoad() {\r\n        var stats, statsdom;\r\n\r\n        var content = document.querySelector('.content');\r\n        var canvas = document.querySelector('.shader');\r\n        var buttons = {\r\n            pause: document.querySelector('.btn-pause'),\r\n            record: document.querySelector('.btn-record'),\r\n            stats: document.querySelector('.btn-stats'),\r\n            create: document.querySelector('.btn-create'),\r\n        };\r\n        var flags = {\r\n            toggle: false,\r\n            record: false,\r\n            stats: false,\r\n        };\r\n\r\n        resize(true);\r\n\r\n        var glsl = new GlslCanvas(canvas, {\r\n            premultipliedAlpha: false,\r\n            preserveDrawingBuffer: true,\r\n            backgroundColor: 'rgba(1,1,1,1)',\r\n        });\r\n        glsl.on('error', onGlslError);\r\n\r\n        var capture = new CaptureService();\r\n        capture.set(canvas);\r\n\r\n        var camera = new CameraService();\r\n\r\n        var trails = new TrailsService();\r\n\r\n        glsl.on('render', function () {\r\n            capture.snapshotRender();\r\n            camera.render(glsl);\r\n            trails.render(glsl);\r\n            glsl.forceRender = true;\r\n        });\r\n\r\n        function onUpdateUniforms(params) {\r\n            var uniforms = gui.uniforms();\r\n            // console.log('GuiService.onUpdate', uniforms);\r\n            // uniforms.u_trails = trails;\r\n            // uniforms.u_trail_0 = trails[0];\r\n            glsl.setUniforms(uniforms);\r\n            // console.log('onUpdateUniforms', uniforms);\r\n        }\r\n\r\n        var gui = new GuiService(onUpdateUniforms);\r\n\r\n        load();\r\n\r\n        function load() {\r\n            document.querySelector('.errors').setAttribute('class', 'errors');\r\n            document.querySelector('.welcome').setAttribute('class', (options.uri ? 'welcome' : 'welcome active'));\r\n            var o = window.options;\r\n            o.vertex = o.vertex.trim().length > 0 ? o.vertex : null;\r\n            o.fragment = o.fragment.trim().length > 0 ? o.fragment : null;\r\n            if (o.fragment || o.vertex) {\r\n                document.querySelector('body').setAttribute('class', 'ready');\r\n            } else {\r\n                document.querySelector('body').setAttribute('class', 'empty');\r\n                removeStats();\r\n            }\r\n            glsl.load(o.fragment, o.vertex);\r\n            for (var t in o.textures) {\r\n                glsl.uniformTexture('u_texture_' + t, o.textures[t], {\r\n                    filtering: 'mipmap',\r\n                    repeat: true,\r\n                });\r\n            }\r\n            gui.load(o.uniforms);\r\n            glsl.setUniforms(gui.uniforms());\r\n        }\r\n\r\n        function resize(init) {\r\n            var w = content.offsetWidth;\r\n            var h = content.offsetHeight;\r\n            canvas.style.width = w + 'px';\r\n            canvas.style.height = h + 'px';\r\n            if (init) {\r\n                canvas.width = w;\r\n                canvas.height = h;\r\n            } else {\r\n                glsl.resize();\r\n            }\r\n        }\r\n\r\n        function snapshot() {\r\n            glsl.forceRender = true;\r\n            glsl.render();\r\n            return capture.snapshot();\r\n        }\r\n\r\n        function record() {\r\n            glsl.forceRender = true;\r\n            glsl.render();\r\n            if (capture.record()) {\r\n                // flags.record = true;\r\n            }\r\n        }\r\n\r\n        function stop() {\r\n            capture.stop().then(function (video) {\r\n                // console.log('capture.stop');\r\n                // var filename = options.uri.path.split('/').pop().replace('.glsl', '');\r\n                // console.log('filename', filename);\r\n                var url = URL.createObjectURL(video.blob);\r\n                var link = document.createElement('a');\r\n                link.href = url;\r\n                link.download = 'shader' + video.extension;\r\n                link.click();\r\n                setTimeout(function () {\r\n                    window.URL.revokeObjectURL(output);\r\n                }, 100);\r\n            });\r\n        }\r\n\r\n        function togglePause() {\r\n            flags.pause = !flags.pause;\r\n            // console.log('pause', flags.pause);\r\n            if (glsl.paused) {\r\n                if (glsl.timePause) {\r\n                    glsl.timePrev = new Date();\r\n                    glsl.timeLoad += (glsl.timePrev - glsl.timePause);\r\n                }\r\n                glsl.play();\r\n                buttons.pause.querySelector('i').setAttribute('class', 'icon-pause');\r\n            } else {\r\n                glsl.pause();\r\n                glsl.timePause = new Date();\r\n                buttons.pause.querySelector('i').setAttribute('class', 'icon-play');\r\n            }\r\n        }\r\n\r\n        function toggleRecord() {\r\n            flags.record = !flags.record;\r\n            // console.log('record', flags.record);\r\n            if (flags.record) {\r\n                buttons.record.setAttribute('class', 'btn btn-record active');\r\n                buttons.record.querySelector('i').setAttribute('class', 'icon-stop');\r\n                record();\r\n            } else {\r\n                buttons.record.setAttribute('class', 'btn btn-record');\r\n                buttons.record.querySelector('i').setAttribute('class', 'icon-record');\r\n                stop();\r\n            }\r\n        }\r\n\r\n        function toggleStats() {\r\n            flags.stats = !flags.stats;\r\n\r\n            function statsTick() {\r\n                stats.update();\r\n                if (flags.stats) {\r\n                    requestAnimationFrame(statsTick);\r\n                }\r\n            }\r\n            if (flags.stats) {\r\n                if (!statsdom) {\r\n                    stats = new Stats();\r\n                    stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n                    statsdom = stats.dom;\r\n                    statsdom.setAttribute('class', 'stats');\r\n                    // statsdom.style.cssText = 'position:fixed;top:0;right:0;cursor:pointer;opacity:0.9;z-index:10000';\r\n                    document.body.appendChild(stats.dom);\r\n                } else {\r\n                    statsdom.style.visibility = 'visible';\r\n                }\r\n                requestAnimationFrame(statsTick);\r\n                gui.show();\r\n                buttons.stats.setAttribute('class', 'btn btn-stats active');\r\n            } else {\r\n                removeStats();\r\n            }\r\n        }\r\n\r\n        function removeStats() {\r\n            if (statsdom) {\r\n                statsdom.style.visibility = 'hidden';\r\n            }\r\n            gui.hide();\r\n            buttons.stats.setAttribute('class', 'btn btn-stats');\r\n            flags.stats = false;\r\n        }\r\n\r\n        function createShader(e) {\r\n            // console.log('createShader', e);\r\n            window.parent.postMessage({\r\n                command: \"did-click-link\",\r\n                data: 'command:glsl-canvas.createShader?' + JSON.stringify([options.uri]),\r\n            }, \"file://\");\r\n        }\r\n\r\n        function onMessage(event) {\r\n            window.options = JSON.parse(event.data);\r\n            // console.log('onMessage', window.options);\r\n            // event.source.postMessage('message', event.origin);\r\n            load();\r\n        }\r\n\r\n        var ri;\r\n\r\n        function onResize() {\r\n            if (ri) {\r\n                clearTimeout(ri);\r\n            }\r\n            ri = setTimeout(resize, 50);\r\n        }\r\n\r\n        var ui;\r\n\r\n        function updateUniforms(e) {\r\n            if (ui) {\r\n                clearTimeout(ui);\r\n            }\r\n            ui = setTimeout(function () {\r\n                onUpdateUniforms();\r\n            }, 1000 / 25);\r\n        }\r\n\r\n        function onDown(e) {\r\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\r\n            camera.down(e.x / min, e.y / min);\r\n        }\r\n\r\n        function onMove(e) {\r\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\r\n            camera.move(e.x / min, e.y / min);\r\n            trails.move(e.x, content.offsetHeight - e.y);\r\n        }\r\n\r\n        function onUp(e) {\r\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\r\n            camera.up(e.x / min, e.y / min);\r\n        }\r\n\r\n        function onWheel(e) {\r\n            camera.wheel(e.wheelDelta / Math.abs(e.wheelDelta));\r\n        }\r\n\r\n        canvas.addEventListener(\"dblclick\", togglePause);\r\n        canvas.addEventListener('mousedown', onDown);\r\n        canvas.addEventListener('mousemove', onMove);\r\n        window.addEventListener('mouseup', onUp);\r\n        window.addEventListener('mousewheel', onWheel);\r\n        buttons.pause.addEventListener('mousedown', togglePause);\r\n        buttons.record.addEventListener('mousedown', toggleRecord);\r\n        buttons.stats.addEventListener('mousedown', toggleStats);\r\n        buttons.create.addEventListener('click', createShader);\r\n        window.addEventListener(\"message\", onMessage, false);\r\n        window.addEventListener('resize', onResize);\r\n\r\n        resize();\r\n    }\r\n\r\n    function onGlslError(message) {\r\n        // console.log('onGlslError.error', message.error);\r\n        var options = window.options;\r\n        var errors = [],\r\n            warnings = [];\r\n        message.error.replace(/ERROR: \\d+:(\\d+): \\'(.+)\\' : (.+)/g, function (m, l, v, t) {\r\n            var message = 'ERROR (' + v + ') ' + t;\r\n            var li = '<li><a class=\"error\" unselectable href=\"' + encodeURI('command:glsl-canvas.revealGlslLine?' + JSON.stringify([options.uri, Number(l), message])) + '\"><span class=\"line\">ERROR line ' + Number(l) + '</span> <span class=\"value\" title=\"' + v + '\">' + v + '</span> <span class=\"text\" title=\"' + t + '\">' + t + '</span></a></li>';\r\n            errors.push(li);\r\n            return li;\r\n        });\r\n        message.error.replace(/WARNING: \\d+:(\\d+): \\'(.*\\n*|.*|\\n*)\\' : (.+)/g, function (m, l, v, t) {\r\n            var li = '<li><a class=\"warning\" unselectable href=\"' + encodeURI('command:glsl-canvas.revealGlslLine?' + JSON.stringify([options.uri, Number(l), message])) + '\"><span class=\"line\">WARN line ' + Number(l) + '</span> <span class=\"text\" title=\"' + t + '\">' + t + '</span></a></li>';\r\n            warnings.push(li);\r\n            return li;\r\n        });\r\n        var output = '<div class=\"errors-content\"><p>glslCanvas error</p><ul>';\r\n        output += errors.join('\\n');\r\n        output += warnings.join('\\n');\r\n        output += '</ul></div>';\r\n        document.querySelector('.errors').setAttribute('class', 'errors active');\r\n        document.querySelector('.errors').innerHTML = output;\r\n        document.querySelector('body').setAttribute('class', 'idle');\r\n    }\r\n\r\n    window.addEventListener('load', onLoad);\r\n\r\n}());"],"sourceRoot":"/source/"}