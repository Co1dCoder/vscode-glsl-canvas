{"version":3,"sources":["resources/js/app.js"],"names":["Vector","x","y","z","this","prototype","negative","add","v","subtract","multiply","divide","equals","dot","cross","length","Math","sqrt","unit","min","max","toAngles","theta","atan2","phi","asin","angleTo","a","acos","toArray","n","slice","clone","init","b","c","fromAngles","cos","sin","randomDirection","random","PI","lerp","fraction","fromArray","angleBetween","window","CameraService","RAD","radius","down","mouse","move","up","wheel","d","render","glsl","vector","toVector","array","Float32Array","update","method","type","name","value","u","uniforms","location","gl","getUniformLocation","program","apply","concat","e","console","log","fromVector","atan","camera","spr","CaptureService","set","canvas","snapshot","service","queue","promise","Promise","resolve","reject","snapshotRender","url","toDataURL","bytes","atob","buffer","Uint8Array","i","charCodeAt","blob","Blob","extension","record","MediaRecorder","captureStream","capture","chunks","stream","options","mimeType","recorder","ondataavailable","data","size","push","tracks","getTracks","forEach","track","stop","removeTrack","start","Parser","tuple","keys","2","3","4","r","filter","enumerate","prefix","getter","key","obj","p","Array","isArray","get","Object","map","GuiService","callback","closed","hidden","pool","copy","JSON","parse","stringify","load","params","gui","locals","changed","destroy","dat","GUI","hide","show","_merge","hasOwnProperty","merge","_callback","loop","onChange","folder","addFolder","randomize","_randomize","f","__controllers","initialValue","__min","__max","property","updateDisplay","__folders","domElement","style","display","TrailsService","history","trails","fill","t","tx","friction","shift","func","wait","context","args","result","timeout","previous","later","leading","getNow","now","remaining","arguments","clearTimeout","trailing","setTimeout","throttle","Date","getTime","onGlslError","message","errors","warnings","error","replace","m","l","li","encodeURI","uri","Number","output","join","document","querySelector","setAttribute","innerHTML","addEventListener","stats","statsdom","content","buttons","pause","create","flags","toggle","resize","GlslCanvas","premultipliedAlpha","preserveDrawingBuffer","backgroundColor","on","ri","onUpdateUniforms","togglePause","offsetWidth","offsetHeight","wheelDelta","abs","forceRender","then","video","URL","createObjectURL","link","createElement","href","download","click","revokeObjectURL","visibility","Stats","showPanel","dom","body","appendChild","requestAnimationFrame","statsTick","removeStats","parent","postMessage","command","event","setUniforms","o","vertex","trim","fragment","textures","uniformTexture","filtering","repeat","w","h","width","height","paused","timePause","timePrev","timeLoad","play"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n    'use strict';\n\n    var Vector = function () {\n\n        function Vector(x, y, z) {\n            this.x = x || 0;\n            this.y = y || 0;\n            this.z = z || 0;\n        }\n\n        // Instance Methods\n        // The methods add(), subtract(), multiply(), and divide() can all take either a vector or a number as an argument.\n\n        Vector.prototype = {\n            negative: function () {\n                return new Vector(-this.x, -this.y, -this.z);\n            },\n            add: function (v) {\n                if (v instanceof Vector) return new Vector(this.x + v.x, this.y + v.y, this.z + v.z);\n                else return new Vector(this.x + v, this.y + v, this.z + v);\n            },\n            subtract: function (v) {\n                if (v instanceof Vector) return new Vector(this.x - v.x, this.y - v.y, this.z - v.z);\n                else return new Vector(this.x - v, this.y - v, this.z - v);\n            },\n            multiply: function (v) {\n                if (v instanceof Vector) return new Vector(this.x * v.x, this.y * v.y, this.z * v.z);\n                else return new Vector(this.x * v, this.y * v, this.z * v);\n            },\n            divide: function (v) {\n                if (v instanceof Vector) return new Vector(this.x / v.x, this.y / v.y, this.z / v.z);\n                else return new Vector(this.x / v, this.y / v, this.z / v);\n            },\n            equals: function (v) {\n                return this.x === v.x && this.y === v.y && this.z === v.z;\n            },\n            dot: function (v) {\n                return this.x * v.x + this.y * v.y + this.z * v.z;\n            },\n            cross: function (v) {\n                return new Vector(\n                    this.y * v.z - this.z * v.y,\n                    this.z * v.x - this.x * v.z,\n                    this.x * v.y - this.y * v.x\n                );\n            },\n            length: function () {\n                return Math.sqrt(this.dot(this));\n            },\n            unit: function () {\n                return this.divide(this.length());\n            },\n            min: function () {\n                return Math.min(Math.min(this.x, this.y), this.z);\n            },\n            max: function () {\n                return Math.max(Math.max(this.x, this.y), this.z);\n            },\n            toAngles: function () {\n                return {\n                    theta: Math.atan2(this.z, this.x),\n                    phi: Math.asin(this.y / this.length())\n                };\n            },\n            angleTo: function (a) {\n                return Math.acos(this.dot(a) / (this.length() * a.length()));\n            },\n            toArray: function (n) {\n                return [this.x, this.y, this.z].slice(0, n || 3);\n            },\n            clone: function () {\n                return new Vector(this.x, this.y, this.z);\n            },\n            init: function (x, y, z) {\n                this.x = x;\n                this.y = y;\n                this.z = z;\n                return this;\n            }\n        };\n\n        // Static Methods\n        // Vector.randomDirection() returns a vector with a length of 1 and a statistically uniform direction. Vector.lerp() performs linear interpolation between two vectors.\n\n        Vector.negative = function (a, b) {\n            b.x = -a.x;\n            b.y = -a.y;\n            b.z = -a.z;\n            return b;\n        };\n        Vector.add = function (a, b, c) {\n            if (b instanceof Vector) {\n                c.x = a.x + b.x;\n                c.y = a.y + b.y;\n                c.z = a.z + b.z;\n            } else {\n                c.x = a.x + b;\n                c.y = a.y + b;\n                c.z = a.z + b;\n            }\n            return c;\n        };\n        Vector.subtract = function (a, b, c) {\n            if (b instanceof Vector) {\n                c.x = a.x - b.x;\n                c.y = a.y - b.y;\n                c.z = a.z - b.z;\n            } else {\n                c.x = a.x - b;\n                c.y = a.y - b;\n                c.z = a.z - b;\n            }\n            return c;\n        };\n        Vector.multiply = function (a, b, c) {\n            if (b instanceof Vector) {\n                c.x = a.x * b.x;\n                c.y = a.y * b.y;\n                c.z = a.z * b.z;\n            } else {\n                c.x = a.x * b;\n                c.y = a.y * b;\n                c.z = a.z * b;\n            }\n            return c;\n        };\n        Vector.divide = function (a, b, c) {\n            if (b instanceof Vector) {\n                c.x = a.x / b.x;\n                c.y = a.y / b.y;\n                c.z = a.z / b.z;\n            } else {\n                c.x = a.x / b;\n                c.y = a.y / b;\n                c.z = a.z / b;\n            }\n            return c;\n        };\n        Vector.cross = function (a, b, c) {\n            c.x = a.y * b.z - a.z * b.y;\n            c.y = a.z * b.x - a.x * b.z;\n            c.z = a.x * b.y - a.y * b.x;\n            return c;\n        };\n        Vector.unit = function (a, b) {\n            var length = a.length();\n            b.x = a.x / length;\n            b.y = a.y / length;\n            b.z = a.z / length;\n            return b;\n        };\n        Vector.fromAngles = function (theta, phi) {\n            return new Vector(Math.cos(theta) * Math.cos(phi), Math.sin(phi), Math.sin(theta) * Math.cos(phi));\n        };\n        Vector.randomDirection = function () {\n            return Vector.fromAngles(Math.random() * Math.PI * 2, Math.asin(Math.random() * 2 - 1));\n        };\n        Vector.min = function (a, b) {\n            return new Vector(Math.min(a.x, b.x), Math.min(a.y, b.y), Math.min(a.z, b.z));\n        };\n        Vector.max = function (a, b) {\n            return new Vector(Math.max(a.x, b.x), Math.max(a.y, b.y), Math.max(a.z, b.z));\n        };\n        Vector.lerp = function (a, b, fraction) {\n            return b.subtract(a).multiply(fraction).add(a);\n        };\n        Vector.fromArray = function (a) {\n            return new Vector(a[0], a[1], a[2]);\n        };\n        Vector.angleBetween = function (a, b) {\n            return a.angleTo(b);\n        };\n\n        return Vector;\n    }();\n\n    window.Vector = Vector;\n\n}());\n/* global window, console, Vector */\n\n(function () {\n    'use strict';\n\n    var CameraService = function () {\n\n        var PI = Math.PI;\n        var RAD = PI / 180;\n\n        function CameraService(theta, phi, radius) {\n            var service = this;\n            service.theta = (theta || 45) * RAD;\n            service.phi = (phi || 45) * RAD;\n            service.radius = radius || 1.0;\n        }\n\n        CameraService.prototype = {\n            down: down,\n            move: move,\n            up: up,\n            wheel: wheel,\n            render: render,\n            update: update,\n        };\n\n        CameraService.fromVector = fromVector;\n        CameraService.toVector = toVector;\n\n        // publics\n\n        function down(x, y) {\n            var service = this;\n            service.mouse = {\n                x: x,\n                y: y,\n            };\n        }\n\n        function move(x, y) {\n            var service = this,\n                mouse = service.mouse;\n            if (mouse) {\n                var theta = (x - mouse.x) * 180 * RAD;\n                var phi = (mouse.y - y) * 180 * RAD;\n                mouse.x = x;\n                mouse.y = y;\n                service.theta += theta;\n                service.phi += phi;\n            }\n        }\n\n        function up(x, y) {\n            var service = this;\n            service.mouse = null;\n        }\n\n        function wheel(d) {\n            var service = this;\n            service.radius = Math.max(0.01, service.radius + d * 0.02);\n        }\n\n        function render(glsl) {\n            var service = this;\n            var vector = CameraService.toVector(service);\n            var array = new Float32Array([vector.x, vector.y, vector.z]);\n            service.update(glsl, '3fv', 'vec3', 'u_camera', array);\n        }\n\n        function update(glsl, method, type, name, value) {\n            try {\n                var u = glsl.uniforms[name] = glsl.uniforms[name] || {};\n                u.name = name;\n                u.value = value;\n                u.type = type;\n                u.method = 'uniform' + method;\n                u.location = glsl.gl.getUniformLocation(glsl.program, name);\n                glsl.gl[u.method].apply(glsl.gl, [u.location].concat(u.value));\n            } catch (e) {\n                console.log('fastUpdate', e);\n            }\n        }\n\n        // statics\n\n        function fromVector(vector) {\n            var radius = vector.length();\n            var theta = Math.acos(vector.y / radius); //theta\n            var phi = Math.atan(vector.x / vector.z); //phi\n            return new CameraService(theta, phi, radius);\n        }\n\n        function toVector(camera) {\n            var spr = Math.sin(camera.phi) * camera.radius;\n            var x = spr * Math.sin(camera.theta);\n            var y = Math.cos(camera.phi) * camera.radius;\n            var z = spr * Math.cos(camera.theta);\n            return new Vector(x, y, z);\n        }\n\n        return CameraService;\n\n    }();\n\n    window.CameraService = CameraService;\n\n}());\n/* global window, document, console, GlslCanvas */\n/* \nAuthor: Brett Camper (@professorlemeza)\nURL: https://github.com/tangrams/tangram/blob/master/src/utils/media_capture.js\n*/\n\n(function () {\n    'use strict';\n\n    function CaptureService() {}\n\n    CaptureService.prototype = {\n        set: set,\n        snapshot: snapshot,\n        snapshotRender: snapshotRender,\n        record: record,\n        stop: stop,\n    };\n\n    function set(canvas) {\n        var service = this;\n        service.canvas = canvas;\n    }\n\n    /*\n    var mimeTypes = [\n        'video/webm\\;codecs=h264',\n        'video/webm\\;codecs=vp8',\n        'video/webm\\;codecs=daala',\n        'video/webm',\n        'audio/webm\\;codecs=opus',\n        'audio/webm',\n        'video/mpeg',\n    ];\n    var options = {\n        videoBitsPerSecond: 2500000,\n        audioBitsPerSecond: 128000,\n        mimeType: 'video/webm',\n        extension: '.webm',\n    };\n    // MediaRecorder.isTypeSupported(mimeTypes[0])\n    */\n\n    function record() {\n        var service = this;\n        if (typeof window.MediaRecorder !== 'function' || !service.canvas || typeof service.canvas.captureStream !== 'function') {\n            console.log('warn: Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser');\n            return false;\n        } else if (service.capture) {\n            console.log('warn: Video capture already in progress, call Scene.stopVideoCapture() first');\n            return false;\n        }\n        try {\n            var capture = {};\n            var chunks = [];\n            var stream = service.canvas.captureStream();\n            var options = {\n                mimeType: 'video/webm', // 'video/webm\\;codecs=h264'\n            };\n            var recorder = new MediaRecorder(stream, options);\n            recorder.ondataavailable = function (e) {\n                if (e.data.size > 0) {\n                    chunks.push(e.data);\n                }\n                // Stopped recording? Create the final capture file blob\n                if (capture.resolve) {\n                    var blob = new Blob(chunks, {\n                        type: options.mimeType,\n                    });\n                    if (stream) {\n                        var tracks = stream.getTracks() || [];\n                        tracks.forEach(function (track) {\n                            track.stop();\n                            stream.removeTrack(track);\n                        });\n                    }\n                    stream = null;\n                    service.recorder = null;\n                    service.capture = null;\n                    capture.resolve({\n                        blob: blob,\n                        extension: '.webm',\n                    });\n                }\n            };\n            service.capture = capture;\n            service.recorder = recorder;\n            recorder.start();\n        } catch (e) {\n            service.capture = null;\n            service.recorder = null;\n            console.log('error: Scene video capture failed', e);\n            return false;\n        }\n        return true;\n    }\n\n    function stop() {\n        var service = this;\n        if (!service.capture) {\n            console.log('warn: No scene video capture in progress, call Scene.startVideoCapture() first');\n            return Promise.resolve({});\n        }\n        service.capture.promise = new Promise(function (resolve, reject) {\n            service.capture.resolve = resolve;\n            service.capture.reject = reject;\n        });\n        service.recorder.stop();\n        return service.capture.promise;\n    }\n\n    function snapshot() {\n        var service = this;\n        if (service.queue) {\n            return service.queue.promise;\n        }\n        service.queue = {};\n        service.queue.promise = new Promise(function (resolve, reject) {\n            service.queue.resolve = resolve;\n            service.queue.reject = reject;\n        });\n        return service.queue.promise;\n    }\n\n    function snapshotRender() {\n        var service = this;\n        if (service.queue) {\n            // Get data URL, convert to blob\n            // Strip host/mimetype/etc., convert base64 to binary without UTF-8 mangling\n            // Adapted from: https://gist.github.com/unconed/4370822\n            var url = service.canvas.toDataURL('image/png');\n            var bytes = atob(url.slice(22));\n            var buffer = new Uint8Array(bytes.length);\n            for (var i = 0; i < bytes.length; ++i) {\n                buffer[i] = bytes.charCodeAt(i);\n            }\n            var blob = new Blob([buffer], {\n                type: 'image/png',\n            });\n            service.queue.resolve({\n                blob: blob,\n                extension: '.png',\n            });\n            service.queue = null;\n        }\n    }\n\n    window.CaptureService = CaptureService;\n}());\n/* global window, document, console */\n\n(function () {\n    'use strict';\n\n    var Parser = function () {\n\n        var Parser = {\n            set: set,\n            get: get,\n        };\n\n        function tuple(array) {\n            var tuples = {\n                2: ['x', 'y'],\n                3: ['x', 'y', 'z'],\n                4: ['r', 'g', 'b', 'a']\n            };\n            var keys = tuples[array.length];\n            var r = {};\n            array.filter(function (v, i) {\n                r[keys[i]] = v;\n            });\n            return r;\n        }\n\n        function enumerate(array, prefix) {\n            var r = {};\n            array.filter(function (v, i) {\n                r[prefix + i] = v;\n            });\n            return r;\n        }\n\n        function getter(v) {\n            return function (key) {\n                return v[key];\n            };\n        }\n\n        function set(obj) {\n            var data = {};\n            for (var p in obj) {\n                var v = obj[p];\n                if (Array.isArray(v)) {\n                    if (v.length > 1) {\n                        switch (typeof v[0]) {\n                            case 'number':\n                                if (v.length < 5) {\n                                    data[p] = tuple(v);\n                                }\n                                break;\n                            case 'boolean':\n                                data[p] = enumerate(v, 'bool_');\n                                break;\n                            case 'string':\n                                data[p] = enumerate(v, 'texture_');\n                                break;\n                            case 'object':\n                                data[p] = enumerate(v, 'struct_');\n                                break;\n                        }\n                    } else if (v.length) {\n                        data[p] = v[0];\n                    }\n                } else if (v !== undefined && v !== null) {\n                    data[p] = v;\n                }\n            }\n            return data;\n        }\n\n        function get(obj) {\n            var data = {};\n            for (var p in obj) {\n                var v = obj[p];\n                switch (typeof v) {\n                    case 'function':\n                        break;\n                    case 'number':\n                    case 'boolean':\n                    case 'string':\n                        data[p] = v;\n                        break;\n                    default:\n                        var keys = Object.keys(v);\n                        data[p] = keys.map(getter(v));\n                        break;\n                }\n            }\n            // console.log('Parser.get', data);\n            return data;\n        }\n\n        /*\n        float                                   <--- typeof U === 'number'\n        bool                                    <--- typeof U === 'boolean'\n        sampler2D                               <--- typeof U === 'string'\n        Structure                               <--- typeof U === 'object'\n        ARRAYS of                               <--- Array.isArray(U)\n            number                              <--- typeof U[0] === 'number'\n                float                           <--- U.length === 1\n                vec2, vec3, vec4                <--- U.length > 1 && U.length < 5\n                float[]                         <--- U.length > 4\n            sampler2D[]                         <--- typeof U[0] === 'string'\n            vec2[], vec3[], vec4[]              <--- Array.isArray(U[0]) && typeof U[0][0] === 'number'\n            Structure[]                         <--- typeof U[0] === 'object'\n        \n            TODO: assume matrix for (typeof == Float32Array && length == 16)\n        TODO: support other non-float types? (int, etc.)\n        */\n\n        return Parser;\n\n    }();\n\n    var GuiService = function () {\n\n        function GuiService(callback) {\n            this.closed = true;\n            this.hidden = true;\n            this.callback = callback || function () {\n                console.log('GuiService.onChange');\n            };\n            this.pool = {};\n        }\n\n        GuiService.prototype = {\n            load: load,\n            hide: hide,\n            show: show,\n            uniforms: uniforms,\n        };\n\n        // statics\n\n        function differs(a, b) {\n            // console.log('differs', JSON.stringify(a), JSON.stringify(b));\n            return JSON.stringify(a) !== JSON.stringify(b);\n        }\n\n        function copy(obj) {\n            return JSON.parse(JSON.stringify(obj));\n        }\n\n        function merge(a, b) {\n            function _merge(a, b) {\n                for (var key in a) {\n                    if (b.hasOwnProperty(key)) {\n                        if (typeof a[key] === 'number') {\n                            a[key] = b[key];\n                        } else if (typeof a[key] == 'object' && Object.keys(a[key]).length > 0) {\n                            _merge(a[key], b[key]);\n                        }\n                    }\n                }\n            }\n            if (a) {\n                a = copy(a);\n\n                _merge(a, b);\n            }\n            return a;\n        }\n\n        function loop(obj, params, callback) {\n            var keys = [],\n                p;\n            for (p in params) {\n                keys.push(p);\n            }\n            keys.filter(function (key) {\n                var value = params[key];\n                if (typeof value === 'number') {\n                    p = obj.add(params, key, 0.0, 1.0);\n                    p.onChange(callback);\n                } else if (typeof value === 'object' && Object.keys(value).length > 0) {\n                    p = null;\n                    var folder = obj.addFolder(key);\n                    loop(folder, value, callback);\n                } else {\n                    p = obj.add(params, key);\n                    p.onChange(callback);\n                }\n            });\n        }\n\n        function randomize(obj, params, callback) {\n\n            function _randomize(obj, params) {\n                obj.__controllers.filter(function (c) {\n                    if (typeof c.initialValue === 'number' && typeof c.__min === 'number' && typeof c.__max === 'number') {\n                        var value = c.__min + (c.__max - c.__min) * Math.random();\n                        params[c.property] = value;\n                        c.updateDisplay();\n                    }\n                });\n                for (var f in obj.__folders) {\n                    _randomize(obj.__folders[f], params[f]);\n                }\n            }\n            _randomize(obj, params);\n            callback();\n        }\n\n        // publics\n\n        function load(params) {\n            var service = this;\n            var gui = service.gui;\n            var locals = service.locals;\n            var changed = differs(params, locals);\n            if (gui && changed) {\n                service.closed = gui.closed;\n                gui.destroy();\n                gui = null;\n            }\n            if (!gui) {\n                gui = new dat.GUI();\n                gui.closed = service.closed;\n                service.gui = gui;\n                if (service.hidden) {\n                    service.hide();\n                } else {\n                    service.show();\n                }\n            }\n            if (changed) {\n                locals = copy(params);\n                service.locals = locals;\n                var pool = Parser.set(params);\n                pool = merge(pool, service.pool);\n                service.pool = pool;\n                var _callback = function () {\n                    service.callback(pool);\n                };\n                loop(gui, pool, _callback);\n                pool.randomize = function () {\n                    randomize(gui, pool, _callback);\n                };\n                gui.add(pool, 'randomize');\n            }\n        }\n\n        function hide() {\n            var service = this;\n            service.hidden = true;\n            var gui = service.gui;\n            if (gui) {\n                gui.domElement.style.display = 'none';\n                // dat.GUI.toggleHide();\n            }\n        }\n\n        function show() {\n            var service = this;\n            var locals = service.locals;\n            var gui = service.gui;\n            if (gui && Object.keys(locals).length) {\n                gui.domElement.style.display = '';\n            }\n            service.hidden = false;\n        }\n\n        function uniforms() {\n            var service = this;\n            var pool = service.pool;\n            return Parser.get(pool);\n        }\n\n        return GuiService;\n    }();\n\n    window.GuiService = GuiService;\n\n}());\n/* global window, document, console */\n\n(function () {\n    'use strict';\n\n    var TrailsService = function () {\n\n        function TrailsService() {\n            var service = this;\n            service.mouse = new Float32Array([0.0, 0.0]);\n            service.history = [];\n            service.trails = new Array(10).fill(null).map(function () {\n                return new Float32Array([0.0, 0.0]);\n            });\n        }\n\n        TrailsService.prototype = {\n            render: render,\n            move: move,\n            push: throttle(_push, 1000 / 60),\n            update: update,\n        };\n\n        // statics\n\n        var getNow = Date.now || function () {\n            return new Date().getTime();\n        };\n\n        function throttle(func, wait, options) {\n            // Returns a function, that, when invoked, will only be triggered at most once\n            // during a given window of time. Normally, the throttled function will run\n            // as much as it can, without ever going more than once per `wait` duration;\n            // but if you'd like to disable the execution on the leading edge, pass\n            // `{leading: false}`. To disable execution on the trailing edge, ditto.\n            var context, args, result;\n            var timeout = null;\n            var previous = 0;\n            if (!options) options = {};\n            var later = function () {\n                previous = options.leading === false ? 0 : getNow();\n                timeout = null;\n                result = func.apply(context, args);\n                if (!timeout) context = args = null;\n            };\n            return function () {\n                var now = getNow();\n                if (!previous && options.leading === false) previous = now;\n                var remaining = wait - (now - previous);\n                context = this;\n                args = arguments;\n                if (remaining <= 0 || remaining > wait) {\n                    if (timeout) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                    }\n                    previous = now;\n                    result = func.apply(context, args);\n                    if (!timeout) context = args = null;\n                } else if (!timeout && options.trailing !== false) {\n                    timeout = setTimeout(later, remaining);\n                }\n                return result;\n            };\n        }\n\n        // publics\n\n        var ti = 0;\n\n        function render(glsl) {\n            var service = this;\n            var trails = service.trails,\n                history = service.history,\n                mouse = service.mouse;\n\n            var i = 0,\n                t = trails.length;\n            var tx = history.length ? history[0] : mouse;\n            while (i < t) {\n                var e = (i > 0 ? trails[i - 1] : tx);\n                var v = trails[i];\n                var friction = 1.0 / (5.0 + i);\n                v[0] += (e[0] - v[0]) * friction;\n                v[1] += (e[1] - v[1]) * friction;\n                service.update(glsl, '2fv', 'vec2', 'u_trails[' + i + ']', v);\n                i++;\n            }\n            if (history.length) {\n                history.shift();\n            }\n        }\n\n        function move(x, y) {\n            var service = this,\n                mouse = service.mouse;\n            mouse[0] = x;\n            mouse[1] = y;\n            service.push();\n        }\n\n        function _push() {\n            var service = this;\n            service.history.push(new Float32Array(service.mouse));\n        }\n\n        function update(glsl, method, type, name, value) {\n            try {\n                var u = glsl.uniforms[name] = glsl.uniforms[name] || {};\n                u.name = name;\n                u.value = value;\n                u.type = type;\n                u.method = 'uniform' + method;\n                u.location = glsl.gl.getUniformLocation(glsl.program, name);\n                glsl.gl[u.method].apply(glsl.gl, [u.location].concat(u.value));\n            } catch (e) {\n                console.log('fastUpdate', e);\n            }\n        }\n\n        return TrailsService;\n    }();\n\n    window.TrailsService = TrailsService;\n\n}());\n/* global window, document, console, GlslCanvas, CaptureService, GuiService, TrailsService, CameraService, Stats, dat */\n\n(function () {\n    'use strict';\n\n    function onLoad() {\n        var stats, statsdom;\n\n        var content = document.querySelector('.content');\n        var canvas = document.querySelector('.shader');\n        var buttons = {\n            pause: document.querySelector('.btn-pause'),\n            record: document.querySelector('.btn-record'),\n            stats: document.querySelector('.btn-stats'),\n            create: document.querySelector('.btn-create'),\n        };\n        var flags = {\n            toggle: false,\n            record: false,\n            stats: false,\n        };\n\n        resize(true);\n\n        var glsl = new GlslCanvas(canvas, {\n            premultipliedAlpha: false,\n            preserveDrawingBuffer: true,\n            backgroundColor: 'rgba(1,1,1,1)',\n        });\n\n        if (!glsl.gl) {\n            document.querySelector('.missing').setAttribute('class', 'missing active');\n            return;\n        }\n\n        glsl.on('error', onGlslError);\n\n        var capture = new CaptureService();\n        capture.set(canvas);\n\n        var camera = new CameraService();\n\n        var trails = new TrailsService();\n\n        glsl.on('render', function () {\n            capture.snapshotRender();\n            camera.render(glsl);\n            trails.render(glsl);\n            // glsl.forceRender = true;\n        });\n\n        function onUpdateUniforms(params) {\n            var uniforms = gui.uniforms();\n            // console.log('GuiService.onUpdate', uniforms);\n            // uniforms.u_trails = trails;\n            // uniforms.u_trail_0 = trails[0];\n            glsl.setUniforms(uniforms);\n            // console.log('onUpdateUniforms', uniforms);\n        }\n\n        var gui = new GuiService(onUpdateUniforms);\n\n        load();\n\n        function load() {\n            document.querySelector('.errors').setAttribute('class', 'errors');\n            document.querySelector('.welcome').setAttribute('class', (options.uri ? 'welcome' : 'welcome active'));\n            var o = window.options;\n            o.vertex = o.vertex.trim().length > 0 ? o.vertex : null;\n            o.fragment = o.fragment.trim().length > 0 ? o.fragment : null;\n            if (o.fragment || o.vertex) {\n                document.querySelector('body').setAttribute('class', 'ready');\n            } else {\n                document.querySelector('body').setAttribute('class', 'empty');\n                removeStats();\n            }\n            glsl.load(o.fragment, o.vertex);\n            for (var t in o.textures) {\n                glsl.uniformTexture('u_texture_' + t, o.textures[t], {\n                    filtering: 'mipmap',\n                    repeat: true,\n                });\n            }\n            gui.load(o.uniforms);\n            glsl.setUniforms(gui.uniforms());\n        }\n\n        function resize(init) {\n            var w = content.offsetWidth;\n            var h = content.offsetHeight;\n            canvas.style.width = w + 'px';\n            canvas.style.height = h + 'px';\n            if (init) {\n                canvas.width = w;\n                canvas.height = h;\n            } else {\n                glsl.resize();\n            }\n        }\n\n        function snapshot() {\n            glsl.forceRender = true;\n            glsl.render();\n            return capture.snapshot();\n        }\n\n        function record() {\n            glsl.forceRender = true;\n            glsl.render();\n            if (capture.record()) {\n                // flags.record = true;\n            }\n        }\n\n        function stop() {\n            capture.stop().then(function (video) {\n                // console.log('capture.stop');\n                // var filename = options.uri.path.split('/').pop().replace('.glsl', '');\n                // console.log('filename', filename);\n                var url = URL.createObjectURL(video.blob);\n                var link = document.createElement('a');\n                link.href = url;\n                link.download = 'shader' + video.extension;\n                link.click();\n                setTimeout(function () {\n                    window.URL.revokeObjectURL(output);\n                }, 100);\n            });\n        }\n\n        function togglePause() {\n            flags.pause = !flags.pause;\n            // console.log('pause', flags.pause);\n            if (glsl.paused) {\n                if (glsl.timePause) {\n                    glsl.timePrev = new Date();\n                    glsl.timeLoad += (glsl.timePrev - glsl.timePause);\n                }\n                glsl.play();\n                buttons.pause.querySelector('i').setAttribute('class', 'icon-pause');\n            } else {\n                glsl.pause();\n                glsl.timePause = new Date();\n                buttons.pause.querySelector('i').setAttribute('class', 'icon-play');\n            }\n        }\n\n        function toggleRecord() {\n            flags.record = !flags.record;\n            // console.log('record', flags.record);\n            if (flags.record) {\n                buttons.record.setAttribute('class', 'btn btn-record active');\n                buttons.record.querySelector('i').setAttribute('class', 'icon-stop');\n                record();\n            } else {\n                buttons.record.setAttribute('class', 'btn btn-record');\n                buttons.record.querySelector('i').setAttribute('class', 'icon-record');\n                stop();\n            }\n        }\n\n        function toggleStats() {\n            flags.stats = !flags.stats;\n\n            function statsTick() {\n                stats.update();\n                if (flags.stats) {\n                    requestAnimationFrame(statsTick);\n                }\n            }\n            if (flags.stats) {\n                if (!statsdom) {\n                    stats = new Stats();\n                    stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\n                    statsdom = stats.dom;\n                    statsdom.setAttribute('class', 'stats');\n                    // statsdom.style.cssText = 'position:fixed;top:0;right:0;cursor:pointer;opacity:0.9;z-index:10000';\n                    document.body.appendChild(stats.dom);\n                } else {\n                    statsdom.style.visibility = 'visible';\n                }\n                requestAnimationFrame(statsTick);\n                gui.show();\n                buttons.stats.setAttribute('class', 'btn btn-stats active');\n            } else {\n                removeStats();\n            }\n        }\n\n        function removeStats() {\n            if (statsdom) {\n                statsdom.style.visibility = 'hidden';\n            }\n            gui.hide();\n            buttons.stats.setAttribute('class', 'btn btn-stats');\n            flags.stats = false;\n        }\n\n        function createShader(e) {\n            // console.log('createShader', e);\n            window.parent.postMessage({\n                command: \"did-click-link\",\n                data: 'command:glsl-canvas.createShader?' + JSON.stringify([options.uri]),\n            }, \"file://\");\n        }\n\n        function onMessage(event) {\n            window.options = JSON.parse(event.data);\n            // console.log('onMessage', window.options);\n            // event.source.postMessage('message', event.origin);\n            load();\n        }\n\n        var ri;\n\n        function onResize() {\n            if (ri) {\n                clearTimeout(ri);\n            }\n            ri = setTimeout(resize, 50);\n        }\n\n        var ui;\n\n        function updateUniforms(e) {\n            if (ui) {\n                clearTimeout(ui);\n            }\n            ui = setTimeout(function () {\n                onUpdateUniforms();\n            }, 1000 / 25);\n        }\n\n        function onDown(e) {\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\n            camera.down(e.x / min, e.y / min);\n        }\n\n        function onMove(e) {\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\n            camera.move(e.x / min, e.y / min);\n            trails.move(e.x, content.offsetHeight - e.y);\n        }\n\n        function onUp(e) {\n            var min = Math.min(content.offsetWidth, content.offsetHeight);\n            camera.up(e.x / min, e.y / min);\n        }\n\n        function onWheel(e) {\n            camera.wheel(e.wheelDelta / Math.abs(e.wheelDelta));\n        }\n\n        canvas.addEventListener(\"dblclick\", togglePause);\n        canvas.addEventListener('mousedown', onDown);\n        canvas.addEventListener('mousemove', onMove);\n        window.addEventListener('mouseup', onUp);\n        window.addEventListener('mousewheel', onWheel);\n        buttons.pause.addEventListener('mousedown', togglePause);\n        buttons.record.addEventListener('mousedown', toggleRecord);\n        buttons.stats.addEventListener('mousedown', toggleStats);\n        buttons.create.addEventListener('click', createShader);\n        window.addEventListener(\"message\", onMessage, false);\n        window.addEventListener('resize', onResize);\n\n        resize();\n    }\n\n    function onGlslError(message) {\n        // console.log('onGlslError.error', message.error);\n        var options = window.options;\n        var errors = [],\n            warnings = [];\n        message.error.replace(/ERROR: \\d+:(\\d+): \\'(.+)\\' : (.+)/g, function (m, l, v, t) {\n            var message = 'ERROR (' + v + ') ' + t;\n            var li = '<li><a class=\"error\" unselectable href=\"' + encodeURI('command:glsl-canvas.revealGlslLine?' + JSON.stringify([options.uri, Number(l), message])) + '\"><span class=\"line\">ERROR line ' + Number(l) + '</span> <span class=\"value\" title=\"' + v + '\">' + v + '</span> <span class=\"text\" title=\"' + t + '\">' + t + '</span></a></li>';\n            errors.push(li);\n            return li;\n        });\n        message.error.replace(/WARNING: \\d+:(\\d+): \\'(.*\\n*|.*|\\n*)\\' : (.+)/g, function (m, l, v, t) {\n            var li = '<li><a class=\"warning\" unselectable href=\"' + encodeURI('command:glsl-canvas.revealGlslLine?' + JSON.stringify([options.uri, Number(l), message])) + '\"><span class=\"line\">WARN line ' + Number(l) + '</span> <span class=\"text\" title=\"' + t + '\">' + t + '</span></a></li>';\n            warnings.push(li);\n            return li;\n        });\n        var output = '<div class=\"errors-content\"><p>glslCanvas error</p><ul>';\n        output += errors.join('\\n');\n        output += warnings.join('\\n');\n        output += '</ul></div>';\n        document.querySelector('.errors').setAttribute('class', 'errors active');\n        document.querySelector('.errors').innerHTML = output;\n        document.querySelector('body').setAttribute('class', 'idle');\n    }\n\n    window.addEventListener('load', onLoad);\n\n}());"]}