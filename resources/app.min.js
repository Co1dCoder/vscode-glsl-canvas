!function(){"use strict";function e(e){var t=window.options,r=[],n=[];e.error.replace(/ERROR: \d+:(\d+): \'(.+)\' : (.+)/g,function(e,n,s,o){var a="ERROR ("+s+") "+o,i='<li><a class="error" unselectable href="'+encodeURI("command:glsl-canvas.revealGlslLine?"+JSON.stringify([t.uri,Number(n),a]))+'"><span class="line">ERROR line '+Number(n)+'</span> <span class="value" title="'+s+'">'+s+'</span> <span class="text" title="'+o+'">'+o+"</span></a></li>";return r.push(i),i}),e.error.replace(/WARNING: \d+:(\d+): \'(.*\n*|.*|\n*)\' : (.+)/g,function(r,s,o,a){var i='<li><a class="warning" unselectable href="'+encodeURI("command:glsl-canvas.revealGlslLine?"+JSON.stringify([t.uri,Number(s),e]))+'"><span class="line">WARN line '+Number(s)+'</span> <span class="text" title="'+a+'">'+a+"</span></a></li>";return n.push(i),i});var s='<div class="errors-content"><p>glslCanvas error</p><ul>';s+=r.join("\n"),s+=n.join("\n"),s+="</ul></div>",document.querySelector(".errors").setAttribute("class","errors active"),document.querySelector(".errors").innerHTML=s}window.addEventListener("load",function(){var t,r,n=1,s=document.querySelector(".content"),o=document.querySelector(".shader"),a={pause:document.querySelector(".btn-pause"),record:document.querySelector(".btn-record"),stats:document.querySelector(".btn-stats"),create:document.querySelector(".btn-create")},i={toggle:!1,record:!1,stats:!1};d();var c=new GlslCanvas(o,{premultipliedAlpha:!1,preserveDrawingBuffer:!0,backgroundColor:"rgba(1,1,1,1)"});c.on("error",e);var u=new CaptureService;function l(){document.querySelector(".errors").setAttribute("class","errors"),document.querySelector(".welcome").setAttribute("class",options.uri?"welcome":"welcome active");var e=window.options;for(var t in e.vertex=e.vertex.trim().length>0?e.vertex:null,e.fragment=e.fragment.trim().length>0?e.fragment:null,c.load(e.fragment,e.vertex),e.uniforms)c.setUniform(t,e.uniforms[t]);for(var r in e.textures)c.setUniform("u_texture_"+r,e.textures[r]);document.querySelector("body").setAttribute("class",e.fragment||e.vertex?"ready":"empty")}function d(){var e=s.offsetWidth+n,t=s.offsetHeight+n;o.style.width=e+"px",o.style.height=t+"px",o.width=e,o.height=t,n=0}function m(){i.pause=!i.pause,c.paused?(c.timePause&&(c.timePrev=new Date,c.timeLoad+=c.timePrev-c.timePause),c.play(),a.pause.querySelector("i").setAttribute("class","icon-pause")):(c.pause(),c.timePause=new Date,a.pause.querySelector("i").setAttribute("class","icon-play"))}u.set(o),c.on("render",function(){u.snapshotRender()}),l(),document.addEventListener("dblclick",m),a.pause.addEventListener("mousedown",m),a.record.addEventListener("mousedown",function(){i.record=!i.record,i.record?(a.record.setAttribute("class","btn btn-record active"),a.record.querySelector("i").setAttribute("class","icon-stop"),c.forceRender=!0,c.render(),u.record()):(a.record.setAttribute("class","btn btn-record"),a.record.querySelector("i").setAttribute("class","icon-record"),u.stop().then(function(e){var t=URL.createObjectURL(e.blob),r=document.createElement("a");r.href=t,r.download="shader"+e.extension,r.click(),setTimeout(function(){window.URL.revokeObjectURL(output)},100)}))}),a.stats.addEventListener("mousedown",function(){i.stats=!i.stats,i.stats?(r?r.style.visibility="visible":((t=new Stats).showPanel(0),(r=t.dom).style.cssText="position:fixed;top:0;right:0;cursor:pointer;opacity:0.9;z-index:10000",document.body.appendChild(t.dom)),requestAnimationFrame(function e(){t.update(),i.stats&&requestAnimationFrame(e)}),a.stats.setAttribute("class","btn btn-stats active")):(r&&(r.style.visibility="hidden"),a.stats.setAttribute("class","btn btn-stats"))}),a.create.addEventListener("click",function(e){window.parent.postMessage({command:"did-click-link",data:"command:glsl-canvas.createShader?"+JSON.stringify([options.uri])},"file://")}),window.addEventListener("message",function(e){window.options=JSON.parse(e.data),l()},!1),window.addEventListener("resize",d),d()})}();
//# sourceMappingURL=app.min.js.map
