!function(){"use strict";function e(){function e(){document.querySelector(".errors").setAttribute("class","errors"),document.querySelector(".welcome").setAttribute("class",options.uri?"welcome":"welcome active");var e=window.options;e.vertex=e.vertex.trim().length>0?e.vertex:null,e.fragment=e.fragment.trim().length>0?e.fragment:null,p.load(e.fragment,e.vertex);for(var t in e.uniforms)p.setUniform(t,e.uniforms[t]);for(var r in e.textures)p.setUniform("u_texture_"+r,e.textures[r]);document.querySelector("body").setAttribute("class",e.fragment||e.vertex?"ready":"empty")}function r(){var e=l.offsetWidth+c,t=l.offsetHeight+c;u.style.width=e+"px",u.style.height=t+"px",u.width=e,u.height=t,c=0}function n(){m.pause=!m.pause,p.paused?(p.timePause&&(p.timePrev=new Date,p.timeLoad+=p.timePrev-p.timePause),p.play(),d.pause.querySelector("i").setAttribute("class","icon-pause")):(p.pause(),p.timePause=new Date,d.pause.querySelector("i").setAttribute("class","icon-play"))}function s(){if(m.record=!m.record,m.record){d.record.querySelector("i").setAttribute("class","icon-stop");try{v=new Whammy.Video(20),u=document.querySelector(".shader"),v.add(u.getContext("webgl"))}catch(e){console.log("encoder.init.error",e)}}else{d.record.querySelector("i").setAttribute("class","icon-record");try{v&&(v.compile(function(e){var t=(window.webkitURL||window.URL).createObjectURL(e),r=document.createElement("a");r.href=t,r.download="shader.webm",r.click(),setTimeout(function(){(window.webkitURL||window.URL).revokeObjectURL(e)},100)}),v=null)}catch(e){console.log("encoder.compile.error",e)}}}function o(){function e(){w.update(),m.stats&&requestAnimationFrame(e)}m.stats=!m.stats,m.stats?(f?f.style.visibility="visible":(w=new Stats,w.showPanel(0),f=w.dom,f.style.cssText="position:fixed;top:0;right:0;cursor:pointer;opacity:0.9;z-index:10000",document.body.appendChild(w.dom)),requestAnimationFrame(e),d.stats.setAttribute("class","btn active")):(f&&(f.style.visibility="hidden"),d.stats.setAttribute("class","btn"))}function i(e){console.log("createShader",e),window.parent.postMessage({command:"did-click-link",data:"command:glsl-canvas.createShader?"+JSON.stringify([options.uri])},"file://")}function a(t){window.options=JSON.parse(t.data),e()}var c=1,l=document.querySelector(".content"),u=document.querySelector(".shader"),d={pause:document.querySelector(".btn-pause"),record:document.querySelector(".btn-record"),stats:document.querySelector(".btn-stats"),create:document.querySelector(".btn-create")},m={toggle:!1,record:!1,stats:!1};r();var p=new GlslCanvas(u);p.on("error",t),e();var v,w,f;document.addEventListener("dblclick",n),d.pause.addEventListener("mousedown",n),d.record.addEventListener("mousedown",s),d.stats.addEventListener("mousedown",o),d.create.addEventListener("click",i),window.addEventListener("message",a,!1),window.addEventListener("resize",r),r()}function t(e){var t=window.options,r=[],n=[];e.error.replace(/ERROR: \d+:(\d+): \'(.+)\' : (.+)/g,function(e,n,s,o){var i="ERROR ("+s+") "+o,a='<li><a class="error" unselectable data-line="'+Number(n)+'" href="'+encodeURI("command:glsl-canvas.revealGlslLine?"+JSON.stringify([t.uri,Number(n),i]))+'"><span class="line">ERROR line '+Number(n)+'</span> <span class="value" title="'+s+'">'+s+'</span> <span class="text" title="'+o+'">'+o+"</span></a></li>";return r.push(a),a}),e.error.replace(/WARNING: \d+:(\d+): \'(.*\n*|.*|\n*)\' : (.+)/g,function(r,s,o,i){var a='<li><a class="warning" unselectable data-line="'+Number(s)+'" href="'+encodeURI("command:glsl-canvas.revealGlslLine?"+JSON.stringify([t.uri,Number(s),e]))+'"><span class="line">WARN line '+Number(s)+'</span> <span class="text" title="'+i+'">'+i+"</span></a></li>";return n.push(a),a});var s='<div class="errors-content"><h4>glslCanvas error</h4><ul>';s+=r.join("\n"),s+=n.join("\n"),s+="</ul></div>",document.querySelector(".errors").setAttribute("class","errors active"),document.querySelector(".errors").innerHTML=s,r.length&&document.querySelectorAll(".error")[0].click()}window.addEventListener("load",e)}();
//# sourceMappingURL=app.min.js.map
