{"version":3,"sources":["docs/js/vendors.js"],"names":["f","exports","module","define","amd","window","global","self","this","GlslEditor","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","_dereq_","default","__esModule","core-js/library/fn/get-iterator","2","core-js/library/fn/object/assign","3","core-js/library/fn/object/create","4","core-js/library/fn/object/define-property","5","core-js/library/fn/object/get-own-property-descriptor","6","core-js/library/fn/object/keys","7","core-js/library/fn/object/set-prototype-of","8","core-js/library/fn/promise","9","core-js/library/fn/set","10","instance","Constructor","TypeError","11","_Object$defineProperty","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","babel-runtime/core-js/object/define-property","12","_Object$getOwnPropertyDescriptor","_x","_x2","_x3","_again","object","property","receiver","Function","desc","undefined","value","getter","get","parent","Object","getPrototypeOf","babel-runtime/core-js/object/get-own-property-descriptor","13","_Object$create","_Object$setPrototypeOf","subClass","superClass","constructor","__proto__","babel-runtime/core-js/object/create","babel-runtime/core-js/object/set-prototype-of","14","obj","15","CodeMirror","noOptions","nonWS","Pos","firstNonWS","str","found","search","commands","toggleComment","cm","defineExtension","options","minLine","Infinity","ranges","listSelections","mode","from","to","line","uncomment","lineComment","getModeAt","commentString","getLine","end","Math","min","ch","lastLine","pad","padding","blankLines","commentBlankLines","operation","indent","baseString","whitespace","slice","cut","test","replaceRange","blockCommentStart","fullLines","blockComment","startString","endString","blockCommentEnd","lastLineHasText","lead","blockCommentLead","didSomething","start","lineString","lines","indexOf","getTokenTypeAt","push","pos","endPos","startLine","endLine","open","close","lastIndexOf","lastStart","firstEnd","almostLastStart","openEnd","foundEnd","mod","../../lib/codemirror","16","dialogDiv","template","bottom","dialog","getWrapperElement","appendChild","document","createElement","className","innerHTML","closeNotification","newVal","state","currentNotificationClose","callback","closed","me","inp","parentNode","removeChild","focus","onClose","button","getElementsByTagName","selectValueOnOpen","select","onInput","on","onKeyUp","onKeyDown","keyCode","closeOnEnter","blur","e_stop","closeOnBlur","callbacks","buttons","blurring","b","e_preventDefault","setTimeout","doneTimer","duration","clearTimeout","17","Panel","node","height","cleared","panels","wrap","style","getComputedStyle","currentStyle","parseInt","info","setHeight","heightLeft","wrapper","insertBefore","hasFocus","_setSize","setSize","width","newHeight","px","exec","Number","offsetHeight","initPanels","cmWrapper","after","before","nextSibling","replace","clear","position","firstChild","replaceChild","removePanels","changed","18","clearRulers","display","lineSpace","childNodes","setRulers","val","getOption","cw","defaultCharWidth","left","charCoords","firstLine","minH","scroller","elt","col","conf","column","color","borderColor","lineStyle","borderLeftStyle","borderLeftWidth","top","minHeight","cursorDiv","refreshRulers","defineOption","old","Init","off","19","defaults","pairs","triples","explode","name","removeKeyMap","keyMap","closeBrackets","addKeyMap","bind","Backspace","getConfig","Pass","empty","around","charsAround","head","cur","Enter","replaceSelection","execCommand","indentLine","charAt","handler","type","identical","opening","curType","range","next","getRange","isWordChar","enteringString","right","sels","getSelections","replaceSelections","sel","inverted","cmpPos","anchor","setSelections","triggerElectric","handleChar","deflt","getCursor","token","getTokenAt","stream","StringStream","type1","getMode","20","ie_lt8","navigator","userAgent","documentMode","matching","(",")","[","]","{","}","findMatchingBracket","where","strict","config","getLineHandle","match","text","dir","scanForBracket","forward","maxScanLen","maxScanLineLength","maxScanLines","stack","re","bracketRegex","lineEnd","max","lineNo","pop","matchBrackets","autoclear","maxHighlightLen","maxHighlightLineLength","marks","markText","focused","currentlyHighlighted","doMatchBrackets","21","doFold","force","finder","minSize","allowFolded","findMarksAt","__isFold","myWidget","widget","createTextNode","makeWidget","myRange","replacedWith","clearOnEnter","signal","newFoldFunction","rangeFinder","toggleFold","foldCode","fold","unfold","foldAll","unfoldAll","registerHelper","funcs","Array","arguments","helpers","getHelpers","defaultOptions","auto","minFoldSize","scanUp","editorOptions","foldOptions","22","clearGutter","foldGutter","gutter","onGutterClick","onChange","onViewportChange","onFold","updateInViewport","opts","indicatorOpen","indicatorFolded","parseOptions","isFolded","find","marker","spec","cloneNode","updateFoldInfo","foldOption","func","eachLine","mark","setGutterMarker","vp","getViewport","folded","changeUpdate","foldOnChangeTimeSpan","updateViewportTimeSpan","./foldcode","23","tabSize","getIndent","countColumn","myIndent","lastLineInFold","curLine","24","forEach","arr","scriptHint","editor","keywords","getToken","innerMode","string","tprop","context","list","globalScope","maybeAdd","item","arrayContains","gatherCompletions","stringProps","arrayProps","funcProps","base","additionalContext","useGlobalScope","jQuery","_","v","localVars","globalVars","getCompletions","getCoffeeScriptToken","javascriptKeywords","coffeescriptKeywords","split","25","HINT_ELEMENT_CLASS","ACTIVE_HINT_ELEMENT_CLASS","Completion","debounce","tick","startPos","startLen","getSelection","activityFunc","cursorActivity","showHint","getHints","async","newOpts","hint","prop","hintOptions","out","resolve","selections","somethingSelected","supportsSelection","completionActive","completion","update","requestAnimationFrame","fn","cancelAnimationFrame","getText","getHintElement","hintsElement","el","nodeName","toUpperCase","Widget","data","picked","hints","selectedHint","completions","render","displayText","hintId","cursorCoords","alignWithWord","below","winW","innerWidth","body","offsetWidth","documentElement","winH","innerHeight","container","box","getBoundingClientRect","cursor","closingOnBlur","overlapX","handle","baseMap","Up","moveFocus","Down","PageUp","menuSize","PageDown","Home","setFocus","End","pick","Tab","Esc","custom","customKeys","ourMap","addBinding","bound","hasOwnProperty","extra","extraKeys","buildKeyMap","avoidWrap","changeActive","screenAmount","closeOnUnfocus","onBlur","onFocus","startScroll","getScrollInfo","onScroll","curScroll","newTop","point","pageYOffset","scrollTop","srcElement","completeOnSingleClick","applicableHelpers","result","active","closeCharacters","disable","first","myTick","finishUpdate","completeSingle","offsetTop","clientHeight","floor","words","resolved","app","run","helper","getHelper","fromList","anyword","term","word","autocomplete","26","getSearchState","posFrom","posTo","lastQuery","query","overlay","queryCaseInsensitive","toLowerCase","getSearchCursor","shortText","openDialog","prompt","parseString","parseQuery","isRE","RegExp","queryDialog","startSearch","caseInsensitive","queryText","removeOverlay","source","ignoreCase","lastIndex","index","skipToEnd","addOverlay","showMatchesOnScrollbar","annotate","doSearch","rev","persistent","findNext","q","hiding","event","opacity","shiftKey","querySelector","clearSearch","setSelection","scrollIntoView","replaceQueryDialog","replacementQueryDialog","doReplaceConfirm","replaceAll","all","dialogText","advance","fs","doReplace","openConfirm","confirm","findPersistent","findPrev","../dialog/dialog","./searchcursor","27","SearchCursor","doc","caseFold","atOccurrence","clipPos","matches","reverse","cutOff","newMatch","matchLen","origQuery","orig","adjustPos","origTarget","last","ln","pos1","len1","findPrevious","savePosAndFail","maxLine","lineCount","newText","origin","splitLines","defineDocExtension","28","findParagraph","startRE","paragraphStart","endRE","paragraphEnd","findBreakPoint","wrapOn","killTrailingSpace","at","endOfText","wrapRange","killTrailing","changes","curNo","leadingSpace","oldLen","spaceInserted","spaceTrimmed","firstBreak","bp","change","changeEnd","para","wrapLines","span","paras","madeChange","29","map","sublime","fallthrough","cmds","mac","macDefault","ctrl","moveSubword","extendSelectionsBy","shift","extend","cat","findPosSubword","scrollLineCombo","insertLine","above","len","newSelection","wordAt","visibleBottomLine","lineAtHeight","scrollTo","defaultTextHeight","visibleTopLine","lineRanges","scroll","extended","fullWord","sublimeFindFullWord","addSelection","mirror","selectBetweenBrackets","closing","prev","swapLineCombo","sortLines","caseSensitive","selected","toSort","sort","au","bu","linesToMove","newSels","joined","offset","actual","rangeCount","sublimeBookmarks","current","unshift","findMarks","j","sublimeBookmark","k","splice","clearWhenEmpty","cK","modifyWordOrSelection","indices","replacements","getTarget","findAndGoTo","toStartOfLine","indentUnit","prevIndent","findColumn","sublimeMark","setBookmark","tmp","sublimeKilled","setCursor","primaryIndex","normalizeKeyMap","../addon/edit/matchbrackets","../addon/search/searchcursor","../lib/codemirror","30","platform","gecko","ie_upto10","ie_11up","ie","ie_version","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","mobile","windows","presto_version","flipCtrlCmd","captureRightClick","sawReadOnlySpans","sawCollapsedSpans","place","copyObj","setGuttersForLineNumbers","Doc","lineSeparator","input","inputStyles","inputStyle","d","scrollbarFiller","setAttribute","gutterFiller","lineDiv","selectionDiv","measure","lineMeasure","mover","sizer","sizerWidth","heightForcer","scrollerGap","gutters","lineGutter","zIndex","paddingRight","draggable","viewFrom","viewTo","reportedViewFrom","reportedViewTo","view","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","selForContextMenu","activeTouch","init","updateGutters","themeChanged","lineWrapping","autofocus","initScrollbars","keyMaps","overlays","modeGen","overwrite","delayingBlurEvent","suppressEdits","pasteIncoming","cutIncoming","selectingText","draggingText","highlight","Delayed","keySeq","specialChars","opt","reset","onMouseDown","signalDOMEvent","posFromMouse","clickInGutter","eventInWidget","findWordAt","extendSelection","onContextMenu","touchFinished","prevTouch","finishTouch","Date","farAway","touch","other","dx","dy","touches","radiusX","radiusY","isMouseLikeTouchEvent","now","moved","pageX","pageY","coordsChar","Range","setScrollTop","setScrollLeft","scrollLeft","onScrollWheel","dragFunctions","enter","over","frag","createDocumentFragment","drawSelectionCursor","dragCursor","removeChildrenAndAdd","onDragOver","lastDrop","dataTransfer","setData","setDragImage","img","src","_top","onDragStart","drop","onDrop","leave","clearDragCursor","getField","onKeyPress","registerEventHandlers","globalsRegistered","resizeTimer","forEachCodeMirror","onResize","ensureGlobalHandlers","startOperation","curOp","forceUpdate","attachDoc","optionHandlers","maybeUpdateLineNumberWidth","finishInit","initHooks","endOperation","textRendering","loadMode","modeOption","resetModeState","iter","stateAfter","styles","frontier","startWorker","regChange","estimateHeight","th","textHeight","wrapping","perLine","clientWidth","charWidth","lineIsHidden","widgetsHeight","widgets","ceil","estimateLineHeights","est","estHeight","updateLineHeight","theme","clearCaches","guttersChanged","alignHorizontally","specs","removeChildren","gutterClass","gElt","updateGutterSpace","marginLeft","lineLength","merged","collapsedSpanAtStart","collapsedSpanAtEnd","findMaxLine","lineNumbers","concat","measureForScrollbars","gutterW","docH","round","paddingVert","viewHeight","scrollWidth","viewWidth","barLeft","fixedGutter","docHeight","scrollHeight","scrollGap","gutterWidth","NativeScrollbars","vert","horiz","checkedOverlay","minWidth","NullScrollbars","scrollbars","addClass","rmClass","scrollbarModel","scrollbarStyle","axis","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","updateHeightsInViewport","sizes","paddingBottom","coverGutterNextToScrollbar","visibleLines","viewport","paddingTop","ensure","ensureFrom","ensureTo","heightAtLine","comp","compensateForHScroll","hidden","align","alignable","lineNumberFor","size","innerW","String","lineNumberFormatter","firstLineNumber","DisplayUpdate","visible","editorIsHidden","wrapperHeight","wrapperWidth","oldDisplayWidth","displayWidth","dims","getDimensions","events","updateDisplayIfNeeded","resetView","countDirtyView","viewportMargin","visualLineNo","visualLineEndNo","different","buildViewArray","findViewIndex","adjustView","toUpdate","activeElt","updateNumbersFrom","rm","currentWheelTarget","lineN","lineView","updateNumber","lineNumber","updateLineForChanges","buildLineElement","patchDisplay","postUpdateDisplay","displayHeight","barMeasure","updateSelection","setDocumentHeight","updateDisplaySimple","finish","total","prevBottom","bot","diff","updateWidgetHeight","rest","gutterLeft","clientLeft","offsetLeft","fixedPos","gutterTotalWidth","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","getLineContent","ext","built","buildLineContent","cls","pre","bgClass","textClass","background","updateLineBackground","wrapClass","gutterBackground","markers","gutterMarkers","gutterWrap","setUneditable","id","insertLineWidgets","insertLineWidgetsFor","allowAbove","ws","handleMouseEvents","positionLineWidget","signalLater","noHScroll","coverGutter","paddingLeft","needsH","needsV","sWidth","totalHeight","totalWidth","overlayHack","w","barMouseDown","e_target","native","null","emitter","hasHandler","apply","cmp","copyPos","x","maxPos","minPos","ensureFocus","isReadOnly","readOnly","cantEdit","lastCopied","applyTextInput","inserted","deleted","paste","textLines","multiPaste","join","lst","updateInput","changeEvent","makeChange","ensureCursorVisible","typing","handlePaste","pasted","clipboardData","getData","preventDefault","disableInput","runInOp","electricChars","smartIndent","indented","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","TextareaInput","prevInput","pollingFast","polling","inaccurateSelection","hasSelection","composing","hiddenTextarea","te","div","border","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","gracePeriod","posToDOM","findViewForLine","mapFromLineView","order","getOrder","side","getBidiPartAt","nodeAndOffsetInLineMap","collapse","badPos","bad","domToPos","lineNode","locateNodeInLineView","contains","textNode","nodeType","topNode","nodeValue","maps","curNode","dist","textContent","previousSibling","Selection","primIndex","normalizeSelection","prim","inv","simpleSelection","clipLine","linelen","isLine","extendRange","posBefore","primary","extendSelections","heads","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","done","history","setSelectionNoUndo","opId","hist","lastSelOp","lastSelOrigin","lastModTime","lastSelTime","lastOrigin","historyEventDelay","pushSelectionToHistory","clearRedo","clearSelectionEvents","undone","addSelectionToHistory","NaN","setSelectionInner","skipAtomicInSelection","bias","equals","selectionChanged","signalCursorActivity","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","flipped","curPos","markedSpans","sp","m","inclusiveLeft","inclusiveRight","explicitlyCleared","atomic","newPos","showSelection","prepareSelection","curFragment","cursors","selFragment","selection","collapsed","showCursorWhenSelecting","drawSelectionRange","output","singleCursorHeightPerLine","cursorHeight","otherCursor","fragment","paddingH","leftSide","rightSide","add","drawForLine","fromArg","toArg","lineObj","lineLen","coords","part","level","iterateBidiSections","rightPos","leftPos","sFrom","sTo","fromLine","toLine","singleVLine","visualLine","leftEnd","rightStart","restartBlink","clearInterval","blinker","visibility","cursorBlinkRate","setInterval","time","startState","set","highlightWorker","workTime","copyState","getStateBefore","changedLines","oldStyles","tooLong","maxHighlightLength","highlighted","highlightLine","oldCls","styleClasses","newCls","classes","ischange","processLine","workDelay","regLineChange","precise","minindent","minline","lim","findStartLine","save","isNaN","cache","caches","measureChar","measureCharPrepared","prepareMeasureForLine","LineView","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","curWidth","heights","rects","getClientRects","abs","ensureLineHeights","isExtendingChar","coverStart","coverEnd","nullRect","screen","logicalXDPI","deviceXDPI","badZoomedRects","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","rtop","rbot","mid","bogus","rbottom","measureCharInner","textarea","prepareCopyCut","selectInput","lineWiseCopyCut","sel_dontScroll","poll","fastPoll","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","minimal","content","hasCopyEvent","supportsTouch","resetPosition","receivedFocus","slowPoll","pollInterval","missed","p","charCodeAt","same","ensurePolled","scrollPos","resetSelectionOnContextMenu","oldCSS","cssText","clientY","clientX","oldScrollY","scrollY","detectingSelectAll","prepareSelectAllHack","mouseup","rehide","selectionStart","extval","selectionEnd","selectAll","readOnlyChanged","nothing","needsContentAttribute","onCopyCut","clearData","kludge","hadFocus","activeElement","startData","ours","handled","applyComposition","forceCompositionEnd","pollContent","showPrimarySelection","showMultipleSelections","curAnchor","anchorNode","anchorOffset","curFocus","focusNode","focusOffset","getRangeAt","rng","removeAllRanges","addRange","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","fromIndex","fromNode","toIndex","toNode","lastChild","lineSep","walk","cmText","getAttribute","markerID","getBetween","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","fromCharCode","charCode","contenteditable","here","there","deepCopy","measureText","mStart","mEnd","insertLeft","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","pageScrollX","pageXOffset","pageScrollY","intoCoordSystem","widgetHeight","yOff","lOff","xOff","fromCoordSystem","localBox","lineSpaceBox","preparedMeasure","getBidi","partPos","bidiLeft","bidiRight","bidiOther","estimateCoords","PosWithInfo","outside","xRel","y","coordsCharInner","mergedPos","innerOff","wrongLine","adjust","getX","bidi","lineLeft","lineRight","fromX","fromOutside","toX","toOutside","moveVisually","xDiff","step","middle","middleX","lastClick","lastDoubleClick","operationGroup","nextOpId","viewChanged","changeObjs","cursorActivityHandlers","cursorActivityCalled","updateMaxLine","scrollToPos","ops","ownsGroup","delayedCallbacks","group","op","fireCallbacksForOps","endOperation_R1","updatedDisplay","mustUpdate","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","marginBottom","borderRightWidth","adjustWidthTo","maxScrollLeft","preparedSelection","forceScroll","margin","limit","endCoords","calculateScrollPos","startTop","startLeft","scrollPosIntoView","isCursor","doScroll","scrollNode","maybeScrollWindow","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","methodOp","docMethodOp","visualLineContinued","nextPos","array","lendiff","viewCuttingPoint","cutTop","cutBot","oldN","newN","dirty","liberal","forRect","space","colDiff","e_button","contained","modifier","metaKey","ctrlKey","dragDrop","dragAndDrop","startTime","dragEnd","e2","leftButtonStartDrag","addNew","ourRange","ourIndex","startSel","altKey","sel_mouse","lastPos","editorSize","counter","curCount","startCol","posCol","oldRange","extendTo","move","up","leftButtonSelect","leftButtonDown","lastMiddleDown","gutterEvent","prevent","signalfn","mX","mY","lineBox","e_defaultPrevented","g","files","FileReader","File","read","loadFile","file","allowDropFileTypes","reader","onload","readAsText","isScroller","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","wheelDeltaX","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","delta","canScrollX","canScrollY","outer","pixels","movedX","movedY","sample","doHandleBinding","dropShift","prevShift","wheelEventPixels","stopSeq","dispatchKey","seq","isModifierKey","lookupKey","lookupKeyForEditor","handleKeyBinding","keyName","motion","lastStoppedKey","returnValue","showCrossHair","which","adjustForChange","computeSelAfterChange","offsetPos","nw","filterChange","canceled","cancel","ignoreReadOnly","parts","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","selAfter","addChangeToHistory","makeChangeSingleDoc","stretchSpansOverChange","rebased","linkedDocs","sharedHist","rebaseHist","makeChangeFromHistory","allowSelectionOnly","dest","antiChanges","generation","maxGeneration","filter","historyChangeFromChange","mergeOldSpans","shiftDoc","distance","spans","removed","recomputeMaxLength","checkWidthStart","updateDoc","full","isWholeLineUpdate","changesHandler","changeHandler","makeChangeSingleDocInEditor","x1","y1","x2","y2","snapMargin","screentop","docBottom","atTop","atBottom","screenleft","screenw","tooWide","addToScrollPos","resolveScrollToPos","cursorScrollMargin","sPos","how","aggressive","curSpace","indentation","curSpaceString","indentString","indentWithTabs","spaceStr","changeLine","changeType","no","deleteNearSelection","compute","kill","toKill","replaced","findPosH","unit","visually","origDir","possible","moveOnce","boundToLine","moveLogically","sawType","hitSide","findPosV","pageSize","setOption","option","getDoc","getKeyMap","modeSpec","opaque","indentSelection","newRanges","takeToken","getLineTokens","getLineStyles","help","helperType","_global","pred","getStateAfter","gutterID","isEmpty","lineInfo","addWidget","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","cmd","amount","moveH","rtlMoveVisually","sel_move","deleteH","goalColumn","moveV","goals","startChar","check","toggleOverwrite","interpret","refresh","oldHeight","swapDoc","getInputField","getScrollerElement","getGutterElement","eventMixin","notOnInit","toString","setValue","newBreaks","title","detach","attach","integer","disabled","toggle","undoDepth","tabIndex","modes","mimeModes","defineMode","dependencies","defineMIME","mime","resolveMode","createObj","mfactory","modeObj","modeExtensions","exts","modeProps","extendMode","properties","defineInitHook","registerGlobalHelper","predicate","nstate","a1","a2","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","undo","redo","undoSelection","redoSelection","goDocStart","goDocEnd","goLineStart","lineStart","goLineStartSmart","lineStartSmart","goLineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","goLineDown","goPageUp","goPageDown","goCharLeft","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","transposeChars","newSel","newlineAndIndent","normalizeKeyName","alt","basic","Left","Right","Delete","Shift-Backspace","Shift-Tab","Insert","pcDefault","Ctrl-A","Ctrl-D","Ctrl-Z","Shift-Ctrl-Z","Ctrl-Y","Ctrl-Home","Ctrl-End","Ctrl-Up","Ctrl-Down","Ctrl-Left","Ctrl-Right","Alt-Left","Alt-Right","Ctrl-Backspace","Ctrl-Delete","Ctrl-S","Ctrl-F","Ctrl-G","Shift-Ctrl-G","Shift-Ctrl-F","Shift-Ctrl-R","Ctrl-[","Ctrl-]","Ctrl-U","Shift-Ctrl-U","Alt-U","emacsy","Ctrl-B","Ctrl-P","Ctrl-N","Alt-F","Alt-B","Ctrl-E","Ctrl-V","Shift-Ctrl-V","Ctrl-H","Alt-D","Alt-Backspace","Ctrl-K","Ctrl-T","Cmd-A","Cmd-D","Cmd-Z","Shift-Cmd-Z","Cmd-Y","Cmd-Home","Cmd-Up","Cmd-End","Cmd-Down","Cmd-Left","Cmd-Right","Ctrl-Alt-Backspace","Alt-Delete","Cmd-S","Cmd-F","Cmd-G","Shift-Cmd-G","Cmd-Alt-F","Shift-Cmd-Alt-F","Cmd-[","Cmd-]","Cmd-Backspace","Cmd-Delete","Cmd-U","Shift-Cmd-U","keymap","copy","keyname","keys","keyNames","noShift","altGraphKey","fromTextArea","tabindex","placeholder","getValue","form","leaveSubmitMethodAlone","realSubmit","submit","wrappedSubmit","getTextArea","toTextArea","lastColumnPos","lastColumnValue","eol","sol","peek","eat","ok","eatWhile","eatSpace","skipTo","backUp","pattern","consume","cased","substr","hideFirstChars","inner","nextMarkerId","TextMarker","withOp","getMarkedSpanFor","removeMarkedSpan","visual","dHeight","attachLine","detachLine","shared","widgetNode","linked","isParent","SharedTextMarker","markTextShared","conflictingCollapsedRange","addToHistory","MarkedSpan","clearHistory","startStyle","endStyle","css","findSharedMarkers","detachSharedMarkers","subMarker","oldFirst","oldLast","startCh","endCh","isInsert","endsAfter","markedSpansBefore","startsBefore","markedSpansAfter","sameLine","clearEmptySpans","newMarkers","gapMarkers","gap","removeClearedSpans","getOldSpans","stretched","oldCur","stretchCur","detachMarkedSpans","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","vis","lineIsHiddenInner","LineWidget","adjustScrollWhenAboveVisible","parentStyle","oldH","Line","extractLineClasses","lineClass","callBlankLine","blankLine","readToken","asArray","getObj","tokens","runMode","lineClasses","forceToEnd","flattenSpans","curStart","curStyle","addModeClass","mName","st","i_end","updateFrontier","startAt","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","builder","splitSpaces","addToken","buildToken","hasBadBidiRects","buildTokenBadBidi","insertLineContent","joinClasses","zeroWidthElement","special","mustWrap","skipped","txt","tabWidth","specialCharPlaceholder","fullStyle","buildCollapsedSpan","ignoreWidget","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","upto","tokenText","wholeLineUpdateBefore","spansFor","updateLine","linesFor","lastText","lastSpans","nlines","insert","remove","added","LeafChunk","BranchChunk","children","chunkSize","removeInner","insertInner","iterN","child","sz","newleaf","maybeSpill","sibling","myIndex","used","nextDocId","cleanGeneration","History","getLines","getLineNumber","getLineHandleVisualStart","clipPosArray","dup","oldPrev","newPrev","computeReplacedSel","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","lastOp","isClean","gen","getHistory","copyHistoryArray","setHistory","histData","addLineClass","classTest","removeLineClass","addLineWidget","insertAt","aboveVisible","removeLineWidget","realOpts","getAllMarks","posFromIndex","indexFromPos","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","splitIds","iterLinkedDocs","getEditor","splitLinesAuto","dontDelegate","method","sharedHistOnly","propagate","skip","rel","chunk","h","lh","bidiOrdering","startGen","histChange","attachLocalSpans","existing","newGroup","instantiateSel","newChanges","rebaseHistSelSingle","rebaseHistArray","sub","copied","e_stopPropagation","stopPropagation","cancelBubble","defaultPrevented","addEventListener","attachEvent","_handlers","noHandlers","getHandlers","removeEventListener","detachEvent","handlers","args","orphanDelayedCallbacks","fireOrphanDelayed","bnd","delayed","override","codemirrorIgnore","ctor","ms","startIndex","startValue","nextTab","goal","spaceStrs","inst","create","_e","nonASCIISingleCaseWordChar","isWordCharBasic","extendingChars","tag","count","createRange","endNode","setEnd","setStart","createTextRange","moveToElementText","moveEnd","moveStart","host","root","as","getElementsByClassName","byClass","zwspSupported","badBidiRects","r0","r1","nl","rt","ownerDocument","parentElement","compareEndPoints","oncopy","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","127","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","inWS","linedir","moveInLine","byUnit","lowTypes","arabicTypes","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","types","nstart","version","31","propertyIsEnumerable","parserConfig","curPunc","isDefKeyword","statementIndentUnit","dontAlignCalls","builtin","blockKeywords","defKeywords","atoms","hooks","multiLineStrings","indentStatements","indentSwitch","namespaceSeparator","isPunctuationChar","isNumberChar","isOperatorChar","endStatement","tokenBase","quote","tokenize","escaped","tokenComment","maybeEnd","Context","isStatement","pushContext","popContext","basecolumn","startOfLine","prevToken","ctx","typeFirstDefinitions","isTopScope","styleDefs","textAfter","firstChar","hook","switchBlock","cKeywords","cTypes","cppHook","pointerHook","_stream","cpp14Literal","cpp11StringHook","cpp11RawStringDelim","tokenRawString","tokenAtString","delim","def","mimes","tokenTripleString","#","*","U","L","R","0","lastTwo","@","\"","'","_state","stringTokenizer","tokenCeylonString","`","../modules/core.get-iterator","../modules/es6.string.iterator","../modules/web.dom.iterable","assign","../../modules/$.core","../../modules/es6.object.assign","$","P","D","../../modules/$","it","setDesc","getDesc","../../modules/es6.object.get-own-property-descriptor","../../modules/es6.object.keys","setPrototypeOf","../../modules/es6.object.set-prototype-of","Promise","../modules/$.core","../modules/es6.object.to-string","../modules/es6.promise","Set","../modules/es6.set","../modules/es7.set.to-json","41","42","43","isObject","./$.is-object","cof","TAG","ARG","O","T","B","callee","./$.cof","./$.wks","hide","redefineAll","strictNew","defined","forOf","$iterDefine","ID","$has","setSpecies","DESCRIPTORS","isExtensible","SIZE","fastKey","getEntry","that","entry","_i","_f","getConstructor","NAME","IS_MAP","ADDER","C","iterable","_l","delete","callbackfn","has","setStrong","iterated","kind","_t","_k","./$","./$.ctx","./$.defined","./$.descriptors","./$.for-of","./$.has","./$.hide","./$.iter-define","./$.iter-step","./$.redefine-all","./$.set-species","./$.strict-new","./$.uid","47","classof","./$.classof","48","$export","fails","setToStringTag","methods","common","IS_WEAK","Base","proto","entries","_c","each","KEY","IS_ADDER","G","W","F","./$.export","./$.fails","./$.global","./$.set-to-string-tag","49","core","__e","50","aFunction","c","./$.a-function","51","52","defineProperty","53","is","54","PROTOTYPE","own","IS_FORCED","IS_GLOBAL","IS_STATIC","S","IS_PROTO","IS_BIND","IS_WRAP","param","./$.core","55","56","isArrayIter","anObject","toLength","getIterFn","iterator","iterFn","./$.an-object","./$.is-array-iter","./$.iter-call","./$.to-length","./core.get-iterator-method","57","__g","58","createDesc","./$.property-desc","60","un","62","63","Iterators","ITERATOR","ArrayProto","./$.iterators","64","65","ret","66","IteratorPrototype","67","LIBRARY","redefine","$iterCreate","getProto","BUGGY","FF_ITERATOR","VALUES","returnThis","DEFAULT","IS_SET","FORCED","getMethod","DEF_VALUES","VALUES_BUG","$native","$default","values","./$.iter-create","./$.library","./$.redefine","68","SAFE_CLOSING","riter","skipClosing","safe","69","70","71","$Object","isEnum","getOwnPropertyDescriptor","setDescs","getKeys","getNames","getOwnPropertyNames","getSymbols","getOwnPropertySymbols","72","73","notify","macrotask","Observer","MutationObserver","WebKitMutationObserver","process","isNode","flush","domain","exit","nextTick","observe","characterData","then","task","./$.task","74","toObject","IObject","A","Symbol","K","$$","$$len","./$.iobject","./$.to-object","75","exp","76","bitmap","77","78","79","80","buggy","81","SPECIES","82","stat","83","SHARED","store","84","85","86","toInteger","TO_STRING","./$.to-integer","87","defer","channel","port","invoke","html","cel","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","queue","ONREADYSTATECHANGE","listner","port2","port1","onmessage","postMessage","importScripts","./$.dom-create","./$.html","./$.invoke","88","89","90","random","uid","./$.shared","94","getIteratorMethod","95","getIterator","96","addToUnscopables","toIObject","Arguments","./$.add-to-unscopables","./$.to-iobject","97","./$.object-assign","98","$getOwnPropertyDescriptor","./$.object-sap","99","$keys","100","./$.set-proto","101","102","Wrapper","setProto","speciesConstructor","asap","PROMISE","testResolve","promise","USE_NATIVE","works","P2","thenableThenGotten","isThenable","PromiseCapability","reject","$$resolve","$$reject","perform","error","record","isReject","chain","reaction","fail","console","isUnhandled","emit","onunhandledrejection","reason","_d","$reject","$resolve","executor","err","onFulfilled","onRejected","catch","capability","abrupt","remaining","results","alreadyCalled","race","./$.iter-detect","./$.microtask","./$.same-value","./$.species-constructor","103","strong","./$.collection","./$.collection-strong","104","$at","./$.string-at","105","toJSON","./$.collection-to-json","NodeList","HTMLCollection","./es6.array.iterator","CrossStorageClient","url","frame","_id","_generateUUID","_promise","_frameId","frameId","_origin","_getOrigin","_requests","_connected","_closed","_count","_timeout","timeout","_listener","_installListener","getElementById","_poll","_createFrame","_hub","contentWindow","frameStyle","uri","href","location","protocol","onConnect","client","connect","_request","del","message","response","JSON","parse","interval","targetOrigin","params","req","originalToJSON","stringify","108","CrossStorageHub","permissions","available","localStorage","_permissions","listener","request","_permitted","_inArray","allow","_set","setItem","_get","storage","getItem","_del","removeItem","_clear","_getKeys","_now","getTime","./client.js","./hub.js","polyfill","htmlClass","section","tags","Class","catchClass","register","tagOrClass","filterBy","collections","HTMLAllCollection","HTMLFormControlsCollection","HTMLOptionsCollection","elements","Element","HTMLAnchorElement","HTMLAppletElement","HTMLAreaElement","HTMLAttachmentElement","HTMLAudioElement","HTMLBRElement","HTMLBaseElement","HTMLBodyElement","HTMLButtonElement","HTMLCanvasElement","HTMLContentElement","HTMLDListElement","HTMLDataElement","HTMLDataListElement","HTMLDetailsElement","HTMLDialogElement","HTMLDirectoryElement","HTMLDivElement","HTMLDocument","HTMLElement","HTMLEmbedElement","HTMLFieldSetElement","HTMLFontElement","HTMLFormElement","HTMLFrameElement","HTMLFrameSetElement","HTMLHRElement","HTMLHeadElement","HTMLHeadingElement","HTMLHtmlElement","HTMLIFrameElement","HTMLImageElement","HTMLInputElement","HTMLKeygenElement","HTMLLIElement","HTMLLabelElement","HTMLLegendElement","HTMLLinkElement","HTMLMapElement","HTMLMarqueeElement","HTMLMediaElement","HTMLMenuElement","HTMLMenuItemElement","HTMLMetaElement","HTMLMeterElement","HTMLModElement","HTMLOListElement","HTMLObjectElement","HTMLOptGroupElement","HTMLOptionElement","HTMLOutputElement","HTMLParagraphElement","HTMLParamElement","HTMLPictureElement","HTMLPreElement","HTMLProgressElement","HTMLQuoteElement","HTMLScriptElement","HTMLSelectElement","HTMLShadowElement","HTMLSlotElement","HTMLSourceElement","HTMLSpanElement","HTMLStyleElement","HTMLTableCaptionElement","HTMLTableCellElement","HTMLTableColElement","HTMLTableElement","HTMLTableRowElement","HTMLTableSectionElement","HTMLTemplateElement","HTMLTextAreaElement","HTMLTimeElement","HTMLTitleElement","HTMLTrackElement","HTMLUListElement","HTMLUnknownElement","HTMLVideoElement","nodes","Attr","Audio","CDATASection","CharacterData","Comment","Document","DocumentFragment","DocumentType","Image","Option","ProcessingInstruction","ShadowRoot","Text","XMLDocument","asapQueue","onSubtreeModified","callDOMAttrModified","getAttributesMirror","observer","patchIfNotAlready","patch","patchedRemoveAttribute","patchedSetAttribute","onPropertyChange","REGISTER_ELEMENT","EXPANDO_UID","ADD_EVENT_LISTENER","ATTACHED","CALLBACK","DETACHED","EXTENDS","ATTRIBUTE_CHANGED_CALLBACK","ATTACHED_CALLBACK","CONNECTED_CALLBACK","DISCONNECTED_CALLBACK","CREATED_CALLBACK","DETACHED_CALLBACK","ADDITION","MODIFICATION","REMOVAL","DOM_ATTR_MODIFIED","DOM_CONTENT_LOADED","DOM_SUBTREE_MODIFIED","PREFIX_TAG","PREFIX_IS","validName","invalidNames","protos","OP","hOP","iPO","isPrototypeOf","gOPD","gOPN","gPO","sPO","hasProto","DRECEV1","customElements","usableCustomElements","whenDefined","Dict","Map","V","cb","justCreated","constructors","waitingList","nodeNames","secondArgument","Bridge","setPrototype","setProperties","names","HTMLElementPrototype","Node","IE8","safeProperty","isValidNode","targets","attachShadow","dispatchEvent","hasAttribute","removeAttribute","patchedCreateElement","attributesObserver","attributes","attributeOldValue","DOMAttrModified","doesNotSupportDOMAttrModified","asapTimer","V0","setListener","justSetup","dropDomContentLoaded","notFromInnerHTMLHelper","ASAP","loopAndVerify","action","verifyAndSetupAndAction","executeAction","querySelectorAll","getTypeIndex","isInQSA","onDOMAttrModified","currentTarget","attrChange","attrName","addition","removal","prevValue","newValue","onDOMNode","onReadyStateChange","purge","setupNode","created","throwTypeError","counterAction","CustomElementRegistry","CERDefine","CProto","observedAttributes","definition","notifyAttributes","getIs","attribute","polyfillV1","patchClass","isNative","Reflect","construct","WebKit","Classes","mutations","removedNodes","disconnect","childList","subtree","CustomEvent","bubbles","had","superSecret","propertyName","capture","oldAttributes","newAttributes","attr","upperType","attached","detached","checkEmAll","records","addedNodes","attributeName","oldValue","deep","loopAndSetup","extending","localName","typeExtension","setup","innerHTMLHelper","noBuiltIn","DRE","outerHTML","o_O","FireFox","isCallable","toStr","thisArg","forEachArray","forEachString","forEachObject","is-callable","112","win","113","commonjsGlobal","window_1","isFunction_1","alert","trim_1","forEach_1","toString$1","forEachArray$1","parseHeaders","headers","row","arg","immutable","hasOwnProperty$1","xhr","createXHR","default_1","initParams","_createXHR","called","errorFunc","evt","timeoutTimer","statusCode","failureResponse","loadFunc","aborted","status","useXDR","responseText","responseType","responseXML","firefoxBugTakenEffect","getXml","isJson","getBody","rawRequest","getAllResponseHeaders","cors","XDomainRequest","XMLHttpRequest","sync","json","onreadystatechange","readyState","onerror","onprogress","onabort","ontimeout","username","password","withCredentials","abort","setRequestHeader","beforeSend","send","_typeof","classCallCheck","AwaitValue","AsyncGenerator","front","back","resume","settle","_invoke","return","asyncIterator","throw","createClass","toConsumableArray","isArray","arr2","lastError","GET_A_WEBGL_BROWSER","OTHER_PROBLEM","ERROR_BROWSER_SUPPORT","ERROR_OTHER","setupWebGL","canvas","optAttribs","onError","handleError","errorCode","msg","WebGLRenderingContext","ii","getContext","create3DContext","getExtension","createShader","main","gl","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","trigger","deleteShader","createProgram","shaders","optLocations","program","attachShader","_ii","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","log","deleteProgram","isPowerOf2","subscribeMixin$1","listeners","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","listSubscriptions","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","subscribe","unsubscribe","unsubscribeAll","_len","_key","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","Texture","texture","createTexture","valid","sourceType","loading","Uint8Array","filtering","setFiltering","load","deleteTexture","activeUnit","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","setUrl","element","setElement","_this","isVideo","autoplay","crossOrigin","_this2","intervalID","currentTime","play","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","complete","videoWidth","videoHeight","texImage2D","RGBA","UNSIGNED_BYTE","powerOf2","defualtFilter","texParameteri","TEXTURE_WRAP_S","repeat","REPEAT","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","generateMipmap","NEAREST","getMaxTextureSize","getParameter","MAX_TEXTURE_SIZE","GlslCanvas","contextOptions","textures","buffers","uniforms","vbo","isValid","BUFFER_COUNT","TEXTURE_COUNT","vertexString","fragmentString","timeLoad","timePrev","performance","timeDelta","forceRender","paused","realToCSSPixels","devicePixelRatio","backgroundColor","_source","texCoordsLoc","getAttribLocation","texCoords","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","verticesLoc","vertices","imgList","nImg","setUniform","mouse","sandbox","setMouse","RenderLoop","nMouse","resize","tex","animated","destroy","att","attribs","deleteBuffer","useProgram","buffer","fragString","vertString","nDelta","nTime","nDate","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","getBuffers","loadPrograms","pre_test_vert","pre_test_frag","pre_test_paused","createQueryEXT","wasValid","beginQueryEXT","TIME_ELAPSED_EXT","endQueryEXT","waitForTest","getQueryObjectEXT","QUERY_RESULT_AVAILABLE_EXT","disjoint","GPU_DISJOINT_EXT","timeElapsedMs","QUERY_RESULT_EXT","urlElementOrData","setUniforms","parsed","parseUniforms","prefix","uniform","loadTexture","mouse_x","mouse_y","uniform2f","getUniformLocation","_len2","_key2","resizeSwappableBuffers","renderPrograms","H","updateVariables","updateUniforms","bundle","bindFramebuffer","FRAMEBUFFER","drawArrays","TRIANGLES","date","variables","year","getFullYear","month","getMonth","getDate","daytime","getHours","getMinutes","getSeconds","getMilliseconds","_key3","uniform1f","uniform4f","uniform1i","uniformTexture","glsl","vertex","createSwappableBuffer","swap","temp","framebufferTexture2D","COLOR_ATTACHMENT0","createFramebuffer","minW","readPixels","newIndex","newTexture","texSubImage2D","newBuffer","glslCanvases","loadAllGlslCanvas","114","fnToStr","constructorRegex","isES6ClassFn","spaceStripped","hasToStringTag","toStringTag","tryFunctionObject","strClass","115","116","trim","for-each","117","118","isFunction","xtend","global/window","is-function","parse-headers","119","120","_createClass","_classCallCheck","_Object$keys","_interopRequireDefault","_coreShader2","_coreEditor","_uiMenu2","_uiHelpers2","_uiErrorsDisplay2","_uiVisualDebugger2","_uiExportIcon2","_ioFileDrop2","_ioHashWatch2","_ioBufferManager2","_ioLocalStorage2","_xhr2","_toolsMixin","_vendorFileSaverMinJs","_crossStorage","STORAGE_LAST_EDITOR_CONTENT","EMPTY_FRAG_SHADER","selector","createFontLink","subscribeMixin","autoupdate","imgs","display_menu","frag_header","frag_footer","watchHash","menu","multipleBuffers","bufferManager","fileDrops","initEditor","errorsDisplay","visualDebugger","exportIcon","canvas_follow","canvas_float","float","oldContent","setContent","tabName","debugging","focusAll","filename","ge","getContent","getTitle","blob","Blob","saveAs","testingResults","clean","link","media","flag","pWindowOpen","openWindow","closeWindow","GlslWebComponent","createdCallback","canvas_size","tooltips","specified","glslEditor","registerElement","./core/Editor","./core/Shader","./io/BufferManager","./io/FileDrop","./io/HashWatch","./io/LocalStorage","./tools/mixin","./ui/ErrorsDisplay","./ui/ExportIcon","./ui/Helpers","./ui/Menu","./ui/VisualDebugger","./vendor/FileSaver.min.js","babel-runtime/core-js/object/keys","babel-runtime/helpers/class-call-check","babel-runtime/helpers/create-class","babel-runtime/helpers/interop-require-default","cross-storage","document-register-element","121","_codemirror2","autoCloseBrackets","Ctrl-Space","unfocusLine","unfocusAll","focusLine","UNFOCUS_CLASS","codemirror","codemirror/addon/comment/comment","codemirror/addon/dialog/dialog","codemirror/addon/display/panel","codemirror/addon/display/rulers","codemirror/addon/edit/closebrackets","codemirror/addon/edit/matchbrackets","codemirror/addon/fold/foldcode","codemirror/addon/fold/foldgutter","codemirror/addon/fold/indent-fold","codemirror/addon/hint/javascript-hint","codemirror/addon/hint/show-hint","codemirror/addon/search/search","codemirror/addon/search/searchcursor","codemirror/addon/wrap/hardwrap","codemirror/keymap/sublime","codemirror/mode/clike/clike.js","122","_glslCanvas2","_toolsInteractiveDom","_toolsMediaCapture2","_uiMenuItem2","CONTROLS_CLASSNAME","CONTROLS_PANEL_CLASSNAME","Shader","elCanvas","glslcanvas","premultipliedAlpha","preserveDrawingBuffer","canvas_width","canvas_height","mediaCapture","setCanvas","completeScreenshot","displayMenu","controlsContainer","controlPanel","controls","playPause","pause","isCapturing","rec","stopVideoCapture","startVideoCapture","presentationMode","togglePresentationWindow","elControl","showControls","hideControls","offsetY","canvas_draggable","canvas_resizable","canvas_snapable","subscribeInteractiveDom","snap","snapRight","requestRedraw","screenshot","video","originalSize","presentationWindow","setUpPresentationWindow","overflow","fontSize","fontFamily","fontWeight","letterSpacing","textAlign","setProperty","setCanvasSize","onPresentationWindowResize","onPresentationWindowClose","onClosePresentationWindow","../tools/interactiveDom","../tools/mediaCapture","../ui/MenuItem","../vendor/FileSaver.min.js","glslCanvas","123","BufferManager","tabs","tab","panel","getLength","addPanel","buf","bufferName","needChange","getCurrent","124","FileDrop","dropEffect","125","HashWatch","hash","hashes","path","qstr","decodeURIComponent","logs","parseFloat","126","LOCAL_STORAGE_PREFIX","LocalStorage","pushItem","stored","lastReplay","createOpenFrameArtwork","OF_BASE_API_URL","OF_BASE_APP_URL","author","getAuthor","getOfToken","initiateOfRequest","ofToken","successListener","author_name","is_public","format","thumb_url","saveOnServer","FormData","append","dataURL","el_canvas","toDataURL","blobBin","atob","_name","replay","128","getDomOrigin","defaultView","parentWindow","docElem","clientTop","getDevicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","129","isCommented","nLine","isLineAfterMain","totalLines","voidRE","voidMatch","getVariableType","sVariable","nLines","uniformRE","voidIN","constructRE","constructMatch","uniformMatch","getShaderForTypeVarInLine","sType","getResultRange","testResults","minMS","maxMS","getMedian","half","getDeltaSum","getHits","130","dom","_mixin","onRightEdge","onBottomEdge","onLeftEdge","onTopEdge","rightScreenEdge","bottomScreenEdge","preSnapped","clicked","redraw","ghostdom","hintHide","setBounds","onDown","calc","isResizing","cx","cy","isMoving","canMove","MARGINS","onMove","onUp","snapped","FULLSCREEN_MARGINS","changedTouches","animate","currentWidth","removeProperty","currentHeight","_y","./mixin","131","_Promise","_urls","MediaCapture","queueScreenshot","videoCapture","cap","MediaRecorder","captureStream","chunks","mimeType","mediaRecorder","ondataavailable","createObjectURL","getTracks","track","stop","removeTrack","_this3","./urls","babel-runtime/core-js/promise","132","_Set","_Object$assign","_getIterator","offAll","babel-runtime/core-js/get-iterator","babel-runtime/core-js/object/assign","babel-runtime/core-js/set","133","_createObjectURL","URL","webkitURL","134","ErrorsDisplay","testing","addError","changesObjs","er","icon","135","_modalsExportModal2","ExportIcon","modal","presentModal","./modals/ExportModal","136","_pickersColorPicker2","_pickersVec3Picker2","_pickersVec2Picker2","_pickersFloatPicker2","_pickersTypesColor2","_modalsModal2","execAll","matchArray","Helpers","bgColor","fgColor","getString","fnColor","dimColor","selColor","linkButton","debug","getMatch","activeModal","isVisible","removeModal","showAt","newColor","newDir","newpos","number","newNumber","iluminate","rta","getTypeMatch","./modals/Modal","./pickers/ColorPicker","./pickers/FloatPicker","./pickers/Vec2Picker","./pickers/Vec3Picker","./pickers/types/Color","137","_MenuItem2","Menu","menus","fileInput","click","share","exportModal","bbox","./MenuItem","138","MenuItem","onClick","hiddenClass","139","_toolsDebugging","_coreEditorJs","mainGE","VisualDebugger","breakpoint","testingFrag","testingLine","testingSamples","breakpoints","mainStartsAt","testLine","sum","hits","pct","markerHTML","toFixed","makeMarker","variable","onTest","elapsedMs","N_SAMPLES","debbuging","searchOverlay","extraClass","../core/Editor.js","../tools/debugging","140","_inherits","_Modal3","_ioShare","ExportModal","_Modal","CSS_PREFIX","download","codeURL","shaderURL","shareOF","success","../../io/share","../MenuItem","./Modal","babel-runtime/helpers/get","babel-runtime/helpers/inherits","141","addEvent","removeEvent","Modal","onClickOutsideHandler","onClickOutside","onKeyPressHandler","classList","getModalClass","caller","../../tools/mixin","142","_Picker2","_Picker3","_typesColor2","_toolsCommon","currentTargetHeight","domCache","ColorPicker","_Picker","disc","barlum","cover","barbg","barwhite","barcursors","leftcursor","rightcursor","hsvMap","hsvMapCover","hsvMapCursor","hsvBarBGLayer","hsvBarWhiteLayer","hsvBarCursors","hsvLeftCursor","hsvRightCursor","colorDisc","luminanceBar","lbutton","colors","colorDiscRadius","pi2","PI","cos","hsv","sin","hueRGB","luminance","onHsvDownHandler","onHsvDown","radius","diskContext","ratio","scale","drawDisk","angle","gradient","createRadialGradient","addColorStop","fillStyle","fill","restore","lineWidth","strokeStyle","stroke","createLinearGradient","fillRect","draw","onHsvMoveHandler","onHsvMove","onHsvUpHandler","onHsvUp","renderer","offsetX","atan2","sqrt","destroyEvents","steps","colorCallback","coef","translate","beginPath","moveTo","arc","../../tools/common","../../tools/interactiveDom","./Picker","./types/Color","143","_typesFloat2","FloatPicker","prevOffset","clearRect","lineTo","closePath","overPoint","vel","center","./types/Float","144","Picker","drawFrame","onMouseDownHandler","onMouseMoveHandler","onMouseUpHandler","onMouseMove","onMouseUp","145","_typesVector2","Vec2Picker","strokeRect","./types/Vector","146","_typesMatrix2","Vec3Picker","camera","shapes","edgeColour","edges","textColour","setCenter","dragOffset","z","shape","getMult","drawShapeEdges","nodeColour","drawShapeNodes","drawShapeText","nodeRadius","coord","viewFromCamera","textBaseline","fillText","getSub","onDbClick","getInv","mult","rotateX","rotateY","negX","negY","./types/Matrix","147","_ColorConverter","_ColorConverter2","Color","getColorAsRGB","_n","alpha","_n2","limitValue","getValueRanges","convert","rgb","hue2RGB","getLuminance","exceptions","hsl","cmyk","typ","vec","./ColorConverter","148","normalized","RGB","pow","valueRanges","_colors","cmy","Lab","XYZ","X","Y","Z","HEX","XYZMatrix","XYZReference","ColorConverter","hue","chroma","dependent","rgb2hsv","hsv2hsl","sv","sextant","vsf","rgb2cmy","cmy2cmyk","cmyk2cmy","cmy2rgb","M","X3","Y3","Z3","rgb2XYZ","XYZ2Lab","Lab2XYZ","XYZ2rgb","149","Float","150","_Vector2","Matrix","dim","theta","getTransform","newMatrix","newRow","invdet","./Vector","151","Vector","strValues","filler","getLengthSq","152","get_URL","save_link","createElementNS","can_use_save_link","is_safari","webkit_req_fs","webkitRequestFileSystem","req_fs","requestFileSystem","mozRequestFileSystem","throw_outside","ex","force_saveable_type","fs_min_size","revoke","revoker","revokeObjectURL","dispatch","filesaver","event_types","auto_bom","FileSaver","no_auto_bom","object_url","target_view","blob_changed","dispatch_all","fs_error","onloadend","base64Data","DONE","readAsDataURL","INIT","abortable","create_if_not_found","exclusive","MouseEvent","webkitSlice","TEMPORARY","getDirectory","getFile","createWriter","writer","onwriteend","toURL","ABORT_ERR","write","WRITING","NOT_FOUND_ERR","FS_proto","msSaveOrOpenBlob","onwritestart","onwrite"],"mappings":"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","file":"vendors.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.GlslEditor = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/get-iterator\"), __esModule: true };\n},{\"core-js/library/fn/get-iterator\":32}],2:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/assign\"), __esModule: true };\n},{\"core-js/library/fn/object/assign\":33}],3:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/create\"), __esModule: true };\n},{\"core-js/library/fn/object/create\":34}],4:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/define-property\"), __esModule: true };\n},{\"core-js/library/fn/object/define-property\":35}],5:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n},{\"core-js/library/fn/object/get-own-property-descriptor\":36}],6:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/keys\"), __esModule: true };\n},{\"core-js/library/fn/object/keys\":37}],7:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n},{\"core-js/library/fn/object/set-prototype-of\":38}],8:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/promise\"), __esModule: true };\n},{\"core-js/library/fn/promise\":39}],9:[function(_dereq_,module,exports){\nmodule.exports = { \"default\": _dereq_(\"core-js/library/fn/set\"), __esModule: true };\n},{\"core-js/library/fn/set\":40}],10:[function(_dereq_,module,exports){\n\"use strict\";\n\nexports[\"default\"] = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nexports.__esModule = true;\n},{}],11:[function(_dereq_,module,exports){\n\"use strict\";\n\nvar _Object$defineProperty = _dereq_(\"babel-runtime/core-js/object/define-property\")[\"default\"];\n\nexports[\"default\"] = (function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n\n      _Object$defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n})();\n\nexports.__esModule = true;\n},{\"babel-runtime/core-js/object/define-property\":4}],12:[function(_dereq_,module,exports){\n\"use strict\";\n\nvar _Object$getOwnPropertyDescriptor = _dereq_(\"babel-runtime/core-js/object/get-own-property-descriptor\")[\"default\"];\n\nexports[\"default\"] = function get(_x, _x2, _x3) {\n  var _again = true;\n\n  _function: while (_again) {\n    var object = _x,\n        property = _x2,\n        receiver = _x3;\n    _again = false;\n    if (object === null) object = Function.prototype;\n\n    var desc = _Object$getOwnPropertyDescriptor(object, property);\n\n    if (desc === undefined) {\n      var parent = Object.getPrototypeOf(object);\n\n      if (parent === null) {\n        return undefined;\n      } else {\n        _x = parent;\n        _x2 = property;\n        _x3 = receiver;\n        _again = true;\n        desc = parent = undefined;\n        continue _function;\n      }\n    } else if (\"value\" in desc) {\n      return desc.value;\n    } else {\n      var getter = desc.get;\n\n      if (getter === undefined) {\n        return undefined;\n      }\n\n      return getter.call(receiver);\n    }\n  }\n};\n\nexports.__esModule = true;\n},{\"babel-runtime/core-js/object/get-own-property-descriptor\":5}],13:[function(_dereq_,module,exports){\n\"use strict\";\n\nvar _Object$create = _dereq_(\"babel-runtime/core-js/object/create\")[\"default\"];\n\nvar _Object$setPrototypeOf = _dereq_(\"babel-runtime/core-js/object/set-prototype-of\")[\"default\"];\n\nexports[\"default\"] = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = _Object$create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _Object$setPrototypeOf ? _Object$setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nexports.__esModule = true;\n},{\"babel-runtime/core-js/object/create\":3,\"babel-runtime/core-js/object/set-prototype-of\":7}],14:[function(_dereq_,module,exports){\n\"use strict\";\n\nexports[\"default\"] = function (obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n};\n\nexports.__esModule = true;\n},{}],15:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var noOptions = {};\n  var nonWS = /[^\\s\\u00a0]/;\n  var Pos = CodeMirror.Pos;\n\n  function firstNonWS(str) {\n    var found = str.search(nonWS);\n    return found == -1 ? 0 : found;\n  }\n\n  CodeMirror.commands.toggleComment = function(cm) {\n    cm.toggleComment();\n  };\n\n  CodeMirror.defineExtension(\"toggleComment\", function(options) {\n    if (!options) options = noOptions;\n    var cm = this;\n    var minLine = Infinity, ranges = this.listSelections(), mode = null;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      if (from.line >= minLine) continue;\n      if (to.line >= minLine) to = Pos(minLine, 0);\n      minLine = from.line;\n      if (mode == null) {\n        if (cm.uncomment(from, to, options)) mode = \"un\";\n        else { cm.lineComment(from, to, options); mode = \"line\"; }\n      } else if (mode == \"un\") {\n        cm.uncomment(from, to, options);\n      } else {\n        cm.lineComment(from, to, options);\n      }\n    }\n  });\n\n  CodeMirror.defineExtension(\"lineComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = self.getModeAt(from);\n    var commentString = options.lineComment || mode.lineComment;\n    if (!commentString) {\n      if (options.blockCommentStart || mode.blockCommentStart) {\n        options.fullLines = true;\n        self.blockComment(from, to, options);\n      }\n      return;\n    }\n    var firstLine = self.getLine(from.line);\n    if (firstLine == null) return;\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line + 1 : to.line, self.lastLine() + 1);\n    var pad = options.padding == null ? \" \" : options.padding;\n    var blankLines = options.commentBlankLines || from.line == to.line;\n\n    self.operation(function() {\n      if (options.indent) {\n        var baseString = null;\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i);\n          var whitespace = line.slice(0, firstNonWS(line));\n          if (baseString == null || baseString.length > whitespace.length) {\n            baseString = whitespace;\n          }\n        }\n        for (var i = from.line; i < end; ++i) {\n          var line = self.getLine(i), cut = baseString.length;\n          if (!blankLines && !nonWS.test(line)) continue;\n          if (line.slice(0, cut) != baseString) cut = firstNonWS(line);\n          self.replaceRange(baseString + commentString + pad, Pos(i, 0), Pos(i, cut));\n        }\n      } else {\n        for (var i = from.line; i < end; ++i) {\n          if (blankLines || nonWS.test(self.getLine(i)))\n            self.replaceRange(commentString + pad, Pos(i, 0));\n        }\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"blockComment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = self.getModeAt(from);\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) {\n      if ((options.lineComment || mode.lineComment) && options.fullLines != false)\n        self.lineComment(from, to, options);\n      return;\n    }\n\n    var end = Math.min(to.line, self.lastLine());\n    if (end != from.line && to.ch == 0 && nonWS.test(self.getLine(end))) --end;\n\n    var pad = options.padding == null ? \" \" : options.padding;\n    if (from.line > end) return;\n\n    self.operation(function() {\n      if (options.fullLines != false) {\n        var lastLineHasText = nonWS.test(self.getLine(end));\n        self.replaceRange(pad + endString, Pos(end));\n        self.replaceRange(startString + pad, Pos(from.line, 0));\n        var lead = options.blockCommentLead || mode.blockCommentLead;\n        if (lead != null) for (var i = from.line + 1; i <= end; ++i)\n          if (i != end || lastLineHasText)\n            self.replaceRange(lead + pad, Pos(i, 0));\n      } else {\n        self.replaceRange(endString, to);\n        self.replaceRange(startString, from);\n      }\n    });\n  });\n\n  CodeMirror.defineExtension(\"uncomment\", function(from, to, options) {\n    if (!options) options = noOptions;\n    var self = this, mode = self.getModeAt(from);\n    var end = Math.min(to.ch != 0 || to.line == from.line ? to.line : to.line - 1, self.lastLine()), start = Math.min(from.line, end);\n\n    // Try finding line comments\n    var lineString = options.lineComment || mode.lineComment, lines = [];\n    var pad = options.padding == null ? \" \" : options.padding, didSomething;\n    lineComment: {\n      if (!lineString) break lineComment;\n      for (var i = start; i <= end; ++i) {\n        var line = self.getLine(i);\n        var found = line.indexOf(lineString);\n        if (found > -1 && !/comment/.test(self.getTokenTypeAt(Pos(i, found + 1)))) found = -1;\n        if (found == -1 && (i != end || i == start) && nonWS.test(line)) break lineComment;\n        if (found > -1 && nonWS.test(line.slice(0, found))) break lineComment;\n        lines.push(line);\n      }\n      self.operation(function() {\n        for (var i = start; i <= end; ++i) {\n          var line = lines[i - start];\n          var pos = line.indexOf(lineString), endPos = pos + lineString.length;\n          if (pos < 0) continue;\n          if (line.slice(endPos, endPos + pad.length) == pad) endPos += pad.length;\n          didSomething = true;\n          self.replaceRange(\"\", Pos(i, pos), Pos(i, endPos));\n        }\n      });\n      if (didSomething) return true;\n    }\n\n    // Try block comments\n    var startString = options.blockCommentStart || mode.blockCommentStart;\n    var endString = options.blockCommentEnd || mode.blockCommentEnd;\n    if (!startString || !endString) return false;\n    var lead = options.blockCommentLead || mode.blockCommentLead;\n    var startLine = self.getLine(start), endLine = end == start ? startLine : self.getLine(end);\n    var open = startLine.indexOf(startString), close = endLine.lastIndexOf(endString);\n    if (close == -1 && start != end) {\n      endLine = self.getLine(--end);\n      close = endLine.lastIndexOf(endString);\n    }\n    if (open == -1 || close == -1 ||\n        !/comment/.test(self.getTokenTypeAt(Pos(start, open + 1))) ||\n        !/comment/.test(self.getTokenTypeAt(Pos(end, close + 1))))\n      return false;\n\n    // Avoid killing block comments completely outside the selection.\n    // Positions of the last startString before the start of the selection, and the first endString after it.\n    var lastStart = startLine.lastIndexOf(startString, from.ch);\n    var firstEnd = lastStart == -1 ? -1 : startLine.slice(0, from.ch).indexOf(endString, lastStart + startString.length);\n    if (lastStart != -1 && firstEnd != -1 && firstEnd + endString.length != from.ch) return false;\n    // Positions of the first endString after the end of the selection, and the last startString before it.\n    firstEnd = endLine.indexOf(endString, to.ch);\n    var almostLastStart = endLine.slice(to.ch).lastIndexOf(startString, firstEnd - to.ch);\n    lastStart = (firstEnd == -1 || almostLastStart == -1) ? -1 : to.ch + almostLastStart;\n    if (firstEnd != -1 && lastStart != -1 && lastStart != to.ch) return false;\n\n    self.operation(function() {\n      self.replaceRange(\"\", Pos(end, close - (pad && endLine.slice(close - pad.length, close) == pad ? pad.length : 0)),\n                        Pos(end, close + endString.length));\n      var openEnd = open + startString.length;\n      if (pad && startLine.slice(openEnd, openEnd + pad.length) == pad) openEnd += pad.length;\n      self.replaceRange(\"\", Pos(start, open), Pos(start, openEnd));\n      if (lead) for (var i = start + 1; i <= end; ++i) {\n        var line = self.getLine(i), found = line.indexOf(lead);\n        if (found == -1 || nonWS.test(line.slice(0, found))) continue;\n        var foundEnd = found + lead.length;\n        if (pad && line.slice(foundEnd, foundEnd + pad.length) == pad) foundEnd += pad.length;\n        self.replaceRange(\"\", Pos(i, found), Pos(i, foundEnd));\n      }\n    });\n    return true;\n  });\n});\n\n},{\"../../lib/codemirror\":30}],16:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// Open simple dialogs on top of an editor. Relies on dialog.css.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  function dialogDiv(cm, template, bottom) {\n    var wrap = cm.getWrapperElement();\n    var dialog;\n    dialog = wrap.appendChild(document.createElement(\"div\"));\n    if (bottom)\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-bottom\";\n    else\n      dialog.className = \"CodeMirror-dialog CodeMirror-dialog-top\";\n\n    if (typeof template == \"string\") {\n      dialog.innerHTML = template;\n    } else { // Assuming it's a detached DOM element.\n      dialog.appendChild(template);\n    }\n    return dialog;\n  }\n\n  function closeNotification(cm, newVal) {\n    if (cm.state.currentNotificationClose)\n      cm.state.currentNotificationClose();\n    cm.state.currentNotificationClose = newVal;\n  }\n\n  CodeMirror.defineExtension(\"openDialog\", function(template, callback, options) {\n    if (!options) options = {};\n\n    closeNotification(this, null);\n\n    var dialog = dialogDiv(this, template, options.bottom);\n    var closed = false, me = this;\n    function close(newVal) {\n      if (typeof newVal == 'string') {\n        inp.value = newVal;\n      } else {\n        if (closed) return;\n        closed = true;\n        dialog.parentNode.removeChild(dialog);\n        me.focus();\n\n        if (options.onClose) options.onClose(dialog);\n      }\n    }\n\n    var inp = dialog.getElementsByTagName(\"input\")[0], button;\n    if (inp) {\n      if (options.value) {\n        inp.value = options.value;\n        if (options.selectValueOnOpen !== false) {\n          inp.select();\n        }\n      }\n\n      if (options.onInput)\n        CodeMirror.on(inp, \"input\", function(e) { options.onInput(e, inp.value, close);});\n      if (options.onKeyUp)\n        CodeMirror.on(inp, \"keyup\", function(e) {options.onKeyUp(e, inp.value, close);});\n\n      CodeMirror.on(inp, \"keydown\", function(e) {\n        if (options && options.onKeyDown && options.onKeyDown(e, inp.value, close)) { return; }\n        if (e.keyCode == 27 || (options.closeOnEnter !== false && e.keyCode == 13)) {\n          inp.blur();\n          CodeMirror.e_stop(e);\n          close();\n        }\n        if (e.keyCode == 13) callback(inp.value, e);\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(inp, \"blur\", close);\n\n      inp.focus();\n    } else if (button = dialog.getElementsByTagName(\"button\")[0]) {\n      CodeMirror.on(button, \"click\", function() {\n        close();\n        me.focus();\n      });\n\n      if (options.closeOnBlur !== false) CodeMirror.on(button, \"blur\", close);\n\n      button.focus();\n    }\n    return close;\n  });\n\n  CodeMirror.defineExtension(\"openConfirm\", function(template, callbacks, options) {\n    closeNotification(this, null);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var buttons = dialog.getElementsByTagName(\"button\");\n    var closed = false, me = this, blurring = 1;\n    function close() {\n      if (closed) return;\n      closed = true;\n      dialog.parentNode.removeChild(dialog);\n      me.focus();\n    }\n    buttons[0].focus();\n    for (var i = 0; i < buttons.length; ++i) {\n      var b = buttons[i];\n      (function(callback) {\n        CodeMirror.on(b, \"click\", function(e) {\n          CodeMirror.e_preventDefault(e);\n          close();\n          if (callback) callback(me);\n        });\n      })(callbacks[i]);\n      CodeMirror.on(b, \"blur\", function() {\n        --blurring;\n        setTimeout(function() { if (blurring <= 0) close(); }, 200);\n      });\n      CodeMirror.on(b, \"focus\", function() { ++blurring; });\n    }\n  });\n\n  /*\n   * openNotification\n   * Opens a notification, that can be closed with an optional timer\n   * (default 5000ms timer) and always closes on click.\n   *\n   * If a notification is opened while another is opened, it will close the\n   * currently opened one and open the new one immediately.\n   */\n  CodeMirror.defineExtension(\"openNotification\", function(template, options) {\n    closeNotification(this, close);\n    var dialog = dialogDiv(this, template, options && options.bottom);\n    var closed = false, doneTimer;\n    var duration = options && typeof options.duration !== \"undefined\" ? options.duration : 5000;\n\n    function close() {\n      if (closed) return;\n      closed = true;\n      clearTimeout(doneTimer);\n      dialog.parentNode.removeChild(dialog);\n    }\n\n    CodeMirror.on(dialog, 'click', function(e) {\n      CodeMirror.e_preventDefault(e);\n      close();\n    });\n\n    if (duration)\n      doneTimer = setTimeout(close, duration);\n\n    return close;\n  });\n});\n\n},{\"../../lib/codemirror\":30}],17:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  CodeMirror.defineExtension(\"addPanel\", function(node, options) {\n    options = options || {};\n\n    if (!this.state.panels) initPanels(this);\n\n    var info = this.state.panels;\n    var wrapper = info.wrapper;\n    var cmWrapper = this.getWrapperElement();\n\n    if (options.after instanceof Panel && !options.after.cleared) {\n      wrapper.insertBefore(node, options.before.node.nextSibling);\n    } else if (options.before instanceof Panel && !options.before.cleared) {\n      wrapper.insertBefore(node, options.before.node);\n    } else if (options.replace instanceof Panel && !options.replace.cleared) {\n      wrapper.insertBefore(node, options.replace.node);\n      options.replace.clear();\n    } else if (options.position == \"bottom\") {\n      wrapper.appendChild(node);\n    } else if (options.position == \"before-bottom\") {\n      wrapper.insertBefore(node, cmWrapper.nextSibling);\n    } else if (options.position == \"after-top\") {\n      wrapper.insertBefore(node, cmWrapper);\n    } else {\n      wrapper.insertBefore(node, wrapper.firstChild);\n    }\n\n    var height = (options && options.height) || node.offsetHeight;\n    this._setSize(null, info.heightLeft -= height);\n    info.panels++;\n    return new Panel(this, node, options, height);\n  });\n\n  function Panel(cm, node, options, height) {\n    this.cm = cm;\n    this.node = node;\n    this.options = options;\n    this.height = height;\n    this.cleared = false;\n  }\n\n  Panel.prototype.clear = function() {\n    if (this.cleared) return;\n    this.cleared = true;\n    var info = this.cm.state.panels;\n    this.cm._setSize(null, info.heightLeft += this.height);\n    info.wrapper.removeChild(this.node);\n    if (--info.panels == 0) removePanels(this.cm);\n  };\n\n  Panel.prototype.changed = function(height) {\n    var newHeight = height == null ? this.node.offsetHeight : height;\n    var info = this.cm.state.panels;\n    this.cm._setSize(null, info.height += (newHeight - this.height));\n    this.height = newHeight;\n  };\n\n  function initPanels(cm) {\n    var wrap = cm.getWrapperElement();\n    var style = window.getComputedStyle ? window.getComputedStyle(wrap) : wrap.currentStyle;\n    var height = parseInt(style.height);\n    var info = cm.state.panels = {\n      setHeight: wrap.style.height,\n      heightLeft: height,\n      panels: 0,\n      wrapper: document.createElement(\"div\")\n    };\n    wrap.parentNode.insertBefore(info.wrapper, wrap);\n    var hasFocus = cm.hasFocus();\n    info.wrapper.appendChild(wrap);\n    if (hasFocus) cm.focus();\n\n    cm._setSize = cm.setSize;\n    if (height != null) cm.setSize = function(width, newHeight) {\n      if (newHeight == null) return this._setSize(width, newHeight);\n      info.setHeight = newHeight;\n      if (typeof newHeight != \"number\") {\n        var px = /^(\\d+\\.?\\d*)px$/.exec(newHeight);\n        if (px) {\n          newHeight = Number(px[1]);\n        } else {\n          info.wrapper.style.height = newHeight;\n          newHeight = info.wrapper.offsetHeight;\n          info.wrapper.style.height = \"\";\n        }\n      }\n      cm._setSize(width, info.heightLeft += (newHeight - height));\n      height = newHeight;\n    };\n  }\n\n  function removePanels(cm) {\n    var info = cm.state.panels;\n    cm.state.panels = null;\n\n    var wrap = cm.getWrapperElement();\n    info.wrapper.parentNode.replaceChild(wrap, info.wrapper);\n    wrap.style.height = info.setHeight;\n    cm.setSize = cm._setSize;\n    cm.setSize();\n  }\n});\n\n},{\"../../lib/codemirror\":30}],18:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"rulers\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      clearRulers(cm);\n      cm.off(\"refresh\", refreshRulers);\n    }\n    if (val && val.length) {\n      setRulers(cm);\n      cm.on(\"refresh\", refreshRulers);\n    }\n  });\n\n  function clearRulers(cm) {\n    for (var i = cm.display.lineSpace.childNodes.length - 1; i >= 0; i--) {\n      var node = cm.display.lineSpace.childNodes[i];\n      if (/(^|\\s)CodeMirror-ruler($|\\s)/.test(node.className))\n        node.parentNode.removeChild(node);\n    }\n  }\n\n  function setRulers(cm) {\n    var val = cm.getOption(\"rulers\");\n    var cw = cm.defaultCharWidth();\n    var left = cm.charCoords(CodeMirror.Pos(cm.firstLine(), 0), \"div\").left;\n    var minH = cm.display.scroller.offsetHeight + 30;\n    for (var i = 0; i < val.length; i++) {\n      var elt = document.createElement(\"div\");\n      elt.className = \"CodeMirror-ruler\";\n      var col, conf = val[i];\n      if (typeof conf == \"number\") {\n        col = conf;\n      } else {\n        col = conf.column;\n        if (conf.className) elt.className += \" \" + conf.className;\n        if (conf.color) elt.style.borderColor = conf.color;\n        if (conf.lineStyle) elt.style.borderLeftStyle = conf.lineStyle;\n        if (conf.width) elt.style.borderLeftWidth = conf.width;\n      }\n      elt.style.left = (left + col * cw) + \"px\";\n      elt.style.top = \"-50px\";\n      elt.style.bottom = \"-20px\";\n      elt.style.minHeight = minH + \"px\";\n      cm.display.lineSpace.insertBefore(elt, cm.display.cursorDiv);\n    }\n  }\n\n  function refreshRulers(cm) {\n    clearRulers(cm);\n    setRulers(cm);\n  }\n});\n\n},{\"../../lib/codemirror\":30}],19:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var defaults = {\n    pairs: \"()[]{}''\\\"\\\"\",\n    triples: \"\",\n    explode: \"[]{}\"\n  };\n\n  var Pos = CodeMirror.Pos;\n\n  CodeMirror.defineOption(\"autoCloseBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.removeKeyMap(keyMap);\n      cm.state.closeBrackets = null;\n    }\n    if (val) {\n      cm.state.closeBrackets = val;\n      cm.addKeyMap(keyMap);\n    }\n  });\n\n  function getOption(conf, name) {\n    if (name == \"pairs\" && typeof conf == \"string\") return conf;\n    if (typeof conf == \"object\" && conf[name] != null) return conf[name];\n    return defaults[name];\n  }\n\n  var bind = defaults.pairs + \"`\";\n  var keyMap = {Backspace: handleBackspace, Enter: handleEnter};\n  for (var i = 0; i < bind.length; i++)\n    keyMap[\"'\" + bind.charAt(i) + \"'\"] = handler(bind.charAt(i));\n\n  function handler(ch) {\n    return function(cm) { return handleChar(cm, ch); };\n  }\n\n  function getConfig(cm) {\n    var deflt = cm.state.closeBrackets;\n    if (!deflt) return null;\n    var mode = cm.getModeAt(cm.getCursor());\n    return mode.closeBrackets || deflt;\n  }\n\n  function handleBackspace(cm) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || pairs.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var cur = ranges[i].head;\n      cm.replaceRange(\"\", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1));\n    }\n  }\n\n  function handleEnter(cm) {\n    var conf = getConfig(cm);\n    var explode = conf && getOption(conf, \"explode\");\n    if (!explode || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || explode.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    cm.operation(function() {\n      cm.replaceSelection(\"\\n\\n\", null);\n      cm.execCommand(\"goCharLeft\");\n      ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var line = ranges[i].head.line;\n        cm.indentLine(line, null, true);\n        cm.indentLine(line + 1, null, true);\n      }\n    });\n  }\n\n  function contractSelection(sel) {\n    var inverted = CodeMirror.cmpPos(sel.anchor, sel.head) > 0;\n    return {anchor: new Pos(sel.anchor.line, sel.anchor.ch + (inverted ? -1 : 1)),\n            head: new Pos(sel.head.line, sel.head.ch + (inverted ? 1 : -1))};\n  }\n\n  function handleChar(cm, ch) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var pos = pairs.indexOf(ch);\n    if (pos == -1) return CodeMirror.Pass;\n    var triples = getOption(conf, \"triples\");\n\n    var identical = pairs.charAt(pos + 1) == ch;\n    var ranges = cm.listSelections();\n    var opening = pos % 2 == 0;\n\n    var type, next;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], cur = range.head, curType;\n      var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));\n      if (opening && !range.empty()) {\n        curType = \"surround\";\n      } else if ((identical || !opening) && next == ch) {\n        if (triples.indexOf(ch) >= 0 && cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == ch + ch + ch)\n          curType = \"skipThree\";\n        else\n          curType = \"skip\";\n      } else if (identical && cur.ch > 1 && triples.indexOf(ch) >= 0 &&\n                 cm.getRange(Pos(cur.line, cur.ch - 2), cur) == ch + ch &&\n                 (cur.ch <= 2 || cm.getRange(Pos(cur.line, cur.ch - 3), Pos(cur.line, cur.ch - 2)) != ch)) {\n        curType = \"addFour\";\n      } else if (identical) {\n        if (!CodeMirror.isWordChar(next) && enteringString(cm, cur, ch)) curType = \"both\";\n        else return CodeMirror.Pass;\n      } else if (opening && (cm.getLine(cur.line).length == cur.ch ||\n                             isClosingBracket(next, pairs) ||\n                             /\\s/.test(next))) {\n        curType = \"both\";\n      } else {\n        return CodeMirror.Pass;\n      }\n      if (!type) type = curType;\n      else if (type != curType) return CodeMirror.Pass;\n    }\n\n    var left = pos % 2 ? pairs.charAt(pos - 1) : ch;\n    var right = pos % 2 ? ch : pairs.charAt(pos + 1);\n    cm.operation(function() {\n      if (type == \"skip\") {\n        cm.execCommand(\"goCharRight\");\n      } else if (type == \"skipThree\") {\n        for (var i = 0; i < 3; i++)\n          cm.execCommand(\"goCharRight\");\n      } else if (type == \"surround\") {\n        var sels = cm.getSelections();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = left + sels[i] + right;\n        cm.replaceSelections(sels, \"around\");\n        sels = cm.listSelections().slice();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = contractSelection(sels[i]);\n        cm.setSelections(sels);\n      } else if (type == \"both\") {\n        cm.replaceSelection(left + right, null);\n        cm.triggerElectric(left + right);\n        cm.execCommand(\"goCharLeft\");\n      } else if (type == \"addFour\") {\n        cm.replaceSelection(left + left + left + left, \"before\");\n        cm.execCommand(\"goCharRight\");\n      }\n    });\n  }\n\n  function isClosingBracket(ch, pairs) {\n    var pos = pairs.lastIndexOf(ch);\n    return pos > -1 && pos % 2 == 1;\n  }\n\n  function charsAround(cm, pos) {\n    var str = cm.getRange(Pos(pos.line, pos.ch - 1),\n                          Pos(pos.line, pos.ch + 1));\n    return str.length == 2 ? str : null;\n  }\n\n  // Project the token type that will exists after the given char is\n  // typed, and use it to determine whether it would cause the start\n  // of a string token.\n  function enteringString(cm, pos, ch) {\n    var line = cm.getLine(pos.line);\n    var token = cm.getTokenAt(pos);\n    if (/\\bstring2?\\b/.test(token.type)) return false;\n    var stream = new CodeMirror.StringStream(line.slice(0, pos.ch) + ch + line.slice(pos.ch), 4);\n    stream.pos = stream.start = token.start;\n    for (;;) {\n      var type1 = cm.getMode().token(stream, token.state);\n      if (stream.pos >= pos.ch + 1) return /\\bstring2?\\b/.test(type1);\n      stream.start = stream.pos;\n    }\n  }\n});\n\n},{\"../../lib/codemirror\":30}],20:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var ie_lt8 = /MSIE \\d/.test(navigator.userAgent) &&\n    (document.documentMode == null || document.documentMode < 8);\n\n  var Pos = CodeMirror.Pos;\n\n  var matching = {\"(\": \")>\", \")\": \"(<\", \"[\": \"]>\", \"]\": \"[<\", \"{\": \"}>\", \"}\": \"{<\"};\n\n  function findMatchingBracket(cm, where, strict, config) {\n    var line = cm.getLineHandle(where.line), pos = where.ch - 1;\n    var match = (pos >= 0 && matching[line.text.charAt(pos)]) || matching[line.text.charAt(++pos)];\n    if (!match) return null;\n    var dir = match.charAt(1) == \">\" ? 1 : -1;\n    if (strict && (dir > 0) != (pos == where.ch)) return null;\n    var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));\n\n    var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style || null, config);\n    if (found == null) return null;\n    return {from: Pos(where.line, pos), to: found && found.pos,\n            match: found && found.ch == match.charAt(0), forward: dir > 0};\n  }\n\n  // bracketRegex is used to specify which type of bracket to scan\n  // should be a regexp, e.g. /[[\\]]/\n  //\n  // Note: If \"where\" is on an open bracket, then this bracket is ignored.\n  //\n  // Returns false when no bracket was found, null when it reached\n  // maxScanLines and gave up\n  function scanForBracket(cm, where, dir, style, config) {\n    var maxScanLen = (config && config.maxScanLineLength) || 10000;\n    var maxScanLines = (config && config.maxScanLines) || 1000;\n\n    var stack = [];\n    var re = config && config.bracketRegex ? config.bracketRegex : /[(){}[\\]]/;\n    var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1)\n                          : Math.max(cm.firstLine() - 1, where.line - maxScanLines);\n    for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {\n      var line = cm.getLine(lineNo);\n      if (!line) continue;\n      var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1;\n      if (line.length > maxScanLen) continue;\n      if (lineNo == where.line) pos = where.ch - (dir < 0 ? 1 : 0);\n      for (; pos != end; pos += dir) {\n        var ch = line.charAt(pos);\n        if (re.test(ch) && (style === undefined || cm.getTokenTypeAt(Pos(lineNo, pos + 1)) == style)) {\n          var match = matching[ch];\n          if ((match.charAt(1) == \">\") == (dir > 0)) stack.push(ch);\n          else if (!stack.length) return {pos: Pos(lineNo, pos), ch: ch};\n          else stack.pop();\n        }\n      }\n    }\n    return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;\n  }\n\n  function matchBrackets(cm, autoclear, config) {\n    // Disable brace matching in long lines, since it'll cause hugely slow updates\n    var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000;\n    var marks = [], ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, false, config);\n      if (match && cm.getLine(match.from.line).length <= maxHighlightLen) {\n        var style = match.match ? \"CodeMirror-matchingbracket\" : \"CodeMirror-nonmatchingbracket\";\n        marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), {className: style}));\n        if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen)\n          marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), {className: style}));\n      }\n    }\n\n    if (marks.length) {\n      // Kludge to work around the IE bug from issue #1193, where text\n      // input stops going to the textare whever this fires.\n      if (ie_lt8 && cm.state.focused) cm.focus();\n\n      var clear = function() {\n        cm.operation(function() {\n          for (var i = 0; i < marks.length; i++) marks[i].clear();\n        });\n      };\n      if (autoclear) setTimeout(clear, 800);\n      else return clear;\n    }\n  }\n\n  var currentlyHighlighted = null;\n  function doMatchBrackets(cm) {\n    cm.operation(function() {\n      if (currentlyHighlighted) {currentlyHighlighted(); currentlyHighlighted = null;}\n      currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);\n    });\n  }\n\n  CodeMirror.defineOption(\"matchBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init)\n      cm.off(\"cursorActivity\", doMatchBrackets);\n    if (val) {\n      cm.state.matchBrackets = typeof val == \"object\" ? val : {};\n      cm.on(\"cursorActivity\", doMatchBrackets);\n    }\n  });\n\n  CodeMirror.defineExtension(\"matchBrackets\", function() {matchBrackets(this, true);});\n  CodeMirror.defineExtension(\"findMatchingBracket\", function(pos, strict, config){\n    return findMatchingBracket(this, pos, strict, config);\n  });\n  CodeMirror.defineExtension(\"scanForBracket\", function(pos, dir, style, config){\n    return scanForBracket(this, pos, dir, style, config);\n  });\n});\n\n},{\"../../lib/codemirror\":30}],21:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function doFold(cm, pos, options, force) {\n    if (options && options.call) {\n      var finder = options;\n      options = null;\n    } else {\n      var finder = getOption(cm, options, \"rangeFinder\");\n    }\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\n    var minSize = getOption(cm, options, \"minFoldSize\");\n\n    function getRange(allowFolded) {\n      var range = finder(cm, pos);\n      if (!range || range.to.line - range.from.line < minSize) return null;\n      var marks = cm.findMarksAt(range.from);\n      for (var i = 0; i < marks.length; ++i) {\n        if (marks[i].__isFold && force !== \"fold\") {\n          if (!allowFolded) return null;\n          range.cleared = true;\n          marks[i].clear();\n        }\n      }\n      return range;\n    }\n\n    var range = getRange(true);\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\n      pos = CodeMirror.Pos(pos.line - 1, 0);\n      range = getRange(false);\n    }\n    if (!range || range.cleared || force === \"unfold\") return;\n\n    var myWidget = makeWidget(cm, options);\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\n      myRange.clear();\n      CodeMirror.e_preventDefault(e);\n    });\n    var myRange = cm.markText(range.from, range.to, {\n      replacedWith: myWidget,\n      clearOnEnter: true,\n      __isFold: true\n    });\n    myRange.on(\"clear\", function(from, to) {\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\n    });\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\n  }\n\n  function makeWidget(cm, options) {\n    var widget = getOption(cm, options, \"widget\");\n    if (typeof widget == \"string\") {\n      var text = document.createTextNode(widget);\n      widget = document.createElement(\"span\");\n      widget.appendChild(text);\n      widget.className = \"CodeMirror-foldmarker\";\n    }\n    return widget;\n  }\n\n  // Clumsy backwards-compatible interface\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\n  };\n\n  // New-style interface\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\n    doFold(this, pos, options, force);\n  });\n\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\n    var marks = this.findMarksAt(pos);\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold) return true;\n  });\n\n  CodeMirror.commands.toggleFold = function(cm) {\n    cm.foldCode(cm.getCursor());\n  };\n  CodeMirror.commands.fold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"fold\");\n  };\n  CodeMirror.commands.unfold = function(cm) {\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\n  };\n  CodeMirror.commands.foldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\n    });\n  };\n  CodeMirror.commands.unfoldAll = function(cm) {\n    cm.operation(function() {\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\n    });\n  };\n\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\n    var funcs = Array.prototype.slice.call(arguments, 0);\n    return function(cm, start) {\n      for (var i = 0; i < funcs.length; ++i) {\n        var found = funcs[i](cm, start);\n        if (found) return found;\n      }\n    };\n  });\n\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\n    var helpers = cm.getHelpers(start, \"fold\");\n    for (var i = 0; i < helpers.length; i++) {\n      var cur = helpers[i](cm, start);\n      if (cur) return cur;\n    }\n  });\n\n  var defaultOptions = {\n    rangeFinder: CodeMirror.fold.auto,\n    widget: \"\\u2194\",\n    minFoldSize: 0,\n    scanUp: false\n  };\n\n  CodeMirror.defineOption(\"foldOptions\", null);\n\n  function getOption(cm, options, name) {\n    if (options && options[name] !== undefined)\n      return options[name];\n    var editorOptions = cm.options.foldOptions;\n    if (editorOptions && editorOptions[name] !== undefined)\n      return editorOptions[name];\n    return defaultOptions[name];\n  }\n\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\n    return getOption(this, options, name);\n  });\n});\n\n},{\"../../lib/codemirror\":30}],22:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"), _dereq_(\"./foldcode\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\n      cm.state.foldGutter = null;\n      cm.off(\"gutterClick\", onGutterClick);\n      cm.off(\"change\", onChange);\n      cm.off(\"viewportChange\", onViewportChange);\n      cm.off(\"fold\", onFold);\n      cm.off(\"unfold\", onFold);\n      cm.off(\"swapDoc\", updateInViewport);\n    }\n    if (val) {\n      cm.state.foldGutter = new State(parseOptions(val));\n      updateInViewport(cm);\n      cm.on(\"gutterClick\", onGutterClick);\n      cm.on(\"change\", onChange);\n      cm.on(\"viewportChange\", onViewportChange);\n      cm.on(\"fold\", onFold);\n      cm.on(\"unfold\", onFold);\n      cm.on(\"swapDoc\", updateInViewport);\n    }\n  });\n\n  var Pos = CodeMirror.Pos;\n\n  function State(options) {\n    this.options = options;\n    this.from = this.to = 0;\n  }\n\n  function parseOptions(opts) {\n    if (opts === true) opts = {};\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\n    return opts;\n  }\n\n  function isFolded(cm, line) {\n    var marks = cm.findMarksAt(Pos(line));\n    for (var i = 0; i < marks.length; ++i)\n      if (marks[i].__isFold && marks[i].find().from.line == line) return marks[i];\n  }\n\n  function marker(spec) {\n    if (typeof spec == \"string\") {\n      var elt = document.createElement(\"div\");\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\n      return elt;\n    } else {\n      return spec.cloneNode(true);\n    }\n  }\n\n  function updateFoldInfo(cm, from, to) {\n    var opts = cm.state.foldGutter.options, cur = from;\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\n    var func = cm.foldOption(opts, \"rangeFinder\");\n    cm.eachLine(from, to, function(line) {\n      var mark = null;\n      if (isFolded(cm, cur)) {\n        mark = marker(opts.indicatorFolded);\n      } else {\n        var pos = Pos(cur, 0);\n        var range = func && func(cm, pos);\n        if (range && range.to.line - range.from.line >= minSize)\n          mark = marker(opts.indicatorOpen);\n      }\n      cm.setGutterMarker(line, opts.gutter, mark);\n      ++cur;\n    });\n  }\n\n  function updateInViewport(cm) {\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\n    if (!state) return;\n    cm.operation(function() {\n      updateFoldInfo(cm, vp.from, vp.to);\n    });\n    state.from = vp.from; state.to = vp.to;\n  }\n\n  function onGutterClick(cm, line, gutter) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    if (gutter != opts.gutter) return;\n    var folded = isFolded(cm, line);\n    if (folded) folded.clear();\n    else cm.foldCode(Pos(line, 0), opts.rangeFinder);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    state.from = state.to = 0;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\n  }\n\n  function onViewportChange(cm) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var opts = state.options;\n    clearTimeout(state.changeUpdate);\n    state.changeUpdate = setTimeout(function() {\n      var vp = cm.getViewport();\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\n        updateInViewport(cm);\n      } else {\n        cm.operation(function() {\n          if (vp.from < state.from) {\n            updateFoldInfo(cm, vp.from, state.from);\n            state.from = vp.from;\n          }\n          if (vp.to > state.to) {\n            updateFoldInfo(cm, state.to, vp.to);\n            state.to = vp.to;\n          }\n        });\n      }\n    }, opts.updateViewportTimeSpan || 400);\n  }\n\n  function onFold(cm, from) {\n    var state = cm.state.foldGutter;\n    if (!state) return;\n    var line = from.line;\n    if (line >= state.from && line < state.to)\n      updateFoldInfo(cm, line, line + 1);\n  }\n});\n\n},{\"../../lib/codemirror\":30,\"./foldcode\":21}],23:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.registerHelper(\"fold\", \"indent\", function(cm, start) {\n  var tabSize = cm.getOption(\"tabSize\"), firstLine = cm.getLine(start.line);\n  if (!/\\S/.test(firstLine)) return;\n  var getIndent = function(line) {\n    return CodeMirror.countColumn(line, null, tabSize);\n  };\n  var myIndent = getIndent(firstLine);\n  var lastLineInFold = null;\n  // Go through lines until we find a line that definitely doesn't belong in\n  // the block we're folding, or to the end.\n  for (var i = start.line + 1, end = cm.lastLine(); i <= end; ++i) {\n    var curLine = cm.getLine(i);\n    var curIndent = getIndent(curLine);\n    if (curIndent > myIndent) {\n      // Lines with a greater indent are considered part of the block.\n      lastLineInFold = i;\n    } else if (!/\\S/.test(curLine)) {\n      // Empty lines might be breaks within the block we're trying to fold.\n    } else {\n      // A non-empty line at an indent equal to or less than ours marks the\n      // start of another block.\n      break;\n    }\n  }\n  if (lastLineInFold) return {\n    from: CodeMirror.Pos(start.line, firstLine.length),\n    to: CodeMirror.Pos(lastLineInFold, cm.getLine(lastLineInFold).length)\n  };\n});\n\n});\n\n},{\"../../lib/codemirror\":30}],24:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var Pos = CodeMirror.Pos;\n\n  function forEach(arr, f) {\n    for (var i = 0, e = arr.length; i < e; ++i) f(arr[i]);\n  }\n\n  function arrayContains(arr, item) {\n    if (!Array.prototype.indexOf) {\n      var i = arr.length;\n      while (i--) {\n        if (arr[i] === item) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return arr.indexOf(item) != -1;\n  }\n\n  function scriptHint(editor, keywords, getToken, options) {\n    // Find the token at the cursor\n    var cur = editor.getCursor(), token = getToken(editor, cur);\n    if (/\\b(?:string|comment)\\b/.test(token.type)) return;\n    token.state = CodeMirror.innerMode(editor.getMode(), token.state).state;\n\n    // If it's not a 'word-style' token, ignore the token.\n    if (!/^[\\w$_]*$/.test(token.string)) {\n      token = {start: cur.ch, end: cur.ch, string: \"\", state: token.state,\n               type: token.string == \".\" ? \"property\" : null};\n    } else if (token.end > cur.ch) {\n      token.end = cur.ch;\n      token.string = token.string.slice(0, cur.ch - token.start);\n    }\n\n    var tprop = token;\n    // If it is a property, find out what it is a property of.\n    while (tprop.type == \"property\") {\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string != \".\") return;\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (!context) var context = [];\n      context.push(tprop);\n    }\n    return {list: getCompletions(token, context, keywords, options),\n            from: Pos(cur.line, token.start),\n            to: Pos(cur.line, token.end)};\n  }\n\n  function javascriptHint(editor, options) {\n    return scriptHint(editor, javascriptKeywords,\n                      function (e, cur) {return e.getTokenAt(cur);},\n                      options);\n  };\n  CodeMirror.registerHelper(\"hint\", \"javascript\", javascriptHint);\n\n  function getCoffeeScriptToken(editor, cur) {\n  // This getToken, it is for coffeescript, imitates the behavior of\n  // getTokenAt method in javascript.js, that is, returning \"property\"\n  // type and treat \".\" as indepenent token.\n    var token = editor.getTokenAt(cur);\n    if (cur.ch == token.start + 1 && token.string.charAt(0) == '.') {\n      token.end = token.start;\n      token.string = '.';\n      token.type = \"property\";\n    }\n    else if (/^\\.[\\w$_]*$/.test(token.string)) {\n      token.type = \"property\";\n      token.start++;\n      token.string = token.string.replace(/\\./, '');\n    }\n    return token;\n  }\n\n  function coffeescriptHint(editor, options) {\n    return scriptHint(editor, coffeescriptKeywords, getCoffeeScriptToken, options);\n  }\n  CodeMirror.registerHelper(\"hint\", \"coffeescript\", coffeescriptHint);\n\n  var stringProps = (\"charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight \" +\n                     \"toUpperCase toLowerCase split concat match replace search\").split(\" \");\n  var arrayProps = (\"length concat join splice push pop shift unshift slice reverse sort indexOf \" +\n                    \"lastIndexOf every some filter forEach map reduce reduceRight \").split(\" \");\n  var funcProps = \"prototype apply call bind\".split(\" \");\n  var javascriptKeywords = (\"break case catch continue debugger default delete do else false finally for function \" +\n                  \"if in instanceof new null return switch throw true try typeof var void while with\").split(\" \");\n  var coffeescriptKeywords = (\"and break catch class continue delete do else extends false finally for \" +\n                  \"if in instanceof isnt new no not null of off on or return switch then throw true try typeof until void while with yes\").split(\" \");\n\n  function getCompletions(token, context, keywords, options) {\n    var found = [], start = token.string, global = options && options.globalScope || window;\n    function maybeAdd(str) {\n      if (str.lastIndexOf(start, 0) == 0 && !arrayContains(found, str)) found.push(str);\n    }\n    function gatherCompletions(obj) {\n      if (typeof obj == \"string\") forEach(stringProps, maybeAdd);\n      else if (obj instanceof Array) forEach(arrayProps, maybeAdd);\n      else if (obj instanceof Function) forEach(funcProps, maybeAdd);\n      for (var name in obj) maybeAdd(name);\n    }\n\n    if (context && context.length) {\n      // If this is a property, see if it belongs to some object we can\n      // find in the current environment.\n      var obj = context.pop(), base;\n      if (obj.type && obj.type.indexOf(\"variable\") === 0) {\n        if (options && options.additionalContext)\n          base = options.additionalContext[obj.string];\n        if (!options || options.useGlobalScope !== false)\n          base = base || global[obj.string];\n      } else if (obj.type == \"string\") {\n        base = \"\";\n      } else if (obj.type == \"atom\") {\n        base = 1;\n      } else if (obj.type == \"function\") {\n        if (global.jQuery != null && (obj.string == '$' || obj.string == 'jQuery') &&\n            (typeof global.jQuery == 'function'))\n          base = global.jQuery();\n        else if (global._ != null && (obj.string == '_') && (typeof global._ == 'function'))\n          base = global._();\n      }\n      while (base != null && context.length)\n        base = base[context.pop().string];\n      if (base != null) gatherCompletions(base);\n    } else {\n      // If not, just look in the global object and any local scope\n      // (reading into JS mode internals to get at the local and global variables)\n      for (var v = token.state.localVars; v; v = v.next) maybeAdd(v.name);\n      for (var v = token.state.globalVars; v; v = v.next) maybeAdd(v.name);\n      if (!options || options.useGlobalScope !== false)\n        gatherCompletions(global);\n      forEach(keywords, maybeAdd);\n    }\n    return found;\n  }\n});\n\n},{\"../../lib/codemirror\":30}],25:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    var self = this;\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      this.cm.off(\"cursorActivity\", this.activityFunc);\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion), completion.from || data.from,\n                                completion.to || data.to, \"complete\");\n      CodeMirror.signal(data, \"pick\", completion);\n      this.close();\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < this.startPos.ch || this.cm.somethingSelected() ||\n          (pos.ch && this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return;\n      if (!this.options.hint.async) {\n        this.finishUpdate(this.options.hint(this.cm, this.options), first);\n      } else {\n        var myTick = ++this.tick, self = this;\n        this.options.hint(this.cm, function(data) {\n          if (self.tick == myTick) self.finishUpdate(data, first);\n        }, this.options);\n      }\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n      if (data && this.data && CodeMirror.cmpPos(data.from, this.data.from)) data = null;\n      this.data = data;\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    hints.className = \"CodeMirror-hints\";\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n    (completion.options.container || document.body).appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    var startScroll = cm.getScrollInfo();\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[0], hints.firstChild);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var async = false, resolved\n      for (var i = 0; i < helpers.length; i++) if (helpers[i].async) async = true\n      if (async) {\n        resolved = function(cm, callback, options) {\n          var app = applicableHelpers(cm, helpers)\n          function run(i, result) {\n            if (i == app.length) return callback(null)\n            var helper = app[i]\n            if (helper.async) {\n              helper(cm, function(result) {\n                if (result) callback(result)\n                else run(i + 1)\n              }, options)\n            } else {\n              var result = helper(cm, options)\n              if (result) callback(result)\n              else run(i + 1)\n            }\n          }\n          run(0)\n        }\n        resolved.async = true\n      } else {\n        resolved = function(cm, options) {\n          var app = applicableHelpers(cm, helpers)\n          for (var i = 0; i < app.length; i++) {\n            var cur = app[i](cm, options)\n            if (cur && cur.list.length) return cur\n          }\n        }\n      }\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\n    var to = CodeMirror.Pos(cur.line, token.end);\n    if (token.string && /\\w/.test(token.string[token.string.length - 1])) {\n      var term = token.string, from = CodeMirror.Pos(cur.line, token.start);\n    } else {\n      var term = \"\", from = to;\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: false,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n\n},{\"../../lib/codemirror\":30}],26:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// Define search commands. Depends on dialog.js or another\n// implementation of the openDialog method.\n\n// Replace works a little oddly -- it will do the replace on the next\n// Ctrl-G (or whatever is bound to findNext) press. You prevent a\n// replace by making sure the match is no longer selected when hitting\n// Ctrl-G.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"), _dereq_(\"./searchcursor\"), _dereq_(\"../dialog/dialog\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"./searchcursor\", \"../dialog/dialog\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  function searchOverlay(query, caseInsensitive) {\n    if (typeof query == \"string\")\n      query = new RegExp(query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), caseInsensitive ? \"gi\" : \"g\");\n    else if (!query.global)\n      query = new RegExp(query.source, query.ignoreCase ? \"gi\" : \"g\");\n\n    return {token: function(stream) {\n      query.lastIndex = stream.pos;\n      var match = query.exec(stream.string);\n      if (match && match.index == stream.pos) {\n        stream.pos += match[0].length;\n        return \"searching\";\n      } else if (match) {\n        stream.pos = match.index;\n      } else {\n        stream.skipToEnd();\n      }\n    }};\n  }\n\n  function SearchState() {\n    this.posFrom = this.posTo = this.lastQuery = this.query = null;\n    this.overlay = null;\n  }\n\n  function getSearchState(cm) {\n    return cm.state.search || (cm.state.search = new SearchState());\n  }\n\n  function queryCaseInsensitive(query) {\n    return typeof query == \"string\" && query == query.toLowerCase();\n  }\n\n  function getSearchCursor(cm, query, pos) {\n    // Heuristic: if the query string is all lowercase, do a case insensitive search.\n    return cm.getSearchCursor(query, pos, queryCaseInsensitive(query));\n  }\n\n  function persistentDialog(cm, text, deflt, f) {\n    cm.openDialog(text, f, {\n      value: deflt,\n      selectValueOnOpen: true,\n      closeOnEnter: false,\n      onClose: function() { clearSearch(cm); }\n    });\n  }\n\n  function dialog(cm, text, shortText, deflt, f) {\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true});\n    else f(prompt(shortText, deflt));\n  }\n\n  function confirmDialog(cm, text, shortText, fs) {\n    if (cm.openConfirm) cm.openConfirm(text, fs);\n    else if (confirm(shortText)) fs[0]();\n  }\n\n  function parseString(string) {\n    return string.replace(/\\\\(.)/g, function(_, ch) {\n      if (ch == \"n\") return \"\\n\"\n      if (ch == \"r\") return \"\\r\"\n      return ch\n    })\n  }\n\n  function parseQuery(query) {\n    var isRE = query.match(/^\\/(.*)\\/([a-z]*)$/);\n    if (isRE) {\n      try { query = new RegExp(isRE[1], isRE[2].indexOf(\"i\") == -1 ? \"\" : \"i\"); }\n      catch(e) {} // Not a regular expression after all, do a string search\n    } else {\n      query = parseString(query)\n    }\n    if (typeof query == \"string\" ? query == \"\" : query.test(\"\"))\n      query = /x^/;\n    return query;\n  }\n\n  var queryDialog =\n    'Search: <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">(Use /re/ syntax for regexp search)</span>';\n\n  function startSearch(cm, state, query) {\n    state.queryText = query;\n    state.query = parseQuery(query);\n    cm.removeOverlay(state.overlay, queryCaseInsensitive(state.query));\n    state.overlay = searchOverlay(state.query, queryCaseInsensitive(state.query));\n    cm.addOverlay(state.overlay);\n    if (cm.showMatchesOnScrollbar) {\n      if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n      state.annotate = cm.showMatchesOnScrollbar(state.query, queryCaseInsensitive(state.query));\n    }\n  }\n\n  function doSearch(cm, rev, persistent) {\n    var state = getSearchState(cm);\n    if (state.query) return findNext(cm, rev);\n    var q = cm.getSelection() || state.lastQuery;\n    if (persistent && cm.openDialog) {\n      var hiding = null\n      persistentDialog(cm, queryDialog, q, function(query, event) {\n        CodeMirror.e_stop(event);\n        if (!query) return;\n        if (query != state.queryText) startSearch(cm, state, query);\n        if (hiding) hiding.style.opacity = 1\n        findNext(cm, event.shiftKey, function(_, to) {\n          var dialog\n          if (to.line < 3 && document.querySelector &&\n              (dialog = cm.display.wrapper.querySelector(\".CodeMirror-dialog\")) &&\n              dialog.getBoundingClientRect().bottom - 4 > cm.cursorCoords(to, \"window\").top)\n            (hiding = dialog).style.opacity = .4\n        })\n      });\n    } else {\n      dialog(cm, queryDialog, \"Search for:\", q, function(query) {\n        if (query && !state.query) cm.operation(function() {\n          startSearch(cm, state, query);\n          state.posFrom = state.posTo = cm.getCursor();\n          findNext(cm, rev);\n        });\n      });\n    }\n  }\n\n  function findNext(cm, rev, callback) {cm.operation(function() {\n    var state = getSearchState(cm);\n    var cursor = getSearchCursor(cm, state.query, rev ? state.posFrom : state.posTo);\n    if (!cursor.find(rev)) {\n      cursor = getSearchCursor(cm, state.query, rev ? CodeMirror.Pos(cm.lastLine()) : CodeMirror.Pos(cm.firstLine(), 0));\n      if (!cursor.find(rev)) return;\n    }\n    cm.setSelection(cursor.from(), cursor.to());\n    cm.scrollIntoView({from: cursor.from(), to: cursor.to()}, 20);\n    state.posFrom = cursor.from(); state.posTo = cursor.to();\n    if (callback) callback(cursor.from(), cursor.to())\n  });}\n\n  function clearSearch(cm) {cm.operation(function() {\n    var state = getSearchState(cm);\n    state.lastQuery = state.query;\n    if (!state.query) return;\n    state.query = state.queryText = null;\n    cm.removeOverlay(state.overlay);\n    if (state.annotate) { state.annotate.clear(); state.annotate = null; }\n  });}\n\n  var replaceQueryDialog =\n    ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">(Use /re/ syntax for regexp search)</span>';\n  var replacementQueryDialog = 'With: <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/>';\n  var doReplaceConfirm = \"Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>\";\n\n  function replaceAll(cm, query, text) {\n    cm.operation(function() {\n      for (var cursor = getSearchCursor(cm, query); cursor.findNext();) {\n        if (typeof query != \"string\") {\n          var match = cm.getRange(cursor.from(), cursor.to()).match(query);\n          cursor.replace(text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n        } else cursor.replace(text);\n      }\n    });\n  }\n\n  function replace(cm, all) {\n    if (cm.getOption(\"readOnly\")) return;\n    var query = cm.getSelection() || getSearchState(cm).lastQuery;\n    var dialogText = all ? \"Replace all:\" : \"Replace:\"\n    dialog(cm, dialogText + replaceQueryDialog, dialogText, query, function(query) {\n      if (!query) return;\n      query = parseQuery(query);\n      dialog(cm, replacementQueryDialog, \"Replace with:\", \"\", function(text) {\n        text = parseString(text)\n        if (all) {\n          replaceAll(cm, query, text)\n        } else {\n          clearSearch(cm);\n          var cursor = getSearchCursor(cm, query, cm.getCursor());\n          var advance = function() {\n            var start = cursor.from(), match;\n            if (!(match = cursor.findNext())) {\n              cursor = getSearchCursor(cm, query);\n              if (!(match = cursor.findNext()) ||\n                  (start && cursor.from().line == start.line && cursor.from().ch == start.ch)) return;\n            }\n            cm.setSelection(cursor.from(), cursor.to());\n            cm.scrollIntoView({from: cursor.from(), to: cursor.to()});\n            confirmDialog(cm, doReplaceConfirm, \"Replace?\",\n                          [function() {doReplace(match);}, advance,\n                           function() {replaceAll(cm, query, text)}]);\n          };\n          var doReplace = function(match) {\n            cursor.replace(typeof query == \"string\" ? text :\n                           text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\n            advance();\n          };\n          advance();\n        }\n      });\n    });\n  }\n\n  CodeMirror.commands.find = function(cm) {clearSearch(cm); doSearch(cm);};\n  CodeMirror.commands.findPersistent = function(cm) {clearSearch(cm); doSearch(cm, false, true);};\n  CodeMirror.commands.findNext = doSearch;\n  CodeMirror.commands.findPrev = function(cm) {doSearch(cm, true);};\n  CodeMirror.commands.clearSearch = clearSearch;\n  CodeMirror.commands.replace = replace;\n  CodeMirror.commands.replaceAll = function(cm) {replace(cm, true);};\n});\n\n},{\"../../lib/codemirror\":30,\"../dialog/dialog\":16,\"./searchcursor\":27}],27:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n  var Pos = CodeMirror.Pos;\n\n  function SearchCursor(doc, query, pos, caseFold) {\n    this.atOccurrence = false; this.doc = doc;\n    if (caseFold == null && typeof query == \"string\") caseFold = false;\n\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0);\n    this.pos = {from: pos, to: pos};\n\n    // The matches method is filled in based on the type of query.\n    // It takes a position and a direction, and returns an object\n    // describing the next occurrence of the query, or null if no\n    // more matches were found.\n    if (typeof query != \"string\") { // Regexp match\n      if (!query.global) query = new RegExp(query.source, query.ignoreCase ? \"ig\" : \"g\");\n      this.matches = function(reverse, pos) {\n        if (reverse) {\n          query.lastIndex = 0;\n          var line = doc.getLine(pos.line).slice(0, pos.ch), cutOff = 0, match, start;\n          for (;;) {\n            query.lastIndex = cutOff;\n            var newMatch = query.exec(line);\n            if (!newMatch) break;\n            match = newMatch;\n            start = match.index;\n            cutOff = match.index + (match[0].length || 1);\n            if (cutOff == line.length) break;\n          }\n          var matchLen = (match && match[0].length) || 0;\n          if (!matchLen) {\n            if (start == 0 && line.length == 0) {match = undefined;}\n            else if (start != doc.getLine(pos.line).length) {\n              matchLen++;\n            }\n          }\n        } else {\n          query.lastIndex = pos.ch;\n          var line = doc.getLine(pos.line), match = query.exec(line);\n          var matchLen = (match && match[0].length) || 0;\n          var start = match && match.index;\n          if (start + matchLen != line.length && !matchLen) matchLen = 1;\n        }\n        if (match && matchLen)\n          return {from: Pos(pos.line, start),\n                  to: Pos(pos.line, start + matchLen),\n                  match: match};\n      };\n    } else { // String query\n      var origQuery = query;\n      if (caseFold) query = query.toLowerCase();\n      var fold = caseFold ? function(str){return str.toLowerCase();} : function(str){return str;};\n      var target = query.split(\"\\n\");\n      // Different methods for single-line and multi-line queries\n      if (target.length == 1) {\n        if (!query.length) {\n          // Empty string would match anything and never progress, so\n          // we define it to match nothing instead.\n          this.matches = function() {};\n        } else {\n          this.matches = function(reverse, pos) {\n            if (reverse) {\n              var orig = doc.getLine(pos.line).slice(0, pos.ch), line = fold(orig);\n              var match = line.lastIndexOf(query);\n              if (match > -1) {\n                match = adjustPos(orig, line, match);\n                return {from: Pos(pos.line, match), to: Pos(pos.line, match + origQuery.length)};\n              }\n             } else {\n               var orig = doc.getLine(pos.line).slice(pos.ch), line = fold(orig);\n               var match = line.indexOf(query);\n               if (match > -1) {\n                 match = adjustPos(orig, line, match) + pos.ch;\n                 return {from: Pos(pos.line, match), to: Pos(pos.line, match + origQuery.length)};\n               }\n            }\n          };\n        }\n      } else {\n        var origTarget = origQuery.split(\"\\n\");\n        this.matches = function(reverse, pos) {\n          var last = target.length - 1;\n          if (reverse) {\n            if (pos.line - (target.length - 1) < doc.firstLine()) return;\n            if (fold(doc.getLine(pos.line).slice(0, origTarget[last].length)) != target[target.length - 1]) return;\n            var to = Pos(pos.line, origTarget[last].length);\n            for (var ln = pos.line - 1, i = last - 1; i >= 1; --i, --ln)\n              if (target[i] != fold(doc.getLine(ln))) return;\n            var line = doc.getLine(ln), cut = line.length - origTarget[0].length;\n            if (fold(line.slice(cut)) != target[0]) return;\n            return {from: Pos(ln, cut), to: to};\n          } else {\n            if (pos.line + (target.length - 1) > doc.lastLine()) return;\n            var line = doc.getLine(pos.line), cut = line.length - origTarget[0].length;\n            if (fold(line.slice(cut)) != target[0]) return;\n            var from = Pos(pos.line, cut);\n            for (var ln = pos.line + 1, i = 1; i < last; ++i, ++ln)\n              if (target[i] != fold(doc.getLine(ln))) return;\n            if (fold(doc.getLine(ln).slice(0, origTarget[last].length)) != target[last]) return;\n            return {from: from, to: Pos(ln, origTarget[last].length)};\n          }\n        };\n      }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false);},\n    findPrevious: function() {return this.find(true);},\n\n    find: function(reverse) {\n      var self = this, pos = this.doc.clipPos(reverse ? this.pos.from : this.pos.to);\n      function savePosAndFail(line) {\n        var pos = Pos(line, 0);\n        self.pos = {from: pos, to: pos};\n        self.atOccurrence = false;\n        return false;\n      }\n\n      for (;;) {\n        if (this.pos = this.matches(reverse, pos)) {\n          this.atOccurrence = true;\n          return this.pos.match || true;\n        }\n        if (reverse) {\n          if (!pos.line) return savePosAndFail(0);\n          pos = Pos(pos.line-1, this.doc.getLine(pos.line-1).length);\n        }\n        else {\n          var maxLine = this.doc.lineCount();\n          if (pos.line == maxLine - 1) return savePosAndFail(maxLine);\n          pos = Pos(pos.line + 1, 0);\n        }\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from;},\n    to: function() {if (this.atOccurrence) return this.pos.to;},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return;\n      var lines = CodeMirror.splitLines(newText);\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin);\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0));\n    }\n  };\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos) {\n    if (orig.length == folded.length) return pos;\n    for (var pos1 = Math.min(pos, orig.length);;) {\n      var len1 = orig.slice(0, pos1).toLowerCase().length;\n      if (len1 < pos) ++pos1;\n      else if (len1 > pos) --pos1;\n      else return pos1;\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold);\n  });\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold);\n  });\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = [];\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold);\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break;\n      ranges.push({anchor: cur.from(), head: cur.to()});\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0);\n  });\n});\n\n},{\"../../lib/codemirror\":30}],28:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var Pos = CodeMirror.Pos;\n\n  function findParagraph(cm, pos, options) {\n    var startRE = options.paragraphStart || cm.getHelper(pos, \"paragraphStart\");\n    for (var start = pos.line, first = cm.firstLine(); start > first; --start) {\n      var line = cm.getLine(start);\n      if (startRE && startRE.test(line)) break;\n      if (!/\\S/.test(line)) { ++start; break; }\n    }\n    var endRE = options.paragraphEnd || cm.getHelper(pos, \"paragraphEnd\");\n    for (var end = pos.line + 1, last = cm.lastLine(); end <= last; ++end) {\n      var line = cm.getLine(end);\n      if (endRE && endRE.test(line)) { ++end; break; }\n      if (!/\\S/.test(line)) break;\n    }\n    return {from: start, to: end};\n  }\n\n  function findBreakPoint(text, column, wrapOn, killTrailingSpace) {\n    for (var at = column; at > 0; --at)\n      if (wrapOn.test(text.slice(at - 1, at + 1))) break;\n    for (var first = true;; first = false) {\n      var endOfText = at;\n      if (killTrailingSpace)\n        while (text.charAt(endOfText - 1) == \" \") --endOfText;\n      if (endOfText == 0 && first) at = column;\n      else return {from: endOfText, to: at};\n    }\n  }\n\n  function wrapRange(cm, from, to, options) {\n    from = cm.clipPos(from); to = cm.clipPos(to);\n    var column = options.column || 80;\n    var wrapOn = options.wrapOn || /\\s\\S|-[^\\.\\d]/;\n    var killTrailing = options.killTrailingSpace !== false;\n    var changes = [], curLine = \"\", curNo = from.line;\n    var lines = cm.getRange(from, to, false);\n    if (!lines.length) return null;\n    var leadingSpace = lines[0].match(/^[ \\t]*/)[0];\n\n    for (var i = 0; i < lines.length; ++i) {\n      var text = lines[i], oldLen = curLine.length, spaceInserted = 0;\n      if (curLine && text && !wrapOn.test(curLine.charAt(curLine.length - 1) + text.charAt(0))) {\n        curLine += \" \";\n        spaceInserted = 1;\n      }\n      var spaceTrimmed = \"\";\n      if (i) {\n        spaceTrimmed = text.match(/^\\s*/)[0];\n        text = text.slice(spaceTrimmed.length);\n      }\n      curLine += text;\n      if (i) {\n        var firstBreak = curLine.length > column && leadingSpace == spaceTrimmed &&\n          findBreakPoint(curLine, column, wrapOn, killTrailing);\n        // If this isn't broken, or is broken at a different point, remove old break\n        if (!firstBreak || firstBreak.from != oldLen || firstBreak.to != oldLen + spaceInserted) {\n          changes.push({text: [spaceInserted ? \" \" : \"\"],\n                        from: Pos(curNo, oldLen),\n                        to: Pos(curNo + 1, spaceTrimmed.length)});\n        } else {\n          curLine = leadingSpace + text;\n          ++curNo;\n        }\n      }\n      while (curLine.length > column) {\n        var bp = findBreakPoint(curLine, column, wrapOn, killTrailing);\n        changes.push({text: [\"\", leadingSpace],\n                      from: Pos(curNo, bp.from),\n                      to: Pos(curNo, bp.to)});\n        curLine = leadingSpace + curLine.slice(bp.to);\n        ++curNo;\n      }\n    }\n    if (changes.length) cm.operation(function() {\n      for (var i = 0; i < changes.length; ++i) {\n        var change = changes[i];\n        if (change.text || CodeMirror.cmpPos(change.from, change.to))\n          cm.replaceRange(change.text, change.from, change.to);\n      }\n    });\n    return changes.length ? {from: changes[0].from, to: CodeMirror.changeEnd(changes[changes.length - 1])} : null;\n  }\n\n  CodeMirror.defineExtension(\"wrapParagraph\", function(pos, options) {\n    options = options || {};\n    if (!pos) pos = this.getCursor();\n    var para = findParagraph(this, pos, options);\n    return wrapRange(this, Pos(para.from, 0), Pos(para.to - 1), options);\n  });\n\n  CodeMirror.commands.wrapLines = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections(), at = cm.lastLine() + 1;\n      for (var i = ranges.length - 1; i >= 0; i--) {\n        var range = ranges[i], span;\n        if (range.empty()) {\n          var para = findParagraph(cm, range.head, {});\n          span = {from: Pos(para.from, 0), to: Pos(para.to - 1)};\n        } else {\n          span = {from: range.from(), to: range.to()};\n        }\n        if (span.to.line >= at) continue;\n        at = span.from.line;\n        wrapRange(cm, span.from, span.to, {});\n      }\n    });\n  };\n\n  CodeMirror.defineExtension(\"wrapRange\", function(from, to, options) {\n    return wrapRange(this, from, to, options || {});\n  });\n\n  CodeMirror.defineExtension(\"wrapParagraphsInRange\", function(from, to, options) {\n    options = options || {};\n    var cm = this, paras = [];\n    for (var line = from.line; line <= to.line;) {\n      var para = findParagraph(cm, Pos(line, 0), options);\n      paras.push(para);\n      line = para.to;\n    }\n    var madeChange = false;\n    if (paras.length) cm.operation(function() {\n      for (var i = paras.length - 1; i >= 0; --i)\n        madeChange = madeChange || wrapRange(cm, Pos(paras[i].from, 0), Pos(paras[i].to - 1), options);\n    });\n    return madeChange;\n  });\n});\n\n},{\"../../lib/codemirror\":30}],29:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// A rough approximation of Sublime Text's keybindings\n// Depends on addon/search/searchcursor.js and optionally addon/dialog/dialogs.js\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../lib/codemirror\"), _dereq_(\"../addon/search/searchcursor\"), _dereq_(\"../addon/edit/matchbrackets\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../lib/codemirror\", \"../addon/search/searchcursor\", \"../addon/edit/matchbrackets\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var map = CodeMirror.keyMap.sublime = {fallthrough: \"default\"};\n  var cmds = CodeMirror.commands;\n  var Pos = CodeMirror.Pos;\n  var mac = CodeMirror.keyMap[\"default\"] == CodeMirror.keyMap.macDefault;\n  var ctrl = mac ? \"Cmd-\" : \"Ctrl-\";\n\n  // This is not exactly Sublime's algorithm. I couldn't make heads or tails of that.\n  function findPosSubword(doc, start, dir) {\n    if (dir < 0 && start.ch == 0) return doc.clipPos(Pos(start.line - 1));\n    var line = doc.getLine(start.line);\n    if (dir > 0 && start.ch >= line.length) return doc.clipPos(Pos(start.line + 1, 0));\n    var state = \"start\", type;\n    for (var pos = start.ch, e = dir < 0 ? 0 : line.length, i = 0; pos != e; pos += dir, i++) {\n      var next = line.charAt(dir < 0 ? pos - 1 : pos);\n      var cat = next != \"_\" && CodeMirror.isWordChar(next) ? \"w\" : \"o\";\n      if (cat == \"w\" && next.toUpperCase() == next) cat = \"W\";\n      if (state == \"start\") {\n        if (cat != \"o\") { state = \"in\"; type = cat; }\n      } else if (state == \"in\") {\n        if (type != cat) {\n          if (type == \"w\" && cat == \"W\" && dir < 0) pos--;\n          if (type == \"W\" && cat == \"w\" && dir > 0) { type = \"w\"; continue; }\n          break;\n        }\n      }\n    }\n    return Pos(start.line, pos);\n  }\n\n  function moveSubword(cm, dir) {\n    cm.extendSelectionsBy(function(range) {\n      if (cm.display.shift || cm.doc.extend || range.empty())\n        return findPosSubword(cm.doc, range.head, dir);\n      else\n        return dir < 0 ? range.from() : range.to();\n    });\n  }\n\n  cmds[map[\"Alt-Left\"] = \"goSubwordLeft\"] = function(cm) { moveSubword(cm, -1); };\n  cmds[map[\"Alt-Right\"] = \"goSubwordRight\"] = function(cm) { moveSubword(cm, 1); };\n\n  var scrollLineCombo = mac ? \"Ctrl-Alt-\" : \"Ctrl-\";\n\n  cmds[map[scrollLineCombo + \"Up\"] = \"scrollLineUp\"] = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleBottomLine = cm.lineAtHeight(info.top + info.clientHeight, \"local\");\n      if (cm.getCursor().line >= visibleBottomLine)\n        cm.execCommand(\"goLineUp\");\n    }\n    cm.scrollTo(null, info.top - cm.defaultTextHeight());\n  };\n  cmds[map[scrollLineCombo + \"Down\"] = \"scrollLineDown\"] = function(cm) {\n    var info = cm.getScrollInfo();\n    if (!cm.somethingSelected()) {\n      var visibleTopLine = cm.lineAtHeight(info.top, \"local\")+1;\n      if (cm.getCursor().line <= visibleTopLine)\n        cm.execCommand(\"goLineDown\");\n    }\n    cm.scrollTo(null, info.top + cm.defaultTextHeight());\n  };\n\n  cmds[map[\"Shift-\" + ctrl + \"L\"] = \"splitSelectionByLine\"] = function(cm) {\n    var ranges = cm.listSelections(), lineRanges = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      for (var line = from.line; line <= to.line; ++line)\n        if (!(to.line > from.line && line == to.line && to.ch == 0))\n          lineRanges.push({anchor: line == from.line ? from : Pos(line, 0),\n                           head: line == to.line ? to : Pos(line)});\n    }\n    cm.setSelections(lineRanges, 0);\n  };\n\n  map[\"Shift-Tab\"] = \"indentLess\";\n\n  cmds[map[\"Esc\"] = \"singleSelectionTop\"] = function(cm) {\n    var range = cm.listSelections()[0];\n    cm.setSelection(range.anchor, range.head, {scroll: false});\n  };\n\n  cmds[map[ctrl + \"L\"] = \"selectLine\"] = function(cm) {\n    var ranges = cm.listSelections(), extended = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      extended.push({anchor: Pos(range.from().line, 0),\n                     head: Pos(range.to().line + 1, 0)});\n    }\n    cm.setSelections(extended);\n  };\n\n  map[\"Shift-\" + ctrl + \"K\"] = \"deleteLine\";\n\n  function insertLine(cm, above) {\n    cm.operation(function() {\n      var len = cm.listSelections().length, newSelection = [], last = -1;\n      for (var i = 0; i < len; i++) {\n        var head = cm.listSelections()[i].head;\n        if (head.line <= last) continue;\n        var at = Pos(head.line + (above ? 0 : 1), 0);\n        cm.replaceRange(\"\\n\", at, null, \"+insertLine\");\n        cm.indentLine(at.line, null, true);\n        newSelection.push({head: at, anchor: at});\n        last = head.line + 1;\n      }\n      cm.setSelections(newSelection);\n    });\n  }\n\n  cmds[map[ctrl + \"Enter\"] = \"insertLineAfter\"] = function(cm) { insertLine(cm, false); };\n\n  cmds[map[\"Shift-\" + ctrl + \"Enter\"] = \"insertLineBefore\"] = function(cm) { insertLine(cm, true); };\n\n  function wordAt(cm, pos) {\n    var start = pos.ch, end = start, line = cm.getLine(pos.line);\n    while (start && CodeMirror.isWordChar(line.charAt(start - 1))) --start;\n    while (end < line.length && CodeMirror.isWordChar(line.charAt(end))) ++end;\n    return {from: Pos(pos.line, start), to: Pos(pos.line, end), word: line.slice(start, end)};\n  }\n\n  cmds[map[ctrl + \"D\"] = \"selectNextOccurrence\"] = function(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    var fullWord = cm.state.sublimeFindFullWord == cm.doc.sel;\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      cm.setSelection(word.from, word.to);\n      fullWord = true;\n    } else {\n      var text = cm.getRange(from, to);\n      var query = fullWord ? new RegExp(\"\\\\b\" + text + \"\\\\b\") : text;\n      var cur = cm.getSearchCursor(query, to);\n      if (cur.findNext()) {\n        cm.addSelection(cur.from(), cur.to());\n      } else {\n        cur = cm.getSearchCursor(query, Pos(cm.firstLine(), 0));\n        if (cur.findNext())\n          cm.addSelection(cur.from(), cur.to());\n      }\n    }\n    if (fullWord)\n      cm.state.sublimeFindFullWord = cm.doc.sel;\n  };\n\n  var mirror = \"(){}[]\";\n  function selectBetweenBrackets(cm) {\n    var pos = cm.getCursor(), opening = cm.scanForBracket(pos, -1);\n    if (!opening) return;\n    for (;;) {\n      var closing = cm.scanForBracket(pos, 1);\n      if (!closing) return;\n      if (closing.ch == mirror.charAt(mirror.indexOf(opening.ch) + 1)) {\n        cm.setSelection(Pos(opening.pos.line, opening.pos.ch + 1), closing.pos, false);\n        return true;\n      }\n      pos = Pos(closing.pos.line, closing.pos.ch + 1);\n    }\n  }\n\n  cmds[map[\"Shift-\" + ctrl + \"Space\"] = \"selectScope\"] = function(cm) {\n    selectBetweenBrackets(cm) || cm.execCommand(\"selectAll\");\n  };\n  cmds[map[\"Shift-\" + ctrl + \"M\"] = \"selectBetweenBrackets\"] = function(cm) {\n    if (!selectBetweenBrackets(cm)) return CodeMirror.Pass;\n  };\n\n  cmds[map[ctrl + \"M\"] = \"goToBracket\"] = function(cm) {\n    cm.extendSelectionsBy(function(range) {\n      var next = cm.scanForBracket(range.head, 1);\n      if (next && CodeMirror.cmpPos(next.pos, range.head) != 0) return next.pos;\n      var prev = cm.scanForBracket(range.head, -1);\n      return prev && Pos(prev.pos.line, prev.pos.ch + 1) || range.head;\n    });\n  };\n\n  var swapLineCombo = mac ? \"Cmd-Ctrl-\" : \"Shift-Ctrl-\";\n\n  cmds[map[swapLineCombo + \"Up\"] = \"swapLineUp\"] = function(cm) {\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.firstLine() - 1, newSels = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from().line - 1, to = range.to().line;\n      newSels.push({anchor: Pos(range.anchor.line - 1, range.anchor.ch),\n                    head: Pos(range.head.line - 1, range.head.ch)});\n      if (range.to().ch == 0 && !range.empty()) --to;\n      if (from > at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = 0; i < linesToMove.length; i += 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        if (to > cm.lastLine())\n          cm.replaceRange(\"\\n\" + line, Pos(cm.lastLine()), null, \"+swapLine\");\n        else\n          cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.setSelections(newSels);\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds[map[swapLineCombo + \"Down\"] = \"swapLineDown\"] = function(cm) {\n    var ranges = cm.listSelections(), linesToMove = [], at = cm.lastLine() + 1;\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var range = ranges[i], from = range.to().line + 1, to = range.from().line;\n      if (range.to().ch == 0 && !range.empty()) from--;\n      if (from < at) linesToMove.push(from, to);\n      else if (linesToMove.length) linesToMove[linesToMove.length - 1] = to;\n      at = to;\n    }\n    cm.operation(function() {\n      for (var i = linesToMove.length - 2; i >= 0; i -= 2) {\n        var from = linesToMove[i], to = linesToMove[i + 1];\n        var line = cm.getLine(from);\n        if (from == cm.lastLine())\n          cm.replaceRange(\"\", Pos(from - 1), Pos(from), \"+swapLine\");\n        else\n          cm.replaceRange(\"\", Pos(from, 0), Pos(from + 1, 0), \"+swapLine\");\n        cm.replaceRange(line + \"\\n\", Pos(to, 0), null, \"+swapLine\");\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n  map[ctrl + \"/\"] = function(cm) {\n    cm.toggleComment({ indent: true });\n  }\n\n  cmds[map[ctrl + \"J\"] = \"joinLines\"] = function(cm) {\n    var ranges = cm.listSelections(), joined = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], from = range.from();\n      var start = from.line, end = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == end)\n        end = ranges[++i].to().line;\n      joined.push({start: start, end: end, anchor: !range.empty() && from});\n    }\n    cm.operation(function() {\n      var offset = 0, ranges = [];\n      for (var i = 0; i < joined.length; i++) {\n        var obj = joined[i];\n        var anchor = obj.anchor && Pos(obj.anchor.line - offset, obj.anchor.ch), head;\n        for (var line = obj.start; line <= obj.end; line++) {\n          var actual = line - offset;\n          if (line == obj.end) head = Pos(actual, cm.getLine(actual).length + 1);\n          if (actual < cm.lastLine()) {\n            cm.replaceRange(\" \", Pos(actual), Pos(actual + 1, /^\\s*/.exec(cm.getLine(actual + 1))[0].length));\n            ++offset;\n          }\n        }\n        ranges.push({anchor: anchor || head, head: head});\n      }\n      cm.setSelections(ranges, 0);\n    });\n  };\n\n  cmds[map[\"Shift-\" + ctrl + \"D\"] = \"duplicateLine\"] = function(cm) {\n    cm.operation(function() {\n      var rangeCount = cm.listSelections().length;\n      for (var i = 0; i < rangeCount; i++) {\n        var range = cm.listSelections()[i];\n        if (range.empty())\n          cm.replaceRange(cm.getLine(range.head.line) + \"\\n\", Pos(range.head.line, 0));\n        else\n          cm.replaceRange(cm.getRange(range.from(), range.to()), range.from());\n      }\n      cm.scrollIntoView();\n    });\n  };\n\n  map[ctrl + \"T\"] = \"transposeChars\";\n\n  function sortLines(cm, caseSensitive) {\n    var ranges = cm.listSelections(), toSort = [], selected;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      if (range.empty()) continue;\n      var from = range.from().line, to = range.to().line;\n      while (i < ranges.length - 1 && ranges[i + 1].from().line == to)\n        to = range[++i].to().line;\n      toSort.push(from, to);\n    }\n    if (toSort.length) selected = true;\n    else toSort.push(cm.firstLine(), cm.lastLine());\n\n    cm.operation(function() {\n      var ranges = [];\n      for (var i = 0; i < toSort.length; i += 2) {\n        var from = toSort[i], to = toSort[i + 1];\n        var start = Pos(from, 0), end = Pos(to);\n        var lines = cm.getRange(start, end, false);\n        if (caseSensitive)\n          lines.sort();\n        else\n          lines.sort(function(a, b) {\n            var au = a.toUpperCase(), bu = b.toUpperCase();\n            if (au != bu) { a = au; b = bu; }\n            return a < b ? -1 : a == b ? 0 : 1;\n          });\n        cm.replaceRange(lines, start, end);\n        if (selected) ranges.push({anchor: start, head: end});\n      }\n      if (selected) cm.setSelections(ranges, 0);\n    });\n  }\n\n  cmds[map[\"F9\"] = \"sortLines\"] = function(cm) { sortLines(cm, true); };\n  cmds[map[ctrl + \"F9\"] = \"sortLinesInsensitive\"] = function(cm) { sortLines(cm, false); };\n\n  cmds[map[\"F2\"] = \"nextBookmark\"] = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      var current = marks.shift();\n      var found = current.find();\n      if (found) {\n        marks.push(current);\n        return cm.setSelection(found.from, found.to);\n      }\n    }\n  };\n\n  cmds[map[\"Shift-F2\"] = \"prevBookmark\"] = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) while (marks.length) {\n      marks.unshift(marks.pop());\n      var found = marks[marks.length - 1].find();\n      if (!found)\n        marks.pop();\n      else\n        return cm.setSelection(found.from, found.to);\n    }\n  };\n\n  cmds[map[ctrl + \"F2\"] = \"toggleBookmark\"] = function(cm) {\n    var ranges = cm.listSelections();\n    var marks = cm.state.sublimeBookmarks || (cm.state.sublimeBookmarks = []);\n    for (var i = 0; i < ranges.length; i++) {\n      var from = ranges[i].from(), to = ranges[i].to();\n      var found = cm.findMarks(from, to);\n      for (var j = 0; j < found.length; j++) {\n        if (found[j].sublimeBookmark) {\n          found[j].clear();\n          for (var k = 0; k < marks.length; k++)\n            if (marks[k] == found[j])\n              marks.splice(k--, 1);\n          break;\n        }\n      }\n      if (j == found.length)\n        marks.push(cm.markText(from, to, {sublimeBookmark: true, clearWhenEmpty: false}));\n    }\n  };\n\n  cmds[map[\"Shift-\" + ctrl + \"F2\"] = \"clearBookmarks\"] = function(cm) {\n    var marks = cm.state.sublimeBookmarks;\n    if (marks) for (var i = 0; i < marks.length; i++) marks[i].clear();\n    marks.length = 0;\n  };\n\n  cmds[map[\"Alt-F2\"] = \"selectBookmarks\"] = function(cm) {\n    var marks = cm.state.sublimeBookmarks, ranges = [];\n    if (marks) for (var i = 0; i < marks.length; i++) {\n      var found = marks[i].find();\n      if (!found)\n        marks.splice(i--, 0);\n      else\n        ranges.push({anchor: found.from, head: found.to});\n    }\n    if (ranges.length)\n      cm.setSelections(ranges, 0);\n  };\n\n  map[\"Alt-Q\"] = \"wrapLines\";\n\n  var cK = ctrl + \"K \";\n\n  function modifyWordOrSelection(cm, mod) {\n    cm.operation(function() {\n      var ranges = cm.listSelections(), indices = [], replacements = [];\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.empty()) { indices.push(i); replacements.push(\"\"); }\n        else replacements.push(mod(cm.getRange(range.from(), range.to())));\n      }\n      cm.replaceSelections(replacements, \"around\", \"case\");\n      for (var i = indices.length - 1, at; i >= 0; i--) {\n        var range = ranges[indices[i]];\n        if (at && CodeMirror.cmpPos(range.head, at) > 0) continue;\n        var word = wordAt(cm, range.head);\n        at = word.from;\n        cm.replaceRange(mod(word.word), word.from, word.to);\n      }\n    });\n  }\n\n  map[cK + ctrl + \"Backspace\"] = \"delLineLeft\";\n\n  cmds[map[\"Backspace\"] = \"smartBackspace\"] = function(cm) {\n    if (cm.somethingSelected()) return CodeMirror.Pass;\n\n    var cursor = cm.getCursor();\n    var toStartOfLine = cm.getRange({line: cursor.line, ch: 0}, cursor);\n    var column = CodeMirror.countColumn(toStartOfLine, null, cm.getOption(\"tabSize\"));\n    var indentUnit = cm.getOption(\"indentUnit\");\n\n    if (toStartOfLine && !/\\S/.test(toStartOfLine) && column % indentUnit == 0) {\n      var prevIndent = new Pos(cursor.line,\n        CodeMirror.findColumn(toStartOfLine, column - indentUnit, indentUnit));\n\n      // If no smart delete is happening (due to tab sizing) just do a regular delete\n      if (prevIndent.ch == cursor.ch) return CodeMirror.Pass;\n\n      return cm.replaceRange(\"\", prevIndent, cursor, \"+delete\");\n    } else {\n      return CodeMirror.Pass;\n    }\n  };\n\n  cmds[map[cK + ctrl + \"K\"] = \"delLineRight\"] = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = ranges.length - 1; i >= 0; i--)\n        cm.replaceRange(\"\", ranges[i].anchor, Pos(ranges[i].to().line), \"+delete\");\n      cm.scrollIntoView();\n    });\n  };\n\n  cmds[map[cK + ctrl + \"U\"] = \"upcaseAtCursor\"] = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toUpperCase(); });\n  };\n  cmds[map[cK + ctrl + \"L\"] = \"downcaseAtCursor\"] = function(cm) {\n    modifyWordOrSelection(cm, function(str) { return str.toLowerCase(); });\n  };\n\n  cmds[map[cK + ctrl + \"Space\"] = \"setSublimeMark\"] = function(cm) {\n    if (cm.state.sublimeMark) cm.state.sublimeMark.clear();\n    cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n  };\n  cmds[map[cK + ctrl + \"A\"] = \"selectToSublimeMark\"] = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) cm.setSelection(cm.getCursor(), found);\n  };\n  cmds[map[cK + ctrl + \"W\"] = \"deleteToSublimeMark\"] = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      var from = cm.getCursor(), to = found;\n      if (CodeMirror.cmpPos(from, to) > 0) { var tmp = to; to = from; from = tmp; }\n      cm.state.sublimeKilled = cm.getRange(from, to);\n      cm.replaceRange(\"\", from, to);\n    }\n  };\n  cmds[map[cK + ctrl + \"X\"] = \"swapWithSublimeMark\"] = function(cm) {\n    var found = cm.state.sublimeMark && cm.state.sublimeMark.find();\n    if (found) {\n      cm.state.sublimeMark.clear();\n      cm.state.sublimeMark = cm.setBookmark(cm.getCursor());\n      cm.setCursor(found);\n    }\n  };\n  cmds[map[cK + ctrl + \"Y\"] = \"sublimeYank\"] = function(cm) {\n    if (cm.state.sublimeKilled != null)\n      cm.replaceSelection(cm.state.sublimeKilled, null, \"paste\");\n  };\n\n  map[cK + ctrl + \"G\"] = \"clearBookmarks\";\n  cmds[map[cK + ctrl + \"C\"] = \"showInCenter\"] = function(cm) {\n    var pos = cm.cursorCoords(null, \"local\");\n    cm.scrollTo(null, (pos.top + pos.bottom) / 2 - cm.getScrollInfo().clientHeight / 2);\n  };\n\n  cmds[map[\"Shift-Alt-Up\"] = \"selectLinesUpward\"] = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.head.line > cm.firstLine())\n          cm.addSelection(Pos(range.head.line - 1, range.head.ch));\n      }\n    });\n  };\n  cmds[map[\"Shift-Alt-Down\"] = \"selectLinesDownward\"] = function(cm) {\n    cm.operation(function() {\n      var ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (range.head.line < cm.lastLine())\n          cm.addSelection(Pos(range.head.line + 1, range.head.ch));\n      }\n    });\n  };\n\n  function getTarget(cm) {\n    var from = cm.getCursor(\"from\"), to = cm.getCursor(\"to\");\n    if (CodeMirror.cmpPos(from, to) == 0) {\n      var word = wordAt(cm, from);\n      if (!word.word) return;\n      from = word.from;\n      to = word.to;\n    }\n    return {from: from, to: to, query: cm.getRange(from, to), word: word};\n  }\n\n  function findAndGoTo(cm, forward) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var query = target.query;\n    var cur = cm.getSearchCursor(query, forward ? target.to : target.from);\n\n    if (forward ? cur.findNext() : cur.findPrevious()) {\n      cm.setSelection(cur.from(), cur.to());\n    } else {\n      cur = cm.getSearchCursor(query, forward ? Pos(cm.firstLine(), 0)\n                                              : cm.clipPos(Pos(cm.lastLine())));\n      if (forward ? cur.findNext() : cur.findPrevious())\n        cm.setSelection(cur.from(), cur.to());\n      else if (target.word)\n        cm.setSelection(target.from, target.to);\n    }\n  };\n  cmds[map[ctrl + \"F3\"] = \"findUnder\"] = function(cm) { findAndGoTo(cm, true); };\n  cmds[map[\"Shift-\" + ctrl + \"F3\"] = \"findUnderPrevious\"] = function(cm) { findAndGoTo(cm,false); };\n  cmds[map[\"Alt-F3\"] = \"findAllUnder\"] = function(cm) {\n    var target = getTarget(cm);\n    if (!target) return;\n    var cur = cm.getSearchCursor(target.query);\n    var matches = [];\n    var primaryIndex = -1;\n    while (cur.findNext()) {\n      matches.push({anchor: cur.from(), head: cur.to()});\n      if (cur.from().line <= target.from.line && cur.from().ch <= target.from.ch)\n        primaryIndex++;\n    }\n    cm.setSelections(matches, primaryIndex);\n  };\n\n  map[\"Shift-\" + ctrl + \"[\"] = \"fold\";\n  map[\"Shift-\" + ctrl + \"]\"] = \"unfold\";\n  map[cK + ctrl + \"0\"] = map[cK + ctrl + \"j\"] = \"unfoldAll\";\n\n  map[ctrl + \"I\"] = \"findIncremental\";\n  map[\"Shift-\" + ctrl + \"I\"] = \"findIncrementalReverse\";\n  map[ctrl + \"H\"] = \"replace\";\n  map[\"F3\"] = \"findNext\";\n  map[\"Shift-F3\"] = \"findPrev\";\n\n  CodeMirror.normalizeKeyMap(map);\n});\n\n},{\"../addon/edit/matchbrackets\":20,\"../addon/search/searchcursor\":27,\"../lib/codemirror\":30}],30:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    module.exports = mod();\n  else if (typeof define == \"function\" && define.amd) // AMD\n    return define([], mod);\n  else // Plain browser env\n    this.CodeMirror = mod();\n})(function() {\n  \"use strict\";\n\n  // BROWSER SNIFFING\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : ie_11up[1]);\n  var webkit = /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || /Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) presto_version = Number(presto_version[1]);\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  // EDITOR CONSTRUCTOR\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    if (!(this instanceof CodeMirror)) return new CodeMirror(place, options);\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n    setGuttersForLineNumbers(options);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") doc = new Doc(doc, options.mode, null, options.lineSeparator);\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input);\n    display.wrapper.CodeMirror = this;\n    updateGutters(this);\n    themeChanged(this);\n    if (options.lineWrapping)\n      this.display.wrapper.className += \" CodeMirror-wrap\";\n    if (options.autofocus && !mobile) display.input.focus();\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    var cm = this;\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) setTimeout(function() { cm.display.input.reset(true); }, 20);\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || cm.hasFocus())\n      setTimeout(bind(onFocus, this), 20);\n    else\n      onBlur(this);\n\n    for (var opt in optionHandlers) if (optionHandlers.hasOwnProperty(opt))\n      optionHandlers[opt](this, options[opt], Init);\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) options.finishInit(this);\n    for (var i = 0; i < initHooks.length; ++i) initHooks[i](this);\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      display.lineDiv.style.textRendering = \"auto\";\n  }\n\n  // DISPLAY CONSTRUCTOR\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = elt(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = elt(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [elt(\"div\", [d.lineSpace], \"CodeMirror-lines\")], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) d.scroller.draggable = true;\n\n    if (place) {\n      if (place.appendChild) place.appendChild(d.wrapper);\n      else place(d.wrapper);\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    input.init(d);\n  }\n\n  // STATE UPDATES\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = CodeMirror.getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function(line) {\n      if (line.stateAfter) line.stateAfter = null;\n      if (line.styles) line.styles = null;\n    });\n    cm.doc.frontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) regChange(cm);\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function(){updateScrollbars(cm);}, 100);\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function(line) {\n      if (lineIsHidden(cm.doc, line)) return 0;\n\n      var widgetsHeight = 0;\n      if (line.widgets) for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) widgetsHeight += line.widgets[i].height;\n      }\n\n      if (wrapping)\n        return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th;\n      else\n        return widgetsHeight + th;\n    };\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function(line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) updateLineHeight(line, estHeight);\n    });\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  function guttersChanged(cm) {\n    updateGutters(cm);\n    regChange(cm);\n    setTimeout(function(){alignHorizontally(cm);}, 20);\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function updateGutters(cm) {\n    var gutters = cm.display.gutters, specs = cm.options.gutters;\n    removeChildren(gutters);\n    for (var i = 0; i < specs.length; ++i) {\n      var gutterClass = specs[i];\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n      if (gutterClass == \"CodeMirror-linenumbers\") {\n        cm.display.lineGutter = gElt;\n        gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = i ? \"\" : \"none\";\n    updateGutterSpace(cm);\n  }\n\n  function updateGutterSpace(cm) {\n    var width = cm.display.gutters.offsetWidth;\n    cm.display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) return 0;\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found = merged.find(0, true);\n      len -= cur.text.length - found.from.ch;\n      cur = found.to.line;\n      len += cur.text.length - found.to.ch;\n    }\n    return len;\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function(line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // Make sure the gutters options contains the element\n  // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n  function setGuttersForLineNumbers(options) {\n    var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n    if (found == -1 && options.lineNumbers) {\n      options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n    } else if (found > -1 && !options.lineNumbers) {\n      options.gutters = options.gutters.slice(0);\n      options.gutters.splice(found, 1);\n    }\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    };\n  }\n\n  function NativeScrollbars(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function() {\n      if (vert.clientHeight) scroll(vert.scrollTop, \"vertical\");\n    });\n    on(horiz, \"scroll\", function() {\n      if (horiz.clientWidth) scroll(horiz.scrollLeft, \"horizontal\");\n    });\n\n    this.checkedOverlay = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\";\n  }\n\n  NativeScrollbars.prototype = copyObj({\n    update: function(measure) {\n      var needsH = measure.scrollWidth > measure.clientWidth + 1;\n      var needsV = measure.scrollHeight > measure.clientHeight + 1;\n      var sWidth = measure.nativeBarWidth;\n\n      if (needsV) {\n        this.vert.style.display = \"block\";\n        this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n        var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n        // A bug in IE8 can cause this value to be negative, so guard it.\n        this.vert.firstChild.style.height =\n          Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n      } else {\n        this.vert.style.display = \"\";\n        this.vert.firstChild.style.height = \"0\";\n      }\n\n      if (needsH) {\n        this.horiz.style.display = \"block\";\n        this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n        this.horiz.style.left = measure.barLeft + \"px\";\n        var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n        this.horiz.firstChild.style.width =\n          (measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n      } else {\n        this.horiz.style.display = \"\";\n        this.horiz.firstChild.style.width = \"0\";\n      }\n\n      if (!this.checkedOverlay && measure.clientHeight > 0) {\n        if (sWidth == 0) this.overlayHack();\n        this.checkedOverlay = true;\n      }\n\n      return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0};\n    },\n    setScrollLeft: function(pos) {\n      if (this.horiz.scrollLeft != pos) this.horiz.scrollLeft = pos;\n    },\n    setScrollTop: function(pos) {\n      if (this.vert.scrollTop != pos) this.vert.scrollTop = pos;\n    },\n    overlayHack: function() {\n      var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n      this.horiz.style.minHeight = this.vert.style.minWidth = w;\n      var self = this;\n      var barMouseDown = function(e) {\n        if (e_target(e) != self.vert && e_target(e) != self.horiz)\n          operation(self.cm, onMouseDown)(e);\n      };\n      on(this.vert, \"mousedown\", barMouseDown);\n      on(this.horiz, \"mousedown\", barMouseDown);\n    },\n    clear: function() {\n      var parent = this.horiz.parentNode;\n      parent.removeChild(this.horiz);\n      parent.removeChild(this.vert);\n    }\n  }, NativeScrollbars.prototype);\n\n  function NullScrollbars() {}\n\n  NullScrollbars.prototype = copyObj({\n    update: function() { return {bottom: 0, right: 0}; },\n    setScrollLeft: function() {},\n    setScrollTop: function() {},\n    clear: function() {}\n  }, NullScrollbars.prototype);\n\n  CodeMirror.scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        rmClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n    }\n\n    cm.display.scrollbars = new CodeMirror.scrollbarModel[cm.options.scrollbarStyle](function(node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function() {\n        if (cm.state.focused) setTimeout(function() { cm.display.input.focus(); }, 0);\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function(pos, axis) {\n      if (axis == \"horizontal\") setScrollLeft(cm, pos);\n      else setScrollTop(cm, pos);\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      addClass(cm.display.wrapper, cm.display.scrollbars.addClass);\n  }\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) measure = measureForScrollbars(cm);\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        updateHeightsInViewport(cm);\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else d.scrollbarFiller.style.display = \"\";\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else d.gutterFiller.style.display = \"\";\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)};\n  }\n\n  // LINE NUMBERS\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) return;\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) if (!view[i].hidden) {\n      if (cm.options.fixedGutter && view[i].gutter)\n        view[i].gutter.style.left = left;\n      var align = view[i].alignable;\n      if (align) for (var j = 0; j < align.length; j++)\n        align[j].style.left = left;\n    }\n    if (cm.options.fixedGutter)\n      display.gutters.style.left = (comp + gutterW) + \"px\";\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) return false;\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm);\n      return true;\n    }\n    return false;\n  }\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber));\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left;\n  }\n\n  // DISPLAY DRAWING\n\n  function DisplayUpdate(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  }\n\n  DisplayUpdate.prototype.signal = function(emitter, type) {\n    if (hasHandler(emitter, type))\n      this.events.push(arguments);\n  };\n  DisplayUpdate.prototype.finish = function() {\n    for (var i = 0; i < this.events.length; i++)\n      signal.apply(null, this.events[i]);\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false;\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      return false;\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) from = Math.max(doc.first, display.viewFrom);\n    if (display.viewTo > to && display.viewTo - to < 20) to = Math.min(end, display.viewTo);\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      return false;\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var focused = activeElt();\n    if (toUpdate > 4) display.lineDiv.style.display = \"none\";\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) display.lineDiv.style.display = \"\";\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    if (focused && activeElt() != focused && focused.offsetHeight) focused.focus();\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true;\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)};\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          break;\n      }\n      if (!updateDisplayIfNeeded(cm, update)) break;\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      setDocumentHeight(cm, barMeasure);\n      updateScrollbars(cm, barMeasure);\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      setDocumentHeight(cm, barMeasure);\n      updateScrollbars(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    var total = measure.docHeight + cm.display.barHeight;\n    cm.display.heightForcer.style.top = total + \"px\";\n    cm.display.gutters.style.height = Math.max(total + scrollGap(cm), measure.clientHeight) + \"px\";\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], height;\n      if (cur.hidden) continue;\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n      }\n      var diff = cur.line.height - height;\n      if (height < 2) height = textHeight(display);\n      if (diff > .001 || diff < -.001) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) for (var j = 0; j < cur.rest.length; j++)\n          updateWidgetHeight(cur.rest[j]);\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) for (var i = 0; i < line.widgets.length; ++i)\n      line.widgets[i].height = line.widgets[i].node.offsetHeight;\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[cm.options.gutters[i]] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth};\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        node.style.display = \"none\";\n      else\n        node.parentNode.removeChild(node);\n      return next;\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) {\n      } else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) cur = rm(cur);\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) updateNumber = false;\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) cur = rm(cur);\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") updateLineText(cm, lineView);\n      else if (type == \"gutter\") updateLineGutter(cm, lineView, lineN, dims);\n      else if (type == \"class\") updateLineClasses(lineView);\n      else if (type == \"widget\") updateLineWidgets(cm, lineView, dims);\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        lineView.text.parentNode.replaceChild(lineView.node, lineView.text);\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) lineView.node.style.zIndex = 2;\n    }\n    return lineView.node;\n  }\n\n  function updateLineBackground(lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) cls += \" CodeMirror-linebackground\";\n    if (lineView.background) {\n      if (cls) lineView.background.className = cls;\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built;\n    }\n    return buildLineContent(cm, lineView);\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) lineView.node = built.pre;\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(lineView) {\n    updateLineBackground(lineView);\n    if (lineView.line.wrapClass)\n      ensureLineWrapped(lineView).className = lineView.line.wrapClass;\n    else if (lineView.node != lineView.text)\n      lineView.node.className = \"\";\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      \"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) +\n                                      \"px; width: \" + dims.gutterTotalWidth + \"px\");\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", \"left: \" +\n                                             (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\");\n      cm.display.input.setUneditable(gutterWrap);\n      wrap.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        gutterWrap.className += \" \" + lineView.line.gutterClass;\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              \"left: \" + dims.gutterLeft[\"CodeMirror-linenumbers\"] + \"px; width: \"\n              + cm.display.lineNumInnerWidth + \"px\"));\n      if (markers) for (var k = 0; k < cm.options.gutters.length; ++k) {\n        var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\", \"left: \" +\n                                     dims.gutterLeft[id] + \"px; width: \" + dims.gutterWidth[id] + \"px\"));\n      }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) lineView.alignable = null;\n    for (var node = lineView.node.firstChild, next; node; node = next) {\n      var next = node.nextSibling;\n      if (node.className == \"CodeMirror-linewidget\")\n        lineView.node.removeChild(node);\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) lineView.bgClass = built.bgClass;\n    if (built.textClass) lineView.textClass = built.textClass;\n\n    updateLineClasses(lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node;\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) for (var i = 0; i < lineView.rest.length; i++)\n      insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false);\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) return;\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n      if (!widget.handleMouseEvents) node.setAttribute(\"cm-ignore-events\", \"true\");\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        wrap.insertBefore(node, lineView.gutter || lineView.text);\n      else\n        wrap.appendChild(node);\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n      (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) node.style.marginLeft = -dims.gutterTotalWidth + \"px\";\n    }\n  }\n\n  // POSITION OBJECT\n\n  // A Pos instance represents a position within the text.\n  var Pos = CodeMirror.Pos = function(line, ch) {\n    if (!(this instanceof Pos)) return new Pos(line, ch);\n    this.line = line; this.ch = ch;\n  };\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  var cmp = CodeMirror.cmpPos = function(a, b) { return a.line - b.line || a.ch - b.ch; };\n\n  function copyPos(x) {return Pos(x.line, x.ch);}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a; }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b; }\n\n  // INPUT HANDLING\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function isReadOnly(cm) {\n    return cm.options.readOnly || cm.doc.cantEdit;\n  }\n\n  // This will be set to an array of strings when copying, so that,\n  // when pasting, we know what kind of selections the copied text\n  // was made out of.\n  var lastCopied = null;\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) sel = doc.sel;\n\n    var paste = cm.state.pasteIncoming || origin == \"paste\";\n    var textLines = doc.splitLines(inserted), multiPaste = null;\n    // When pasing N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.length; i++)\n            multiPaste.push(doc.splitLines(lastCopied[i]));\n        }\n      } else if (textLines.length == sel.ranges.length) {\n        multiPaste = map(textLines, function(l) { return [l]; });\n      }\n    }\n\n    // Normal behavior is to insert the new text into every selection\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          from = Pos(from.line, from.ch - deleted);\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length));\n      }\n      var updateInput = cm.curOp.updateInput;\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      triggerElectric(cm, inserted);\n\n    ensureCursorVisible(cm);\n    cm.curOp.updateInput = updateInput;\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = false;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"text/plain\");\n    if (pasted) {\n      e.preventDefault();\n      if (!isReadOnly(cm) && !cm.options.disableInput)\n        runInOp(cm, function() { applyTextInput(cm, pasted, 0, null, \"paste\"); });\n      return true;\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) return;\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) continue;\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break;\n          }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          indented = indentLine(cm, range.head.line, \"smart\");\n      }\n      if (indented) signalLater(cm, \"electricInput\", cm, range.head.line);\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges};\n  }\n\n  function disableBrowserMagic(field) {\n    field.setAttribute(\"autocorrect\", \"off\");\n    field.setAttribute(\"autocapitalize\", \"off\");\n    field.setAttribute(\"spellcheck\", \"false\");\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  function TextareaInput(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Tracks when input.reset has punted to just putting a short\n    // string into the textarea instead of the full selection.\n    this.inaccurateSelection = false;\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) te.style.width = \"1000px\";\n    else te.setAttribute(\"wrap\", \"off\");\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) te.style.border = \"1px solid black\";\n    disableBrowserMagic(te);\n    return div;\n  }\n\n  TextareaInput.prototype = copyObj({\n    init: function(display) {\n      var input = this, cm = this.cm;\n\n      // Wraps and hides input textarea\n      var div = this.wrapper = hiddenTextarea();\n      // The semihidden textarea that is focused when the editor is\n      // focused, and receives input.\n      var te = this.textarea = div.firstChild;\n      display.wrapper.insertBefore(div, display.wrapper.firstChild);\n\n      // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n      if (ios) te.style.width = \"0px\";\n\n      on(te, \"input\", function() {\n        if (ie && ie_version >= 9 && input.hasSelection) input.hasSelection = null;\n        input.poll();\n      });\n\n      on(te, \"paste\", function(e) {\n        if (handlePaste(e, cm)) return true;\n\n        cm.state.pasteIncoming = true;\n        input.fastPoll();\n      });\n\n      function prepareCopyCut(e) {\n        if (cm.somethingSelected()) {\n          lastCopied = cm.getSelections();\n          if (input.inaccurateSelection) {\n            input.prevInput = \"\";\n            input.inaccurateSelection = false;\n            te.value = lastCopied.join(\"\\n\");\n            selectInput(te);\n          }\n        } else if (!cm.options.lineWiseCopyCut) {\n          return;\n        } else {\n          var ranges = copyableRanges(cm);\n          lastCopied = ranges.text;\n          if (e.type == \"cut\") {\n            cm.setSelections(ranges.ranges, null, sel_dontScroll);\n          } else {\n            input.prevInput = \"\";\n            te.value = ranges.text.join(\"\\n\");\n            selectInput(te);\n          }\n        }\n        if (e.type == \"cut\") cm.state.cutIncoming = true;\n      }\n      on(te, \"cut\", prepareCopyCut);\n      on(te, \"copy\", prepareCopyCut);\n\n      on(display.scroller, \"paste\", function(e) {\n        if (eventInWidget(display, e)) return;\n        cm.state.pasteIncoming = true;\n        input.focus();\n      });\n\n      // Prevent normal selection in the editor (we handle our own)\n      on(display.lineSpace, \"selectstart\", function(e) {\n        if (!eventInWidget(display, e)) e_preventDefault(e);\n      });\n\n      on(te, \"compositionstart\", function() {\n        var start = cm.getCursor(\"from\");\n        if (input.composing) input.composing.range.clear()\n        input.composing = {\n          start: start,\n          range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n        };\n      });\n      on(te, \"compositionend\", function() {\n        if (input.composing) {\n          input.poll();\n          input.composing.range.clear();\n          input.composing = null;\n        }\n      });\n    },\n\n    prepareSelection: function() {\n      // Redraw the selection and/or cursor\n      var cm = this.cm, display = cm.display, doc = cm.doc;\n      var result = prepareSelection(cm);\n\n      // Move the hidden textarea near the cursor to prevent scrolling artifacts\n      if (cm.options.moveInputWithCursor) {\n        var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n        var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n        result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                            headPos.top + lineOff.top - wrapOff.top));\n        result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                             headPos.left + lineOff.left - wrapOff.left));\n      }\n\n      return result;\n    },\n\n    showSelection: function(drawn) {\n      var cm = this.cm, display = cm.display;\n      removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n      removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n      if (drawn.teTop != null) {\n        this.wrapper.style.top = drawn.teTop + \"px\";\n        this.wrapper.style.left = drawn.teLeft + \"px\";\n      }\n    },\n\n    // Reset the input to correspond to the selection (or to be empty,\n    // when not typing and nothing is selected)\n    reset: function(typing) {\n      if (this.contextMenuPending) return;\n      var minimal, selected, cm = this.cm, doc = cm.doc;\n      if (cm.somethingSelected()) {\n        this.prevInput = \"\";\n        var range = doc.sel.primary();\n        minimal = hasCopyEvent &&\n          (range.to().line - range.from().line > 100 || (selected = cm.getSelection()).length > 1000);\n        var content = minimal ? \"-\" : selected || cm.getSelection();\n        this.textarea.value = content;\n        if (cm.state.focused) selectInput(this.textarea);\n        if (ie && ie_version >= 9) this.hasSelection = content;\n      } else if (!typing) {\n        this.prevInput = this.textarea.value = \"\";\n        if (ie && ie_version >= 9) this.hasSelection = null;\n      }\n      this.inaccurateSelection = minimal;\n    },\n\n    getField: function() { return this.textarea; },\n\n    supportsTouch: function() { return false; },\n\n    focus: function() {\n      if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n        try { this.textarea.focus(); }\n        catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n      }\n    },\n\n    blur: function() { this.textarea.blur(); },\n\n    resetPosition: function() {\n      this.wrapper.style.top = this.wrapper.style.left = 0;\n    },\n\n    receivedFocus: function() { this.slowPoll(); },\n\n    // Poll for input changes, using the normal rate of polling. This\n    // runs as long as the editor is focused.\n    slowPoll: function() {\n      var input = this;\n      if (input.pollingFast) return;\n      input.polling.set(this.cm.options.pollInterval, function() {\n        input.poll();\n        if (input.cm.state.focused) input.slowPoll();\n      });\n    },\n\n    // When an event has just come in that is likely to add or change\n    // something in the input textarea, we poll faster, to ensure that\n    // the change appears on the screen quickly.\n    fastPoll: function() {\n      var missed = false, input = this;\n      input.pollingFast = true;\n      function p() {\n        var changed = input.poll();\n        if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n        else {input.pollingFast = false; input.slowPoll();}\n      }\n      input.polling.set(20, p);\n    },\n\n    // Read input from the textarea, and update the document to match.\n    // When something is selected, it is present in the textarea, and\n    // selected (unless it is huge, in which case a placeholder is\n    // used). When nothing is selected, the cursor sits after previously\n    // seen text (can be empty), which is stored in prevInput (we must\n    // not reset the textarea when typing, because that breaks IME).\n    poll: function() {\n      var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n      // Since this is called a *lot*, try to bail out as cheaply as\n      // possible when it is clear that nothing happened. hasSelection\n      // will be the case when there is a lot of text in the textarea,\n      // in which case reading its value would be expensive.\n      if (this.contextMenuPending || !cm.state.focused ||\n          (hasSelection(input) && !prevInput && !this.composing) ||\n          isReadOnly(cm) || cm.options.disableInput || cm.state.keySeq)\n        return false;\n\n      var text = input.value;\n      // If nothing changed, bail.\n      if (text == prevInput && !cm.somethingSelected()) return false;\n      // Work around nonsensical selection resetting in IE9/10, and\n      // inexplicable appearance of private area unicode characters on\n      // some key combos in Mac (#2689).\n      if (ie && ie_version >= 9 && this.hasSelection === text ||\n          mac && /[\\uf700-\\uf7ff]/.test(text)) {\n        cm.display.input.reset();\n        return false;\n      }\n\n      if (cm.doc.sel == cm.display.selForContextMenu) {\n        var first = text.charCodeAt(0);\n        if (first == 0x200b && !prevInput) prevInput = \"\\u200b\";\n        if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\"); }\n      }\n      // Find the part of the input that is actually new\n      var same = 0, l = Math.min(prevInput.length, text.length);\n      while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) ++same;\n\n      var self = this;\n      runInOp(cm, function() {\n        applyTextInput(cm, text.slice(same), prevInput.length - same,\n                       null, self.composing ? \"*compose\" : null);\n\n        // Don't leave long text in the textarea, since it makes further polling slow\n        if (text.length > 1000 || text.indexOf(\"\\n\") > -1) input.value = self.prevInput = \"\";\n        else self.prevInput = text;\n\n        if (self.composing) {\n          self.composing.range.clear();\n          self.composing.range = cm.markText(self.composing.start, cm.getCursor(\"to\"),\n                                             {className: \"CodeMirror-composing\"});\n        }\n      });\n      return true;\n    },\n\n    ensurePolled: function() {\n      if (this.pollingFast && this.poll()) this.pollingFast = false;\n    },\n\n    onKeyPress: function() {\n      if (ie && ie_version >= 9) this.hasSelection = null;\n      this.fastPoll();\n    },\n\n    onContextMenu: function(e) {\n      var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n      var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n      if (!pos || presto) return; // Opera is difficult.\n\n      // Reset the current text selection only if the click is done outside of the selection\n      // and 'resetSelectionOnContextMenu' option is true.\n      var reset = cm.options.resetSelectionOnContextMenu;\n      if (reset && cm.doc.sel.contains(pos) == -1)\n        operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll);\n\n      var oldCSS = te.style.cssText;\n      input.wrapper.style.position = \"absolute\";\n      te.style.cssText = \"position: fixed; width: 30px; height: 30px; top: \" + (e.clientY - 5) +\n        \"px; left: \" + (e.clientX - 5) + \"px; z-index: 1000; background: \" +\n        (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") +\n        \"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n      if (webkit) var oldScrollY = window.scrollY; // Work around Chrome issue (#2712)\n      display.input.focus();\n      if (webkit) window.scrollTo(null, oldScrollY);\n      display.input.reset();\n      // Adds \"Select all\" to context menu in FF\n      if (!cm.somethingSelected()) te.value = input.prevInput = \" \";\n      input.contextMenuPending = true;\n      display.selForContextMenu = cm.doc.sel;\n      clearTimeout(display.detectingSelectAll);\n\n      // Select-all will be greyed out if there's nothing to select, so\n      // this adds a zero-width space so that we can later check whether\n      // it got selected.\n      function prepareSelectAllHack() {\n        if (te.selectionStart != null) {\n          var selected = cm.somethingSelected();\n          var extval = \"\\u200b\" + (selected ? te.value : \"\");\n          te.value = \"\\u21da\"; // Used to catch context-menu undo\n          te.value = extval;\n          input.prevInput = selected ? \"\" : \"\\u200b\";\n          te.selectionStart = 1; te.selectionEnd = extval.length;\n          // Re-set this, in case some other handler touched the\n          // selection in the meantime.\n          display.selForContextMenu = cm.doc.sel;\n        }\n      }\n      function rehide() {\n        input.contextMenuPending = false;\n        input.wrapper.style.position = \"relative\";\n        te.style.cssText = oldCSS;\n        if (ie && ie_version < 9) display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos);\n\n        // Try to detect the user choosing select-all\n        if (te.selectionStart != null) {\n          if (!ie || (ie && ie_version < 9)) prepareSelectAllHack();\n          var i = 0, poll = function() {\n            if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n                te.selectionEnd > 0 && input.prevInput == \"\\u200b\")\n              operation(cm, commands.selectAll)(cm);\n            else if (i++ < 10) display.detectingSelectAll = setTimeout(poll, 500);\n            else display.input.reset();\n          };\n          display.detectingSelectAll = setTimeout(poll, 200);\n        }\n      }\n\n      if (ie && ie_version >= 9) prepareSelectAllHack();\n      if (captureRightClick) {\n        e_stop(e);\n        var mouseup = function() {\n          off(window, \"mouseup\", mouseup);\n          setTimeout(rehide, 20);\n        };\n        on(window, \"mouseup\", mouseup);\n      } else {\n        setTimeout(rehide, 50);\n      }\n    },\n\n    readOnlyChanged: function(val) {\n      if (!val) this.reset();\n    },\n\n    setUneditable: nothing,\n\n    needsContentAttribute: false\n  }, TextareaInput.prototype);\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  function ContentEditableInput(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.gracePeriod = false;\n  }\n\n  ContentEditableInput.prototype = copyObj({\n    init: function(display) {\n      var input = this, cm = input.cm;\n      var div = input.div = display.lineDiv;\n      disableBrowserMagic(div);\n\n      on(div, \"paste\", function(e) { handlePaste(e, cm); })\n\n      on(div, \"compositionstart\", function(e) {\n        var data = e.data;\n        input.composing = {sel: cm.doc.sel, data: data, startData: data};\n        if (!data) return;\n        var prim = cm.doc.sel.primary();\n        var line = cm.getLine(prim.head.line);\n        var found = line.indexOf(data, Math.max(0, prim.head.ch - data.length));\n        if (found > -1 && found <= prim.head.ch)\n          input.composing.sel = simpleSelection(Pos(prim.head.line, found),\n                                                Pos(prim.head.line, found + data.length));\n      });\n      on(div, \"compositionupdate\", function(e) {\n        input.composing.data = e.data;\n      });\n      on(div, \"compositionend\", function(e) {\n        var ours = input.composing;\n        if (!ours) return;\n        if (e.data != ours.startData && !/\\u200b/.test(e.data))\n          ours.data = e.data;\n        // Need a small delay to prevent other code (input event,\n        // selection polling) from doing damage when fired right after\n        // compositionend.\n        setTimeout(function() {\n          if (!ours.handled)\n            input.applyComposition(ours);\n          if (input.composing == ours)\n            input.composing = null;\n        }, 50);\n      });\n\n      on(div, \"touchstart\", function() {\n        input.forceCompositionEnd();\n      });\n\n      on(div, \"input\", function() {\n        if (input.composing) return;\n        if (isReadOnly(cm) || !input.pollContent())\n          runInOp(input.cm, function() {regChange(cm);});\n      });\n\n      function onCopyCut(e) {\n        if (cm.somethingSelected()) {\n          lastCopied = cm.getSelections();\n          if (e.type == \"cut\") cm.replaceSelection(\"\", null, \"cut\");\n        } else if (!cm.options.lineWiseCopyCut) {\n          return;\n        } else {\n          var ranges = copyableRanges(cm);\n          lastCopied = ranges.text;\n          if (e.type == \"cut\") {\n            cm.operation(function() {\n              cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n              cm.replaceSelection(\"\", null, \"cut\");\n            });\n          }\n        }\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        if (e.clipboardData && !ios) {\n          e.preventDefault();\n          e.clipboardData.clearData();\n          e.clipboardData.setData(\"text/plain\", lastCopied.join(\"\\n\"));\n        } else {\n          // Old-fashioned briefly-focus-a-textarea hack\n          var kludge = hiddenTextarea(), te = kludge.firstChild;\n          cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n          te.value = lastCopied.join(\"\\n\");\n          var hadFocus = document.activeElement;\n          selectInput(te);\n          setTimeout(function() {\n            cm.display.lineSpace.removeChild(kludge);\n            hadFocus.focus();\n          }, 50);\n        }\n      }\n      on(div, \"copy\", onCopyCut);\n      on(div, \"cut\", onCopyCut);\n    },\n\n    prepareSelection: function() {\n      var result = prepareSelection(this.cm, false);\n      result.focus = this.cm.state.focused;\n      return result;\n    },\n\n    showSelection: function(info) {\n      if (!info || !this.cm.display.view.length) return;\n      if (info.focus) this.showPrimarySelection();\n      this.showMultipleSelections(info);\n    },\n\n    showPrimarySelection: function() {\n      var sel = window.getSelection(), prim = this.cm.doc.sel.primary();\n      var curAnchor = domToPos(this.cm, sel.anchorNode, sel.anchorOffset);\n      var curFocus = domToPos(this.cm, sel.focusNode, sel.focusOffset);\n      if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n          cmp(minPos(curAnchor, curFocus), prim.from()) == 0 &&\n          cmp(maxPos(curAnchor, curFocus), prim.to()) == 0)\n        return;\n\n      var start = posToDOM(this.cm, prim.from());\n      var end = posToDOM(this.cm, prim.to());\n      if (!start && !end) return;\n\n      var view = this.cm.display.view;\n      var old = sel.rangeCount && sel.getRangeAt(0);\n      if (!start) {\n        start = {node: view[0].measure.map[2], offset: 0};\n      } else if (!end) { // FIXME dangerously hacky\n        var measure = view[view.length - 1].measure;\n        var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n        end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n      }\n\n      try { var rng = range(start.node, start.offset, end.offset, end.node); }\n      catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n      if (rng) {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n        if (old && sel.anchorNode == null) sel.addRange(old);\n        else if (gecko) this.startGracePeriod();\n      }\n      this.rememberSelection();\n    },\n\n    startGracePeriod: function() {\n      var input = this;\n      clearTimeout(this.gracePeriod);\n      this.gracePeriod = setTimeout(function() {\n        input.gracePeriod = false;\n        if (input.selectionChanged())\n          input.cm.operation(function() { input.cm.curOp.selectionChanged = true; });\n      }, 20);\n    },\n\n    showMultipleSelections: function(info) {\n      removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n      removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n    },\n\n    rememberSelection: function() {\n      var sel = window.getSelection();\n      this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n      this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n    },\n\n    selectionInEditor: function() {\n      var sel = window.getSelection();\n      if (!sel.rangeCount) return false;\n      var node = sel.getRangeAt(0).commonAncestorContainer;\n      return contains(this.div, node);\n    },\n\n    focus: function() {\n      if (this.cm.options.readOnly != \"nocursor\") this.div.focus();\n    },\n    blur: function() { this.div.blur(); },\n    getField: function() { return this.div; },\n\n    supportsTouch: function() { return true; },\n\n    receivedFocus: function() {\n      var input = this;\n      if (this.selectionInEditor())\n        this.pollSelection();\n      else\n        runInOp(this.cm, function() { input.cm.curOp.selectionChanged = true; });\n\n      function poll() {\n        if (input.cm.state.focused) {\n          input.pollSelection();\n          input.polling.set(input.cm.options.pollInterval, poll);\n        }\n      }\n      this.polling.set(this.cm.options.pollInterval, poll);\n    },\n\n    selectionChanged: function() {\n      var sel = window.getSelection();\n      return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n        sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset;\n    },\n\n    pollSelection: function() {\n      if (!this.composing && !this.gracePeriod && this.selectionChanged()) {\n        var sel = window.getSelection(), cm = this.cm;\n        this.rememberSelection();\n        var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n        var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n        if (anchor && head) runInOp(cm, function() {\n          setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n          if (anchor.bad || head.bad) cm.curOp.selectionChanged = true;\n        });\n      }\n    },\n\n    pollContent: function() {\n      var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n      var from = sel.from(), to = sel.to();\n      if (from.line < display.viewFrom || to.line > display.viewTo - 1) return false;\n\n      var fromIndex;\n      if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n        var fromLine = lineNo(display.view[0].line);\n        var fromNode = display.view[0].node;\n      } else {\n        var fromLine = lineNo(display.view[fromIndex].line);\n        var fromNode = display.view[fromIndex - 1].node.nextSibling;\n      }\n      var toIndex = findViewIndex(cm, to.line);\n      if (toIndex == display.view.length - 1) {\n        var toLine = display.viewTo - 1;\n        var toNode = display.lineDiv.lastChild;\n      } else {\n        var toLine = lineNo(display.view[toIndex + 1].line) - 1;\n        var toNode = display.view[toIndex + 1].node.previousSibling;\n      }\n\n      var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n      var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n      while (newText.length > 1 && oldText.length > 1) {\n        if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n        else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n        else break;\n      }\n\n      var cutFront = 0, cutEnd = 0;\n      var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n      while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n        ++cutFront;\n      var newBot = lst(newText), oldBot = lst(oldText);\n      var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                               oldBot.length - (oldText.length == 1 ? cutFront : 0));\n      while (cutEnd < maxCutEnd &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n        ++cutEnd;\n\n      newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd);\n      newText[0] = newText[0].slice(cutFront);\n\n      var chFrom = Pos(fromLine, cutFront);\n      var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n      if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n        replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n        return true;\n      }\n    },\n\n    ensurePolled: function() {\n      this.forceCompositionEnd();\n    },\n    reset: function() {\n      this.forceCompositionEnd();\n    },\n    forceCompositionEnd: function() {\n      if (!this.composing || this.composing.handled) return;\n      this.applyComposition(this.composing);\n      this.composing.handled = true;\n      this.div.blur();\n      this.div.focus();\n    },\n    applyComposition: function(composing) {\n      if (isReadOnly(this.cm))\n        operation(this.cm, regChange)(this.cm)\n      else if (composing.data && composing.data != composing.startData)\n        operation(this.cm, applyTextInput)(this.cm, composing.data, 0, composing.sel);\n    },\n\n    setUneditable: function(node) {\n      node.contentEditable = \"false\"\n    },\n\n    onKeyPress: function(e) {\n      e.preventDefault();\n      if (!isReadOnly(this.cm))\n        operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0);\n    },\n\n    readOnlyChanged: function(val) {\n      this.div.contentEditable = String(val != \"nocursor\")\n    },\n\n    onContextMenu: nothing,\n    resetPosition: nothing,\n\n    needsContentAttribute: true\n  }, ContentEditableInput.prototype);\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) return null;\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result;\n  }\n\n  function badPos(pos, bad) { if (bad) pos.bad = true; return pos; }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true);\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) return null;\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) break;\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        return locateNodeInLineView(lineView, node, offset);\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) return badPos(Pos(lineNo(lineView.line), 0), true);\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad);\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) offset = textNode.nodeValue.length;\n    }\n    while (topNode.parentNode != wrapper) topNode = topNode.parentNode;\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) ch = map[j + (offset ? 1 : 0)];\n            return Pos(line, ch);\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) return badPos(found, bad);\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        return badPos(Pos(found.line, found.ch - dist), bad);\n      else\n        dist += after.textContent.length;\n    }\n    for (var before = topNode.previousSibling, dist = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        return badPos(Pos(found.line, found.ch + dist), bad);\n      else\n        dist += after.textContent.length;\n    }\n  }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator();\n    function recognizeMarker(id) { return function(marker) { return marker.id == id; }; }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText != null) {\n          if (cmText == \"\") cmText = node.textContent.replace(/\\u200b/g, \"\");\n          text += cmText;\n          return;\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find()))\n            text += getBetween(cm.doc, range.from, range.to).join(lineSep);\n          return;\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") return;\n        for (var i = 0; i < node.childNodes.length; i++)\n          walk(node.childNodes[i]);\n        if (/^(pre|div|p)$/i.test(node.nodeName))\n          closing = true;\n      } else if (node.nodeType == 3) {\n        var val = node.nodeValue;\n        if (!val) return;\n        if (closing) {\n          text += lineSep;\n          closing = false;\n        }\n        text += val;\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) break;\n      from = from.nextSibling;\n    }\n    return text;\n  }\n\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // SELECTION / CURSOR\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  function Selection(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  }\n\n  Selection.prototype = {\n    primary: function() { return this.ranges[this.primIndex]; },\n    equals: function(other) {\n      if (other == this) return true;\n      if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) return false;\n      for (var i = 0; i < this.ranges.length; i++) {\n        var here = this.ranges[i], there = other.ranges[i];\n        if (cmp(here.anchor, there.anchor) != 0 || cmp(here.head, there.head) != 0) return false;\n      }\n      return true;\n    },\n    deepCopy: function() {\n      for (var out = [], i = 0; i < this.ranges.length; i++)\n        out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head));\n      return new Selection(out, this.primIndex);\n    },\n    somethingSelected: function() {\n      for (var i = 0; i < this.ranges.length; i++)\n        if (!this.ranges[i].empty()) return true;\n      return false;\n    },\n    contains: function(pos, end) {\n      if (!end) end = pos;\n      for (var i = 0; i < this.ranges.length; i++) {\n        var range = this.ranges[i];\n        if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n          return i;\n      }\n      return -1;\n    }\n  };\n\n  function Range(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  }\n\n  Range.prototype = {\n    from: function() { return minPos(this.anchor, this.head); },\n    to: function() { return maxPos(this.anchor, this.head); },\n    empty: function() {\n      return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch;\n    }\n  };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(ranges, primIndex) {\n    var prim = ranges[primIndex];\n    ranges.sort(function(a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      if (cmp(prev.to(), cur.from()) >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) --primIndex;\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex);\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0);\n  }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) return Pos(doc.first, 0);\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) return Pos(last, getLine(doc, last).text.length);\n    return clipToLen(pos, getLine(doc, pos.line).text.length);\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) return Pos(pos.line, linelen);\n    else if (ch < 0) return Pos(pos.line, 0);\n    else return pos;\n  }\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size;}\n  function clipPosArray(doc, array) {\n    for (var out = [], i = 0; i < array.length; i++) out[i] = clipPos(doc, array[i]);\n    return out;\n  }\n\n  // SELECTION UPDATES\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(doc, range, head, other) {\n    if (doc.cm && doc.cm.display.shift || doc.extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head);\n    } else {\n      return new Range(other || head, head);\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options) {\n    setSelection(doc, new Selection([extendRange(doc, doc.sel.primary(), head, other)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    for (var out = [], i = 0; i < doc.sel.ranges.length; i++)\n      out[i] = extendRange(doc, doc.sel.ranges[i], heads[i], null);\n    var newSel = normalizeSelection(out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head));\n      }\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj);\n    if (obj.ranges != sel.ranges) return normalizeSelection(obj.ranges, obj.ranges.length - 1);\n    else return sel;\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      sel = filterSelectionChange(doc, sel);\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      ensureCursorVisible(doc.cm);\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) return;\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false), sel_dontScroll);\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) out = sel.ranges.slice(0, i);\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(out, sel.primIndex) : sel;\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, bias, mayClear) {\n    var flipped = false, curPos = pos;\n    var dir = bias || 1;\n    doc.cantEdit = false;\n    search: for (;;) {\n      var line = getLine(doc, curPos.line);\n      if (line.markedSpans) {\n        for (var i = 0; i < line.markedSpans.length; ++i) {\n          var sp = line.markedSpans[i], m = sp.marker;\n          if ((sp.from == null || (m.inclusiveLeft ? sp.from <= curPos.ch : sp.from < curPos.ch)) &&\n              (sp.to == null || (m.inclusiveRight ? sp.to >= curPos.ch : sp.to > curPos.ch))) {\n            if (mayClear) {\n              signal(m, \"beforeCursorEnter\");\n              if (m.explicitlyCleared) {\n                if (!line.markedSpans) break;\n                else {--i; continue;}\n              }\n            }\n            if (!m.atomic) continue;\n            var newPos = m.find(dir < 0 ? -1 : 1);\n            if (cmp(newPos, curPos) == 0) {\n              newPos.ch += dir;\n              if (newPos.ch < 0) {\n                if (newPos.line > doc.first) newPos = clipPos(doc, Pos(newPos.line - 1));\n                else newPos = null;\n              } else if (newPos.ch > line.text.length) {\n                if (newPos.line < doc.first + doc.size - 1) newPos = Pos(newPos.line + 1, 0);\n                else newPos = null;\n              }\n              if (!newPos) {\n                if (flipped) {\n                  // Driven in a corner -- no valid cursor position found at all\n                  // -- try again *with* clearing, if we didn't already\n                  if (!mayClear) return skipAtomic(doc, pos, bias, true);\n                  // Otherwise, turn off editing until further notice, and return the start of the doc\n                  doc.cantEdit = true;\n                  return Pos(doc.first, 0);\n                }\n                flipped = true; newPos = pos; dir = -dir;\n              }\n            }\n            curPos = newPos;\n            continue search;\n          }\n        }\n      }\n      return curPos;\n    }\n  }\n\n  // SELECTION DRAWING\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (primary === false && i == doc.sel.primIndex) continue;\n      var range = doc.sel.ranges[i];\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        drawSelectionCursor(cm, range.head, curFragment);\n      if (!collapsed)\n        drawSelectionRange(cm, range, selFragment);\n    }\n    return result;\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n\n    function add(left, top, width, bottom) {\n      if (top < 0) top = 0;\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", \"position: absolute; left: \" + left +\n                               \"px; top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) +\n                               \"px; height: \" + (bottom - top) + \"px\"));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias);\n      }\n\n      iterateBidiSections(getOrder(lineObj), fromArg || 0, toArg == null ? lineLen : toArg, function(from, to, dir) {\n        var leftPos = coords(from, \"left\"), rightPos, left, right;\n        if (from == to) {\n          rightPos = leftPos;\n          left = right = leftPos.left;\n        } else {\n          rightPos = coords(to - 1, \"right\");\n          if (dir == \"rtl\") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }\n          left = leftPos.left;\n          right = rightPos.right;\n        }\n        if (fromArg == null && from == 0) left = leftSide;\n        if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part\n          add(left, leftPos.top, null, leftPos.bottom);\n          left = leftSide;\n          if (leftPos.bottom < rightPos.top) add(left, leftPos.bottom, null, rightPos.top);\n        }\n        if (toArg == null && to == lineLen) right = rightSide;\n        if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)\n          start = leftPos;\n        if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)\n          end = rightPos;\n        if (left < leftSide + 1) left = leftSide;\n        add(left, rightPos.top, right - left, rightPos.bottom);\n      });\n      return {start: start, end: end};\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        add(leftSide, leftEnd.bottom, null, rightStart.top);\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) return;\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      display.blinker = setInterval(function() {\n        display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate);\n    else if (cm.options.cursorBlinkRate < 0)\n      display.cursorDiv.style.visibility = \"hidden\";\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.mode.startState && cm.doc.frontier < cm.display.viewTo)\n      cm.state.highlight.set(time, bind(highlightWorker, cm));\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.frontier < doc.first) doc.frontier = doc.first;\n    if (doc.frontier >= cm.display.viewTo) return;\n    var end = +new Date + cm.options.workTime;\n    var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n    var changedLines = [];\n\n    doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function(line) {\n      if (doc.frontier >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles, tooLong = line.text.length > cm.options.maxHighlightLength;\n        var highlighted = highlightLine(cm, line, tooLong ? copyState(doc.mode, state) : state, true);\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) line.styleClasses = newCls;\n        else if (oldCls) line.styleClasses = null;\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) ischange = oldStyles[i] != line.styles[i];\n        if (ischange) changedLines.push(doc.frontier);\n        line.stateAfter = tooLong ? state : copyState(doc.mode, state);\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          processLine(cm, line.text, state);\n        line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n      }\n      ++doc.frontier;\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true;\n      }\n    });\n    if (changedLines.length) runInOp(cm, function() {\n      for (var i = 0; i < changedLines.length; i++)\n        regLineChange(cm, changedLines[i], \"text\");\n    });\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) return doc.first;\n      var line = getLine(doc, search - 1);\n      if (line.stateAfter && (!precise || search <= doc.frontier)) return search;\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline;\n  }\n\n  function getStateBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) return true;\n    var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n    if (!state) state = startState(doc.mode);\n    else state = copyState(doc.mode, state);\n    doc.iter(pos, n, function(line) {\n      processLine(cm, line.text, state);\n      var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n      line.stateAfter = save ? copyState(doc.mode, state) : null;\n      ++pos;\n    });\n    if (precise) doc.frontier = pos;\n    return state;\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop;}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight;}\n  function paddingH(display) {\n    if (display.cachedPaddingH) return display.cachedPaddingH;\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) display.cachedPaddingH = data;\n    return data;\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth; }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth;\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight;\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            heights.push((cur.bottom + next.top) / 2 - rect.top);\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      return {map: lineView.measure.map, cache: lineView.measure.cache};\n    for (var i = 0; i < lineView.rest.length; i++)\n      if (lineView.rest[i] == line)\n        return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]};\n    for (var i = 0; i < lineView.rest.length; i++)\n      if (lineNo(lineView.rest[i]) > lineN)\n        return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i], before: true};\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view;\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias);\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      return cm.display.view[findViewIndex(cm, lineN)];\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      return ext;\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      view = updateExternalMeasurement(cm, line);\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    };\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) ch = -1;\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        prepared.rect = prepared.view.text.getBoundingClientRect();\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) prepared.cache[key] = found;\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom};\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      var mStart = map[i], mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) collapse = \"right\";\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          collapse = bias;\n        if (bias == \"left\" && start == 0)\n          while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          }\n        if (bias == \"right\" && start == mEnd - mStart)\n          while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          }\n        break;\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd};\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i = 0; i < 4; i++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) --start;\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) ++end;\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart) {\n          rect = node.parentNode.getBoundingClientRect();\n        } else if (ie && cm.options.lineWrapping) {\n          var rects = range(node, start, end).getClientRects();\n          if (rects.length)\n            rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n          else\n            rect = nullRect;\n        } else {\n          rect = range(node, start, end).getBoundingClientRect() || nullRect;\n        }\n        if (rect.left || rect.right || start == 0) break;\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) rect = maybeUpdateRectForZooming(cm.display.measure, rect);\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) collapse = bias = \"right\";\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n      else\n        rect = node.getBoundingClientRect();\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom};\n      else\n        rect = nullRect;\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    for (var i = 0; i < heights.length - 1; i++)\n      if (mid < heights[i]) break;\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) result.bogus = true;\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result;\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      return rect;\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY};\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) for (var i = 0; i < lineView.rest.length; i++)\n        lineView.measure.caches[i] = {};\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      clearLineMeasurementCacheFor(cm.display.view[i]);\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) cm.display.maxLineChanged = true;\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() { return window.pageXOffset || (document.documentElement || document.body).scrollLeft; }\n  function pageScrollY() { return window.pageYOffset || (document.documentElement || document.body).scrollTop; }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"/null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context) {\n    if (lineObj.widgets) for (var i = 0; i < lineObj.widgets.length; ++i) if (lineObj.widgets[i].above) {\n      var size = widgetHeight(lineObj.widgets[i]);\n      rect.top += size; rect.bottom += size;\n    }\n    if (context == \"line\") return rect;\n    if (!context) context = \"local\";\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") yOff += paddingTop(cm.display);\n    else yOff -= cm.display.viewOffset;\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect;\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"/null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") return coords;\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top};\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) lineObj = getLine(cm.doc, pos.line);\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context);\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) m.left = m.right; else m.right = m.left;\n      return intoCoordSystem(cm, lineObj, m, context);\n    }\n    function getBidi(ch, partPos) {\n      var part = order[partPos], right = part.level % 2;\n      if (ch == bidiLeft(part) && partPos && part.level < order[partPos - 1].level) {\n        part = order[--partPos];\n        ch = bidiRight(part) - (part.level % 2 ? 0 : 1);\n        right = true;\n      } else if (ch == bidiRight(part) && partPos < order.length - 1 && part.level < order[partPos + 1].level) {\n        part = order[++partPos];\n        ch = bidiLeft(part) - part.level % 2;\n        right = false;\n      }\n      if (right && ch == part.to && ch > part.from) return get(ch - 1);\n      return get(ch, right);\n    }\n    var order = getOrder(lineObj), ch = pos.ch;\n    if (!order) return get(ch);\n    var partPos = getBidiPartAt(order, ch);\n    var val = getBidi(ch, partPos);\n    if (bidiOther != null) val.other = getBidi(ch, bidiOther);\n    return val;\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0, pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) left = charWidth(cm.display) * pos.ch;\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height};\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, outside, xRel) {\n    var pos = Pos(line, ch);\n    pos.xRel = xRel;\n    if (outside) pos.outside = true;\n    return pos;\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) return PosWithInfo(doc.first, 0, true, -1);\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, true, 1);\n    if (x < 0) x = 0;\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var merged = collapsedSpanAtEnd(lineObj);\n      var mergedPos = merged && merged.find(0, true);\n      if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n        lineN = lineNo(lineObj = mergedPos.to.line);\n      else\n        return found;\n    }\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    var innerOff = y - heightAtLine(lineObj);\n    var wrongLine = false, adjust = 2 * cm.display.wrapper.clientWidth;\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n\n    function getX(ch) {\n      var sp = cursorCoords(cm, Pos(lineNo, ch), \"line\", lineObj, preparedMeasure);\n      wrongLine = true;\n      if (innerOff > sp.bottom) return sp.left - adjust;\n      else if (innerOff < sp.top) return sp.left + adjust;\n      else wrongLine = false;\n      return sp.left;\n    }\n\n    var bidi = getOrder(lineObj), dist = lineObj.text.length;\n    var from = lineLeft(lineObj), to = lineRight(lineObj);\n    var fromX = getX(from), fromOutside = wrongLine, toX = getX(to), toOutside = wrongLine;\n\n    if (x > toX) return PosWithInfo(lineNo, to, toOutside, 1);\n    // Do a binary search between these bounds.\n    for (;;) {\n      if (bidi ? to == from || to == moveVisually(lineObj, from, 1) : to - from <= 1) {\n        var ch = x < fromX || x - fromX <= toX - x ? from : to;\n        var xDiff = x - (ch == from ? fromX : toX);\n        while (isExtendingChar(lineObj.text.charAt(ch))) ++ch;\n        var pos = PosWithInfo(lineNo, ch, ch == from ? fromOutside : toOutside,\n                              xDiff < -1 ? -1 : xDiff > 1 ? 1 : 0);\n        return pos;\n      }\n      var step = Math.ceil(dist / 2), middle = from + step;\n      if (bidi) {\n        middle = from;\n        for (var i = 0; i < step; ++i) middle = moveVisually(lineObj, middle, 1);\n      }\n      var middleX = getX(middle);\n      if (middleX > x) {to = middle; toX = middleX; if (toOutside = wrongLine) toX += 1000; dist = step;}\n      else {from = middle; fromX = middleX; fromOutside = wrongLine; dist -= step;}\n    }\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) return display.cachedTextHeight;\n    if (measureText == null) {\n      measureText = elt(\"pre\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) display.cachedTextHeight = height;\n    removeChildren(display.measure);\n    return height || 1;\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) return display.cachedCharWidth;\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) display.cachedCharWidth = width;\n    return width || 10;\n  }\n\n  // OPERATIONS\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var operationGroup = null;\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: null,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    if (operationGroup) {\n      operationGroup.ops.push(cm.curOp);\n    } else {\n      cm.curOp.ownsGroup = operationGroup = {\n        ops: [cm.curOp],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        callbacks[i].call(null);\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm);\n      }\n    } while (i < callbacks.length);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp, group = op.ownsGroup;\n    if (!group) return;\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      for (var i = 0; i < group.ops.length; i++)\n        group.ops[i].cm.curOp = null;\n      endOperations(group);\n    }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_R1(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Write DOM (maybe)\n      endOperation_W1(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_R2(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Write DOM (maybe)\n      endOperation_W2(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_finish(ops[i]);\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) findMaxLine(cm);\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) updateHeightsInViewport(cm);\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      op.preparedSelection = display.input.prepareSelection();\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true);\n      cm.display.maxLineChanged = false;\n    }\n\n    if (op.preparedSelection)\n      cm.display.input.showSelection(op.preparedSelection);\n    if (op.updatedDisplay)\n      setDocumentHeight(cm, op.barMeasure);\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      updateScrollbars(cm, op.barMeasure);\n\n    if (op.selectionChanged) restartBlink(cm);\n\n    if (cm.state.focused && op.updateInput)\n      cm.display.input.reset(op.typing);\n    if (op.focus && op.focus == activeElt()) ensureFocus(op.cm);\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) postUpdateDisplay(cm, op.update);\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      display.wheelStartX = display.wheelStartY = null;\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null && (display.scroller.scrollTop != op.scrollTop || op.forceScroll)) {\n      doc.scrollTop = Math.max(0, Math.min(display.scroller.scrollHeight - display.scroller.clientHeight, op.scrollTop));\n      display.scrollbars.setScrollTop(doc.scrollTop);\n      display.scroller.scrollTop = doc.scrollTop;\n    }\n    if (op.scrollLeft != null && (display.scroller.scrollLeft != op.scrollLeft || op.forceScroll)) {\n      doc.scrollLeft = Math.max(0, Math.min(display.scroller.scrollWidth - displayWidth(cm), op.scrollLeft));\n      display.scrollbars.setScrollLeft(doc.scrollLeft);\n      display.scroller.scrollLeft = doc.scrollLeft;\n      alignHorizontally(cm);\n    }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var coords = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                     clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      if (op.scrollToPos.isCursor && cm.state.focused) maybeScrollWindow(cm, coords);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) for (var i = 0; i < hidden.length; ++i)\n      if (!hidden[i].lines.length) signal(hidden[i], \"hide\");\n    if (unhidden) for (var i = 0; i < unhidden.length; ++i)\n      if (unhidden[i].lines.length) signal(unhidden[i], \"unhide\");\n\n    if (display.wrapper.offsetHeight)\n      doc.scrollTop = cm.display.scroller.scrollTop;\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      signal(cm, \"changes\", cm, op.changeObjs);\n    if (op.update)\n      op.update.finish();\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) return f();\n    startOperation(cm);\n    try { return f(); }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) return f.apply(cm, arguments);\n      startOperation(cm);\n      try { return f.apply(cm, arguments); }\n      finally { endOperation(cm); }\n    };\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) return f.apply(this, arguments);\n      startOperation(this);\n      try { return f.apply(this, arguments); }\n      finally { endOperation(this); }\n    };\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) return f.apply(this, arguments);\n      startOperation(cm);\n      try { return f.apply(this, arguments); }\n      finally { endOperation(cm); }\n    };\n  }\n\n  // VIEW TRACKING\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array;\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) from = cm.doc.first;\n    if (to == null) to = cm.doc.first + cm.doc.size;\n    if (!lendiff) lendiff = 0;\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      display.updateLineNumbers = from;\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        resetView(cm);\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut = viewCuttingPoint(cm, from, from, -1);\n      if (cut) {\n        display.view = display.view.slice(0, cut.index);\n        display.viewTo = cut.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        ext.lineN += lendiff;\n      else if (from < ext.lineN + ext.size)\n        display.externalMeasured = null;\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      display.externalMeasured = null;\n\n    if (line < display.viewFrom || line >= display.viewTo) return;\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) return;\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) arr.push(type);\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) return null;\n    n -= cm.display.viewFrom;\n    if (n < 0) return null;\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) return i;\n    }\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      return {index: index, lineN: newN};\n    for (var i = 0, n = cm.display.viewFrom; i < index; i++)\n      n += view[i].size;\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) return null;\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) return null;\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN};\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view);\n      else if (display.viewFrom < from)\n        display.view = display.view.slice(findViewIndex(cm, from));\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        display.view = display.view.concat(buildViewArray(cm, display.viewTo, to));\n      else if (display.viewTo > to)\n        display.view = display.view.slice(0, findViewIndex(cm, to));\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) ++dirty;\n    }\n    return dirty;\n  }\n\n  // EVENT HANDLERS\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      on(d.scroller, \"dblclick\", operation(cm, function(e) {\n        if (signalDOMEvent(cm, e)) return;\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) return;\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      }));\n    else\n      on(d.scroller, \"dblclick\", function(e) { signalDOMEvent(cm, e) || e_preventDefault(e); });\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    if (!captureRightClick) on(d.scroller, \"contextmenu\", function(e) {onContextMenu(cm, e);});\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function() {d.activeTouch = null;}, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    };\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) return false;\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1;\n    }\n    function farAway(touch, other) {\n      if (other.left == null) return true;\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20;\n    }\n    on(d.scroller, \"touchstart\", function(e) {\n      if (!isMouseLikeTouchEvent(e)) {\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function() {\n      if (d.activeTouch) d.activeTouch.moved = true;\n    });\n    on(d.scroller, \"touchend\", function(e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          range = new Range(pos, pos);\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          range = cm.findWordAt(pos);\n        else // Triple tap\n          range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0)));\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function() {\n      if (d.scroller.clientHeight) {\n        setScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function(e){onScrollWheel(cm, e);});\n    on(d.scroller, \"DOMMouseScroll\", function(e){onScrollWheel(cm, e);});\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function() { d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function(e) {if (!signalDOMEvent(cm, e)) e_stop(e);},\n      over: function(e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function(e){onDragStart(cm, e);},\n      drop: operation(cm, onDrop),\n      leave: function() {clearDragCursor(cm);}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function(e) { onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", bind(onFocus, cm));\n    on(inp, \"blur\", bind(onBlur, cm));\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != CodeMirror.Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth)\n      return;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  // MOUSE EVENTS\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        return true;\n    }\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") return null;\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null; }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords;\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (display.activeTouch && display.input.supportsTouch() || signalDOMEvent(cm, e)) return;\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function(){display.scroller.draggable = true;}, 100);\n      }\n      return;\n    }\n    if (clickInGutter(cm, e)) return;\n    var start = posFromMouse(cm, e);\n    window.focus();\n\n    switch (e_button(e)) {\n    case 1:\n      // #3261: make sure, that we're not starting a second selection\n      if (cm.state.selectingText)\n        cm.state.selectingText(e);\n      else if (start)\n        leftButtonDown(cm, e, start);\n      else if (e_target(e) == display.scroller)\n        e_preventDefault(e);\n      break;\n    case 2:\n      if (webkit) cm.state.lastMiddleDown = +new Date;\n      if (start) extendSelection(cm.doc, start);\n      setTimeout(function() {display.input.focus();}, 20);\n      e_preventDefault(e);\n      break;\n    case 3:\n      if (captureRightClick) onContextMenu(cm, e);\n      else delayBlurEvent(cm);\n      break;\n    }\n  }\n\n  var lastClick, lastDoubleClick;\n  function leftButtonDown(cm, e, start) {\n    if (ie) setTimeout(bind(ensureFocus, cm), 0);\n    else cm.curOp.focus = activeElt();\n\n    var now = +new Date, type;\n    if (lastDoubleClick && lastDoubleClick.time > now - 400 && cmp(lastDoubleClick.pos, start) == 0) {\n      type = \"triple\";\n    } else if (lastClick && lastClick.time > now - 400 && cmp(lastClick.pos, start) == 0) {\n      type = \"double\";\n      lastDoubleClick = {time: now, pos: start};\n    } else {\n      type = \"single\";\n      lastClick = {time: now, pos: start};\n    }\n\n    var sel = cm.doc.sel, modifier = mac ? e.metaKey : e.ctrlKey, contained;\n    if (cm.options.dragDrop && dragAndDrop && !isReadOnly(cm) &&\n        type == \"single\" && (contained = sel.contains(start)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), start) < 0 || start.xRel > 0) &&\n        (cmp(contained.to(), start) > 0 || start.xRel < 0))\n      leftButtonStartDrag(cm, e, start, modifier);\n    else\n      leftButtonSelect(cm, e, start, type, modifier);\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, e, start, modifier) {\n    var display = cm.display, startTime = +new Date;\n    var dragEnd = operation(cm, function(e2) {\n      if (webkit) display.scroller.draggable = false;\n      cm.state.draggingText = false;\n      off(document, \"mouseup\", dragEnd);\n      off(display.scroller, \"drop\", dragEnd);\n      if (Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) < 10) {\n        e_preventDefault(e2);\n        if (!modifier && +new Date - 200 < startTime)\n          extendSelection(cm.doc, start);\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if (webkit || ie && ie_version == 9)\n          setTimeout(function() {document.body.focus(); display.input.focus();}, 20);\n        else\n          display.input.focus();\n      }\n    });\n    // Let the drag handler handle this.\n    if (webkit) display.scroller.draggable = true;\n    cm.state.draggingText = dragEnd;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) display.scroller.dragDrop();\n    on(document, \"mouseup\", dragEnd);\n    on(display.scroller, \"drop\", dragEnd);\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, e, start, type, addNew) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(e);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (addNew && !e.shiftKey) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        ourRange = ranges[ourIndex];\n      else\n        ourRange = new Range(start, start);\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (e.altKey) {\n      type = \"rect\";\n      if (!addNew) ourRange = new Range(start, start);\n      start = posFromMouse(cm, e, true, true);\n      ourIndex = -1;\n    } else if (type == \"double\") {\n      var word = cm.findWordAt(start);\n      if (cm.display.shift || doc.extend)\n        ourRange = extendRange(doc, ourRange, word.anchor, word.head);\n      else\n        ourRange = word;\n    } else if (type == \"triple\") {\n      var line = new Range(Pos(start.line, 0), clipPos(doc, Pos(start.line + 1, 0)));\n      if (cm.display.shift || doc.extend)\n        ourRange = extendRange(doc, ourRange, line.anchor, line.head);\n      else\n        ourRange = line;\n    } else {\n      ourRange = extendRange(doc, ourRange, start);\n    }\n\n    if (!addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && type == \"single\" && !e.shiftKey) {\n      setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) return;\n      lastPos = pos;\n\n      if (type == \"rect\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos)));\n          else if (text.length > leftPos)\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize))));\n        }\n        if (!ranges.length) ranges.push(new Range(start, start));\n        setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var anchor = oldRange.anchor, head = pos;\n        if (type != \"single\") {\n          if (type == \"double\")\n            var range = cm.findWordAt(pos);\n          else\n            var range = new Range(Pos(pos.line, 0), clipPos(doc, Pos(pos.line + 1, 0)));\n          if (cmp(range.anchor, anchor) > 0) {\n            head = range.head;\n            anchor = minPos(oldRange.from(), range.anchor);\n          } else {\n            head = range.anchor;\n            anchor = maxPos(oldRange.to(), range.head);\n          }\n        }\n        var ranges = startSel.ranges.slice(0);\n        ranges[ourIndex] = new Range(clipPos(doc, anchor), head);\n        setSelection(doc, normalizeSelection(ranges, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, type == \"rect\");\n      if (!cur) return;\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          setTimeout(operation(cm, function(){if (counter == curCount) extend(e);}), 150);\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) setTimeout(operation(cm, function() {\n          if (counter != curCount) return;\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50);\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      e_preventDefault(e);\n      display.input.focus();\n      off(document, \"mousemove\", move);\n      off(document, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function(e) {\n      if (!e_button(e)) done(e);\n      else extend(e);\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(document, \"mousemove\", move);\n    on(document, \"mouseup\", up);\n  }\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent, signalfn) {\n    try { var mX = e.clientX, mY = e.clientY; }\n    catch(e) { return false; }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) return false;\n    if (prevent) e_preventDefault(e);\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) return e_defaultPrevented(e);\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.options.gutters.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.options.gutters[i];\n        signalfn(cm, type, cm, line, gutter, e);\n        return e_defaultPrevented(e);\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true, signalLater);\n  }\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      return;\n    e_preventDefault(e);\n    if (ie) lastDrop = +new Date;\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || isReadOnly(cm)) return;\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var loadFile = function(file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1)\n          return;\n\n        var reader = new FileReader;\n        reader.onload = operation(cm, function() {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) content = \"\";\n          text[i] = content;\n          if (++read == n) {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n          }\n        });\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < n; ++i) loadFile(files[i], i);\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function() {cm.display.input.focus();}, 20);\n        return;\n      }\n      try {\n        var text = e.dataTransfer.getData(\"Text\");\n        if (text) {\n          if (cm.state.draggingText && !(mac ? e.altKey : e.ctrlKey))\n            var selected = cm.listSelections();\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) for (var i = 0; i < selected.length; ++i)\n            replaceRange(cm.doc, \"\", selected[i].anchor, selected[i].head, \"drag\");\n          cm.replaceSelection(text, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return; }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) return;\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) img.parentNode.removeChild(img);\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) return;\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // SCROLL EVENTS\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function setScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) return;\n    cm.doc.scrollTop = val;\n    if (!gecko) updateDisplaySimple(cm, {top: val});\n    if (cm.display.scroller.scrollTop != val) cm.display.scroller.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (gecko) updateDisplaySimple(cm);\n    startWorker(cm, 100);\n  }\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller) {\n    if (isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) return;\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) cm.display.scroller.scrollLeft = val;\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) wheelPixelsPerUnit = -.53;\n  else if (gecko) wheelPixelsPerUnit = 15;\n  else if (chrome) wheelPixelsPerUnit = -.7;\n  else if (safari) wheelPixelsPerUnit = -1/3;\n\n  var wheelEventDelta = function(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) dx = e.detail;\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) dy = e.detail;\n    else if (dy == null) dy = e.wheelDelta;\n    return {x: dx, y: dy};\n  };\n  CodeMirror.wheelEventPixels = function(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta;\n  };\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) return;\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer;\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        setScrollTop(cm, Math.max(0, Math.min(scroll.scrollTop + dy * wheelPixelsPerUnit, scroll.scrollHeight - scroll.clientHeight)));\n      setScrollLeft(cm, Math.max(0, Math.min(scroll.scrollLeft + dx * wheelPixelsPerUnit, scroll.scrollWidth - scroll.clientWidth)));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        e_preventDefault(e);\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return;\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) top = Math.max(0, top + pixels - 50);\n      else bot = Math.min(cm.doc.height, bot + pixels + 50);\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function() {\n          if (display.wheelStartX == null) return;\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) return;\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // KEY EVENTS\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) return false;\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (isReadOnly(cm)) cm.state.suppressEdits = true;\n      if (dropShift) cm.display.shift = false;\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done;\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) return result;\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm);\n  }\n\n  var stopSeq = new Delayed;\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) return \"handled\";\n      stopSeq.set(50, function() {\n        if (cm.state.keySeq == seq) {\n          cm.state.keySeq = null;\n          cm.display.input.reset();\n        }\n      });\n      name = seq + \" \" + name;\n    }\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      cm.state.keySeq = name;\n    if (result == \"handled\")\n      signalLater(cm, \"keyHandled\", cm, name, e);\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    if (seq && !result && /\\'$/.test(name)) {\n      e_preventDefault(e);\n      return true;\n    }\n    return !!result;\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) return false;\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function(b) {return doHandleBinding(cm, b, true);})\n          || dispatchKey(cm, name, e, function(b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 return doHandleBinding(cm, b);\n             });\n    } else {\n      return dispatchKey(cm, name, e, function(b) { return doHandleBinding(cm, b); });\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e,\n                       function(b) { return doHandleBinding(cm, b, true); });\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) return;\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) e.returnValue = false;\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        cm.replaceSelection(\"\", null, \"cut\");\n    }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      showCrossHair(cm);\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) this.doc.sel.shift = false;\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) return;\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return;}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) return;\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    if (handleCharBinding(cm, e, ch)) return;\n    cm.display.input.onKeyPress(e);\n  }\n\n  // FOCUS/BLUR EVENTS\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function() {\n      if (cm.state.delayingBlurEvent) {\n        cm.state.delayingBlurEvent = false;\n        onBlur(cm);\n      }\n    }, 100);\n  }\n\n  function onFocus(cm) {\n    if (cm.state.delayingBlurEvent) cm.state.delayingBlurEvent = false;\n\n    if (cm.options.readOnly == \"nocursor\") return;\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) setTimeout(function() { cm.display.input.reset(true); }, 20); // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm) {\n    if (cm.state.delayingBlurEvent) return;\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function() {if (!cm.state.focused) cm.display.shift = false;}, 150);\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) return;\n    if (signalDOMEvent(cm, e, \"contextmenu\")) return;\n    cm.display.input.onContextMenu(e);\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) return false;\n    return gutterEvent(cm, e, \"gutterContextMenu\", false, signal);\n  }\n\n  // UPDATING\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  var changeEnd = CodeMirror.changeEnd = function(change) {\n    if (!change.text) return change.to;\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));\n  };\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) return pos;\n    if (cmp(pos, change.to) <= 0) return changeEnd(change);\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) ch += changeEnd(change).ch - change.to.ch;\n    return Pos(line, ch);\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(out, doc.sel.primIndex);\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      return Pos(nw.line, pos.ch - old.ch + nw.ch);\n    else\n      return Pos(nw.line + (pos.line - old.line), pos.ch);\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex);\n  }\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function() { this.canceled = true; }\n    };\n    if (update) obj.update = function(from, to, text, origin) {\n      if (from) this.from = clipPos(doc, from);\n      if (to) this.to = clipPos(doc, to);\n      if (text) this.text = text;\n      if (origin !== undefined) this.origin = origin;\n    };\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeChange\", doc.cm, obj);\n\n    if (obj.canceled) return null;\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin};\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly);\n      if (doc.cm.state.suppressEdits) return;\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) return;\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text});\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) return;\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function(doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    if (doc.cm && doc.cm.state.suppressEdits) return;\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    for (var i = 0; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        break;\n    }\n    if (i == source.length) return;\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return;\n        }\n        selAfter = event;\n      }\n      else break;\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    for (var i = event.changes.length - 1; i >= 0; --i) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return;\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)});\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function(doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) return;\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function(range) {\n      return new Range(Pos(range.anchor.line + distance, range.anchor.ch),\n                       Pos(range.head.line + distance, range.head.ch));\n    }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        regLineChange(doc.cm, l, \"gutter\");\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return;\n    }\n    if (change.from.line > doc.lastLine()) return;\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) selAfter = computeSelAfterChange(doc, change);\n    if (doc.cm) makeChangeSingleDocInEditor(doc.cm, change, spans);\n    else updateDoc(doc, change, spans);\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function(line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true;\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      signalCursorActivity(cm);\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function(line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) cm.curOp.updateMaxLine = true;\n    }\n\n    // Adjust frontier, schedule worker\n    doc.frontier = Math.min(doc.frontier, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      regChange(cm);\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      regLineChange(cm, from.line, \"text\");\n    else\n      regChange(cm, from.line, to.line + 1, lendiff);\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) signalLater(cm, \"change\", cm, obj);\n      if (changesHandler) (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj);\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    if (!to) to = from;\n    if (cmp(to, from) < 0) { var tmp = to; to = from; from = tmp; }\n    if (typeof code == \"string\") code = doc.splitLines(code);\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, coords) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) return;\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (coords.top + box.top < 0) doScroll = true;\n    else if (coords.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) doScroll = false;\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, \"position: absolute; top: \" +\n                           (coords.top - display.viewOffset - paddingTop(cm.display)) + \"px; height: \" +\n                           (coords.bottom - coords.top + scrollGap(cm) + display.barHeight) + \"px; left: \" +\n                           coords.left + \"px; width: 2px;\");\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) margin = 0;\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false, coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      var scrollPos = calculateScrollPos(cm, Math.min(coords.left, endCoords.left),\n                                         Math.min(coords.top, endCoords.top) - margin,\n                                         Math.max(coords.left, endCoords.left),\n                                         Math.max(coords.bottom, endCoords.bottom) + margin);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        setScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) changed = true;\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) changed = true;\n      }\n      if (!changed) break;\n    }\n    return coords;\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, x1, y1, x2, y2) {\n    var scrollPos = calculateScrollPos(cm, x1, y1, x2, y2);\n    if (scrollPos.scrollTop != null) setScrollTop(cm, scrollPos.scrollTop);\n    if (scrollPos.scrollLeft != null) setScrollLeft(cm, scrollPos.scrollLeft);\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, x1, y1, x2, y2) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (y1 < 0) y1 = 0;\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (y2 - y1 > screen) y2 = y1 + screen;\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = y1 < snapMargin, atBottom = y2 > docBottom - snapMargin;\n    if (y1 < screentop) {\n      result.scrollTop = atTop ? 0 : y1;\n    } else if (y2 > screentop + screen) {\n      var newTop = Math.min(y1, (atBottom ? docBottom : y2) - screen);\n      if (newTop != screentop) result.scrollTop = newTop;\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = x2 - x1 > screenw;\n    if (tooWide) x2 = x1 + screenw;\n    if (x1 < 10)\n      result.scrollLeft = 0;\n    else if (x1 < screenleft)\n      result.scrollLeft = Math.max(0, x1 - (tooWide ? 0 : 10));\n    else if (x2 > screenw + screenleft - 3)\n      result.scrollLeft = x2 + (tooWide ? 0 : 10) - screenw;\n    return result;\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollPos(cm, left, top) {\n    if (left != null || top != null) resolveScrollToPos(cm);\n    if (left != null)\n      cm.curOp.scrollLeft = (cm.curOp.scrollLeft == null ? cm.doc.scrollLeft : cm.curOp.scrollLeft) + left;\n    if (top != null)\n      cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor(), from = cur, to = cur;\n    if (!cm.options.lineWrapping) {\n      from = cur.ch ? Pos(cur.line, cur.ch - 1) : cur;\n      to = Pos(cur.line, cur.ch + 1);\n    }\n    cm.curOp.scrollToPos = {from: from, to: to, margin: cm.options.cursorScrollMargin, isCursor: true};\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      var sPos = calculateScrollPos(cm, Math.min(from.left, to.left),\n                                    Math.min(from.top, to.top) - range.margin,\n                                    Math.max(from.right, to.right),\n                                    Math.max(from.bottom, to.bottom) + range.margin);\n      cm.scrollTo(sPos.scrollLeft, sPos.scrollTop);\n    }\n  }\n\n  // API UTILITIES\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) how = \"add\";\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) how = \"prev\";\n      else state = getStateBefore(cm, n);\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) line.stateAfter = null;\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) return;\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) indentation = countColumn(getLine(doc, n-1).text, null, tabSize);\n      else indentation = 0;\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";}\n    if (pos < indentation) indentString += spaceStr(indentation - pos);\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true;\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i = 0; i < doc.sel.ranges.length; i++) {\n        var range = doc.sel.ranges[i];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i, new Range(pos, pos));\n          break;\n        }\n      }\n    }\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") line = getLine(doc, clipLine(doc, handle));\n    else no = lineNo(handle);\n    if (no == null) return null;\n    if (op(line, no) && doc.cm) regLineChange(doc.cm, no, changeType);\n    return line;\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break;\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function() {\n      for (var i = kill.length - 1; i >= 0; i--)\n        replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\");\n      ensureCursorVisible(cm);\n    });\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var line = pos.line, ch = pos.ch, origDir = dir;\n    var lineObj = getLine(doc, line);\n    var possible = true;\n    function findNextLine() {\n      var l = line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) return (possible = false);\n      line = l;\n      return lineObj = getLine(doc, l);\n    }\n    function moveOnce(boundToLine) {\n      var next = (visually ? moveVisually : moveLogically)(lineObj, ch, dir, true);\n      if (next == null) {\n        if (!boundToLine && findNextLine()) {\n          if (visually) ch = (dir < 0 ? lineRight : lineLeft)(lineObj);\n          else ch = dir < 0 ? lineObj.text.length : 0;\n        } else return (possible = false);\n      } else ch = next;\n      return true;\n    }\n\n    if (unit == \"char\") moveOnce();\n    else if (unit == \"column\") moveOnce(true);\n    else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) break;\n        var cur = lineObj.text.charAt(ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) type = \"s\";\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce();}\n          break;\n        }\n\n        if (type) sawType = type;\n        if (dir > 0 && !moveOnce(!first)) break;\n      }\n    }\n    var result = skipAtomic(doc, Pos(line, ch), origDir, true);\n    if (!possible) result.hitSide = true;\n    return result;\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      y = pos.top + dir * (pageSize - (dir < 0 ? 1.5 : .5) * textHeight(cm.display));\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    for (;;) {\n      var target = coordsChar(cm, x, y);\n      if (!target.outside) break;\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break; }\n      y += dir * 5;\n    }\n    return target;\n  }\n\n  // EDITOR METHODS\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") return;\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        operation(this, optionHandlers[option])(this, value, old);\n    },\n\n    getOption: function(option) {return this.options[option];},\n    getDoc: function() {return this.doc;},\n\n    addKeyMap: function(map, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n    },\n    removeKeyMap: function(map) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        if (maps[i] == map || maps[i].name == map) {\n          maps.splice(i, 1);\n          return true;\n        }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) throw new Error(\"Overlays may not be stateful.\");\n      this.state.overlays.push({mode: mode, modeSpec: spec, opaque: options && options.opaque});\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this.state.modeGen++;\n          regChange(this);\n          return;\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) dir = this.options.smartIndent ? \"smart\" : \"prev\";\n        else dir = dir ? \"add\" : \"subtract\";\n      }\n      if (isLine(this.doc, n)) indentLine(this, n, dir, aggressive);\n    }),\n    indentSelection: methodOp(function(how) {\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (!range.empty()) {\n          var from = range.from(), to = range.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            indentLine(this, j, how);\n          var newRanges = this.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll);\n        } else if (range.head.line > end) {\n          indentLine(this, range.head.line, how, true);\n          end = range.head.line;\n          if (i == this.doc.sel.primIndex) ensureCursorVisible(this);\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise);\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true);\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) type = styles[2];\n      else for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) after = mid;\n        else if (styles[mid * 2 + 1] < ch) before = mid + 1;\n        else { type = styles[mid * 2 + 2]; break; }\n      }\n      var cut = type ? type.indexOf(\"cm-overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1);\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) return mode;\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0];\n    },\n\n    getHelpers: function(pos, type) {\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) return found;\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) found.push(help[mode[type]]);\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) found.push(val);\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i = 0; i < help._global.length; i++) {\n        var cur = help._global[i];\n        if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n          found.push(cur.val);\n      }\n      return found;\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise);\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range = this.doc.sel.primary();\n      if (start == null) pos = range.head;\n      else if (typeof start == \"object\") pos = clipPos(this.doc, start);\n      else pos = start ? range.from() : range.to();\n      return cursorCoords(this, pos, mode || \"page\");\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\");\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top);\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset);\n    },\n    heightAtLine: function(line, mode) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) line = this.doc.first;\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\").top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0);\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display); },\n    defaultCharWidth: function() { return charWidth(this.display); },\n\n    setGutterMarker: methodOp(function(line, gutterID, value) {\n      return changeLine(this.doc, line, \"gutter\", function(line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) line.gutterMarkers = null;\n        return true;\n      });\n    }),\n\n    clearGutter: methodOp(function(gutterID) {\n      var cm = this, doc = cm.doc, i = doc.first;\n      doc.iter(function(line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          line.gutterMarkers[gutterID] = null;\n          regLineChange(cm, i, \"gutter\");\n          if (isEmpty(line.gutterMarkers)) line.gutterMarkers = null;\n        }\n        ++i;\n      });\n    }),\n\n    lineInfo: function(line) {\n      if (typeof line == \"number\") {\n        if (!isLine(this.doc, line)) return null;\n        var n = line;\n        line = getLine(this.doc, line);\n        if (!line) return null;\n      } else {\n        var n = lineNo(line);\n        if (n == null) return null;\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets};\n    },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo};},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          top = pos.top - node.offsetHeight;\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          top = pos.bottom;\n        if (left + node.offsetWidth > hspace)\n          left = hspace - node.offsetWidth;\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") left = 0;\n        else if (horiz == \"middle\") left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        scrollIntoView(this, left, top, left + node.offsetWidth, top + node.offsetHeight);\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        return commands[cmd].call(null, this);\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        cur = findPosH(this.doc, cur, dir, unit, visually);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var cm = this;\n      cm.extendSelectionsBy(function(range) {\n        if (cm.display.shift || cm.doc.extend || range.empty())\n          return findPosH(cm.doc, range.head, dir, unit, cm.options.rtlMoveVisually);\n        else\n          return dir < 0 ? range.from() : range.to();\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        doc.replaceSelection(\"\", null, \"+delete\");\n      else\n        deleteNearSelection(this, function(range) {\n          var other = findPosH(doc, range.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other};\n        });\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        var coords = cursorCoords(this, cur, \"div\");\n        if (x == null) x = coords.left;\n        else coords.left = x;\n        cur = findPosV(this, coords, dir, unit);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var cm = this, doc = this.doc, goals = [];\n      var collapse = !cm.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function(range) {\n        if (collapse)\n          return dir < 0 ? range.from() : range.to();\n        var headPos = cursorCoords(cm, range.head, \"div\");\n        if (range.goalColumn != null) headPos.left = range.goalColumn;\n        goals.push(headPos.left);\n        var pos = findPosV(cm, headPos, dir, unit);\n        if (unit == \"page\" && range == doc.sel.primary())\n          addToScrollPos(cm, null, charCoords(cm, pos, \"div\").top - headPos.top);\n        return pos;\n      }, sel_move);\n      if (goals.length) for (var i = 0; i < doc.sel.ranges.length; i++)\n        doc.sel.ranges[i].goalColumn = goals[i];\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.xRel < 0 || end == line.length) && start) --start; else ++end;\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function(ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function(ch) {return /\\s/.test(ch);}\n          : function(ch) {return !/\\s/.test(ch) && !isWordChar(ch);};\n        while (start > 0 && check(line.charAt(start - 1))) --start;\n        while (end < line.length && check(line.charAt(end))) ++end;\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end));\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) return;\n      if (this.state.overwrite = !this.state.overwrite)\n        addClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n      else\n        rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt(); },\n\n    scrollTo: methodOp(function(x, y) {\n      if (x != null || y != null) resolveScrollToPos(this);\n      if (x != null) this.curOp.scrollLeft = x;\n      if (y != null) this.curOp.scrollTop = y;\n    }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)};\n    },\n\n    scrollIntoView: methodOp(function(range, margin) {\n      if (range == null) {\n        range = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) margin = this.options.cursorScrollMargin;\n      } else if (typeof range == \"number\") {\n        range = {from: Pos(range, 0), to: null};\n      } else if (range.from == null) {\n        range = {from: range, to: null};\n      }\n      if (!range.to) range.to = range.from;\n      range.margin = margin || 0;\n\n      if (range.from.line != null) {\n        resolveScrollToPos(this);\n        this.curOp.scrollToPos = range;\n      } else {\n        var sPos = calculateScrollPos(this, Math.min(range.from.left, range.to.left),\n                                      Math.min(range.from.top, range.to.top) - range.margin,\n                                      Math.max(range.from.right, range.to.right),\n                                      Math.max(range.from.bottom, range.to.bottom) + range.margin);\n        this.scrollTo(sPos.scrollLeft, sPos.scrollTop);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var cm = this;\n      function interpret(val) {\n        return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n      }\n      if (width != null) cm.display.wrapper.style.width = interpret(width);\n      if (height != null) cm.display.wrapper.style.height = interpret(height);\n      if (cm.options.lineWrapping) clearLineMeasurementCache(this);\n      var lineNo = cm.display.viewFrom;\n      cm.doc.iter(lineNo, cm.display.viewTo, function(line) {\n        if (line.widgets) for (var i = 0; i < line.widgets.length; i++)\n          if (line.widgets[i].noHScroll) { regLineChange(cm, lineNo, \"widget\"); break; }\n        ++lineNo;\n      });\n      cm.curOp.forceUpdate = true;\n      signal(cm, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f);},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      this.scrollTo(this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        estimateLineHeights(this);\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      this.scrollTo(doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old;\n    }),\n\n    getInputField: function(){return this.display.input.getField();},\n    getWrapperElement: function(){return this.display.wrapper;},\n    getScrollerElement: function(){return this.display.scroller;},\n    getGutterElement: function(){return this.display.gutters;}\n  };\n  eventMixin(CodeMirror);\n\n  // OPTION DEFAULTS\n\n  // The default configuration options.\n  var defaults = CodeMirror.defaults = {};\n  // Functions to run when options are changed.\n  var optionHandlers = CodeMirror.optionHandlers = {};\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) optionHandlers[name] =\n      notOnInit ? function(cm, val, old) {if (old != Init) handle(cm, val, old);} : handle;\n  }\n\n  // Passed to option handlers when there is no old value.\n  var Init = CodeMirror.Init = {toString: function(){return \"CodeMirror.Init\";}};\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function(cm, val) {\n    cm.setValue(val);\n  }, true);\n  option(\"mode\", null, function(cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function(cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n  option(\"lineSeparator\", null, function(cm, val) {\n    cm.doc.lineSep = val;\n    if (!val) return;\n    var newBreaks = [], lineNo = cm.doc.first;\n    cm.doc.iter(function(line) {\n      for (var pos = 0;;) {\n        var found = line.text.indexOf(val, pos);\n        if (found == -1) break;\n        pos = found + val.length;\n        newBreaks.push(Pos(lineNo, found));\n      }\n      lineNo++;\n    });\n    for (var i = newBreaks.length - 1; i >= 0; i--)\n      replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length))\n  });\n  option(\"specialChars\", /[\\t\\u0000-\\u0019\\u00ad\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function(cm, val, old) {\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    if (old != CodeMirror.Init) cm.refresh();\n  });\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function(cm) {cm.refresh();}, true);\n  option(\"electricChars\", true);\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function() {\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\"); // FIXME\n  }, true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function(cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", function(cm, val, old) {\n    var next = getKeyMap(val);\n    var prev = old != CodeMirror.Init && getKeyMap(old);\n    if (prev && prev.detach) prev.detach(cm, next);\n    if (next.attach) next.attach(cm, prev || null);\n  });\n  option(\"extraKeys\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function(cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, function(cm) {updateScrollbars(cm);}, true);\n  option(\"scrollbarStyle\", \"native\", function(cm) {\n    initScrollbars(cm);\n    updateScrollbars(cm);\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n  }, true);\n  option(\"lineNumbers\", false, function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function(integer) {return integer;}, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n  option(\"lineWiseCopyCut\", true);\n\n  option(\"readOnly\", false, function(cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n      cm.display.disabled = true;\n    } else {\n      cm.display.disabled = false;\n    }\n    cm.display.input.readOnlyChanged(val)\n  });\n  option(\"disableInput\", false, function(cm, val) {if (!val) cm.display.input.reset();}, true);\n  option(\"dragDrop\", true, dragDropChanged);\n  option(\"allowDropFileTypes\", null);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function(cm, val){cm.doc.history.undoDepth = val;});\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function(cm){cm.refresh();}, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function(cm, val) {\n    if (!val) cm.display.input.resetPosition();\n  });\n\n  option(\"tabindex\", null, function(cm, val) {\n    cm.display.input.getField().tabIndex = val || \"\";\n  });\n  option(\"autofocus\", null);\n\n  // MODE DEFINITION AND QUERYING\n\n  // Known modes, by name and by MIME\n  var modes = CodeMirror.modes = {}, mimeModes = CodeMirror.mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name, mode) {\n    if (!CodeMirror.defaults.mode && name != \"null\") CodeMirror.defaults.mode = name;\n    if (arguments.length > 2)\n      mode.dependencies = Array.prototype.slice.call(arguments, 2);\n    modes[name] = mode;\n  };\n\n  CodeMirror.defineMIME = function(mime, spec) {\n    mimeModes[mime] = spec;\n  };\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  CodeMirror.resolveMode = function(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") found = {name: found};\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return CodeMirror.resolveMode(\"application/xml\");\n    }\n    if (typeof spec == \"string\") return {name: spec};\n    else return spec || {name: \"null\"};\n  };\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  CodeMirror.getMode = function(options, spec) {\n    var spec = CodeMirror.resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) return CodeMirror.getMode(options, \"text/plain\");\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) continue;\n        if (modeObj.hasOwnProperty(prop)) modeObj[\"_\" + prop] = modeObj[prop];\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) modeObj.helperType = spec.helperType;\n    if (spec.modeProps) for (var prop in spec.modeProps)\n      modeObj[prop] = spec.modeProps[prop];\n\n    return modeObj;\n  };\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function() {\n    return {token: function(stream) {stream.skipToEnd();}};\n  });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = CodeMirror.modeExtensions = {};\n  CodeMirror.extendMode = function(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  };\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function(name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function(name, func) {\n    Doc.prototype[name] = func;\n  };\n  CodeMirror.defineOption = option;\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function(f) {initHooks.push(f);};\n\n  var helpers = CodeMirror.helpers = {};\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) helpers[type] = CodeMirror[type] = {_global: []};\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n\n  // MODE STATE HANDLING\n\n  // Utility functions for working with state. Exported because nested\n  // modes need to do this for their inner modes.\n\n  var copyState = CodeMirror.copyState = function(mode, state) {\n    if (state === true) return state;\n    if (mode.copyState) return mode.copyState(state);\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) val = val.concat([]);\n      nstate[n] = val;\n    }\n    return nstate;\n  };\n\n  var startState = CodeMirror.startState = function(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true;\n  };\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  CodeMirror.innerMode = function(mode, state) {\n    while (mode.innerMode) {\n      var info = mode.innerMode(state);\n      if (!info || info.mode == mode) break;\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state};\n  };\n\n  // STANDARD COMMANDS\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = CodeMirror.commands = {\n    selectAll: function(cm) {cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);},\n    singleSelection: function(cm) {\n      cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll);\n    },\n    killLine: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        if (range.empty()) {\n          var len = getLine(cm.doc, range.head.line).text.length;\n          if (range.head.ch == len && range.head.line < cm.lastLine())\n            return {from: range.head, to: Pos(range.head.line + 1, 0)};\n          else\n            return {from: range.head, to: Pos(range.head.line, len)};\n        } else {\n          return {from: range.from(), to: range.to()};\n        }\n      });\n    },\n    deleteLine: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        return {from: Pos(range.from().line, 0),\n                to: clipPos(cm.doc, Pos(range.to().line + 1, 0))};\n      });\n    },\n    delLineLeft: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        return {from: Pos(range.from().line, 0), to: range.from()};\n      });\n    },\n    delWrappedLineLeft: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n        return {from: leftPos, to: range.from()};\n      });\n    },\n    delWrappedLineRight: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n        return {from: range.from(), to: rightPos };\n      });\n    },\n    undo: function(cm) {cm.undo();},\n    redo: function(cm) {cm.redo();},\n    undoSelection: function(cm) {cm.undoSelection();},\n    redoSelection: function(cm) {cm.redoSelection();},\n    goDocStart: function(cm) {cm.extendSelection(Pos(cm.firstLine(), 0));},\n    goDocEnd: function(cm) {cm.extendSelection(Pos(cm.lastLine()));},\n    goLineStart: function(cm) {\n      cm.extendSelectionsBy(function(range) { return lineStart(cm, range.head.line); },\n                            {origin: \"+move\", bias: 1});\n    },\n    goLineStartSmart: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        return lineStartSmart(cm, range.head);\n      }, {origin: \"+move\", bias: 1});\n    },\n    goLineEnd: function(cm) {\n      cm.extendSelectionsBy(function(range) { return lineEnd(cm, range.head.line); },\n                            {origin: \"+move\", bias: -1});\n    },\n    goLineRight: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      }, sel_move);\n    },\n    goLineLeft: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({left: 0, top: top}, \"div\");\n      }, sel_move);\n    },\n    goLineLeftSmart: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n        if (pos.ch < cm.getLine(pos.line).search(/\\S/)) return lineStartSmart(cm, range.head);\n        return pos;\n      }, sel_move);\n    },\n    goLineUp: function(cm) {cm.moveV(-1, \"line\");},\n    goLineDown: function(cm) {cm.moveV(1, \"line\");},\n    goPageUp: function(cm) {cm.moveV(-1, \"page\");},\n    goPageDown: function(cm) {cm.moveV(1, \"page\");},\n    goCharLeft: function(cm) {cm.moveH(-1, \"char\");},\n    goCharRight: function(cm) {cm.moveH(1, \"char\");},\n    goColumnLeft: function(cm) {cm.moveH(-1, \"column\");},\n    goColumnRight: function(cm) {cm.moveH(1, \"column\");},\n    goWordLeft: function(cm) {cm.moveH(-1, \"word\");},\n    goGroupRight: function(cm) {cm.moveH(1, \"group\");},\n    goGroupLeft: function(cm) {cm.moveH(-1, \"group\");},\n    goWordRight: function(cm) {cm.moveH(1, \"word\");},\n    delCharBefore: function(cm) {cm.deleteH(-1, \"char\");},\n    delCharAfter: function(cm) {cm.deleteH(1, \"char\");},\n    delWordBefore: function(cm) {cm.deleteH(-1, \"word\");},\n    delWordAfter: function(cm) {cm.deleteH(1, \"word\");},\n    delGroupBefore: function(cm) {cm.deleteH(-1, \"group\");},\n    delGroupAfter: function(cm) {cm.deleteH(1, \"group\");},\n    indentAuto: function(cm) {cm.indentSelection(\"smart\");},\n    indentMore: function(cm) {cm.indentSelection(\"add\");},\n    indentLess: function(cm) {cm.indentSelection(\"subtract\");},\n    insertTab: function(cm) {cm.replaceSelection(\"\\t\");},\n    insertSoftTab: function(cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(new Array(tabSize - col % tabSize + 1).join(\" \"));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function(cm) {\n      if (cm.somethingSelected()) cm.indentSelection(\"add\");\n      else cm.execCommand(\"insertTab\");\n    },\n    transposeChars: function(cm) {\n      runInOp(cm, function() {\n        var ranges = cm.listSelections(), newSel = [];\n        for (var i = 0; i < ranges.length; i++) {\n          var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n          if (line) {\n            if (cur.ch == line.length) cur = new Pos(cur.line, cur.ch - 1);\n            if (cur.ch > 0) {\n              cur = new Pos(cur.line, cur.ch + 1);\n              cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                              Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n            } else if (cur.line > cm.doc.first) {\n              var prev = getLine(cm.doc, cur.line - 1).text;\n              if (prev)\n                cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                                prev.charAt(prev.length - 1),\n                                Pos(cur.line - 1, prev.length - 1), Pos(cur.line, 1), \"+transpose\");\n            }\n          }\n          newSel.push(new Range(cur, cur));\n        }\n        cm.setSelections(newSel);\n      });\n    },\n    newlineAndIndent: function(cm) {\n      runInOp(cm, function() {\n        var len = cm.listSelections().length;\n        for (var i = 0; i < len; i++) {\n          var range = cm.listSelections()[i];\n          cm.replaceRange(cm.doc.lineSeparator(), range.anchor, range.head, \"+input\");\n          cm.indentLine(range.from().line + 1, null, true);\n        }\n        ensureCursorVisible(cm);\n      });\n    },\n    toggleOverwrite: function(cm) {cm.toggleOverwrite();}\n  };\n\n\n  // STANDARD KEYMAPS\n\n  var keyMap = CodeMirror.keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    fallthrough: \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    fallthrough: [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/), name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) cmd = true;\n      else if (/^a(lt)?$/i.test(mod)) alt = true;\n      else if (/^(c|ctrl|control)$/i.test(mod)) ctrl = true;\n      else if (/^s(hift)$/i.test(mod)) shift = true;\n      else throw new Error(\"Unrecognized modifier name: \" + mod);\n    }\n    if (alt) name = \"Alt-\" + name;\n    if (ctrl) name = \"Ctrl-\" + name;\n    if (cmd) name = \"Cmd-\" + name;\n    if (shift) name = \"Shift-\" + name;\n    return name;\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  CodeMirror.normalizeKeyMap = function(keymap) {\n    var copy = {};\n    for (var keyname in keymap) if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) continue;\n      if (value == \"...\") { delete keymap[keyname]; continue; }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val, name;\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) copy[name] = val;\n        else if (prev != val) throw new Error(\"Inconsistent bindings for \" + name);\n      }\n      delete keymap[keyname];\n    }\n    for (var prop in copy) keymap[prop] = copy[prop];\n    return keymap;\n  };\n\n  var lookupKey = CodeMirror.lookupKey = function(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) return \"nothing\";\n    if (found === \"...\") return \"multi\";\n    if (found != null && handle(found)) return \"handled\";\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        return lookupKey(key, map.fallthrough, handle, context);\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) return result;\n      }\n    }\n  };\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  var isModifierKey = CodeMirror.isModifierKey = function(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\";\n  };\n\n  // Look up the name of a key as indicated by an event object.\n  var keyName = CodeMirror.keyName = function(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) return false;\n    var base = keyNames[event.keyCode], name = base;\n    if (name == null || event.altGraphKey) return false;\n    if (event.altKey && base != \"Alt\") name = \"Alt-\" + name;\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") name = \"Ctrl-\" + name;\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") name = \"Cmd-\" + name;\n    if (!noShift && event.shiftKey && base != \"Shift\") name = \"Shift-\" + name;\n    return name;\n  };\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val;\n  }\n\n  // FROMTEXTAREA\n\n  CodeMirror.fromTextArea = function(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      options.tabindex = textarea.tabIndex;\n    if (!options.placeholder && textarea.placeholder)\n      options.placeholder = textarea.placeholder;\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form, realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function() {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function(cm) {\n      cm.save = save;\n      cm.getTextArea = function() { return textarea; };\n      cm.toTextArea = function() {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (typeof textarea.form.submit == \"function\")\n            textarea.form.submit = realSubmit;\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function(node) {\n      textarea.parentNode.insertBefore(node, textarea.nextSibling);\n    }, options);\n    return cm;\n  };\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = CodeMirror.StringStream = function(string, tabSize) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n  };\n\n  StringStream.prototype = {\n    eol: function() {return this.pos >= this.string.length;},\n    sol: function() {return this.pos == this.lineStart;},\n    peek: function() {return this.string.charAt(this.pos) || undefined;},\n    next: function() {\n      if (this.pos < this.string.length)\n        return this.string.charAt(this.pos++);\n    },\n    eat: function(match) {\n      var ch = this.string.charAt(this.pos);\n      if (typeof match == \"string\") var ok = ch == match;\n      else var ok = ch && (match.test ? match.test(ch) : match(ch));\n      if (ok) {++this.pos; return ch;}\n    },\n    eatWhile: function(match) {\n      var start = this.pos;\n      while (this.eat(match)){}\n      return this.pos > start;\n    },\n    eatSpace: function() {\n      var start = this.pos;\n      while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) ++this.pos;\n      return this.pos > start;\n    },\n    skipToEnd: function() {this.pos = this.string.length;},\n    skipTo: function(ch) {\n      var found = this.string.indexOf(ch, this.pos);\n      if (found > -1) {this.pos = found; return true;}\n    },\n    backUp: function(n) {this.pos -= n;},\n    column: function() {\n      if (this.lastColumnPos < this.start) {\n        this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n        this.lastColumnPos = this.start;\n      }\n      return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    indentation: function() {\n      return countColumn(this.string, null, this.tabSize) -\n        (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    match: function(pattern, consume, caseInsensitive) {\n      if (typeof pattern == \"string\") {\n        var cased = function(str) {return caseInsensitive ? str.toLowerCase() : str;};\n        var substr = this.string.substr(this.pos, pattern.length);\n        if (cased(substr) == cased(pattern)) {\n          if (consume !== false) this.pos += pattern.length;\n          return true;\n        }\n      } else {\n        var match = this.string.slice(this.pos).match(pattern);\n        if (match && match.index > 0) return null;\n        if (match && consume !== false) this.pos += match[0].length;\n        return match;\n      }\n    },\n    current: function(){return this.string.slice(this.start, this.pos);},\n    hideFirstChars: function(n, inner) {\n      this.lineStart += n;\n      try { return inner(); }\n      finally { this.lineStart -= n; }\n    }\n  };\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  var nextMarkerId = 0;\n\n  var TextMarker = CodeMirror.TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n  eventMixin(TextMarker);\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) startOperation(cm);\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) signalLater(this, \"clear\", found.from, found.to);\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) regLineChange(cm, lineNo(line), \"text\");\n      else if (cm) {\n        if (span.to != null) max = lineNo(line);\n        if (span.from != null) min = lineNo(line);\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        updateLineHeight(line, textHeight(cm.display));\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) for (var i = 0; i < this.lines.length; ++i) {\n      var visual = visualLine(this.lines[i]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    }\n\n    if (min != null && cm && this.collapsed) regChange(cm, min, max + 1);\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) reCheckSelection(cm.doc);\n    }\n    if (cm) signalLater(cm, \"markerCleared\", cm, this);\n    if (withOp) endOperation(cm);\n    if (this.parent) this.parent.clear();\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function(side, lineObj) {\n    if (side == null && this.type == \"bookmark\") side = 1;\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) return from;\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) return to;\n      }\n    }\n    return from && {from: from, to: to};\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function() {\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) return;\n    runInOp(cm, function() {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          updateLineHeight(line, line.height + dHeight);\n      }\n    });\n  };\n\n  TextMarker.prototype.attachLine = function(line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this);\n    }\n    this.lines.push(line);\n  };\n  TextMarker.prototype.detachLine = function(line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      (op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) return markTextShared(doc, from, to, options, type);\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) return operation(doc.cm, markText)(doc, from, to, options, type);\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) copyObj(options, marker, false);\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      return marker;\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = elt(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\");\n      if (options.insertLeft) marker.widgetNode.insertLeft = true;\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        throw new Error(\"Inserting collapsed marker partially overlapping an existing one\");\n      sawCollapsedSpans = true;\n    }\n\n    if (marker.addToHistory)\n      addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN);\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function(line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        updateMaxLine = true;\n      if (marker.collapsed && curLine != from.line) updateLineHeight(line, 0);\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) doc.iter(from.line, to.line + 1, function(line) {\n      if (lineIsHidden(doc, line)) updateLineHeight(line, 0);\n    });\n\n    if (marker.clearOnEnter) on(marker, \"beforeCursorEnter\", function() { marker.clear(); });\n\n    if (marker.readOnly) {\n      sawReadOnlySpans = true;\n      if (doc.history.done.length || doc.history.undone.length)\n        doc.clearHistory();\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) cm.curOp.updateMaxLine = true;\n      if (marker.collapsed)\n        regChange(cm, from.line, to.line + 1);\n      else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\n        for (var i = from.line; i <= to.line; i++) regLineChange(cm, i, \"text\");\n      if (marker.atomic) reCheckSelection(cm.doc);\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker;\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = CodeMirror.SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      markers[i].parent = this;\n  };\n  eventMixin(SharedTextMarker);\n\n  SharedTextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      this.markers[i].clear();\n    signalLater(this, \"clear\");\n  };\n  SharedTextMarker.prototype.find = function(side, lineObj) {\n    return this.primary.find(side, lineObj);\n  };\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function(doc) {\n      if (widget) options.widgetNode = widget.cloneNode(true);\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        if (doc.linked[i].isParent) return;\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary);\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())),\n                         function(m) { return m.parent; });\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], linked = [marker.primary.doc];;\n      linkedDocs(marker.primary.doc, function(d) { linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    }\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) return span;\n    }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    for (var r, i = 0; i < spans.length; ++i)\n      if (spans[i] != span) (r || (r = [])).push(spans[i]);\n    return r;\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);\n        (nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    }\n    return nw;\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);\n        (nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    }\n    return nw;\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) return null;\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) return null;\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) span.to = startCh;\n          else if (sameLine) span.to = found.to == null ? null : found.to + offset;\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i = 0; i < last.length; ++i) {\n        var span = last[i];\n        if (span.to != null) span.to += offset;\n        if (span.from == null) {\n          var found = getMarkedSpanFor(first, span.marker);\n          if (!found) {\n            span.from = offset;\n            if (sameLine) (first || (first = [])).push(span);\n          }\n        } else {\n          span.from += offset;\n          if (sameLine) (first || (first = [])).push(span);\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) first = clearEmptySpans(first);\n    if (last && last != first) last = clearEmptySpans(last);\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        for (var i = 0; i < first.length; ++i)\n          if (first[i].to == null)\n            (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i].marker, null, null));\n      for (var i = 0; i < gap; ++i)\n        newMarkers.push(gapMarkers);\n      newMarkers.push(last);\n    }\n    return newMarkers;\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        spans.splice(i--, 1);\n    }\n    if (!spans.length) return null;\n    return spans;\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) return stretched;\n    if (!stretched) return old;\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            if (oldCur[k].marker == span.marker) continue spans;\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old;\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function(line) {\n      if (line.markedSpans) for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          (markers || (markers = [])).push(mark);\n      }\n    });\n    if (!markers) return null;\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) continue;\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          newParts.push({from: p.from, to: m.from});\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          newParts.push({from: m.to, to: p.to});\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 1;\n      }\n    }\n    return parts;\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.detachLine(line);\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.attachLine(line);\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0; }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0; }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) return lenDiff;\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) return -fromCmp;\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) return toCmp;\n    return b.id - a.id;\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        found = sp.marker;\n    }\n    return found;\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true); }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false); }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) continue;\n      if (fromCmp <= 0 && (cmp(found.to, from) > 0 || (sp.marker.inclusiveRight && marker.inclusiveLeft)) ||\n          fromCmp >= 0 && (cmp(found.from, to) < 0 || (sp.marker.inclusiveLeft && marker.inclusiveRight)))\n        return true;\n    }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      line = merged.find(-1, true).line;\n    return line;\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n      (lines || (lines = [])).push(line);\n    }\n    return lines;\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) return lineN;\n    return lineNo(vis);\n  }\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) return lineN;\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) return lineN;\n    while (merged = collapsedSpanAtEnd(line))\n      line = merged.find(1, true).line;\n    return lineNo(line) + 1;\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      if (sp.from == null) return true;\n      if (sp.marker.widgetNode) continue;\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        return true;\n    }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker));\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      return true;\n    for (var sp, i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) return true;\n    }\n  }\n\n  // LINE WIDGETS\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = CodeMirror.LineWidget = function(doc, node, options) {\n    if (options) for (var opt in options) if (options.hasOwnProperty(opt))\n      this[opt] = options[opt];\n    this.doc = doc;\n    this.node = node;\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      addToScrollPos(cm, null, diff);\n  }\n\n  LineWidget.prototype.clear = function() {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) return;\n    for (var i = 0; i < ws.length; ++i) if (ws[i] == this) ws.splice(i--, 1);\n    if (!ws.length) line.widgets = null;\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) runInOp(cm, function() {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n    });\n  };\n  LineWidget.prototype.changed = function() {\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) return;\n    updateLineHeight(line, line.height + diff);\n    if (cm) runInOp(cm, function() {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n    });\n  };\n\n  function widgetHeight(widget) {\n    if (widget.height != null) return widget.height;\n    var cm = widget.doc.cm;\n    if (!cm) return 0;\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\";\n      if (widget.noHScroll)\n        parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\";\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.offsetHeight;\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) cm.display.alignWidgets = true;\n    changeLine(doc, handle, \"widget\", function(line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) widgets.push(widget);\n      else widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget);\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) addToScrollPos(cm, null, widget.height);\n        cm.curOp.forceUpdate = true;\n      }\n      return true;\n    });\n    return widget;\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = CodeMirror.Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n  eventMixin(Line);\n  Line.prototype.lineNo = function() { return lineNo(this); };\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) line.stateAfter = null;\n    if (line.styles) line.styles = null;\n    if (line.order != null) line.order = null;\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) updateLineHeight(line, estHeight);\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) break;\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        output[prop] = lineClass[2];\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        output[prop] += \" \" + lineClass[2];\n    }\n    return type;\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) return mode.blankLine(state);\n    if (!mode.innerMode) return;\n    var inner = CodeMirror.innerMode(mode, state);\n    if (inner.mode.blankLine) return inner.mode.blankLine(inner.state);\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) inner[0] = CodeMirror.innerMode(mode, state).mode;\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) return style;\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\");\n  }\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    function getObj(copy) {\n      return {start: stream.start, end: stream.pos,\n              string: stream.current(),\n              type: style || null,\n              state: copy ? copyState(doc.mode, state) : state};\n    }\n\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), state = getStateBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize), tokens;\n    if (asArray) tokens = [];\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, state);\n      if (asArray) tokens.push(getObj(true));\n    }\n    return asArray ? tokens : getObj();\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, state, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) flattenSpans = cm.options.flattenSpans;\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") extractLineClasses(callBlankLine(mode, state), lineClasses);\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) processLine(cm, text, state, stream.pos);\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) style = \"m-\" + (style ? mName + \" \" + style : mName);\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 50000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444 characters\n      var pos = Math.min(stream.pos, curStart + 50000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, state, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, state, function(end, style) {\n      st.push(end, style);\n    }, lineClasses, forceToEnd);\n\n    // Run overlays, adjust style array.\n    for (var o = 0; o < cm.state.overlays.length; ++o) {\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      runMode(cm, line.text, overlay.mode, true, function(end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            st.splice(i, 1, end, st[i+1], i_end);\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) return;\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"cm-overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"cm-overlay \" + style;\n          }\n        }\n      }, lineClasses);\n    }\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null};\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var state = getStateBefore(cm, lineNo(line));\n      var result = highlightLine(cm, line, line.text.length > cm.options.maxHighlightLength ? copyState(cm.doc.mode, state) : state);\n      line.stateAfter = state;\n      line.styles = result.styles;\n      if (result.classes) line.styleClasses = result.classes;\n      else if (line.styleClasses) line.styleClasses = null;\n      if (updateFrontier === cm.doc.frontier) cm.doc.frontier++;\n    }\n    return line.styles;\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, state, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") callBlankLine(mode, state);\n    while (!stream.eol()) {\n      readToken(mode, stream, state);\n      stream.start = stream.pos;\n    }\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) return null;\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"));\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = elt(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: elt(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order;\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line)))\n        builder.addToken = buildTokenBadBidi(builder.addToken, order);\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\");\n        if (line.styleClasses.textClass)\n          builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\");\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure)));\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n        (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map);\n        (lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit && /\\bcm-tab\\b/.test(builder.content.lastChild.className))\n      builder.content.className = \"cm-tab-wrap-hack\";\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\");\n\n    return builder;\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token;\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, title, css) {\n    if (!text) return;\n    var displayText = builder.splitSpaces ? text.replace(/ {3,}/g, splitSpaces) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      var content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) mustWrap = true;\n      builder.pos += text.length;\n    } else {\n      var content = document.createDocumentFragment(), pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) content.appendChild(elt(\"span\", [txt]));\n          else content.appendChild(txt);\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) break;\n        pos += skipped + 1;\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          var txt = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt.setAttribute(\"role\", \"presentation\");\n          txt.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          var txt = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          var txt = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) content.appendChild(elt(\"span\", [txt]));\n          else content.appendChild(txt);\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt);\n        builder.pos++;\n      }\n    }\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) fullStyle += startStyle;\n      if (endStyle) fullStyle += endStyle;\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (title) token.title = title;\n      return builder.content.appendChild(token);\n    }\n    builder.content.appendChild(content);\n  }\n\n  function splitSpaces(old) {\n    var out = \" \";\n    for (var i = 0; i < old.length - 2; ++i) out += i % 2 ? \" \" : \"\\u00a0\";\n    out += \" \";\n    return out;\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function(builder, text, style, startStyle, endStyle, title, css) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        for (var i = 0; i < order.length; i++) {\n          var part = order[i];\n          if (part.to > start && part.from <= start) break;\n        }\n        if (part.to >= end) return inner(builder, text, style, startStyle, endStyle, title, css);\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    };\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) builder.map.push(builder.pos, builder.pos + size, widget);\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        widget = builder.content.appendChild(document.createElement(\"span\"));\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i = 1; i < styles.length; i+=2)\n        builder.addToken(builder, allText.slice(at, at = styles[i]), interpretTokenStyle(styles[i+1], builder.cm.options));\n      return;\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = title = css = \"\";\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [];\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) spanStyle += \" \" + m.className;\n            if (m.css) css = m.css;\n            if (m.startStyle && sp.from == pos) spanStartStyle += \" \" + m.startStyle;\n            if (m.endStyle && sp.to == nextChange) spanEndStyle += \" \" + m.endStyle;\n            if (m.title && !title) title = m.title;\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              collapsed = sp;\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) return;\n          if (collapsed.to == pos) collapsed = false;\n        }\n        if (!collapsed && foundBookmarks.length) for (var j = 0; j < foundBookmarks.length; ++j)\n          buildCollapsedSpan(builder, 0, foundBookmarks[j]);\n      }\n      if (pos >= len) break;\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break;}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore);\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null;}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      for (var i = start, result = []; i < end; ++i)\n        result.push(new Line(text[i], spansFor(i), estimateHeight));\n      return result;\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) doc.remove(from.line, nlines);\n      if (added.length) doc.insert(from.line, added);\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added = linesFor(1, text.length - 1);\n        added.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added = linesFor(1, text.length - 1);\n      if (nlines > 1) doc.remove(from.line + 1, nlines - 1);\n      doc.insert(from.line + 1, added);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    for (var i = 0, height = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length; },\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) lines[i].parent = this;\n    },\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        if (op(this.lines[at])) return true;\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size; },\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) this.children[i].collapse(lines);\n    },\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            while (child.lines.length > 50) {\n              var spilled = child.lines.splice(child.lines.length - 25, 25);\n              var newleaf = new LeafChunk(spilled);\n              child.height -= newleaf.height;\n              this.children.splice(i + 1, 0, newleaf);\n              newleaf.parent = this;\n            }\n            this.maybeSpill();\n          }\n          break;\n        }\n        at -= sz;\n      }\n    },\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) return;\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n        } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10);\n      me.parent.maybeSpill();\n    },\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) return true;\n          if ((n -= used) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n    }\n  };\n\n  var nextDocId = 0;\n  var Doc = CodeMirror.Doc = function(text, mode, firstLine, lineSep) {\n    if (!(this instanceof Doc)) return new Doc(text, mode, firstLine, lineSep);\n    if (firstLine == null) firstLine = 0;\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.frontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n\n    if (typeof text == \"string\") text = this.splitLines(text);\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) this.iterN(from - this.first, to - from, op);\n      else this.iterN(this.first, this.first + this.size, from);\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) height += lines[i].height;\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || this.lineSeparator());\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      setSelection(this, simpleSelection(top));\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || this.lineSeparator());\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text;},\n\n    getLineHandle: function(line) {if (isLine(this, line)) return getLine(this, line);},\n    getLineNumber: function(line) {return lineNo(line);},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") line = getLine(this, line);\n      return visualLine(line);\n    },\n\n    lineCount: function() {return this.size;},\n    firstLine: function() {return this.first;},\n    lastLine: function() {return this.first + this.size - 1;},\n\n    clipPos: function(pos) {return clipPos(this, pos);},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") pos = range.head;\n      else if (start == \"anchor\") pos = range.anchor;\n      else if (start == \"end\" || start == \"to\" || start === false) pos = range.to();\n      else pos = range.from();\n      return pos;\n    },\n    listSelections: function() { return this.sel.ranges; },\n    somethingSelected: function() {return this.sel.somethingSelected();},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads, options));\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      extendSelections(this, map(this.sel.ranges, f), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) return;\n      for (var i = 0, out = []; i < ranges.length; i++)\n        out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head));\n      if (primary == null) primary = Math.min(ranges.length - 1, this.sel.primIndex);\n      setSelection(this, normalizeSelection(out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) return lines;\n      else return lines.join(lineSep || this.lineSeparator());\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) sel = sel.join(lineSep || this.lineSeparator());\n        parts[i] = sel;\n      }\n      return parts;\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        dup[i] = code;\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i = changes.length - 1; i >= 0; i--)\n        makeChange(this, changes[i]);\n      if (newSel) setSelectionReplaceHistory(this, newSel);\n      else if (this.cm) ensureCursorVisible(this.cm);\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend;},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) if (!hist.done[i].ranges) ++done;\n      for (var i = 0; i < hist.undone.length; i++) if (!hist.undone[i].ranges) ++undone;\n      return {undo: done, redo: undone};\n    },\n    clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null;\n      return this.history.generation;\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration);\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)};\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function(line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) line[prop] = cls;\n        else if (classTest(cls).test(line[prop])) return false;\n        else line[prop] += \" \" + cls;\n        return true;\n      });\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function(line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) return false;\n        else if (cls == null) line[prop] = null;\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) return false;\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true;\n      });\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options);\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\");\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\");\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          markers.push(span.marker.parent || span.marker);\n      }\n      return markers;\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function(line) {\n        var spans = line.markedSpans;\n        if (spans) for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(lineNo == from.line && from.ch > span.to ||\n                span.from == null && lineNo != from.line||\n                lineNo == to.line && span.from > to.ch) &&\n              (!filter || filter(span.marker)))\n            found.push(span.marker.parent || span.marker);\n        }\n        ++lineNo;\n      });\n      return found;\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function(line) {\n        var sps = line.markedSpans;\n        if (sps) for (var i = 0; i < sps.length; ++i)\n          if (sps[i].from != null) markers.push(sps[i].marker);\n      });\n      return markers;\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first;\n      this.iter(function(line) {\n        var sz = line.text.length + 1;\n        if (sz > off) { ch = off; return true; }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch));\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) return 0;\n      this.iter(this.first, coords.line, function (line) {\n        index += line.text.length + 1;\n      });\n      return index;\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc;\n    },\n\n    linkedDoc: function(options) {\n      if (!options) options = {};\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) from = options.from;\n      if (options.to != null && options.to < to) to = options.to;\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep);\n      if (options.sharedHist) copy.history = this.history;\n      (this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy;\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) other = other.doc;\n      if (this.linked) for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) continue;\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break;\n      }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function(doc) {splitIds.push(doc.id);}, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode;},\n    getEditor: function() {return this.cm;},\n\n    splitLines: function(str) {\n      if (this.lineSep) return str.split(this.lineSep);\n      return splitLinesAuto(str);\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\"; }\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments);};\n    })(Doc.prototype[prop]);\n\n  eventMixin(Doc);\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) continue;\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) continue;\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) throw new Error(\"This document is already in use.\");\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    if (!cm.options.lineWrapping) findMaxLine(cm);\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  // LINE UTILITIES\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\");\n    for (var chunk = doc; !chunk.lines;) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break; }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n];\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function(line) {\n      var text = line.text;\n      if (n == end.line) text = text.slice(0, end.ch);\n      if (n == start.line) text = text.slice(start.ch);\n      out.push(text);\n      ++n;\n    });\n    return out;\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function(line) { out.push(line.text); });\n    return out;\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) for (var n = line; n; n = n.parent) n.height += diff;\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) return null;\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) break;\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first;\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i = 0; i < chunk.children.length; ++i) {\n        var child = chunk.children[i], ch = child.height;\n        if (h < ch) { chunk = child; continue outer; }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n;\n    } while (!chunk.lines);\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) break;\n      h -= lh;\n    }\n    return n + i;\n  }\n\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) break;\n      else h += line.height;\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i = 0; i < p.children.length; ++i) {\n        var cur = p.children[i];\n        if (cur == chunk) break;\n        else h += cur.height;\n      }\n    }\n    return h;\n  }\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line) {\n    var order = line.order;\n    if (order == null) order = line.order = bidiOrdering(line.text);\n    return order;\n  }\n\n  // HISTORY\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function(doc) {attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);}, true);\n    return histChange;\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) array.pop();\n      else break;\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done);\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done);\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done);\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, ore are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      var last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        pushSelectionToHistory(doc.sel, hist.done);\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) hist.done.shift();\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) signal(doc, \"historyAdded\");\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500);\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      hist.done[hist.done.length - 1] = sel;\n    else\n      pushSelectionToHistory(sel, hist.done);\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      clearSelectionEvents(hist.undone);\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      dest.push(sel);\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function(line) {\n      if (line.markedSpans)\n        (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans;\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) return null;\n    for (var i = 0, out; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) out = spans.slice(0, i); }\n      else if (out) out.push(spans[i]);\n    }\n    return !out ? spans : out.length ? out : null;\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) return null;\n    for (var i = 0, nw = []; i < change.text.length; ++i)\n      nw.push(removeClearedSpans(found[i]));\n    return nw;\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    for (var i = 0, copy = []; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue;\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m;\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) for (var prop in change) if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        }\n      }\n    }\n    return copy;\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue;\n      }\n      for (var j = 0; j < sub.changes.length; ++j) {\n        var cur = sub.changes[j];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break;\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // EVENT UTILITIES\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  var e_preventDefault = CodeMirror.e_preventDefault = function(e) {\n    if (e.preventDefault) e.preventDefault();\n    else e.returnValue = false;\n  };\n  var e_stopPropagation = CodeMirror.e_stopPropagation = function(e) {\n    if (e.stopPropagation) e.stopPropagation();\n    else e.cancelBubble = true;\n  };\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n  }\n  var e_stop = CodeMirror.e_stop = function(e) {e_preventDefault(e); e_stopPropagation(e);};\n\n  function e_target(e) {return e.target || e.srcElement;}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) b = 1;\n      else if (e.button & 2) b = 3;\n      else if (e.button & 4) b = 2;\n    }\n    if (mac && e.ctrlKey && b == 1) b = 3;\n    return b;\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var on = CodeMirror.on = function(emitter, type, f) {\n    if (emitter.addEventListener)\n      emitter.addEventListener(type, f, false);\n    else if (emitter.attachEvent)\n      emitter.attachEvent(\"on\" + type, f);\n    else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      var arr = map[type] || (map[type] = []);\n      arr.push(f);\n    }\n  };\n\n  var noHandlers = []\n  function getHandlers(emitter, type, copy) {\n    var arr = emitter._handlers && emitter._handlers[type]\n    if (copy) return arr && arr.length > 0 ? arr.slice() : noHandlers\n    else return arr || noHandlers\n  }\n\n  var off = CodeMirror.off = function(emitter, type, f) {\n    if (emitter.removeEventListener)\n      emitter.removeEventListener(type, f, false);\n    else if (emitter.detachEvent)\n      emitter.detachEvent(\"on\" + type, f);\n    else {\n      var handlers = getHandlers(emitter, type, false)\n      for (var i = 0; i < handlers.length; ++i)\n        if (handlers[i] == f) { handlers.splice(i, 1); break; }\n    }\n  };\n\n  var signal = CodeMirror.signal = function(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type, true)\n    if (!handlers.length) return;\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) handlers[i].apply(null, args);\n  };\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type, false)\n    if (!arr.length) return;\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    function bnd(f) {return function(){f.apply(null, args);};};\n    for (var i = 0; i < arr.length; ++i)\n      list.push(bnd(arr[i]));\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) delayed[i]();\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      e = {type: e, preventDefault: function() { this.defaultPrevented = true; }};\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore;\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) return;\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) if (indexOf(set, arr[i]) == -1)\n      set.push(arr[i]);\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // MISC UTILITIES\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = CodeMirror.Pass = {toString: function(){return \"CodeMirror.Pass\";}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  function Delayed() {this.id = null;}\n  Delayed.prototype.set = function(ms, f) {\n    clearTimeout(this.id);\n    this.id = setTimeout(f, ms);\n  };\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  var countColumn = CodeMirror.countColumn = function(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) end = string.length;\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        return n + (end - i);\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  };\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  var findColumn = CodeMirror.findColumn = function(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) nextTab = string.length;\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        return pos + Math.min(skipped, goal - col);\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) return pos;\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      spaceStrs.push(lst(spaceStrs) + \" \");\n    return spaceStrs[n];\n  }\n\n  function lst(arr) { return arr[arr.length-1]; }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; };\n  else if (ie) // Suppress mysterious IE10 errors\n    selectInput = function(node) { try { node.select(); } catch(_e) {} };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      if (array[i] == elt) return i;\n    return -1;\n  }\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) out[i] = f(array[i], i);\n    return out;\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) copyObj(props, inst);\n    return inst;\n  };\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) target = {};\n    for (var prop in obj)\n      if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        target[prop] = obj[prop];\n    return target;\n  }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args);};\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  var isWordCharBasic = CodeMirror.isWordChar = function(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch));\n  };\n  function isWordChar(ch, helper) {\n    if (!helper) return isWordCharBasic(ch);\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) return true;\n    return helper.test(ch);\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) if (obj.hasOwnProperty(n) && obj[n]) return false;\n    return true;\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch); }\n\n  // DOM UTILITIES\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) e.className = className;\n    if (style) e.style.cssText = style;\n    if (typeof content == \"string\") e.appendChild(document.createTextNode(content));\n    else if (content) for (var i = 0; i < content.length; ++i) e.appendChild(content[i]);\n    return e;\n  }\n\n  var range;\n  if (document.createRange) range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r;\n  };\n  else range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r; }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r;\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      e.removeChild(e.firstChild);\n    return e;\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e);\n  }\n\n  var contains = CodeMirror.contains = function(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      child = child.parentNode;\n    if (parent.contains)\n      return parent.contains(child);\n    do {\n      if (child.nodeType == 11) child = child.host;\n      if (child == parent) return true;\n    } while (child = child.parentNode);\n  };\n\n  function activeElt() {\n    var activeElement = document.activeElement;\n    while (activeElement && activeElement.root && activeElement.root.activeElement)\n      activeElement = activeElement.root.activeElement;\n    return activeElement;\n  }\n  // Older versions of IE throws unspecified error when touching\n  // document.activeElement in some cases (during loading, in iframe)\n  if (ie && ie_version < 11) activeElt = function() {\n    try { return document.activeElement; }\n    catch(e) { return document.body; }\n  };\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\"); }\n  var rmClass = CodeMirror.rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n  var addClass = CodeMirror.addClass = function(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) node.className += (current ? \" \" : \"\") + cls;\n  };\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      if (as[i] && !classTest(as[i]).test(b)) b += \" \" + as[i];\n    return b;\n  }\n\n  // WINDOW-WIDE EVENTS\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.body.getElementsByClassName) return;\n    var byClass = document.body.getElementsByClassName(\"CodeMirror\");\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) f(cm);\n    }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) return;\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function() {\n      if (resizeTimer == null) resizeTimer = setTimeout(function() {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100);\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function() {\n      forEachCodeMirror(onBlur);\n    });\n  }\n\n  // FEATURE DETECTION\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) return false;\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div;\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8);\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node;\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) return badBidiRects;\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    if (!r0 || r0.left == r0.right) return false; // Safari returns null in some cases (#2780)\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    return badBidiRects = (r1.right - r0.right < 3);\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = CodeMirror.splitLines = \"\\n\\nb\".split(/\\n/).length != 3 ? function(string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) nl = string.length;\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result;\n  } : function(string){return string.split(/\\r\\n?|\\n/);};\n\n  var hasSelection = window.getSelection ? function(te) {\n    try { return te.selectionStart != te.selectionEnd; }\n    catch(e) { return false; }\n  } : function(te) {\n    try {var range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) return false;\n    return range.compareEndPoints(\"StartToEnd\", range) != 0;\n  };\n\n  var hasCopyEvent = (function() {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) return true;\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\";\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) return badZoomedRects;\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1;\n  }\n\n  // KEY NAMES\n\n  var keyNames = CodeMirror.keyNames = {\n    3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n  (function() {\n    // Number keys\n    for (var i = 0; i < 10; i++) keyNames[i + 48] = keyNames[i + 96] = String(i);\n    // Alphabetic keys\n    for (var i = 65; i <= 90; i++) keyNames[i] = String.fromCharCode(i);\n    // Function keys\n    for (var i = 1; i <= 12; i++) keyNames[i + 111] = keyNames[i + 63235] = \"F\" + i;\n  })();\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) return f(from, to, \"ltr\");\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n        found = true;\n      }\n    }\n    if (!found) f(from, to, \"ltr\");\n  }\n\n  function bidiLeft(part) { return part.level % 2 ? part.to : part.from; }\n  function bidiRight(part) { return part.level % 2 ? part.from : part.to; }\n\n  function lineLeft(line) { var order = getOrder(line); return order ? bidiLeft(order[0]) : 0; }\n  function lineRight(line) {\n    var order = getOrder(line);\n    if (!order) return line.text.length;\n    return bidiRight(lst(order));\n  }\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) lineN = lineNo(visual);\n    var order = getOrder(visual);\n    var ch = !order ? 0 : order[0].level % 2 ? lineRight(visual) : lineLeft(visual);\n    return Pos(lineN, ch);\n  }\n  function lineEnd(cm, lineN) {\n    var merged, line = getLine(cm.doc, lineN);\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n      lineN = null;\n    }\n    var order = getOrder(line);\n    var ch = !order ? line.text.length : order[0].level % 2 ? lineLeft(line) : lineRight(line);\n    return Pos(lineN == null ? lineNo(line) : lineN, ch);\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(0, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS);\n    }\n    return start;\n  }\n\n  function compareBidiLevel(order, a, b) {\n    var linedir = order[0].level;\n    if (a == linedir) return true;\n    if (b == linedir) return false;\n    return a < b;\n  }\n  var bidiOther;\n  function getBidiPartAt(order, pos) {\n    bidiOther = null;\n    for (var i = 0, found; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < pos && cur.to > pos) return i;\n      if ((cur.from == pos || cur.to == pos)) {\n        if (found == null) {\n          found = i;\n        } else if (compareBidiLevel(order, cur.level, order[found].level)) {\n          if (cur.from != cur.to) bidiOther = found;\n          return i;\n        } else {\n          if (cur.from != cur.to) bidiOther = i;\n          return found;\n        }\n      }\n    }\n    return found;\n  }\n\n  function moveInLine(line, pos, dir, byUnit) {\n    if (!byUnit) return pos + dir;\n    do pos += dir;\n    while (pos > 0 && isExtendingChar(line.text.charAt(pos)));\n    return pos;\n  }\n\n  // This is needed in order to move 'visually' through bi-directional\n  // text -- i.e., pressing left should make the cursor go left, even\n  // when in RTL text. The tricky part is the 'jumps', where RTL and\n  // LTR text touch each other. This often requires the cursor offset\n  // to move more than one unit, in order to visually move one unit.\n  function moveVisually(line, start, dir, byUnit) {\n    var bidi = getOrder(line);\n    if (!bidi) return moveLogically(line, start, dir, byUnit);\n    var pos = getBidiPartAt(bidi, start), part = bidi[pos];\n    var target = moveInLine(line, start, part.level % 2 ? -dir : dir, byUnit);\n\n    for (;;) {\n      if (target > part.from && target < part.to) return target;\n      if (target == part.from || target == part.to) {\n        if (getBidiPartAt(bidi, target) == pos) return target;\n        part = bidi[pos += dir];\n        return (dir > 0) == part.level % 2 ? part.to : part.from;\n      } else {\n        part = bidi[pos += dir];\n        if (!part) return null;\n        if ((dir > 0) == part.level % 2)\n          target = moveInLine(line, part.to, -1, byUnit);\n        else\n          target = moveInLine(line, part.from, 1, byUnit);\n      }\n    }\n  }\n\n  function moveLogically(line, start, dir, byUnit) {\n    var target = start + dir;\n    if (byUnit) while (target > 0 && isExtendingChar(line.text.charAt(target))) target += dir;\n    return target < 0 || target > line.text.length ? null : target;\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6ff\n    var arabicTypes = \"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm\";\n    function charType(code) {\n      if (code <= 0xf7) return lowTypes.charAt(code);\n      else if (0x590 <= code && code <= 0x5f4) return \"R\";\n      else if (0x600 <= code && code <= 0x6ed) return arabicTypes.charAt(code - 0x600);\n      else if (0x6ee <= code && code <= 0x8ac) return \"r\";\n      else if (0x2000 <= code && code <= 0x200b) return \"w\";\n      else if (code == 0x200c) return \"b\";\n      else return \"L\";\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n    // Browsers seem to always treat the boundaries of block elements as being L.\n    var outerType = \"L\";\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str) {\n      if (!bidiRE.test(str)) return false;\n      var len = str.length, types = [];\n      for (var i = 0, type; i < len; ++i)\n        types.push(type = charType(str.charCodeAt(i)));\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i = 0, prev = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"m\") types[i] = prev;\n        else prev = type;\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"1\" && cur == \"r\") types[i] = \"n\";\n        else if (isStrong.test(type)) { cur = type; if (type == \"r\") types[i] = \"R\"; }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i = 1, prev = types[0]; i < len - 1; ++i) {\n        var type = types[i];\n        if (type == \"+\" && prev == \"1\" && types[i+1] == \"1\") types[i] = \"1\";\n        else if (type == \",\" && prev == types[i+1] &&\n                 (prev == \"1\" || prev == \"n\")) types[i] = prev;\n        prev = type;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i = 0; i < len; ++i) {\n        var type = types[i];\n        if (type == \",\") types[i] = \"N\";\n        else if (type == \"%\") {\n          for (var end = i + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i && types[i-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (cur == \"L\" && type == \"1\") types[i] = \"L\";\n        else if (isStrong.test(type)) cur = type;\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i = 0; i < len; ++i) {\n        if (isNeutral.test(types[i])) {\n          for (var end = i + 1; end < len && isNeutral.test(types[end]); ++end) {}\n          var before = (i ? types[i-1] : outerType) == \"L\";\n          var after = (end < len ? types[end] : outerType) == \"L\";\n          var replace = before || after ? \"L\" : \"R\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i = 0; i < len;) {\n        if (countsAsLeft.test(types[i])) {\n          var start = i;\n          for (++i; i < len && countsAsLeft.test(types[i]); ++i) {}\n          order.push(new BidiSpan(0, start, i));\n        } else {\n          var pos = i, at = order.length;\n          for (++i; i < len && types[i] != \"L\"; ++i) {}\n          for (var j = pos; j < i;) {\n            if (countsAsNum.test(types[j])) {\n              if (pos < j) order.splice(at, 0, new BidiSpan(1, pos, j));\n              var nstart = j;\n              for (++j; j < i && countsAsNum.test(types[j]); ++j) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j));\n              pos = j;\n            } else ++j;\n          }\n          if (pos < i) order.splice(at, 0, new BidiSpan(1, pos, i));\n        }\n      }\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n        order[0].from = m[0].length;\n        order.unshift(new BidiSpan(0, 0, m[0].length));\n      }\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n        lst(order).to -= m[0].length;\n        order.push(new BidiSpan(0, len - m[0].length, len));\n      }\n      if (order[0].level == 2)\n        order.unshift(new BidiSpan(1, order[0].to, order[0].to));\n      if (order[0].level != lst(order).level)\n        order.push(new BidiSpan(order[0].level, len, len));\n\n      return order;\n    };\n  })();\n\n  // THE END\n\n  CodeMirror.version = \"5.8.0\";\n\n  return CodeMirror;\n});\n\n},{}],31:[function(_dereq_,module,exports){\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(_dereq_(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"clike\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit,\n      statementIndentUnit = parserConfig.statementIndentUnit || indentUnit,\n      dontAlignCalls = parserConfig.dontAlignCalls,\n      keywords = parserConfig.keywords || {},\n      types = parserConfig.types || {},\n      builtin = parserConfig.builtin || {},\n      blockKeywords = parserConfig.blockKeywords || {},\n      defKeywords = parserConfig.defKeywords || {},\n      atoms = parserConfig.atoms || {},\n      hooks = parserConfig.hooks || {},\n      multiLineStrings = parserConfig.multiLineStrings,\n      indentStatements = parserConfig.indentStatements !== false,\n      indentSwitch = parserConfig.indentSwitch !== false,\n      namespaceSeparator = parserConfig.namespaceSeparator,\n      isPunctuationChar = parserConfig.isPunctuationChar || /[\\[\\]{}\\(\\),;\\:\\.]/,\n      isNumberChar = parserConfig.isNumberChar || /\\d/,\n      isOperatorChar = parserConfig.isOperatorChar || /[+\\-*&%=<>!?|\\/]/,\n      endStatement = parserConfig.endStatement || /^[;:,]$/;\n\n  var curPunc, isDefKeyword;\n\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (hooks[ch]) {\n      var result = hooks[ch](stream, state);\n      if (result !== false) return result;\n    }\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    }\n    if (isPunctuationChar.test(ch)) {\n      curPunc = ch;\n      return null;\n    }\n    if (isNumberChar.test(ch)) {\n      stream.eatWhile(/[\\w\\.]/);\n      return \"number\";\n    }\n    if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      }\n      if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return \"comment\";\n      }\n    }\n    if (isOperatorChar.test(ch)) {\n      stream.eatWhile(isOperatorChar);\n      return \"operator\";\n    }\n    stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n    if (namespaceSeparator) while (stream.match(namespaceSeparator))\n      stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n\n    var cur = stream.current();\n    if (contains(keywords, cur)) {\n      if (contains(blockKeywords, cur)) curPunc = \"newstatement\";\n      if (contains(defKeywords, cur)) isDefKeyword = true;\n      return \"keyword\";\n    }\n    if (contains(types, cur)) return \"variable-3\";\n    if (contains(builtin, cur)) {\n      if (contains(blockKeywords, cur)) curPunc = \"newstatement\";\n      return \"builtin\";\n    }\n    if (contains(atoms, cur)) return \"atom\";\n    return \"variable\";\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next, end = false;\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) {end = true; break;}\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (end || !(escaped || multiLineStrings))\n        state.tokenize = null;\n      return \"string\";\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = null;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return \"comment\";\n  }\n\n  function Context(indented, column, type, align, prev) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.align = align;\n    this.prev = prev;\n  }\n  function isStatement(type) {\n    return type == \"statement\" || type == \"switchstatement\" || type == \"namespace\";\n  }\n  function pushContext(state, col, type) {\n    var indent = state.indented;\n    if (state.context && isStatement(state.context.type) && !isStatement(type))\n      indent = state.context.indented;\n    return state.context = new Context(indent, col, type, null, state.context);\n  }\n  function popContext(state) {\n    var t = state.context.type;\n    if (t == \")\" || t == \"]\" || t == \"}\")\n      state.indented = state.context.indented;\n    return state.context = state.context.prev;\n  }\n\n  function typeBefore(stream, state) {\n    if (state.prevToken == \"variable\" || state.prevToken == \"variable-3\") return true;\n    if (/\\S(?:[^- ]>|[*\\]])\\s*$|\\*$/.test(stream.string.slice(0, stream.start))) return true;\n  }\n\n  function isTopScope(context) {\n    for (;;) {\n      if (!context || context.type == \"top\") return true;\n      if (context.type == \"}\" && context.prev.type != \"namespace\") return false;\n      context = context.prev;\n    }\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      return {\n        tokenize: null,\n        context: new Context((basecolumn || 0) - indentUnit, 0, \"top\", false),\n        indented: 0,\n        startOfLine: true,\n        prevToken: null\n      };\n    },\n\n    token: function(stream, state) {\n      var ctx = state.context;\n      if (stream.sol()) {\n        if (ctx.align == null) ctx.align = false;\n        state.indented = stream.indentation();\n        state.startOfLine = true;\n      }\n      if (stream.eatSpace()) return null;\n      curPunc = isDefKeyword = null;\n      var style = (state.tokenize || tokenBase)(stream, state);\n      if (style == \"comment\" || style == \"meta\") return style;\n      if (ctx.align == null) ctx.align = true;\n\n      if (endStatement.test(curPunc)) while (isStatement(state.context.type)) popContext(state);\n      else if (curPunc == \"{\") pushContext(state, stream.column(), \"}\");\n      else if (curPunc == \"[\") pushContext(state, stream.column(), \"]\");\n      else if (curPunc == \"(\") pushContext(state, stream.column(), \")\");\n      else if (curPunc == \"}\") {\n        while (isStatement(ctx.type)) ctx = popContext(state);\n        if (ctx.type == \"}\") ctx = popContext(state);\n        while (isStatement(ctx.type)) ctx = popContext(state);\n      }\n      else if (curPunc == ctx.type) popContext(state);\n      else if (indentStatements &&\n               (((ctx.type == \"}\" || ctx.type == \"top\") && curPunc != \";\") ||\n                (isStatement(ctx.type) && curPunc == \"newstatement\"))) {\n        var type = \"statement\";\n        if (curPunc == \"newstatement\" && indentSwitch && stream.current() == \"switch\")\n          type = \"switchstatement\";\n        else if (style == \"keyword\" && stream.current() == \"namespace\")\n          type = \"namespace\";\n        pushContext(state, stream.column(), type);\n      }\n\n      if (style == \"variable\" &&\n          ((state.prevToken == \"def\" ||\n            (parserConfig.typeFirstDefinitions && typeBefore(stream, state) &&\n             isTopScope(state.context) && stream.match(/^\\s*\\(/, false)))))\n        style = \"def\";\n\n      if (hooks.token) {\n        var result = hooks.token(stream, state, style);\n        if (result !== undefined) style = result;\n      }\n\n      if (style == \"def\" && parserConfig.styleDefs === false) style = \"variable\";\n\n      state.startOfLine = false;\n      state.prevToken = isDefKeyword ? \"def\" : style || curPunc;\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize != tokenBase && state.tokenize != null) return CodeMirror.Pass;\n      var ctx = state.context, firstChar = textAfter && textAfter.charAt(0);\n      if (isStatement(ctx.type) && firstChar == \"}\") ctx = ctx.prev;\n      if (hooks.indent) {\n        var hook = hooks.indent(state, ctx, textAfter);\n        if (typeof hook == \"number\") return hook\n      }\n      var closing = firstChar == ctx.type;\n      var switchBlock = ctx.prev && ctx.prev.type == \"switchstatement\";\n      if (isStatement(ctx.type))\n        return ctx.indented + (firstChar == \"{\" ? 0 : statementIndentUnit);\n      if (ctx.align && (!dontAlignCalls || ctx.type != \")\"))\n        return ctx.column + (closing ? 0 : 1);\n      if (ctx.type == \")\" && !closing)\n        return ctx.indented + statementIndentUnit;\n\n      return ctx.indented + (closing ? 0 : indentUnit) +\n        (!closing && switchBlock && !/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 0);\n    },\n\n    electricInput: indentSwitch ? /^\\s*(?:case .*?:|default:|\\{\\}?|\\})$/ : /^\\s*[{}]$/,\n    blockCommentStart: \"/*\",\n    blockCommentEnd: \"*/\",\n    lineComment: \"//\",\n    fold: \"brace\"\n  };\n});\n\n  function words(str) {\n    var obj = {}, words = str.split(\" \");\n    for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n    return obj;\n  }\n  function contains(words, word) {\n    if (typeof words === \"function\") {\n      return words(word);\n    } else {\n      return words.propertyIsEnumerable(word);\n    }\n  }\n  var cKeywords = \"auto if break case register continue return default do sizeof \" +\n    \"static else struct switch extern typedef float union for \" +\n    \"goto while enum const volatile\";\n  var cTypes = \"int long char short double float unsigned signed void size_t ptrdiff_t\";\n\n  function cppHook(stream, state) {\n    if (!state.startOfLine) return false;\n    for (;;) {\n      if (stream.skipTo(\"\\\\\")) {\n        stream.next();\n        if (stream.eol()) {\n          state.tokenize = cppHook;\n          break;\n        }\n      } else {\n        stream.skipToEnd();\n        state.tokenize = null;\n        break;\n      }\n    }\n    return \"meta\";\n  }\n\n  function pointerHook(_stream, state) {\n    if (state.prevToken == \"variable-3\") return \"variable-3\";\n    return false;\n  }\n\n  function cpp14Literal(stream) {\n    stream.eatWhile(/[\\w\\.']/);\n    return \"number\";\n  }\n\n  function cpp11StringHook(stream, state) {\n    stream.backUp(1);\n    // Raw strings.\n    if (stream.match(/(R|u8R|uR|UR|LR)/)) {\n      var match = stream.match(/\"([^\\s\\\\()]{0,16})\\(/);\n      if (!match) {\n        return false;\n      }\n      state.cpp11RawStringDelim = match[1];\n      state.tokenize = tokenRawString;\n      return tokenRawString(stream, state);\n    }\n    // Unicode strings/chars.\n    if (stream.match(/(u8|u|U|L)/)) {\n      if (stream.match(/[\"']/, /* eat */ false)) {\n        return \"string\";\n      }\n      return false;\n    }\n    // Ignore this hook.\n    stream.next();\n    return false;\n  }\n\n  function cppLooksLikeConstructor(word) {\n    var lastTwo = /(\\w+)::(\\w+)$/.exec(word);\n    return lastTwo && lastTwo[1] == lastTwo[2];\n  }\n\n  // C#-style strings where \"\" escapes a quote.\n  function tokenAtString(stream, state) {\n    var next;\n    while ((next = stream.next()) != null) {\n      if (next == '\"' && !stream.eat('\"')) {\n        state.tokenize = null;\n        break;\n      }\n    }\n    return \"string\";\n  }\n\n  // C++11 raw string literal is <prefix>\"<delim>( anything )<delim>\", where\n  // <delim> can be a string up to 16 characters long.\n  function tokenRawString(stream, state) {\n    // Escape characters that have special regex meanings.\n    var delim = state.cpp11RawStringDelim.replace(/[^\\w\\s]/g, '\\\\$&');\n    var match = stream.match(new RegExp(\".*?\\\\)\" + delim + '\"'));\n    if (match)\n      state.tokenize = null;\n    else\n      stream.skipToEnd();\n    return \"string\";\n  }\n\n  function def(mimes, mode) {\n    if (typeof mimes == \"string\") mimes = [mimes];\n    var words = [];\n    function add(obj) {\n      if (obj) for (var prop in obj) if (obj.hasOwnProperty(prop))\n        words.push(prop);\n    }\n    add(mode.keywords);\n    add(mode.types);\n    add(mode.builtin);\n    add(mode.atoms);\n    if (words.length) {\n      mode.helperType = mimes[0];\n      CodeMirror.registerHelper(\"hintWords\", mimes[0], words);\n    }\n\n    for (var i = 0; i < mimes.length; ++i)\n      CodeMirror.defineMIME(mimes[i], mode);\n  }\n\n  def([\"text/x-csrc\", \"text/x-c\", \"text/x-chdr\"], {\n    name: \"clike\",\n    keywords: words(cKeywords),\n    types: words(cTypes + \" bool _Complex _Bool float_t double_t intptr_t intmax_t \" +\n                 \"int8_t int16_t int32_t int64_t uintptr_t uintmax_t uint8_t uint16_t \" +\n                 \"uint32_t uint64_t\"),\n    blockKeywords: words(\"case do else for if switch while struct\"),\n    defKeywords: words(\"struct\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"null true false\"),\n    hooks: {\"#\": cppHook, \"*\": pointerHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def([\"text/x-c++src\", \"text/x-c++hdr\"], {\n    name: \"clike\",\n    keywords: words(cKeywords + \" asm dynamic_cast namespace reinterpret_cast try explicit new \" +\n                    \"static_cast typeid catch operator template typename class friend private \" +\n                    \"this using const_cast inline public throw virtual delete mutable protected \" +\n                    \"alignas alignof constexpr decltype nullptr noexcept thread_local final \" +\n                    \"static_assert override\"),\n    types: words(cTypes + \" bool wchar_t\"),\n    blockKeywords: words(\"catch class do else finally for if struct switch try while\"),\n    defKeywords: words(\"class namespace struct enum union\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    hooks: {\n      \"#\": cppHook,\n      \"*\": pointerHook,\n      \"u\": cpp11StringHook,\n      \"U\": cpp11StringHook,\n      \"L\": cpp11StringHook,\n      \"R\": cpp11StringHook,\n      \"0\": cpp14Literal,\n      \"1\": cpp14Literal,\n      \"2\": cpp14Literal,\n      \"3\": cpp14Literal,\n      \"4\": cpp14Literal,\n      \"5\": cpp14Literal,\n      \"6\": cpp14Literal,\n      \"7\": cpp14Literal,\n      \"8\": cpp14Literal,\n      \"9\": cpp14Literal,\n      token: function(stream, state, style) {\n        if (style == \"variable\" && stream.peek() == \"(\" &&\n            (state.prevToken == \";\" || state.prevToken == null ||\n             state.prevToken == \"}\") &&\n            cppLooksLikeConstructor(stream.current()))\n          return \"def\";\n      }\n    },\n    namespaceSeparator: \"::\",\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-java\", {\n    name: \"clike\",\n    keywords: words(\"abstract assert break case catch class const continue default \" +\n                    \"do else enum extends final finally float for goto if implements import \" +\n                    \"instanceof interface native new package private protected public \" +\n                    \"return static strictfp super switch synchronized this throw throws transient \" +\n                    \"try volatile while\"),\n    types: words(\"byte short int long float double boolean char void Boolean Byte Character Double Float \" +\n                 \"Integer Long Number Object Short String StringBuffer StringBuilder Void\"),\n    blockKeywords: words(\"catch class do else finally for if switch try while\"),\n    defKeywords: words(\"class interface package enum\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    endStatement: /^[;:]$/,\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      }\n    },\n    modeProps: {fold: [\"brace\", \"import\"]}\n  });\n\n  def(\"text/x-csharp\", {\n    name: \"clike\",\n    keywords: words(\"abstract as async await base break case catch checked class const continue\" +\n                    \" default delegate do else enum event explicit extern finally fixed for\" +\n                    \" foreach goto if implicit in interface internal is lock namespace new\" +\n                    \" operator out override params private protected public readonly ref return sealed\" +\n                    \" sizeof stackalloc static struct switch this throw try typeof unchecked\" +\n                    \" unsafe using virtual void volatile while add alias ascending descending dynamic from get\" +\n                    \" global group into join let orderby partial remove select set value var yield\"),\n    types: words(\"Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func\" +\n                 \" Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32\" +\n                 \" UInt64 bool byte char decimal double short int long object\"  +\n                 \" sbyte float string ushort uint ulong\"),\n    blockKeywords: words(\"catch class do else finally for foreach if struct switch try while\"),\n    defKeywords: words(\"class interface namespace struct var\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    hooks: {\n      \"@\": function(stream, state) {\n        if (stream.eat('\"')) {\n          state.tokenize = tokenAtString;\n          return tokenAtString(stream, state);\n        }\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      }\n    }\n  });\n\n  function tokenTripleString(stream, state) {\n    var escaped = false;\n    while (!stream.eol()) {\n      if (!escaped && stream.match('\"\"\"')) {\n        state.tokenize = null;\n        break;\n      }\n      escaped = stream.next() == \"\\\\\" && !escaped;\n    }\n    return \"string\";\n  }\n\n  def(\"text/x-scala\", {\n    name: \"clike\",\n    keywords: words(\n\n      /* scala */\n      \"abstract case catch class def do else extends final finally for forSome if \" +\n      \"implicit import lazy match new null object override package private protected return \" +\n      \"sealed super this throw trait try type val var while with yield _ : = => <- <: \" +\n      \"<% >: # @ \" +\n\n      /* package scala */\n      \"assert assume require print println printf readLine readBoolean readByte readShort \" +\n      \"readChar readInt readLong readFloat readDouble \" +\n\n      \":: #:: \"\n    ),\n    types: words(\n      \"AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either \" +\n      \"Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable \" +\n      \"Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering \" +\n      \"Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder \" +\n      \"StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector \" +\n\n      /* package java.lang */\n      \"Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable \" +\n      \"Compiler Double Exception Float Integer Long Math Number Object Package Pair Process \" +\n      \"Runtime Runnable SecurityManager Short StackTraceElement StrictMath String \" +\n      \"StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void\"\n    ),\n    multiLineStrings: true,\n    blockKeywords: words(\"catch class do else finally for forSome if match switch try while\"),\n    defKeywords: words(\"class def object package trait type val var\"),\n    atoms: words(\"true false null\"),\n    indentStatements: false,\n    indentSwitch: false,\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      },\n      '\"': function(stream, state) {\n        if (!stream.match('\"\"')) return false;\n        state.tokenize = tokenTripleString;\n        return state.tokenize(stream, state);\n      },\n      \"'\": function(stream) {\n        stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n        return \"atom\";\n      }\n    },\n    modeProps: {closeBrackets: {triples: '\"'}}\n  });\n\n  def(\"text/x-kotlin\", {\n    name: \"clike\",\n    keywords: words(\n      /*keywords*/\n      \"package as typealias class interface this super val \" +\n      \"var fun for is in This throw return \" +\n      \"break continue object if else while do try when !in !is as?\" +\n\n      /*soft keywords*/\n      \"file import where by get set abstract enum open inner override private public internal \" +\n      \"protected catch finally out final vararg reified dynamic companion constructor init \" +\n      \"sealed field property receiver param sparam lateinit data inline noinline tailrec \" +\n      \"external annotation crossinline\"\n    ),\n    types: words(\n      /* package java.lang */\n      \"Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable \" +\n      \"Compiler Double Exception Float Integer Long Math Number Object Package Pair Process \" +\n      \"Runtime Runnable SecurityManager Short StackTraceElement StrictMath String \" +\n      \"StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void\"\n    ),\n    multiLineStrings: true,\n    blockKeywords: words(\"catch class do else finally for if where try while enum\"),\n    defKeywords: words(\"class val var object package interface fun\"),\n    atoms: words(\"true false null this\"),\n    modeProps: {closeBrackets: {triples: '\"'}}\n  });\n\n  def([\"x-shader/x-vertex\", \"x-shader/x-fragment\"], {\n    name: \"clike\",\n    keywords: words(\"sampler1D sampler2D sampler3D samplerCube \" +\n                    \"sampler1DShadow sampler2DShadow \" +\n                    \"const attribute uniform varying \" +\n                    \"break continue discard return \" +\n                    \"for while do if else struct \" +\n                    \"in out inout\"),\n    types: words(\"float int bool void \" +\n                 \"vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 \" +\n                 \"mat2 mat3 mat4\"),\n    blockKeywords: words(\"for while do if else struct\"),\n    builtin: words(\"radians degrees sin cos tan asin acos atan \" +\n                    \"pow exp log exp2 sqrt inversesqrt \" +\n                    \"abs sign floor ceil fract mod min max clamp mix step smoothstep \" +\n                    \"length distance dot cross normalize ftransform faceforward \" +\n                    \"reflect refract matrixCompMult \" +\n                    \"lessThan lessThanEqual greaterThan greaterThanEqual \" +\n                    \"equal notEqual any all not \" +\n                    \"texture1D texture1DProj texture1DLod texture1DProjLod \" +\n                    \"texture2D texture2DProj texture2DLod texture2DProjLod \" +\n                    \"texture3D texture3DProj texture3DLod texture3DProjLod \" +\n                    \"textureCube textureCubeLod \" +\n                    \"shadow1D shadow2D shadow1DProj shadow2DProj \" +\n                    \"shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod \" +\n                    \"dFdx dFdy fwidth \" +\n                    \"noise1 noise2 noise3 noise4\"),\n    atoms: words(\"true false \" +\n                \"gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex \" +\n                \"gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 \" +\n                \"gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 \" +\n                \"gl_FogCoord gl_PointCoord \" +\n                \"gl_Position gl_PointSize gl_ClipVertex \" +\n                \"gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor \" +\n                \"gl_TexCoord gl_FogFragCoord \" +\n                \"gl_FragCoord gl_FrontFacing \" +\n                \"gl_FragData gl_FragDepth \" +\n                \"gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix \" +\n                \"gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse \" +\n                \"gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse \" +\n                \"gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose \" +\n                \"gl_ProjectionMatrixInverseTranspose \" +\n                \"gl_ModelViewProjectionMatrixInverseTranspose \" +\n                \"gl_TextureMatrixInverseTranspose \" +\n                \"gl_NormalScale gl_DepthRange gl_ClipPlane \" +\n                \"gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel \" +\n                \"gl_FrontLightModelProduct gl_BackLightModelProduct \" +\n                \"gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ \" +\n                \"gl_FogParameters \" +\n                \"gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords \" +\n                \"gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats \" +\n                \"gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits \" +\n                \"gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits \" +\n                \"gl_MaxDrawBuffers\"),\n    indentSwitch: false,\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-nesc\", {\n    name: \"clike\",\n    keywords: words(cKeywords + \"as atomic async call command component components configuration event generic \" +\n                    \"implementation includes interface module new norace nx_struct nx_union post provides \" +\n                    \"signal task uses abstract extends\"),\n    types: words(cTypes),\n    blockKeywords: words(\"case do else for if switch while struct\"),\n    atoms: words(\"null true false\"),\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  def(\"text/x-objectivec\", {\n    name: \"clike\",\n    keywords: words(cKeywords + \"inline restrict _Bool _Complex _Imaginery BOOL Class bycopy byref id IMP in \" +\n                    \"inout nil oneway out Protocol SEL self super atomic nonatomic retain copy readwrite readonly\"),\n    types: words(cTypes),\n    atoms: words(\"YES NO NULL NILL ON OFF true false\"),\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$]/);\n        return \"keyword\";\n      },\n      \"#\": cppHook,\n      indent: function(_state, ctx, textAfter) {\n        if (ctx.type == \"statement\" && /^@\\w/.test(textAfter)) return ctx.indented\n      }\n    },\n    modeProps: {fold: \"brace\"}\n  });\n\n  def(\"text/x-squirrel\", {\n    name: \"clike\",\n    keywords: words(\"base break clone continue const default delete enum extends function in class\" +\n                    \" foreach local resume return this throw typeof yield constructor instanceof static\"),\n    types: words(cTypes),\n    blockKeywords: words(\"case catch class else for foreach if switch try while\"),\n    defKeywords: words(\"function local class\"),\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null\"),\n    hooks: {\"#\": cppHook},\n    modeProps: {fold: [\"brace\", \"include\"]}\n  });\n\n  // Ceylon Strings need to deal with interpolation\n  var stringTokenizer = null;\n  function tokenCeylonString(type) {\n    return function(stream, state) {\n      var escaped = false, next, end = false;\n      while (!stream.eol()) {\n        if (!escaped && stream.match('\"') &&\n              (type == \"single\" || stream.match('\"\"'))) {\n          end = true;\n          break;\n        }\n        if (!escaped && stream.match('``')) {\n          stringTokenizer = tokenCeylonString(type);\n          end = true;\n          break;\n        }\n        next = stream.next();\n        escaped = type == \"single\" && !escaped && next == \"\\\\\";\n      }\n      if (end)\n          state.tokenize = null;\n      return \"string\";\n    }\n  }\n\n  def(\"text/x-ceylon\", {\n    name: \"clike\",\n    keywords: words(\"abstracts alias assembly assert assign break case catch class continue dynamic else\" +\n                    \" exists extends finally for function given if import in interface is let module new\" +\n                    \" nonempty object of out outer package return satisfies super switch then this throw\" +\n                    \" try value void while\"),\n    types: function(word) {\n        // In Ceylon all identifiers that start with an uppercase are types\n        var first = word.charAt(0);\n        return (first === first.toUpperCase() && first !== first.toLowerCase());\n    },\n    blockKeywords: words(\"case catch class dynamic else finally for function if interface module new object switch try while\"),\n    defKeywords: words(\"class dynamic function interface module object package value\"),\n    builtin: words(\"abstract actual aliased annotation by default deprecated doc final formal late license\" +\n                   \" native optional sealed see serializable shared suppressWarnings tagged throws variable\"),\n    isPunctuationChar: /[\\[\\]{}\\(\\),;\\:\\.`]/,\n    isOperatorChar: /[+\\-*&%=<>!?|^~:\\/]/,\n    isNumberChar: /[\\d#$]/,\n    multiLineStrings: true,\n    typeFirstDefinitions: true,\n    atoms: words(\"true false null larger smaller equal empty finished\"),\n    indentSwitch: false,\n    styleDefs: false,\n    hooks: {\n      \"@\": function(stream) {\n        stream.eatWhile(/[\\w\\$_]/);\n        return \"meta\";\n      },\n      '\"': function(stream, state) {\n          state.tokenize = tokenCeylonString(stream.match('\"\"') ? \"triple\" : \"single\");\n          return state.tokenize(stream, state);\n        },\n      '`': function(stream, state) {\n          if (!stringTokenizer || !stream.match('`')) return false;\n          state.tokenize = stringTokenizer;\n          stringTokenizer = null;\n          return state.tokenize(stream, state);\n        },\n      \"'\": function(stream) {\n        stream.eatWhile(/[\\w\\$_\\xa1-\\uffff]/);\n        return \"atom\";\n      },\n      token: function(_stream, state, style) {\n          if ((style == \"variable\" || style == \"variable-3\") &&\n              state.prevToken == \".\") {\n            return \"variable-2\";\n          }\n        }\n    },\n    modeProps: {\n        fold: [\"brace\", \"import\"],\n        closeBrackets: {triples: '\"'}\n    }\n  });\n\n});\n\n},{\"../../lib/codemirror\":30}],32:[function(_dereq_,module,exports){\n_dereq_('../modules/web.dom.iterable');\n_dereq_('../modules/es6.string.iterator');\nmodule.exports = _dereq_('../modules/core.get-iterator');\n},{\"../modules/core.get-iterator\":95,\"../modules/es6.string.iterator\":104,\"../modules/web.dom.iterable\":106}],33:[function(_dereq_,module,exports){\n_dereq_('../../modules/es6.object.assign');\nmodule.exports = _dereq_('../../modules/$.core').Object.assign;\n},{\"../../modules/$.core\":49,\"../../modules/es6.object.assign\":97}],34:[function(_dereq_,module,exports){\nvar $ = _dereq_('../../modules/$');\nmodule.exports = function create(P, D){\n  return $.create(P, D);\n};\n},{\"../../modules/$\":71}],35:[function(_dereq_,module,exports){\nvar $ = _dereq_('../../modules/$');\nmodule.exports = function defineProperty(it, key, desc){\n  return $.setDesc(it, key, desc);\n};\n},{\"../../modules/$\":71}],36:[function(_dereq_,module,exports){\nvar $ = _dereq_('../../modules/$');\n_dereq_('../../modules/es6.object.get-own-property-descriptor');\nmodule.exports = function getOwnPropertyDescriptor(it, key){\n  return $.getDesc(it, key);\n};\n},{\"../../modules/$\":71,\"../../modules/es6.object.get-own-property-descriptor\":98}],37:[function(_dereq_,module,exports){\n_dereq_('../../modules/es6.object.keys');\nmodule.exports = _dereq_('../../modules/$.core').Object.keys;\n},{\"../../modules/$.core\":49,\"../../modules/es6.object.keys\":99}],38:[function(_dereq_,module,exports){\n_dereq_('../../modules/es6.object.set-prototype-of');\nmodule.exports = _dereq_('../../modules/$.core').Object.setPrototypeOf;\n},{\"../../modules/$.core\":49,\"../../modules/es6.object.set-prototype-of\":100}],39:[function(_dereq_,module,exports){\n_dereq_('../modules/es6.object.to-string');\n_dereq_('../modules/es6.string.iterator');\n_dereq_('../modules/web.dom.iterable');\n_dereq_('../modules/es6.promise');\nmodule.exports = _dereq_('../modules/$.core').Promise;\n},{\"../modules/$.core\":49,\"../modules/es6.object.to-string\":101,\"../modules/es6.promise\":102,\"../modules/es6.string.iterator\":104,\"../modules/web.dom.iterable\":106}],40:[function(_dereq_,module,exports){\n_dereq_('../modules/es6.object.to-string');\n_dereq_('../modules/es6.string.iterator');\n_dereq_('../modules/web.dom.iterable');\n_dereq_('../modules/es6.set');\n_dereq_('../modules/es7.set.to-json');\nmodule.exports = _dereq_('../modules/$.core').Set;\n},{\"../modules/$.core\":49,\"../modules/es6.object.to-string\":101,\"../modules/es6.set\":103,\"../modules/es6.string.iterator\":104,\"../modules/es7.set.to-json\":105,\"../modules/web.dom.iterable\":106}],41:[function(_dereq_,module,exports){\nmodule.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n},{}],42:[function(_dereq_,module,exports){\nmodule.exports = function(){ /* empty */ };\n},{}],43:[function(_dereq_,module,exports){\nvar isObject = _dereq_('./$.is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n},{\"./$.is-object\":64}],44:[function(_dereq_,module,exports){\n// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = _dereq_('./$.cof')\n  , TAG = _dereq_('./$.wks')('toStringTag')\n  // ES3 wrong here\n  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\nmodule.exports = function(it){\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = (O = Object(it))[TAG]) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n},{\"./$.cof\":45,\"./$.wks\":93}],45:[function(_dereq_,module,exports){\nvar toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n},{}],46:[function(_dereq_,module,exports){\n'use strict';\nvar $            = _dereq_('./$')\n  , hide         = _dereq_('./$.hide')\n  , redefineAll  = _dereq_('./$.redefine-all')\n  , ctx          = _dereq_('./$.ctx')\n  , strictNew    = _dereq_('./$.strict-new')\n  , defined      = _dereq_('./$.defined')\n  , forOf        = _dereq_('./$.for-of')\n  , $iterDefine  = _dereq_('./$.iter-define')\n  , step         = _dereq_('./$.iter-step')\n  , ID           = _dereq_('./$.uid')('id')\n  , $has         = _dereq_('./$.has')\n  , isObject     = _dereq_('./$.is-object')\n  , setSpecies   = _dereq_('./$.set-species')\n  , DESCRIPTORS  = _dereq_('./$.descriptors')\n  , isExtensible = Object.isExtensible || isObject\n  , SIZE         = DESCRIPTORS ? '_s' : 'size'\n  , id           = 0;\n\nvar fastKey = function(it, create){\n  // return primitive with prefix\n  if(!isObject(it))return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if(!$has(it, ID)){\n    // can't set id to frozen object\n    if(!isExtensible(it))return 'F';\n    // not necessary to add id\n    if(!create)return 'E';\n    // add missing object id\n    hide(it, ID, ++id);\n  // return object id with prefix\n  } return 'O' + it[ID];\n};\n\nvar getEntry = function(that, key){\n  // fast case\n  var index = fastKey(key), entry;\n  if(index !== 'F')return that._i[index];\n  // frozen object case\n  for(entry = that._f; entry; entry = entry.n){\n    if(entry.k == key)return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function(wrapper, NAME, IS_MAP, ADDER){\n    var C = wrapper(function(that, iterable){\n      strictNew(that, C, NAME);\n      that._i = $.create(null); // index\n      that._f = undefined;      // first entry\n      that._l = undefined;      // last entry\n      that[SIZE] = 0;           // size\n      if(iterable != undefined)forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear(){\n        for(var that = this, data = that._i, entry = that._f; entry; entry = entry.n){\n          entry.r = true;\n          if(entry.p)entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function(key){\n        var that  = this\n          , entry = getEntry(that, key);\n        if(entry){\n          var next = entry.n\n            , prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if(prev)prev.n = next;\n          if(next)next.p = prev;\n          if(that._f == entry)that._f = next;\n          if(that._l == entry)that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /*, that = undefined */){\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3)\n          , entry;\n        while(entry = entry ? entry.n : this._f){\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while(entry && entry.r)entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key){\n        return !!getEntry(this, key);\n      }\n    });\n    if(DESCRIPTORS)$.setDesc(C.prototype, 'size', {\n      get: function(){\n        return defined(this[SIZE]);\n      }\n    });\n    return C;\n  },\n  def: function(that, key, value){\n    var entry = getEntry(that, key)\n      , prev, index;\n    // change existing entry\n    if(entry){\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if(!that._f)that._f = entry;\n      if(prev)prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if(index !== 'F')that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function(C, NAME, IS_MAP){\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function(iterated, kind){\n      this._t = iterated;  // target\n      this._k = kind;      // kind\n      this._l = undefined; // previous\n    }, function(){\n      var that  = this\n        , kind  = that._k\n        , entry = that._l;\n      // revert to the last existing entry\n      while(entry && entry.r)entry = entry.p;\n      // get next entry\n      if(!that._t || !(that._l = entry = entry ? entry.n : that._t._f)){\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if(kind == 'keys'  )return step(0, entry.k);\n      if(kind == 'values')return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values' , !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n},{\"./$\":71,\"./$.ctx\":50,\"./$.defined\":51,\"./$.descriptors\":52,\"./$.for-of\":56,\"./$.has\":58,\"./$.hide\":59,\"./$.is-object\":64,\"./$.iter-define\":67,\"./$.iter-step\":69,\"./$.redefine-all\":77,\"./$.set-species\":81,\"./$.strict-new\":85,\"./$.uid\":92}],47:[function(_dereq_,module,exports){\n// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar forOf   = _dereq_('./$.for-of')\n  , classof = _dereq_('./$.classof');\nmodule.exports = function(NAME){\n  return function toJSON(){\n    if(classof(this) != NAME)throw TypeError(NAME + \"#toJSON isn't generic\");\n    var arr = [];\n    forOf(this, false, arr.push, arr);\n    return arr;\n  };\n};\n},{\"./$.classof\":44,\"./$.for-of\":56}],48:[function(_dereq_,module,exports){\n'use strict';\nvar $              = _dereq_('./$')\n  , global         = _dereq_('./$.global')\n  , $export        = _dereq_('./$.export')\n  , fails          = _dereq_('./$.fails')\n  , hide           = _dereq_('./$.hide')\n  , redefineAll    = _dereq_('./$.redefine-all')\n  , forOf          = _dereq_('./$.for-of')\n  , strictNew      = _dereq_('./$.strict-new')\n  , isObject       = _dereq_('./$.is-object')\n  , setToStringTag = _dereq_('./$.set-to-string-tag')\n  , DESCRIPTORS    = _dereq_('./$.descriptors');\n\nmodule.exports = function(NAME, wrapper, methods, common, IS_MAP, IS_WEAK){\n  var Base  = global[NAME]\n    , C     = Base\n    , ADDER = IS_MAP ? 'set' : 'add'\n    , proto = C && C.prototype\n    , O     = {};\n  if(!DESCRIPTORS || typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function(){\n    new C().entries().next();\n  }))){\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n  } else {\n    C = wrapper(function(target, iterable){\n      strictNew(target, C, NAME);\n      target._c = new Base;\n      if(iterable != undefined)forOf(iterable, IS_MAP, target[ADDER], target);\n    });\n    $.each.call('add,clear,delete,forEach,get,has,set,keys,values,entries'.split(','),function(KEY){\n      var IS_ADDER = KEY == 'add' || KEY == 'set';\n      if(KEY in proto && !(IS_WEAK && KEY == 'clear'))hide(C.prototype, KEY, function(a, b){\n        if(!IS_ADDER && IS_WEAK && !isObject(a))return KEY == 'get' ? undefined : false;\n        var result = this._c[KEY](a === 0 ? 0 : a, b);\n        return IS_ADDER ? this : result;\n      });\n    });\n    if('size' in proto)$.setDesc(C.prototype, 'size', {\n      get: function(){\n        return this._c.size;\n      }\n    });\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F, O);\n\n  if(!IS_WEAK)common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n},{\"./$\":71,\"./$.descriptors\":52,\"./$.export\":54,\"./$.fails\":55,\"./$.for-of\":56,\"./$.global\":57,\"./$.hide\":59,\"./$.is-object\":64,\"./$.redefine-all\":77,\"./$.set-to-string-tag\":82,\"./$.strict-new\":85}],49:[function(_dereq_,module,exports){\nvar core = module.exports = {version: '1.2.6'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n},{}],50:[function(_dereq_,module,exports){\n// optional / simple context binding\nvar aFunction = _dereq_('./$.a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n},{\"./$.a-function\":41}],51:[function(_dereq_,module,exports){\n// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n},{}],52:[function(_dereq_,module,exports){\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !_dereq_('./$.fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n},{\"./$.fails\":55}],53:[function(_dereq_,module,exports){\nvar isObject = _dereq_('./$.is-object')\n  , document = _dereq_('./$.global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n},{\"./$.global\":57,\"./$.is-object\":64}],54:[function(_dereq_,module,exports){\nvar global    = _dereq_('./$.global')\n  , core      = _dereq_('./$.core')\n  , ctx       = _dereq_('./$.ctx')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , IS_WRAP   = type & $export.W\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]\n    , key, own, out;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && key in target;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function(C){\n      var F = function(param){\n        return this instanceof C ? new C(param) : C(param);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    if(IS_PROTO)(exports[PROTOTYPE] || (exports[PROTOTYPE] = {}))[key] = out;\n  }\n};\n// type bitmap\n$export.F = 1;  // forced\n$export.G = 2;  // global\n$export.S = 4;  // static\n$export.P = 8;  // proto\n$export.B = 16; // bind\n$export.W = 32; // wrap\nmodule.exports = $export;\n},{\"./$.core\":49,\"./$.ctx\":50,\"./$.global\":57}],55:[function(_dereq_,module,exports){\nmodule.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n},{}],56:[function(_dereq_,module,exports){\nvar ctx         = _dereq_('./$.ctx')\n  , call        = _dereq_('./$.iter-call')\n  , isArrayIter = _dereq_('./$.is-array-iter')\n  , anObject    = _dereq_('./$.an-object')\n  , toLength    = _dereq_('./$.to-length')\n  , getIterFn   = _dereq_('./core.get-iterator-method');\nmodule.exports = function(iterable, entries, fn, that){\n  var iterFn = getIterFn(iterable)\n    , f      = ctx(fn, that, entries ? 2 : 1)\n    , index  = 0\n    , length, step, iterator;\n  if(typeof iterFn != 'function')throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if(isArrayIter(iterFn))for(length = toLength(iterable.length); length > index; index++){\n    entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n  } else for(iterator = iterFn.call(iterable); !(step = iterator.next()).done; ){\n    call(iterator, f, step.value, entries);\n  }\n};\n},{\"./$.an-object\":43,\"./$.ctx\":50,\"./$.is-array-iter\":63,\"./$.iter-call\":65,\"./$.to-length\":90,\"./core.get-iterator-method\":94}],57:[function(_dereq_,module,exports){\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n},{}],58:[function(_dereq_,module,exports){\nvar hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n},{}],59:[function(_dereq_,module,exports){\nvar $          = _dereq_('./$')\n  , createDesc = _dereq_('./$.property-desc');\nmodule.exports = _dereq_('./$.descriptors') ? function(object, key, value){\n  return $.setDesc(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n},{\"./$\":71,\"./$.descriptors\":52,\"./$.property-desc\":76}],60:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./$.global').document && document.documentElement;\n},{\"./$.global\":57}],61:[function(_dereq_,module,exports){\n// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function(fn, args, that){\n  var un = that === undefined;\n  switch(args.length){\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return              fn.apply(that, args);\n};\n},{}],62:[function(_dereq_,module,exports){\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = _dereq_('./$.cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n},{\"./$.cof\":45}],63:[function(_dereq_,module,exports){\n// check on default Array iterator\nvar Iterators  = _dereq_('./$.iterators')\n  , ITERATOR   = _dereq_('./$.wks')('iterator')\n  , ArrayProto = Array.prototype;\n\nmodule.exports = function(it){\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n},{\"./$.iterators\":70,\"./$.wks\":93}],64:[function(_dereq_,module,exports){\nmodule.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n},{}],65:[function(_dereq_,module,exports){\n// call something on iterator step with safe closing on error\nvar anObject = _dereq_('./$.an-object');\nmodule.exports = function(iterator, fn, value, entries){\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch(e){\n    var ret = iterator['return'];\n    if(ret !== undefined)anObject(ret.call(iterator));\n    throw e;\n  }\n};\n},{\"./$.an-object\":43}],66:[function(_dereq_,module,exports){\n'use strict';\nvar $              = _dereq_('./$')\n  , descriptor     = _dereq_('./$.property-desc')\n  , setToStringTag = _dereq_('./$.set-to-string-tag')\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\n_dereq_('./$.hide')(IteratorPrototype, _dereq_('./$.wks')('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = $.create(IteratorPrototype, {next: descriptor(1, next)});\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n},{\"./$\":71,\"./$.hide\":59,\"./$.property-desc\":76,\"./$.set-to-string-tag\":82,\"./$.wks\":93}],67:[function(_dereq_,module,exports){\n'use strict';\nvar LIBRARY        = _dereq_('./$.library')\n  , $export        = _dereq_('./$.export')\n  , redefine       = _dereq_('./$.redefine')\n  , hide           = _dereq_('./$.hide')\n  , has            = _dereq_('./$.has')\n  , Iterators      = _dereq_('./$.iterators')\n  , $iterCreate    = _dereq_('./$.iter-create')\n  , setToStringTag = _dereq_('./$.set-to-string-tag')\n  , getProto       = _dereq_('./$').getProto\n  , ITERATOR       = _dereq_('./$.wks')('iterator')\n  , BUGGY          = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR    = '@@iterator'\n  , KEYS           = 'keys'\n  , VALUES         = 'values';\n\nvar returnThis = function(){ return this; };\n\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED){\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function(kind){\n    if(!BUGGY && kind in proto)return proto[kind];\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG        = NAME + ' Iterator'\n    , DEF_VALUES = DEFAULT == VALUES\n    , VALUES_BUG = false\n    , proto      = Base.prototype\n    , $native    = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , $default   = $native || getMethod(DEFAULT)\n    , methods, key;\n  // Fix native\n  if($native){\n    var IteratorPrototype = getProto($default.call(new Base));\n    // Set @@toStringTag to native iterators\n    setToStringTag(IteratorPrototype, TAG, true);\n    // FF fix\n    if(!LIBRARY && has(proto, FF_ITERATOR))hide(IteratorPrototype, ITERATOR, returnThis);\n    // fix Array#{values, @@iterator}.name in V8 / FF\n    if(DEF_VALUES && $native.name !== VALUES){\n      VALUES_BUG = true;\n      $default = function values(){ return $native.call(this); };\n    }\n  }\n  // Define iterator\n  if((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])){\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      values:  DEF_VALUES  ? $default : getMethod(VALUES),\n      keys:    IS_SET      ? $default : getMethod(KEYS),\n      entries: !DEF_VALUES ? $default : getMethod('entries')\n    };\n    if(FORCED)for(key in methods){\n      if(!(key in proto))redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n},{\"./$\":71,\"./$.export\":54,\"./$.has\":58,\"./$.hide\":59,\"./$.iter-create\":66,\"./$.iterators\":70,\"./$.library\":72,\"./$.redefine\":78,\"./$.set-to-string-tag\":82,\"./$.wks\":93}],68:[function(_dereq_,module,exports){\nvar ITERATOR     = _dereq_('./$.wks')('iterator')\n  , SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function(){ SAFE_CLOSING = true; };\n  Array.from(riter, function(){ throw 2; });\n} catch(e){ /* empty */ }\n\nmodule.exports = function(exec, skipClosing){\n  if(!skipClosing && !SAFE_CLOSING)return false;\n  var safe = false;\n  try {\n    var arr  = [7]\n      , iter = arr[ITERATOR]();\n    iter.next = function(){ return {done: safe = true}; };\n    arr[ITERATOR] = function(){ return iter; };\n    exec(arr);\n  } catch(e){ /* empty */ }\n  return safe;\n};\n},{\"./$.wks\":93}],69:[function(_dereq_,module,exports){\nmodule.exports = function(done, value){\n  return {value: value, done: !!done};\n};\n},{}],70:[function(_dereq_,module,exports){\nmodule.exports = {};\n},{}],71:[function(_dereq_,module,exports){\nvar $Object = Object;\nmodule.exports = {\n  create:     $Object.create,\n  getProto:   $Object.getPrototypeOf,\n  isEnum:     {}.propertyIsEnumerable,\n  getDesc:    $Object.getOwnPropertyDescriptor,\n  setDesc:    $Object.defineProperty,\n  setDescs:   $Object.defineProperties,\n  getKeys:    $Object.keys,\n  getNames:   $Object.getOwnPropertyNames,\n  getSymbols: $Object.getOwnPropertySymbols,\n  each:       [].forEach\n};\n},{}],72:[function(_dereq_,module,exports){\nmodule.exports = true;\n},{}],73:[function(_dereq_,module,exports){\nvar global    = _dereq_('./$.global')\n  , macrotask = _dereq_('./$.task').set\n  , Observer  = global.MutationObserver || global.WebKitMutationObserver\n  , process   = global.process\n  , Promise   = global.Promise\n  , isNode    = _dereq_('./$.cof')(process) == 'process'\n  , head, last, notify;\n\nvar flush = function(){\n  var parent, domain, fn;\n  if(isNode && (parent = process.domain)){\n    process.domain = null;\n    parent.exit();\n  }\n  while(head){\n    domain = head.domain;\n    fn     = head.fn;\n    if(domain)domain.enter();\n    fn(); // <- currently we use it only for Promise - try / catch not required\n    if(domain)domain.exit();\n    head = head.next;\n  } last = undefined;\n  if(parent)parent.enter();\n};\n\n// Node.js\nif(isNode){\n  notify = function(){\n    process.nextTick(flush);\n  };\n// browsers with MutationObserver\n} else if(Observer){\n  var toggle = 1\n    , node   = document.createTextNode('');\n  new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\n  notify = function(){\n    node.data = toggle = -toggle;\n  };\n// environments with maybe non-completely correct, but existent Promise\n} else if(Promise && Promise.resolve){\n  notify = function(){\n    Promise.resolve().then(flush);\n  };\n// for other environments - macrotask based on:\n// - setImmediate\n// - MessageChannel\n// - window.postMessag\n// - onreadystatechange\n// - setTimeout\n} else {\n  notify = function(){\n    // strange IE + webpack dev server bug - use .call(global)\n    macrotask.call(global, flush);\n  };\n}\n\nmodule.exports = function asap(fn){\n  var task = {fn: fn, next: undefined, domain: isNode && process.domain};\n  if(last)last.next = task;\n  if(!head){\n    head = task;\n    notify();\n  } last = task;\n};\n},{\"./$.cof\":45,\"./$.global\":57,\"./$.task\":87}],74:[function(_dereq_,module,exports){\n// 19.1.2.1 Object.assign(target, source, ...)\nvar $        = _dereq_('./$')\n  , toObject = _dereq_('./$.to-object')\n  , IObject  = _dereq_('./$.iobject');\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = _dereq_('./$.fails')(function(){\n  var a = Object.assign\n    , A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return a({}, A)[S] != 7 || Object.keys(a({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , $$    = arguments\n    , $$len = $$.length\n    , index = 1\n    , getKeys    = $.getKeys\n    , getSymbols = $.getSymbols\n    , isEnum     = $.isEnum;\n  while($$len > index){\n    var S      = IObject($$[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  }\n  return T;\n} : Object.assign;\n},{\"./$\":71,\"./$.fails\":55,\"./$.iobject\":62,\"./$.to-object\":91}],75:[function(_dereq_,module,exports){\n// most Object methods by ES6 should accept primitives\nvar $export = _dereq_('./$.export')\n  , core    = _dereq_('./$.core')\n  , fails   = _dereq_('./$.fails');\nmodule.exports = function(KEY, exec){\n  var fn  = (core.Object || {})[KEY] || Object[KEY]\n    , exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function(){ fn(1); }), 'Object', exp);\n};\n},{\"./$.core\":49,\"./$.export\":54,\"./$.fails\":55}],76:[function(_dereq_,module,exports){\nmodule.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n},{}],77:[function(_dereq_,module,exports){\nvar redefine = _dereq_('./$.redefine');\nmodule.exports = function(target, src){\n  for(var key in src)redefine(target, key, src[key]);\n  return target;\n};\n},{\"./$.redefine\":78}],78:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./$.hide');\n},{\"./$.hide\":59}],79:[function(_dereq_,module,exports){\n// 7.2.9 SameValue(x, y)\nmodule.exports = Object.is || function is(x, y){\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n},{}],80:[function(_dereq_,module,exports){\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar getDesc  = _dereq_('./$').getDesc\n  , isObject = _dereq_('./$.is-object')\n  , anObject = _dereq_('./$.an-object');\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function(test, buggy, set){\n      try {\n        set = _dereq_('./$.ctx')(Function.call, getDesc(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n},{\"./$\":71,\"./$.an-object\":43,\"./$.ctx\":50,\"./$.is-object\":64}],81:[function(_dereq_,module,exports){\n'use strict';\nvar core        = _dereq_('./$.core')\n  , $           = _dereq_('./$')\n  , DESCRIPTORS = _dereq_('./$.descriptors')\n  , SPECIES     = _dereq_('./$.wks')('species');\n\nmodule.exports = function(KEY){\n  var C = core[KEY];\n  if(DESCRIPTORS && C && !C[SPECIES])$.setDesc(C, SPECIES, {\n    configurable: true,\n    get: function(){ return this; }\n  });\n};\n},{\"./$\":71,\"./$.core\":49,\"./$.descriptors\":52,\"./$.wks\":93}],82:[function(_dereq_,module,exports){\nvar def = _dereq_('./$').setDesc\n  , has = _dereq_('./$.has')\n  , TAG = _dereq_('./$.wks')('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n};\n},{\"./$\":71,\"./$.has\":58,\"./$.wks\":93}],83:[function(_dereq_,module,exports){\nvar global = _dereq_('./$.global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n},{\"./$.global\":57}],84:[function(_dereq_,module,exports){\n// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject  = _dereq_('./$.an-object')\n  , aFunction = _dereq_('./$.a-function')\n  , SPECIES   = _dereq_('./$.wks')('species');\nmodule.exports = function(O, D){\n  var C = anObject(O).constructor, S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n},{\"./$.a-function\":41,\"./$.an-object\":43,\"./$.wks\":93}],85:[function(_dereq_,module,exports){\nmodule.exports = function(it, Constructor, name){\n  if(!(it instanceof Constructor))throw TypeError(name + \": use the 'new' operator!\");\n  return it;\n};\n},{}],86:[function(_dereq_,module,exports){\nvar toInteger = _dereq_('./$.to-integer')\n  , defined   = _dereq_('./$.defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n},{\"./$.defined\":51,\"./$.to-integer\":88}],87:[function(_dereq_,module,exports){\nvar ctx                = _dereq_('./$.ctx')\n  , invoke             = _dereq_('./$.invoke')\n  , html               = _dereq_('./$.html')\n  , cel                = _dereq_('./$.dom-create')\n  , global             = _dereq_('./$.global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listner = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(_dereq_('./$.cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listner;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listner, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};\n},{\"./$.cof\":45,\"./$.ctx\":50,\"./$.dom-create\":53,\"./$.global\":57,\"./$.html\":60,\"./$.invoke\":61}],88:[function(_dereq_,module,exports){\n// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n},{}],89:[function(_dereq_,module,exports){\n// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = _dereq_('./$.iobject')\n  , defined = _dereq_('./$.defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};\n},{\"./$.defined\":51,\"./$.iobject\":62}],90:[function(_dereq_,module,exports){\n// 7.1.15 ToLength\nvar toInteger = _dereq_('./$.to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n},{\"./$.to-integer\":88}],91:[function(_dereq_,module,exports){\n// 7.1.13 ToObject(argument)\nvar defined = _dereq_('./$.defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n},{\"./$.defined\":51}],92:[function(_dereq_,module,exports){\nvar id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n},{}],93:[function(_dereq_,module,exports){\nvar store  = _dereq_('./$.shared')('wks')\n  , uid    = _dereq_('./$.uid')\n  , Symbol = _dereq_('./$.global').Symbol;\nmodule.exports = function(name){\n  return store[name] || (store[name] =\n    Symbol && Symbol[name] || (Symbol || uid)('Symbol.' + name));\n};\n},{\"./$.global\":57,\"./$.shared\":83,\"./$.uid\":92}],94:[function(_dereq_,module,exports){\nvar classof   = _dereq_('./$.classof')\n  , ITERATOR  = _dereq_('./$.wks')('iterator')\n  , Iterators = _dereq_('./$.iterators');\nmodule.exports = _dereq_('./$.core').getIteratorMethod = function(it){\n  if(it != undefined)return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n},{\"./$.classof\":44,\"./$.core\":49,\"./$.iterators\":70,\"./$.wks\":93}],95:[function(_dereq_,module,exports){\nvar anObject = _dereq_('./$.an-object')\n  , get      = _dereq_('./core.get-iterator-method');\nmodule.exports = _dereq_('./$.core').getIterator = function(it){\n  var iterFn = get(it);\n  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n},{\"./$.an-object\":43,\"./$.core\":49,\"./core.get-iterator-method\":94}],96:[function(_dereq_,module,exports){\n'use strict';\nvar addToUnscopables = _dereq_('./$.add-to-unscopables')\n  , step             = _dereq_('./$.iter-step')\n  , Iterators        = _dereq_('./$.iterators')\n  , toIObject        = _dereq_('./$.to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = _dereq_('./$.iter-define')(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n},{\"./$.add-to-unscopables\":42,\"./$.iter-define\":67,\"./$.iter-step\":69,\"./$.iterators\":70,\"./$.to-iobject\":89}],97:[function(_dereq_,module,exports){\n// 19.1.3.1 Object.assign(target, source)\nvar $export = _dereq_('./$.export');\n\n$export($export.S + $export.F, 'Object', {assign: _dereq_('./$.object-assign')});\n},{\"./$.export\":54,\"./$.object-assign\":74}],98:[function(_dereq_,module,exports){\n// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = _dereq_('./$.to-iobject');\n\n_dereq_('./$.object-sap')('getOwnPropertyDescriptor', function($getOwnPropertyDescriptor){\n  return function getOwnPropertyDescriptor(it, key){\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n},{\"./$.object-sap\":75,\"./$.to-iobject\":89}],99:[function(_dereq_,module,exports){\n// 19.1.2.14 Object.keys(O)\nvar toObject = _dereq_('./$.to-object');\n\n_dereq_('./$.object-sap')('keys', function($keys){\n  return function keys(it){\n    return $keys(toObject(it));\n  };\n});\n},{\"./$.object-sap\":75,\"./$.to-object\":91}],100:[function(_dereq_,module,exports){\n// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = _dereq_('./$.export');\n$export($export.S, 'Object', {setPrototypeOf: _dereq_('./$.set-proto').set});\n},{\"./$.export\":54,\"./$.set-proto\":80}],101:[function(_dereq_,module,exports){\n\n},{}],102:[function(_dereq_,module,exports){\n'use strict';\nvar $          = _dereq_('./$')\n  , LIBRARY    = _dereq_('./$.library')\n  , global     = _dereq_('./$.global')\n  , ctx        = _dereq_('./$.ctx')\n  , classof    = _dereq_('./$.classof')\n  , $export    = _dereq_('./$.export')\n  , isObject   = _dereq_('./$.is-object')\n  , anObject   = _dereq_('./$.an-object')\n  , aFunction  = _dereq_('./$.a-function')\n  , strictNew  = _dereq_('./$.strict-new')\n  , forOf      = _dereq_('./$.for-of')\n  , setProto   = _dereq_('./$.set-proto').set\n  , same       = _dereq_('./$.same-value')\n  , SPECIES    = _dereq_('./$.wks')('species')\n  , speciesConstructor = _dereq_('./$.species-constructor')\n  , asap       = _dereq_('./$.microtask')\n  , PROMISE    = 'Promise'\n  , process    = global.process\n  , isNode     = classof(process) == 'process'\n  , P          = global[PROMISE]\n  , empty      = function(){ /* empty */ }\n  , Wrapper;\n\nvar testResolve = function(sub){\n  var test = new P(empty), promise;\n  if(sub)test.constructor = function(exec){\n    exec(empty, empty);\n  };\n  (promise = P.resolve(test))['catch'](empty);\n  return promise === test;\n};\n\nvar USE_NATIVE = function(){\n  var works = false;\n  function P2(x){\n    var self = new P(x);\n    setProto(self, P2.prototype);\n    return self;\n  }\n  try {\n    works = P && P.resolve && testResolve();\n    setProto(P2, P);\n    P2.prototype = $.create(P.prototype, {constructor: {value: P2}});\n    // actual Firefox has broken subclass support, test that\n    if(!(P2.resolve(5).then(function(){}) instanceof P2)){\n      works = false;\n    }\n    // actual V8 bug, https://code.google.com/p/v8/issues/detail?id=4162\n    if(works && _dereq_('./$.descriptors')){\n      var thenableThenGotten = false;\n      P.resolve($.setDesc({}, 'then', {\n        get: function(){ thenableThenGotten = true; }\n      }));\n      works = thenableThenGotten;\n    }\n  } catch(e){ works = false; }\n  return works;\n}();\n\n// helpers\nvar sameConstructor = function(a, b){\n  // library wrapper special case\n  if(LIBRARY && a === P && b === Wrapper)return true;\n  return same(a, b);\n};\nvar getConstructor = function(C){\n  var S = anObject(C)[SPECIES];\n  return S != undefined ? S : C;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar PromiseCapability = function(C){\n  var resolve, reject;\n  this.promise = new C(function($$resolve, $$reject){\n    if(resolve !== undefined || reject !== undefined)throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject  = $$reject;\n  });\n  this.resolve = aFunction(resolve),\n  this.reject  = aFunction(reject)\n};\nvar perform = function(exec){\n  try {\n    exec();\n  } catch(e){\n    return {error: e};\n  }\n};\nvar notify = function(record, isReject){\n  if(record.n)return;\n  record.n = true;\n  var chain = record.c;\n  asap(function(){\n    var value = record.v\n      , ok    = record.s == 1\n      , i     = 0;\n    var run = function(reaction){\n      var handler = ok ? reaction.ok : reaction.fail\n        , resolve = reaction.resolve\n        , reject  = reaction.reject\n        , result, then;\n      try {\n        if(handler){\n          if(!ok)record.h = true;\n          result = handler === true ? value : handler(value);\n          if(result === reaction.promise){\n            reject(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(result)){\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch(e){\n        reject(e);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    chain.length = 0;\n    record.n = false;\n    if(isReject)setTimeout(function(){\n      var promise = record.p\n        , handler, console;\n      if(isUnhandled(promise)){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      } record.a = undefined;\n    }, 1);\n  });\n};\nvar isUnhandled = function(promise){\n  var record = promise._d\n    , chain  = record.a || record.c\n    , i      = 0\n    , reaction;\n  if(record.h)return false;\n  while(chain.length > i){\n    reaction = chain[i++];\n    if(reaction.fail || !isUnhandled(reaction.promise))return false;\n  } return true;\n};\nvar $reject = function(value){\n  var record = this;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  record.v = value;\n  record.s = 2;\n  record.a = record.c.slice();\n  notify(record, true);\n};\nvar $resolve = function(value){\n  var record = this\n    , then;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  try {\n    if(record.p === value)throw TypeError(\"Promise can't be resolved itself\");\n    if(then = isThenable(value)){\n      asap(function(){\n        var wrapper = {r: record, d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      record.v = value;\n      record.s = 1;\n      notify(record, false);\n    }\n  } catch(e){\n    $reject.call({r: record, d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!USE_NATIVE){\n  // 25.4.3.1 Promise(executor)\n  P = function Promise(executor){\n    aFunction(executor);\n    var record = this._d = {\n      p: strictNew(this, P, PROMISE),         // <- promise\n      c: [],                                  // <- awaiting reactions\n      a: undefined,                           // <- checked in isUnhandled reactions\n      s: 0,                                   // <- state\n      d: false,                               // <- done\n      v: undefined,                           // <- value\n      h: false,                               // <- handled rejection\n      n: false                                // <- notify\n    };\n    try {\n      executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n    } catch(err){\n      $reject.call(record, err);\n    }\n  };\n  _dereq_('./$.redefine-all')(P.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var reaction = new PromiseCapability(speciesConstructor(this, P))\n        , promise  = reaction.promise\n        , record   = this._d;\n      reaction.ok   = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      record.c.push(reaction);\n      if(record.a)record.a.push(reaction);\n      if(record.s)notify(record, false);\n      return promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: P});\n_dereq_('./$.set-to-string-tag')(P, PROMISE);\n_dereq_('./$.set-species')(PROMISE);\nWrapper = _dereq_('./$.core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    var capability = new PromiseCapability(this)\n      , $$reject   = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (!USE_NATIVE || testResolve(true)), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if(x instanceof P && sameConstructor(x.constructor, this))return x;\n    var capability = new PromiseCapability(this)\n      , $$resolve  = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && _dereq_('./$.iter-detect')(function(iter){\n  P.all(iter)['catch'](function(){});\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C          = getConstructor(this)\n      , capability = new PromiseCapability(C)\n      , resolve    = capability.resolve\n      , reject     = capability.reject\n      , values     = [];\n    var abrupt = perform(function(){\n      forOf(iterable, false, values.push, values);\n      var remaining = values.length\n        , results   = Array(remaining);\n      if(remaining)$.each.call(values, function(promise, index){\n        var alreadyCalled = false;\n        C.resolve(promise).then(function(value){\n          if(alreadyCalled)return;\n          alreadyCalled = true;\n          results[index] = value;\n          --remaining || resolve(results);\n        }, reject);\n      });\n      else resolve(results);\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C          = getConstructor(this)\n      , capability = new PromiseCapability(C)\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  }\n});\n},{\"./$\":71,\"./$.a-function\":41,\"./$.an-object\":43,\"./$.classof\":44,\"./$.core\":49,\"./$.ctx\":50,\"./$.descriptors\":52,\"./$.export\":54,\"./$.for-of\":56,\"./$.global\":57,\"./$.is-object\":64,\"./$.iter-detect\":68,\"./$.library\":72,\"./$.microtask\":73,\"./$.redefine-all\":77,\"./$.same-value\":79,\"./$.set-proto\":80,\"./$.set-species\":81,\"./$.set-to-string-tag\":82,\"./$.species-constructor\":84,\"./$.strict-new\":85,\"./$.wks\":93}],103:[function(_dereq_,module,exports){\n'use strict';\nvar strong = _dereq_('./$.collection-strong');\n\n// 23.2 Set Objects\n_dereq_('./$.collection')('Set', function(get){\n  return function Set(){ return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.2.3.1 Set.prototype.add(value)\n  add: function add(value){\n    return strong.def(this, value = value === 0 ? 0 : value, value);\n  }\n}, strong);\n},{\"./$.collection\":48,\"./$.collection-strong\":46}],104:[function(_dereq_,module,exports){\n'use strict';\nvar $at  = _dereq_('./$.string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\n_dereq_('./$.iter-define')(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});\n},{\"./$.iter-define\":67,\"./$.string-at\":86}],105:[function(_dereq_,module,exports){\n// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export  = _dereq_('./$.export');\n\n$export($export.P, 'Set', {toJSON: _dereq_('./$.collection-to-json')('Set')});\n},{\"./$.collection-to-json\":47,\"./$.export\":54}],106:[function(_dereq_,module,exports){\n_dereq_('./es6.array.iterator');\nvar Iterators = _dereq_('./$.iterators');\nIterators.NodeList = Iterators.HTMLCollection = Iterators.Array;\n},{\"./$.iterators\":70,\"./es6.array.iterator\":96}],107:[function(_dereq_,module,exports){\n;(function(root) {\n  /**\n   * Constructs a new cross storage client given the url to a hub. By default,\n   * an iframe is created within the document body that points to the url. It\n   * also accepts an options object, which may include a timeout, frameId, and\n   * promise. The timeout, in milliseconds, is applied to each request and\n   * defaults to 5000ms. The options object may also include a frameId,\n   * identifying an existing frame on which to install its listeners. If the\n   * promise key is supplied the constructor for a Promise, that Promise library\n   * will be used instead of the default window.Promise.\n   *\n   * @example\n   * var storage = new CrossStorageClient('https://store.example.com/hub.html');\n   *\n   * @example\n   * var storage = new CrossStorageClient('https://store.example.com/hub.html', {\n   *   timeout: 5000,\n   *   frameId: 'storageFrame'\n   * });\n   *\n   * @constructor\n   *\n   * @param {string} url    The url to a cross storage hub\n   * @param {object} [opts] An optional object containing additional options,\n   *                        including timeout, frameId, and promise\n   *\n   * @property {string}   _id        A UUID v4 id\n   * @property {function} _promise   The Promise object to use\n   * @property {string}   _frameId   The id of the iFrame pointing to the hub url\n   * @property {string}   _origin    The hub's origin\n   * @property {object}   _requests  Mapping of request ids to callbacks\n   * @property {bool}     _connected Whether or not it has connected\n   * @property {bool}     _closed    Whether or not the client has closed\n   * @property {int}      _count     Number of requests sent\n   * @property {function} _listener  The listener added to the window\n   * @property {Window}   _hub       The hub window\n   */\n  function CrossStorageClient(url, opts) {\n    opts = opts || {};\n\n    this._id        = CrossStorageClient._generateUUID();\n    this._promise   = opts.promise || Promise;\n    this._frameId   = opts.frameId || 'CrossStorageClient-' + this._id;\n    this._origin    = CrossStorageClient._getOrigin(url);\n    this._requests  = {};\n    this._connected = false;\n    this._closed    = false;\n    this._count     = 0;\n    this._timeout   = opts.timeout || 5000;\n    this._listener  = null;\n\n    this._installListener();\n\n    var frame;\n    if (opts.frameId) {\n      frame = document.getElementById(opts.frameId);\n    }\n\n    // If using a passed iframe, poll the hub for a ready message\n    if (frame) {\n      this._poll();\n    }\n\n    // Create the frame if not found or specified\n    frame = frame || this._createFrame(url);\n    this._hub = frame.contentWindow;\n  }\n\n  /**\n   * The styles to be applied to the generated iFrame. Defines a set of properties\n   * that hide the element by positioning it outside of the visible area, and\n   * by modifying its display.\n   *\n   * @member {Object}\n   */\n  CrossStorageClient.frameStyle = {\n    display:  'none',\n    position: 'absolute',\n    top:      '-999px',\n    left:     '-999px'\n  };\n\n  /**\n   * Returns the origin of an url, with cross browser support. Accommodates\n   * the lack of location.origin in IE, as well as the discrepancies in the\n   * inclusion of the port when using the default port for a protocol, e.g.\n   * 443 over https. Defaults to the origin of window.location if passed a\n   * relative path.\n   *\n   * @param   {string} url The url to a cross storage hub\n   * @returns {string} The origin of the url\n   */\n  CrossStorageClient._getOrigin = function(url) {\n    var uri, protocol, origin;\n\n    uri = document.createElement('a');\n    uri.href = url;\n\n    if (!uri.host) {\n      uri = window.location;\n    }\n\n    if (!uri.protocol || uri.protocol === ':') {\n      protocol = window.location.protocol;\n    } else {\n      protocol = uri.protocol;\n    }\n\n    origin = protocol + '//' + uri.host;\n    origin = origin.replace(/:80$|:443$/, '');\n\n    return origin;\n  };\n\n  /**\n   * UUID v4 generation, taken from: http://stackoverflow.com/questions/\n   * 105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n   *\n   * @returns {string} A UUID v4 string\n   */\n  CrossStorageClient._generateUUID = function() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16|0, v = c == 'x' ? r : (r&0x3|0x8);\n\n      return v.toString(16);\n    });\n  };\n\n  /**\n   * Returns a promise that is fulfilled when a connection has been established\n   * with the cross storage hub. Its use is required to avoid sending any\n   * requests prior to initialization being complete.\n   *\n   * @returns {Promise} A promise that is resolved on connect\n   */\n  CrossStorageClient.prototype.onConnect = function() {\n    var client = this;\n\n    if (this._connected) {\n      return this._promise.resolve();\n    } else if (this._closed) {\n      return this._promise.reject(new Error('CrossStorageClient has closed'));\n    }\n\n    // Queue connect requests for client re-use\n    if (!this._requests.connect) {\n      this._requests.connect = [];\n    }\n\n    return new this._promise(function(resolve, reject) {\n      var timeout = setTimeout(function() {\n        reject(new Error('CrossStorageClient could not connect'));\n      }, client._timeout);\n\n      client._requests.connect.push(function(err) {\n        clearTimeout(timeout);\n        if (err) return reject(err);\n\n        resolve();\n      });\n    });\n  };\n\n  /**\n   * Sets a key to the specified value. Returns a promise that is fulfilled on\n   * success, or rejected if any errors setting the key occurred, or the request\n   * timed out.\n   *\n   * @param   {string}  key   The key to set\n   * @param   {*}       value The value to assign\n   * @returns {Promise} A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype.set = function(key, value) {\n    return this._request('set', {\n      key:   key,\n      value: value\n    });\n  };\n\n  /**\n   * Accepts one or more keys for which to retrieve their values. Returns a\n   * promise that is settled on hub response or timeout. On success, it is\n   * fulfilled with the value of the key if only passed a single argument.\n   * Otherwise it's resolved with an array of values. On failure, it is rejected\n   * with the corresponding error message.\n   *\n   * @param   {...string} key The key to retrieve\n   * @returns {Promise}   A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype.get = function(key) {\n    var args = Array.prototype.slice.call(arguments);\n\n    return this._request('get', {keys: args});\n  };\n\n  /**\n   * Accepts one or more keys for deletion. Returns a promise that is settled on\n   * hub response or timeout.\n   *\n   * @param   {...string} key The key to delete\n   * @returns {Promise}   A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype.del = function() {\n    var args = Array.prototype.slice.call(arguments);\n\n    return this._request('del', {keys: args});\n  };\n\n  /**\n   * Returns a promise that, when resolved, indicates that all localStorage\n   * data has been cleared.\n   *\n   * @returns {Promise} A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype.clear = function() {\n    return this._request('clear');\n  };\n\n  /**\n   * Returns a promise that, when resolved, passes an array of all keys\n   * currently in storage.\n   *\n   * @returns {Promise} A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype.getKeys = function() {\n    return this._request('getKeys');\n  };\n\n  /**\n   * Deletes the iframe and sets the connected state to false. The client can\n   * no longer be used after being invoked.\n   */\n  CrossStorageClient.prototype.close = function() {\n    var frame = document.getElementById(this._frameId);\n    if (frame) {\n      frame.parentNode.removeChild(frame);\n    }\n\n    // Support IE8 with detachEvent\n    if (window.removeEventListener) {\n      window.removeEventListener('message', this._listener, false);\n    } else {\n      window.detachEvent('onmessage', this._listener);\n    }\n\n    this._connected = false;\n    this._closed = true;\n  };\n\n  /**\n   * Installs the necessary listener for the window message event. When a message\n   * is received, the client's _connected status is changed to true, and the\n   * onConnect promise is fulfilled. Given a response message, the callback\n   * corresponding to its request is invoked. If response.error holds a truthy\n   * value, the promise associated with the original request is rejected with\n   * the error. Otherwise the promise is fulfilled and passed response.result.\n   *\n   * @private\n   */\n  CrossStorageClient.prototype._installListener = function() {\n    var client = this;\n\n    this._listener = function(message) {\n      var i, origin, error, response;\n\n      // Ignore invalid messages or those after the client has closed\n      if (client._closed || !message.data || typeof message.data !== 'string') {\n        return;\n      }\n\n      // postMessage returns the string \"null\" as the origin for \"file://\"\n      origin = (message.origin === 'null') ? 'file://' : message.origin;\n\n      // Ignore messages not from the correct origin\n      if (origin !== client._origin) return;\n\n      // LocalStorage isn't available in the hub\n      if (message.data === 'cross-storage:unavailable') {\n        if (!client._closed) client.close();\n        if (!client._requests.connect) return;\n\n        error = new Error('Closing client. Could not access localStorage in hub.');\n        for (i = 0; i < client._requests.connect.length; i++) {\n          client._requests.connect[i](error);\n        }\n\n        return;\n      }\n\n      // Handle initial connection\n      if (message.data.indexOf('cross-storage:') !== -1 && !client._connected) {\n        client._connected = true;\n        if (!client._requests.connect) return;\n\n        for (i = 0; i < client._requests.connect.length; i++) {\n          client._requests.connect[i](error);\n        }\n        delete client._requests.connect;\n      }\n\n      if (message.data === 'cross-storage:ready') return;\n\n      // All other messages\n      try {\n        response = JSON.parse(message.data);\n      } catch(e) {\n        return;\n      }\n\n      if (!response.id) return;\n\n      if (client._requests[response.id]) {\n        client._requests[response.id](response.error, response.result);\n      }\n    };\n\n    // Support IE8 with attachEvent\n    if (window.addEventListener) {\n      window.addEventListener('message', this._listener, false);\n    } else {\n      window.attachEvent('onmessage', this._listener);\n    }\n  };\n\n  /**\n   * Invoked when a frame id was passed to the client, rather than allowing\n   * the client to create its own iframe. Polls the hub for a ready event to\n   * establish a connected state.\n   */\n  CrossStorageClient.prototype._poll = function() {\n    var client, interval, targetOrigin;\n\n    client = this;\n\n    // postMessage requires that the target origin be set to \"*\" for \"file://\"\n    targetOrigin = (client._origin === 'file://') ? '*' : client._origin;\n\n    interval = setInterval(function() {\n      if (client._connected) return clearInterval(interval);\n      if (!client._hub) return;\n\n      client._hub.postMessage('cross-storage:poll', targetOrigin);\n    }, 1000);\n  };\n\n  /**\n   * Creates a new iFrame containing the hub. Applies the necessary styles to\n   * hide the element from view, prior to adding it to the document body.\n   * Returns the created element.\n   *\n   * @private\n   *\n   * @param  {string}            url The url to the hub\n   * returns {HTMLIFrameElement} The iFrame element itself\n   */\n  CrossStorageClient.prototype._createFrame = function(url) {\n    var frame, key;\n\n    frame = window.document.createElement('iframe');\n    frame.id = this._frameId;\n\n    // Style the iframe\n    for (key in CrossStorageClient.frameStyle) {\n      if (CrossStorageClient.frameStyle.hasOwnProperty(key)) {\n        frame.style[key] = CrossStorageClient.frameStyle[key];\n      }\n    }\n\n    window.document.body.appendChild(frame);\n    frame.src = url;\n\n    return frame;\n  };\n\n  /**\n   * Sends a message containing the given method and params to the hub. Stores\n   * a callback in the _requests object for later invocation on message, or\n   * deletion on timeout. Returns a promise that is settled in either instance.\n   *\n   * @private\n   *\n   * @param   {string}  method The method to invoke\n   * @param   {*}       params The arguments to pass\n   * @returns {Promise} A promise that is settled on hub response or timeout\n   */\n  CrossStorageClient.prototype._request = function(method, params) {\n    var req, client;\n\n    if (this._closed) {\n      return this._promise.reject(new Error('CrossStorageClient has closed'));\n    }\n\n    client = this;\n    client._count++;\n\n    req = {\n      id:     this._id + ':' + client._count,\n      method: 'cross-storage:' + method,\n      params: params\n    };\n\n    return new this._promise(function(resolve, reject) {\n      var timeout, originalToJSON, targetOrigin;\n\n      // Timeout if a response isn't received after 4s\n      timeout = setTimeout(function() {\n        if (!client._requests[req.id]) return;\n\n        delete client._requests[req.id];\n        reject(new Error('Timeout: could not perform ' + req.method));\n      }, client._timeout);\n\n      // Add request callback\n      client._requests[req.id] = function(err, result) {\n        clearTimeout(timeout);\n        delete client._requests[req.id];\n        if (err) return reject(new Error(err));\n        resolve(result);\n      };\n\n      // In case we have a broken Array.prototype.toJSON, e.g. because of\n      // old versions of prototype\n      if (Array.prototype.toJSON) {\n        originalToJSON = Array.prototype.toJSON;\n        Array.prototype.toJSON = null;\n      }\n\n      // postMessage requires that the target origin be set to \"*\" for \"file://\"\n      targetOrigin = (client._origin === 'file://') ? '*' : client._origin;\n\n      // Send serialized message\n      client._hub.postMessage(JSON.stringify(req), targetOrigin);\n\n      // Restore original toJSON\n      if (originalToJSON) {\n        Array.prototype.toJSON = originalToJSON;\n      }\n    });\n  };\n\n  /**\n   * Export for various environments.\n   */\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = CrossStorageClient;\n  } else if (typeof exports !== 'undefined') {\n    exports.CrossStorageClient = CrossStorageClient;\n  } else if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return CrossStorageClient;\n    });\n  } else {\n    root.CrossStorageClient = CrossStorageClient;\n  }\n}(this));\n\n},{}],108:[function(_dereq_,module,exports){\n;(function(root) {\n  var CrossStorageHub = {};\n\n  /**\n   * Accepts an array of objects with two keys: origin and allow. The value\n   * of origin is expected to be a RegExp, and allow, an array of strings.\n   * The cross storage hub is then initialized to accept requests from any of\n   * the matching origins, allowing access to the associated lists of methods.\n   * Methods may include any of: get, set, del, getKeys and clear. A 'ready'\n   * message is sent to the parent window once complete.\n   *\n   * @example\n   * // Subdomain can get, but only root domain can set and del\n   * CrossStorageHub.init([\n   *   {origin: /\\.example.com$/,        allow: ['get']},\n   *   {origin: /:(www\\.)?example.com$/, allow: ['get', 'set', 'del']}\n   * ]);\n   *\n   * @param {array} permissions An array of objects with origin and allow\n   */\n  CrossStorageHub.init = function(permissions) {\n    var available = true;\n\n    // Return if localStorage is unavailable, or third party\n    // access is disabled\n    try {\n      if (!window.localStorage) available = false;\n    } catch (e) {\n      available = false;\n    }\n\n    if (!available) {\n      try {\n        return window.parent.postMessage('cross-storage:unavailable', '*');\n      } catch (e) {\n        return;\n      }\n    }\n\n    CrossStorageHub._permissions = permissions || [];\n    CrossStorageHub._installListener();\n    window.parent.postMessage('cross-storage:ready', '*');\n  };\n\n  /**\n   * Installs the necessary listener for the window message event. Accommodates\n   * IE8 and up.\n   *\n   * @private\n   */\n  CrossStorageHub._installListener = function() {\n    var listener = CrossStorageHub._listener;\n    if (window.addEventListener) {\n      window.addEventListener('message', listener, false);\n    } else {\n      window.attachEvent('onmessage', listener);\n    }\n  };\n\n  /**\n   * The message handler for all requests posted to the window. It ignores any\n   * messages having an origin that does not match the originally supplied\n   * pattern. Given a JSON object with one of get, set, del or getKeys as the\n   * method, the function performs the requested action and returns its result.\n   *\n   * @param {MessageEvent} message A message to be processed\n   */\n  CrossStorageHub._listener = function(message) {\n    var origin, targetOrigin, request, method, error, result, response;\n\n    // postMessage returns the string \"null\" as the origin for \"file://\"\n    origin = (message.origin === 'null') ? 'file://' : message.origin;\n\n    // Handle polling for a ready message\n    if (message.data === 'cross-storage:poll') {\n      return window.parent.postMessage('cross-storage:ready', message.origin);\n    }\n\n    // Ignore the ready message when viewing the hub directly\n    if (message.data === 'cross-storage:ready') return;\n\n    // Check whether message.data is a valid json\n    try {\n      request = JSON.parse(message.data);\n    } catch (err) {\n      return;\n    }\n\n    // Check whether request.method is a string\n    if (!request || typeof request.method !== 'string') {\n      return;\n    }\n\n    method = request.method.split('cross-storage:')[1];\n\n    if (!method) {\n      return;\n    } else if (!CrossStorageHub._permitted(origin, method)) {\n      error = 'Invalid permissions for ' + method;\n    } else {\n      try {\n        result = CrossStorageHub['_' + method](request.params);\n      } catch (err) {\n        error = err.message;\n      }\n    }\n\n    response = JSON.stringify({\n      id: request.id,\n      error: error,\n      result: result\n    });\n\n    // postMessage requires that the target origin be set to \"*\" for \"file://\"\n    targetOrigin = (origin === 'file://') ? '*' : origin;\n\n    window.parent.postMessage(response, targetOrigin);\n  };\n\n  /**\n   * Returns a boolean indicating whether or not the requested method is\n   * permitted for the given origin. The argument passed to method is expected\n   * to be one of 'get', 'set', 'del' or 'getKeys'.\n   *\n   * @param   {string} origin The origin for which to determine permissions\n   * @param   {string} method Requested action\n   * @returns {bool}   Whether or not the request is permitted\n   */\n  CrossStorageHub._permitted = function(origin, method) {\n    var available, i, entry, match;\n\n    available = ['get', 'set', 'del', 'clear', 'getKeys'];\n    if (!CrossStorageHub._inArray(method, available)) {\n      return false;\n    }\n\n    for (i = 0; i < CrossStorageHub._permissions.length; i++) {\n      entry = CrossStorageHub._permissions[i];\n      if (!(entry.origin instanceof RegExp) || !(entry.allow instanceof Array)) {\n        continue;\n      }\n\n      match = entry.origin.test(origin);\n      if (match && CrossStorageHub._inArray(method, entry.allow)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  /**\n   * Sets a key to the specified value.\n   *\n   * @param {object} params An object with key and value\n   */\n  CrossStorageHub._set = function(params) {\n    window.localStorage.setItem(params.key, params.value);\n  };\n\n  /**\n   * Accepts an object with an array of keys for which to retrieve their values.\n   * Returns a single value if only one key was supplied, otherwise it returns\n   * an array. Any keys not set result in a null element in the resulting array.\n   *\n   * @param   {object} params An object with an array of keys\n   * @returns {*|*[]}  Either a single value, or an array\n   */\n  CrossStorageHub._get = function(params) {\n    var storage, result, i, value;\n\n    storage = window.localStorage;\n    result = [];\n\n    for (i = 0; i < params.keys.length; i++) {\n      try {\n        value = storage.getItem(params.keys[i]);\n      } catch (e) {\n        value = null;\n      }\n\n      result.push(value);\n    }\n\n    return (result.length > 1) ? result : result[0];\n  };\n\n  /**\n   * Deletes all keys specified in the array found at params.keys.\n   *\n   * @param {object} params An object with an array of keys\n   */\n  CrossStorageHub._del = function(params) {\n    for (var i = 0; i < params.keys.length; i++) {\n      window.localStorage.removeItem(params.keys[i]);\n    }\n  };\n\n  /**\n   * Clears localStorage.\n   */\n  CrossStorageHub._clear = function() {\n    window.localStorage.clear();\n  };\n\n  /**\n   * Returns an array of all keys stored in localStorage.\n   *\n   * @returns {string[]} The array of keys\n   */\n  CrossStorageHub._getKeys = function(params) {\n    var i, length, keys;\n\n    keys = [];\n    length = window.localStorage.length;\n\n    for (i = 0; i < length; i++) {\n      keys.push(window.localStorage.key(i));\n    }\n\n    return keys;\n  };\n\n  /**\n   * Returns whether or not a value is present in the array. Consists of an\n   * alternative to extending the array prototype for indexOf, since it's\n   * unavailable for IE8.\n   *\n   * @param   {*}    value The value to find\n   * @parma   {[]*}  array The array in which to search\n   * @returns {bool} Whether or not the value was found\n   */\n  CrossStorageHub._inArray = function(value, array) {\n    for (var i = 0; i < array.length; i++) {\n      if (value === array[i]) return true;\n    }\n\n    return false;\n  };\n\n  /**\n   * A cross-browser version of Date.now compatible with IE8 that avoids\n   * modifying the Date object.\n   *\n   * @return {int} The current timestamp in milliseconds\n   */\n  CrossStorageHub._now = function() {\n    if (typeof Date.now === 'function') {\n      return Date.now();\n    }\n\n    return new Date().getTime();\n  };\n\n  /**\n   * Export for various environments.\n   */\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = CrossStorageHub;\n  } else if (typeof exports !== 'undefined') {\n    exports.CrossStorageHub = CrossStorageHub;\n  } else if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return CrossStorageHub;\n    });\n  } else {\n    root.CrossStorageHub = CrossStorageHub;\n  }\n}(this));\n\n},{}],109:[function(_dereq_,module,exports){\nmodule.exports = {\n  CrossStorageClient: _dereq_('./client.js'),\n  CrossStorageHub:    _dereq_('./hub.js')\n};\n\n},{\"./client.js\":107,\"./hub.js\":108}],110:[function(_dereq_,module,exports){\n/*! (C) Andrea Giammarchi - @WebReflection - ISC Style License */\n(function(window,polyfill){\"use strict\";var document=window.document,Object=window.Object;var htmlClass=function(info){var catchClass=/^[A-Z]+[a-z]/,filterBy=function(re){var arr=[],tag;for(tag in register){if(re.test(tag))arr.push(tag)}return arr},add=function(Class,tag){tag=tag.toLowerCase();if(!(tag in register)){register[Class]=(register[Class]||[]).concat(tag);register[tag]=register[tag.toUpperCase()]=Class}},register=(Object.create||Object)(null),htmlClass={},i,section,tags,Class;for(section in info){for(Class in info[section]){tags=info[section][Class];register[Class]=tags;for(i=0;i<tags.length;i++){register[tags[i].toLowerCase()]=register[tags[i].toUpperCase()]=Class}}}htmlClass.get=function get(tagOrClass){return typeof tagOrClass===\"string\"?register[tagOrClass]||(catchClass.test(tagOrClass)?[]:\"\"):filterBy(tagOrClass)};htmlClass.set=function set(tag,Class){return catchClass.test(tag)?add(tag,Class):add(Class,tag),htmlClass};return htmlClass}({collections:{HTMLAllCollection:[\"all\"],HTMLCollection:[\"forms\"],HTMLFormControlsCollection:[\"elements\"],HTMLOptionsCollection:[\"options\"]},elements:{Element:[\"element\"],HTMLAnchorElement:[\"a\"],HTMLAppletElement:[\"applet\"],HTMLAreaElement:[\"area\"],HTMLAttachmentElement:[\"attachment\"],HTMLAudioElement:[\"audio\"],HTMLBRElement:[\"br\"],HTMLBaseElement:[\"base\"],HTMLBodyElement:[\"body\"],HTMLButtonElement:[\"button\"],HTMLCanvasElement:[\"canvas\"],HTMLContentElement:[\"content\"],HTMLDListElement:[\"dl\"],HTMLDataElement:[\"data\"],HTMLDataListElement:[\"datalist\"],HTMLDetailsElement:[\"details\"],HTMLDialogElement:[\"dialog\"],HTMLDirectoryElement:[\"dir\"],HTMLDivElement:[\"div\"],HTMLDocument:[\"document\"],HTMLElement:[\"element\",\"abbr\",\"address\",\"article\",\"aside\",\"b\",\"bdi\",\"bdo\",\"cite\",\"code\",\"command\",\"dd\",\"dfn\",\"dt\",\"em\",\"figcaption\",\"figure\",\"footer\",\"header\",\"i\",\"kbd\",\"mark\",\"nav\",\"noscript\",\"rp\",\"rt\",\"ruby\",\"s\",\"samp\",\"section\",\"small\",\"strong\",\"sub\",\"summary\",\"sup\",\"u\",\"var\",\"wbr\"],HTMLEmbedElement:[\"embed\"],HTMLFieldSetElement:[\"fieldset\"],HTMLFontElement:[\"font\"],HTMLFormElement:[\"form\"],HTMLFrameElement:[\"frame\"],HTMLFrameSetElement:[\"frameset\"],HTMLHRElement:[\"hr\"],HTMLHeadElement:[\"head\"],HTMLHeadingElement:[\"h1\",\"h2\",\"h3\",\"h4\",\"h5\",\"h6\"],HTMLHtmlElement:[\"html\"],HTMLIFrameElement:[\"iframe\"],HTMLImageElement:[\"img\"],HTMLInputElement:[\"input\"],HTMLKeygenElement:[\"keygen\"],HTMLLIElement:[\"li\"],HTMLLabelElement:[\"label\"],HTMLLegendElement:[\"legend\"],HTMLLinkElement:[\"link\"],HTMLMapElement:[\"map\"],HTMLMarqueeElement:[\"marquee\"],HTMLMediaElement:[\"media\"],HTMLMenuElement:[\"menu\"],HTMLMenuItemElement:[\"menuitem\"],HTMLMetaElement:[\"meta\"],HTMLMeterElement:[\"meter\"],HTMLModElement:[\"del\",\"ins\"],HTMLOListElement:[\"ol\"],HTMLObjectElement:[\"object\"],HTMLOptGroupElement:[\"optgroup\"],HTMLOptionElement:[\"option\"],HTMLOutputElement:[\"output\"],HTMLParagraphElement:[\"p\"],HTMLParamElement:[\"param\"],HTMLPictureElement:[\"picture\"],HTMLPreElement:[\"pre\"],HTMLProgressElement:[\"progress\"],HTMLQuoteElement:[\"blockquote\",\"q\",\"quote\"],HTMLScriptElement:[\"script\"],HTMLSelectElement:[\"select\"],HTMLShadowElement:[\"shadow\"],HTMLSlotElement:[\"slot\"],HTMLSourceElement:[\"source\"],HTMLSpanElement:[\"span\"],HTMLStyleElement:[\"style\"],HTMLTableCaptionElement:[\"caption\"],HTMLTableCellElement:[\"td\",\"th\"],HTMLTableColElement:[\"col\",\"colgroup\"],HTMLTableElement:[\"table\"],HTMLTableRowElement:[\"tr\"],HTMLTableSectionElement:[\"thead\",\"tbody\",\"tfoot\"],HTMLTemplateElement:[\"template\"],HTMLTextAreaElement:[\"textarea\"],HTMLTimeElement:[\"time\"],HTMLTitleElement:[\"title\"],HTMLTrackElement:[\"track\"],HTMLUListElement:[\"ul\"],HTMLUnknownElement:[\"unknown\",\"vhgroupv\",\"vkeygen\"],HTMLVideoElement:[\"video\"]},nodes:{Attr:[\"node\"],Audio:[\"audio\"],CDATASection:[\"node\"],CharacterData:[\"node\"],Comment:[\"#comment\"],Document:[\"#document\"],DocumentFragment:[\"#document-fragment\"],DocumentType:[\"node\"],HTMLDocument:[\"#document\"],Image:[\"img\"],Option:[\"option\"],ProcessingInstruction:[\"node\"],ShadowRoot:[\"#shadow-root\"],Text:[\"#text\"],XMLDocument:[\"xml\"]}});if(typeof polyfill!==\"object\")polyfill={type:polyfill||\"auto\"};var REGISTER_ELEMENT=\"registerElement\",EXPANDO_UID=\"__\"+REGISTER_ELEMENT+(window.Math.random()*1e5>>0),ADD_EVENT_LISTENER=\"addEventListener\",ATTACHED=\"attached\",CALLBACK=\"Callback\",DETACHED=\"detached\",EXTENDS=\"extends\",ATTRIBUTE_CHANGED_CALLBACK=\"attributeChanged\"+CALLBACK,ATTACHED_CALLBACK=ATTACHED+CALLBACK,CONNECTED_CALLBACK=\"connected\"+CALLBACK,DISCONNECTED_CALLBACK=\"disconnected\"+CALLBACK,CREATED_CALLBACK=\"created\"+CALLBACK,DETACHED_CALLBACK=DETACHED+CALLBACK,ADDITION=\"ADDITION\",MODIFICATION=\"MODIFICATION\",REMOVAL=\"REMOVAL\",DOM_ATTR_MODIFIED=\"DOMAttrModified\",DOM_CONTENT_LOADED=\"DOMContentLoaded\",DOM_SUBTREE_MODIFIED=\"DOMSubtreeModified\",PREFIX_TAG=\"<\",PREFIX_IS=\"=\",validName=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,invalidNames=[\"ANNOTATION-XML\",\"COLOR-PROFILE\",\"FONT-FACE\",\"FONT-FACE-SRC\",\"FONT-FACE-URI\",\"FONT-FACE-FORMAT\",\"FONT-FACE-NAME\",\"MISSING-GLYPH\"],types=[],protos=[],query=\"\",documentElement=document.documentElement,indexOf=types.indexOf||function(v){for(var i=this.length;i--&&this[i]!==v;){}return i},OP=Object.prototype,hOP=OP.hasOwnProperty,iPO=OP.isPrototypeOf,defineProperty=Object.defineProperty,empty=[],gOPD=Object.getOwnPropertyDescriptor,gOPN=Object.getOwnPropertyNames,gPO=Object.getPrototypeOf,sPO=Object.setPrototypeOf,hasProto=!!Object.__proto__,fixGetClass=false,DRECEV1=\"__dreCEv1\",customElements=window.customElements,usableCustomElements=!/^force/.test(polyfill.type)&&!!(customElements&&customElements.define&&customElements.get&&customElements.whenDefined),Dict=Object.create||Object,Map=window.Map||function Map(){var K=[],V=[],i;return{get:function(k){return V[indexOf.call(K,k)]},set:function(k,v){i=indexOf.call(K,k);if(i<0)V[K.push(k)-1]=v;else V[i]=v}}},Promise=window.Promise||function(fn){var notify=[],done=false,p={catch:function(){return p},then:function(cb){notify.push(cb);if(done)setTimeout(resolve,1);return p}};function resolve(value){done=true;while(notify.length)notify.shift()(value)}fn(resolve);return p},justCreated=false,constructors=Dict(null),waitingList=Dict(null),nodeNames=new Map,secondArgument=function(is){return is.toLowerCase()},create=Object.create||function Bridge(proto){return proto?(Bridge.prototype=proto,new Bridge):this},setPrototype=sPO||(hasProto?function(o,p){o.__proto__=p;return o}:gOPN&&gOPD?function(){function setProperties(o,p){for(var key,names=gOPN(p),i=0,length=names.length;i<length;i++){key=names[i];if(!hOP.call(o,key)){defineProperty(o,key,gOPD(p,key))}}}return function(o,p){do{setProperties(o,p)}while((p=gPO(p))&&!iPO.call(p,o));return o}}():function(o,p){for(var key in p){o[key]=p[key]}return o}),MutationObserver=window.MutationObserver||window.WebKitMutationObserver,HTMLElementPrototype=(window.HTMLElement||window.Element||window.Node).prototype,IE8=!iPO.call(HTMLElementPrototype,documentElement),safeProperty=IE8?function(o,k,d){o[k]=d.value;return o}:defineProperty,isValidNode=IE8?function(node){return node.nodeType===1}:function(node){return iPO.call(HTMLElementPrototype,node)},targets=IE8&&[],attachShadow=HTMLElementPrototype.attachShadow,cloneNode=HTMLElementPrototype.cloneNode,dispatchEvent=HTMLElementPrototype.dispatchEvent,getAttribute=HTMLElementPrototype.getAttribute,hasAttribute=HTMLElementPrototype.hasAttribute,removeAttribute=HTMLElementPrototype.removeAttribute,setAttribute=HTMLElementPrototype.setAttribute,createElement=document.createElement,patchedCreateElement=createElement,attributesObserver=MutationObserver&&{attributes:true,characterData:true,attributeOldValue:true},DOMAttrModified=MutationObserver||function(e){doesNotSupportDOMAttrModified=false;documentElement.removeEventListener(DOM_ATTR_MODIFIED,DOMAttrModified)},asapQueue,asapTimer=0,V0=REGISTER_ELEMENT in document&&!/^force-all/.test(polyfill.type),setListener=true,justSetup=false,doesNotSupportDOMAttrModified=true,dropDomContentLoaded=true,notFromInnerHTMLHelper=true,onSubtreeModified,callDOMAttrModified,getAttributesMirror,observer,observe,patchIfNotAlready,patch,tmp;if(MutationObserver){tmp=document.createElement(\"div\");tmp.innerHTML=\"<div><div></div></div>\";new MutationObserver(function(mutations,observer){if(mutations[0]&&mutations[0].type==\"childList\"&&!mutations[0].removedNodes[0].childNodes.length){tmp=gOPD(HTMLElementPrototype,\"innerHTML\");var set=tmp&&tmp.set;if(set)defineProperty(HTMLElementPrototype,\"innerHTML\",{set:function(value){while(this.lastChild)this.removeChild(this.lastChild);set.call(this,value)}})}observer.disconnect();tmp=null}).observe(tmp,{childList:true,subtree:true});tmp.innerHTML=\"\"}if(!V0){if(sPO||hasProto){patchIfNotAlready=function(node,proto){if(!iPO.call(proto,node)){setupNode(node,proto)}};patch=setupNode}else{patchIfNotAlready=function(node,proto){if(!node[EXPANDO_UID]){node[EXPANDO_UID]=Object(true);setupNode(node,proto)}};patch=patchIfNotAlready}if(IE8){doesNotSupportDOMAttrModified=false;(function(){var descriptor=gOPD(HTMLElementPrototype,ADD_EVENT_LISTENER),addEventListener=descriptor.value,patchedRemoveAttribute=function(name){var e=new CustomEvent(DOM_ATTR_MODIFIED,{bubbles:true});e.attrName=name;e.prevValue=getAttribute.call(this,name);e.newValue=null;e[REMOVAL]=e.attrChange=2;removeAttribute.call(this,name);dispatchEvent.call(this,e)},patchedSetAttribute=function(name,value){var had=hasAttribute.call(this,name),old=had&&getAttribute.call(this,name),e=new CustomEvent(DOM_ATTR_MODIFIED,{bubbles:true});setAttribute.call(this,name,value);e.attrName=name;e.prevValue=had?old:null;e.newValue=value;if(had){e[MODIFICATION]=e.attrChange=1}else{e[ADDITION]=e.attrChange=0}dispatchEvent.call(this,e)},onPropertyChange=function(e){var node=e.currentTarget,superSecret=node[EXPANDO_UID],propertyName=e.propertyName,event;if(superSecret.hasOwnProperty(propertyName)){superSecret=superSecret[propertyName];event=new CustomEvent(DOM_ATTR_MODIFIED,{bubbles:true});event.attrName=superSecret.name;event.prevValue=superSecret.value||null;event.newValue=superSecret.value=node[propertyName]||null;if(event.prevValue==null){event[ADDITION]=event.attrChange=0}else{event[MODIFICATION]=event.attrChange=1}dispatchEvent.call(node,event)}};descriptor.value=function(type,handler,capture){if(type===DOM_ATTR_MODIFIED&&this[ATTRIBUTE_CHANGED_CALLBACK]&&this.setAttribute!==patchedSetAttribute){this[EXPANDO_UID]={className:{name:\"class\",value:this.className}};this.setAttribute=patchedSetAttribute;this.removeAttribute=patchedRemoveAttribute;addEventListener.call(this,\"propertychange\",onPropertyChange)}addEventListener.call(this,type,handler,capture)};defineProperty(HTMLElementPrototype,ADD_EVENT_LISTENER,descriptor)})()}else if(!MutationObserver){documentElement[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED,DOMAttrModified);documentElement.setAttribute(EXPANDO_UID,1);documentElement.removeAttribute(EXPANDO_UID);if(doesNotSupportDOMAttrModified){onSubtreeModified=function(e){var node=this,oldAttributes,newAttributes,key;if(node===e.target){oldAttributes=node[EXPANDO_UID];node[EXPANDO_UID]=newAttributes=getAttributesMirror(node);for(key in newAttributes){if(!(key in oldAttributes)){return callDOMAttrModified(0,node,key,oldAttributes[key],newAttributes[key],ADDITION)}else if(newAttributes[key]!==oldAttributes[key]){return callDOMAttrModified(1,node,key,oldAttributes[key],newAttributes[key],MODIFICATION)}}for(key in oldAttributes){if(!(key in newAttributes)){return callDOMAttrModified(2,node,key,oldAttributes[key],newAttributes[key],REMOVAL)}}}};callDOMAttrModified=function(attrChange,currentTarget,attrName,prevValue,newValue,action){var e={attrChange:attrChange,currentTarget:currentTarget,attrName:attrName,prevValue:prevValue,newValue:newValue};e[action]=attrChange;onDOMAttrModified(e)};getAttributesMirror=function(node){for(var attr,name,result={},attributes=node.attributes,i=0,length=attributes.length;i<length;i++){attr=attributes[i];name=attr.name;if(name!==\"setAttribute\"){result[name]=attr.value}}return result}}}document[REGISTER_ELEMENT]=function registerElement(type,options){upperType=type.toUpperCase();if(setListener){setListener=false;if(MutationObserver){observer=function(attached,detached){function checkEmAll(list,callback){for(var i=0,length=list.length;i<length;callback(list[i++])){}}return new MutationObserver(function(records){for(var current,node,newValue,i=0,length=records.length;i<length;i++){current=records[i];if(current.type===\"childList\"){checkEmAll(current.addedNodes,attached);checkEmAll(current.removedNodes,detached)}else{node=current.target;if(notFromInnerHTMLHelper&&node[ATTRIBUTE_CHANGED_CALLBACK]&&current.attributeName!==\"style\"){newValue=getAttribute.call(node,current.attributeName);if(newValue!==current.oldValue){node[ATTRIBUTE_CHANGED_CALLBACK](current.attributeName,current.oldValue,newValue)}}}}})}(executeAction(ATTACHED),executeAction(DETACHED));observe=function(node){observer.observe(node,{childList:true,subtree:true});return node};observe(document);if(attachShadow){HTMLElementPrototype.attachShadow=function(){return observe(attachShadow.apply(this,arguments))}}}else{asapQueue=[];document[ADD_EVENT_LISTENER](\"DOMNodeInserted\",onDOMNode(ATTACHED));document[ADD_EVENT_LISTENER](\"DOMNodeRemoved\",onDOMNode(DETACHED))}document[ADD_EVENT_LISTENER](DOM_CONTENT_LOADED,onReadyStateChange);document[ADD_EVENT_LISTENER](\"readystatechange\",onReadyStateChange);HTMLElementPrototype.cloneNode=function(deep){var node=cloneNode.call(this,!!deep),i=getTypeIndex(node);if(-1<i)patch(node,protos[i]);if(deep&&query.length)loopAndSetup(node.querySelectorAll(query));return node}}if(justSetup)return justSetup=false;if(-2<indexOf.call(types,PREFIX_IS+upperType)+indexOf.call(types,PREFIX_TAG+upperType)){throwTypeError(type)}if(!validName.test(upperType)||-1<indexOf.call(invalidNames,upperType)){throw new Error(\"The type \"+type+\" is invalid\")}var constructor=function(){return extending?document.createElement(nodeName,upperType):document.createElement(nodeName)},opt=options||OP,extending=hOP.call(opt,EXTENDS),nodeName=extending?options[EXTENDS].toUpperCase():upperType,upperType,i;if(extending&&-1<indexOf.call(types,PREFIX_TAG+nodeName)){throwTypeError(nodeName)}i=types.push((extending?PREFIX_IS:PREFIX_TAG)+upperType)-1;query=query.concat(query.length?\",\":\"\",extending?nodeName+'[is=\"'+type.toLowerCase()+'\"]':nodeName);constructor.prototype=protos[i]=hOP.call(opt,\"prototype\")?opt.prototype:create(HTMLElementPrototype);if(query.length)loopAndVerify(document.querySelectorAll(query),ATTACHED);return constructor};document.createElement=patchedCreateElement=function(localName,typeExtension){var is=getIs(typeExtension),node=is?createElement.call(document,localName,secondArgument(is)):createElement.call(document,localName),name=\"\"+localName,i=indexOf.call(types,(is?PREFIX_IS:PREFIX_TAG)+(is||name).toUpperCase()),setup=-1<i;if(is){node.setAttribute(\"is\",is=is.toLowerCase());if(setup){setup=isInQSA(name.toUpperCase(),is)}}notFromInnerHTMLHelper=!document.createElement.innerHTMLHelper;if(setup)patch(node,protos[i]);return node}}function ASAP(){var queue=asapQueue.splice(0,asapQueue.length);asapTimer=0;while(queue.length){queue.shift().call(null,queue.shift())}}function loopAndVerify(list,action){for(var i=0,length=list.length;i<length;i++){verifyAndSetupAndAction(list[i],action)}}function loopAndSetup(list){for(var i=0,length=list.length,node;i<length;i++){node=list[i];patch(node,protos[getTypeIndex(node)])}}function executeAction(action){return function(node){if(isValidNode(node)){verifyAndSetupAndAction(node,action);if(query.length)loopAndVerify(node.querySelectorAll(query),action)}}}function getTypeIndex(target){var is=getAttribute.call(target,\"is\"),nodeName=target.nodeName.toUpperCase(),i=indexOf.call(types,is?PREFIX_IS+is.toUpperCase():PREFIX_TAG+nodeName);return is&&-1<i&&!isInQSA(nodeName,is)?-1:i}function isInQSA(name,type){return-1<query.indexOf(name+'[is=\"'+type+'\"]')}function onDOMAttrModified(e){var node=e.currentTarget,attrChange=e.attrChange,attrName=e.attrName,target=e.target,addition=e[ADDITION]||2,removal=e[REMOVAL]||3;if(notFromInnerHTMLHelper&&(!target||target===node)&&node[ATTRIBUTE_CHANGED_CALLBACK]&&attrName!==\"style\"&&(e.prevValue!==e.newValue||e.newValue===\"\"&&(attrChange===addition||attrChange===removal))){node[ATTRIBUTE_CHANGED_CALLBACK](attrName,attrChange===addition?null:e.prevValue,attrChange===removal?null:e.newValue)}}function onDOMNode(action){var executor=executeAction(action);return function(e){asapQueue.push(executor,e.target);if(asapTimer)clearTimeout(asapTimer);asapTimer=setTimeout(ASAP,1)}}function onReadyStateChange(e){if(dropDomContentLoaded){dropDomContentLoaded=false;e.currentTarget.removeEventListener(DOM_CONTENT_LOADED,onReadyStateChange)}if(query.length)loopAndVerify((e.target||document).querySelectorAll(query),e.detail===DETACHED?DETACHED:ATTACHED);if(IE8)purge()}function patchedSetAttribute(name,value){var self=this;setAttribute.call(self,name,value);onSubtreeModified.call(self,{target:self})}function setupNode(node,proto){setPrototype(node,proto);if(observer){observer.observe(node,attributesObserver)}else{if(doesNotSupportDOMAttrModified){node.setAttribute=patchedSetAttribute;node[EXPANDO_UID]=getAttributesMirror(node);node[ADD_EVENT_LISTENER](DOM_SUBTREE_MODIFIED,onSubtreeModified)}node[ADD_EVENT_LISTENER](DOM_ATTR_MODIFIED,onDOMAttrModified)}if(node[CREATED_CALLBACK]&&notFromInnerHTMLHelper){node.created=true;node[CREATED_CALLBACK]();node.created=false}}function purge(){for(var node,i=0,length=targets.length;i<length;i++){node=targets[i];if(!documentElement.contains(node)){length--;targets.splice(i--,1);verifyAndSetupAndAction(node,DETACHED)}}}function throwTypeError(type){throw new Error(\"A \"+type+\" type is already registered\")}function verifyAndSetupAndAction(node,action){var fn,i=getTypeIndex(node),counterAction;if(-1<i){patchIfNotAlready(node,protos[i]);i=0;if(action===ATTACHED&&!node[ATTACHED]){node[DETACHED]=false;node[ATTACHED]=true;counterAction=\"connected\";i=1;if(IE8&&indexOf.call(targets,node)<0){targets.push(node)}}else if(action===DETACHED&&!node[DETACHED]){node[ATTACHED]=false;node[DETACHED]=true;counterAction=\"disconnected\";i=1}if(i&&(fn=node[action+CALLBACK]||node[counterAction+CALLBACK]))fn.call(node)}}function CustomElementRegistry(){}CustomElementRegistry.prototype={constructor:CustomElementRegistry,define:usableCustomElements?function(name,Class,options){if(options){CERDefine(name,Class,options)}else{var NAME=name.toUpperCase();constructors[NAME]={constructor:Class,create:[NAME]};nodeNames.set(Class,NAME);customElements.define(name,Class)}}:CERDefine,get:usableCustomElements?function(name){return customElements.get(name)||get(name)}:get,whenDefined:usableCustomElements?function(name){return Promise.race([customElements.whenDefined(name),whenDefined(name)])}:whenDefined};function CERDefine(name,Class,options){var is=options&&options[EXTENDS]||\"\",CProto=Class.prototype,proto=create(CProto),attributes=Class.observedAttributes||empty,definition={prototype:proto};safeProperty(proto,CREATED_CALLBACK,{value:function(){if(justCreated)justCreated=false;else if(!this[DRECEV1]){this[DRECEV1]=true;new Class(this);if(CProto[CREATED_CALLBACK])CProto[CREATED_CALLBACK].call(this);var info=constructors[nodeNames.get(Class)];if(!usableCustomElements||info.create.length>1){notifyAttributes(this)}}}});safeProperty(proto,ATTRIBUTE_CHANGED_CALLBACK,{value:function(name){if(-1<indexOf.call(attributes,name))CProto[ATTRIBUTE_CHANGED_CALLBACK].apply(this,arguments)}});if(CProto[CONNECTED_CALLBACK]){safeProperty(proto,ATTACHED_CALLBACK,{value:CProto[CONNECTED_CALLBACK]})}if(CProto[DISCONNECTED_CALLBACK]){safeProperty(proto,DETACHED_CALLBACK,{value:CProto[DISCONNECTED_CALLBACK]})}if(is)definition[EXTENDS]=is;name=name.toUpperCase();constructors[name]={constructor:Class,create:is?[is,secondArgument(name)]:[name]};nodeNames.set(Class,name);document[REGISTER_ELEMENT](name.toLowerCase(),definition);whenDefined(name);waitingList[name].r()}function get(name){var info=constructors[name.toUpperCase()];return info&&info.constructor}function getIs(options){return typeof options===\"string\"?options:options&&options.is||\"\"}function notifyAttributes(self){var callback=self[ATTRIBUTE_CHANGED_CALLBACK],attributes=callback?self.attributes:empty,i=attributes.length,attribute;while(i--){attribute=attributes[i];callback.call(self,attribute.name||attribute.nodeName,null,attribute.value||attribute.nodeValue)}}function whenDefined(name){name=name.toUpperCase();if(!(name in waitingList)){waitingList[name]={};waitingList[name].p=new Promise(function(resolve){waitingList[name].r=resolve})}return waitingList[name].p}function polyfillV1(){if(customElements)delete window.customElements;defineProperty(window,\"customElements\",{configurable:true,value:new CustomElementRegistry});defineProperty(window,\"CustomElementRegistry\",{configurable:true,value:CustomElementRegistry});for(var patchClass=function(name){var Class=window[name];if(Class){window[name]=function CustomElementsV1(self){var info,isNative;if(!self)self=this;if(!self[DRECEV1]){justCreated=true;info=constructors[nodeNames.get(self.constructor)];isNative=usableCustomElements&&info.create.length===1;self=isNative?Reflect.construct(Class,empty,info.constructor):document.createElement.apply(document,info.create);self[DRECEV1]=true;justCreated=false;if(!isNative)notifyAttributes(self)}return self};window[name].prototype=Class.prototype;try{Class.prototype.constructor=window[name]}catch(WebKit){fixGetClass=true;defineProperty(Class,DRECEV1,{value:window[name]})}}},Classes=htmlClass.get(/^HTML[A-Z]*[a-z]/),i=Classes.length;i--;patchClass(Classes[i])){}document.createElement=function(name,options){var is=getIs(options);return is?patchedCreateElement.call(this,name,secondArgument(is)):patchedCreateElement.call(this,name)};if(!V0){justSetup=true;document[REGISTER_ELEMENT](\"\")}}if(!customElements||/^force/.test(polyfill.type))polyfillV1();else if(!polyfill.noBuiltIn){try{(function(DRE,options,name){var re=new RegExp(\"^<a\\\\s+is=('|\\\")\"+name+\"\\\\1></a>$\");options[EXTENDS]=\"a\";DRE.prototype=create(HTMLAnchorElement.prototype);DRE.prototype.constructor=DRE;window.customElements.define(name,DRE,options);if(!re.test(document.createElement(\"a\",{is:name}).outerHTML)||!re.test((new DRE).outerHTML)){throw options}})(function DRE(){return Reflect.construct(HTMLAnchorElement,[],DRE)},{},\"document-register-element-a\")}catch(o_O){polyfillV1()}}if(!polyfill.noBuiltIn){try{createElement.call(document,\"a\",\"a\")}catch(FireFox){secondArgument=function(is){return{is:is.toLowerCase()}}}}})(window);\n\n},{}],111:[function(_dereq_,module,exports){\n'use strict';\n\nvar isCallable = _dereq_('is-callable');\n\nvar toStr = Object.prototype.toString;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar forEachArray = function forEachArray(array, iterator, receiver) {\n    for (var i = 0, len = array.length; i < len; i++) {\n        if (hasOwnProperty.call(array, i)) {\n            if (receiver == null) {\n                iterator(array[i], i, array);\n            } else {\n                iterator.call(receiver, array[i], i, array);\n            }\n        }\n    }\n};\n\nvar forEachString = function forEachString(string, iterator, receiver) {\n    for (var i = 0, len = string.length; i < len; i++) {\n        // no such thing as a sparse string.\n        if (receiver == null) {\n            iterator(string.charAt(i), i, string);\n        } else {\n            iterator.call(receiver, string.charAt(i), i, string);\n        }\n    }\n};\n\nvar forEachObject = function forEachObject(object, iterator, receiver) {\n    for (var k in object) {\n        if (hasOwnProperty.call(object, k)) {\n            if (receiver == null) {\n                iterator(object[k], k, object);\n            } else {\n                iterator.call(receiver, object[k], k, object);\n            }\n        }\n    }\n};\n\nvar forEach = function forEach(list, iterator, thisArg) {\n    if (!isCallable(iterator)) {\n        throw new TypeError('iterator must be a function');\n    }\n\n    var receiver;\n    if (arguments.length >= 3) {\n        receiver = thisArg;\n    }\n\n    if (toStr.call(list) === '[object Array]') {\n        forEachArray(list, iterator, receiver);\n    } else if (typeof list === 'string') {\n        forEachString(list, iterator, receiver);\n    } else {\n        forEachObject(list, iterator, receiver);\n    }\n};\n\nmodule.exports = forEach;\n\n},{\"is-callable\":114}],112:[function(_dereq_,module,exports){\n(function (global){\nvar win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{}],113:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\n\n\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof commonjsGlobal !== \"undefined\") {\n    win = commonjsGlobal;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nvar window_1 = win;\n\nvar isFunction_1 = isFunction;\n\nvar toString = Object.prototype.toString;\n\nfunction isFunction (fn) {\n  var string = toString.call(fn);\n  return string === '[object Function]' ||\n    (typeof fn === 'function' && string !== '[object RegExp]') ||\n    (typeof window !== 'undefined' &&\n     // IE8 and below\n     (fn === window.setTimeout ||\n      fn === window.alert ||\n      fn === window.confirm ||\n      fn === window.prompt))\n}\n\nvar trim_1 = createCommonjsModule(function (module, exports) {\nexports = module.exports = trim;\n\nfunction trim(str){\n  return str.replace(/^\\s*|\\s*$/g, '');\n}\n\nexports.left = function(str){\n  return str.replace(/^\\s*/, '');\n};\n\nexports.right = function(str){\n  return str.replace(/\\s*$/, '');\n};\n});\n\nvar forEach_1 = forEach;\n\nvar toString$1 = Object.prototype.toString;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction forEach(list, iterator, context) {\n    if (!isFunction_1(iterator)) {\n        throw new TypeError('iterator must be a function')\n    }\n\n    if (arguments.length < 3) {\n        context = this;\n    }\n    \n    if (toString$1.call(list) === '[object Array]')\n        forEachArray$1(list, iterator, context);\n    else if (typeof list === 'string')\n        forEachString(list, iterator, context);\n    else\n        forEachObject(list, iterator, context);\n}\n\nfunction forEachArray$1(array, iterator, context) {\n    for (var i = 0, len = array.length; i < len; i++) {\n        if (hasOwnProperty.call(array, i)) {\n            iterator.call(context, array[i], i, array);\n        }\n    }\n}\n\nfunction forEachString(string, iterator, context) {\n    for (var i = 0, len = string.length; i < len; i++) {\n        // no such thing as a sparse string.\n        iterator.call(context, string.charAt(i), i, string);\n    }\n}\n\nfunction forEachObject(object, iterator, context) {\n    for (var k in object) {\n        if (hasOwnProperty.call(object, k)) {\n            iterator.call(context, object[k], k, object);\n        }\n    }\n}\n\nvar isArray = function(arg) {\n      return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n\nvar parseHeaders = function (headers) {\n  if (!headers)\n    return {}\n\n  var result = {};\n\n  forEach_1(\n      trim_1(headers).split('\\n')\n    , function (row) {\n        var index = row.indexOf(':')\n          , key = trim_1(row.slice(0, index)).toLowerCase()\n          , value = trim_1(row.slice(index + 1));\n\n        if (typeof(result[key]) === 'undefined') {\n          result[key] = value;\n        } else if (isArray(result[key])) {\n          result[key].push(value);\n        } else {\n          result[key] = [ result[key], value ];\n        }\n      }\n  );\n\n  return result\n};\n\nvar immutable = extend;\n\nvar hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {};\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n            if (hasOwnProperty$1.call(source, key)) {\n                target[key] = source[key];\n            }\n        }\n    }\n\n    return target\n}\n\n\"use strict\";\n\n\n\n\n\nvar xhr = createXHR;\n// Allow use of default import syntax in TypeScript\nvar default_1 = createXHR;\ncreateXHR.XMLHttpRequest = window_1.XMLHttpRequest || noop;\ncreateXHR.XDomainRequest = \"withCredentials\" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window_1.XDomainRequest;\n\nforEachArray([\"get\", \"put\", \"post\", \"patch\", \"head\", \"delete\"], function(method) {\n    createXHR[method === \"delete\" ? \"del\" : method] = function(uri, options, callback) {\n        options = initParams(uri, options, callback);\n        options.method = method.toUpperCase();\n        return _createXHR(options)\n    };\n});\n\nfunction forEachArray(array, iterator) {\n    for (var i = 0; i < array.length; i++) {\n        iterator(array[i]);\n    }\n}\n\nfunction isEmpty(obj){\n    for(var i in obj){\n        if(obj.hasOwnProperty(i)) return false\n    }\n    return true\n}\n\nfunction initParams(uri, options, callback) {\n    var params = uri;\n\n    if (isFunction_1(options)) {\n        callback = options;\n        if (typeof uri === \"string\") {\n            params = {uri:uri};\n        }\n    } else {\n        params = immutable(options, {uri: uri});\n    }\n\n    params.callback = callback;\n    return params\n}\n\nfunction createXHR(uri, options, callback) {\n    options = initParams(uri, options, callback);\n    return _createXHR(options)\n}\n\nfunction _createXHR(options) {\n    if(typeof options.callback === \"undefined\"){\n        throw new Error(\"callback argument missing\")\n    }\n\n    var called = false;\n    var callback = function cbOnce(err, response, body){\n        if(!called){\n            called = true;\n            options.callback(err, response, body);\n        }\n    };\n\n    function readystatechange() {\n        if (xhr.readyState === 4) {\n            setTimeout(loadFunc, 0);\n        }\n    }\n\n    function getBody() {\n        // Chrome with requestType=blob throws errors arround when even testing access to responseText\n        var body = undefined;\n\n        if (xhr.response) {\n            body = xhr.response;\n        } else {\n            body = xhr.responseText || getXml(xhr);\n        }\n\n        if (isJson) {\n            try {\n                body = JSON.parse(body);\n            } catch (e) {}\n        }\n\n        return body\n    }\n\n    function errorFunc(evt) {\n        clearTimeout(timeoutTimer);\n        if(!(evt instanceof Error)){\n            evt = new Error(\"\" + (evt || \"Unknown XMLHttpRequest Error\") );\n        }\n        evt.statusCode = 0;\n        return callback(evt, failureResponse)\n    }\n\n    // will load the data & process the response in a special response object\n    function loadFunc() {\n        if (aborted) return\n        var status;\n        clearTimeout(timeoutTimer);\n        if(options.useXDR && xhr.status===undefined) {\n            //IE8 CORS GET successful response doesn't have a status field, but body is fine\n            status = 200;\n        } else {\n            status = (xhr.status === 1223 ? 204 : xhr.status);\n        }\n        var response = failureResponse;\n        var err = null;\n\n        if (status !== 0){\n            response = {\n                body: getBody(),\n                statusCode: status,\n                method: method,\n                headers: {},\n                url: uri,\n                rawRequest: xhr\n            };\n            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE\n                response.headers = parseHeaders(xhr.getAllResponseHeaders());\n            }\n        } else {\n            err = new Error(\"Internal XMLHttpRequest Error\");\n        }\n        return callback(err, response, response.body)\n    }\n\n    var xhr = options.xhr || null;\n\n    if (!xhr) {\n        if (options.cors || options.useXDR) {\n            xhr = new createXHR.XDomainRequest();\n        }else{\n            xhr = new createXHR.XMLHttpRequest();\n        }\n    }\n\n    var key;\n    var aborted;\n    var uri = xhr.url = options.uri || options.url;\n    var method = xhr.method = options.method || \"GET\";\n    var body = options.body || options.data;\n    var headers = xhr.headers = options.headers || {};\n    var sync = !!options.sync;\n    var isJson = false;\n    var timeoutTimer;\n    var failureResponse = {\n        body: undefined,\n        headers: {},\n        statusCode: 0,\n        method: method,\n        url: uri,\n        rawRequest: xhr\n    };\n\n    if (\"json\" in options && options.json !== false) {\n        isJson = true;\n        headers[\"accept\"] || headers[\"Accept\"] || (headers[\"Accept\"] = \"application/json\"); //Don't override existing accept header declared by user\n        if (method !== \"GET\" && method !== \"HEAD\") {\n            headers[\"content-type\"] || headers[\"Content-Type\"] || (headers[\"Content-Type\"] = \"application/json\"); //Don't override existing accept header declared by user\n            body = JSON.stringify(options.json === true ? body : options.json);\n        }\n    }\n\n    xhr.onreadystatechange = readystatechange;\n    xhr.onload = loadFunc;\n    xhr.onerror = errorFunc;\n    // IE9 must have onprogress be set to a unique function.\n    xhr.onprogress = function () {\n        // IE must die\n    };\n    xhr.onabort = function(){\n        aborted = true;\n    };\n    xhr.ontimeout = errorFunc;\n    xhr.open(method, uri, !sync, options.username, options.password);\n    //has to be after open\n    if(!sync) {\n        xhr.withCredentials = !!options.withCredentials;\n    }\n    // Cannot set timeout with sync request\n    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly\n    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent\n    if (!sync && options.timeout > 0 ) {\n        timeoutTimer = setTimeout(function(){\n            if (aborted) return\n            aborted = true;//IE9 may still call readystatechange\n            xhr.abort(\"timeout\");\n            var e = new Error(\"XMLHttpRequest timeout\");\n            e.code = \"ETIMEDOUT\";\n            errorFunc(e);\n        }, options.timeout );\n    }\n\n    if (xhr.setRequestHeader) {\n        for(key in headers){\n            if(headers.hasOwnProperty(key)){\n                xhr.setRequestHeader(key, headers[key]);\n            }\n        }\n    } else if (options.headers && !isEmpty(options.headers)) {\n        throw new Error(\"Headers cannot be set on an XDomainRequest object\")\n    }\n\n    if (\"responseType\" in options) {\n        xhr.responseType = options.responseType;\n    }\n\n    if (\"beforeSend\" in options &&\n        typeof options.beforeSend === \"function\"\n    ) {\n        options.beforeSend(xhr);\n    }\n\n    // Microsoft Edge browser sends \"undefined\" when send is called with undefined value.\n    // XMLHttpRequest spec says to pass null as body to indicate no body\n    // See https://github.com/naugtur/xhr/issues/100.\n    xhr.send(body || null);\n\n    return xhr\n\n\n}\n\nfunction getXml(xhr) {\n    // xhr.responseXML will throw Exception \"InvalidStateError\" or \"DOMException\"\n    // See https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseXML.\n    try {\n        if (xhr.responseType === \"document\") {\n            return xhr.responseXML\n        }\n        var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === \"parsererror\";\n        if (xhr.responseType === \"\" && !firefoxBugTakenEffect) {\n            return xhr.responseXML\n        }\n    } catch (e) {}\n\n    return null\n}\n\nfunction noop() {}\n\nxhr.default = default_1;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\nvar asyncGenerator = function () {\n  function AwaitValue(value) {\n    this.value = value;\n  }\n\n  function AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n\n        if (value instanceof AwaitValue) {\n          Promise.resolve(value.value).then(function (arg) {\n            resume(\"next\", arg);\n          }, function (arg) {\n            resume(\"throw\", arg);\n          });\n        } else {\n          settle(result.done ? \"return\" : \"normal\", result.value);\n        }\n      } catch (err) {\n        settle(\"throw\", err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case \"return\":\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case \"throw\":\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== \"function\") {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === \"function\" && Symbol.asyncIterator) {\n    AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke(\"next\", arg);\n  };\n\n  AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke(\"throw\", arg);\n  };\n\n  AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke(\"return\", arg);\n  };\n\n  return {\n    wrap: function (fn) {\n      return function () {\n        return new AsyncGenerator(fn.apply(this, arguments));\n      };\n    },\n    await: function (value) {\n      return new AwaitValue(value);\n    }\n  };\n}();\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nvar lastError = '';\n\n/**\n * Creates the HTLM for a failure message\n * @param {string} canvasContainerId id of container of th\n *        canvas.\n * @return {string} The html.\n */\nfunction makeFailHTML(msg) {\n    return '\\n<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>\\n<td align=\"center\">\\n<div style=\"display: table-cell; vertical-align: middle;\">\\n<div style=\"\">' + msg + '</div>\\n</div>\\n</td></tr></table>\\n';\n}\n\n/**\n * Message for getting a webgl browser\n * @type {string}\n */\nvar GET_A_WEBGL_BROWSER = '\\n\\tThis page requires a browser that supports WebGL.<br/>\\n\\t<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>\\n';\n\n/**\n * Message for need better hardware\n * @type {string}\n */\nvar OTHER_PROBLEM = '\\n\\tIt does not appear your computer can support WebGL.<br/>\\n\\t<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>\\n';\n\n/**\n * Code to return in `onError` callback when the browser doesn't support webgl\n * @type {number}\n */\nvar ERROR_BROWSER_SUPPORT = 1;\n\n/**\n * Code to return in `onError` callback there's any other problem related to webgl\n * @type {number}\n */\nvar ERROR_OTHER = 2;\n\n/**\n * Creates a webgl context. If creation fails it will\n * change the contents of the container of the <canvas>\n * tag to an error message with the correct links for WebGL,\n * unless `onError` option is defined to a callback,\n * which allows for custom error handling..\n * @param {Element} canvas. The canvas element to create a\n *     context from.\n * @param {WebGLContextCreationAttributes} optAttribs Any\n *     creation attributes you want to pass in.\n * @return {WebGLRenderingContext} The created context.\n */\nfunction setupWebGL(canvas, optAttribs, onError) {\n    function showLink(str) {\n        var container = canvas.parentNode;\n        if (container) {\n            container.innerHTML = makeFailHTML(str);\n        }\n    }\n\n    function handleError(errorCode, msg) {\n        if (typeof onError === 'function') {\n            onError(errorCode);\n        } else {\n            showLink(msg);\n        }\n    }\n\n    if (!window.WebGLRenderingContext) {\n        handleError(ERROR_BROWSER_SUPPORT, GET_A_WEBGL_BROWSER);\n        return null;\n    }\n\n    var context = create3DContext(canvas, optAttribs);\n    if (!context) {\n        handleError(ERROR_OTHER, OTHER_PROBLEM);\n    } else {\n        context.getExtension('OES_standard_derivatives');\n    }\n    return context;\n}\n\n/**\n * Creates a webgl context.\n * @param {!Canvas} canvas The canvas tag to get context\n *     from. If one is not passed in one will be created.\n * @return {!WebGLContext} The created context.\n */\nfunction create3DContext(canvas, optAttribs) {\n    var names = ['webgl', 'experimental-webgl'];\n    var context = null;\n    for (var ii = 0; ii < names.length; ++ii) {\n        try {\n            context = canvas.getContext(names[ii], optAttribs);\n        } catch (e) {\n            if (context) {\n                break;\n            }\n        }\n    }\n    return context;\n}\n\n/*\n *\tCreate a Vertex of a specific type (gl.VERTEX_SHADER/)\n */\nfunction createShader(main, source, type, offset) {\n    var gl = main.gl;\n\n    var shader = gl.createShader(type);\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n    if (!compiled) {\n        // Something went wrong during compilation; get the error\n        lastError = gl.getShaderInfoLog(shader);\n        console.error('*** Error compiling shader ' + shader + ':' + lastError);\n        main.trigger('error', {\n            shader: shader,\n            source: source,\n            type: type,\n            error: lastError,\n            offset: offset || 0\n        });\n        gl.deleteShader(shader);\n        return null;\n    }\n\n    return shader;\n}\n\n/**\n * Loads a shader.\n * @param {!WebGLContext} gl The WebGLContext to use.\n * @param {string} shaderSource The shader source.\n * @param {number} shaderType The type of shader.\n * @param {function(string): void) opt_errorCallback callback for errors.\n * @return {!WebGLShader} The created shader.\n */\nfunction createProgram(main, shaders, optAttribs, optLocations) {\n    var gl = main.gl;\n\n    var program = gl.createProgram();\n    for (var ii = 0; ii < shaders.length; ++ii) {\n        gl.attachShader(program, shaders[ii]);\n    }\n    if (optAttribs) {\n        for (var _ii = 0; _ii < optAttribs.length; ++_ii) {\n            gl.bindAttribLocation(program, optLocations ? optLocations[_ii] : _ii, optAttribs[_ii]);\n        }\n    }\n    gl.linkProgram(program);\n\n    // Check the link status\n    var linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n    if (!linked) {\n        // something went wrong with the link\n        lastError = gl.getProgramInfoLog(program);\n        console.log('Error in program linking:' + lastError);\n        gl.deleteProgram(program);\n        return null;\n    }\n    return program;\n}\n\n// By Brett Camber on\n// https://github.com/tangrams/tangram/blob/master/src/gl/glsl.js\nfunction parseUniforms(uniforms) {\n    var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    var parsed = [];\n\n    for (var name in uniforms) {\n        var uniform = uniforms[name];\n        var u = void 0;\n\n        if (prefix) {\n            name = prefix + '.' + name;\n        }\n\n        // Single float\n        if (typeof uniform === 'number') {\n            parsed.push({\n                type: 'float',\n                method: '1f',\n                name: name,\n                value: uniform\n            });\n        }\n        // Array: vector, array of floats, array of textures, or array of structs\n        else if (Array.isArray(uniform)) {\n                // Numeric values\n                if (typeof uniform[0] === 'number') {\n                    // float vectors (vec2, vec3, vec4)\n                    if (uniform.length === 1) {\n                        parsed.push({\n                            type: 'float',\n                            method: '1f',\n                            name: name,\n                            value: uniform\n                        });\n                    }\n                    // float vectors (vec2, vec3, vec4)\n                    else if (uniform.length >= 2 && uniform.length <= 4) {\n                            parsed.push({\n                                type: 'vec' + uniform.length,\n                                method: uniform.length + 'fv',\n                                name: name,\n                                value: uniform\n                            });\n                        }\n                        // float array\n                        else if (uniform.length > 4) {\n                                parsed.push({\n                                    type: 'float[]',\n                                    method: '1fv',\n                                    name: name + '[0]',\n                                    value: uniform\n                                });\n                            }\n                    // TODO: assume matrix for (typeof == Float32Array && length == 16)?\n                }\n                // Array of textures\n                else if (typeof uniform[0] === 'string') {\n                        parsed.push({\n                            type: 'sampler2D',\n                            method: '1i',\n                            name: name,\n                            value: uniform\n                        });\n                    }\n                    // Array of arrays - but only arrays of vectors are allowed in this case\n                    else if (Array.isArray(uniform[0]) && typeof uniform[0][0] === 'number') {\n                            // float vectors (vec2, vec3, vec4)\n                            if (uniform[0].length >= 2 && uniform[0].length <= 4) {\n                                // Set each vector in the array\n                                for (u = 0; u < uniform.length; u++) {\n                                    parsed.push({\n                                        type: 'vec' + uniform[0].length,\n                                        method: uniform[u].length + 'fv',\n                                        name: name + '[' + u + ']',\n                                        value: uniform[u]\n                                    });\n                                }\n                            }\n                            // else error?\n                        }\n                        // Array of structures\n                        else if (_typeof(uniform[0]) === 'object') {\n                                for (u = 0; u < uniform.length; u++) {\n                                    // Set each struct in the array\n                                    parsed.push.apply(parsed, toConsumableArray(parseUniforms(uniform[u], name + '[' + u + ']')));\n                                }\n                            }\n            }\n            // Boolean\n            else if (typeof uniform === 'boolean') {\n                    parsed.push({\n                        type: 'bool',\n                        method: '1i',\n                        name: name,\n                        value: uniform\n                    });\n                }\n                // Texture\n                else if (typeof uniform === 'string') {\n                        parsed.push({\n                            type: 'sampler2D',\n                            method: '1i',\n                            name: name,\n                            value: uniform\n                        });\n                    }\n                    // Structure\n                    else if ((typeof uniform === 'undefined' ? 'undefined' : _typeof(uniform)) === 'object') {\n                            // Set each field in the struct\n                            parsed.push.apply(parsed, toConsumableArray(parseUniforms(uniform, name)));\n                        }\n        // TODO: support other non-float types? (int, etc.)\n    }\n    return parsed;\n}\n\nfunction isCanvasVisible(canvas) {\n    return canvas.getBoundingClientRect().top + canvas.height > 0 && canvas.getBoundingClientRect().top < (window.innerHeight || document.documentElement.clientHeight);\n}\n\nfunction isPowerOf2(value) {\n    return (value & value - 1) === 0;\n}\n\nfunction isSafari() {\n    return (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)\n    );\n}\n\n\n\n\n\n\n\nfunction isDiff(a, b) {\n    if (a && b) {\n        return a.toString() !== b.toString();\n    }\n    return false;\n}\n\nfunction subscribeMixin$1(target) {\n    var listeners = new Set();\n\n    return Object.assign(target, {\n        on: function on(type, f) {\n            var listener = {};\n            listener[type] = f;\n            listeners.add(listener);\n        },\n        off: function off(type, f) {\n            if (f) {\n                var listener = {};\n                listener[type] = f;\n                listeners.delete(listener);\n            } else {\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = listeners[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var item = _step.value;\n                        var _iteratorNormalCompletion2 = true;\n                        var _didIteratorError2 = false;\n                        var _iteratorError2 = undefined;\n\n                        try {\n                            for (var _iterator2 = Object.keys(item)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                                var key = _step2.value;\n\n                                if (key === type) {\n                                    listeners.delete(item);\n                                    return;\n                                }\n                            }\n                        } catch (err) {\n                            _didIteratorError2 = true;\n                            _iteratorError2 = err;\n                        } finally {\n                            try {\n                                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                                    _iterator2.return();\n                                }\n                            } finally {\n                                if (_didIteratorError2) {\n                                    throw _iteratorError2;\n                                }\n                            }\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            }\n        },\n        listSubscriptions: function listSubscriptions() {\n            var _iteratorNormalCompletion3 = true;\n            var _didIteratorError3 = false;\n            var _iteratorError3 = undefined;\n\n            try {\n                for (var _iterator3 = listeners[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                    var item = _step3.value;\n\n                    console.log(item);\n                }\n            } catch (err) {\n                _didIteratorError3 = true;\n                _iteratorError3 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                        _iterator3.return();\n                    }\n                } finally {\n                    if (_didIteratorError3) {\n                        throw _iteratorError3;\n                    }\n                }\n            }\n        },\n        subscribe: function subscribe(listener) {\n            listeners.add(listener);\n        },\n        unsubscribe: function unsubscribe(listener) {\n            listeners.delete(listener);\n        },\n        unsubscribeAll: function unsubscribeAll() {\n            listeners.clear();\n        },\n        trigger: function trigger(event) {\n            for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                data[_key - 1] = arguments[_key];\n            }\n\n            var _iteratorNormalCompletion4 = true;\n            var _didIteratorError4 = false;\n            var _iteratorError4 = undefined;\n\n            try {\n                for (var _iterator4 = listeners[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                    var listener = _step4.value;\n\n                    if (typeof listener[event] === 'function') {\n                        listener[event].apply(listener, toConsumableArray(data));\n                    }\n                }\n            } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                        _iterator4.return();\n                    }\n                } finally {\n                    if (_didIteratorError4) {\n                        throw _iteratorError4;\n                    }\n                }\n            }\n        }\n    });\n}\n\n// Texture management\nvar Texture = function () {\n    function Texture(gl, name) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        classCallCheck(this, Texture);\n\n        subscribeMixin$1(this);\n\n        this.gl = gl;\n        this.texture = gl.createTexture();\n        if (this.texture) {\n            this.valid = true;\n        }\n        this.bind();\n\n        this.name = name;\n        this.source = null;\n        this.sourceType = null;\n        this.loading = null; // a Promise object to track the loading state of this texture\n\n        // Default to a 1-pixel black texture so we can safely render while we wait for an image to load\n        // See: http://stackoverflow.com/questions/19722247/webgl-wait-for-texture-to-load\n        this.setData(1, 1, new Uint8Array([0, 0, 0, 255]), { filtering: 'linear' });\n        this.setFiltering(options.filtering);\n\n        this.load(options);\n    }\n\n    // Destroy a single texture instance\n\n\n    createClass(Texture, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (!this.valid) {\n                return;\n            }\n            this.gl.deleteTexture(this.texture);\n            this.texture = null;\n            delete this.data;\n            this.data = null;\n            this.valid = false;\n        }\n    }, {\n        key: 'bind',\n        value: function bind(unit) {\n            if (!this.valid) {\n                return;\n            }\n            if (typeof unit === 'number') {\n                if (Texture.activeUnit !== unit) {\n                    this.gl.activeTexture(this.gl.TEXTURE0 + unit);\n                    Texture.activeUnit = unit;\n                }\n            }\n            if (Texture.activeTexture !== this.texture) {\n                this.gl.bindTexture(this.gl.TEXTURE_2D, this.texture);\n                Texture.activeTexture = this.texture;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            this.loading = null;\n\n            if (typeof options.url === 'string') {\n                if (this.url === undefined || options.url !== this.url) {\n                    this.setUrl(options.url, options);\n                }\n            } else if (options.element) {\n                this.setElement(options.element, options);\n            } else if (options.data && options.width && options.height) {\n                this.setData(options.width, options.height, options.data, options);\n            }\n        }\n\n        // Sets texture from an url\n\n    }, {\n        key: 'setUrl',\n        value: function setUrl(url) {\n            var _this = this;\n\n            var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n            if (!this.valid) {\n                return;\n            }\n\n            this.url = url; // save URL reference (will be overwritten when element is loaded below)\n            this.source = this.url;\n            this.sourceType = 'url';\n\n            this.loading = new Promise(function (resolve, reject) {\n                var ext = url.split('.').pop().toLowerCase();\n                var isVideo = ext === 'ogv' || ext === 'webm' || ext === 'mp4';\n\n                var element = undefined;\n                if (isVideo) {\n                    element = document.createElement('video');\n                    element.autoplay = true;\n                    options.filtering = 'nearest';\n                    // element.preload = 'auto';\n                    // element.style.display = 'none';\n                    // document.body.appendChild(element);\n                } else {\n                    element = new Image();\n                }\n\n                element.onload = function () {\n                    try {\n                        _this.setElement(element, options);\n                    } catch (e) {\n                        console.log('Texture \\'' + _this.name + '\\': failed to load url: \\'' + _this.source + '\\'', e, options);\n                    }\n                    resolve(_this);\n                };\n                element.onerror = function (e) {\n                    // Warn and resolve on error\n                    console.log('Texture \\'' + _this.name + '\\': failed to load url: \\'' + _this.source + '\\'', e, options);\n                    resolve(_this);\n                };\n\n                // Safari has a bug loading data-URL elements with CORS enabled, so it must be disabled in that case\n                // https://bugs.webkit.org/show_bug.cgi?id=123978\n                if (!(isSafari() && _this.source.slice(0, 5) === 'data:')) {\n                    element.crossOrigin = 'anonymous';\n                }\n\n                element.src = _this.source;\n                if (isVideo) {\n                    _this.setElement(element, options);\n                }\n            });\n            return this.loading;\n        }\n\n        // Sets texture to a raw image buffer\n\n    }, {\n        key: 'setData',\n        value: function setData(width, height, data) {\n            var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n            this.width = width;\n            this.height = height;\n\n            this.source = data;\n            this.sourceType = 'data';\n\n            this.update(options);\n            this.setFiltering(options);\n\n            this.loading = Promise.resolve(this);\n            return this.loading;\n        }\n\n        // Sets the texture to track a element (canvas/image)\n\n    }, {\n        key: 'setElement',\n        value: function setElement(element, options) {\n            var _this2 = this;\n\n            var el = element;\n\n            // a string element is interpeted as a CSS selector\n            if (typeof element === 'string') {\n                element = document.querySelector(element);\n            }\n\n            if (element instanceof HTMLCanvasElement || element instanceof HTMLImageElement || element instanceof HTMLVideoElement) {\n                this.source = element;\n                this.sourceType = 'element';\n\n                if (element instanceof HTMLVideoElement) {\n                    element.addEventListener('canplaythrough', function () {\n                        _this2.intervalID = setInterval(function () {\n                            _this2.update(options);\n                        }, 15);\n                    }, true);\n                    element.addEventListener('ended', function () {\n                        element.currentTime = 0;\n                        element.play();\n                    }, true);\n                } else {\n                    this.update(options);\n                }\n                this.setFiltering(options);\n            } else {\n                var msg = 'the \\'element\\' parameter (`element: ' + JSON.stringify(el) + '`) must be a CSS ';\n                msg += 'selector string, or a <canvas>, <image> or <video> object';\n                console.log('Texture \\'' + this.name + '\\': ' + msg, options);\n            }\n\n            this.loading = Promise.resolve(this);\n            return this.loading;\n        }\n\n        // Uploads current image or buffer to the GPU (can be used to update animated textures on the fly)\n\n    }, {\n        key: 'update',\n        value: function update() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            if (!this.valid) {\n                return;\n            }\n\n            this.bind();\n            this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, options.UNPACK_FLIP_Y_WEBGL === false ? false : true);\n            this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, options.UNPACK_PREMULTIPLY_ALPHA_WEBGL || false);\n\n            // Image or Canvas element\n            if (this.sourceType === 'element' && (this.source instanceof HTMLCanvasElement || this.source instanceof HTMLVideoElement || this.source instanceof HTMLImageElement && this.source.complete)) {\n                if (this.source instanceof HTMLVideoElement) {\n                    this.width = this.source.videoWidth;\n                    this.height = this.source.videoHeight;\n                } else {\n                    this.width = this.source.width;\n                    this.height = this.source.height;\n                }\n                this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.source);\n            }\n            // Raw image buffer\n            else if (this.sourceType === 'data') {\n                    this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.width, this.height, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.source);\n                }\n            this.trigger('loaded', this);\n        }\n\n        // Determines appropriate filtering mode\n\n    }, {\n        key: 'setFiltering',\n        value: function setFiltering() {\n            var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            if (!this.valid) {\n                return;\n            }\n\n            this.powerOf2 = isPowerOf2(this.width) && isPowerOf2(this.height);\n            var defualtFilter = this.powerOf2 ? 'mipmap' : 'linear';\n            this.filtering = options.filtering || defualtFilter;\n\n            var gl = this.gl;\n            this.bind();\n\n            // For power-of-2 textures, the following presets are available:\n            // mipmap: linear blend from nearest mip\n            // linear: linear blend from original image (no mips)\n            // nearest: nearest pixel from original image (no mips, 'blocky' look)\n            if (this.powerOf2) {\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, options.TEXTURE_WRAP_S || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE);\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, options.TEXTURE_WRAP_T || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE);\n\n                if (this.filtering === 'mipmap') {\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR); // TODO: use trilinear filtering by defualt instead?\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n                    gl.generateMipmap(gl.TEXTURE_2D);\n                } else if (this.filtering === 'linear') {\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n                } else if (this.filtering === 'nearest') {\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n                }\n            } else {\n                // WebGL has strict requirements on non-power-of-2 textures:\n                // No mipmaps and must clamp to edge\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n                if (this.filtering === 'mipmap') {\n                    this.filtering = 'linear';\n                }\n\n                if (this.filtering === 'nearest') {\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n                } else {\n                    // default to linear for non-power-of-2 textures\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n                }\n            }\n        }\n    }]);\n    return Texture;\n}();\n\n// Report max texture size for a GL context\n\n\nTexture.getMaxTextureSize = function (gl) {\n    return gl.getParameter(gl.MAX_TEXTURE_SIZE);\n};\n\n// Global set of textures, by name\nTexture.activeUnit = -1;\n\n/*\nThe MIT License (MIT)\n\nCopyright (c) 2015 Patricio Gonzalez Vivo ( http://www.patriciogonzalezvivo.com )\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the 'Software'), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n\nvar GlslCanvas = function () {\n    function GlslCanvas(canvas, contextOptions, options) {\n        var _this = this;\n\n        classCallCheck(this, GlslCanvas);\n\n        subscribeMixin$1(this);\n\n        contextOptions = contextOptions || {};\n        options = options || {};\n\n        this.width = canvas.clientWidth;\n        this.height = canvas.clientHeight;\n\n        this.canvas = canvas;\n        this.gl = undefined;\n        this.program = undefined;\n        this.textures = {};\n        this.buffers = {};\n        this.uniforms = {};\n        this.vbo = {};\n        this.isValid = false;\n\n        this.BUFFER_COUNT = 0;\n        this.TEXTURE_COUNT = 0;\n\n        this.vertexString = contextOptions.vertexString || '\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texcoord;\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main() {\\n    gl_Position = vec4(a_position, 0.0, 1.0);\\n    v_texcoord = a_texcoord;\\n}\\n';\n        this.fragmentString = contextOptions.fragmentString || '\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main(){\\n    gl_FragColor = vec4(0.0);\\n}\\n';\n\n        // GL Context\n        var gl = setupWebGL(canvas, contextOptions, options.onError);\n        if (!gl) {\n            return;\n        }\n        this.gl = gl;\n        this.timeLoad = this.timePrev = performance.now();\n        this.timeDelta = 0.0;\n        this.forceRender = true;\n        this.paused = false;\n        this.realToCSSPixels = window.devicePixelRatio || 1;\n\n        // Allow alpha\n        canvas.style.backgroundColor = contextOptions.backgroundColor || 'rgba(1,1,1,0)';\n\n        // Load shader\n        if (canvas.hasAttribute('data-fragment')) {\n            this.fragmentString = canvas.getAttribute('data-fragment');\n        } else if (canvas.hasAttribute('data-fragment-url')) {\n            var source = canvas.getAttribute('data-fragment-url');\n            xhr.get(source, function (error, response, body) {\n                _this.load(body, _this.vertexString);\n            });\n        }\n\n        // Load shader\n        if (canvas.hasAttribute('data-vertex')) {\n            this.vertexString = canvas.getAttribute('data-vertex');\n        } else if (canvas.hasAttribute('data-vertex-url')) {\n            var _source = canvas.getAttribute('data-vertex-url');\n            xhr.get(_source, function (error, response, body) {\n                _this.load(_this.fragmentString, body);\n            });\n        }\n\n        this.load();\n\n        if (!this.program) {\n            return;\n        }\n\n        // Define Vertex buffer\n        var texCoordsLoc = gl.getAttribLocation(this.program, 'a_texcoord');\n        this.vbo.texCoords = gl.createBuffer();\n        this.gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo.texCoords);\n        this.gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        this.gl.enableVertexAttribArray(texCoordsLoc);\n        this.gl.vertexAttribPointer(texCoordsLoc, 2, gl.FLOAT, false, 0, 0);\n\n        var verticesLoc = gl.getAttribLocation(this.program, 'a_position');\n        this.vbo.vertices = gl.createBuffer();\n        this.gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo.vertices);\n        this.gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        this.gl.enableVertexAttribArray(verticesLoc);\n        this.gl.vertexAttribPointer(verticesLoc, 2, gl.FLOAT, false, 0, 0);\n\n        // load TEXTURES\n        if (canvas.hasAttribute('data-textures')) {\n            var imgList = canvas.getAttribute('data-textures').split(',');\n            for (var nImg in imgList) {\n                this.setUniform('u_tex' + nImg, imgList[nImg]);\n            }\n        }\n\n        // ========================== EVENTS\n        var mouse = {\n            x: 0,\n            y: 0\n        };\n        document.addEventListener('mousemove', function (e) {\n            mouse.x = e.clientX || e.pageX;\n            mouse.y = e.clientY || e.pageY;\n        }, false);\n\n        var sandbox = this;\n        function RenderLoop() {\n            if (sandbox.nMouse > 1) {\n                sandbox.setMouse(mouse);\n            }\n            sandbox.forceRender = sandbox.resize();\n            sandbox.render();\n            window.requestAnimationFrame(RenderLoop);\n        }\n\n        // Start\n        this.setMouse({ x: 0, y: 0 });\n        RenderLoop();\n        return this;\n    }\n\n    createClass(GlslCanvas, [{\n        key: 'destroy',\n        value: function destroy() {\n            this.animated = false;\n            this.isValid = false;\n            for (var tex in this.textures) {\n                if (tex.destroy) {\n                    tex.destroy();\n                }\n            }\n            this.textures = {};\n            for (var att in this.attribs) {\n                this.gl.deleteBuffer(this.attribs[att]);\n            }\n            this.gl.useProgram(null);\n            this.gl.deleteProgram(this.program);\n            for (var key in this.buffers) {\n                var buffer = this.buffers[key];\n                this.gl.deleteProgram(buffer.program);\n            }\n            this.program = null;\n            this.gl = null;\n        }\n    }, {\n        key: 'load',\n        value: function load(fragString, vertString) {\n\n            // Load vertex shader if there is one\n            if (vertString) {\n                this.vertexString = vertString;\n            }\n\n            // Load fragment shader if there is one\n            if (fragString) {\n                this.fragmentString = fragString;\n            }\n\n            this.animated = false;\n            this.nDelta = (this.fragmentString.match(/u_delta/g) || []).length;\n            this.nTime = (this.fragmentString.match(/u_time/g) || []).length;\n            this.nDate = (this.fragmentString.match(/u_date/g) || []).length;\n            this.nMouse = (this.fragmentString.match(/u_mouse/g) || []).length;\n            this.animated = this.nDate > 1 || this.nTime > 1 || this.nMouse > 1;\n\n            var nTextures = this.fragmentString.search(/sampler2D/g);\n            if (nTextures) {\n                var lines = this.fragmentString.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    var match = lines[i].match(/uniform\\s*sampler2D\\s*([\\w]*);\\s*\\/\\/\\s*([\\w|\\:\\/\\/|\\.|\\-|\\_]*)/i);\n                    if (match) {\n                        var ext = match[2].split('.').pop().toLowerCase();\n                        if (match[1] && match[2] && (ext === 'jpg' || ext === 'jpeg' || ext === 'png' || ext === 'ogv' || ext === 'webm' || ext === 'mp4')) {\n                            this.setUniform(match[1], match[2]);\n                        }\n                    }\n                    var main = lines[i].match(/\\s*void\\s*main\\s*/g);\n                    if (main) {\n                        break;\n                    }\n                }\n            }\n\n            var vertexShader = createShader(this, this.vertexString, this.gl.VERTEX_SHADER);\n            var fragmentShader = createShader(this, this.fragmentString, this.gl.FRAGMENT_SHADER);\n\n            // If Fragment shader fails load a empty one to sign the error\n            if (!fragmentShader) {\n                fragmentShader = createShader(this, 'void main(){\\n\\tgl_FragColor = vec4(1.0);\\n}', this.gl.FRAGMENT_SHADER);\n                this.isValid = false;\n            } else {\n                this.isValid = true;\n            }\n\n            // Create and use program\n            var program = createProgram(this, [vertexShader, fragmentShader]); //, [0,1],['a_texcoord','a_position']);\n            this.gl.useProgram(program);\n\n            // Delete shaders\n            // this.gl.detachShader(program, vertexShader);\n            // this.gl.detachShader(program, fragmentShader);\n            this.gl.deleteShader(vertexShader);\n            this.gl.deleteShader(fragmentShader);\n\n            this.program = program;\n            this.change = true;\n\n            this.BUFFER_COUNT = 0;\n            var buffers = this.getBuffers(this.fragmentString);\n            if (Object.keys(buffers).length) {\n                this.loadPrograms(buffers);\n            }\n            this.buffers = buffers;\n\n            // Trigger event\n            this.trigger('load', {});\n\n            this.forceRender = true;\n        }\n    }, {\n        key: 'test',\n        value: function test(callback, fragString, vertString) {\n            // Thanks to @thespite for the help here\n            // https://www.khronos.org/registry/webgl/extensions/EXT_disjoint_timer_query/\n            var pre_test_vert = this.vertexString;\n            var pre_test_frag = this.fragmentString;\n            var pre_test_paused = this.paused;\n\n            var ext = this.gl.getExtension('EXT_disjoint_timer_query');\n            var query = ext.createQueryEXT();\n            var wasValid = this.isValid;\n\n            if (fragString || vertString) {\n                this.load(fragString, vertString);\n                wasValid = this.isValid;\n                this.forceRender = true;\n                this.render();\n            }\n\n            this.paused = true;\n            ext.beginQueryEXT(ext.TIME_ELAPSED_EXT, query);\n            this.forceRender = true;\n            this.render();\n            ext.endQueryEXT(ext.TIME_ELAPSED_EXT);\n\n            var sandbox = this;\n            function finishTest() {\n                // Revert changes... go back to normal\n                sandbox.paused = pre_test_paused;\n                if (fragString || vertString) {\n                    sandbox.load(pre_test_frag, pre_test_vert);\n                }\n            }\n            function waitForTest() {\n                sandbox.forceRender = true;\n                sandbox.render();\n                var available = ext.getQueryObjectEXT(query, ext.QUERY_RESULT_AVAILABLE_EXT);\n                var disjoint = sandbox.gl.getParameter(ext.GPU_DISJOINT_EXT);\n                if (available && !disjoint) {\n                    var ret = {\n                        wasValid: wasValid,\n                        frag: fragString || sandbox.fragmentString,\n                        vert: vertString || sandbox.vertexString,\n                        timeElapsedMs: ext.getQueryObjectEXT(query, ext.QUERY_RESULT_EXT) / 1000000.0\n                    };\n                    finishTest();\n                    callback(ret);\n                } else {\n                    window.requestAnimationFrame(waitForTest);\n                }\n            }\n            waitForTest();\n        }\n    }, {\n        key: 'loadTexture',\n        value: function loadTexture(name, urlElementOrData, options) {\n            var _this2 = this;\n\n            if (!options) {\n                options = {};\n            }\n\n            if (typeof urlElementOrData === 'string') {\n                options.url = urlElementOrData;\n            } else if ((typeof urlElementOrData === 'undefined' ? 'undefined' : _typeof(urlElementOrData)) === 'object' && urlElementOrData.data && urlElementOrData.width && urlElementOrData.height) {\n                options.data = urlElementOrData.data;\n                options.width = urlElementOrData.width;\n                options.height = urlElementOrData.height;\n            } else if ((typeof urlElementOrData === 'undefined' ? 'undefined' : _typeof(urlElementOrData)) === 'object') {\n                options.element = urlElementOrData;\n            }\n\n            if (this.textures[name]) {\n                if (this.textures[name]) {\n                    this.textures[name].load(options);\n                    this.textures[name].on('loaded', function (args) {\n                        _this2.forceRender = true;\n                    });\n                }\n            } else {\n                this.textures[name] = new Texture(this.gl, name, options);\n                this.textures[name].on('loaded', function (args) {\n                    _this2.forceRender = true;\n                });\n            }\n        }\n    }, {\n        key: 'refreshUniforms',\n        value: function refreshUniforms() {\n            this.uniforms = {};\n        }\n    }, {\n        key: 'setUniform',\n        value: function setUniform(name) {\n            var u = {};\n\n            for (var _len = arguments.length, value = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                value[_key - 1] = arguments[_key];\n            }\n\n            u[name] = value;\n            this.setUniforms(u);\n        }\n    }, {\n        key: 'setUniforms',\n        value: function setUniforms(uniforms) {\n            var parsed = parseUniforms(uniforms);\n            // Set each uniform\n            for (var u in parsed) {\n                if (parsed[u].type === 'sampler2D') {\n                    // For textures, we need to track texture units, so we have a special setter\n                    // this.uniformTexture(parsed[u].name, parsed[u].value[0]);\n                    this.loadTexture(parsed[u].name, parsed[u].value[0]);\n                } else {\n                    this.uniform(parsed[u].method, parsed[u].type, parsed[u].name, parsed[u].value);\n                    this.forceRender = true;\n                }\n            }\n        }\n    }, {\n        key: 'setMouse',\n        value: function setMouse(mouse) {\n            // set the mouse uniform\n            var rect = this.canvas.getBoundingClientRect();\n            if (mouse && mouse.x && mouse.x >= rect.left && mouse.x <= rect.right && mouse.y && mouse.y >= rect.top && mouse.y <= rect.bottom) {\n\n                var mouse_x = (mouse.x - rect.left) * this.realToCSSPixels;\n                var mouse_y = this.canvas.height - (mouse.y - rect.top) * this.realToCSSPixels;\n\n                for (var key in this.buffers) {\n                    var buffer = this.buffers[key];\n                    this.gl.useProgram(buffer.program);\n                    this.gl.uniform2f(this.gl.getUniformLocation(buffer.program, 'u_mouse'), mouse_x, mouse_y);\n                }\n                this.gl.useProgram(this.program);\n                this.gl.uniform2f(this.gl.getUniformLocation(this.program, 'u_mouse'), mouse_x, mouse_y);\n            }\n        }\n\n        // ex: program.uniform('3f', 'position', x, y, z);\n\n    }, {\n        key: 'uniform',\n        value: function uniform(method, type, name) {\n            // 'value' is a method-appropriate arguments list\n            this.uniforms[name] = this.uniforms[name] || {};\n            var uniform = this.uniforms[name];\n\n            for (var _len2 = arguments.length, value = Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {\n                value[_key2 - 3] = arguments[_key2];\n            }\n\n            var change = isDiff(uniform.value, value);\n            if (change || this.change || uniform.location === undefined || uniform.value === undefined) {\n                uniform.name = name;\n                uniform.value = value;\n                uniform.type = type;\n                uniform.method = 'uniform' + method;\n                uniform.location = this.gl.getUniformLocation(this.program, name);\n\n                this.gl[uniform.method].apply(this.gl, [uniform.location].concat(uniform.value));\n            }\n        }\n    }, {\n        key: 'uniformTexture',\n        value: function uniformTexture(name, texture, options) {\n            if (this.textures[name] === undefined) {\n                this.loadTexture(name, texture, options);\n            } else {\n                return true;\n            }\n        }\n    }, {\n        key: 'resize',\n        value: function resize() {\n            if (this.width !== this.canvas.clientWidth || this.height !== this.canvas.clientHeight) {\n                this.realToCSSPixels = window.devicePixelRatio || 1;\n\n                // Lookup the size the browser is displaying the canvas in CSS pixels\n                // and compute a size needed to make our drawingbuffer match it in\n                // device pixels.\n                var displayWidth = Math.floor(this.gl.canvas.clientWidth * this.realToCSSPixels);\n                var displayHeight = Math.floor(this.gl.canvas.clientHeight * this.realToCSSPixels);\n\n                // Check if the canvas is not the same size.\n                if (this.gl.canvas.width !== displayWidth || this.gl.canvas.height !== displayHeight) {\n                    // Make the canvas the same size\n                    this.gl.canvas.width = displayWidth;\n                    this.gl.canvas.height = displayHeight;\n                    // Set the viewport to match\n                    this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n                    // this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\n                }\n                this.width = this.canvas.clientWidth;\n                this.height = this.canvas.clientHeight;\n                this.resizeSwappableBuffers();\n                return true;\n            } else {\n                return false;\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            this.visible = isCanvasVisible(this.canvas);\n            if (this.forceRender || this.animated && this.visible && !this.paused) {\n                this.renderPrograms();\n                // Trigger event\n                this.trigger('render', {});\n                this.change = false;\n                this.forceRender = false;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this.paused = true;\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this.paused = false;\n        }\n    }, {\n        key: 'version',\n        value: function version() {\n            return '0.0.27';\n        }\n\n        // render main and buffers programs\n\n    }, {\n        key: 'renderPrograms',\n        value: function renderPrograms() {\n            var gl = this.gl,\n                W = gl.canvas.width,\n                H = gl.canvas.height;\n            this.updateVariables();\n            gl.viewport(0, 0, W, H);\n            for (var key in this.buffers) {\n                var buffer = this.buffers[key];\n                this.updateUniforms(buffer.program, key);\n                buffer.bundle.render(W, H, buffer.program, buffer.name);\n                gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            }\n            this.updateUniforms(this.program, 'main');\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\n        }\n\n        // update glslCanvas variables\n\n    }, {\n        key: 'updateVariables',\n        value: function updateVariables() {\n            var glsl = this;\n            var date = new Date();\n            var now = performance.now();\n            var variables = this.variables || {};\n            variables.prev = variables.prev || now;\n            variables.delta = (now - variables.prev) / 1000.0;\n            variables.prev = now;\n            variables.load = glsl.timeLoad;\n            variables.time = (now - glsl.timeLoad) / 1000.0;\n            variables.year = date.getFullYear();\n            variables.month = date.getMonth();\n            variables.date = date.getDate();\n            variables.daytime = date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds() + date.getMilliseconds() * 0.001;\n            this.variables = variables;\n        }\n\n        // update uniforms per program\n\n    }, {\n        key: 'updateUniforms',\n        value: function updateUniforms(program, key) {\n            var gl = this.gl,\n                variables = this.variables;\n            gl.useProgram(program);\n            if (this.nDelta > 1) {\n                // set the delta time uniform\n                gl.uniform1f(gl.getUniformLocation(program, 'u_delta'), variables.delta);\n            }\n            if (this.nTime > 1) {\n                // set the elapsed time uniform\n                gl.uniform1f(gl.getUniformLocation(program, 'u_time'), variables.time);\n            }\n            if (this.nDate) {\n                // Set date uniform: year/month/day/time_in_sec\n                gl.uniform4f(gl.getUniformLocation(program, 'u_date'), variables.year, variables.month, variables.date, variables.daytime);\n            }\n            // set the resolution uniform\n            gl.uniform2f(gl.getUniformLocation(program, 'u_resolution'), this.canvas.width, this.canvas.height);\n            // this.uniform('2f', 'vec2', 'u_resolution', this.canvas.width, this.canvas.height);\n            for (var _key3 in this.buffers) {\n                var buffer = this.buffers[_key3];\n                gl.uniform1i(gl.getUniformLocation(program, buffer.name), buffer.bundle.input.index);\n            }\n            this.TEXTURE_COUNT = this.BUFFER_COUNT;\n            for (var name in this.textures) {\n                if (this.uniformTexture(name, null, {\n                    filtering: 'mipmap',\n                    repeat: true\n                })) {\n                    var texture = this.textures[name];\n                    gl.activeTexture(gl.TEXTURE0 + this.TEXTURE_COUNT);\n                    gl.bindTexture(gl.TEXTURE_2D, texture.texture);\n                    gl.uniform1i(gl.getUniformLocation(program, name), this.TEXTURE_COUNT);\n                    gl.uniform2f(gl.getUniformLocation(program, name + 'Resolution'), texture.width, texture.height);\n                    this.TEXTURE_COUNT++;\n                }\n            }\n        }\n\n        // parse input strings\n\n    }, {\n        key: 'getBuffers',\n        value: function getBuffers(fragString) {\n            var buffers = {};\n            if (fragString) {\n                fragString.replace(/(?:^\\s*)((?:#if|#elif)(?:\\s*)(defined\\s*\\(\\s*BUFFER_)(\\d+)(?:\\s*\\))|(?:#ifdef)(?:\\s*BUFFER_)(\\d+)(?:\\s*))/gm, function () {\n                    var i = arguments[3] || arguments[4];\n                    buffers['u_buffer' + i] = {\n                        fragment: '#define BUFFER_' + i + '\\n' + fragString\n                    };\n                });\n            }\n            return buffers;\n        }\n\n        // load buffers programs\n\n    }, {\n        key: 'loadPrograms',\n        value: function loadPrograms(buffers) {\n            var glsl = this;\n            var gl = this.gl;\n            var i = 0;\n            var vertex = createShader(glsl, glsl.vertexString, gl.VERTEX_SHADER);\n            for (var key in buffers) {\n                var buffer = buffers[key];\n                var fragment = createShader(glsl, buffer.fragment, gl.FRAGMENT_SHADER, 1);\n                if (!fragment) {\n                    fragment = createShader(glsl, 'void main(){\\n\\tgl_FragColor = vec4(1.0);\\n}', gl.FRAGMENT_SHADER);\n                    glsl.isValid = false;\n                } else {\n                    glsl.isValid = true;\n                }\n                var program = createProgram(glsl, [vertex, fragment]);\n                buffer.name = 'u_buffer' + i;\n                buffer.program = program;\n                buffer.bundle = glsl.createSwappableBuffer(glsl.canvas.width, glsl.canvas.height, program);\n                gl.deleteShader(fragment);\n                i++;\n            }\n            gl.deleteShader(vertex);\n        }\n\n        // create an input / output swappable buffer\n\n    }, {\n        key: 'createSwappableBuffer',\n        value: function createSwappableBuffer(W, H, program) {\n            var input = this.createBuffer(W, H, program);\n            var output = this.createBuffer(W, H, program);\n            var gl = this.gl;\n            return {\n                input: input,\n                output: output,\n                swap: function swap() {\n                    var temp = input;\n                    input = output;\n                    output = temp;\n                    this.input = input;\n                    this.output = output;\n                },\n                render: function render(W, H, program, name) {\n                    gl.useProgram(program);\n                    gl.viewport(0, 0, W, H);\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, this.input.buffer);\n                    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.output.texture, 0);\n                    gl.drawArrays(gl.TRIANGLES, 0, 6);\n                    this.swap();\n                },\n                resize: function resize(W, H, program, name) {\n                    gl.useProgram(program);\n                    gl.viewport(0, 0, W, H);\n                    this.input.resize(W, H);\n                    this.output.resize(W, H);\n                }\n            };\n        }\n\n        // create a buffers\n\n    }, {\n        key: 'createBuffer',\n        value: function createBuffer(W, H, program) {\n            var gl = this.gl;\n            var index = this.BUFFER_COUNT;\n            this.BUFFER_COUNT += 2;\n            gl.getExtension('OES_texture_float');\n            var texture = gl.createTexture();\n            gl.activeTexture(gl.TEXTURE0 + index);\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, W, H, 0, gl.RGBA, gl.FLOAT, null);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n            var buffer = gl.createFramebuffer();\n            return {\n                index: index,\n                texture: texture,\n                buffer: buffer,\n                W: W,\n                H: H,\n                resize: function resize(W, H) {\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, buffer);\n                    var minW = Math.min(W, this.W);\n                    var minH = Math.min(H, this.H);\n                    var pixels = new Float32Array(minW * minH * 4);\n                    gl.readPixels(0, 0, minW, minH, gl.RGBA, gl.FLOAT, pixels);\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                    var newIndex = index + 1;\n                    var newTexture = gl.createTexture();\n                    gl.activeTexture(gl.TEXTURE0 + newIndex);\n                    gl.bindTexture(gl.TEXTURE_2D, newTexture);\n                    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, W, H, 0, gl.RGBA, gl.FLOAT, null);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n                    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n                    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, minW, minH, gl.RGBA, gl.FLOAT, pixels);\n                    var newBuffer = gl.createFramebuffer();\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                    gl.deleteTexture(texture);\n                    gl.activeTexture(gl.TEXTURE0 + index);\n                    gl.bindTexture(gl.TEXTURE_2D, newTexture);\n                    index = this.index = index;\n                    texture = this.texture = newTexture;\n                    buffer = this.buffer = newBuffer;\n                    this.W = W;\n                    this.H = H;\n                }\n            };\n        }\n\n        // resize buffers on canvas resize\n        // consider applying a throttle of 50 ms on canvas resize\n        // to avoid requestAnimationFrame and Gl violations\n\n    }, {\n        key: 'resizeSwappableBuffers',\n        value: function resizeSwappableBuffers() {\n            var gl = this.gl;\n            var W = gl.canvas.width,\n                H = gl.canvas.height;\n            gl.viewport(0, 0, W, H);\n            for (var key in this.buffers) {\n                var buffer = this.buffers[key];\n                buffer.bundle.resize(W, H, buffer.program, buffer.name);\n            }\n            gl.useProgram(this.program);\n        }\n    }]);\n    return GlslCanvas;\n}();\n\nfunction loadAllGlslCanvas() {\n    var list = document.getElementsByClassName('glslCanvas');\n    if (list.length > 0) {\n        window.glslCanvases = [];\n        for (var i = 0; i < list.length; i++) {\n            var sandbox = new GlslCanvas(list[i]);\n            if (sandbox.isValid) {\n                window.glslCanvases.push(sandbox);\n            }\n        }\n    }\n}\n\nwindow.addEventListener('load', function () {\n    loadAllGlslCanvas();\n});\n\nmodule.exports = GlslCanvas;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{}],114:[function(_dereq_,module,exports){\n'use strict';\n\nvar fnToStr = Function.prototype.toString;\n\nvar constructorRegex = /^\\s*class /;\nvar isES6ClassFn = function isES6ClassFn(value) {\n\ttry {\n\t\tvar fnStr = fnToStr.call(value);\n\t\tvar singleStripped = fnStr.replace(/\\/\\/.*\\n/g, '');\n\t\tvar multiStripped = singleStripped.replace(/\\/\\*[.\\s\\S]*\\*\\//g, '');\n\t\tvar spaceStripped = multiStripped.replace(/\\n/mg, ' ').replace(/ {2}/g, ' ');\n\t\treturn constructorRegex.test(spaceStripped);\n\t} catch (e) {\n\t\treturn false; // not a function\n\t}\n};\n\nvar tryFunctionObject = function tryFunctionObject(value) {\n\ttry {\n\t\tif (isES6ClassFn(value)) { return false; }\n\t\tfnToStr.call(value);\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\nvar toStr = Object.prototype.toString;\nvar fnClass = '[object Function]';\nvar genClass = '[object GeneratorFunction]';\nvar hasToStringTag = typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol';\n\nmodule.exports = function isCallable(value) {\n\tif (!value) { return false; }\n\tif (typeof value !== 'function' && typeof value !== 'object') { return false; }\n\tif (hasToStringTag) { return tryFunctionObject(value); }\n\tif (isES6ClassFn(value)) { return false; }\n\tvar strClass = toStr.call(value);\n\treturn strClass === fnClass || strClass === genClass;\n};\n\n},{}],115:[function(_dereq_,module,exports){\nmodule.exports = isFunction\n\nvar toString = Object.prototype.toString\n\nfunction isFunction (fn) {\n  var string = toString.call(fn)\n  return string === '[object Function]' ||\n    (typeof fn === 'function' && string !== '[object RegExp]') ||\n    (typeof window !== 'undefined' &&\n     // IE8 and below\n     (fn === window.setTimeout ||\n      fn === window.alert ||\n      fn === window.confirm ||\n      fn === window.prompt))\n};\n\n},{}],116:[function(_dereq_,module,exports){\nvar trim = _dereq_('trim')\n  , forEach = _dereq_('for-each')\n  , isArray = function(arg) {\n      return Object.prototype.toString.call(arg) === '[object Array]';\n    }\n\nmodule.exports = function (headers) {\n  if (!headers)\n    return {}\n\n  var result = {}\n\n  forEach(\n      trim(headers).split('\\n')\n    , function (row) {\n        var index = row.indexOf(':')\n          , key = trim(row.slice(0, index)).toLowerCase()\n          , value = trim(row.slice(index + 1))\n\n        if (typeof(result[key]) === 'undefined') {\n          result[key] = value\n        } else if (isArray(result[key])) {\n          result[key].push(value)\n        } else {\n          result[key] = [ result[key], value ]\n        }\n      }\n  )\n\n  return result\n}\n},{\"for-each\":111,\"trim\":117}],117:[function(_dereq_,module,exports){\n\nexports = module.exports = trim;\n\nfunction trim(str){\n  return str.replace(/^\\s*|\\s*$/g, '');\n}\n\nexports.left = function(str){\n  return str.replace(/^\\s*/, '');\n};\n\nexports.right = function(str){\n  return str.replace(/\\s*$/, '');\n};\n\n},{}],118:[function(_dereq_,module,exports){\n\"use strict\";\nvar window = _dereq_(\"global/window\")\nvar isFunction = _dereq_(\"is-function\")\nvar parseHeaders = _dereq_(\"parse-headers\")\nvar xtend = _dereq_(\"xtend\")\n\nmodule.exports = createXHR\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = createXHR;\ncreateXHR.XMLHttpRequest = window.XMLHttpRequest || noop\ncreateXHR.XDomainRequest = \"withCredentials\" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest\n\nforEachArray([\"get\", \"put\", \"post\", \"patch\", \"head\", \"delete\"], function(method) {\n    createXHR[method === \"delete\" ? \"del\" : method] = function(uri, options, callback) {\n        options = initParams(uri, options, callback)\n        options.method = method.toUpperCase()\n        return _createXHR(options)\n    }\n})\n\nfunction forEachArray(array, iterator) {\n    for (var i = 0; i < array.length; i++) {\n        iterator(array[i])\n    }\n}\n\nfunction isEmpty(obj){\n    for(var i in obj){\n        if(obj.hasOwnProperty(i)) return false\n    }\n    return true\n}\n\nfunction initParams(uri, options, callback) {\n    var params = uri\n\n    if (isFunction(options)) {\n        callback = options\n        if (typeof uri === \"string\") {\n            params = {uri:uri}\n        }\n    } else {\n        params = xtend(options, {uri: uri})\n    }\n\n    params.callback = callback\n    return params\n}\n\nfunction createXHR(uri, options, callback) {\n    options = initParams(uri, options, callback)\n    return _createXHR(options)\n}\n\nfunction _createXHR(options) {\n    if(typeof options.callback === \"undefined\"){\n        throw new Error(\"callback argument missing\")\n    }\n\n    var called = false\n    var callback = function cbOnce(err, response, body){\n        if(!called){\n            called = true\n            options.callback(err, response, body)\n        }\n    }\n\n    function readystatechange() {\n        if (xhr.readyState === 4) {\n            setTimeout(loadFunc, 0)\n        }\n    }\n\n    function getBody() {\n        // Chrome with requestType=blob throws errors arround when even testing access to responseText\n        var body = undefined\n\n        if (xhr.response) {\n            body = xhr.response\n        } else {\n            body = xhr.responseText || getXml(xhr)\n        }\n\n        if (isJson) {\n            try {\n                body = JSON.parse(body)\n            } catch (e) {}\n        }\n\n        return body\n    }\n\n    function errorFunc(evt) {\n        clearTimeout(timeoutTimer)\n        if(!(evt instanceof Error)){\n            evt = new Error(\"\" + (evt || \"Unknown XMLHttpRequest Error\") )\n        }\n        evt.statusCode = 0\n        return callback(evt, failureResponse)\n    }\n\n    // will load the data & process the response in a special response object\n    function loadFunc() {\n        if (aborted) return\n        var status\n        clearTimeout(timeoutTimer)\n        if(options.useXDR && xhr.status===undefined) {\n            //IE8 CORS GET successful response doesn't have a status field, but body is fine\n            status = 200\n        } else {\n            status = (xhr.status === 1223 ? 204 : xhr.status)\n        }\n        var response = failureResponse\n        var err = null\n\n        if (status !== 0){\n            response = {\n                body: getBody(),\n                statusCode: status,\n                method: method,\n                headers: {},\n                url: uri,\n                rawRequest: xhr\n            }\n            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE\n                response.headers = parseHeaders(xhr.getAllResponseHeaders())\n            }\n        } else {\n            err = new Error(\"Internal XMLHttpRequest Error\")\n        }\n        return callback(err, response, response.body)\n    }\n\n    var xhr = options.xhr || null\n\n    if (!xhr) {\n        if (options.cors || options.useXDR) {\n            xhr = new createXHR.XDomainRequest()\n        }else{\n            xhr = new createXHR.XMLHttpRequest()\n        }\n    }\n\n    var key\n    var aborted\n    var uri = xhr.url = options.uri || options.url\n    var method = xhr.method = options.method || \"GET\"\n    var body = options.body || options.data\n    var headers = xhr.headers = options.headers || {}\n    var sync = !!options.sync\n    var isJson = false\n    var timeoutTimer\n    var failureResponse = {\n        body: undefined,\n        headers: {},\n        statusCode: 0,\n        method: method,\n        url: uri,\n        rawRequest: xhr\n    }\n\n    if (\"json\" in options && options.json !== false) {\n        isJson = true\n        headers[\"accept\"] || headers[\"Accept\"] || (headers[\"Accept\"] = \"application/json\") //Don't override existing accept header declared by user\n        if (method !== \"GET\" && method !== \"HEAD\") {\n            headers[\"content-type\"] || headers[\"Content-Type\"] || (headers[\"Content-Type\"] = \"application/json\") //Don't override existing accept header declared by user\n            body = JSON.stringify(options.json === true ? body : options.json)\n        }\n    }\n\n    xhr.onreadystatechange = readystatechange\n    xhr.onload = loadFunc\n    xhr.onerror = errorFunc\n    // IE9 must have onprogress be set to a unique function.\n    xhr.onprogress = function () {\n        // IE must die\n    }\n    xhr.onabort = function(){\n        aborted = true;\n    }\n    xhr.ontimeout = errorFunc\n    xhr.open(method, uri, !sync, options.username, options.password)\n    //has to be after open\n    if(!sync) {\n        xhr.withCredentials = !!options.withCredentials\n    }\n    // Cannot set timeout with sync request\n    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly\n    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent\n    if (!sync && options.timeout > 0 ) {\n        timeoutTimer = setTimeout(function(){\n            if (aborted) return\n            aborted = true//IE9 may still call readystatechange\n            xhr.abort(\"timeout\")\n            var e = new Error(\"XMLHttpRequest timeout\")\n            e.code = \"ETIMEDOUT\"\n            errorFunc(e)\n        }, options.timeout )\n    }\n\n    if (xhr.setRequestHeader) {\n        for(key in headers){\n            if(headers.hasOwnProperty(key)){\n                xhr.setRequestHeader(key, headers[key])\n            }\n        }\n    } else if (options.headers && !isEmpty(options.headers)) {\n        throw new Error(\"Headers cannot be set on an XDomainRequest object\")\n    }\n\n    if (\"responseType\" in options) {\n        xhr.responseType = options.responseType\n    }\n\n    if (\"beforeSend\" in options &&\n        typeof options.beforeSend === \"function\"\n    ) {\n        options.beforeSend(xhr)\n    }\n\n    // Microsoft Edge browser sends \"undefined\" when send is called with undefined value.\n    // XMLHttpRequest spec says to pass null as body to indicate no body\n    // See https://github.com/naugtur/xhr/issues/100.\n    xhr.send(body || null)\n\n    return xhr\n\n\n}\n\nfunction getXml(xhr) {\n    // xhr.responseXML will throw Exception \"InvalidStateError\" or \"DOMException\"\n    // See https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseXML.\n    try {\n        if (xhr.responseType === \"document\") {\n            return xhr.responseXML\n        }\n        var firefoxBugTakenEffect = xhr.responseXML && xhr.responseXML.documentElement.nodeName === \"parsererror\"\n        if (xhr.responseType === \"\" && !firefoxBugTakenEffect) {\n            return xhr.responseXML\n        }\n    } catch (e) {}\n\n    return null\n}\n\nfunction noop() {}\n\n},{\"global/window\":112,\"is-function\":115,\"parse-headers\":116,\"xtend\":119}],119:[function(_dereq_,module,exports){\nmodule.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n\n},{}],120:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _Object$keys = _dereq_('babel-runtime/core-js/object/keys')['default'];\n\nvar _Object$create = _dereq_('babel-runtime/core-js/object/create')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\n_dereq_('document-register-element');\n\nvar _coreShader = _dereq_('./core/Shader');\n\nvar _coreShader2 = _interopRequireDefault(_coreShader);\n\nvar _coreEditor = _dereq_('./core/Editor');\n\nvar _uiMenu = _dereq_('./ui/Menu');\n\nvar _uiMenu2 = _interopRequireDefault(_uiMenu);\n\nvar _uiHelpers = _dereq_('./ui/Helpers');\n\nvar _uiHelpers2 = _interopRequireDefault(_uiHelpers);\n\nvar _uiErrorsDisplay = _dereq_('./ui/ErrorsDisplay');\n\nvar _uiErrorsDisplay2 = _interopRequireDefault(_uiErrorsDisplay);\n\nvar _uiVisualDebugger = _dereq_('./ui/VisualDebugger');\n\nvar _uiVisualDebugger2 = _interopRequireDefault(_uiVisualDebugger);\n\nvar _uiExportIcon = _dereq_('./ui/ExportIcon');\n\nvar _uiExportIcon2 = _interopRequireDefault(_uiExportIcon);\n\nvar _ioFileDrop = _dereq_('./io/FileDrop');\n\nvar _ioFileDrop2 = _interopRequireDefault(_ioFileDrop);\n\nvar _ioHashWatch = _dereq_('./io/HashWatch');\n\nvar _ioHashWatch2 = _interopRequireDefault(_ioHashWatch);\n\nvar _ioBufferManager = _dereq_('./io/BufferManager');\n\nvar _ioBufferManager2 = _interopRequireDefault(_ioBufferManager);\n\nvar _ioLocalStorage = _dereq_('./io/LocalStorage');\n\nvar _ioLocalStorage2 = _interopRequireDefault(_ioLocalStorage);\n\n// Import Utils\n\nvar _xhr = _dereq_('xhr');\n\nvar _xhr2 = _interopRequireDefault(_xhr);\n\nvar _toolsMixin = _dereq_('./tools/mixin');\n\n// 3er Parties\n\nvar _vendorFileSaverMinJs = _dereq_('./vendor/FileSaver.min.js');\n\n// Cross storage for Openframe -- allows restricted access to certain localStorage operations\n// on the openframe domain\n\nvar _crossStorage = _dereq_('cross-storage');\n\nvar STORAGE_LAST_EDITOR_CONTENT = 'last-content';\n\nvar EMPTY_FRAG_SHADER = '// Author:\\n// Title:\\n\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nuniform vec2 u_resolution;\\nuniform vec2 u_mouse;\\nuniform float u_time;\\n\\nvoid main() {\\n    vec2 st = gl_FragCoord.xy/u_resolution.xy;\\n    st.x *= u_resolution.x/u_resolution.y;\\n\\n    vec3 color = vec3(0.);\\n    color = vec3(st.x,st.y,abs(sin(u_time)));\\n\\n    gl_FragColor = vec4(color,1.0);\\n}';\n\nvar GlslEditor = (function () {\n    function GlslEditor(selector, options) {\n        var _this = this;\n\n        _classCallCheck(this, GlslEditor);\n\n        this.createFontLink();\n        (0, _toolsMixin.subscribeMixin)(this);\n\n        if (typeof selector === 'object' && selector.nodeType && selector.nodeType === 1) {\n            this.container = selector;\n        } else if (typeof selector === 'string') {\n            this.container = document.querySelector(selector);\n            if (!this.container) {\n                throw new Error('element ' + selector + ' not present');\n            }\n        } else {\n            console.log('Error, type ' + typeof selector + ' of ' + selector + ' is unknown');\n            return;\n        }\n\n        this.options = {};\n        this.change = false;\n        this.autoupdate = true;\n\n        if (options) {\n            this.options = options;\n        }\n\n        if (this.options.imgs) {\n            this.options.imgs = [];\n        }\n\n        if (this.options.display_menu === undefined) {\n            this.options.display_menu = true;\n        }\n\n        if (this.container.hasAttribute('data-textures')) {\n            var imgList = this.container.getAttribute('data-textures').split(',');\n            for (var i in imgList) {\n                this.options.imgs.push(imgList[i]);\n            }\n        }\n\n        // Default Theme\n        if (!this.options.theme) {\n            this.options.theme = 'default';\n        }\n\n        // Default Context\n        if (!this.options.frag) {\n            var innerHTML = this.container.innerHTML.replace(/&lt;br&gt;/g, '');\n            innerHTML = innerHTML.replace(/<br>/g, '');\n            innerHTML = innerHTML.replace(/&nbsp;/g, '');\n            innerHTML = innerHTML.replace(/&lt;/g, '<');\n            innerHTML = innerHTML.replace(/&gt;/g, '>');\n            innerHTML = innerHTML.replace(/&amp;/g, '&');\n            this.options.frag = innerHTML || EMPTY_FRAG_SHADER;\n\n            if (innerHTML) {\n                this.container.innerHTML = '';\n            }\n        }\n\n        // Default invisible Fragment header\n        if (!this.options.frag_header) {\n            this.options.frag_header = '';\n        }\n\n        // Default invisible Fragment footer\n        if (!this.options.frag_footer) {\n            this.options.frag_footer = '';\n        }\n\n        // Listen to hash changes\n        if (this.options.watchHash) {\n            new _ioHashWatch2['default'](this);\n        }\n\n        // Load UI\n        if (this.options.menu) {\n            this.menu = new _uiMenu2['default'](this);\n        }\n\n        // Support for multiple buffers\n        if (this.options.multipleBuffers) {\n            this.bufferManager = new _ioBufferManager2['default'](this);\n        }\n\n        // Listen to file drops\n        if (this.options.fileDrops) {\n            new _ioFileDrop2['default'](this);\n        }\n\n        // CORE elements\n        this.shader = new _coreShader2['default'](this);\n        this.editor = (0, _coreEditor.initEditor)(this);\n\n        this.helpers = new _uiHelpers2['default'](this);\n        this.errorsDisplay = new _uiErrorsDisplay2['default'](this);\n        this.visualDebugger = new _uiVisualDebugger2['default'](this);\n\n        if (this.options.exportIcon) {\n            this['export'] = new _uiExportIcon2['default'](this);\n        }\n\n        // EVENTS\n        this.editor.on('change', function () {\n            if (_this.autoupdate) {\n                _this.update();\n            }\n        });\n\n        if (this.options.canvas_follow) {\n            this.shader.el.style.position = 'relative';\n            if (this.options.canvas_float) {\n                this.shader.el.style.float = this.options.canvas_float;\n            }\n            this.editor.on('cursorActivity', function (cm) {\n                var height = cm.heightAtLine(cm.getCursor().line + 1, 'local') - _this.shader.el.clientHeight;\n                if (height < 0) {\n                    height = 0.0;\n                }\n                _this.shader.el.style.top = height.toString() + 'px';\n            });\n        }\n\n        // If the user bails for whatever reason, hastily shove the contents of\n        // the editor into some kind of storage. This overwrites whatever was\n        // there before. Note that there is not really a way of handling unload\n        // with our own UI and logic, since this allows for widespread abuse\n        // of normal browser functionality.\n        window.addEventListener('beforeunload', function (event) {\n            var content = {};\n            if (_this.bufferManager && _Object$keys(_this.bufferManager.buffers).length !== 0) {\n                for (var key in _this.bufferManager.buffers) {\n                    content[key] = _this.bufferManager.buffers[key].getValue();\n                }\n            } else {\n                content[new Date().getTime().toString()] = _this.editor.getValue();\n            }\n\n            if (_this.options.menu) {\n                _ioLocalStorage2['default'].setItem(STORAGE_LAST_EDITOR_CONTENT, JSON.stringify(content));\n            }\n        });\n\n        if (this.options.menu) {\n            // If there is previus content load it.\n            var oldContent = JSON.parse(_ioLocalStorage2['default'].getItem(STORAGE_LAST_EDITOR_CONTENT));\n            if (oldContent) {\n                for (var key in oldContent) {\n                    this.open(oldContent[key], key);\n                }\n            } else {\n                this['new']();\n            }\n        } else {\n            this['new']();\n        }\n\n        if (this.options.menu || this.options.exportIcon) {\n            // setup CrossStorage client\n            this.storage = new _crossStorage.CrossStorageClient('https://openframe.io/hub.html');\n            this.storage.onConnect().then(function () {\n                console.log('Connected to OpenFrame [o]');\n            });\n            // }).bind(this);\n        }\n\n        return this;\n    }\n\n    _createClass(GlslEditor, [{\n        key: 'new',\n        value: function _new() {\n            this.setContent(this.options.frag || EMPTY_FRAG_SHADER, new Date().getTime().toString());\n            this.trigger('new_content', {});\n            this.options.frag = null;\n        }\n    }, {\n        key: 'setContent',\n        value: function setContent(shader, tabName) {\n            // If the string is CODE\n            if (this.shader && this.shader.canvas) {\n                if (this.debugging) {\n                    this.debugging = false;\n                    (0, _coreEditor.focusAll)(this.editor);\n                }\n                this.shader.canvas.load(this.options.frag_header + shader + this.options.frag_footer);\n            }\n\n            if (this.editor) {\n                if (tabName !== undefined && this.bufferManager !== undefined) {\n                    this.bufferManager.open(tabName, shader);\n                    this.bufferManager.select(tabName);\n                } else {\n                    this.editor.setValue(shader);\n                    this.editor.setSize(null, this.editor.getDoc().height + 'px');\n                    this.editor.setSize(null, 'auto');\n                    this.filename = tabName;\n                }\n            }\n            this.change = true;\n        }\n    }, {\n        key: 'open',\n        value: function open(shader, tabName) {\n            var _this2 = this;\n\n            if (typeof shader === 'object') {\n                (function () {\n                    var reader = new FileReader();\n                    var ge = _this2;\n                    reader.onload = function (e) {\n                        ge.setContent(e.target.result, shader.name);\n                    };\n                    reader.readAsText(shader);\n                })();\n            } else if (typeof shader === 'string') {\n                if (/\\.frag$/.test(shader) || /\\.fs$/.test(shader)) {\n                    // If the string is an URL\n                    _xhr2['default'].get(shader, function (error, response, body) {\n                        if (error) {\n                            console.log('Error downloading ', shader, error);\n                            return;\n                        }\n                        _this2.setContent(body, tabName);\n                    });\n                } else {\n                    this.setContent(shader, tabName);\n                }\n            }\n        }\n    }, {\n        key: 'getContent',\n        value: function getContent() {\n            return this.editor.getValue();\n        }\n    }, {\n        key: 'getAuthor',\n        value: function getAuthor() {\n            var content = this.getContent();\n            var result = content.match(/\\/\\/\\s*[A|a]uthor\\s*[\\:]?\\s*([\\w|\\s|\\@|\\(|\\)|\\-|\\_]*)/i);\n            if (result && !(result[1] === ' ' || result[1] === '')) {\n                var author = result[1].replace(/(\\r\\n|\\n|\\r)/gm, '');\n                return author;\n            } else {\n                return 'unknown';\n            }\n        }\n    }, {\n        key: 'getTitle',\n        value: function getTitle() {\n            var content = this.getContent();\n            var result = content.match(/\\/\\/\\s*[T|t]itle\\s*:\\s*([\\w|\\s|\\@|\\(|\\)|\\-|\\_]*)/i);\n            if (result && !(result[1] === ' ' || result[1] === '')) {\n                var title = result[1].replace(/(\\r\\n|\\n|\\r)/gm, '');\n                return title;\n            } else if (this.bufferManager !== undefined) {\n                return this.bufferManager.current;\n            } else {\n                return 'unknown';\n            }\n        }\n\n        // Returns Promise\n    }, {\n        key: 'getOfToken',\n        value: function getOfToken() {\n            return this.storage.get('accessToken');\n        }\n    }, {\n        key: 'download',\n        value: function download() {\n            var content = this.getContent();\n            var name = this.getTitle();\n            if (name !== '') {\n                name += '-';\n            }\n            name += new Date().getTime();\n\n            // Download code\n            var blob = new Blob([content], { type: 'text/plain' });\n            (0, _vendorFileSaverMinJs.saveAs)(blob, name + '.frag');\n            this.editor.doc.markClean();\n            this.change = false;\n        }\n    }, {\n        key: 'update',\n        value: function update() {\n            if (this.debugging) {\n                this.debugging = false;\n                (0, _coreEditor.focusAll)(this.editor);\n            }\n\n            if (this.visualDebugger.testingResults.length) {\n                this.visualDebugger.clean();\n            }\n            this.shader.canvas.load(this.options.frag_header + this.editor.getValue() + this.options.frag_footer);\n        }\n    }, {\n        key: 'createFontLink',\n        value: function createFontLink() {\n            var head = document.getElementsByTagName('head')[0];\n            var link = document.createElement('link');\n            link.href = 'https://fonts.googleapis.com/icon?family=Material+Icons';\n            link.type = 'text/css';\n            link.rel = 'stylesheet';\n            link.media = 'screen,print';\n            head.appendChild(link);\n            document.getElementsByTagName('head')[0].appendChild(link);\n        }\n    }, {\n        key: 'togglePresentationWindow',\n        value: function togglePresentationWindow(flag) {\n            this.pWindowOpen = flag;\n            if (flag) {\n                this.shader.openWindow();\n            } else {\n                this.shader.closeWindow();\n            }\n        }\n    }, {\n        key: 'onClosePresentationWindow',\n        value: function onClosePresentationWindow() {\n            this.pWindowOpen = false;\n        }\n    }]);\n\n    return GlslEditor;\n})();\n\nexports['default'] = GlslEditor;\n\nwindow.GlslEditor = GlslEditor;\n\nvar GlslWebComponent = function GlslWebComponent() {};\nGlslWebComponent.prototype = _Object$create(HTMLElement.prototype);\nGlslWebComponent.prototype.createdCallback = function createdCallback() {\n    var options = {\n        canvas_size: 150,\n        canvas_follow: true,\n        tooltips: true\n    };\n\n    for (var i = 0; i < this.attributes.length; i++) {\n        var attribute = this.attributes[i];\n        if (attribute.specified) {\n            var value = attribute.value;\n\n            if (value === 'true') {\n                value = true;\n            } else if (value === 'false') {\n                value = false;\n            } else if (parseInt(value)) {\n                value = parseInt(value);\n            }\n\n            options[attribute.name] = value;\n        }\n    }\n\n    this.glslEditor = new GlslEditor(this, options);\n};\n\ndocument.registerElement('glsl-editor', GlslWebComponent);\nmodule.exports = exports['default'];\n\n},{\"./core/Editor\":121,\"./core/Shader\":122,\"./io/BufferManager\":123,\"./io/FileDrop\":124,\"./io/HashWatch\":125,\"./io/LocalStorage\":126,\"./tools/mixin\":132,\"./ui/ErrorsDisplay\":134,\"./ui/ExportIcon\":135,\"./ui/Helpers\":136,\"./ui/Menu\":137,\"./ui/VisualDebugger\":139,\"./vendor/FileSaver.min.js\":152,\"babel-runtime/core-js/object/create\":3,\"babel-runtime/core-js/object/keys\":6,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14,\"cross-storage\":109,\"document-register-element\":110,\"xhr\":118}],121:[function(_dereq_,module,exports){\n// Import CodeMirror\n'use strict';\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.initEditor = initEditor;\nexports.unfocusLine = unfocusLine;\nexports.unfocusAll = unfocusAll;\nexports.focusLine = focusLine;\nexports.focusAll = focusAll;\n\nvar _codemirror = _dereq_('codemirror');\n\nvar _codemirror2 = _interopRequireDefault(_codemirror);\n\n// Import CodeMirror addons and modules\n\n_dereq_('codemirror/addon/search/search');\n\n_dereq_('codemirror/addon/search/searchcursor');\n\n_dereq_('codemirror/addon/comment/comment');\n\n_dereq_('codemirror/addon/dialog/dialog');\n\n_dereq_('codemirror/addon/edit/matchbrackets');\n\n_dereq_('codemirror/addon/edit/closebrackets');\n\n_dereq_('codemirror/addon/wrap/hardwrap');\n\n_dereq_('codemirror/addon/fold/foldcode');\n\n_dereq_('codemirror/addon/fold/foldgutter');\n\n_dereq_('codemirror/addon/fold/indent-fold');\n\n_dereq_('codemirror/addon/hint/show-hint');\n\n_dereq_('codemirror/addon/hint/javascript-hint');\n\n_dereq_('codemirror/addon/display/rulers');\n\n_dereq_('codemirror/addon/display/panel');\n\n_dereq_('codemirror/mode/clike/clike.js');\n\n// Keymap\n\n_dereq_('codemirror/keymap/sublime');\n\nvar UNFOCUS_CLASS = 'ge_editor-unfocus';\n\nfunction initEditor(main) {\n    if (main.options.lineNumbers === undefined) {\n        main.options.lineNumbers = true;\n    }\n\n    // CREATE AND START CODEMIRROR\n    var el = document.createElement('div');\n    el.setAttribute('class', 'ge_editor');\n\n    // If there is a menu offset the editor to come after it\n    if (main.menu) {\n        el.style.paddingTop = (main.menu.el.clientHeight || main.menu.el.offsetHeight || main.menu.el.scrollHeight) + 'px';\n    }\n\n    main.container.appendChild(el);\n\n    var cm = (0, _codemirror2['default'])(el, {\n        value: main.options.frag,\n        viewportMargin: Infinity,\n        lineNumbers: main.options.lineNumbers,\n        matchBrackets: true,\n        mode: 'x-shader/x-fragment',\n        keyMap: 'sublime',\n        autoCloseBrackets: true,\n        extraKeys: { 'Ctrl-Space': 'autocomplete' },\n        showCursorWhenSelecting: true,\n        theme: main.options.theme,\n        dragDrop: false,\n        indentUnit: 4,\n        gutters: main.options.lineNumbers ? ['CodeMirror-linenumbers', 'breakpoints'] : false,\n        lineWrapping: true,\n        autofocus: true\n    });\n    return cm;\n}\n\nfunction unfocusLine(cm, line) {\n    if (line === null) {\n        return;\n    }\n    cm.getDoc().addLineClass(line, 'gutter', UNFOCUS_CLASS);\n    cm.getDoc().addLineClass(line, 'text', UNFOCUS_CLASS);\n}\n\nfunction unfocusAll(cm) {\n    for (var i = 0, j = cm.getDoc().lineCount(); i <= j; i++) {\n        unfocusLine(cm, i);\n    }\n}\n\nfunction focusLine(cm, line) {\n    if (line === null) {\n        return;\n    }\n    cm.getDoc().removeLineClass(line, 'gutter', UNFOCUS_CLASS);\n    cm.getDoc().removeLineClass(line, 'text', UNFOCUS_CLASS);\n}\n\nfunction focusAll(cm) {\n    for (var i = 0, j = cm.getDoc().lineCount(); i <= j; i++) {\n        focusLine(cm, i);\n    }\n}\n\n},{\"babel-runtime/helpers/interop-require-default\":14,\"codemirror\":30,\"codemirror/addon/comment/comment\":15,\"codemirror/addon/dialog/dialog\":16,\"codemirror/addon/display/panel\":17,\"codemirror/addon/display/rulers\":18,\"codemirror/addon/edit/closebrackets\":19,\"codemirror/addon/edit/matchbrackets\":20,\"codemirror/addon/fold/foldcode\":21,\"codemirror/addon/fold/foldgutter\":22,\"codemirror/addon/fold/indent-fold\":23,\"codemirror/addon/hint/javascript-hint\":24,\"codemirror/addon/hint/show-hint\":25,\"codemirror/addon/search/search\":26,\"codemirror/addon/search/searchcursor\":27,\"codemirror/addon/wrap/hardwrap\":28,\"codemirror/keymap/sublime\":29,\"codemirror/mode/clike/clike.js\":31}],122:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _glslCanvas = _dereq_('glslCanvas');\n\nvar _glslCanvas2 = _interopRequireDefault(_glslCanvas);\n\nvar _toolsInteractiveDom = _dereq_('../tools/interactiveDom');\n\nvar _toolsMediaCapture = _dereq_('../tools/mediaCapture');\n\nvar _toolsMediaCapture2 = _interopRequireDefault(_toolsMediaCapture);\n\nvar _uiMenuItem = _dereq_('../ui/MenuItem');\n\nvar _uiMenuItem2 = _interopRequireDefault(_uiMenuItem);\n\n// 3er Parties\n\nvar _vendorFileSaverMinJs = _dereq_('../vendor/FileSaver.min.js');\n\nvar CONTROLS_CLASSNAME = 'ge_control';\nvar CONTROLS_PANEL_CLASSNAME = 'ge_control_panel';\n\nvar Shader = (function () {\n    function Shader(main) {\n        var _this = this;\n\n        _classCallCheck(this, Shader);\n\n        this.main = main;\n        this.options = main.options;\n        this.frag = '';\n\n        // DOM CONTAINER\n        this.el = document.createElement('div');\n        this.el.setAttribute('class', 'ge_canvas_container');\n        // CREATE AND START GLSLCANVAS\n        this.elCanvas = document.createElement('canvas');\n        this.elCanvas.setAttribute('class', 'ge_canvas');\n        this.elCanvas.setAttribute('data-fragment', this.options.frag_header + this.options.frag + this.options.frag_footer);\n        this.el.appendChild(this.elCanvas);\n        var glslcanvas = new _glslCanvas2['default'](this.elCanvas, { premultipliedAlpha: false, preserveDrawingBuffer: true, backgroundColor: 'rgba(1,1,1,1)' });\n\n        var width = this.options.canvas_width || this.options.canvas_size || '250';\n        var height = this.options.canvas_height || this.options.canvas_size || '250';\n        glslcanvas.canvas.style.width = width + 'px';\n        glslcanvas.canvas.style.height = height + 'px';\n        glslcanvas.resize();\n\n        this.canvas = glslcanvas;\n\n        if (this.options.imgs && this.options.imgs.length > 0) {\n            for (var i in this.options.imgs) {\n                this.canvas.setUniform('u_tex' + i, this.options.imgs[i]);\n            }\n        }\n\n        // Media Capture\n        this.mediaCapture = new _toolsMediaCapture2['default']();\n        this.mediaCapture.setCanvas(this.elCanvas);\n        this.canvas.on('render', function () {\n            _this.mediaCapture.completeScreenshot();\n        });\n\n        if (main.options.displayMenu) {\n            // CONTROLS\n            this.controlsContainer = document.createElement('ul');\n            this.controlsContainer.className = CONTROLS_CLASSNAME;\n            this.controlPanel = document.createElement('ul');\n            this.controlPanel.className = CONTROLS_PANEL_CLASSNAME;\n            this.controlsContainer.appendChild(this.controlPanel);\n            this.el.appendChild(this.controlsContainer);\n            this.controls = {};\n            // play/stop\n            // this.controls.playPause = new MenuItem(this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">pause</i>', (event) => {\n            this.controls.playPause = new _uiMenuItem2['default'](this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">pause</i>', function (event) {\n                event.stopPropagation();\n                event.preventDefault();\n                if (glslcanvas.paused) {\n                    glslcanvas.play();\n                    // this.controls.playPause.name = '<i class=\"material-icons\">pause</i>';//'Pause';\n                    _this.controls.playPause.name = '<i class=\"material-icons\">pause</i>'; //'Pause';\n                } else {\n                        glslcanvas.pause();\n                        _this.controls.playPause.name = '<i class=\"material-icons\">play_arrow</i>'; //'Play';\n                    }\n            });\n            // rec\n            this.isCapturing = false;\n            // let rec = new MenuItem(this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">fiber_manual_record</i>', (event) => {\n            var rec = new _uiMenuItem2['default'](this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">&#xE061;</i>', function (event) {\n                event.stopPropagation();\n                event.preventDefault();\n                if (_this.isCapturing) {\n                    _this.stopVideoCapture();\n                } else {\n                    _this.startVideoCapture();\n                }\n            });\n            this.controls.rec = rec;\n            this.controls.rec.button.style.color = 'red';\n\n            // present mode (only if there is a presentation.html file to point to)\n            // this.controls.presentationMode = new MenuItem(this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">open_in_new</i>', (event) => {\n            this.controls.presentationMode = new _uiMenuItem2['default'](this.controlPanel, 'ge_control_element', '<i class=\"material-icons\">open_in_new</i>', function (event) {\n                event.stopPropagation();\n                event.preventDefault();\n                if (main.pWindowOpen) {\n                    main.togglePresentationWindow(false);\n                } else {\n                    main.togglePresentationWindow(true);\n                }\n            });\n\n            this.elControl = this.el.getElementsByClassName(CONTROLS_CLASSNAME)[0];\n            this.elControl.addEventListener('mouseenter', function (event) {\n                _this.showControls();\n            });\n            this.elControl.addEventListener('mouseleave', function (event) {\n                _this.hideControls();\n            });\n            this.elCanvas.addEventListener('mousemove', function (event) {\n                if (event.offsetY > _this.elCanvas.clientHeight * .66) {\n                    _this.showControls();\n                } else {\n                    _this.hideControls();\n                }\n            });\n            this.hideControls();\n        }\n\n        // ========== EVENTS\n        // Draggable/resizable/snappable\n        if (main.options.canvas_draggable || main.options.canvas_resizable || main.options.canvas_snapable) {\n            (0, _toolsInteractiveDom.subscribeInteractiveDom)(this.el, {\n                move: main.options.canvas_draggable,\n                resize: main.options.canvas_resizable,\n                snap: main.options.canvas_snapable\n            });\n\n            if (main.options.canvas_size === 'halfscreen') {\n                this.el.snapRight();\n            }\n\n            this.el.on('move', function (event) {\n                event.el.style.width = event.el.clientWidth + 'px';\n                event.el.style.height = event.el.clientHeight + 'px';\n            });\n            this.el.on('resize', function (event) {\n                glslcanvas.canvas.style.width = event.el.clientWidth + 'px';\n                glslcanvas.canvas.style.height = event.el.clientHeight + 'px';\n                glslcanvas.resize();\n            });\n        }\n\n        // If there is a menu offset the editor to come after it\n        if (main.menu) {\n            this.el.style.top = (main.menu.el.clientHeight || main.menu.el.offsetHeight || main.menu.el.scrollHeight) + 'px';\n        }\n\n        // Add all this to the main container\n        main.container.appendChild(this.el);\n        glslcanvas.resize();\n    }\n\n    _createClass(Shader, [{\n        key: 'hideControls',\n        value: function hideControls() {\n            if (this.elControl && this.elControl.className === CONTROLS_CLASSNAME) {\n                this.elControl.className = CONTROLS_CLASSNAME + ' ' + CONTROLS_CLASSNAME + '_hidden';\n            }\n        }\n    }, {\n        key: 'showControls',\n        value: function showControls() {\n            if (this.elControl && this.elControl.className === CONTROLS_CLASSNAME + ' ' + CONTROLS_CLASSNAME + '_hidden') {\n                this.elControl.className = CONTROLS_CLASSNAME;\n            }\n        }\n    }, {\n        key: 'requestRedraw',\n        value: function requestRedraw() {\n            this.canvas.forceRender = true;\n            this.canvas.render();\n        }\n    }, {\n        key: 'screenshot',\n        value: function screenshot() {\n            this.requestRedraw();\n            return this.mediaCapture.screenshot();\n        }\n    }, {\n        key: 'startVideoCapture',\n        value: function startVideoCapture() {\n            this.requestRedraw();\n            if (this.mediaCapture.startVideoCapture()) {\n                this.isCapturing = true;\n                this.controls.rec.button.style.color = 'white';\n                // this.controls.rec.name = '<i class=\"material-icons\">stop</i>';\n                this.controls.rec.name = '<i class=\"material-icons\">&#xE061;</i>';\n            }\n        }\n    }, {\n        key: 'stopVideoCapture',\n        value: function stopVideoCapture() {\n            if (this.isCapturing) {\n                this.isCapturing = false;\n                this.controls.rec.button.style.color = 'red';\n                // this.controls.rec.name = '<i class=\"material-icons\">fiber_manual_record</i>';\n                this.controls.rec.name = '<i class=\"material-icons\">stop</i>';\n                this.mediaCapture.stopVideoCapture().then(function (video) {\n                    (0, _vendorFileSaverMinJs.saveAs)(video.blob, Number(new Date()) + '.webm');\n                });\n            }\n        }\n    }, {\n        key: 'openWindow',\n        value: function openWindow() {\n            this.originalSize = { width: this.canvas.canvas.clientWidth, height: this.canvas.canvas.clientHeight };\n            this.presentationWindow = window.open('', '_blank', 'presentationWindow');\n            this.setUpPresentationWindow();\n        }\n    }, {\n        key: 'closeWindow',\n        value: function closeWindow() {\n            if (this.presentationWindow) {\n                this.presentationWindow.close();\n            }\n        }\n    }, {\n        key: 'setCanvasSize',\n        value: function setCanvasSize(w, h) {\n            this.canvas.canvas.style.width = w + 'px';\n            this.canvas.canvas.style.height = h + 'px';\n        }\n    }, {\n        key: 'setUpPresentationWindow',\n        value: function setUpPresentationWindow() {\n            this.presentationWindow.document.body.appendChild(this.canvas.canvas);\n            var d = this.presentationWindow.document;\n            var div = d.createElement('div');\n            div.appendChild(d.createTextNode('Projector mode'));\n            var span = this.presentationWindow.document.createElement('span');\n            div.appendChild(span);\n            span.appendChild(d.createTextNode(\" - If the canvas doesn't update, drag this window and reveal the editor\"));\n            d.body.appendChild(div);\n\n            d.title = 'GLSL Editor';\n            d.body.style.padding = '0';\n            d.body.style.margin = '0';\n            d.body.style.background = '#171e22';\n            d.body.style.overflow = 'hidden';\n\n            div.style.position = 'absolute';\n            div.style.width = '100%';\n            div.style.background = 'rgba(0, 0, 0, 0.5)';\n            div.style.position = 'absolute';\n            div.style.top = '0';\n            div.style.left = '0';\n            div.style.right = '0';\n            div.style.padding = '16px';\n            div.style.color = '#ffffff';\n            div.style.fontSize = '14px';\n            div.style.fontFamily = 'Helvetica, Geneva, sans-serif';\n            div.style.fontWeight = '400';\n            div.style.letterSpacing = '0.1em';\n            div.style.textAlign = 'center';\n            div.style.opacity = '1';\n            div.style.zIndex = '9999';\n            div.style.setProperty('-webkit-transition', 'opacity 1.5s');\n            div.style.setProperty('-moz-transition', 'opacity 1.5s');\n            div.style.setProperty('transition', 'opacity 1.5s');\n\n            span.style.color = 'rgba(255, 255, 255, 0.5)';\n\n            setTimeout(function () {\n                div.style.opacity = 0;\n            }, 4000);\n\n            this.setCanvasSize(this.presentationWindow.innerWidth, this.presentationWindow.innerHeight);\n            this.presentationWindow.addEventListener('resize', this.onPresentationWindowResize.bind(this));\n            this.presentationWindow.addEventListener('unload', this.onPresentationWindowClose.bind(this));\n        }\n    }, {\n        key: 'onPresentationWindowClose',\n        value: function onPresentationWindowClose() {\n            this.el.appendChild(this.canvas.canvas);\n            this.setCanvasSize(this.originalSize.width, this.originalSize.height);\n            this.canvas.resize();\n\n            this.main.onClosePresentationWindow();\n            this.main.menu.onClosePresentationWindow();\n            this.presentationWindow = null;\n        }\n    }, {\n        key: 'onPresentationWindowResize',\n        value: function onPresentationWindowResize() {\n            if (this.presentationWindow) {\n                this.setCanvasSize(this.presentationWindow.innerWidth, this.presentationWindow.innerHeight);\n                this.canvas.resize();\n            }\n        }\n    }]);\n\n    return Shader;\n})();\n\nexports['default'] = Shader;\nmodule.exports = exports['default'];\n\n},{\"../tools/interactiveDom\":130,\"../tools/mediaCapture\":131,\"../ui/MenuItem\":138,\"../vendor/FileSaver.min.js\":152,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14,\"glslCanvas\":113}],123:[function(_dereq_,module,exports){\n// Import CodeMirror\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _Object$keys = _dereq_('babel-runtime/core-js/object/keys')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _codemirror = _dereq_('codemirror');\n\nvar _codemirror2 = _interopRequireDefault(_codemirror);\n\n_dereq_('codemirror/mode/clike/clike.js');\n\nvar BufferManager = (function () {\n    function BufferManager(main) {\n        _classCallCheck(this, BufferManager);\n\n        this.main = main;\n        this.buffers = {};\n        this.tabs = {};\n        this.current = 'untitled';\n    }\n\n    _createClass(BufferManager, [{\n        key: 'open',\n        value: function open(name, content) {\n            var _this = this;\n\n            if (!this.el) {\n                // Create DOM element\n                this.el = document.createElement('ul');\n                this.el.className = 'ge_panel';\n            }\n\n            if (this.main.change && this.current === 'untitled') {\n                console.log('Open Current in a different tab');\n                this.open(this.current, this.main.getContent());\n            }\n\n            this.buffers[name] = _codemirror2['default'].Doc(content, 'x-shader/x-fragment');\n\n            // Create a new tab\n            var tab = document.createElement('li');\n            tab.setAttribute('class', 'ge_panel_tab');\n            tab.textContent = name;\n            _codemirror2['default'].on(tab, 'click', function () {\n                _this.select(name);\n            });\n\n            var close = tab.appendChild(document.createElement('a'));\n            close.textContent = 'x';\n            close.setAttribute('class', 'ge_panel_tab_close');\n            _codemirror2['default'].on(close, 'click', function () {\n                _this.close(name);\n            });\n\n            this.el.appendChild(tab);\n            this.tabs[name] = tab;\n\n            if (this.el && !this.panel && this.getLength() > 1) {\n                // Create Panel CM element\n                this.panel = this.main.editor.addPanel(this.el, { position: 'top' });\n            }\n        }\n    }, {\n        key: 'select',\n        value: function select(name) {\n            var buf = this.buffers[name];\n\n            if (buf === undefined) {\n                return;\n            }\n\n            if (buf.getEditor()) {\n                buf = buf.linkedDoc({ sharedHist: true });\n            }\n            var old = this.main.editor.swapDoc(buf);\n            var linked = old.iterLinkedDocs(function (doc) {\n                linked = doc;\n            });\n            if (linked) {\n                // Make sure the document in buffers is the one the other view is looking at\n                for (var bufferName in this.buffers) {\n                    if (this.buffers[bufferName] === old) {\n                        this.buffers[bufferName] = linked;\n                    }\n                }\n                old.unlinkDoc(linked);\n            }\n            this.main.editor.focus();\n            this.main.setContent(this.main.getContent());\n\n            if (this.tabs[this.current]) {\n                this.tabs[this.current].setAttribute('class', 'ge_panel_tab');\n            }\n            this.tabs[name].setAttribute('class', 'ge_panel_tab_active');\n            this.current = name;\n\n            this.main.editor.setSize(null, 'auto');\n            this.main.editor.getWrapperElement().style.height = 'auto';\n\n            this.main.trigger('new_content', {});\n        }\n    }, {\n        key: 'close',\n        value: function close(name) {\n            var needChange = name === this.getCurrent();\n\n            this.el.removeChild(this.tabs[name]);\n            delete this.tabs[name];\n            delete this.buffers[name];\n\n            if (this.getLength() === 1) {\n                this.panel.clear();\n                this.panel = undefined;\n                this.el = undefined;\n            }\n\n            if (needChange) {\n                for (var prop in this.tabs) {\n                    this.select(prop);\n                    break;\n                }\n            }\n        }\n    }, {\n        key: 'getCurrent',\n        value: function getCurrent() {\n            return this.current;\n        }\n    }, {\n        key: 'getLength',\n        value: function getLength() {\n            return _Object$keys(this.buffers).length;\n        }\n    }]);\n\n    return BufferManager;\n})();\n\nexports['default'] = BufferManager;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/core-js/object/keys\":6,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14,\"codemirror\":30,\"codemirror/mode/clike/clike.js\":31}],124:[function(_dereq_,module,exports){\n/*\nOriginal: https://github.com/tangrams/tangram-play/blob/gh-pages/src/js/addons/ui/FileDrop.js\nAuthor: Lou Huang (@saikofish)\n*/\n\n'use strict';\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar FileDrop = function FileDrop(main) {\n    _classCallCheck(this, FileDrop);\n\n    // Set up drag/drop file listeners\n    main.container.addEventListener('dragenter', function (event) {\n        // Check to make sure that dropped items are files.\n        // This prevents other drags (e.g. text in editor)\n        // from turning on the file drop area.\n        // See here: http://stackoverflow.com/questions/6848043/how-do-i-detect-a-file-is-being-dragged-rather-than-a-draggable-element-on-my-pa\n        // Tested in Chrome, Firefox, Safari 8\n        var types = event.dataTransfer.types;\n        if (types !== null && (types.indexOf ? types.indexOf('Files') !== -1 : types.contains('application/x-moz-file'))) {\n            event.preventDefault();\n            event.dataTransfer.dropEffect = 'copy';\n        }\n    }, true);\n\n    main.container.addEventListener('dragover', function (event) {\n        // Required to prevent browser from navigating to a file\n        // instead of receiving a data transfer\n        event.preventDefault();\n    }, false);\n\n    main.container.addEventListener('dragleave', function (event) {\n        event.preventDefault();\n    }, true);\n\n    main.container.addEventListener('drop', function (event) {\n        event.preventDefault();\n        if (event.dataTransfer.files.length > 0) {\n            var file = event.dataTransfer.files[0];\n            main.open(file);\n        }\n    }, false);\n};\n\nexports['default'] = FileDrop;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10}],125:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar HashWatch = (function () {\n    function HashWatch(main) {\n        var _this = this;\n\n        _classCallCheck(this, HashWatch);\n\n        this.main = main;\n        this.check();\n\n        window.addEventListener('hashchange', function () {\n            _this.check();\n        }, false);\n    }\n\n    _createClass(HashWatch, [{\n        key: 'check',\n        value: function check() {\n            if (window.location.hash !== '') {\n                this.main.options.imgs = [];\n\n                var hashes = location.hash.split('&');\n                for (var i in hashes) {\n                    var ext = hashes[i].substr(hashes[i].lastIndexOf('.') + 1);\n                    var path = hashes[i];\n\n                    // Extract hash if is present\n                    if (path.search('#') === 0) {\n                        path = path.substr(1);\n                    }\n\n                    var filename = path.split('/').pop();\n\n                    if (ext === 'frag') {\n                        this.main.open(path, filename.replace(/\\.[^/.]+$/, ''));\n                    } else if (ext === 'png' || ext === 'jpg' || ext === 'PNG' || ext === 'JPG') {\n                        this.main.options.imgs.push(path);\n                    }\n                }\n            }\n\n            var query = parseQuery(window.location.search.slice(1));\n            if (query) {\n                for (var key in query) {\n                    if (key === 'log') {\n                        if (this.main.bufferManager) {\n                            var logs = query.log.split(',');\n                            for (var i in logs) {\n                                this.main.open('https://thebookofshaders.com/log/' + logs[i] + '.frag', logs[i]);\n                            }\n                        } else {\n                            this.main.open('https://thebookofshaders.com/log/' + query.log + '.frag', query.log);\n                        }\n                    } else {\n                        var value = query[key];\n                        if (value === 'true' || value === 'false') {\n                            value = value == 'true';\n                        } else if (parseFloat(value)) {\n                            value = parseFloat(value);\n                        }\n                        this.main.options[key] = value;\n                    }\n                }\n            }\n        }\n    }]);\n\n    return HashWatch;\n})();\n\nexports['default'] = HashWatch;\n\nfunction parseQuery(qstr) {\n    var query = {};\n    var a = qstr.split('&');\n    for (var i in a) {\n        var b = a[i].split('=');\n        query[decodeURIComponent(b[0])] = decodeURIComponent(b[1]);\n    }\n    return query;\n}\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],126:[function(_dereq_,module,exports){\n/*\nOriginal: https://github.com/tangrams/tangram-play/blob/gh-pages/src/js/addons/LocalStorage.js\nAuthor: Lou Huang (@saikofish)\n*/\n\n/**\n *  Local storage\n *\n *  Provides a common interface for the application where modules can\n *  request storage of values across multiple user sessions via the\n *  browser's LocalStorage API.\n *\n *  Browser support is good, so no fallbacks are implemented.\n *  This module manages namespacing for Tangram Play to prevent name\n *  collisions with other libraries, browser extensions, etc.\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nvar LOCAL_STORAGE_PREFIX = 'glslEditor-';\n\nvar LocalStorage = {\n    /**\n     *  setItem()\n     *  Namespaces key name to Tangram Play application and adds\n     *  the value to LocalStorage.\n     */\n    setItem: function setItem(key, value) {\n        if (window.localStorage) {\n            window.localStorage.setItem(LOCAL_STORAGE_PREFIX + key, value);\n        }\n    },\n\n    /**\n     *  pushItem()\n     *  Store values as an array. If the key doesn't exist as an object, create it.\n     *  Note that this overwrites an old value if it is present and not a JSON object!\n     *  If it exists, retreive it, serialize it into JSON, push the new value,\n     *  re-encode to a string and then set it back in localStorage.\n     *  No other array methods are implemented. If you need to delete items, etc\n     *  then retrieve the string as normal, do the work in your script, and then\n     *  set it to the new stringified array instead of pushing it.\n     */\n    pushItem: function pushItem(key, value) {\n        var stored = undefined;\n        stored = this.getItem(key);\n        // In case there is a previously stored item here that is not\n        // parseable JSON, don't fail\n        try {\n            stored = JSON.parse(stored);\n            stored.arr = stored.arr || [];\n        } catch (e) {\n            stored = { arr: [] };\n        }\n        stored.arr.push(value);\n        this.setItem(key, JSON.stringify(stored));\n    },\n\n    /**\n     *  getItem()\n     *  Retrieves value for the given key name and application namespace.\n     */\n    getItem: function getItem(key) {\n        if (window.localStorage) {\n            return window.localStorage.getItem(LOCAL_STORAGE_PREFIX + key);\n        }\n    },\n\n    /**\n     *  removeItem()\n     *  Removes key-value pair under the application namespace.\n     */\n    removeItem: function removeItem(key) {\n        if (window.localStorage) {\n            window.localStorage.removeItem(LOCAL_STORAGE_PREFIX + key);\n        }\n    },\n\n    /**\n     *  clear()\n     *  Loops through all values in localStorage under the application\n     *  namespace and removes them, preserving other key-value pairs in\n     *  localStorage.\n     */\n    clear: function clear() {\n        if (window.localStorage) {\n            for (var key in window.localStorage) {\n                if (key.indexOf(LOCAL_STORAGE_PREFIX) === 0) {\n                    window.localStorage.removeItem(LOCAL_STORAGE_PREFIX + key);\n                }\n            }\n        }\n    }\n};\n\nexports['default'] = LocalStorage;\nmodule.exports = exports['default'];\n\n},{}],127:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.saveOnServer = saveOnServer;\nexports.createOpenFrameArtwork = createOpenFrameArtwork;\nvar lastReplay;\n\nfunction saveOnServer(ge, callback) {\n    if (!ge.change && lastReplay) {\n        callback(lastReplay);\n        return;\n    }\n\n    var content = ge.getContent();\n    var name = ge.getAuthor();\n    var title = ge.getTitle();\n\n    if (name !== '' && title !== '') {\n        name += '-' + title;\n    }\n\n    // STORE A COPY on SERVER\n    var url = 'https://thebookofshaders.com:8080/';\n    // let url = 'http://localhost:8080/';\n    var data = new FormData();\n    data.append('code', content);\n\n    var dataURL = ge.shader.el_canvas.toDataURL('image/png');\n    var blobBin = atob(dataURL.split(',')[1]);\n    var array = [];\n    for (var i = 0; i < blobBin.length; i++) {\n        array.push(blobBin.charCodeAt(i));\n    }\n    var file = new Blob([new Uint8Array(array)], { type: 'image/png' });\n    data.append('image', file);\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', url + 'save', true);\n    xhr.onload = function (event) {\n        if (typeof callback === 'function') {\n            var _name = xhr.responseText;\n            var replay = {\n                content: content,\n                name: _name,\n                url: url\n            };\n            callback(replay);\n            lastReplay = replay;\n        }\n    };\n    xhr.send(data);\n}\n\nfunction createOpenFrameArtwork(glslEditor, name, url, callback) {\n    var OF_BASE_API_URL = 'https://api.openframe.io/v0';\n    var OF_BASE_APP_URL = 'https://openframe.io';\n    // const OF_BASE_API_URL = 'http://localhost:8888/api'; // for local testing\n    // const OF_BASE_APP_URL = 'http://localhost:8000'; // for local testing\n    var title = glslEditor.getTitle();\n    var author = glslEditor.getAuthor();\n    glslEditor.getOfToken().then(initiateOfRequest);\n\n    function initiateOfRequest(ofToken) {\n        var xhr = new XMLHttpRequest();\n        if (typeof callback === 'undefined') {\n            callback = function () {};\n        }\n        // anywhere in the API that user {id} is needed, the alias 'current' can be used for the logged-in user\n        xhr.open('POST', OF_BASE_API_URL + '/users/current/created_artwork');\n        // set content type to JSON...\n        xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n        xhr.setRequestHeader('Authorization', ofToken);\n        xhr.setRequestHeader('access_token', ofToken);\n\n        // This is essential in order to include auth cookies:\n        xhr.onload = function (event) {\n            console.log('onload', event);\n            if (event.currentTarget.status >= 400) {\n                (function () {\n                    window.open(OF_BASE_APP_URL + '/login', 'login', 'width=500,height=600');\n                    var successListener = function successListener(e) {\n                        if (e.data === 'success') {\n                            createOpenFrameArtwork(glslEditor, name, url, callback);\n                        }\n                        window.removeEventListener('message', successListener);\n                    };\n                    window.addEventListener('message', successListener, false);\n                })();\n            } else if (event.currentTarget.status === 200) {\n                callback(true);\n            } else {\n                callback(false);\n            }\n        };\n        xhr.onerror = function (event) {\n            console.log('Status:', event.currentTarget.status);\n        };\n        /* Remote expects underscore keys */\n        /* eslint-disable camelcase */\n        xhr.send(JSON.stringify({\n            title: title,\n            author_name: author,\n            is_public: false,\n            format: 'openframe-glslviewer',\n            url: 'https://thebookofshaders.com/log/' + name + '.frag',\n            thumb_url: 'https://thebookofshaders.com/log/' + name + '.png'\n            /* eslint-enable camelcase */\n        }));\n    }\n}\n\n},{}],128:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.getDomOrigin = getDomOrigin;\nexports.getDevicePixelRatio = getDevicePixelRatio;\n\nfunction getDomOrigin(el) {\n    var box = el.getBoundingClientRect ? el.getBoundingClientRect() : { top: 0, left: 0 };\n    var doc = el && el.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView || doc.parentWindow || window;\n    var docElem = doc.documentElement || body.parentNode;\n    var clientTop = docElem.clientTop || body.clientTop || 0; // border on html or body or both\n    var clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\n    return {\n        left: box.left + (win.pageXOffset || docElem.scrollLeft) - clientLeft,\n        top: box.top + (win.pageYOffset || docElem.scrollTop) - clientTop\n    };\n}\n\nfunction getDevicePixelRatio(ctx) {\n    var devicePixelRatio = window.devicePixelRatio || 1;\n    var backingStoreRatio = ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;\n    return devicePixelRatio / backingStoreRatio;\n}\n\n},{}],129:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.isCommented = isCommented;\nexports.isLineAfterMain = isLineAfterMain;\nexports.getVariableType = getVariableType;\nexports.getShaderForTypeVarInLine = getShaderForTypeVarInLine;\nexports.getResultRange = getResultRange;\nexports.getMedian = getMedian;\nexports.getDeltaSum = getDeltaSum;\nexports.getHits = getHits;\n\nfunction isCommented(cm, nLine, match) {\n    var token = cm.getTokenAt({ line: nLine, ch: match.index });\n    if (token && token.type) {\n        return token.type === 'comment';\n    }\n    return false;\n}\n\nfunction isLineAfterMain(cm, nLine) {\n    var totalLines = cm.getDoc().size;\n    var voidRE = new RegExp('void main\\\\s*\\\\(\\\\s*[void]*\\\\)', 'i');\n    for (var i = 0; i < nLine && i < totalLines; i++) {\n        // Do not start until being inside the main function\n        var voidMatch = voidRE.exec(cm.getLine(i));\n        if (voidMatch) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction getVariableType(cm, sVariable) {\n    var nLines = cm.getDoc().size;\n\n    // Show line where the value of the variable is been asigned\n    var uniformRE = new RegExp('\\\\s*uniform\\\\s+(float|vec2|vec3|vec4)\\\\s+' + sVariable + '\\\\s*;');\n    var voidRE = new RegExp('void main\\\\s*\\\\(\\\\s*[void]*\\\\)', 'i');\n    var voidIN = false;\n    var constructRE = new RegExp('(float|vec\\\\d)\\\\s+(' + sVariable + ')\\\\s*[;]?', 'i');\n    for (var i = 0; i < nLines; i++) {\n        if (!voidIN) {\n            // Do not start until being inside the main function\n            var voidMatch = voidRE.exec(cm.getLine(i));\n            if (voidMatch) {\n                voidIN = true;\n            } else {\n                var uniformMatch = uniformRE.exec(cm.getLine(i));\n                if (uniformMatch && !isCommented(cm, i, uniformMatch)) {\n                    return uniformMatch[1];\n                }\n            }\n        } else {\n            var constructMatch = constructRE.exec(cm.getLine(i));\n            if (constructMatch && constructMatch[1] && !isCommented(cm, i, constructMatch)) {\n                return constructMatch[1];\n            }\n        }\n    }\n    return 'none';\n}\n\nfunction getShaderForTypeVarInLine(cm, sType, sVariable, nLine) {\n    var frag = '';\n    var offset = 1;\n    for (var i = 0; i < nLine + 1 && i < cm.getDoc().size; i++) {\n        if (cm.getLine(i)) {\n            frag += cm.getLine(i) + '\\n';\n        }\n    }\n\n    frag += '\\tgl_FragColor = ';\n    if (sType === 'float') {\n        frag += 'vec4(vec3(' + sVariable + '),1.)';\n    } else if (sType === 'vec2') {\n        frag += 'vec4(vec3(' + sVariable + ',0.),1.)';\n    } else if (sType === 'vec3') {\n        frag += 'vec4(' + sVariable + ',1.)';\n    } else if (sType === 'vec4') {\n        frag += sVariable;\n    }\n    frag += ';\\n}\\n';\n\n    return frag;\n}\n\nfunction getResultRange(testResults) {\n    var minMS = '10000000.0';\n    var minLine = 0;\n    var maxMS = '0.0';\n    var maxLine = 0;\n    for (var i in testResults) {\n        if (testResults[i].ms < minMS) {\n            minMS = testResults[i].ms;\n            minLine = testResults[i].line;\n        }\n        if (testResults[i].ms > maxMS) {\n            maxMS = testResults[i].ms;\n            maxLine = testResults[i].line;\n        }\n    }\n    return { min: { line: minLine, ms: minMS }, max: { line: maxLine, ms: maxMS } };\n}\n\nfunction getMedian(values) {\n    values.sort(function (a, b) {\n        return a - b;\n    });\n\n    var half = Math.floor(values.length / 2);\n\n    if (values.length % 2) {\n        return values[half];\n    } else {\n        return (values[half - 1] + values[half]) / 2.0;\n    }\n}\n\nfunction getDeltaSum(testResults) {\n    var total = 0.0;\n    for (var i in testResults) {\n        if (testResults[i].delta > 0) {\n            total += testResults[i].delta;\n        }\n    }\n    return total;\n}\n\nfunction getHits(testResults) {\n    var total = 0;\n    for (var i in testResults) {\n        if (testResults[i].delta > 0) {\n            total++;\n        }\n    }\n    return total;\n}\n\n},{}],130:[function(_dereq_,module,exports){\n/*\n * Original code from: https://twitter.com/blurspline / https://github.com/zz85\n * See post @ http://www.lab4games.net/zz85/blog/2014/11/15/resizing-moving-snapping-windows-with-js-css/\n */\n\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.subscribeInteractiveDom = subscribeInteractiveDom;\n\nvar _mixin = _dereq_('./mixin');\n\n// Thresholds\nvar FULLSCREEN_MARGINS = -30;\nvar MARGINS = 10;\n\nfunction setBounds(element, x, y, w, h) {\n    element.style.left = x + 'px';\n    element.style.top = y + 'px';\n    element.style.width = w + 'px';\n    element.style.height = h + 'px';\n}\n\nfunction subscribeInteractiveDom(dom, options) {\n    (0, _mixin.subscribeMixin)(dom);\n\n    options = options || {};\n    options.resize = options.resize !== undefined ? options.resize : false;\n    options.move = options.move !== undefined ? options.move : false;\n    options.snap = options.snap !== undefined ? options.snap : false;\n\n    // Minimum resizable area\n    var minWidth = 100;\n    var minHeight = 100;\n\n    // End of what's configurable.\n    var clicked = null;\n    var onRightEdge, onBottomEdge, onLeftEdge, onTopEdge;\n\n    var rightScreenEdge, bottomScreenEdge;\n\n    var preSnapped;\n\n    var b, x, y;\n\n    var redraw = false;\n\n    var ghostdom = document.createElement('div');\n    ghostdom.className = 'ghostdom';\n\n    if (options.snap) {\n        dom.parentElement.appendChild(ghostdom);\n    }\n\n    // Mouse events\n    dom.addEventListener('mousedown', onMouseDown);\n    document.addEventListener('mousemove', onMove);\n    document.addEventListener('mouseup', onUp);\n\n    // Touch events\n    dom.addEventListener('touchstart', onTouchDown);\n    document.addEventListener('touchmove', onTouchMove);\n    document.addEventListener('touchend', onTouchEnd);\n\n    function hintHide() {\n        setBounds(ghostdom, b.left, b.top, b.width, b.height);\n        ghostdom.style.opacity = 0;\n    }\n\n    function onTouchDown(event) {\n        onDown(event.touches[0]);\n        e.preventDefault();\n    }\n\n    function onTouchMove(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        onMove(event.touches[0]);\n    }\n\n    function onTouchEnd(event) {\n        if (event.touches.length === 0) {\n            onUp(e.changedTouches[0]);\n        }\n    }\n\n    function onMouseDown(event) {\n        onDown(event);\n        e.preventDefault();\n    }\n\n    function onDown(event) {\n        calc(event);\n        var isResizing = options.resize && (onRightEdge || onBottomEdge || onTopEdge || onLeftEdge);\n        clicked = {\n            x: x,\n            y: y,\n            cx: event.clientX,\n            cy: event.clientY,\n            w: b.width,\n            h: b.height,\n            isResizing: isResizing,\n            isMoving: !isResizing && canMove(),\n            onTopEdge: onTopEdge,\n            onLeftEdge: onLeftEdge,\n            onRightEdge: onRightEdge,\n            onBottomEdge: onBottomEdge\n        };\n    }\n\n    function canMove() {\n        return options.move && x > 0 && x < b.width && y > 0 && y < b.height; // && y < 30;\n    }\n\n    function calc(event) {\n        b = dom.getBoundingClientRect();\n        x = event.clientX - b.left;\n        y = event.clientY - b.top;\n\n        onTopEdge = y < MARGINS;\n        onLeftEdge = x < MARGINS;\n        onRightEdge = x >= b.width - MARGINS;\n        onBottomEdge = y >= b.height - MARGINS;\n\n        rightScreenEdge = window.innerWidth - MARGINS;\n        bottomScreenEdge = window.innerHeight - MARGINS;\n    }\n\n    var e;\n\n    function onMove(event) {\n        calc(event);\n        e = event;\n        redraw = true;\n    }\n\n    function animate() {\n        requestAnimationFrame(animate);\n\n        if (!redraw) {\n            return;\n        }\n        redraw = false;\n\n        if (clicked && clicked.isResizing) {\n            if (clicked.onRightEdge) {\n                dom.style.width = Math.max(x, minWidth) + 'px';\n            }\n            if (clicked.onBottomEdge) {\n                dom.style.height = Math.max(y, minHeight) + 'px';\n            }\n\n            if (clicked.onLeftEdge) {\n                var currentWidth = Math.max(clicked.cx - e.clientX + clicked.w, minWidth);\n                if (currentWidth > minWidth) {\n                    dom.style.width = currentWidth + 'px';\n                    dom.style.removeProperty('right');\n                    dom.style.left = e.clientX + 'px';\n                }\n            }\n\n            if (clicked.onTopEdge) {\n                var currentHeight = Math.max(clicked.cy - e.clientY + clicked.h, minHeight);\n                if (currentHeight > minHeight) {\n                    dom.style.height = currentHeight + 'px';\n                    dom.style.removeProperty('bottom');\n                    dom.style.top = e.clientY + 'px';\n                }\n            }\n\n            hintHide();\n            dom.trigger('resize', { finish: false, el: dom });\n            return;\n        }\n\n        if (clicked && clicked.isMoving) {\n            if (options.snap) {\n                if (b.top < FULLSCREEN_MARGINS || b.left < FULLSCREEN_MARGINS || b.right > window.innerWidth - FULLSCREEN_MARGINS || b.bottom > window.innerHeight - FULLSCREEN_MARGINS) {\n                    setBounds(ghostdom, 0, 0, window.innerWidth, window.innerHeight);\n                    ghostdom.style.opacity = 0.2;\n                } else if (b.top < MARGINS) {\n                    setBounds(ghostdom, 0, 0, window.innerWidth, window.innerHeight / 2);\n                    ghostdom.style.opacity = 0.2;\n                } else if (b.left < MARGINS) {\n                    setBounds(ghostdom, 0, 0, window.innerWidth / 2, window.innerHeight);\n                    ghostdom.style.opacity = 0.2;\n                } else if (b.right > rightScreenEdge) {\n                    setBounds(ghostdom, window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight);\n                    ghostdom.style.opacity = 0.2;\n                } else if (b.bottom > bottomScreenEdge) {\n                    setBounds(ghostdom, 0, window.innerHeight / 2, window.innerWidth, window.innerWidth / 2);\n                    ghostdom.style.opacity = 0.2;\n                } else {\n                    hintHide();\n                }\n\n                if (preSnapped) {\n                    setBounds(dom, e.clientX - preSnapped.width / 2, e.clientY - Math.min(clicked.y, preSnapped.height), preSnapped.width, preSnapped.height);\n                    return;\n                }\n\n                // moving\n                dom.style.removeProperty('right');\n                dom.style.removeProperty('bottom');\n                dom.style.top = e.clientY - clicked.y + 'px';\n                dom.style.left = e.clientX - clicked.x + 'px';\n            } else {\n                var _x = e.clientX - clicked.x;\n                var _y = e.clientY - clicked.y;\n\n                if (_x < 0) {\n                    _x = 0;\n                } else if (_y < 0) {\n                    _y = 0;\n                } else if (_x + dom.offsetWidth > window.innerWidth) {\n                    _x = window.innerWidth - dom.offsetWidth;\n                } else if (_y + dom.offsetHeight > window.innerHeight) {\n                    _y = window.innerHeight - dom.offsetHeight;\n                }\n\n                dom.style.removeProperty('right');\n                dom.style.removeProperty('bottom');\n                dom.style.left = _x + 'px';\n                dom.style.top = _y + 'px';\n            }\n\n            dom.trigger('move', { finish: false, el: dom });\n            return;\n        }\n        // This code executes when mouse moves without clicking\n\n        // style cursor\n        if (options.resize && (onRightEdge && onBottomEdge || onLeftEdge && onTopEdge)) {\n            dom.style.cursor = 'nwse-resize';\n        } else if (options.resize && (onRightEdge && onTopEdge || onBottomEdge && onLeftEdge)) {\n            dom.style.cursor = 'nesw-resize';\n        } else if (options.resize && (onRightEdge || onLeftEdge)) {\n            dom.style.cursor = 'ew-resize';\n        } else if (options.resize && (onBottomEdge || onTopEdge)) {\n            dom.style.cursor = 'ns-resize';\n        } else if (canMove()) {\n            dom.style.cursor = 'move';\n        } else {\n            dom.style.cursor = 'default';\n        }\n    }\n    animate();\n\n    function onUp(e) {\n        calc(e);\n\n        if (clicked && clicked.isResizing) {\n            dom.trigger('resize', { finish: true, el: dom });\n        }\n\n        if (options.snap && clicked && clicked.isMoving) {\n            // Snap\n            var snapped = {\n                width: b.width,\n                height: b.height\n            };\n\n            if (b.top < FULLSCREEN_MARGINS || b.left < FULLSCREEN_MARGINS || b.right > window.innerWidth - FULLSCREEN_MARGINS || b.bottom > window.innerHeight - FULLSCREEN_MARGINS) {\n                setBounds(dom, 0, 0, window.innerWidth, window.innerHeight);\n                preSnapped = snapped;\n            } else if (b.top < MARGINS) {\n                setBounds(dom, 0, 0, window.innerWidth, window.innerHeight / 2);\n                preSnapped = snapped;\n            } else if (b.left < MARGINS) {\n                setBounds(dom, 0, 0, window.innerWidth / 2, window.innerHeight);\n                preSnapped = snapped;\n            } else if (b.right > rightScreenEdge) {\n                setBounds(dom, window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight);\n                preSnapped = snapped;\n            } else if (b.bottom > bottomScreenEdge) {\n                setBounds(dom, 0, window.innerHeight / 2, window.innerWidth, window.innerWidth / 2);\n                preSnapped = snapped;\n            } else {\n                preSnapped = null;\n            }\n            hintHide();\n            dom.trigger('move', { finish: true, el: dom });\n            dom.trigger('resize', { finish: true, el: dom });\n        }\n        clicked = null;\n    }\n\n    dom.snapRight = function () {\n        var snapped = {\n            width: dom.width,\n            height: dom.height\n        };\n\n        setBounds(dom, window.innerWidth / 2, 0, window.innerWidth / 2, window.innerHeight);\n        preSnapped = snapped;\n        // hintHide();\n        dom.trigger('move', { finish: true, el: dom });\n        dom.trigger('resize', { finish: true, el: dom });\n    };\n\n    return dom;\n}\n\n},{\"./mixin\":132}],131:[function(_dereq_,module,exports){\n/* global MediaRecorder\nAuthor: Brett Camper (@professorlemeza)\nURL: https://github.com/tangrams/tangram/blob/master/src/utils/media_capture.js\n*/\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _Promise = _dereq_('babel-runtime/core-js/promise')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _urls = _dereq_('./urls');\n\nvar MediaCapture = (function () {\n    function MediaCapture() {\n        _classCallCheck(this, MediaCapture);\n\n        this.queueScreenshot = null;\n        this.videoCapture = null;\n    }\n\n    _createClass(MediaCapture, [{\n        key: 'setCanvas',\n        value: function setCanvas(canvas) {\n            this.canvas = canvas;\n        }\n\n        // Take a screenshot, returns a promise that resolves with the screenshot data when available\n    }, {\n        key: 'screenshot',\n        value: function screenshot() {\n            var _this = this;\n\n            if (this.queueScreenshot != null) {\n                return this.queueScreenshot.promise; // only capture one screenshot at a time\n            }\n\n            // Will resolve once rendering is complete and render buffer is captured\n            this.queueScreenshot = {};\n            this.queueScreenshot.promise = new _Promise(function (resolve, reject) {\n                _this.queueScreenshot.resolve = resolve;\n                _this.queueScreenshot.reject = reject;\n            });\n            return this.queueScreenshot.promise;\n        }\n\n        // Called after rendering, captures render buffer and resolves promise with the image data\n    }, {\n        key: 'completeScreenshot',\n        value: function completeScreenshot() {\n            if (this.queueScreenshot != null) {\n                // Get data URL, convert to blob\n                // Strip host/mimetype/etc., convert base64 to binary without UTF-8 mangling\n                // Adapted from: https://gist.github.com/unconed/4370822\n                var url = this.canvas.toDataURL('image/png');\n                var data = atob(url.slice(22));\n                var buffer = new Uint8Array(data.length);\n                for (var i = 0; i < data.length; ++i) {\n                    buffer[i] = data.charCodeAt(i);\n                }\n                var blob = new Blob([buffer], { type: 'image/png' });\n\n                // Resolve with screenshot data\n                this.queueScreenshot.resolve({ url: url, blob: blob, type: 'png' });\n                this.queueScreenshot = null;\n            }\n        }\n\n        // Starts capturing a video stream from the canvas\n    }, {\n        key: 'startVideoCapture',\n        value: function startVideoCapture() {\n            var _this2 = this;\n\n            if (typeof window.MediaRecorder !== 'function' || !this.canvas || typeof this.canvas.captureStream !== 'function') {\n                console.log('warn: Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser');\n                return false;\n            } else if (this.videoCapture) {\n                console.log('warn: Video capture already in progress, call Scene.stopVideoCapture() first');\n                return false;\n            }\n\n            // Start a new capture\n            try {\n                (function () {\n                    var cap = _this2.videoCapture = {};\n                    cap.chunks = [];\n                    cap.stream = _this2.canvas.captureStream();\n                    cap.options = { mimeType: 'video/webm' }; // TODO: support other format options\n                    cap.mediaRecorder = new MediaRecorder(cap.stream, cap.options);\n                    cap.mediaRecorder.ondataavailable = function (event) {\n                        if (event.data.size > 0) {\n                            cap.chunks.push(event.data);\n                        }\n\n                        // Stopped recording? Create the final capture file blob\n                        if (cap.resolve) {\n                            var blob = new Blob(cap.chunks, { type: cap.options.mimeType });\n                            var url = (0, _urls.createObjectURL)(blob);\n\n                            // Explicitly remove all stream tracks, and set objects to null\n                            if (cap.stream) {\n                                var tracks = cap.stream.getTracks() || [];\n                                tracks.forEach(function (track) {\n                                    track.stop();\n                                    cap.stream.removeTrack(track);\n                                });\n                            }\n                            cap.stream = null;\n                            cap.mediaRecorder = null;\n                            _this2.videoCapture = null;\n\n                            cap.resolve({ url: url, blob: blob, type: 'webm' });\n                        }\n                    };\n                    cap.mediaRecorder.start();\n                })();\n            } catch (e) {\n                this.videoCapture = null;\n                console.log('error: Scene video capture failed', e);\n                return false;\n            }\n            return true;\n        }\n\n        // Stops capturing a video stream from the canvas, returns a promise that resolves with the video when available\n    }, {\n        key: 'stopVideoCapture',\n        value: function stopVideoCapture() {\n            var _this3 = this;\n\n            if (!this.videoCapture) {\n                console.log('warn: No scene video capture in progress, call Scene.startVideoCapture() first');\n                return _Promise.resolve({});\n            }\n\n            // Promise that will resolve when final stream is available\n            this.videoCapture.promise = new _Promise(function (resolve, reject) {\n                _this3.videoCapture.resolve = resolve;\n                _this3.videoCapture.reject = reject;\n            });\n\n            // Stop recording\n            this.videoCapture.mediaRecorder.stop();\n\n            return this.videoCapture.promise;\n        }\n    }]);\n\n    return MediaCapture;\n})();\n\nexports['default'] = MediaCapture;\nmodule.exports = exports['default'];\n\n},{\"./urls\":133,\"babel-runtime/core-js/promise\":8,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],132:[function(_dereq_,module,exports){\n/*\nAdd events to a class or object:\n    class MyClass {\n        constructor() {\n            subscribeMixin(this); // Add the mixing functions to the class\n            ...\n            this.trigger('something', { owner: this, content: 'that'}); // trigger an event passing some arguments\n\nSubscribe to events by doing:\n    myClass.on('something', (args) => {\n        console.log(args);\n    });\n\nUnsubscribe to events by doing:\n    myClass.off('something');\n\nor more presicelly:\n    myClass.off('something', (args) => {\n        console.log(args);\n    });\n\nUnsubscribe to all events by:\n    myClass.offAll();\n*/\n\n'use strict';\n\nvar _Set = _dereq_('babel-runtime/core-js/set')['default'];\n\nvar _Object$assign = _dereq_('babel-runtime/core-js/object/assign')['default'];\n\nvar _getIterator = _dereq_('babel-runtime/core-js/get-iterator')['default'];\n\nvar _Object$keys = _dereq_('babel-runtime/core-js/object/keys')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.subscribeMixin = subscribeMixin;\n\nfunction subscribeMixin(target) {\n    var listeners = new _Set();\n\n    return _Object$assign(target, {\n\n        on: function on(type, f) {\n            var listener = {};\n            listener[type] = f;\n            listeners.add(listener);\n        },\n\n        off: function off(type, f) {\n            if (f) {\n                var listener = {};\n                listener[type] = f;\n                listeners['delete'](listener);\n            } else {\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = _getIterator(listeners), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var item = _step.value;\n                        var _iteratorNormalCompletion2 = true;\n                        var _didIteratorError2 = false;\n                        var _iteratorError2 = undefined;\n\n                        try {\n                            for (var _iterator2 = _getIterator(_Object$keys(item)), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                                var key = _step2.value;\n\n                                if (key === type) {\n                                    listeners['delete'](item);\n                                    return;\n                                }\n                            }\n                        } catch (err) {\n                            _didIteratorError2 = true;\n                            _iteratorError2 = err;\n                        } finally {\n                            try {\n                                if (!_iteratorNormalCompletion2 && _iterator2['return']) {\n                                    _iterator2['return']();\n                                }\n                            } finally {\n                                if (_didIteratorError2) {\n                                    throw _iteratorError2;\n                                }\n                            }\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator['return']) {\n                            _iterator['return']();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            }\n        },\n\n        offAll: function offAll() {\n            listeners.clear();\n        },\n\n        trigger: function trigger(event) {\n            var _iteratorNormalCompletion3 = true;\n            var _didIteratorError3 = false;\n            var _iteratorError3 = undefined;\n\n            try {\n                for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                    data[_key - 1] = arguments[_key];\n                }\n\n                for (var _iterator3 = _getIterator(listeners), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                    var listener = _step3.value;\n\n                    if (typeof listener[event] === 'function') {\n                        listener[event].apply(listener, data);\n                    }\n                }\n            } catch (err) {\n                _didIteratorError3 = true;\n                _iteratorError3 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion3 && _iterator3['return']) {\n                        _iterator3['return']();\n                    }\n                } finally {\n                    if (_didIteratorError3) {\n                        throw _iteratorError3;\n                    }\n                }\n            }\n        },\n\n        listSubscriptions: function listSubscriptions() {\n            var _iteratorNormalCompletion4 = true;\n            var _didIteratorError4 = false;\n            var _iteratorError4 = undefined;\n\n            try {\n                for (var _iterator4 = _getIterator(listeners), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                    var item = _step4.value;\n\n                    console.log(item);\n                }\n            } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion4 && _iterator4['return']) {\n                        _iterator4['return']();\n                    }\n                } finally {\n                    if (_didIteratorError4) {\n                        throw _iteratorError4;\n                    }\n                }\n            }\n        }\n    });\n}\n\n},{\"babel-runtime/core-js/get-iterator\":1,\"babel-runtime/core-js/object/assign\":2,\"babel-runtime/core-js/object/keys\":6,\"babel-runtime/core-js/set\":9}],133:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.createObjectURL = createObjectURL;\nvar _createObjectURL = undefined;\n\nfunction createObjectURL(url) {\n    if (_createObjectURL === undefined) {\n        _createObjectURL = window.URL && window.URL.createObjectURL || window.webkitURL && window.webkitURL.createObjectURL;\n        if (typeof _createObjectURL !== 'function') {\n            _createObjectURL = null;\n            console.log('window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs');\n        }\n    }\n\n    if (_createObjectURL) {\n        return _createObjectURL(url);\n    } else {\n        return url;\n    }\n}\n\n},{}],134:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar ErrorsDisplay = (function () {\n    function ErrorsDisplay(main) {\n        var _this = this;\n\n        _classCallCheck(this, ErrorsDisplay);\n\n        this.main = main;\n\n        //  private variables\n        this.widgets = [];\n\n        // EVENTS\n        this.main.shader.canvas.on('error', function (arg) {\n            if (_this.main.visualDebugger && _this.main.visualDebugger.testing) {\n                _this.clean();\n            } else {\n                _this.clean();\n                _this.addError(arg);\n            }\n        });\n\n        this.main.editor.on('changes', function (cm, changesObjs) {\n            if (_this.main.shader.canvas.isValid) {\n                _this.clean();\n            }\n        });\n    }\n\n    _createClass(ErrorsDisplay, [{\n        key: 'clean',\n        value: function clean() {\n            for (var i = 0; i < this.widgets.length; i++) {\n                this.main.editor.removeLineWidget(this.widgets[i]);\n            }\n            this.widgets.length = 0;\n        }\n    }, {\n        key: 'addError',\n        value: function addError(args) {\n            var re = /ERROR:\\s+\\d+:(\\d+):\\s+('.*)/g;\n            var matches = re.exec(args.error);\n            if (matches) {\n                var line = parseInt(matches[1]) - 1;\n                var er = matches[2];\n                var msg = document.createElement('div');\n\n                var icon = msg.appendChild(document.createElement('span'));\n                icon.className = 'ge-error-icon';\n                icon.innerHTML = 'x';\n                msg.appendChild(document.createTextNode(er));\n                msg.className = 'ge-error';\n                this.widgets.push(this.main.editor.addLineWidget(line, msg)); //, { coverGutter: false, noHScroll: true }));\n            }\n        }\n    }]);\n\n    return ErrorsDisplay;\n})();\n\nexports['default'] = ErrorsDisplay;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],135:[function(_dereq_,module,exports){\n'use strict';\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _modalsExportModal = _dereq_('./modals/ExportModal');\n\nvar _modalsExportModal2 = _interopRequireDefault(_modalsExportModal);\n\nvar ExportIcon = function ExportIcon(main) {\n    var _this = this;\n\n    _classCallCheck(this, ExportIcon);\n\n    this.main = main;\n\n    this.el = document.createElement('div');\n    this.el.setAttribute('class', 'ge_export_icon');\n    this.el.innerHTML = '△';\n    // this.el.innerHTML = '<i class=\"material-icons\">more_vert</i>';\n    this.el.addEventListener('click', function (event) {\n        if (main.change || !_this.modal) {\n            _this.modal = new _modalsExportModal2['default']('ge_export', { main: main });\n        }\n        _this.modal.presentModal(event.target.offsetLeft, event.target.offsetTop);\n    }, true);\n\n    this.main.container.appendChild(this.el);\n};\n\nexports['default'] = ExportIcon;\nmodule.exports = exports['default'];\n\n},{\"./modals/ExportModal\":140,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/interop-require-default\":14}],136:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _pickersColorPicker = _dereq_('./pickers/ColorPicker');\n\nvar _pickersColorPicker2 = _interopRequireDefault(_pickersColorPicker);\n\nvar _pickersVec3Picker = _dereq_('./pickers/Vec3Picker');\n\nvar _pickersVec3Picker2 = _interopRequireDefault(_pickersVec3Picker);\n\nvar _pickersVec2Picker = _dereq_('./pickers/Vec2Picker');\n\nvar _pickersVec2Picker2 = _interopRequireDefault(_pickersVec2Picker);\n\nvar _pickersFloatPicker = _dereq_('./pickers/FloatPicker');\n\nvar _pickersFloatPicker2 = _interopRequireDefault(_pickersFloatPicker);\n\nvar _pickersTypesColor = _dereq_('./pickers/types/Color');\n\nvar _pickersTypesColor2 = _interopRequireDefault(_pickersTypesColor);\n\nvar _modalsModal = _dereq_('./modals/Modal');\n\nvar _modalsModal2 = _interopRequireDefault(_modalsModal);\n\n// Return all pattern matches with captured groups\nRegExp.prototype.execAll = function (string) {\n    var match = null;\n    var matches = [];\n    while (match = this.exec(string)) {\n        var matchArray = [];\n        for (var i in match) {\n            if (parseInt(i) == i) {\n                matchArray.push(match[i]);\n            }\n        }\n        matchArray.index = match.index;\n        matches.push(matchArray);\n    }\n    return matches;\n};\n\nvar Helpers = (function () {\n    function Helpers(main) {\n        var _this = this;\n\n        _classCallCheck(this, Helpers);\n\n        this.main = main;\n        this.main.debugging = false;\n\n        var style = window.getComputedStyle(main.editor.getWrapperElement(), null);\n        var bgColor = new _pickersTypesColor2['default'](style.background !== '' ? style.background : style.backgroundColor);\n        var fgColor = new _pickersTypesColor2['default'](style.color);\n\n        this.properties = {\n            bgColor: bgColor.getString('rgb'),\n            fnColor: fgColor.getString('rgb'),\n            dimColor: 'rgb(127, 127, 127)',\n            selColor: 'rgb(40, 168, 107)',\n            linkButton: true\n        };\n\n        // EVENTS\n        var wrapper = this.main.editor.getWrapperElement();\n        wrapper.addEventListener('contextmenu', function (event) {\n            var cursor = _this.main.editor.getCursor(true);\n            var token = _this.main.editor.getTokenAt(cursor);\n            if (token.type === 'variable') {\n                _this.main.visualDebugger.debug(token.string, cursor.line);\n            } else {\n                _this.main.update();\n            }\n        });\n\n        wrapper.addEventListener('mouseup', function (event) {\n            // bail out if we were doing a selection and not a click\n            if (_this.main.editor.somethingSelected()) {\n                return;\n            }\n\n            var cursor = _this.main.editor.getCursor(true);\n\n            // see if there is a match on the cursor click\n            var match = _this.getMatch(cursor);\n            var token = _this.main.editor.getTokenAt(cursor);\n            if (match) {\n                _this.main.visualDebugger.clean(event);\n                _this.main.update();\n\n                // Toggles the trackpad to be off if it's already present.\n                if (_this.activeModal && _this.activeModal.isVisible) {\n                    _this.activeModal.removeModal();\n                    return;\n                }\n\n                if (match.type === 'color') {\n                    _this.activeModal = new _pickersColorPicker2['default'](match.string, _this.properties);\n                    _this.activeModal.showAt(_this.main.editor);\n                    _this.activeModal.on('changed', function (color) {\n                        var newColor = color.getString('vec');\n                        var start = { line: cursor.line, ch: match.start };\n                        var end = { line: cursor.line, ch: match.end };\n                        match.end = match.start + newColor.length;\n                        _this.main.editor.replaceRange(newColor, start, end, '+' + match.type);\n                    });\n\n                    _this.activeModal.on('linkButton', function (color) {\n                        _this.activeModal = new _pickersVec3Picker2['default'](color.getString('vec'), _this.properties);\n                        _this.activeModal.showAt(_this.main.editor);\n                        _this.activeModal.on('changed', function (dir) {\n                            var newDir = dir.getString('vec3');\n                            var start = { line: cursor.line, ch: match.start };\n                            var end = { line: cursor.line, ch: match.end };\n                            match.end = match.start + newDir.length;\n                            _this.main.editor.replaceRange(newDir, start, end, '+' + match.type);\n                        });\n                    });\n                }\n                if (match.type === 'vec3') {\n                    _this.activeModal = new _pickersVec3Picker2['default'](match.string, _this.properties);\n                    _this.activeModal.showAt(_this.main.editor);\n                    _this.activeModal.on('changed', function (dir) {\n                        var newDir = dir.getString('vec3');\n                        var start = { line: cursor.line, ch: match.start };\n                        var end = { line: cursor.line, ch: match.end };\n                        match.end = match.start + newDir.length;\n                        _this.main.editor.replaceRange(newDir, start, end, '+' + match.type);\n                    });\n                } else if (match.type === 'vec2') {\n                    _this.activeModal = new _pickersVec2Picker2['default'](match.string, _this.properties);\n                    _this.activeModal.showAt(_this.main.editor);\n                    _this.activeModal.on('changed', function (pos) {\n                        var newpos = pos.getString();\n                        var start = { line: cursor.line, ch: match.start };\n                        var end = { line: cursor.line, ch: match.end };\n                        match.end = match.start + newpos.length;\n                        _this.main.editor.replaceRange(newpos, start, end, '+' + match.type);\n                    });\n                } else if (match.type === 'number') {\n                    _this.activeModal = new _pickersFloatPicker2['default'](match.string, _this.properties);\n                    _this.activeModal.showAt(_this.main.editor);\n                    _this.activeModal.on('changed', function (number) {\n                        var newNumber = number.getString();\n                        var start = { line: cursor.line, ch: match.start };\n                        var end = { line: cursor.line, ch: match.end };\n                        match.end = match.start + newNumber.length;\n                        _this.main.editor.replaceRange(newNumber, start, end, '+' + match.type);\n                    });\n                }\n            } else if (_this.main.options.tooltips && (token.type === 'builtin' || token.type === 'variable-3')) {\n                _this.main.visualDebugger.clean(event);\n                var html = '<p>Learn more about: <a href=\"https://thebookofshaders.com/glossary/?search=' + token.string + '\" target=\"_blank\">' + token.string + '</a></p>';\n                _this.activeModal = new _modalsModal2['default']('ge_tooltip', { innerHTML: html });\n                _this.activeModal.showAt(_this.main.editor);\n            } else if (token.type === 'variable') {\n                if (_this.main.visualDebugger) {\n                    _this.main.visualDebugger.clean(event);\n                    _this.main.visualDebugger.iluminate(token.string);\n                }\n            }\n        });\n    }\n\n    _createClass(Helpers, [{\n        key: 'getMatch',\n        value: function getMatch(cursor) {\n            var types = ['color', 'vec3', 'vec2', 'number'];\n            var rta = undefined;\n            for (var i in types) {\n                rta = this.getTypeMatch(cursor, types[i]);\n                if (rta) {\n                    return rta;\n                }\n            }\n            return;\n        }\n    }, {\n        key: 'getTypeMatch',\n        value: function getTypeMatch(cursor, type) {\n            if (!type) {\n                return;\n            }\n            var re = undefined;\n            switch (type.toLowerCase()) {\n                case 'color':\n                    re = /vec[3|4]\\([\\d|.|,\\s]*\\)/g;\n                    break;\n                case 'vec3':\n                    re = /vec3\\([-|\\d|.|,\\s]*\\)/g;\n                    break;\n                case 'vec2':\n                    re = /vec2\\([-|\\d|.|,\\s]*\\)/g;\n                    break;\n                case 'number':\n                    re = /[-]?\\d+\\.\\d+|\\d+\\.|\\.\\d+/g;\n                    break;\n                default:\n                    console.error('invalid match selection');\n                    return;\n            }\n            var line = this.main.editor.getLine(cursor.line);\n            var matches = re.execAll(line);\n\n            if (matches) {\n                for (var i = 0; i < matches.length; i++) {\n                    var val = matches[i][0];\n                    var len = val.length;\n                    var start = matches[i].index;\n                    var end = matches[i].index + len;\n                    if (cursor.ch >= start && cursor.ch <= end) {\n                        return {\n                            type: type,\n                            start: start,\n                            end: end,\n                            string: val\n                        };\n                    }\n                }\n            }\n            return;\n        }\n    }]);\n\n    return Helpers;\n})();\n\nexports['default'] = Helpers;\nmodule.exports = exports['default'];\n\n},{\"./modals/Modal\":141,\"./pickers/ColorPicker\":142,\"./pickers/FloatPicker\":143,\"./pickers/Vec2Picker\":145,\"./pickers/Vec3Picker\":146,\"./pickers/types/Color\":147,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14}],137:[function(_dereq_,module,exports){\n'use strict';\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _MenuItem = _dereq_('./MenuItem');\n\nvar _MenuItem2 = _interopRequireDefault(_MenuItem);\n\nvar _modalsExportModal = _dereq_('./modals/ExportModal');\n\nvar _modalsExportModal2 = _interopRequireDefault(_modalsExportModal);\n\nvar Menu = function Menu(main) {\n    var _this = this;\n\n    _classCallCheck(this, Menu);\n\n    this.main = main;\n    this.menus = {};\n\n    // CREATE MENU Container\n    this.el = document.createElement('ul');\n    this.el.setAttribute('class', 'ge_menu_bar');\n\n    // NEW\n    this.menus['new'] = new _MenuItem2['default'](this.el, 'ge_menu', '<i class=\"material-icons\">add</i> New', function (event) {\n        main['new']();\n    });\n\n    // OPEN\n    this.fileInput = document.createElement('input');\n    this.fileInput.setAttribute('type', 'file');\n    this.fileInput.setAttribute('accept', 'text/x-yaml');\n    this.fileInput.style.display = 'none';\n    this.fileInput.addEventListener('change', function (event) {\n        main.open(event.target.files[0]);\n    });\n    this.menus.open = new _MenuItem2['default'](this.el, 'ge_menu', '<i class=\"material-icons\">folder_open</i>  Open', function (event) {\n        _this.fileInput.click();\n    });\n\n    // this.menus.autoupdate.button.style.color = main.autoupdate ? 'white' : 'gray';\n\n    // TEST\n    this.menus.test = new _MenuItem2['default'](this.el, 'ge_menu', '<i class=\"material-icons\">timeline</i> Test', function (event) {\n        main.visualDebugger.check();\n    });\n\n    // SHARE\n    this.menus.share = new _MenuItem2['default'](this.el, 'ge_menu', '<i class=\"material-icons\">arrow_upward</i> Export', function (event) {\n        if (main.change || !_this.exportModal) {\n            _this.exportModal = new _modalsExportModal2['default']('ge_export', { main: main, position: 'fixed' });\n        }\n\n        var bbox = _this.menus.share.el.getBoundingClientRect();\n        _this.exportModal.presentModal(bbox.left - 5, bbox.top + bbox.height + 5);\n    });\n\n    // AUTOUPDATE\n    this.menus.autoupdate = new _MenuItem2['default'](this.el, 'ge_menu', ' <i class=\"material-icons\">autorenew</i> Update: ON', function (event) {\n        if (main.autoupdate) {\n            main.autoupdate = false;\n            _this.menus.autoupdate.name = '<i class=\"material-icons\">autorenew</i> Update: OFF';\n            // this.menus.autoupdate.button.style.color = 'gray';\n        } else {\n                main.autoupdate = true;\n                main.update();\n                _this.menus.autoupdate.name = '<i class=\"material-icons\">autorenew</i> Update: ON';\n                // this.menus.autoupdate.button.style.color = 'white';\n            }\n    });\n\n    main.container.appendChild(this.el);\n};\n\nexports['default'] = Menu;\nmodule.exports = exports['default'];\n\n},{\"./MenuItem\":138,\"./modals/ExportModal\":140,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/interop-require-default\":14}],138:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar MenuItem = (function () {\n    function MenuItem(container, className, name, onClick) {\n        _classCallCheck(this, MenuItem);\n\n        this.el = document.createElement('li');\n        this.button = document.createElement('button');\n        this.button.className = className + '_button';\n        this.el.appendChild(this.button);\n        this.el.setAttribute('class', className);\n        this.button.innerHTML = name;\n        this.className = className;\n        this.hiddenClass = className + '--hidden';\n\n        // Attach listeners, including those for tooltip behavior\n        this.button.addEventListener('click', onClick, true);\n\n        if (container) {\n            container.appendChild(this.el);\n        }\n    }\n\n    _createClass(MenuItem, [{\n        key: 'hide',\n        value: function hide() {\n            this.el.setAttribute('class', this.className + ' ' + this.hiddenClass);\n        }\n    }, {\n        key: 'show',\n        value: function show() {\n            this.el.setAttribute('class', this.className);\n        }\n    }, {\n        key: 'name',\n        set: function set(name) {\n            this.button.innerHTML = name;\n        }\n    }]);\n\n    return MenuItem;\n})();\n\nexports['default'] = MenuItem;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],139:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _toolsDebugging = _dereq_('../tools/debugging');\n\nvar _coreEditorJs = _dereq_('../core/Editor.js');\n\nvar mainGE = {};\nvar N_SAMPLES = 30;\n\nvar VisualDebugger = (function () {\n    function VisualDebugger(main) {\n        var _this = this;\n\n        _classCallCheck(this, VisualDebugger);\n\n        this.main = main;\n        this.breakpoint = null;\n        mainGE = main;\n\n        this.testing = false;\n        this.testingFrag = '';\n        this.testingLine = 0;\n        this.testingResults = [];\n        this.testingSamples = [];\n\n        this.main.editor.on('gutterClick', function (cm, n) {\n            var info = cm.lineInfo(n);\n            if (info && info.gutterMarkers && info.gutterMarkers.breakpoints) {\n                // Check for an active variable (a variable that have been declare or modify in this line)\n                var variableRE = new RegExp('\\\\s*[float|vec2|vec3|vec4]?\\\\s+([\\\\w|\\\\_]*)[\\\\.\\\\w]*?\\\\s+[\\\\+|\\\\-|\\\\\\\\|\\\\*]?\\\\=', 'i');\n                var match = variableRE.exec(info.text);\n                if (match) {\n                    _this.debug(match[1], info.line);\n                    _this.breakpoint = info.line;\n                }\n            }\n        });\n    }\n\n    _createClass(VisualDebugger, [{\n        key: 'check',\n        value: function check() {\n            // Clean previus records\n            this.testingResults = [];\n\n            var cm = this.main.editor;\n            var nLines = cm.getDoc().size;\n\n            var mainStartsAt = 0;\n            for (var i = 0; i < nLines; i++) {\n                if ((0, _toolsDebugging.isLineAfterMain)(cm, i)) {\n                    mainStartsAt = i;\n                    break;\n                }\n            }\n            this.testLine(mainStartsAt);\n        }\n    }, {\n        key: 'testLine',\n        value: function testLine(nLine) {\n            var cm = mainGE.editor;\n            var visualDebugger = mainGE.visualDebugger;\n\n            // If is done testing...\n            if (nLine >= cm.getDoc().size) {\n                visualDebugger.testingLine = 0;\n                visualDebugger.testing = false;\n\n                var results = visualDebugger.testingResults;\n                var range = (0, _toolsDebugging.getResultRange)(results);\n                var sum = (0, _toolsDebugging.getDeltaSum)(results);\n                var hits = (0, _toolsDebugging.getHits)(results);\n\n                console.log('Test: ', range.max.ms + 'ms', results);\n                cm.clearGutter('breakpoints');\n                for (var i in results) {\n                    var pct = results[i].delta / sum * 100;\n                    var size = results[i].delta / sum * 30;\n                    var markerHTML = '<div>' + results[i].ms.toFixed(2);\n                    if (results[i].delta > 0.) {\n                        markerHTML += '<span class=\"ge_assing_marker_pct ';\n                        if (pct > 100.0 / hits) {\n                            markerHTML += 'ge_assing_marker_slower';\n                        }\n                        markerHTML += '\" style=\"width: ' + size.toFixed(0) + 'px;\" data=\"' + pct.toFixed(0) + '%\"></span>';\n                    }\n\n                    cm.setGutterMarker(results[i].line, 'breakpoints', makeMarker(markerHTML + '</div>'));\n                }\n                return;\n            }\n\n            if ((0, _toolsDebugging.isLineAfterMain)(cm, nLine)) {\n                // If the line is inside the main function\n                var shader = mainGE.shader.canvas;\n\n                // Check for an active variable (a variable that have been declare or modify in this line)\n                var variableRE = new RegExp('\\\\s*[float|vec2|vec3|vec4]?\\\\s+([\\\\w|\\\\_]*)[\\\\.\\\\w]*?\\\\s+[\\\\+|\\\\-|\\\\\\\\|\\\\*]?\\\\=', 'i');\n                var match = variableRE.exec(cm.getLine(nLine));\n                if (match) {\n                    // if there is an active variable, get what type is\n                    var variable = match[1];\n                    var type = (0, _toolsDebugging.getVariableType)(cm, variable);\n                    if (type === 'none') {\n                        // If it fails on finding the type keep going with the test on another line\n                        visualDebugger.testLine(nLine + 1);\n                        return;\n                    }\n\n                    // Prepare\n                    visualDebugger.testing = true;\n                    visualDebugger.testingLine = nLine;\n                    visualDebugger.testingFrag = (0, _toolsDebugging.getShaderForTypeVarInLine)(cm, type, variable, nLine);\n                    visualDebugger.testingSamples = [];\n\n                    (0, _coreEditorJs.unfocusAll)(cm);\n                    (0, _coreEditorJs.focusLine)(cm, nLine);\n                    mainGE.debugging = true;\n\n                    shader.test(this.onTest, visualDebugger.testingFrag);\n                } else {\n                    visualDebugger.testLine(nLine + 1);\n                }\n            } else {\n                // If the line is not inside main function, test the next one...\n                visualDebugger.testLine(nLine + 1);\n            }\n        }\n    }, {\n        key: 'onTest',\n        value: function onTest(target) {\n            var cm = mainGE.editor;\n            var shader = mainGE.shader.canvas;\n            var visualDebugger = mainGE.visualDebugger;\n\n            // If the test shader compiled...\n            if (target.wasValid) {\n                // get data, process and store.\n                var elapsedMs = target.timeElapsedMs;\n\n                if (visualDebugger.testingSamples.length < N_SAMPLES - 1) {\n                    visualDebugger.testingSamples.push(elapsedMs);\n                    shader.test(visualDebugger.onTest, visualDebugger.testingFrag);\n                } else {\n                    (0, _coreEditorJs.focusAll)(cm);\n                    mainGE.debugging = false;\n                    visualDebugger.testingSamples.push(elapsedMs);\n                    elapsedMs = (0, _toolsDebugging.getMedian)(visualDebugger.testingSamples);\n\n                    var range = (0, _toolsDebugging.getResultRange)(visualDebugger.testingResults);\n                    var delta = elapsedMs - range.max.ms;\n                    if (visualDebugger.testingResults.length === 0) {\n                        delta = 0.0;\n                    }\n                    visualDebugger.testingResults.push({ line: visualDebugger.testingLine, ms: target.timeElapsedMs, delta: delta });\n                    // console.log('Testing line:', visualDebugger.testingLine, elapsedMs, delta, range);\n\n                    // Create gutter marker\n                    cm.setGutterMarker(visualDebugger.testingLine, 'breakpoints', makeMarker(elapsedMs.toFixed(2)));\n\n                    // Test next line\n                    visualDebugger.testLine(visualDebugger.testingLine + 1);\n                };\n            } else {\n                console.log(target);\n                // Test next line\n                visualDebugger.testLine(visualDebugger.testingLine + 1);\n            }\n        }\n    }, {\n        key: 'debug',\n        value: function debug(variable, nLine) {\n            (0, _coreEditorJs.focusAll)(this.main.editor);\n            this.main.debugging = false;\n\n            if ((0, _toolsDebugging.isLineAfterMain)(this.main.editor, nLine)) {\n                var type = (0, _toolsDebugging.getVariableType)(this.main.editor, variable);\n                if (type !== 'none') {\n                    event.preventDefault();\n                    this.main.shader.canvas.load((0, _toolsDebugging.getShaderForTypeVarInLine)(this.main.editor, type, variable, nLine));\n                    (0, _coreEditorJs.unfocusAll)(this.main.editor);\n                    (0, _coreEditorJs.focusLine)(this.main.editor, nLine);\n                    this.main.debugging = true;\n                }\n            } else {\n                this.main.update();\n            }\n        }\n    }, {\n        key: 'iluminate',\n        value: function iluminate(variable) {\n            if (this.main.debbuging && this.variable === this.variable) {\n                return;\n            }\n            // this.clean();\n\n            var cm = this.main.editor;\n\n            // Highlight all calls to a variable\n            this.overlay = searchOverlay(variable, true);\n            cm.addOverlay(this.overlay);\n            if (cm.showMatchesOnScrollbar) {\n                if (this.annotate) {\n                    this.annotate.clear();this.annotate = null;\n                }\n                this.annotate = cm.showMatchesOnScrollbar(variable, true);\n            }\n        }\n    }, {\n        key: 'clean',\n        value: function clean(event) {\n            if (event && event.target && event.target.className === 'ge_assing_marker') {\n                return;\n            }\n\n            var cm = this.main.editor;\n            cm.clearGutter('breakpoints');\n            if (this.overlay) {\n                cm.removeOverlay(this.overlay, true);\n            }\n            this.type = null;\n            if (this.main.debbuging) {\n                this.main.shader.canvas.load(this.main.options.frag_header + this.main.editor.getValue() + this.main.options.frag_footer);\n            }\n            this.main.debbuging = false;\n        }\n    }]);\n\n    return VisualDebugger;\n})();\n\nexports['default'] = VisualDebugger;\n\nfunction makeMarker(html, extraClass) {\n    var marker = document.createElement('div');\n    marker.setAttribute('class', 'ge_assing_marker');\n    marker.innerHTML = html;\n    return marker;\n}\n\nfunction searchOverlay(query, caseInsensitive) {\n    if (typeof query === 'string') {\n        query = new RegExp(query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&'), caseInsensitive ? 'gi' : 'g');\n    } else if (!query.global) {\n        query = new RegExp(query.source, query.ignoreCase ? 'gi' : 'g');\n    }\n\n    return {\n        token: function token(stream) {\n            query.lastIndex = stream.pos;\n            var match = query.exec(stream.string);\n            if (match && match.index === stream.pos) {\n                stream.pos += match[0].length || 1;\n                return 'searching';\n            } else if (match) {\n                stream.pos = match.index;\n            } else {\n                stream.skipToEnd();\n            }\n        }\n    };\n}\nmodule.exports = exports['default'];\n\n},{\"../core/Editor.js\":121,\"../tools/debugging\":129,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],140:[function(_dereq_,module,exports){\n'use strict';\n\nvar _get = _dereq_('babel-runtime/helpers/get')['default'];\n\nvar _inherits = _dereq_('babel-runtime/helpers/inherits')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _MenuItem = _dereq_('../MenuItem');\n\nvar _MenuItem2 = _interopRequireDefault(_MenuItem);\n\nvar _Modal2 = _dereq_('./Modal');\n\nvar _Modal3 = _interopRequireDefault(_Modal2);\n\nvar _ioShare = _dereq_('../../io/share');\n\nvar ExportModal = (function (_Modal) {\n    _inherits(ExportModal, _Modal);\n\n    function ExportModal(CSS_PREFIX, properties) {\n        var _this = this;\n\n        _classCallCheck(this, ExportModal);\n\n        _get(Object.getPrototypeOf(ExportModal.prototype), 'constructor', this).call(this, CSS_PREFIX, properties);\n        this.main = properties.main;\n\n        this.save = new _MenuItem2['default'](this.el, 'ge_sub_menu', 'Download file', function (event) {\n            properties.main.download();\n        });\n\n        this.codeURL = new _MenuItem2['default'](this.el, 'ge_sub_menu', 'Code URL...', function (event) {\n            (0, _ioShare.saveOnServer)(_this.main, function (event) {\n                prompt('Use this url to share your code', 'http://thebookofshaders.com/edit.php?log=' + event.name);\n                _this.removeModal();\n            });\n        });\n\n        this.shaderURL = new _MenuItem2['default'](this.el, 'ge_sub_menu', 'Artwork URL...', function (event) {\n            (0, _ioShare.saveOnServer)(_this.main, function (event) {\n                prompt('Use this url to share your artwork', 'http://player.thebookofshaders.com/?log=' + event.name);\n                _this.removeModal();\n            });\n        });\n\n        var shareOF = new _MenuItem2['default'](this.el, 'ge_sub_menu', 'Artwork to [o]', function (event) {\n            shareOF.el.innerHTML = 'Artwork to [o]: adding to collection';\n            (0, _ioShare.saveOnServer)(_this.main, function (event) {\n                (0, _ioShare.createOpenFrameArtwork)(_this.main, event.name, event.url, function (success) {\n                    if (success) {\n                        shareOF.el.innerHTML = 'Artwork to [o]: added!';\n                    } else {\n                        shareOF.el.innerHTML = 'Artwork to [o]: failed :(';\n                    }\n                    setTimeout(function () {\n                        shareOF.el.innerHTML = '[o]';\n                        _this.removeModal();\n                    }, 4000);\n                });\n            });\n        });\n    }\n\n    return ExportModal;\n})(_Modal3['default']);\n\nexports['default'] = ExportModal;\nmodule.exports = exports['default'];\n\n},{\"../../io/share\":127,\"../MenuItem\":138,\"./Modal\":141,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/get\":12,\"babel-runtime/helpers/inherits\":13,\"babel-runtime/helpers/interop-require-default\":14}],141:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.addEvent = addEvent;\nexports.removeEvent = removeEvent;\n\nvar _toolsMixin = _dereq_('../../tools/mixin');\n\nvar Modal = (function () {\n    function Modal(CSS_PREFIX, properties) {\n        _classCallCheck(this, Modal);\n\n        (0, _toolsMixin.subscribeMixin)(this);\n        this.CSS_PREFIX = CSS_PREFIX;\n\n        properties = properties || {};\n        for (var prop in properties) {\n            this[prop] = properties[prop];\n        }\n\n        this.el = document.createElement('div');\n        this.el.className = this.CSS_PREFIX + '_modal ge_modal';\n        this.el.style.backgroundColor = this.bgColor;\n        this.el.innerHTML = this.innerHTML || '';\n\n        if (this.elements) {\n            for (var i = 0; i < this.elements.length; i++) {\n                this.el.appendChild(this.elements[i]);\n            }\n        }\n\n        this.isVisible = false;\n    }\n\n    /* Event handling */\n\n    _createClass(Modal, [{\n        key: 'close',\n        value: function close() {\n            this.trigger('close');\n        }\n    }, {\n        key: 'showAt',\n        value: function showAt(cm) {\n            var cursor = cm.cursorCoords(true, 'page');\n            var x = cursor.left;\n            var y = cursor.top;\n\n            y += 30;\n\n            this.presentModal(x, y);\n        }\n    }, {\n        key: 'presentModal',\n        value: function presentModal(x, y) {\n            var _this = this;\n\n            // Listen for interaction outside of the modal\n            window.setTimeout(function () {\n                _this.onClickOutsideHandler = addEvent(document.body, 'click', _this.onClickOutside, _this);\n                _this.onKeyPressHandler = addEvent(window, 'keydown', _this.onKeyPress, _this);\n            }, 0);\n            this.isVisible = true;\n\n            this.el.style.left = x + 'px';\n            this.el.style.top = y + 'px';\n            this.el.style.width = this.width + 'px';\n            this.el.style.height = this.height + 'px';\n\n            if (this.position) {\n                this.el.style.position = this.position;\n            }\n\n            document.body.appendChild(this.el);\n\n            this.trigger('show');\n        }\n    }, {\n        key: 'getModalClass',\n        value: function getModalClass() {\n            return this.CSS_PREFIX + 'modal';\n        }\n    }, {\n        key: 'onKeyPress',\n        value: function onKeyPress(event) {\n            this.removeModal();\n        }\n    }, {\n        key: 'onClickOutside',\n        value: function onClickOutside(event) {\n            // HACKY!!\n            // A click event fires on the body after mousedown - mousemove, simultaneously with\n            // mouseup. So if someone started a mouse action inside the modal and then\n            // mouseup'd outside of it, it fires a click event on the body, thus, causing the\n            // modal to disappear when the user does not expect it to, since the mouse down event\n            // did not start outside the modal.\n            // There might be (or should be) a better way to track this, but right now, just cancel\n            // the event if the target ends up being on the body directly rather than on one of the\n            // other child elements.\n            if (event.target === document.body) {\n                return;\n            }\n            // end this specific hacky part\n            var target = event.target;\n            if (target) {\n                while (target !== document.documentElement && !target.classList.contains(this.getModalClass())) {\n                    target = target.parentNode;\n                }\n\n                if (!target.classList.contains(this.getModalClass())) {\n                    this.removeModal();\n                }\n            }\n        }\n\n        /**\n         *  Removes modal from DOM and destroys related event listeners\n         */\n    }, {\n        key: 'removeModal',\n        value: function removeModal() {\n            if (this.el && this.el.parentNode) {\n                this.el.parentNode.removeChild(this.el);\n            }\n            removeEvent(document.body, 'click', this.onClickOutsideHandler);\n            this.onClickOutsideHandler = null;\n            removeEvent(window, 'keydown', this.onKeyPressHandler);\n            this.onKeyPressHandler = null;\n\n            this.close();\n            this.isVisible = false;\n        }\n    }]);\n\n    return Modal;\n})();\n\nexports['default'] = Modal;\n\nfunction addEvent(element, event, callback, caller) {\n    var handler = undefined;\n    element.addEventListener(event, handler = function (e) {\n        callback.call(caller, e);\n    }, false);\n    return handler;\n}\n\nfunction removeEvent(element, event, callback) {\n    element.removeEventListener(event, callback, false);\n}\n\n},{\"../../tools/mixin\":132,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],142:[function(_dereq_,module,exports){\n/*\nOriginal: https://github.com/tangrams/tangram-play/blob/gh-pages/src/js/addons/ui/widgets/ColorPickerModal.js\nAuthor: Lou Huang (@saikofish)\n*/\n\n'use strict';\n\nvar _get = _dereq_('babel-runtime/helpers/get')['default'];\n\nvar _inherits = _dereq_('babel-runtime/helpers/inherits')['default'];\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _Picker2 = _dereq_('./Picker');\n\nvar _Picker3 = _interopRequireDefault(_Picker2);\n\nvar _typesColor = _dereq_('./types/Color');\n\nvar _typesColor2 = _interopRequireDefault(_typesColor);\n\nvar _toolsCommon = _dereq_('../../tools/common');\n\nvar _toolsInteractiveDom = _dereq_('../../tools/interactiveDom');\n\n// Some common use variables\nvar currentTarget = undefined;\nvar currentTargetHeight = 0;\nvar domCache = undefined;\n\nvar ColorPicker = (function (_Picker) {\n    _inherits(ColorPicker, _Picker);\n\n    function ColorPicker() {\n        var color = arguments.length <= 0 || arguments[0] === undefined ? 'vec3(1.0,0.0,0.0)' : arguments[0];\n        var properties = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n        _classCallCheck(this, ColorPicker);\n\n        _get(Object.getPrototypeOf(ColorPicker.prototype), 'constructor', this).call(this, 'ge_colorpicker_', properties);\n\n        this.width = 250; // in pixels\n        this.height = 250; // in pixels\n\n        this.disc = { width: 200, height: 200 };\n        this.barlum = { width: 25, height: 200 };\n\n        this.setValue(color);\n        this.init();\n    }\n\n    // generic function for drawing a canvas disc\n\n    _createClass(ColorPicker, [{\n        key: 'init',\n        value: function init() {\n            var _this = this;\n\n            if (!domCache) {\n                var modal = document.createElement('div');\n                var patch = document.createElement('div');\n                var map = document.createElement('div');\n                var disc = document.createElement('canvas');\n                var cover = document.createElement('div');\n                var cursor = document.createElement('div');\n                var barbg = document.createElement('div');\n                var barwhite = document.createElement('div');\n                var barlum = document.createElement('canvas');\n                var barcursors = document.createElement('div');\n                var leftcursor = document.createElement('div');\n                var rightcursor = document.createElement('div');\n\n                modal.className = this.CSS_PREFIX + 'modal ge_picker_modal';\n                modal.style.backgroundColor = this.bgColor;\n                patch.className = this.CSS_PREFIX + 'patch';\n                patch.style.backgroundColor = this.bgColor;\n                map.className = this.CSS_PREFIX + 'hsv-map';\n                disc.className = this.CSS_PREFIX + 'disc';\n                disc.style.backgroundColor = this.bgColor;\n                cover.className = this.CSS_PREFIX + 'disc-cover';\n                cursor.className = this.CSS_PREFIX + 'disc-cursor';\n                barbg.className = this.CSS_PREFIX + 'bar-bg';\n                barwhite.className = this.CSS_PREFIX + 'bar-white';\n                barlum.className = this.CSS_PREFIX + 'bar-luminance';\n                barcursors.className = this.CSS_PREFIX + 'bar-cursors';\n                leftcursor.className = this.CSS_PREFIX + 'bar-cursor-left';\n                rightcursor.className = this.CSS_PREFIX + 'bar-cursor-right';\n\n                map.id = 'cp-map';\n                barcursors.id = 'cp-bar';\n\n                modal.appendChild(patch);\n                modal.appendChild(map);\n\n                map.appendChild(disc);\n                map.appendChild(cover);\n                map.appendChild(cursor);\n                map.appendChild(barbg);\n                map.appendChild(barwhite);\n                map.appendChild(barlum);\n                map.appendChild(barcursors);\n                barcursors.appendChild(leftcursor);\n                barcursors.appendChild(rightcursor);\n\n                domCache = modal;\n            }\n\n            // Returns a clone of the cached document fragment\n            this.el = domCache.cloneNode(true);\n            (0, _toolsInteractiveDom.subscribeInteractiveDom)(this.el, { move: true, resize: false, snap: false });\n\n            // TODO: Improve these references\n            // The caching of references is likely to be important for speed\n            this.dom = {};\n            this.dom.hsvMap = this.el.querySelector('.ge_colorpicker_hsv-map');\n            this.dom.hsvMapCover = this.dom.hsvMap.children[1]; // well...\n            this.dom.hsvMapCursor = this.dom.hsvMap.children[2];\n            this.dom.hsvBarBGLayer = this.dom.hsvMap.children[3];\n            this.dom.hsvBarWhiteLayer = this.dom.hsvMap.children[4];\n            this.dom.hsvBarCursors = this.dom.hsvMap.children[6];\n            this.dom.hsvLeftCursor = this.dom.hsvBarCursors.children[0];\n            this.dom.hsvRightCursor = this.dom.hsvBarCursors.children[1];\n\n            this.dom.colorDisc = this.el.querySelector('.ge_colorpicker_disc');\n            this.dom.luminanceBar = this.el.querySelector('.ge_colorpicker_bar-luminance');\n\n            if (this.linkButton) {\n                var lbutton = document.createElement('div');\n                lbutton.innerHTML = '+';\n                lbutton.className = this.CSS_PREFIX + 'link-button';\n                lbutton.style.color = this.fgColor;\n                this.el.appendChild(lbutton);\n\n                lbutton.addEventListener('click', function () {\n                    _this.trigger('linkButton', _this.value);\n                    if (typeof _this.linkButton === 'function') {\n                        _this.linkButton(_this.value);\n                    }\n                    _this.removeModal();\n                });\n            }\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            //  Render color patch\n            var patch = this.el.querySelector('.ge_colorpicker_patch');\n            patch.style.backgroundColor = this.value.getString('rgb');\n\n            //  Render HSV picker\n            var color = this.value.colors;\n            var colorDiscRadius = this.dom.colorDisc.offsetHeight / 2;\n            var pi2 = Math.PI * 2;\n            var x = Math.cos(pi2 - color.hsv.h * pi2);\n            var y = Math.sin(pi2 - color.hsv.h * pi2);\n            var r = color.hsv.s * (colorDiscRadius - 5);\n\n            this.dom.hsvMapCover.style.opacity = 1 - color.hsv.v / 255;\n            // this is the faster version...\n            this.dom.hsvBarWhiteLayer.style.opacity = 1 - color.hsv.s;\n            this.dom.hsvBarBGLayer.style.backgroundColor = 'rgb(' + color.hueRGB.r + ',' + color.hueRGB.g + ',' + color.hueRGB.b + ')';\n\n            this.dom.hsvMapCursor.style.cssText = 'left: ' + (x * r + colorDiscRadius) + 'px;' + 'top: ' + (y * r + colorDiscRadius) + 'px;' + 'border-color: ' + (color.luminance > 0.22 ? '#333;' : '#ddd');\n\n            if (color.luminance > 0.22) {\n                this.dom.hsvBarCursors.classList.add('ge_colorpicker_dark');\n            } else {\n                this.dom.hsvBarCursors.classList.remove('ge_colorpicker_dark');\n            }\n\n            if (this.dom.hsvLeftCursor) {\n                this.dom.hsvLeftCursor.style.top = this.dom.hsvRightCursor.style.top = (1 - color.hsv.v / 255) * colorDiscRadius * 2 + 'px';\n            }\n        }\n    }, {\n        key: 'presentModal',\n        value: function presentModal(x, y) {\n            _get(Object.getPrototypeOf(ColorPicker.prototype), 'presentModal', this).call(this, x, y);\n\n            // // Listen for interaction on the HSV map\n            this.onHsvDownHandler = (0, _Picker2.addEvent)(this.dom.hsvMap, 'mousedown', this.onHsvDown, this);\n\n            var colorDisc = this.dom.colorDisc;\n\n            if (colorDisc.getContext) {\n                // HSV color wheel with white center\n                var diskContext = colorDisc.getContext('2d');\n                var ratio = (0, _toolsCommon.getDevicePixelRatio)(diskContext);\n                var width = this.disc.width / ratio;\n                var height = this.disc.height / ratio;\n                this.dom.colorDisc.width = width * ratio;\n                this.dom.colorDisc.height = height * ratio;\n                diskContext.scale(ratio, ratio);\n\n                drawDisk(diskContext, [width / 2, height / 2], [width / 2 - 1, height / 2 - 1], 360, function (ctx, angle) {\n                    var gradient = ctx.createRadialGradient(1, 1, 1, 1, 1, 0);\n                    gradient.addColorStop(0, 'hsl(' + (360 - angle + 0) + ', 100%, 50%)');\n                    gradient.addColorStop(1, '#fff');\n\n                    ctx.fillStyle = gradient;\n                    ctx.fill();\n                });\n\n                // gray border\n                drawCircle(diskContext, [width / 2, height / 2], [width / 2, height / 2], this.bgColor, // '#303030',\n                2 / ratio);\n\n                // draw the luminanceBar bar\n                var ctx = this.dom.luminanceBar.getContext('2d');\n                this.dom.luminanceBar.width = this.barlum.width;\n                this.dom.luminanceBar.height = this.barlum.height * ratio;\n                ctx.scale(ratio, ratio);\n                var gradient = ctx.createLinearGradient(0, 0, 0, this.barlum.height / ratio);\n\n                gradient.addColorStop(0, 'transparent');\n                gradient.addColorStop(1, 'black');\n\n                ctx.fillStyle = gradient;\n                ctx.fillRect(0, 0, 30, 200);\n            }\n            this.draw();\n        }\n\n        /**\n         *  Updates only the color value of the color picker\n         *  and the view. Designed to be called by external modules\n         *  so that it can update its internal value from an outside source.\n         *  Does no DOM creation & other initialization work.\n         */\n    }, {\n        key: 'setValue',\n        value: function setValue(color) {\n            this.value = new _typesColor2['default'](color);\n        }\n\n        /* ---------------------------------- */\n        /* ---- HSV-circle color picker ----- */\n        /* ---------------------------------- */\n\n        // Actions when user mouses down on HSV color map\n    }, {\n        key: 'onHsvDown',\n        value: function onHsvDown(event) {\n            var target = event.target || event.srcElement;\n            event.preventDefault();\n\n            currentTarget = target.id ? target : target.parentNode;\n            currentTargetHeight = currentTarget.offsetHeight; // as diameter of circle\n\n            // Starts listening for mousemove and mouseup events\n            this.onHsvMoveHandler = (0, _Picker2.addEvent)(this.el, 'mousemove', this.onHsvMove, this);\n            this.onHsvUpHandler = (0, _Picker2.addEvent)(window, 'mouseup', this.onHsvUp, this);\n\n            this.onHsvMove(event);\n\n            // Hides mouse cursor and begins rendering loop\n            this.dom.hsvMap.classList.add('ge_colorpicker_no-cursor');\n            this.renderer.start();\n        }\n\n        // Actions when user moves around on HSV color map\n    }, {\n        key: 'onHsvMove',\n        value: function onHsvMove(event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var r = undefined,\n                x = undefined,\n                y = undefined,\n                h = undefined,\n                s = undefined;\n            if (event.target === this.dom.hsvMapCover && currentTarget === this.dom.hsvMap) {\n                // the circle\n                r = currentTargetHeight / 2, x = event.offsetX - r, y = event.offsetY - r, h = (360 - (Math.atan2(y, x) * 180 / Math.PI + (y < 0 ? 360 : 0))) / 360, s = Math.sqrt(x * x + y * y) / r;\n                this.value.set({ h: h, s: s }, 'hsv');\n            } else if (event.target === this.dom.hsvBarCursors && currentTarget === this.dom.hsvBarCursors) {\n                // the luminanceBar\n                var v = (currentTargetHeight - event.offsetY) / currentTargetHeight;\n                v = Math.max(0, Math.min(1, v)) * 255;\n                this.value.set({ v: v }, 'hsv');\n            }\n\n            this.trigger('changed', this.value);\n        }\n\n        // Actions when user mouses up on HSV color map\n    }, {\n        key: 'onHsvUp',\n        value: function onHsvUp(event) {\n            // Stops rendering and returns mouse cursor\n            this.renderer.stop();\n            this.dom.hsvMap.classList.remove('ge_colorpicker_no-cursor');\n            this.destroyEvents();\n        }\n\n        // Destroy event listeners that exist during mousedown colorpicker interaction\n    }, {\n        key: 'destroyEvents',\n        value: function destroyEvents() {\n            (0, _Picker2.removeEvent)(this.el, 'mousemove', this.onHsvMoveHandler);\n            this.onHsvMoveHandler = null;\n            (0, _Picker2.removeEvent)(window, 'mouseup', this.onHsvUpHandler);\n            this.onHsvUpHandler = null;\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            this.destroyEvents();\n            (0, _Picker2.removeEvent)(this.dom.hsvMap, 'mousedown', this.onHsvDownHandler);\n            this.onHsvDownHandler = null;\n        }\n    }]);\n\n    return ColorPicker;\n})(_Picker3['default']);\n\nexports['default'] = ColorPicker;\nfunction drawDisk(ctx, coords, radius, steps, colorCallback) {\n    var x = coords[0] || coords; // coordinate on x-axis\n    var y = coords[1] || coords; // coordinate on y-axis\n    var a = radius[0] || radius; // radius on x-axis\n    var b = radius[1] || radius; // radius on y-axis\n    var angle = 360;\n    var coef = Math.PI / 180;\n\n    ctx.save();\n    ctx.translate(x - a, y - b);\n    ctx.scale(a, b);\n\n    steps = angle / steps || 360;\n\n    for (; angle > 0; angle -= steps) {\n        ctx.beginPath();\n        if (steps !== 360) {\n            ctx.moveTo(1, 1); // stroke\n        }\n        ctx.arc(1, 1, 1, (angle - steps / 2 - 1) * coef, (angle + steps / 2 + 1) * coef);\n\n        if (colorCallback) {\n            colorCallback(ctx, angle);\n        } else {\n            ctx.fillStyle = 'black';\n            ctx.fill();\n        }\n    }\n    ctx.restore();\n}\n\nfunction drawCircle(ctx, coords, radius, color, width) {\n    // uses drawDisk\n    width = width || 1;\n    radius = [(radius[0] || radius) - width / 2, (radius[1] || radius) - width / 2];\n    drawDisk(ctx, coords, radius, 1, function (ctx, angle) {\n        ctx.restore();\n        ctx.lineWidth = width;\n        ctx.strokeStyle = color || '#000';\n        ctx.stroke();\n    });\n}\nmodule.exports = exports['default'];\n\n},{\"../../tools/common\":128,\"../../tools/interactiveDom\":130,\"./Picker\":144,\"./types/Color\":147,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/get\":12,\"babel-runtime/helpers/inherits\":13,\"babel-runtime/helpers/interop-require-default\":14}],143:[function(_dereq_,module,exports){\n'use strict';\n\nvar _get = _dereq_('babel-runtime/helpers/get')['default'];\n\nvar _inherits = _dereq_('babel-runtime/helpers/inherits')['default'];\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _Picker2 = _dereq_('./Picker');\n\nvar _Picker3 = _interopRequireDefault(_Picker2);\n\nvar _typesFloat = _dereq_('./types/Float');\n\nvar _typesFloat2 = _interopRequireDefault(_typesFloat);\n\nvar FloatPicker = (function (_Picker) {\n    _inherits(FloatPicker, _Picker);\n\n    function FloatPicker(number, properties) {\n        _classCallCheck(this, FloatPicker);\n\n        _get(Object.getPrototypeOf(FloatPicker.prototype), 'constructor', this).call(this, 'ge_floatpicker_', properties);\n\n        this.width = this.width || 250;\n        this.height = this.height || 40;\n\n        this.prevOffset = 0;\n        this.scale = 2;\n\n        this.setValue(number || 1);\n        this.create();\n    }\n\n    _createClass(FloatPicker, [{\n        key: 'draw',\n        value: function draw() {\n            this.ctx.clearRect(0, 0, this.width, this.height);\n\n            // horizontal line\n            this.ctx.strokeStyle = this.dimColor;\n            this.ctx.lineWidth = 1;\n            this.ctx.beginPath();\n            this.ctx.moveTo(0, 0.5 + this.height * 0.5);\n            this.ctx.lineTo(0 + this.width, 0.5 + this.height * 0.5);\n            this.ctx.closePath();\n            this.ctx.stroke();\n\n            // vertical line\n            this.ctx.strokeStyle = this.fnColor;\n            this.ctx.lineWidth = 1;\n            this.ctx.beginPath();\n            this.ctx.moveTo(this.width * 0.5, 0);\n            this.ctx.lineTo(this.width * 0.5, this.height);\n            this.ctx.closePath();\n            this.ctx.stroke();\n\n            // Triangle line\n            this.ctx.fillStyle = this.overPoint ? this.selColor : this.fnColor;\n            this.ctx.beginPath();\n            this.ctx.moveTo(this.width * 0.5, 5);\n            this.ctx.lineTo(this.width * 0.48, 0);\n            this.ctx.lineTo(this.width * 0.52, 0);\n            this.ctx.closePath();\n            this.ctx.fill();\n\n            var times = 3;\n            var unit = 40;\n            var step = this.width / unit;\n            var sections = unit * times;\n\n            var offsetX = this.offsetX;\n\n            if (Math.abs(this.offsetX - this.width * 0.5) > this.width * 0.5) {\n                offsetX = (this.offsetX - this.width * 0.5) % (this.width * 0.5) + this.width;\n            }\n\n            this.ctx.strokeStyle = this.dimColor;\n            this.ctx.beginPath();\n            for (var i = 0; i < sections; i++) {\n                var l = i % (unit / 2) === 0 ? this.height * 0.35 : i % (unit / 4) === 0 ? this.height * 0.2 : this.height * 0.1;\n                this.ctx.moveTo(i * step - offsetX, this.height * 0.5 - l);\n                this.ctx.lineTo(i * step - offsetX, this.height * 0.5 + l);\n            }\n            this.ctx.stroke();\n\n            var val = Math.round((this.value - this.min) / this.range * this.width);\n\n            // point\n            this.ctx.strokeStyle = this.overPoint ? this.selColor : this.fnColor;\n            this.ctx.lineWidth = 1;\n            this.ctx.beginPath();\n            this.ctx.moveTo(this.offsetX + val, this.height * 0.5);\n            this.ctx.lineTo(this.offsetX + val, this.height);\n            this.ctx.closePath();\n            this.ctx.stroke();\n\n            this.overPoint = false;\n        }\n    }, {\n        key: 'onMouseDown',\n        value: function onMouseDown(event) {\n            this.prevOffset = event.offsetX;\n            _get(Object.getPrototypeOf(FloatPicker.prototype), 'onMouseDown', this).call(this, event);\n        }\n\n        // Actions when user moves around on HSV color map\n    }, {\n        key: 'onMouseMove',\n        value: function onMouseMove(event) {\n            var x = event.offsetX;\n\n            var vel = x - this.prevOffset;\n            var offset = this.offsetX - vel;\n\n            var center = this.width / this.scale;\n            this.setValue(offset / center);\n            this.prevOffset = x;\n\n            // fire 'changed'\n            var number = new _typesFloat2['default'](this.getValue());\n            this.trigger('changed', number);\n            this.overPoint = true;\n        }\n    }, {\n        key: 'setValue',\n        value: function setValue(value) {\n            if (typeof value === 'string') {\n                this.value = parseFloat(value);\n            } else if (typeof value === 'number') {\n                this.value = value;\n            }\n            var center = this.width / this.scale;\n            this.offsetX = this.value * center;\n        }\n    }]);\n\n    return FloatPicker;\n})(_Picker3['default']);\n\nexports['default'] = FloatPicker;\nmodule.exports = exports['default'];\n\n},{\"./Picker\":144,\"./types/Float\":149,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/get\":12,\"babel-runtime/helpers/inherits\":13,\"babel-runtime/helpers/interop-require-default\":14}],144:[function(_dereq_,module,exports){\n/*\nOriginal: https://github.com/tangrams/tangram-play/blob/gh-pages/src/js/addons/ui/widgets/ColorPickerModal.js\nAuthor: Lou Huang (@saikofish)\n*/\n\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.addEvent = addEvent;\nexports.removeEvent = removeEvent;\n\nvar _toolsCommon = _dereq_('../../tools/common');\n\nvar _toolsMixin = _dereq_('../../tools/mixin');\n\nvar Picker = (function () {\n    function Picker(CSS_PREFIX, properties) {\n        var _this = this;\n\n        _classCallCheck(this, Picker);\n\n        (0, _toolsMixin.subscribeMixin)(this);\n        this.CSS_PREFIX = CSS_PREFIX;\n\n        this.bgColor = 'rgb(46, 48, 51)';\n        this.dimColor = 'rgb(100, 100, 100)';\n        this.fnColor = 'rgb(230, 230, 230)';\n        this.selColor = 'rgb(133, 204, 196)';\n\n        properties = properties || {};\n        for (var prop in properties) {\n            this[prop] = properties[prop];\n        }\n\n        /**\n         *  This initializes the renderer. It uses requestAnimationFrame() to\n         *  smoothly render changes in the color picker as user interacts with it.\n         */\n        this.renderer = {\n            // Stores a reference to the animation rendering loop.\n            frame: null,\n\n            drawFrame: function drawFrame() {\n                if (!_this.el) {\n                    return;\n                }\n                _this.draw();\n            },\n\n            // Starts animation rendering loop\n            start: function start() {\n                _this.renderer.drawFrame();\n                _this.renderer.frame = window.requestAnimationFrame(_this.renderer.start);\n            },\n\n            // Stops animation rendering loop\n            stop: function stop() {\n                window.cancelAnimationFrame(_this.renderer.frame);\n            }\n        };\n        this.isVisible = false;\n    }\n\n    /* Event handling */\n\n    _createClass(Picker, [{\n        key: 'create',\n        value: function create() {\n            this.el = document.createElement('div');\n            this.el.className = this.CSS_PREFIX + 'modal ge_picker_modal';\n            this.el.style.backgroundColor = this.bgColor;\n\n            this.canvas = document.createElement('canvas');\n            this.canvas.className = this.CSS_PREFIX + 'canvas ge_picker_canvas';\n            this.canvas.style.backgroundColor = this.bgColor;\n\n            this.el.appendChild(this.canvas);\n            this.ctx = this.canvas.getContext('2d');\n\n            var ratio = (0, _toolsCommon.getDevicePixelRatio)(this.ctx);\n            this.canvas.width = this.width * ratio;\n            this.canvas.height = this.height * ratio;\n            this.ctx.scale(ratio, ratio);\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            // render rutine\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            // Close rutine\n            this.destroyEvents();\n            removeEvent(this.el, 'mousedown', this.onMouseDownHandler);\n            this.onMouseDownHandler = null;\n        }\n    }, {\n        key: 'destroyEvents',\n        value: function destroyEvents() {\n            removeEvent(this.el, 'mousemove', this.onMouseMoveHandler);\n            this.onMouseMoveHandler = null;\n            removeEvent(window, 'mouseup', this.onMouseUpHandler);\n            this.onMouseUpHandler = null;\n        }\n    }, {\n        key: 'setValue',\n        value: function setValue(value) {\n            this.value = value;\n        }\n    }, {\n        key: 'getValue',\n        value: function getValue() {\n            return this.value;\n        }\n    }, {\n        key: 'showAt',\n        value: function showAt(cm) {\n            var cursor = cm.cursorCoords(true, 'page');\n            var x = cursor.left;\n            var y = cursor.top;\n\n            x -= this.width * 0.5;\n            y += 30;\n\n            // // Check if desired x, y will be outside the viewport.\n            // // Do not allow the modal to disappear off the edge of the window.\n            // x = (x + this.width < window.innerWidth) ? x : (window.innerWidth - 20 - this.width);\n            // y = (y + this.height < window.innerHeight) ? y : (window.innerHeight - 20 - this.height);\n\n            this.presentModal(x, y);\n        }\n    }, {\n        key: 'presentModal',\n        value: function presentModal(x, y) {\n            var _this2 = this;\n\n            // Listen for interaction outside of the modal\n            window.setTimeout(function () {\n                _this2.onClickOutsideHandler = addEvent(document.body, 'click', _this2.onClickOutside, _this2);\n                _this2.onKeyPressHandler = addEvent(window, 'keydown', _this2.onKeyPress, _this2);\n            }, 0);\n            this.isVisible = true;\n\n            this.el.style.left = x + 'px';\n            this.el.style.top = y + 'px';\n            this.el.style.width = this.width + 'px';\n            this.el.style.height = this.height + 'px';\n            document.body.appendChild(this.el);\n\n            this.onMouseDownHandler = addEvent(this.el, 'mousedown', this.onMouseDown, this);\n\n            this.renderer.drawFrame();\n        }\n\n        /**\n         *  Removes modal from DOM and destroys related event listeners\n         */\n    }, {\n        key: 'removeModal',\n        value: function removeModal() {\n            if (this.el && this.el.parentNode) {\n                this.el.parentNode.removeChild(this.el);\n            }\n            removeEvent(document.body, 'click', this.onClickOutsideHandler);\n            this.onClickOutsideHandler = null;\n            removeEvent(window, 'keydown', this.onKeyPressHandler);\n            this.onKeyPressHandler = null;\n\n            this.close();\n            this.isVisible = false;\n        }\n    }, {\n        key: 'onKeyPress',\n        value: function onKeyPress(event) {\n            this.removeModal();\n        }\n    }, {\n        key: 'onClickOutside',\n        value: function onClickOutside(event) {\n            // HACKY!!\n            // A click event fires on the body after mousedown - mousemove, simultaneously with\n            // mouseup. So if someone started a mouse action inside the modal and then\n            // mouseup'd outside of it, it fires a click event on the body, thus, causing the\n            // modal to disappear when the user does not expect it to, since the mouse down event\n            // did not start outside the modal.\n            // There might be (or should be) a better way to track this, but right now, just cancel\n            // the event if the target ends up being on the body directly rather than on one of the\n            // other child elements.\n            if (event.target === document.body) {\n                return;\n            }\n            // end this specific hacky part\n\n            var target = event.target;\n\n            while (target !== document.documentElement && !target.classList.contains(this.CSS_PREFIX + 'modal')) {\n                target = target.parentNode;\n            }\n\n            if (!target.classList.contains(this.CSS_PREFIX + 'modal')) {\n                this.removeModal();\n            }\n        }\n    }, {\n        key: 'onMouseDown',\n        value: function onMouseDown(event) {\n            event.preventDefault();\n\n            // Starts listening for mousemove and mouseup events\n            this.onMouseMoveHandler = addEvent(this.el, 'mousemove', this.onMouseMove, this);\n            this.onMouseUpHandler = addEvent(window, 'mouseup', this.onMouseUp, this);\n\n            this.onMouseMove(event);\n\n            this.renderer.start();\n        }\n    }, {\n        key: 'onMouseMove',\n        value: function onMouseMove(event) {}\n    }, {\n        key: 'onMouseUp',\n        value: function onMouseUp(event) {\n            this.renderer.stop();\n            this.destroyEvents();\n        }\n    }]);\n\n    return Picker;\n})();\n\nexports['default'] = Picker;\n\nfunction addEvent(element, event, callback, caller) {\n    var handler = undefined;\n    element.addEventListener(event, handler = function (e) {\n        callback.call(caller, e);\n    }, false);\n    return handler;\n}\n\nfunction removeEvent(element, event, callback) {\n    element.removeEventListener(event, callback, false);\n}\n\n},{\"../../tools/common\":128,\"../../tools/mixin\":132,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],145:[function(_dereq_,module,exports){\n'use strict';\n\nvar _get = _dereq_('babel-runtime/helpers/get')['default'];\n\nvar _inherits = _dereq_('babel-runtime/helpers/inherits')['default'];\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _Picker2 = _dereq_('./Picker');\n\nvar _Picker3 = _interopRequireDefault(_Picker2);\n\nvar _typesVector = _dereq_('./types/Vector');\n\nvar _typesVector2 = _interopRequireDefault(_typesVector);\n\nvar Vec2Picker = (function (_Picker) {\n    _inherits(Vec2Picker, _Picker);\n\n    function Vec2Picker(pos, properties) {\n        _classCallCheck(this, Vec2Picker);\n\n        _get(Object.getPrototypeOf(Vec2Picker.prototype), 'constructor', this).call(this, 'ge_vec2picker_', properties);\n\n        this.width = this.width || 200;\n        this.height = this.height || 200;\n\n        this.min = this.min || -1;\n        this.max = this.max || 1;\n        this.size = this.size || 6;\n        this.range = this.max - this.min;\n        this.overPoint = false;\n\n        var center = (this.range / 2 - this.max) * -1;\n        this.setValue(pos || [center, center]);\n        this.create();\n    }\n\n    _createClass(Vec2Picker, [{\n        key: 'draw',\n        value: function draw() {\n            this.ctx.clearRect(0, 0, this.width, this.height);\n\n            // frame\n            this.ctx.strokeStyle = this.dimColor;\n            this.ctx.lineWidth = 2;\n            this.ctx.strokeRect(0, 0, this.width, this.height);\n\n            this.ctx.beginPath();\n            this.ctx.lineWidth = 0.25;\n            var sections = 20;\n            var step = this.width / sections;\n            for (var i = 0; i < sections; i++) {\n                this.ctx.moveTo(i * step, 0);\n                this.ctx.lineTo(i * step, this.height);\n                this.ctx.moveTo(0, i * step);\n                this.ctx.lineTo(this.width, i * step);\n            }\n            this.ctx.stroke();\n\n            // horizontal line\n            this.ctx.strokeStyle = this.dimColor;\n            this.ctx.lineWidth = 1.0;\n            this.ctx.beginPath();\n            this.ctx.moveTo(0, 0.5 + this.height * 0.5);\n            this.ctx.lineTo(this.width, 0.5 + this.height * 0.5);\n            this.ctx.closePath();\n            this.ctx.stroke();\n\n            // vertical line\n            this.ctx.beginPath();\n            this.ctx.moveTo(0.5 + this.width * 0.5, 0);\n            this.ctx.lineTo(0.5 + this.width * 0.5, this.height);\n            this.ctx.closePath();\n            this.ctx.stroke();\n\n            // // Triangle line\n            // this.ctx.fillStyle = this.dimColor;\n            // this.ctx.beginPath();\n            // this.ctx.moveTo(this.width * 0.5, 5);\n            // this.ctx.lineTo(this.width * 0.48, 0);\n            // this.ctx.lineTo(this.width * 0.52, 0);\n            // this.ctx.closePath();\n            // this.ctx.fill();\n\n            var x = Math.round((this.value.x - this.min) / this.range * this.width);\n            var y = Math.round((1 - (this.value.y - this.min) / this.range) * this.height);\n\n            var half = this.size / 2;\n\n            if (x < half) {\n                x = half;\n            }\n            if (x > this.width - half) {\n                x = this.width - half;\n            }\n            if (y < half) {\n                y = half;\n            }\n            if (y > this.height - half) {\n                y = this.height - half;\n            }\n\n            // point\n            this.ctx.fillStyle = this.overPoint ? this.selColor : this.fnColor;\n            this.ctx.beginPath();\n            var radius = this.overPoint ? 4 : 2;\n            this.ctx.arc(x, y, radius, 0, 2 * Math.PI, false);\n            this.ctx.fill();\n\n            this.ctx.restore();\n            this.overPoint = false;\n        }\n\n        // Actions when user moves around on HSV color map\n    }, {\n        key: 'onMouseMove',\n        value: function onMouseMove(event) {\n            var x = event.offsetX;\n            var y = event.offsetY;\n\n            this.value.x = this.range / this.width * x - (this.range - this.max);\n            this.value.y = (this.range / this.height * y - (this.range - this.max)) * -1;\n\n            // fire 'changed'\n            this.trigger('changed', this.value);\n            this.overPoint = true;\n        }\n    }, {\n        key: 'setValue',\n        value: function setValue(pos) {\n            this.value = new _typesVector2['default'](pos);\n        }\n    }]);\n\n    return Vec2Picker;\n})(_Picker3['default']);\n\nexports['default'] = Vec2Picker;\nmodule.exports = exports['default'];\n\n},{\"./Picker\":144,\"./types/Vector\":151,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/get\":12,\"babel-runtime/helpers/inherits\":13,\"babel-runtime/helpers/interop-require-default\":14}],146:[function(_dereq_,module,exports){\n'use strict';\n\nvar _get = _dereq_('babel-runtime/helpers/get')['default'];\n\nvar _inherits = _dereq_('babel-runtime/helpers/inherits')['default'];\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _Picker2 = _dereq_('./Picker');\n\nvar _Picker3 = _interopRequireDefault(_Picker2);\n\nvar _typesVector = _dereq_('./types/Vector');\n\nvar _typesVector2 = _interopRequireDefault(_typesVector);\n\nvar _typesMatrix = _dereq_('./types/Matrix');\n\nvar _typesMatrix2 = _interopRequireDefault(_typesMatrix);\n\nvar Vec3Picker = (function (_Picker) {\n    _inherits(Vec3Picker, _Picker);\n\n    function Vec3Picker(dir, properties) {\n        _classCallCheck(this, Vec3Picker);\n\n        _get(Object.getPrototypeOf(Vec3Picker.prototype), 'constructor', this).call(this, 'ge_vec3picker_', properties);\n\n        this.width = this.width || 200;\n        this.height = this.width || 200;\n        this.scale = 50;\n\n        this.setValue(dir || [0, 0, 1]);\n        this.create();\n\n        this.camera = new _typesMatrix2['default']();\n        this.shapes = [];\n        this.center = [0, 0, 0];\n\n        this.shapes.push({\n            edgeColour: this.dimColor,\n            nodes: [[this.width / 2 - 50, this.height / 2, 100], [this.width / 2 + 50, this.height / 2, 100], [this.width / 2, this.height / 2 - 50, 100], [this.width / 2, this.height / 2 + 50, 100], [this.width / 2, this.height / 2, 50], [this.width / 2, this.height / 2, 150]],\n            edges: [[0, 1], [2, 3], [4, 5]]\n        });\n\n        this.shapes.push({\n            textColour: this.fnColor,\n            nodes: [[this.width / 2 + 68, this.height / 2, 100], [this.width / 2 - 68, this.height / 2, 100], [this.width / 2, this.height / 2 + 68, 100], [this.width / 2, this.height / 2 - 68, 100], [this.width / 2, this.height / 2, 168], [this.width / 2, this.height / 2, 32]],\n            text: ['x', '-x', 'y', '-y', 'z', '-z']\n        });\n\n        this.setCenter(this.width / 2, this.height / 2, 100);\n\n        // Mouse events\n        this.dragOffset = [0, 0];\n        this.overPoint = false;\n    }\n\n    _createClass(Vec3Picker, [{\n        key: 'setCenter',\n        value: function setCenter(x, y, z) {\n            for (var s in this.shapes) {\n                var shape = this.shapes[s];\n\n                for (var n in shape.nodes) {\n                    shape.nodes[n][0] -= x;\n                    shape.nodes[n][1] -= y;\n                    shape.nodes[n][2] -= z;\n                }\n            }\n            this.center = [x, y, z];\n        }\n    }, {\n        key: 'viewFromCamera',\n        value: function viewFromCamera(node) {\n            var A = this.camera.getMult(node);\n            A.add(this.center);\n            return [A.x, this.height - A.y];\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            this.ctx.clearRect(0, 0, this.width, this.height);\n\n            for (var s in this.shapes) {\n                var shape = this.shapes[s];\n                if (shape.edgeColour) {\n                    this.drawShapeEdges(shape);\n                }\n                if (shape.nodeColour) {\n                    this.drawShapeNodes(shape);\n                }\n                if (shape.text) {\n                    this.drawShapeText(shape);\n                }\n            }\n\n            this.drawShapeEdges({\n                edgeColour: this.fnColor,\n                nodes: [[0, 0, 0], this.point],\n                edges: [[0, 1]]\n            });\n\n            this.drawShapeNodes({\n                nodeColour: this.overPoint ? this.selColor : this.fnColor,\n                nodeRadius: this.overPoint ? 4 : 2,\n                nodes: [this.point]\n            });\n        }\n    }, {\n        key: 'drawShapeEdges',\n        value: function drawShapeEdges(shape) {\n            var nodes = shape.nodes;\n\n            this.ctx.strokeStyle = shape.edgeColour;\n            for (var e in shape.edges) {\n                var coord = this.viewFromCamera(nodes[shape.edges[e][0]]);\n                this.ctx.lineWidth = 1;\n                this.ctx.beginPath();\n                this.ctx.moveTo(coord[0], coord[1]);\n                coord = this.viewFromCamera(nodes[shape.edges[e][1]]);\n                this.ctx.lineTo(coord[0], coord[1]);\n                this.ctx.stroke();\n            }\n        }\n    }, {\n        key: 'drawShapeNodes',\n        value: function drawShapeNodes(shape) {\n            var radius = shape.nodeRadius || 4;\n            this.ctx.fillStyle = shape.nodeColour;\n            for (var n in shape.nodes) {\n                var coord = this.viewFromCamera(shape.nodes[n]);\n                this.ctx.beginPath();\n                this.ctx.arc(coord[0], coord[1], radius, 0, 2 * Math.PI, false);\n                this.ctx.fill();\n            }\n        }\n    }, {\n        key: 'drawShapeText',\n        value: function drawShapeText(shape) {\n            this.ctx.fillStyle = shape.textColour;\n            for (var n in shape.nodes) {\n                var coord = this.viewFromCamera(shape.nodes[n]);\n                this.ctx.textBaseline = 'middle';\n                this.ctx.fillText(shape.text[n], coord[0], coord[1]);\n            }\n        }\n    }, {\n        key: 'onMouseDown',\n        value: function onMouseDown(event) {\n            var mouse = [event.offsetX, event.offsetY];\n            this.dragOffset = mouse;\n\n            var pos = new _typesVector2['default'](this.viewFromCamera(this.point));\n            var diff = pos.getSub(mouse);\n            this.overPoint = diff.getLength() < 10;\n\n            _get(Object.getPrototypeOf(Vec3Picker.prototype), 'onMouseDown', this).call(this, event);\n            this.onMouseUpHandler = (0, _Picker2.addEvent)(this.el, 'dblclick', this.onDbClick, this);\n        }\n\n        // Actions when user moves around on HSV color map\n    }, {\n        key: 'onMouseMove',\n        value: function onMouseMove(event) {\n            var x = event.offsetX;\n            var y = event.offsetY;\n\n            var dx = 0.01 * (x - this.dragOffset[0]);\n            var dy = 0.01 * (y - this.dragOffset[1]);\n\n            if (this.overPoint) {\n                var invM = this.camera.getInv();\n                var vel = invM.getMult([dx, -dy, 0.0]);\n                vel.mult(2);\n                this.value.add(vel);\n                this.point = [this.value.x * this.scale, this.value.y * this.scale, this.value.z * this.scale];\n                // fire 'changed'\n                this.trigger('changed', this.value);\n            } else {\n                this.camera.rotateX(dy);\n                this.camera.rotateY(dx);\n            }\n\n            this.dragOffset = [x, y];\n        }\n    }, {\n        key: 'onDbClick',\n        value: function onDbClick(event) {\n            var mouse = new _typesVector2['default']([event.offsetX, event.offsetY]);\n            var axis = {\n                x: [68, 0, 0],\n                negX: [-68, 0, 0],\n                y: [0, 68, 100],\n                negY: [0, -68, 0]\n            };\n            var selected = '';\n            for (var i in axis) {\n                var pos = new _typesVector2['default'](this.viewFromCamera(axis[i]));\n                var diff = pos.getSub(mouse);\n                if (diff.getLength() < 10) {\n                    selected = i;\n                    break;\n                }\n            }\n            this.camera = new _typesMatrix2['default']();\n\n            if (selected === 'x') {\n                this.camera.rotateY(-1.57079632679);\n            } else if (selected === 'negX') {\n                this.camera.rotateY(1.57079632679);\n            } else if (selected === 'y') {\n                this.camera.rotateX(-1.57079632679);\n            } else if (selected === 'negY') {\n                this.camera.rotateX(1.57079632679);\n            }\n\n            this.draw();\n        }\n    }, {\n        key: 'destroyEvents',\n        value: function destroyEvents() {\n            _get(Object.getPrototypeOf(Vec3Picker.prototype), 'destroyEvents', this).call(this);\n            (0, _Picker2.removeEvent)(this.el, 'dblclick', this.onDbClick);\n            this.onMouseMoveHandler = null;\n        }\n    }, {\n        key: 'setValue',\n        value: function setValue(dir) {\n            this.value = new _typesVector2['default'](dir);\n            this.point = [this.value.x * this.scale, this.value.y * this.scale, this.value.z * this.scale];\n        }\n    }]);\n\n    return Vec3Picker;\n})(_Picker3['default']);\n\nexports['default'] = Vec3Picker;\nmodule.exports = exports['default'];\n\n},{\"./Picker\":144,\"./types/Matrix\":150,\"./types/Vector\":151,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/get\":12,\"babel-runtime/helpers/inherits\":13,\"babel-runtime/helpers/interop-require-default\":14}],147:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _ColorConverter = _dereq_('./ColorConverter');\n\nvar _ColorConverter2 = _interopRequireDefault(_ColorConverter);\n\nvar Color = (function () {\n    function Color(color) {\n        _classCallCheck(this, Color);\n\n        this.colors = {};\n        this.set(color);\n    }\n\n    _createClass(Color, [{\n        key: 'set',\n        value: function set(color, type) {\n            // color only full range\n            if (typeof color === 'number') {\n                type = type ? type : 'rgb';\n                this.colors[type] = {};\n                for (var n = 3; n--;) {\n                    var m = type[n] || type.charAt(n); // IE7\n                    this.colors[type][m] = color;\n                }\n            } else if (typeof color === 'string') {\n                var parts = color.replace(/(?:#|\\)|%)/g, '').split('(');\n                if (parts[1]) {\n                    var values = (parts[1] || '').split(/,\\s*/);\n                    type = type ? type : parts[1] ? parts[0].substr(0, 3) : 'rgb';\n                    this.set(values, type);\n                } else {\n                    this.set((0, _ColorConverter.getColorAsRGB)(color), 'rgb');\n                }\n            } else if (color) {\n                if (Array.isArray(color)) {\n                    var m = '';\n                    type = type || 'rgb';\n\n                    this.colors[type] = this.colors[type] || {};\n                    for (var _n = 3; _n--;) {\n                        m = type[_n] || type.charAt(_n); // IE7\n                        var i = color.length >= 3 ? _n : 0;\n                        this.colors[type][m] = parseFloat(color[i]);\n                    }\n\n                    if (color.length === 4) {\n                        this.colors.alpha = parseFloat(color[3]);\n                    }\n                } else if (type) {\n                    for (var _n2 in color) {\n                        this.colors[type][_n2] = (0, _ColorConverter.limitValue)(color[_n2] / (0, _ColorConverter.getValueRanges)(type)[_n2][1], 0, 1) * (0, _ColorConverter.getValueRanges)(type)[_n2][1];\n                    }\n                }\n            }\n\n            if (!type) {\n                return;\n            }\n\n            if (type !== 'rgb') {\n                var convert = _ColorConverter2['default'];\n                this.colors.rgb = convert[type + '2rgb'](this.colors[type]);\n            }\n            this.convert(type);\n            this.colors.hueRGB = _ColorConverter2['default'].hue2RGB(this.colors.hsv.h);\n            this.colors.luminance = (0, _ColorConverter.getLuminance)(this.colors.rgb);\n        }\n    }, {\n        key: 'convert',\n        value: function convert(type) {\n            var convert = _ColorConverter2['default'],\n                ranges = (0, _ColorConverter.getValueRanges)(),\n                exceptions = { hsl: 'hsv', cmyk: 'cmy', rgb: type };\n\n            if (type !== 'alpha') {\n                for (var typ in ranges) {\n                    if (!ranges[typ][typ]) {\n                        // no alpha|HEX\n                        if (type !== typ && typ !== 'XYZ') {\n                            var from = exceptions[typ] || 'rgb';\n                            this.colors[typ] = convert[from + '2' + typ](this.colors[from]);\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'get',\n        value: function get(type) {\n            if (type !== 'rgb') {\n                var convert = _ColorConverter2['default'];\n                this.colors[type] = convert['rgb2' + type](this.colors['rgb']);\n                return this.colors[type];\n            } else {\n                return this.colors['rgb'];\n            }\n        }\n    }, {\n        key: 'getString',\n        value: function getString(type) {\n            if (type === 'HEX') {\n                var convert = _ColorConverter2['default'];\n                return convert['rgb2' + type](this.colors['rgb']);\n            } else {\n                var color = this.get(type);\n                var str = type,\n                    m = '';\n                if (type === 'vec') {\n                    str += this.colors.alpha ? 4 : 3;\n                }\n                str += '(';\n                for (var n = 0; n < 3; n++) {\n                    m = type[n] || type.charAt(n); // IE7\n                    if (type === 'vec') {\n                        str += color[m].toFixed(3);\n                    } else {\n                        str += Math.floor(color[m]);\n                    }\n                    if (n !== 2) {\n                        str += ',';\n                    }\n                }\n\n                if (this.colors.alpha) {\n                    str += ',' + this.colors.alpha.toFixed(3);\n                }\n                return str += ')';\n            }\n        }\n    }, {\n        key: 'uniformType',\n        value: function uniformType() {\n            if (this.colors.alpha) {\n                return 'vec4';\n            }\n            return 'vec3';\n        }\n    }, {\n        key: 'uniformValue',\n        value: function uniformValue() {\n            var vec = this.get('vec');\n            var arr = [vec.v, vec.e, vec.c];\n            if (this.colors.alpha) {\n                arr.push(this.colors.alpha);\n            }\n            return arr;\n        }\n    }, {\n        key: 'uniformMethod',\n        value: function uniformMethod(type) {\n            if (this.colors.alpha) {\n                return '4f';\n            }\n            return '3f';\n        }\n    }]);\n\n    return Color;\n})();\n\nexports['default'] = Color;\nmodule.exports = exports['default'];\n\n},{\"./ColorConverter\":148,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14}],148:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\nexports.limitValue = limitValue;\nexports.getLuminance = getLuminance;\nexports.getColorAsRGB = getColorAsRGB;\nexports.getValueRanges = getValueRanges;\nvar valueRanges = {\n    rgb: { r: [0, 255], g: [0, 255], b: [0, 255] },\n    hsv: { h: [0, 1], s: [0, 1], v: [0, 255] },\n    hsl: { h: [0, 360], s: [0, 100], l: [0, 100] },\n    cmy: { c: [0, 100], m: [0, 100], y: [0, 100] },\n    cmyk: { c: [0, 100], m: [0, 100], y: [0, 100], k: [0, 100] },\n    Lab: { L: [0, 100], a: [-128, 127], b: [-128, 127] },\n    XYZ: { X: [0, 100], Y: [0, 100], Z: [0, 100] },\n    vec: { v: [0, 1], e: [0, 1], c: [0, 1] },\n    alpha: { alpha: [0, 1] },\n    HEX: { HEX: [0, 16777215] } // maybe we don't need this\n};\n\n// http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html for more\nvar XYZMatrix = { // Observer = 2° (CIE 1931), Illuminant = D65\n    X: [0.4124564, 0.3575761, 0.1804375],\n    Y: [0.2126729, 0.7151522, 0.0721750],\n    Z: [0.0193339, 0.1191920, 0.9503041],\n    R: [3.2404542, -1.5371385, -0.4985314],\n    G: [-0.9692660, 1.8760108, 0.0415560],\n    B: [0.0556434, -0.2040259, 1.0572252]\n};\n\nvar XYZReference = {\n    X: XYZMatrix.X[0] + XYZMatrix.X[1] + XYZMatrix.X[2],\n    Y: XYZMatrix.Y[0] + XYZMatrix.Y[1] + XYZMatrix.Y[2],\n    Z: XYZMatrix.Z[0] + XYZMatrix.Z[1] + XYZMatrix.Z[2]\n};\n\nvar luminance = { r: 0.2126, g: 0.7152, b: 0.0722 }; // W3C 2.0\n\nvar _colors;\n\nvar ColorConverter = (function () {\n    function ColorConverter() {\n        _classCallCheck(this, ColorConverter);\n    }\n\n    _createClass(ColorConverter, null, [{\n        key: 'vec2rgb',\n\n        // ------------------------ VEC ------------------------ //\n        value: function vec2rgb(vec) {\n            return {\n                r: vec.v * valueRanges['rgb']['r'][1],\n                g: vec.e * valueRanges['rgb']['g'][1],\n                b: vec.c * valueRanges['rgb']['b'][1]\n            };\n        }\n    }, {\n        key: 'rgb2vec',\n        value: function rgb2vec(rgb) {\n            return {\n                v: rgb.r / valueRanges['rgb']['r'][1],\n                e: rgb.g / valueRanges['rgb']['g'][1],\n                c: rgb.b / valueRanges['rgb']['b'][1]\n            };\n        }\n\n        // ------------------------ HEX ------------------------ //\n\n    }, {\n        key: 'RGB2HEX',\n        value: function RGB2HEX(rgb) {\n            return ((rgb.r < 16 ? '0' : '') + rgb.r.toString(16) + (rgb.g < 16 ? '0' : '') + rgb.g.toString(16) + (rgb.b < 16 ? '0' : '') + rgb.b.toString(16)).toUpperCase();\n        }\n    }, {\n        key: 'HEX2rgb',\n        value: function HEX2rgb(HEX) {\n            HEX = HEX.split(''); // IE7\n            return {\n                r: parseInt(HEX[0] + HEX[HEX[3] ? 1 : 0], 16) / 255,\n                g: parseInt(HEX[HEX[3] ? 2 : 1] + (HEX[3] || HEX[1]), 16) / 255,\n                b: parseInt((HEX[4] || HEX[2]) + (HEX[5] || HEX[2]), 16) / 255\n            };\n        }\n\n        // ------------------------ HUE ------------------------ //\n\n    }, {\n        key: 'hue2RGB',\n        value: function hue2RGB(hue) {\n            var h = hue * 6,\n\n            // mod = ~~h % 6, // Math.floor(h) -> faster in most browsers\n            mod = Math.floor(h),\n                i = h === 6 ? 0 : h - mod;\n            return {\n                r: Math.round([1, 1 - i, 0, 0, i, 1][mod] * 255),\n                g: Math.round([i, 1, 1, 1 - i, 0, 0][mod] * 255),\n                b: Math.round([0, 0, i, 1, 1, 1 - i][mod] * 255)\n            };\n        }\n\n        // ------------------------ HSV ------------------------ //\n\n    }, {\n        key: 'rgb2hsv',\n        value: function rgb2hsv(rgb) {\n            // faster\n            var r = rgb.r,\n                g = rgb.g,\n                b = rgb.b,\n                k = 0,\n                chroma,\n                min,\n                s;\n\n            if (g < b) {\n                g = b + (b = g, 0);\n                k = -1;\n            }\n            min = b;\n            if (r < g) {\n                r = g + (g = r, 0);\n                k = -2 / 6 - k;\n                min = Math.min(g, b); // g < b ? g : b; ???\n            }\n            chroma = r - min;\n            s = r ? chroma / r : 0;\n            return {\n                h: s < 1e-15 ? _colors && _colors.hsl && _colors.hsl.h || 0 : chroma ? Math.abs(k + (g - b) / (6 * chroma)) : 0,\n                s: r ? chroma / r : _colors && _colors.hsv && _colors.hsv.s || 0, // ??_colors.hsv.s || 0\n                v: r\n            };\n        }\n    }, {\n        key: 'hsv2rgb',\n        value: function hsv2rgb(hsv) {\n            var h = hsv.h * 6,\n                s = hsv.s,\n                v = hsv.v,\n\n            // i = ~~h, // Math.floor(h) -> faster in most browsers\n            i = Math.floor(h),\n                f = h - i,\n                p = v * (1 - s),\n                q = v * (1 - f * s),\n                t = v * (1 - (1 - f) * s),\n                mod = i % 6;\n\n            return {\n                r: [v, q, p, p, t, v][mod],\n                g: [t, v, v, q, p, p][mod],\n                b: [p, p, t, v, v, q][mod]\n            };\n        }\n\n        // ------------------------ HSL ------------------------ //\n\n    }, {\n        key: 'hsv2hsl',\n        value: function hsv2hsl(hsv) {\n            var l = (2 - hsv.s) * hsv.v,\n                s = hsv.s * hsv.v;\n\n            s = !hsv.s ? 0 : l < 1 ? l ? s / l : 0 : s / (2 - l);\n\n            return {\n                h: hsv.h,\n                s: !hsv.v && !s ? _colors && _colors.hsl && _colors.hsl.s || 0 : s, // ???\n                l: l / 2\n            };\n        }\n    }, {\n        key: 'rgb2hsl',\n        value: function rgb2hsl(rgb, dependent) {\n            // not used in Color\n            var hsv = ColorConverter.rgb2hsv(rgb);\n\n            return ColorConverter.hsv2hsl(dependent ? hsv : _colors.hsv = hsv);\n        }\n    }, {\n        key: 'hsl2rgb',\n        value: function hsl2rgb(hsl) {\n            var h = hsl.h * 6,\n                s = hsl.s,\n                l = hsl.l,\n                v = l < 0.5 ? l * (1 + s) : l + s - s * l,\n                m = l + l - v,\n                sv = v ? (v - m) / v : 0,\n\n            // sextant = ~~h, // Math.floor(h) -> faster in most browsers\n            sextant = Math.floor(h),\n                fract = h - sextant,\n                vsf = v * sv * fract,\n                t = m + vsf,\n                q = v - vsf,\n                mod = sextant % 6;\n\n            return {\n                r: [v, q, m, m, t, v][mod],\n                g: [t, v, v, q, m, m][mod],\n                b: [m, m, t, v, v, q][mod]\n            };\n        }\n\n        // ------------------------ CMYK ------------------------ //\n        // Quote from Wikipedia:\n        // 'Since RGB and CMYK spaces are both device-dependent spaces, there is no\n        // simple or general conversion formula that converts between them.\n        // Conversions are generally done through color management systems, using\n        // color profiles that describe the spaces being converted. Nevertheless, the\n        // conversions cannot be exact, since these spaces have very different gamuts.'\n        // Translation: the following are just simple RGB to CMY(K) and visa versa conversion functions.\n\n    }, {\n        key: 'rgb2cmy',\n        value: function rgb2cmy(rgb) {\n            return {\n                c: 1 - rgb.r,\n                m: 1 - rgb.g,\n                y: 1 - rgb.b\n            };\n        }\n    }, {\n        key: 'cmy2cmyk',\n        value: function cmy2cmyk(cmy) {\n            var k = Math.min(Math.min(cmy.c, cmy.m), cmy.y),\n                t = 1 - k || 1e-20;\n\n            return { // regular\n                c: (cmy.c - k) / t,\n                m: (cmy.m - k) / t,\n                y: (cmy.y - k) / t,\n                k: k\n            };\n        }\n    }, {\n        key: 'cmyk2cmy',\n        value: function cmyk2cmy(cmyk) {\n            var k = cmyk.k;\n\n            return { // regular\n                c: cmyk.c * (1 - k) + k,\n                m: cmyk.m * (1 - k) + k,\n                y: cmyk.y * (1 - k) + k\n            };\n        }\n    }, {\n        key: 'cmy2rgb',\n        value: function cmy2rgb(cmy) {\n            return {\n                r: 1 - cmy.c,\n                g: 1 - cmy.m,\n                b: 1 - cmy.y\n            };\n        }\n    }, {\n        key: 'rgb2cmyk',\n        value: function rgb2cmyk(rgb) {\n            var cmy = ColorConverter.rgb2cmy(rgb); // doppelt??\n            return ColorConverter.cmy2cmyk(cmy);\n        }\n    }, {\n        key: 'cmyk2rgb',\n        value: function cmyk2rgb(cmyk) {\n            var cmy = ColorConverter.cmyk2cmy(cmyk); // doppelt??\n            return ColorConverter.cmy2rgb(cmy);\n        }\n\n        // ------------------------ LAB ------------------------ //\n\n    }, {\n        key: 'XYZ2rgb',\n        value: function XYZ2rgb(XYZ) {\n            var M = XYZMatrix,\n                X = XYZ.X,\n                Y = XYZ.Y,\n                Z = XYZ.Z,\n                r = X * M.R[0] + Y * M.R[1] + Z * M.R[2],\n                g = X * M.G[0] + Y * M.G[1] + Z * M.G[2],\n                b = X * M.B[0] + Y * M.B[1] + Z * M.B[2],\n                N = 1 / 2.4;\n\n            M = 0.0031308;\n\n            r = r > M ? 1.055 * Math.pow(r, N) - 0.055 : 12.92 * r;\n            g = g > M ? 1.055 * Math.pow(g, N) - 0.055 : 12.92 * g;\n            b = b > M ? 1.055 * Math.pow(b, N) - 0.055 : 12.92 * b;\n\n            return {\n                r: limitValue(r, 0, 1),\n                g: limitValue(g, 0, 1),\n                b: limitValue(b, 0, 1)\n            };\n        }\n    }, {\n        key: 'rgb2XYZ',\n        value: function rgb2XYZ(rgb) {\n            var M = XYZMatrix,\n                r = rgb.r,\n                g = rgb.g,\n                b = rgb.b,\n                N = 0.04045;\n\n            r = r > N ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;\n            g = g > N ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;\n            b = b > N ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;\n\n            return {\n                X: r * M.X[0] + g * M.X[1] + b * M.X[2],\n                Y: r * M.Y[0] + g * M.Y[1] + b * M.Y[2],\n                Z: r * M.Z[0] + g * M.Z[1] + b * M.Z[2]\n            };\n        }\n    }, {\n        key: 'XYZ2Lab',\n        value: function XYZ2Lab(XYZ) {\n            var R = XYZReference,\n                X = XYZ.X / R.X,\n                Y = XYZ.Y / R.Y,\n                Z = XYZ.Z / R.Z,\n                N = 16 / 116,\n                M = 1 / 3,\n                K = 0.008856,\n                L = 7.787037;\n\n            X = X > K ? Math.pow(X, M) : L * X + N;\n            Y = Y > K ? Math.pow(Y, M) : L * Y + N;\n            Z = Z > K ? Math.pow(Z, M) : L * Z + N;\n\n            return {\n                L: 116 * Y - 16,\n                a: 500 * (X - Y),\n                b: 200 * (Y - Z)\n            };\n        }\n    }, {\n        key: 'Lab2XYZ',\n        value: function Lab2XYZ(Lab) {\n            var R = XYZReference,\n                Y = (Lab.L + 16) / 116,\n                X = Lab.a / 500 + Y,\n                Z = Y - Lab.b / 200,\n                X3 = Math.pow(X, 3),\n                Y3 = Math.pow(Y, 3),\n                Z3 = Math.pow(Z, 3),\n                N = 16 / 116,\n                K = 0.008856,\n                L = 7.787037;\n\n            return {\n                X: (X3 > K ? X3 : (X - N) / L) * R.X,\n                Y: (Y3 > K ? Y3 : (Y - N) / L) * R.Y,\n                Z: (Z3 > K ? Z3 : (Z - N) / L) * R.Z\n            };\n        }\n    }, {\n        key: 'rgb2Lab',\n        value: function rgb2Lab(rgb) {\n            var XYZ = ColorConverter.rgb2XYZ(rgb);\n\n            return ColorConverter.XYZ2Lab(XYZ);\n        }\n    }, {\n        key: 'Lab2rgb',\n        value: function Lab2rgb(Lab) {\n            var XYZ = ColorConverter.Lab2XYZ(Lab);\n\n            return ColorConverter.XYZ2rgb(XYZ);\n        }\n    }]);\n\n    return ColorConverter;\n})();\n\nexports['default'] = ColorConverter;\n\nfunction limitValue(value, min, max) {\n    // return Math.max(min, Math.min(max, value)); // faster??\n    return value > max ? max : value < min ? min : value;\n}\n\nfunction getLuminance(rgb, normalized) {\n    var div = normalized ? 1 : 255,\n        RGB = [rgb.r / div, rgb.g / div, rgb.b / div];\n\n    for (var i = RGB.length; i--;) {\n        RGB[i] = RGB[i] <= 0.03928 ? RGB[i] / 12.92 : Math.pow((RGB[i] + 0.055) / 1.055, 2.4);\n    }\n    return luminance.r * RGB[0] + luminance.g * RGB[1] + luminance.b * RGB[2];\n}\n\nfunction getColorAsRGB(color) {\n    // Create a test element to apply a CSS color and retrieve\n    // a normalized value from.\n    var test = document.createElement('div');\n    test.style.backgroundColor = color;\n\n    // Chrome requires the element to be in DOM for styles to be computed.\n    document.body.appendChild(test);\n\n    // Get the computed style from the browser, in the format of\n    // rgb(x, x, x)\n    var normalized = window.getComputedStyle(test).backgroundColor;\n\n    // In certain cases getComputedStyle() may return\n    // 'transparent' as a value, which is useless(?) for the current\n    // color picker. According to specifications, transparent\n    // is a black with 0 alpha - rgba(0, 0, 0, 0) - but because\n    // the picker does not currently handle alpha, we return the\n    // black value.\n    if (normalized === 'transparent') {\n        normalized = 'rgb(0, 0, 0)';\n    }\n\n    // Garbage collection\n    test.parentNode.removeChild(test);\n\n    return normalized;\n}\n\nfunction getValueRanges(type) {\n    if (!type) {\n        return valueRanges;\n    } else {\n        return valueRanges[type];\n    }\n}\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],149:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar Float = (function () {\n    function Float(value) {\n        _classCallCheck(this, Float);\n\n        this.value = value;\n    }\n\n    _createClass(Float, [{\n        key: 'getString',\n        value: function getString() {\n            return this.value.toFixed(3);\n        }\n    }, {\n        key: 'uniformType',\n        value: function uniformType() {\n            return 'float';\n        }\n    }, {\n        key: 'uniformValue',\n        value: function uniformValue() {\n            return [this.value];\n        }\n    }, {\n        key: 'uniformMethod',\n        value: function uniformMethod() {\n            return '1f';\n        }\n    }]);\n\n    return Float;\n})();\n\nexports['default'] = Float;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],150:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nvar _interopRequireDefault = _dereq_('babel-runtime/helpers/interop-require-default')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar _Vector = _dereq_('./Vector');\n\nvar _Vector2 = _interopRequireDefault(_Vector);\n\n// TODO:\n//      - generalize this for mat2, mat3 and mat4\n\nvar Matrix = (function () {\n    function Matrix(m, type) {\n        _classCallCheck(this, Matrix);\n\n        this.dim = 3;\n        this.value = [[1, 0, 0], [0, 1, 0], [0, 0, 1]];\n        if (m) {\n            this.set(m, type);\n        }\n    }\n\n    _createClass(Matrix, [{\n        key: 'set',\n        value: function set(m, type) {\n            if (m.value[0][0]) {\n                this.value = m.value;\n                this.dim = m.dim;\n            } else if (m[0][0]) {\n                this.value = m;\n            }\n        }\n    }, {\n        key: 'rotateX',\n        value: function rotateX(theta) {\n            var c = Math.cos(theta);\n            var s = Math.sin(theta);\n            var T = [[1, 0, 0], [0, c, -s], [0, s, c]];\n\n            this.value = this.getTransform(T);\n        }\n    }, {\n        key: 'rotateY',\n        value: function rotateY(theta) {\n            var c = Math.cos(theta);\n            var s = Math.sin(theta);\n            var T = [[c, 0, s], [0, 1, 0], [-s, 0, c]];\n\n            this.value = this.getTransform(T);\n        }\n    }, {\n        key: 'getMult',\n        value: function getMult(v) {\n            if (v[0][0] || v.value && v.value[0][0]) {\n                // TODO: what If v is a matrix\n                console.log('TODO: what If v is a matrix');\n            } else {\n                // If v is a vector\n                var A = new _Vector2['default'](v);\n                var B = [];\n                for (var i = 0; i < A.dim; i++) {\n                    B.push(A.value[0] * this.value[i][0] + A.value[1] * this.value[i][1] + A.value[2] * this.value[i][2]);\n                }\n                return new _Vector2['default'](B);\n            }\n        }\n    }, {\n        key: 'getTransform',\n        value: function getTransform(m) {\n            var newMatrix = [];\n            for (var row in m) {\n                var t = m[row];\n                var newRow = [];\n                newRow.push(t[0] * this.value[0][0] + t[1] * this.value[1][0] + t[2] * this.value[2][0]);\n                newRow.push(t[0] * this.value[0][1] + t[1] * this.value[1][1] + t[2] * this.value[2][1]);\n                newRow.push(t[0] * this.value[0][2] + t[1] * this.value[1][2] + t[2] * this.value[2][2]);\n                newMatrix.push(newRow);\n            }\n            return newMatrix;\n        }\n    }, {\n        key: 'getInv',\n        value: function getInv() {\n            var M = new Matrix();\n            var determinant = this.value[0][0] * (this.value[1][1] * this.value[2][2] - this.value[2][1] * this.value[1][2]) - this.value[0][1] * (this.value[1][0] * this.value[2][2] - this.value[1][2] * this.value[2][0]) + this.value[0][2] * (this.value[1][0] * this.value[2][1] - this.value[1][1] * this.value[2][0]);\n            var invdet = 1 / determinant;\n            M.value[0][0] = (this.value[1][1] * this.value[2][2] - this.value[2][1] * this.value[1][2]) * invdet;\n            M.value[0][1] = -(this.value[0][1] * this.value[2][2] - this.value[0][2] * this.value[2][1]) * invdet;\n            M.value[0][2] = (this.value[0][1] * this.value[1][2] - this.value[0][2] * this.value[1][1]) * invdet;\n            M.value[1][0] = -(this.value[1][0] * this.value[2][2] - this.value[1][2] * this.value[2][0]) * invdet;\n            M.value[1][1] = (this.value[0][0] * this.value[2][2] - this.value[0][2] * this.value[2][0]) * invdet;\n            M.value[1][2] = -(this.value[0][0] * this.value[1][2] - this.value[1][0] * this.value[0][2]) * invdet;\n            M.value[2][0] = (this.value[1][0] * this.value[2][1] - this.value[2][0] * this.value[1][1]) * invdet;\n            M.value[2][1] = -(this.value[0][0] * this.value[2][1] - this.value[2][0] * this.value[0][1]) * invdet;\n            M.value[2][2] = (this.value[0][0] * this.value[1][1] - this.value[1][0] * this.value[0][1]) * invdet;\n            return M;\n        }\n    }]);\n\n    return Matrix;\n})();\n\nexports['default'] = Matrix;\nmodule.exports = exports['default'];\n\n},{\"./Vector\":151,\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11,\"babel-runtime/helpers/interop-require-default\":14}],151:[function(_dereq_,module,exports){\n'use strict';\n\nvar _createClass = _dereq_('babel-runtime/helpers/create-class')['default'];\n\nvar _classCallCheck = _dereq_('babel-runtime/helpers/class-call-check')['default'];\n\nObject.defineProperty(exports, '__esModule', {\n    value: true\n});\n\nvar Vector = (function () {\n    function Vector(vec, type) {\n        _classCallCheck(this, Vector);\n\n        this.value = [0, 0];\n        this.dim = 2;\n        this.set(vec, type);\n    }\n\n    _createClass(Vector, [{\n        key: 'set',\n        value: function set(vec, type) {\n            if (typeof vec === 'number') {\n                type = type || 'vec2';\n                this.set([vec], type);\n            } else if (typeof vec === 'string') {\n                var parts = vec.replace(/(?:#|\\)|\\]|%)/g, '').split('(');\n                var strValues = (parts[1] || parts[0].replace(/(\\[)/g, '')).split(/,\\s*/);\n                type = type || (parts[1] ? parts[0].substr(0, 4) : 'vec' + strValues.length);\n                var values = [];\n                for (var i in strValues) {\n                    values.push(parseFloat(strValues[i]));\n                }\n                this.set(values, type);\n            } else if (vec) {\n                if (Array.isArray(vec)) {\n                    this.value = [];\n                    this.value.length = 0;\n                    this.dim = type ? Number(type.substr(3, 4)) : vec.length;\n                    var filler = vec.length === 1 ? vec[0] : 0;\n                    for (var i = 0; i < this.dim; i++) {\n                        this.value.push(vec[i] || filler);\n                    }\n                } else if (vec.dim) {\n                    this.value = vec.value;\n                    this.dim = vec.dim;\n                }\n            }\n        }\n    }, {\n        key: 'getString',\n        value: function getString(type) {\n            type = type || 'vec' + this.dim;\n\n            var len = this.dim;\n            var str = '';\n            var head = type + '(';\n            var end = ')';\n\n            if (type === 'array') {\n                head = '[';\n                end = ']';\n                len = this.dim;\n            } else {\n                len = Number(type.substr(3, 4));\n            }\n\n            str = head;\n            for (var i = 0; i < len; i++) {\n                str += this.value[i].toFixed(3);\n                if (i !== len - 1) {\n                    str += ',';\n                }\n            }\n            return str += end;\n        }\n    }, {\n        key: 'uniformType',\n        value: function uniformType() {\n            return 'vec' + this.dim;\n        }\n    }, {\n        key: 'uniformValue',\n        value: function uniformValue() {\n            var arr = [];\n            for (var i = 0; i < this.dim; i++) {\n                arr.push(this.value[i]);\n            }\n            return arr;\n        }\n    }, {\n        key: 'uniformMethod',\n        value: function uniformMethod() {\n            return this.dim + 'f';\n        }\n\n        // VECTOR OPERATIONS\n\n    }, {\n        key: 'add',\n        value: function add(v) {\n            if (typeof v === 'number') {\n                for (var i = 0; i < this.dim; i++) {\n                    this.value[i] = this.value[i] + v;\n                }\n            } else {\n                var A = new Vector(v);\n                var lim = Math.min(this.dim, A.dim);\n                for (var i = 0; i < lim; i++) {\n                    this.value[i] = this.value[i] + A.value[i];\n                }\n            }\n        }\n    }, {\n        key: 'sub',\n        value: function sub(v) {\n            if (typeof v === 'number') {\n                for (var i = 0; i < this.dim; i++) {\n                    this.value[i] = this.value[i] - v;\n                }\n            } else {\n                var A = new Vector(v);\n                var lim = Math.min(this.dim, A.dim);\n                for (var i = 0; i < lim; i++) {\n                    this.value[i] = this.value[i] - A.value[i];\n                }\n            }\n        }\n    }, {\n        key: 'mult',\n        value: function mult(v) {\n            if (typeof v === 'number') {\n                // Mulitply by scalar\n                for (var i = 0; i < this.dim; i++) {\n                    this.value[i] = this.value[i] * v;\n                }\n            } else {\n                // Multiply two vectors\n                var A = new Vector(v);\n                var lim = Math.min(this.dim, A.dim);\n                for (var i = 0; i < lim; i++) {\n                    this.value[i] = this.value[i] * A.value[i];\n                }\n            }\n        }\n    }, {\n        key: 'div',\n        value: function div(v) {\n            if (typeof v === 'number') {\n                // Mulitply by scalar\n                for (var i = 0; i < this.dim; i++) {\n                    this.value[i] = this.value[i] / v;\n                }\n            } else {\n                // Multiply two vectors\n                var A = new Vector(v);\n                var lim = Math.min(this.dim, A.dim);\n                for (var i = 0; i < lim; i++) {\n                    this.value[i] = this.value[i] / A.value[i];\n                }\n            }\n        }\n    }, {\n        key: 'normalize',\n        value: function normalize() {\n            var l = this.getLength();\n            this.div(l);\n        }\n    }, {\n        key: 'getAdd',\n        value: function getAdd(v) {\n            var A = new Vector(this);\n            A.add(v);\n            return A;\n        }\n    }, {\n        key: 'getSub',\n        value: function getSub(v) {\n            var A = new Vector(this);\n            A.sub(v);\n            return A;\n        }\n    }, {\n        key: 'getMult',\n        value: function getMult(v) {\n            var A = new Vector(this);\n            A.mult(v);\n            return A;\n        }\n    }, {\n        key: 'getDiv',\n        value: function getDiv(v) {\n            var A = new Vector(this);\n            A.div(v);\n            return A;\n        }\n    }, {\n        key: 'getLengthSq',\n        value: function getLengthSq() {\n            if (this.dim === 2) {\n                return this.value[0] * this.value[0] + this.value[1] * this.value[1];\n            } else {\n                return this.value[0] * this.value[0] + this.value[1] * this.value[1] + this.value[2] * this.value[2];\n            }\n        }\n    }, {\n        key: 'getLength',\n        value: function getLength() {\n            return Math.sqrt(this.getLengthSq());\n        }\n    }, {\n        key: 'x',\n        set: function set(v) {\n            this.value[0] = v;\n        },\n        get: function get() {\n            return this.value[0] || 0.0;\n        }\n    }, {\n        key: 'y',\n        set: function set(v) {\n            this.value[1] = v;\n        },\n        get: function get() {\n            return this.value[1] || 0.0;\n        }\n    }, {\n        key: 'z',\n        set: function set(v) {\n            if (this.dim < 3) {\n                while (this.dim < 3) {\n                    this.value.push(0);\n                }\n                this.dim = 3;\n            }\n            this.value[2] = v;\n        },\n        get: function get() {\n            return this.value[2] || 0.0;\n        }\n    }, {\n        key: 'w',\n        set: function set(v) {\n            if (this.dim < 4) {\n                while (this.dim < 4) {\n                    this.value.push(0);\n                }\n                this.dim = 4;\n            }\n            this.value[3] = v;\n        },\n        get: function get() {\n            return this.value[3] || 0.0;\n        }\n    }]);\n\n    return Vector;\n})();\n\nexports['default'] = Vector;\nmodule.exports = exports['default'];\n\n},{\"babel-runtime/helpers/class-call-check\":10,\"babel-runtime/helpers/create-class\":11}],152:[function(_dereq_,module,exports){\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\n\"use strict\";\n\nvar saveAs = saveAs || (function (view) {\n  \"use strict\";if (typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n    return;\n  }var doc = view.document,\n      get_URL = function get_URL() {\n    return view.URL || view.webkitURL || view;\n  },\n      save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\"),\n      can_use_save_link = (\"download\" in save_link),\n      click = function click(node) {\n    var event = new MouseEvent(\"click\");node.dispatchEvent(event);\n  },\n      is_safari = /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent),\n      webkit_req_fs = view.webkitRequestFileSystem,\n      req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem,\n      throw_outside = function throw_outside(ex) {\n    (view.setImmediate || view.setTimeout)(function () {\n      throw ex;\n    }, 0);\n  },\n      force_saveable_type = \"application/octet-stream\",\n      fs_min_size = 0,\n      arbitrary_revoke_timeout = 500,\n      revoke = function revoke(file) {\n    var revoker = function revoker() {\n      if (typeof file === \"string\") {\n        get_URL().revokeObjectURL(file);\n      } else {\n        file.remove();\n      }\n    };if (view.chrome) {\n      revoker();\n    } else {\n      setTimeout(revoker, arbitrary_revoke_timeout);\n    }\n  },\n      dispatch = function dispatch(filesaver, event_types, event) {\n    event_types = [].concat(event_types);var i = event_types.length;while (i--) {\n      var listener = filesaver[\"on\" + event_types[i]];if (typeof listener === \"function\") {\n        try {\n          listener.call(filesaver, event || filesaver);\n        } catch (ex) {\n          throw_outside(ex);\n        }\n      }\n    }\n  },\n      auto_bom = function auto_bom(blob) {\n    if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n      return new Blob([\"﻿\", blob], { type: blob.type });\n    }return blob;\n  },\n      FileSaver = function FileSaver(blob, name, no_auto_bom) {\n    if (!no_auto_bom) {\n      blob = auto_bom(blob);\n    }var filesaver = this,\n        type = blob.type,\n        blob_changed = false,\n        object_url,\n        target_view,\n        dispatch_all = function dispatch_all() {\n      dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n    },\n        fs_error = function fs_error() {\n      if (target_view && is_safari && typeof FileReader !== \"undefined\") {\n        var reader = new FileReader();reader.onloadend = function () {\n          var base64Data = reader.result;target_view.location.href = \"data:attachment/file\" + base64Data.slice(base64Data.search(/[,;]/));filesaver.readyState = filesaver.DONE;dispatch_all();\n        };reader.readAsDataURL(blob);filesaver.readyState = filesaver.INIT;return;\n      }if (blob_changed || !object_url) {\n        object_url = get_URL().createObjectURL(blob);\n      }if (target_view) {\n        target_view.location.href = object_url;\n      } else {\n        var new_tab = view.open(object_url, \"_blank\");if (new_tab == undefined && is_safari) {\n          view.location.href = object_url;\n        }\n      }filesaver.readyState = filesaver.DONE;dispatch_all();revoke(object_url);\n    },\n        abortable = function abortable(func) {\n      return function () {\n        if (filesaver.readyState !== filesaver.DONE) {\n          return func.apply(this, arguments);\n        }\n      };\n    },\n        create_if_not_found = { create: true, exclusive: false },\n        slice;filesaver.readyState = filesaver.INIT;if (!name) {\n      name = \"download\";\n    }if (can_use_save_link) {\n      object_url = get_URL().createObjectURL(blob);setTimeout(function () {\n        save_link.href = object_url;save_link.download = name;click(save_link);dispatch_all();revoke(object_url);filesaver.readyState = filesaver.DONE;\n      });return;\n    }if (view.chrome && type && type !== force_saveable_type) {\n      slice = blob.slice || blob.webkitSlice;blob = slice.call(blob, 0, blob.size, force_saveable_type);blob_changed = true;\n    }if (webkit_req_fs && name !== \"download\") {\n      name += \".download\";\n    }if (type === force_saveable_type || webkit_req_fs) {\n      target_view = view;\n    }if (!req_fs) {\n      fs_error();return;\n    }fs_min_size += blob.size;req_fs(view.TEMPORARY, fs_min_size, abortable(function (fs) {\n      fs.root.getDirectory(\"saved\", create_if_not_found, abortable(function (dir) {\n        var save = function save() {\n          dir.getFile(name, create_if_not_found, abortable(function (file) {\n            file.createWriter(abortable(function (writer) {\n              writer.onwriteend = function (event) {\n                target_view.location.href = file.toURL();filesaver.readyState = filesaver.DONE;dispatch(filesaver, \"writeend\", event);revoke(file);\n              };writer.onerror = function () {\n                var error = writer.error;if (error.code !== error.ABORT_ERR) {\n                  fs_error();\n                }\n              };\"writestart progress write abort\".split(\" \").forEach(function (event) {\n                writer[\"on\" + event] = filesaver[\"on\" + event];\n              });writer.write(blob);filesaver.abort = function () {\n                writer.abort();filesaver.readyState = filesaver.DONE;\n              };filesaver.readyState = filesaver.WRITING;\n            }), fs_error);\n          }), fs_error);\n        };dir.getFile(name, { create: false }, abortable(function (file) {\n          file.remove();save();\n        }), abortable(function (ex) {\n          if (ex.code === ex.NOT_FOUND_ERR) {\n            save();\n          } else {\n            fs_error();\n          }\n        }));\n      }), fs_error);\n    }), fs_error);\n  },\n      FS_proto = FileSaver.prototype,\n      saveAs = function saveAs(blob, name, no_auto_bom) {\n    return new FileSaver(blob, name, no_auto_bom);\n  };if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n    return function (blob, name, no_auto_bom) {\n      if (!no_auto_bom) {\n        blob = auto_bom(blob);\n      }return navigator.msSaveOrOpenBlob(blob, name || \"download\");\n    };\n  }FS_proto.abort = function () {\n    var filesaver = this;filesaver.readyState = filesaver.DONE;dispatch(filesaver, \"abort\");\n  };FS_proto.readyState = FS_proto.INIT = 0;FS_proto.WRITING = 1;FS_proto.DONE = 2;FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;return saveAs;\n})(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || undefined.content);if (typeof module !== \"undefined\" && module.exports) {\n  module.exports.saveAs = saveAs;\n} else if (typeof define !== \"undefined\" && define !== null && define.amd != null) {\n  define([], function () {\n    return saveAs;\n  });\n}\n\n},{}]},{},[120])(120)\n});\n\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL2dldC1pdGVyYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2Fzc2lnbi5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2NyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9wcm9taXNlLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9zZXQuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzLWNhbGwtY2hlY2suanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZS1jbGFzcy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvZ2V0LmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cy5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvaW50ZXJvcC1yZXF1aXJlLWRlZmF1bHQuanMiLCJub2RlX21vZHVsZXMvY29kZW1pcnJvci9hZGRvbi9jb21tZW50L2NvbW1lbnQuanMiLCJub2RlX21vZHVsZXMvY29kZW1pcnJvci9hZGRvbi9kaWFsb2cvZGlhbG9nLmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3IvYWRkb24vZGlzcGxheS9wYW5lbC5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL2FkZG9uL2Rpc3BsYXkvcnVsZXJzLmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3IvYWRkb24vZWRpdC9jbG9zZWJyYWNrZXRzLmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3IvYWRkb24vZWRpdC9tYXRjaGJyYWNrZXRzLmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3IvYWRkb24vZm9sZC9mb2xkY29kZS5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL2FkZG9uL2ZvbGQvZm9sZGd1dHRlci5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL2FkZG9uL2ZvbGQvaW5kZW50LWZvbGQuanMiLCJub2RlX21vZHVsZXMvY29kZW1pcnJvci9hZGRvbi9oaW50L2phdmFzY3JpcHQtaGludC5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL2FkZG9uL2hpbnQvc2hvdy1oaW50LmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3IvYWRkb24vc2VhcmNoL3NlYXJjaC5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL2FkZG9uL3NlYXJjaC9zZWFyY2hjdXJzb3IuanMiLCJub2RlX21vZHVsZXMvY29kZW1pcnJvci9hZGRvbi93cmFwL2hhcmR3cmFwLmpzIiwibm9kZV9tb2R1bGVzL2NvZGVtaXJyb3Iva2V5bWFwL3N1YmxpbWUuanMiLCJub2RlX21vZHVsZXMvY29kZW1pcnJvci9saWIvY29kZW1pcnJvci5qcyIsIm5vZGVfbW9kdWxlcy9jb2RlbWlycm9yL21vZGUvY2xpa2UvY2xpa2UuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL2dldC1pdGVyYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2Fzc2lnbi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2tleXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9zZXQtcHJvdG90eXBlLW9mLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9wcm9taXNlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9zZXQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5hLWZ1bmN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuYWRkLXRvLXVuc2NvcGFibGVzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuYW4tb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuY2xhc3NvZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmNvZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmNvbGxlY3Rpb24tc3Ryb25nLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuY29sbGVjdGlvbi10by1qc29uLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuY29sbGVjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmNvcmUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5jdHguanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5kZWZpbmVkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuZGVzY3JpcHRvcnMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5kb20tY3JlYXRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuZXhwb3J0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuZmFpbHMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5mb3Itb2YuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5nbG9iYWwuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5oYXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5oaWRlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaHRtbC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmludm9rZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLmlvYmplY3QuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5pcy1hcnJheS1pdGVyLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaXMtb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaXRlci1jYWxsLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaXRlci1jcmVhdGUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5pdGVyLWRlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLml0ZXItZGV0ZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaXRlci1zdGVwLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuaXRlcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5saWJyYXJ5LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQubWljcm90YXNrLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQub2JqZWN0LWFzc2lnbi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLm9iamVjdC1zYXAuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5wcm9wZXJ0eS1kZXNjLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQucmVkZWZpbmUtYWxsLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQucmVkZWZpbmUuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5zYW1lLXZhbHVlLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuc2V0LXByb3RvLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuc2V0LXNwZWNpZXMuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5zZXQtdG8tc3RyaW5nLXRhZy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLnNoYXJlZC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLnNwZWNpZXMtY29uc3RydWN0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5zdHJpY3QtbmV3LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQuc3RyaW5nLWF0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQudGFzay5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy8kLnRvLWludGVnZXIuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC50by1pb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQudG8tbGVuZ3RoLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQudG8tb2JqZWN0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQudWlkLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzLyQud2tzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZC5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9jb3JlLmdldC1pdGVyYXRvci5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYuYXJyYXkuaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5hc3NpZ24uanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM2Lm9iamVjdC5rZXlzLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZi5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZy5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYucHJvbWlzZS5qcyIsIm5vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9lczYuc2V0LmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3IuanMiLCJub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvZXM3LnNldC50by1qc29uLmpzIiwibm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUuanMiLCJub2RlX21vZHVsZXMvY3Jvc3Mtc3RvcmFnZS9saWIvY2xpZW50LmpzIiwibm9kZV9tb2R1bGVzL2Nyb3NzLXN0b3JhZ2UvbGliL2h1Yi5qcyIsIm5vZGVfbW9kdWxlcy9jcm9zcy1zdG9yYWdlL2xpYi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9kb2N1bWVudC1yZWdpc3Rlci1lbGVtZW50L2J1aWxkL2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQuanMiLCJub2RlX21vZHVsZXMvZm9yLWVhY2gvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZ2xvYmFsL3dpbmRvdy5qcyIsIm5vZGVfbW9kdWxlcy9nbHNsQ2FudmFzL2xpYi9HbHNsQ2FudmFzLmpzIiwibm9kZV9tb2R1bGVzL2lzLWNhbGxhYmxlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2lzLWZ1bmN0aW9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3BhcnNlLWhlYWRlcnMvcGFyc2UtaGVhZGVycy5qcyIsIm5vZGVfbW9kdWxlcy90cmltL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3hoci9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy94dGVuZC9pbW11dGFibGUuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL0dsc2xFZGl0b3IuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL2NvcmUvRWRpdG9yLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy9jb3JlL1NoYWRlci5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvaW8vQnVmZmVyTWFuYWdlci5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvaW8vRmlsZURyb3AuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL2lvL0hhc2hXYXRjaC5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvaW8vTG9jYWxTdG9yYWdlLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy9pby9zaGFyZS5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvdG9vbHMvY29tbW9uLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy90b29scy9kZWJ1Z2dpbmcuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3Rvb2xzL2ludGVyYWN0aXZlRG9tLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy90b29scy9tZWRpYUNhcHR1cmUuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3Rvb2xzL21peGluLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy90b29scy91cmxzLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9FcnJvcnNEaXNwbGF5LmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9FeHBvcnRJY29uLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9IZWxwZXJzLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9NZW51LmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9NZW51SXRlbS5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvdWkvVmlzdWFsRGVidWdnZXIuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3VpL21vZGFscy9FeHBvcnRNb2RhbC5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvdWkvbW9kYWxzL01vZGFsLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9waWNrZXJzL0NvbG9yUGlja2VyLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9waWNrZXJzL0Zsb2F0UGlja2VyLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9waWNrZXJzL1BpY2tlci5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvdWkvcGlja2Vycy9WZWMyUGlja2VyLmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9waWNrZXJzL1ZlYzNQaWNrZXIuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3VpL3BpY2tlcnMvdHlwZXMvQ29sb3IuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3VpL3BpY2tlcnMvdHlwZXMvQ29sb3JDb252ZXJ0ZXIuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3VpL3BpY2tlcnMvdHlwZXMvRmxvYXQuanMiLCIvVXNlcnMvcGF0cmljaW9ndi9EZXNrdG9wL2dsc2xFZGl0b3Ivc3JjL2pzL3VpL3BpY2tlcnMvdHlwZXMvTWF0cml4LmpzIiwiL1VzZXJzL3BhdHJpY2lvZ3YvRGVza3RvcC9nbHNsRWRpdG9yL3NyYy9qcy91aS9waWNrZXJzL3R5cGVzL1ZlY3Rvci5qcyIsIi9Vc2Vycy9wYXRyaWNpb2d2L0Rlc2t0b3AvZ2xzbEVkaXRvci9zcmMvanMvdmVuZG9yL0ZpbGVTYXZlci5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25NQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeGJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hwUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeHVCQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7O0FDREE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7O0FDRkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7O0FDRkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdmNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNKQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDaGlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QyxRQUFRLENBQUM7QUFDckMsZ0JBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQztBQUN2QixnQkFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNyQixnQkFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQzVDLGdCQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQztBQUN6RCxnQkFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNyQixnQkFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7O0FBR2xCLGdCQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO0FBQ3BDLGdCQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7QUFDdkIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3JDLGdCQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDL0MsZ0JBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7OztBQUdsQixnQkFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7QUFDbkUs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QUcsSUFBSSxDQUFDLENBQUM7YUFDekM7QUFDRCxnQkFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7O0FBR2xCLGdCQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBQ3JDLGdCQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUM7QUFDekIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQztBQUM1QyxnQkFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQztBQUNyRCxnQkFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUNyQixnQkFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQzs7O0FBR2xCLGdCQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDO0FBQ3JCLGdCQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDM0MsZ0JBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDckQsZ0JBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDckIsZ0JBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7Ozs7O0FBV2xCLGdCQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEFBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMs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SSxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLEdBQUcsQ0FBQyxFQUN4RixDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDbEYsaUJBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO1NBQy9CLENBQUMsQ0FBQzs7QUFFSCxZQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQztBQUNiLHNCQUFVLEVBQUUsSUFBSSxDQUFDLE9BQU87QUFDeEIsaUJBQUssRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUM1RixDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFDeEYsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FB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RUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFO0FBQzFDLE9BQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFO0FBQzlDLE9BQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFO0FBQzlDLFFBQUksRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRTtBQUM1RCxPQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUU7QUFDcEQsT0FBRyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUU7QUFDOUMsT0FBRyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDeEMsU0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0FBQ3hCLE9BQUcsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsRUFBRTtDQUM5QixDQUFDOzs7QUFHRixJQUFJLFNBQVMsR0FBRztBQUNaLEtBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDO0FBQ3BDLEtBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDO0FBQ3BDLEtBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDO0FBQ3BDLEtBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQztBQUN0QyxLQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDO0FBQ3JDLEtBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUM7Q0FDeEMsQ0FBQzs7QUFFRixJQUFJLFlBQVksR0FBRztBQUNmLEtBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkQsS0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNuRCxLQUFDLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMs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QyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDMUI7QUFDRCxtQkFBTyxTQUFTLENBQUM7U0FDcEI7OztlQUVLLGtCQUFHO0FBQ0wsZ0JBQUksQ0FBQyxHQUFHLElBQUksTUFBTSxFQUFFLENBQUM7QUFDckIsZ0JBQUksV0FBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQSxBQUFDLEdBQzVGLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQSxBQUFDLEdBQzlGLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQSxBQUFDLENBQUM7QUFDbkgsZ0JBQUksTUFBTSxHQUFHLENBQUMsR0FBRyxXQUFXLENBQUM7QUFDN0IsYUFBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUEsR0FBSSxNQUFNLENBQUM7QUFDckcsYUFBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUEsQUFBQyxHQUFHLE1BQU0sQ0FBQztBQUN0RyxhQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQSxHQUFJLE1BQU0sQ0FBQztBQUNyRyxhQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQSxBQUFDLEdBQUcsTUFBTSxDQUFDO0FBQ3RHLGFBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBLEdBQUksTUFBTSxDQUFDO0FBQ3JHLGFBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBLEFBQUMsR0FBRyxNQUFNLENBQUM7QUFDdEcsYUFBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FB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LENBQUMsSUFBSSxDQUFDLENBQUE7T0FBQyxJQUFHLFdBQVcsRUFBQztBQUFDLG1CQUFXLENBQUMsUUFBUSxDQUFDLElBQUksR0FBQyxVQUFVLENBQUE7T0FBQyxNQUFJO0FBQUMsWUFBSSxPQUFPLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUMsUUFBUSxDQUFDLENBQUMsSUFBRyxPQUFPLElBQUUsU0FBUyxJQUFFLFNBQVMsRUFBQztBQUFDLGNBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFDLFVBQVUsQ0FBQTtTQUFDO09BQUMsU0FBUyxDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtLQUFDO1FBQUMsU0FBUyxHQUFDLFNBQVYsU0FBUyxDQUFVLElBQUksRUFBQztBQUFDLGFBQU8sWUFBVTtBQUFDLFlBQUcsU0FBUyxDQUFDLFVBQVUsS0FBRyxTQUFTLENBQUMsSUFBSSxFQUFDO0FBQUMsaUJBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUMsU0FBUyxDQUFDLENBQUE7U0FBQztPQUFDLENBQUE7S0FBQztRQUFDLG1CQUFtQixHQUFDLEVBQUMsTUFBTSxFQUFDLElBQUksRUFBQyxTQUFTLEVBQUMsS0FBSyxFQUFDO1FBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFHLENBQUMsSUFBSSxFQUFDO0FBQUMsVUFBSSxHQUFDLFVBQVUsQ0FBQTtLQUFDLElBQUcsaUJBQWlCLEVBQUM7QUFBQyxnQkFBVSxHQUFDLE9BQU8sRUFBRSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxVQUFVLENBQUMsWUFBVTtBQUFDLGlCQUFTLENBQUMsSUFBSSxHQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBWSxFQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUMsU0FBUyxDQUFDLElBQUksQ0FBQTtPQUFDLENBQUMsQ0FBQyxPQUFNO0tBQUMsSUFBRyxJQUFJLENBQUMsTUFBTSxJQUFFLElBQUksSUFBRSxJQUFJLEtBQUcsbUJBQW1CLEVBQUM7QUFBQyxXQUFLLEdBQUMsSUFBSSxDQUFDLEtBQUssSUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksR0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksRUFBQyxDQUFDLEVBQUMsSUFBSSxDQUFDLElBQUksRUFBQyxtQkFBbUIsQ0FBQyxDQUFDLFlBQVksR0FBQyxJQUFJLENBQUE7S0FBQyxJQUFHLGFBQWEsSUFBRSxJQUFJLEtBQUcsVUFBVSxFQUFDO0FBQUMsVUFBSSxJQUFFLFdBQVcsQ0FBQTtLQUFDLElBQUcsSUFBSSxLQUFHLG1CQUFtQixJQUFFLGFBQWEsRUFBQztBQUFDLGlCQUFXLEdBQUMsSUFBSSxDQUFBO0tBQUMsSUFBRyxDQUFDLE1BQU0sRUFBQztBQUFDLGNBQVEsRUFBRSxDQUFDLE9BQU07S0FBQyxXQUFXLElBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBQyxXQUFXLEVBQUMsU0FBUyxDQUFDLFVBQVMsRUFBRSxFQUFDO0FBQUMsUUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFDLG1CQUFtQixFQUFDLFNBQVMsQ0FBQyxVQUFTLEdBQUcsRUFBQztBQUFDLFlBQUksSUFBSSxHQUFDLFNBQUwsSUFBSSxHQUFXO0FBQUMsYUFBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUMsbUJBQW1CLEVBQUMsU0FBUyxDQUFDLFVBQVMsSUFBSSxFQUFDO0FBQUMsZ0JBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLFVBQVMsTUFBTSxFQUFDO0FBQUMsb0JBQU0sQ0FBQyxVQUFVLEdBQUMsVUFBUyxLQUFLLEVBQUM7QUFBQywyQkFBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEdBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFDLFVBQVUsRUFBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUE7ZUFBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUMsWUFBVTtBQUFDLG9CQUFJLEtBQUssR0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUcsS0FBSyxDQUFDLElBQUksS0FBRyxLQUFLLENBQUMsU0FBUyxFQUFDO0FBQUMsMEJBQVEsRUFBRSxDQUFBO2lCQUFDO2VBQUMsQ0FBQyxpQ0FBaUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVMsS0FBSyxFQUFDO0FBQUMsc0JBQU0sQ0FBQyxJQUFJLEdBQUMsS0FBSyxDQUFDLEdBQUMsU0FBUyxDQUFDLElBQUksR0FBQyxLQUFLLENBQUMsQ0FBQTtlQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLEdBQUMsWUFBVTtBQUFDLHNCQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsU0FBUyxDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsSUFBSSxDQUFBO2VBQUMsQ0FBQyxTQUFTLENBQUMsVUFBVSxHQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUE7YUFBQyxDQUFDLEVBQUMsUUFBUSxDQUFDLENBQUE7V0FBQyxDQUFDLEVBQUMsUUFBUSxDQUFDLENBQUE7U0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFDLEVBQUMsTUFBTSxFQUFDLEtBQUssRUFBQyxFQUFDLFNBQVMsQ0FBQyxVQUFTLElBQUksRUFBQztBQUFDLGNBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtTQUFDLENBQUMsRUFBQyxTQUFTLENBQUMsVUFBUyxFQUFFLEVBQUM7QUFBQyxjQUFHLEVBQUUsQ0FBQyxJQUFJLEtBQUcsRUFBRSxDQUFDLGFBQWEsRUFBQztBQUFDLGdCQUFJLEVBQUUsQ0FBQTtXQUFDLE1BQUk7QUFBQyxvQkFBUSxFQUFFLENBQUE7V0FBQztTQUFDLENBQUMsQ0FBQyxDQUFBO09BQUMsQ0FBQyxFQUFDLFFBQVEsQ0FBQyxDQUFBO0tBQUMsQ0FBQyxFQUFDLFFBQVEsQ0FBQyxDQUFBO0dBQUM7TUFBQyxRQUFRLEdBQUMsU0FBUyxDQUFDLFNBQVM7TUFBQyxNQUFNLEdBQUMsU0FBUCxNQUFNLENBQVUsSUFBSSxFQUFDLElBQUksRUFBQyxXQUFXLEVBQUM7QUFBQyxXQUFPLElBQUksU0FBUyxDQUFDLElBQUksRUFBQyxJQUFJLEVBQUMsV0FBVyxDQUFDLENBQUE7R0FBQyxDQUFDLElBQUcsT0FBTyxTQUFTLEtBQUcsV0FBVyxJQUFFLFNBQVMsQ0FBQyxnQkFBZ0IsRUFBQztBQUFDLFdBQU8sVUFBUyxJQUFJLEVBQUMsSUFBSSxFQUFDLFdBQVcsRUFBQztBQUFDLFVBQUcsQ0FBQyxXQUFXLEVBQUM7QUFBQyxZQUFJLEdBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFBO09BQUMsT0FBTyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFDLElBQUksSUFBRSxVQUFVLENBQUMsQ0FBQTtLQUFDLENBQUE7R0FBQyxRQUFRLENBQUMsS0FBSyxHQUFDLFlBQVU7QUFBQyxRQUFJLFNBQVMsR0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsR0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLEVBQUMsT0FBTyxDQUFDLENBQUE7R0FBQyxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUMsUUFBUSxDQUFDLElBQUksR0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksR0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssR0FBQyxRQUFRLENBQUMsWUFBWSxHQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUMsUUFBUSxDQUFDLE9BQU8sR0FBQyxRQUFRLENBQUMsT0FBTyxHQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQUMsUUFBUSxDQUFDLFVBQVUsR0FBQyxJQUFJLENBQUMsT0FBTyxNQUFNLENBQUE7Q0FBQyxDQUFBLENBQUMsT0FBTyxJQUFJLEtBQUcsV0FBVyxJQUFFLElBQUksSUFBRSxPQUFPLE1BQU0sS0FBRyxXQUFXLElBQUUsTUFBTSxJQUFFLFVBQUssT0FBTyxDQUFDLENBQUMsSUFBRyxPQUFPLE1BQU0sS0FBRyxXQUFXLElBQUUsTUFBTSxDQUFDLE9BQU8sRUFBQztBQUFDLFFBQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFDLE1BQU0sQ0FBQTtDQUFDLE1BQUssSUFBRyxPQUFPLE1BQU0sS0FBRyxXQUFXLElBQUUsTUFBTSxLQUFHLElBQUksSUFBRSxNQUFNLENBQUMsR0FBRyxJQUFFLElBQUksRUFBQztBQUFDLFFBQU0sQ0FBQyxFQUFFLEVBQUMsWUFBVTtBQUFDLFdBQU8sTUFBTSxDQUFBO0dBQUMsQ0FBQyxDQUFBO0NBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL2dldC1pdGVyYXRvclwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvYXNzaWduXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9jcmVhdGVcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eVwiKSwgX19lc01vZHVsZTogdHJ1ZSB9OyIsIm1vZHVsZS5leHBvcnRzID0geyBcImRlZmF1bHRcIjogcmVxdWlyZShcImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9rZXlzXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9zZXQtcHJvdG90eXBlLW9mXCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL3Byb21pc2VcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJtb2R1bGUuZXhwb3J0cyA9IHsgXCJkZWZhdWx0XCI6IHJlcXVpcmUoXCJjb3JlLWpzL2xpYnJhcnkvZm4vc2V0XCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn07XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfT2JqZWN0JGRlZmluZVByb3BlcnR5ID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZGVmaW5lLXByb3BlcnR5XCIpW1wiZGVmYXVsdFwiXTtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSAoZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcblxuICAgICAgX09iamVjdCRkZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gICAgcmV0dXJuIENvbnN0cnVjdG9yO1xuICB9O1xufSkoKTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9PYmplY3QkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yXCIpW1wiZGVmYXVsdFwiXTtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7XG4gIHZhciBfYWdhaW4gPSB0cnVlO1xuXG4gIF9mdW5jdGlvbjogd2hpbGUgKF9hZ2Fpbikge1xuICAgIHZhciBvYmplY3QgPSBfeCxcbiAgICAgICAgcHJvcGVydHkgPSBfeDIsXG4gICAgICAgIHJlY2VpdmVyID0gX3gzO1xuICAgIF9hZ2FpbiA9IGZhbHNlO1xuICAgIGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcblxuICAgIHZhciBkZXNjID0gX09iamVjdCRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7XG5cbiAgICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7XG5cbiAgICAgIGlmIChwYXJlbnQgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF94ID0gcGFyZW50O1xuICAgICAgICBfeDIgPSBwcm9wZXJ0eTtcbiAgICAgICAgX3gzID0gcmVjZWl2ZXI7XG4gICAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICAgIGRlc2MgPSBwYXJlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7XG4gICAgICByZXR1cm4gZGVzYy52YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0O1xuXG4gICAgICBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfT2JqZWN0JGNyZWF0ZSA9IHJlcXVpcmUoXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2NyZWF0ZVwiKVtcImRlZmF1bHRcIl07XG5cbnZhciBfT2JqZWN0JHNldFByb3RvdHlwZU9mID0gcmVxdWlyZShcImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qvc2V0LXByb3RvdHlwZS1vZlwiKVtcImRlZmF1bHRcIl07XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZnVuY3Rpb24gKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTtcbiAgfVxuXG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9IF9PYmplY3QkY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBfT2JqZWN0JHNldFByb3RvdHlwZU9mID8gX09iamVjdCRzZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzO1xufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7XG4gICAgXCJkZWZhdWx0XCI6IG9ialxuICB9O1xufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHA6Ly9jb2RlbWlycm9yLm5ldC9MSUNFTlNFXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZChyZXF1aXJlKFwiLi4vLi4vbGliL2NvZGVtaXJyb3JcIikpO1xuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSAvLyBBTURcbiAgICBkZWZpbmUoW1wiLi4vLi4vbGliL2NvZGVtaXJyb3JcIl0sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICBtb2QoQ29kZU1pcnJvcik7XG59KShmdW5jdGlvbihDb2RlTWlycm9yKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBub09wdGlvbnMgPSB7fTtcbiAgdmFyIG5vbldTID0gL1teXFxzXFx1MDBhMF0vO1xuICB2YXIgUG9zID0gQ29kZU1pcnJvci5Qb3M7XG5cbiAgZnVuY3Rpb24gZmlyc3ROb25XUyhzdHIpIHtcbiAgICB2YXIgZm91bmQgPSBzdHIuc2VhcmNoKG5vbldTKTtcbiAgICByZXR1cm4gZm91bmQgPT0gLTEgPyAwIDogZm91bmQ7XG4gIH1cblxuICBDb2RlTWlycm9yLmNvbW1hbmRzLnRvZ2dsZUNvbW1lbnQgPSBmdW5jdGlvbihjbSkge1xuICAgIGNtLnRvZ2dsZUNvbW1lbnQoKTtcbiAgfTtcblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcInRvZ2dsZUNvbW1lbnRcIiwgZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IG5vT3B0aW9ucztcbiAgICB2YXIgY20gPSB0aGlzO1xuICAgIHZhciBtaW5MaW5lID0gSW5maW5pdHksIHJhbmdlcyA9IHRoaXMubGlzdFNlbGVjdGlvbnMoKSwgbW9kZSA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IHJhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZyb20gPSByYW5nZXNbaV0uZnJvbSgpLCB0byA9IHJhbmdlc1tpXS50bygpO1xuICAgICAgaWYgKGZyb20ubGluZSA+PSBtaW5MaW5lKSBjb250aW51ZTtcbiAgICAgIGlmICh0by5saW5lID49IG1pbkxpbmUpIHRvID0gUG9zKG1pbkxpbmUsIDApO1xuICAgICAgbWluTGluZSA9IGZyb20ubGluZTtcbiAgICAgIGlmIChtb2RlID09IG51bGwpIHtcbiAgICAgICAgaWYgKGNtLnVuY29tbWVudChmcm9tLCB0bywgb3B0aW9ucykpIG1vZGUgPSBcInVuXCI7XG4gICAgICAgIGVsc2UgeyBjbS5saW5lQ29tbWVudChmcm9tLCB0bywgb3B0aW9ucyk7IG1vZGUgPSBcImxpbmVcIjsgfVxuICAgICAgfSBlbHNlIGlmIChtb2RlID09IFwidW5cIikge1xuICAgICAgICBjbS51bmNvbW1lbnQoZnJvbSwgdG8sIG9wdGlvbnMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY20ubGluZUNvbW1lbnQoZnJvbSwgdG8sIG9wdGlvbnMpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24oXCJsaW5lQ29tbWVudFwiLCBmdW5jdGlvbihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IG5vT3B0aW9ucztcbiAgICB2YXIgc2VsZiA9IHRoaXMsIG1vZGUgPSBzZWxmLmdldE1vZGVBdChmcm9tKTtcbiAgICB2YXIgY29tbWVudFN0cmluZyA9IG9wdGlvbnMubGluZUNvbW1lbnQgfHwgbW9kZS5saW5lQ29tbWVudDtcbiAgICBpZiAoIWNvbW1lbnRTdHJpbmcpIHtcbiAgICAgIGlmIChvcHRpb25zLmJsb2NrQ29tbWVudFN0YXJ0IHx8IG1vZGUuYmxvY2tDb21tZW50U3RhcnQpIHtcbiAgICAgICAgb3B0aW9ucy5mdWxsTGluZXMgPSB0cnVlO1xuICAgICAgICBzZWxmLmJsb2NrQ29tbWVudChmcm9tLCB0bywgb3B0aW9ucyk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBmaXJzdExpbmUgPSBzZWxmLmdldExpbmUoZnJvbS5saW5lKTtcbiAgICBpZiAoZmlyc3RMaW5lID09IG51bGwpIHJldHVybjtcbiAgICB2YXIgZW5kID0gTWF0aC5taW4odG8uY2ggIT0gMCB8fCB0by5saW5lID09IGZyb20ubGluZSA/IHRvLmxpbmUgKyAxIDogdG8ubGluZSwgc2VsZi5sYXN0TGluZSgpICsgMSk7XG4gICAgdmFyIHBhZCA9IG9wdGlvbnMucGFkZGluZyA9PSBudWxsID8gXCIgXCIgOiBvcHRpb25zLnBhZGRpbmc7XG4gICAgdmFyIGJsYW5rTGluZXMgPSBvcHRpb25zLmNvbW1lbnRCbGFua0xpbmVzIHx8IGZyb20ubGluZSA9PSB0by5saW5lO1xuXG4gICAgc2VsZi5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICBpZiAob3B0aW9ucy5pbmRlbnQpIHtcbiAgICAgICAgdmFyIGJhc2VTdHJpbmcgPSBudWxsO1xuICAgICAgICBmb3IgKHZhciBpID0gZnJvbS5saW5lOyBpIDwgZW5kOyArK2kpIHtcbiAgICAgICAgICB2YXIgbGluZSA9IHNlbGYuZ2V0TGluZShpKTtcbiAgICAgICAgICB2YXIgd2hpdGVzcGFjZSA9IGxpbmUuc2xpY2UoMCwgZmlyc3ROb25XUyhsaW5lKSk7XG4gICAgICAgICAgaWYgKGJhc2VTdHJpbmcgPT0gbnVsbCB8fCBiYXNlU3RyaW5nLmxlbmd0aCA+IHdoaXRlc3BhY2UubGVuZ3RoKSB7XG4gICAgICAgICAgICBiYXNlU3RyaW5nID0gd2hpdGVzcGFjZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IGZyb20ubGluZTsgaSA8IGVuZDsgKytpKSB7XG4gICAgICAgICAgdmFyIGxpbmUgPSBzZWxmLmdldExpbmUoaSksIGN1dCA9IGJhc2VTdHJpbmcubGVuZ3RoO1xuICAgICAgICAgIGlmICghYmxhbmtMaW5lcyAmJiAhbm9uV1MudGVzdChsaW5lKSkgY29udGludWU7XG4gICAgICAgICAgaWYgKGxpbmUuc2xpY2UoMCwgY3V0KSAhPSBiYXNlU3RyaW5nKSBjdXQgPSBmaXJzdE5vbldTKGxpbmUpO1xuICAgICAgICAgIHNlbGYucmVwbGFjZVJhbmdlKGJhc2VTdHJpbmcgKyBjb21tZW50U3RyaW5nICsgcGFkLCBQb3MoaSwgMCksIFBvcyhpLCBjdXQpKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGZyb20ubGluZTsgaSA8IGVuZDsgKytpKSB7XG4gICAgICAgICAgaWYgKGJsYW5rTGluZXMgfHwgbm9uV1MudGVzdChzZWxmLmdldExpbmUoaSkpKVxuICAgICAgICAgICAgc2VsZi5yZXBsYWNlUmFuZ2UoY29tbWVudFN0cmluZyArIHBhZCwgUG9zKGksIDApKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcImJsb2NrQ29tbWVudFwiLCBmdW5jdGlvbihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IG5vT3B0aW9ucztcbiAgICB2YXIgc2VsZiA9IHRoaXMsIG1vZGUgPSBzZWxmLmdldE1vZGVBdChmcm9tKTtcbiAgICB2YXIgc3RhcnRTdHJpbmcgPSBvcHRpb25zLmJsb2NrQ29tbWVudFN0YXJ0IHx8IG1vZGUuYmxvY2tDb21tZW50U3RhcnQ7XG4gICAgdmFyIGVuZFN0cmluZyA9IG9wdGlvbnMuYmxvY2tDb21tZW50RW5kIHx8IG1vZGUuYmxvY2tDb21tZW50RW5kO1xuICAgIGlmICghc3RhcnRTdHJpbmcgfHwgIWVuZFN0cmluZykge1xuICAgICAgaWYgKChvcHRpb25zLmxpbmVDb21tZW50IHx8IG1vZGUubGluZUNvbW1lbnQpICYmIG9wdGlvbnMuZnVsbExpbmVzICE9IGZhbHNlKVxuICAgICAgICBzZWxmLmxpbmVDb21tZW50KGZyb20sIHRvLCBvcHRpb25zKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgZW5kID0gTWF0aC5taW4odG8ubGluZSwgc2VsZi5sYXN0TGluZSgpKTtcbiAgICBpZiAoZW5kICE9IGZyb20ubGluZSAmJiB0by5jaCA9PSAwICYmIG5vbldTLnRlc3Qoc2VsZi5nZXRMaW5lKGVuZCkpKSAtLWVuZDtcblxuICAgIHZhciBwYWQgPSBvcHRpb25zLnBhZGRpbmcgPT0gbnVsbCA/IFwiIFwiIDogb3B0aW9ucy5wYWRkaW5nO1xuICAgIGlmIChmcm9tLmxpbmUgPiBlbmQpIHJldHVybjtcblxuICAgIHNlbGYub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKG9wdGlvbnMuZnVsbExpbmVzICE9IGZhbHNlKSB7XG4gICAgICAgIHZhciBsYXN0TGluZUhhc1RleHQgPSBub25XUy50ZXN0KHNlbGYuZ2V0TGluZShlbmQpKTtcbiAgICAgICAgc2VsZi5yZXBsYWNlUmFuZ2UocGFkICsgZW5kU3RyaW5nLCBQb3MoZW5kKSk7XG4gICAgICAgIHNlbGYucmVwbGFjZVJhbmdlKHN0YXJ0U3RyaW5nICsgcGFkLCBQb3MoZnJvbS5saW5lLCAwKSk7XG4gICAgICAgIHZhciBsZWFkID0gb3B0aW9ucy5ibG9ja0NvbW1lbnRMZWFkIHx8IG1vZGUuYmxvY2tDb21tZW50TGVhZDtcbiAgICAgICAgaWYgKGxlYWQgIT0gbnVsbCkgZm9yICh2YXIgaSA9IGZyb20ubGluZSArIDE7IGkgPD0gZW5kOyArK2kpXG4gICAgICAgICAgaWYgKGkgIT0gZW5kIHx8IGxhc3RMaW5lSGFzVGV4dClcbiAgICAgICAgICAgIHNlbGYucmVwbGFjZVJhbmdlKGxlYWQgKyBwYWQsIFBvcyhpLCAwKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLnJlcGxhY2VSYW5nZShlbmRTdHJpbmcsIHRvKTtcbiAgICAgICAgc2VsZi5yZXBsYWNlUmFuZ2Uoc3RhcnRTdHJpbmcsIGZyb20pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcInVuY29tbWVudFwiLCBmdW5jdGlvbihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IG5vT3B0aW9ucztcbiAgICB2YXIgc2VsZiA9IHRoaXMsIG1vZGUgPSBzZWxmLmdldE1vZGVBdChmcm9tKTtcbiAgICB2YXIgZW5kID0gTWF0aC5taW4odG8uY2ggIT0gMCB8fCB0by5saW5lID09IGZyb20ubGluZSA/IHRvLmxpbmUgOiB0by5saW5lIC0gMSwgc2VsZi5sYXN0TGluZSgpKSwgc3RhcnQgPSBNYXRoLm1pbihmcm9tLmxpbmUsIGVuZCk7XG5cbiAgICAvLyBUcnkgZmluZGluZyBsaW5lIGNvbW1lbnRzXG4gICAgdmFyIGxpbmVTdHJpbmcgPSBvcHRpb25zLmxpbmVDb21tZW50IHx8IG1vZGUubGluZUNvbW1lbnQsIGxpbmVzID0gW107XG4gICAgdmFyIHBhZCA9IG9wdGlvbnMucGFkZGluZyA9PSBudWxsID8gXCIgXCIgOiBvcHRpb25zLnBhZGRpbmcsIGRpZFNvbWV0aGluZztcbiAgICBsaW5lQ29tbWVudDoge1xuICAgICAgaWYgKCFsaW5lU3RyaW5nKSBicmVhayBsaW5lQ29tbWVudDtcbiAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8PSBlbmQ7ICsraSkge1xuICAgICAgICB2YXIgbGluZSA9IHNlbGYuZ2V0TGluZShpKTtcbiAgICAgICAgdmFyIGZvdW5kID0gbGluZS5pbmRleE9mKGxpbmVTdHJpbmcpO1xuICAgICAgICBpZiAoZm91bmQgPiAtMSAmJiAhL2NvbW1lbnQvLnRlc3Qoc2VsZi5nZXRUb2tlblR5cGVBdChQb3MoaSwgZm91bmQgKyAxKSkpKSBmb3VuZCA9IC0xO1xuICAgICAgICBpZiAoZm91bmQgPT0gLTEgJiYgKGkgIT0gZW5kIHx8IGkgPT0gc3RhcnQpICYmIG5vbldTLnRlc3QobGluZSkpIGJyZWFrIGxpbmVDb21tZW50O1xuICAgICAgICBpZiAoZm91bmQgPiAtMSAmJiBub25XUy50ZXN0KGxpbmUuc2xpY2UoMCwgZm91bmQpKSkgYnJlYWsgbGluZUNvbW1lbnQ7XG4gICAgICAgIGxpbmVzLnB1c2gobGluZSk7XG4gICAgICB9XG4gICAgICBzZWxmLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDw9IGVuZDsgKytpKSB7XG4gICAgICAgICAgdmFyIGxpbmUgPSBsaW5lc1tpIC0gc3RhcnRdO1xuICAgICAgICAgIHZhciBwb3MgPSBsaW5lLmluZGV4T2YobGluZVN0cmluZyksIGVuZFBvcyA9IHBvcyArIGxpbmVTdHJpbmcubGVuZ3RoO1xuICAgICAgICAgIGlmIChwb3MgPCAwKSBjb250aW51ZTtcbiAgICAgICAgICBpZiAobGluZS5zbGljZShlbmRQb3MsIGVuZFBvcyArIHBhZC5sZW5ndGgpID09IHBhZCkgZW5kUG9zICs9IHBhZC5sZW5ndGg7XG4gICAgICAgICAgZGlkU29tZXRoaW5nID0gdHJ1ZTtcbiAgICAgICAgICBzZWxmLnJlcGxhY2VSYW5nZShcIlwiLCBQb3MoaSwgcG9zKSwgUG9zKGksIGVuZFBvcykpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChkaWRTb21ldGhpbmcpIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIFRyeSBibG9jayBjb21tZW50c1xuICAgIHZhciBzdGFydFN0cmluZyA9IG9wdGlvbnMuYmxvY2tDb21tZW50U3RhcnQgfHwgbW9kZS5ibG9ja0NvbW1lbnRTdGFydDtcbiAgICB2YXIgZW5kU3RyaW5nID0gb3B0aW9ucy5ibG9ja0NvbW1lbnRFbmQgfHwgbW9kZS5ibG9ja0NvbW1lbnRFbmQ7XG4gICAgaWYgKCFzdGFydFN0cmluZyB8fCAhZW5kU3RyaW5nKSByZXR1cm4gZmFsc2U7XG4gICAgdmFyIGxlYWQgPSBvcHRpb25zLmJsb2NrQ29tbWVudExlYWQgfHwgbW9kZS5ibG9ja0NvbW1lbnRMZWFkO1xuICAgIHZhciBzdGFydExpbmUgPSBzZWxmLmdldExpbmUoc3RhcnQpLCBlbmRMaW5lID0gZW5kID09IHN0YXJ0ID8gc3RhcnRMaW5lIDogc2VsZi5nZXRMaW5lKGVuZCk7XG4gICAgdmFyIG9wZW4gPSBzdGFydExpbmUuaW5kZXhPZihzdGFydFN0cmluZyksIGNsb3NlID0gZW5kTGluZS5sYXN0SW5kZXhPZihlbmRTdHJpbmcpO1xuICAgIGlmIChjbG9zZSA9PSAtMSAmJiBzdGFydCAhPSBlbmQpIHtcbiAgICAgIGVuZExpbmUgPSBzZWxmLmdldExpbmUoLS1lbmQpO1xuICAgICAgY2xvc2UgPSBlbmRMaW5lLmxhc3RJbmRleE9mKGVuZFN0cmluZyk7XG4gICAgfVxuICAgIGlmIChvcGVuID09IC0xIHx8IGNsb3NlID09IC0xIHx8XG4gICAgICAgICEvY29tbWVudC8udGVzdChzZWxmLmdldFRva2VuVHlwZUF0KFBvcyhzdGFydCwgb3BlbiArIDEpKSkgfHxcbiAgICAgICAgIS9jb21tZW50Ly50ZXN0KHNlbGYuZ2V0VG9rZW5UeXBlQXQoUG9zKGVuZCwgY2xvc2UgKyAxKSkpKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gQXZvaWQga2lsbGluZyBibG9jayBjb21tZW50cyBjb21wbGV0ZWx5IG91dHNpZGUgdGhlIHNlbGVjdGlvbi5cbiAgICAvLyBQb3NpdGlvbnMgb2YgdGhlIGxhc3Qgc3RhcnRTdHJpbmcgYmVmb3JlIHRoZSBzdGFydCBvZiB0aGUgc2VsZWN0aW9uLCBhbmQgdGhlIGZpcnN0IGVuZFN0cmluZyBhZnRlciBpdC5cbiAgICB2YXIgbGFzdFN0YXJ0ID0gc3RhcnRMaW5lLmxhc3RJbmRleE9mKHN0YXJ0U3RyaW5nLCBmcm9tLmNoKTtcbiAgICB2YXIgZmlyc3RFbmQgPSBsYXN0U3RhcnQgPT0gLTEgPyAtMSA6IHN0YXJ0TGluZS5zbGljZSgwLCBmcm9tLmNoKS5pbmRleE9mKGVuZFN0cmluZywgbGFzdFN0YXJ0ICsgc3RhcnRTdHJpbmcubGVuZ3RoKTtcbiAgICBpZiAobGFzdFN0YXJ0ICE9IC0xICYmIGZpcnN0RW5kICE9IC0xICYmIGZpcnN0RW5kICsgZW5kU3RyaW5nLmxlbmd0aCAhPSBmcm9tLmNoKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gUG9zaXRpb25zIG9mIHRoZSBmaXJzdCBlbmRTdHJpbmcgYWZ0ZXIgdGhlIGVuZCBvZiB0aGUgc2VsZWN0aW9uLCBhbmQgdGhlIGxhc3Qgc3RhcnRTdHJpbmcgYmVmb3JlIGl0LlxuICAgIGZpcnN0RW5kID0gZW5kTGluZS5pbmRleE9mKGVuZFN0cmluZywgdG8uY2gpO1xuICAgIHZhciBhbG1vc3RMYXN0U3RhcnQgPSBlbmRMaW5lLnNsaWNlKHRvLmNoKS5sYXN0SW5kZXhPZihzdGFydFN0cmluZywgZmlyc3RFbmQgLSB0by5jaCk7XG4gICAgbGFzdFN0YXJ0ID0gKGZpcnN0RW5kID09IC0xIHx8IGFsbW9zdExhc3RTdGFydCA9PSAtMSkgPyAtMSA6IHRvLmNoICsgYWxtb3N0TGFzdFN0YXJ0O1xuICAgIGlmIChmaXJzdEVuZCAhPSAtMSAmJiBsYXN0U3RhcnQgIT0gLTEgJiYgbGFzdFN0YXJ0ICE9IHRvLmNoKSByZXR1cm4gZmFsc2U7XG5cbiAgICBzZWxmLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYucmVwbGFjZVJhbmdlKFwiXCIsIFBvcyhlbmQsIGNsb3NlIC0gKHBhZCAmJiBlbmRMaW5lLnNsaWNlKGNsb3NlIC0gcGFkLmxlbmd0aCwgY2xvc2UpID09IHBhZCA/IHBhZC5sZW5ndGggOiAwKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBQb3MoZW5kLCBjbG9zZSArIGVuZFN0cmluZy5sZW5ndGgpKTtcbiAgICAgIHZhciBvcGVuRW5kID0gb3BlbiArIHN0YXJ0U3RyaW5nLmxlbmd0aDtcbiAgICAgIGlmIChwYWQgJiYgc3RhcnRMaW5lLnNsaWNlKG9wZW5FbmQsIG9wZW5FbmQgKyBwYWQubGVuZ3RoKSA9PSBwYWQpIG9wZW5FbmQgKz0gcGFkLmxlbmd0aDtcbiAgICAgIHNlbGYucmVwbGFjZVJhbmdlKFwiXCIsIFBvcyhzdGFydCwgb3BlbiksIFBvcyhzdGFydCwgb3BlbkVuZCkpO1xuICAgICAgaWYgKGxlYWQpIGZvciAodmFyIGkgPSBzdGFydCArIDE7IGkgPD0gZW5kOyArK2kpIHtcbiAgICAgICAgdmFyIGxpbmUgPSBzZWxmLmdldExpbmUoaSksIGZvdW5kID0gbGluZS5pbmRleE9mKGxlYWQpO1xuICAgICAgICBpZiAoZm91bmQgPT0gLTEgfHwgbm9uV1MudGVzdChsaW5lLnNsaWNlKDAsIGZvdW5kKSkpIGNvbnRpbnVlO1xuICAgICAgICB2YXIgZm91bmRFbmQgPSBmb3VuZCArIGxlYWQubGVuZ3RoO1xuICAgICAgICBpZiAocGFkICYmIGxpbmUuc2xpY2UoZm91bmRFbmQsIGZvdW5kRW5kICsgcGFkLmxlbmd0aCkgPT0gcGFkKSBmb3VuZEVuZCArPSBwYWQubGVuZ3RoO1xuICAgICAgICBzZWxmLnJlcGxhY2VSYW5nZShcIlwiLCBQb3MoaSwgZm91bmQpLCBQb3MoaSwgZm91bmRFbmQpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG59KTtcbiIsIi8vIENvZGVNaXJyb3IsIGNvcHlyaWdodCAoYykgYnkgTWFyaWpuIEhhdmVyYmVrZSBhbmQgb3RoZXJzXG4vLyBEaXN0cmlidXRlZCB1bmRlciBhbiBNSVQgbGljZW5zZTogaHR0cDovL2NvZGVtaXJyb3IubmV0L0xJQ0VOU0VcblxuLy8gT3BlbiBzaW1wbGUgZGlhbG9ncyBvbiB0b3Agb2YgYW4gZWRpdG9yLiBSZWxpZXMgb24gZGlhbG9nLmNzcy5cblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgZnVuY3Rpb24gZGlhbG9nRGl2KGNtLCB0ZW1wbGF0ZSwgYm90dG9tKSB7XG4gICAgdmFyIHdyYXAgPSBjbS5nZXRXcmFwcGVyRWxlbWVudCgpO1xuICAgIHZhciBkaWFsb2c7XG4gICAgZGlhbG9nID0gd3JhcC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtcbiAgICBpZiAoYm90dG9tKVxuICAgICAgZGlhbG9nLmNsYXNzTmFtZSA9IFwiQ29kZU1pcnJvci1kaWFsb2cgQ29kZU1pcnJvci1kaWFsb2ctYm90dG9tXCI7XG4gICAgZWxzZVxuICAgICAgZGlhbG9nLmNsYXNzTmFtZSA9IFwiQ29kZU1pcnJvci1kaWFsb2cgQ29kZU1pcnJvci1kaWFsb2ctdG9wXCI7XG5cbiAgICBpZiAodHlwZW9mIHRlbXBsYXRlID09IFwic3RyaW5nXCIpIHtcbiAgICAgIGRpYWxvZy5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcbiAgICB9IGVsc2UgeyAvLyBBc3N1bWluZyBpdCdzIGEgZGV0YWNoZWQgRE9NIGVsZW1lbnQuXG4gICAgICBkaWFsb2cuYXBwZW5kQ2hpbGQodGVtcGxhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gZGlhbG9nO1xuICB9XG5cbiAgZnVuY3Rpb24gY2xvc2VOb3RpZmljYXRpb24oY20sIG5ld1ZhbCkge1xuICAgIGlmIChjbS5zdGF0ZS5jdXJyZW50Tm90aWZpY2F0aW9uQ2xvc2UpXG4gICAgICBjbS5zdGF0ZS5jdXJyZW50Tm90aWZpY2F0aW9uQ2xvc2UoKTtcbiAgICBjbS5zdGF0ZS5jdXJyZW50Tm90aWZpY2F0aW9uQ2xvc2UgPSBuZXdWYWw7XG4gIH1cblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcIm9wZW5EaWFsb2dcIiwgZnVuY3Rpb24odGVtcGxhdGUsIGNhbGxiYWNrLCBvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zKSBvcHRpb25zID0ge307XG5cbiAgICBjbG9zZU5vdGlmaWNhdGlvbih0aGlzLCBudWxsKTtcblxuICAgIHZhciBkaWFsb2cgPSBkaWFsb2dEaXYodGhpcywgdGVtcGxhdGUsIG9wdGlvbnMuYm90dG9tKTtcbiAgICB2YXIgY2xvc2VkID0gZmFsc2UsIG1lID0gdGhpcztcbiAgICBmdW5jdGlvbiBjbG9zZShuZXdWYWwpIHtcbiAgICAgIGlmICh0eXBlb2YgbmV3VmFsID09ICdzdHJpbmcnKSB7XG4gICAgICAgIGlucC52YWx1ZSA9IG5ld1ZhbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChjbG9zZWQpIHJldHVybjtcbiAgICAgICAgY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgZGlhbG9nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlhbG9nKTtcbiAgICAgICAgbWUuZm9jdXMoKTtcblxuICAgICAgICBpZiAob3B0aW9ucy5vbkNsb3NlKSBvcHRpb25zLm9uQ2xvc2UoZGlhbG9nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaW5wID0gZGlhbG9nLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF0sIGJ1dHRvbjtcbiAgICBpZiAoaW5wKSB7XG4gICAgICBpZiAob3B0aW9ucy52YWx1ZSkge1xuICAgICAgICBpbnAudmFsdWUgPSBvcHRpb25zLnZhbHVlO1xuICAgICAgICBpZiAob3B0aW9ucy5zZWxlY3RWYWx1ZU9uT3BlbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBpbnAuc2VsZWN0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMub25JbnB1dClcbiAgICAgICAgQ29kZU1pcnJvci5vbihpbnAsIFwiaW5wdXRcIiwgZnVuY3Rpb24oZSkgeyBvcHRpb25zLm9uSW5wdXQoZSwgaW5wLnZhbHVlLCBjbG9zZSk7fSk7XG4gICAgICBpZiAob3B0aW9ucy5vbktleVVwKVxuICAgICAgICBDb2RlTWlycm9yLm9uKGlucCwgXCJrZXl1cFwiLCBmdW5jdGlvbihlKSB7b3B0aW9ucy5vbktleVVwKGUsIGlucC52YWx1ZSwgY2xvc2UpO30pO1xuXG4gICAgICBDb2RlTWlycm9yLm9uKGlucCwgXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5vbktleURvd24gJiYgb3B0aW9ucy5vbktleURvd24oZSwgaW5wLnZhbHVlLCBjbG9zZSkpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMjcgfHwgKG9wdGlvbnMuY2xvc2VPbkVudGVyICE9PSBmYWxzZSAmJiBlLmtleUNvZGUgPT0gMTMpKSB7XG4gICAgICAgICAgaW5wLmJsdXIoKTtcbiAgICAgICAgICBDb2RlTWlycm9yLmVfc3RvcChlKTtcbiAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIGNhbGxiYWNrKGlucC52YWx1ZSwgZSk7XG4gICAgICB9KTtcblxuICAgICAgaWYgKG9wdGlvbnMuY2xvc2VPbkJsdXIgIT09IGZhbHNlKSBDb2RlTWlycm9yLm9uKGlucCwgXCJibHVyXCIsIGNsb3NlKTtcblxuICAgICAgaW5wLmZvY3VzKCk7XG4gICAgfSBlbHNlIGlmIChidXR0b24gPSBkaWFsb2cuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJidXR0b25cIilbMF0pIHtcbiAgICAgIENvZGVNaXJyb3Iub24oYnV0dG9uLCBcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBjbG9zZSgpO1xuICAgICAgICBtZS5mb2N1cygpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvcHRpb25zLmNsb3NlT25CbHVyICE9PSBmYWxzZSkgQ29kZU1pcnJvci5vbihidXR0b24sIFwiYmx1clwiLCBjbG9zZSk7XG5cbiAgICAgIGJ1dHRvbi5mb2N1cygpO1xuICAgIH1cbiAgICByZXR1cm4gY2xvc2U7XG4gIH0pO1xuXG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwib3BlbkNvbmZpcm1cIiwgZnVuY3Rpb24odGVtcGxhdGUsIGNhbGxiYWNrcywgb3B0aW9ucykge1xuICAgIGNsb3NlTm90aWZpY2F0aW9uKHRoaXMsIG51bGwpO1xuICAgIHZhciBkaWFsb2cgPSBkaWFsb2dEaXYodGhpcywgdGVtcGxhdGUsIG9wdGlvbnMgJiYgb3B0aW9ucy5ib3R0b20pO1xuICAgIHZhciBidXR0b25zID0gZGlhbG9nLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYnV0dG9uXCIpO1xuICAgIHZhciBjbG9zZWQgPSBmYWxzZSwgbWUgPSB0aGlzLCBibHVycmluZyA9IDE7XG4gICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICBpZiAoY2xvc2VkKSByZXR1cm47XG4gICAgICBjbG9zZWQgPSB0cnVlO1xuICAgICAgZGlhbG9nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlhbG9nKTtcbiAgICAgIG1lLmZvY3VzKCk7XG4gICAgfVxuICAgIGJ1dHRvbnNbMF0uZm9jdXMoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBiID0gYnV0dG9uc1tpXTtcbiAgICAgIChmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBDb2RlTWlycm9yLm9uKGIsIFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgIENvZGVNaXJyb3IuZV9wcmV2ZW50RGVmYXVsdChlKTtcbiAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2sobWUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pKGNhbGxiYWNrc1tpXSk7XG4gICAgICBDb2RlTWlycm9yLm9uKGIsIFwiYmx1clwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLS1ibHVycmluZztcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgaWYgKGJsdXJyaW5nIDw9IDApIGNsb3NlKCk7IH0sIDIwMCk7XG4gICAgICB9KTtcbiAgICAgIENvZGVNaXJyb3Iub24oYiwgXCJmb2N1c1wiLCBmdW5jdGlvbigpIHsgKytibHVycmluZzsgfSk7XG4gICAgfVxuICB9KTtcblxuICAvKlxuICAgKiBvcGVuTm90aWZpY2F0aW9uXG4gICAqIE9wZW5zIGEgbm90aWZpY2F0aW9uLCB0aGF0IGNhbiBiZSBjbG9zZWQgd2l0aCBhbiBvcHRpb25hbCB0aW1lclxuICAgKiAoZGVmYXVsdCA1MDAwbXMgdGltZXIpIGFuZCBhbHdheXMgY2xvc2VzIG9uIGNsaWNrLlxuICAgKlxuICAgKiBJZiBhIG5vdGlmaWNhdGlvbiBpcyBvcGVuZWQgd2hpbGUgYW5vdGhlciBpcyBvcGVuZWQsIGl0IHdpbGwgY2xvc2UgdGhlXG4gICAqIGN1cnJlbnRseSBvcGVuZWQgb25lIGFuZCBvcGVuIHRoZSBuZXcgb25lIGltbWVkaWF0ZWx5LlxuICAgKi9cbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24oXCJvcGVuTm90aWZpY2F0aW9uXCIsIGZ1bmN0aW9uKHRlbXBsYXRlLCBvcHRpb25zKSB7XG4gICAgY2xvc2VOb3RpZmljYXRpb24odGhpcywgY2xvc2UpO1xuICAgIHZhciBkaWFsb2cgPSBkaWFsb2dEaXYodGhpcywgdGVtcGxhdGUsIG9wdGlvbnMgJiYgb3B0aW9ucy5ib3R0b20pO1xuICAgIHZhciBjbG9zZWQgPSBmYWxzZSwgZG9uZVRpbWVyO1xuICAgIHZhciBkdXJhdGlvbiA9IG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMuZHVyYXRpb24gIT09IFwidW5kZWZpbmVkXCIgPyBvcHRpb25zLmR1cmF0aW9uIDogNTAwMDtcblxuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgaWYgKGNsb3NlZCkgcmV0dXJuO1xuICAgICAgY2xvc2VkID0gdHJ1ZTtcbiAgICAgIGNsZWFyVGltZW91dChkb25lVGltZXIpO1xuICAgICAgZGlhbG9nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGlhbG9nKTtcbiAgICB9XG5cbiAgICBDb2RlTWlycm9yLm9uKGRpYWxvZywgJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgQ29kZU1pcnJvci5lX3ByZXZlbnREZWZhdWx0KGUpO1xuICAgICAgY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIGlmIChkdXJhdGlvbilcbiAgICAgIGRvbmVUaW1lciA9IHNldFRpbWVvdXQoY2xvc2UsIGR1cmF0aW9uKTtcblxuICAgIHJldHVybiBjbG9zZTtcbiAgfSk7XG59KTtcbiIsIi8vIENvZGVNaXJyb3IsIGNvcHlyaWdodCAoYykgYnkgTWFyaWpuIEhhdmVyYmVrZSBhbmQgb3RoZXJzXG4vLyBEaXN0cmlidXRlZCB1bmRlciBhbiBNSVQgbGljZW5zZTogaHR0cDovL2NvZGVtaXJyb3IubmV0L0xJQ0VOU0VcblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24oXCJhZGRQYW5lbFwiLCBmdW5jdGlvbihub2RlLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICBpZiAoIXRoaXMuc3RhdGUucGFuZWxzKSBpbml0UGFuZWxzKHRoaXMpO1xuXG4gICAgdmFyIGluZm8gPSB0aGlzLnN0YXRlLnBhbmVscztcbiAgICB2YXIgd3JhcHBlciA9IGluZm8ud3JhcHBlcjtcbiAgICB2YXIgY21XcmFwcGVyID0gdGhpcy5nZXRXcmFwcGVyRWxlbWVudCgpO1xuXG4gICAgaWYgKG9wdGlvbnMuYWZ0ZXIgaW5zdGFuY2VvZiBQYW5lbCAmJiAhb3B0aW9ucy5hZnRlci5jbGVhcmVkKSB7XG4gICAgICB3cmFwcGVyLmluc2VydEJlZm9yZShub2RlLCBvcHRpb25zLmJlZm9yZS5ub2RlLm5leHRTaWJsaW5nKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuYmVmb3JlIGluc3RhbmNlb2YgUGFuZWwgJiYgIW9wdGlvbnMuYmVmb3JlLmNsZWFyZWQpIHtcbiAgICAgIHdyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vZGUsIG9wdGlvbnMuYmVmb3JlLm5vZGUpO1xuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5yZXBsYWNlIGluc3RhbmNlb2YgUGFuZWwgJiYgIW9wdGlvbnMucmVwbGFjZS5jbGVhcmVkKSB7XG4gICAgICB3cmFwcGVyLmluc2VydEJlZm9yZShub2RlLCBvcHRpb25zLnJlcGxhY2Uubm9kZSk7XG4gICAgICBvcHRpb25zLnJlcGxhY2UuY2xlYXIoKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMucG9zaXRpb24gPT0gXCJib3R0b21cIikge1xuICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChub2RlKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMucG9zaXRpb24gPT0gXCJiZWZvcmUtYm90dG9tXCIpIHtcbiAgICAgIHdyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vZGUsIGNtV3JhcHBlci5uZXh0U2libGluZyk7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLnBvc2l0aW9uID09IFwiYWZ0ZXItdG9wXCIpIHtcbiAgICAgIHdyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vZGUsIGNtV3JhcHBlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vZGUsIHdyYXBwZXIuZmlyc3RDaGlsZCk7XG4gICAgfVxuXG4gICAgdmFyIGhlaWdodCA9IChvcHRpb25zICYmIG9wdGlvbnMuaGVpZ2h0KSB8fCBub2RlLm9mZnNldEhlaWdodDtcbiAgICB0aGlzLl9zZXRTaXplKG51bGwsIGluZm8uaGVpZ2h0TGVmdCAtPSBoZWlnaHQpO1xuICAgIGluZm8ucGFuZWxzKys7XG4gICAgcmV0dXJuIG5ldyBQYW5lbCh0aGlzLCBub2RlLCBvcHRpb25zLCBoZWlnaHQpO1xuICB9KTtcblxuICBmdW5jdGlvbiBQYW5lbChjbSwgbm9kZSwgb3B0aW9ucywgaGVpZ2h0KSB7XG4gICAgdGhpcy5jbSA9IGNtO1xuICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB0aGlzLmNsZWFyZWQgPSBmYWxzZTtcbiAgfVxuXG4gIFBhbmVsLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmNsZWFyZWQpIHJldHVybjtcbiAgICB0aGlzLmNsZWFyZWQgPSB0cnVlO1xuICAgIHZhciBpbmZvID0gdGhpcy5jbS5zdGF0ZS5wYW5lbHM7XG4gICAgdGhpcy5jbS5fc2V0U2l6ZShudWxsLCBpbmZvLmhlaWdodExlZnQgKz0gdGhpcy5oZWlnaHQpO1xuICAgIGluZm8ud3JhcHBlci5yZW1vdmVDaGlsZCh0aGlzLm5vZGUpO1xuICAgIGlmICgtLWluZm8ucGFuZWxzID09IDApIHJlbW92ZVBhbmVscyh0aGlzLmNtKTtcbiAgfTtcblxuICBQYW5lbC5wcm90b3R5cGUuY2hhbmdlZCA9IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgIHZhciBuZXdIZWlnaHQgPSBoZWlnaHQgPT0gbnVsbCA/IHRoaXMubm9kZS5vZmZzZXRIZWlnaHQgOiBoZWlnaHQ7XG4gICAgdmFyIGluZm8gPSB0aGlzLmNtLnN0YXRlLnBhbmVscztcbiAgICB0aGlzLmNtLl9zZXRTaXplKG51bGwsIGluZm8uaGVpZ2h0ICs9IChuZXdIZWlnaHQgLSB0aGlzLmhlaWdodCkpO1xuICAgIHRoaXMuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuICB9O1xuXG4gIGZ1bmN0aW9uIGluaXRQYW5lbHMoY20pIHtcbiAgICB2YXIgd3JhcCA9IGNtLmdldFdyYXBwZXJFbGVtZW50KCk7XG4gICAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUgPyB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh3cmFwKSA6IHdyYXAuY3VycmVudFN0eWxlO1xuICAgIHZhciBoZWlnaHQgPSBwYXJzZUludChzdHlsZS5oZWlnaHQpO1xuICAgIHZhciBpbmZvID0gY20uc3RhdGUucGFuZWxzID0ge1xuICAgICAgc2V0SGVpZ2h0OiB3cmFwLnN0eWxlLmhlaWdodCxcbiAgICAgIGhlaWdodExlZnQ6IGhlaWdodCxcbiAgICAgIHBhbmVsczogMCxcbiAgICAgIHdyYXBwZXI6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICB9O1xuICAgIHdyYXAucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoaW5mby53cmFwcGVyLCB3cmFwKTtcbiAgICB2YXIgaGFzRm9jdXMgPSBjbS5oYXNGb2N1cygpO1xuICAgIGluZm8ud3JhcHBlci5hcHBlbmRDaGlsZCh3cmFwKTtcbiAgICBpZiAoaGFzRm9jdXMpIGNtLmZvY3VzKCk7XG5cbiAgICBjbS5fc2V0U2l6ZSA9IGNtLnNldFNpemU7XG4gICAgaWYgKGhlaWdodCAhPSBudWxsKSBjbS5zZXRTaXplID0gZnVuY3Rpb24od2lkdGgsIG5ld0hlaWdodCkge1xuICAgICAgaWYgKG5ld0hlaWdodCA9PSBudWxsKSByZXR1cm4gdGhpcy5fc2V0U2l6ZSh3aWR0aCwgbmV3SGVpZ2h0KTtcbiAgICAgIGluZm8uc2V0SGVpZ2h0ID0gbmV3SGVpZ2h0O1xuICAgICAgaWYgKHR5cGVvZiBuZXdIZWlnaHQgIT0gXCJudW1iZXJcIikge1xuICAgICAgICB2YXIgcHggPSAvXihcXGQrXFwuP1xcZCopcHgkLy5leGVjKG5ld0hlaWdodCk7XG4gICAgICAgIGlmIChweCkge1xuICAgICAgICAgIG5ld0hlaWdodCA9IE51bWJlcihweFsxXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5mby53cmFwcGVyLnN0eWxlLmhlaWdodCA9IG5ld0hlaWdodDtcbiAgICAgICAgICBuZXdIZWlnaHQgPSBpbmZvLndyYXBwZXIub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgIGluZm8ud3JhcHBlci5zdHlsZS5oZWlnaHQgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjbS5fc2V0U2l6ZSh3aWR0aCwgaW5mby5oZWlnaHRMZWZ0ICs9IChuZXdIZWlnaHQgLSBoZWlnaHQpKTtcbiAgICAgIGhlaWdodCA9IG5ld0hlaWdodDtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlUGFuZWxzKGNtKSB7XG4gICAgdmFyIGluZm8gPSBjbS5zdGF0ZS5wYW5lbHM7XG4gICAgY20uc3RhdGUucGFuZWxzID0gbnVsbDtcblxuICAgIHZhciB3cmFwID0gY20uZ2V0V3JhcHBlckVsZW1lbnQoKTtcbiAgICBpbmZvLndyYXBwZXIucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQod3JhcCwgaW5mby53cmFwcGVyKTtcbiAgICB3cmFwLnN0eWxlLmhlaWdodCA9IGluZm8uc2V0SGVpZ2h0O1xuICAgIGNtLnNldFNpemUgPSBjbS5fc2V0U2l6ZTtcbiAgICBjbS5zZXRTaXplKCk7XG4gIH1cbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCJdLCBtb2QpO1xuICBlbHNlIC8vIFBsYWluIGJyb3dzZXIgZW52XG4gICAgbW9kKENvZGVNaXJyb3IpO1xufSkoZnVuY3Rpb24oQ29kZU1pcnJvcikge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICBDb2RlTWlycm9yLmRlZmluZU9wdGlvbihcInJ1bGVyc1wiLCBmYWxzZSwgZnVuY3Rpb24oY20sIHZhbCwgb2xkKSB7XG4gICAgaWYgKG9sZCAmJiBvbGQgIT0gQ29kZU1pcnJvci5Jbml0KSB7XG4gICAgICBjbGVhclJ1bGVycyhjbSk7XG4gICAgICBjbS5vZmYoXCJyZWZyZXNoXCIsIHJlZnJlc2hSdWxlcnMpO1xuICAgIH1cbiAgICBpZiAodmFsICYmIHZhbC5sZW5ndGgpIHtcbiAgICAgIHNldFJ1bGVycyhjbSk7XG4gICAgICBjbS5vbihcInJlZnJlc2hcIiwgcmVmcmVzaFJ1bGVycyk7XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiBjbGVhclJ1bGVycyhjbSkge1xuICAgIGZvciAodmFyIGkgPSBjbS5kaXNwbGF5LmxpbmVTcGFjZS5jaGlsZE5vZGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgbm9kZSA9IGNtLmRpc3BsYXkubGluZVNwYWNlLmNoaWxkTm9kZXNbaV07XG4gICAgICBpZiAoLyhefFxccylDb2RlTWlycm9yLXJ1bGVyKCR8XFxzKS8udGVzdChub2RlLmNsYXNzTmFtZSkpXG4gICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZXRSdWxlcnMoY20pIHtcbiAgICB2YXIgdmFsID0gY20uZ2V0T3B0aW9uKFwicnVsZXJzXCIpO1xuICAgIHZhciBjdyA9IGNtLmRlZmF1bHRDaGFyV2lkdGgoKTtcbiAgICB2YXIgbGVmdCA9IGNtLmNoYXJDb29yZHMoQ29kZU1pcnJvci5Qb3MoY20uZmlyc3RMaW5lKCksIDApLCBcImRpdlwiKS5sZWZ0O1xuICAgIHZhciBtaW5IID0gY20uZGlzcGxheS5zY3JvbGxlci5vZmZzZXRIZWlnaHQgKyAzMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGVsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBlbHQuY2xhc3NOYW1lID0gXCJDb2RlTWlycm9yLXJ1bGVyXCI7XG4gICAgICB2YXIgY29sLCBjb25mID0gdmFsW2ldO1xuICAgICAgaWYgKHR5cGVvZiBjb25mID09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgY29sID0gY29uZjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbCA9IGNvbmYuY29sdW1uO1xuICAgICAgICBpZiAoY29uZi5jbGFzc05hbWUpIGVsdC5jbGFzc05hbWUgKz0gXCIgXCIgKyBjb25mLmNsYXNzTmFtZTtcbiAgICAgICAgaWYgKGNvbmYuY29sb3IpIGVsdC5zdHlsZS5ib3JkZXJDb2xvciA9IGNvbmYuY29sb3I7XG4gICAgICAgIGlmIChjb25mLmxpbmVTdHlsZSkgZWx0LnN0eWxlLmJvcmRlckxlZnRTdHlsZSA9IGNvbmYubGluZVN0eWxlO1xuICAgICAgICBpZiAoY29uZi53aWR0aCkgZWx0LnN0eWxlLmJvcmRlckxlZnRXaWR0aCA9IGNvbmYud2lkdGg7XG4gICAgICB9XG4gICAgICBlbHQuc3R5bGUubGVmdCA9IChsZWZ0ICsgY29sICogY3cpICsgXCJweFwiO1xuICAgICAgZWx0LnN0eWxlLnRvcCA9IFwiLTUwcHhcIjtcbiAgICAgIGVsdC5zdHlsZS5ib3R0b20gPSBcIi0yMHB4XCI7XG4gICAgICBlbHQuc3R5bGUubWluSGVpZ2h0ID0gbWluSCArIFwicHhcIjtcbiAgICAgIGNtLmRpc3BsYXkubGluZVNwYWNlLmluc2VydEJlZm9yZShlbHQsIGNtLmRpc3BsYXkuY3Vyc29yRGl2KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZWZyZXNoUnVsZXJzKGNtKSB7XG4gICAgY2xlYXJSdWxlcnMoY20pO1xuICAgIHNldFJ1bGVycyhjbSk7XG4gIH1cbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCJdLCBtb2QpO1xuICBlbHNlIC8vIFBsYWluIGJyb3dzZXIgZW52XG4gICAgbW9kKENvZGVNaXJyb3IpO1xufSkoZnVuY3Rpb24oQ29kZU1pcnJvcikge1xuICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgcGFpcnM6IFwiKClbXXt9JydcXFwiXFxcIlwiLFxuICAgIHRyaXBsZXM6IFwiXCIsXG4gICAgZXhwbG9kZTogXCJbXXt9XCJcbiAgfTtcblxuICB2YXIgUG9zID0gQ29kZU1pcnJvci5Qb3M7XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVPcHRpb24oXCJhdXRvQ2xvc2VCcmFja2V0c1wiLCBmYWxzZSwgZnVuY3Rpb24oY20sIHZhbCwgb2xkKSB7XG4gICAgaWYgKG9sZCAmJiBvbGQgIT0gQ29kZU1pcnJvci5Jbml0KSB7XG4gICAgICBjbS5yZW1vdmVLZXlNYXAoa2V5TWFwKTtcbiAgICAgIGNtLnN0YXRlLmNsb3NlQnJhY2tldHMgPSBudWxsO1xuICAgIH1cbiAgICBpZiAodmFsKSB7XG4gICAgICBjbS5zdGF0ZS5jbG9zZUJyYWNrZXRzID0gdmFsO1xuICAgICAgY20uYWRkS2V5TWFwKGtleU1hcCk7XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiBnZXRPcHRpb24oY29uZiwgbmFtZSkge1xuICAgIGlmIChuYW1lID09IFwicGFpcnNcIiAmJiB0eXBlb2YgY29uZiA9PSBcInN0cmluZ1wiKSByZXR1cm4gY29uZjtcbiAgICBpZiAodHlwZW9mIGNvbmYgPT0gXCJvYmplY3RcIiAmJiBjb25mW25hbWVdICE9IG51bGwpIHJldHVybiBjb25mW25hbWVdO1xuICAgIHJldHVybiBkZWZhdWx0c1tuYW1lXTtcbiAgfVxuXG4gIHZhciBiaW5kID0gZGVmYXVsdHMucGFpcnMgKyBcImBcIjtcbiAgdmFyIGtleU1hcCA9IHtCYWNrc3BhY2U6IGhhbmRsZUJhY2tzcGFjZSwgRW50ZXI6IGhhbmRsZUVudGVyfTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaW5kLmxlbmd0aDsgaSsrKVxuICAgIGtleU1hcFtcIidcIiArIGJpbmQuY2hhckF0KGkpICsgXCInXCJdID0gaGFuZGxlcihiaW5kLmNoYXJBdChpKSk7XG5cbiAgZnVuY3Rpb24gaGFuZGxlcihjaCkge1xuICAgIHJldHVybiBmdW5jdGlvbihjbSkgeyByZXR1cm4gaGFuZGxlQ2hhcihjbSwgY2gpOyB9O1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29uZmlnKGNtKSB7XG4gICAgdmFyIGRlZmx0ID0gY20uc3RhdGUuY2xvc2VCcmFja2V0cztcbiAgICBpZiAoIWRlZmx0KSByZXR1cm4gbnVsbDtcbiAgICB2YXIgbW9kZSA9IGNtLmdldE1vZGVBdChjbS5nZXRDdXJzb3IoKSk7XG4gICAgcmV0dXJuIG1vZGUuY2xvc2VCcmFja2V0cyB8fCBkZWZsdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUJhY2tzcGFjZShjbSkge1xuICAgIHZhciBjb25mID0gZ2V0Q29uZmlnKGNtKTtcbiAgICBpZiAoIWNvbmYgfHwgY20uZ2V0T3B0aW9uKFwiZGlzYWJsZUlucHV0XCIpKSByZXR1cm4gQ29kZU1pcnJvci5QYXNzO1xuXG4gICAgdmFyIHBhaXJzID0gZ2V0T3B0aW9uKGNvbmYsIFwicGFpcnNcIik7XG4gICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghcmFuZ2VzW2ldLmVtcHR5KCkpIHJldHVybiBDb2RlTWlycm9yLlBhc3M7XG4gICAgICB2YXIgYXJvdW5kID0gY2hhcnNBcm91bmQoY20sIHJhbmdlc1tpXS5oZWFkKTtcbiAgICAgIGlmICghYXJvdW5kIHx8IHBhaXJzLmluZGV4T2YoYXJvdW5kKSAlIDIgIT0gMCkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IHJhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGN1ciA9IHJhbmdlc1tpXS5oZWFkO1xuICAgICAgY20ucmVwbGFjZVJhbmdlKFwiXCIsIFBvcyhjdXIubGluZSwgY3VyLmNoIC0gMSksIFBvcyhjdXIubGluZSwgY3VyLmNoICsgMSkpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGhhbmRsZUVudGVyKGNtKSB7XG4gICAgdmFyIGNvbmYgPSBnZXRDb25maWcoY20pO1xuICAgIHZhciBleHBsb2RlID0gY29uZiAmJiBnZXRPcHRpb24oY29uZiwgXCJleHBsb2RlXCIpO1xuICAgIGlmICghZXhwbG9kZSB8fCBjbS5nZXRPcHRpb24oXCJkaXNhYmxlSW5wdXRcIikpIHJldHVybiBDb2RlTWlycm9yLlBhc3M7XG5cbiAgICB2YXIgcmFuZ2VzID0gY20ubGlzdFNlbGVjdGlvbnMoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCFyYW5nZXNbaV0uZW1wdHkoKSkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgICAgIHZhciBhcm91bmQgPSBjaGFyc0Fyb3VuZChjbSwgcmFuZ2VzW2ldLmhlYWQpO1xuICAgICAgaWYgKCFhcm91bmQgfHwgZXhwbG9kZS5pbmRleE9mKGFyb3VuZCkgJSAyICE9IDApIHJldHVybiBDb2RlTWlycm9yLlBhc3M7XG4gICAgfVxuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIGNtLnJlcGxhY2VTZWxlY3Rpb24oXCJcXG5cXG5cIiwgbnVsbCk7XG4gICAgICBjbS5leGVjQ29tbWFuZChcImdvQ2hhckxlZnRcIik7XG4gICAgICByYW5nZXMgPSBjbS5saXN0U2VsZWN0aW9ucygpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGxpbmUgPSByYW5nZXNbaV0uaGVhZC5saW5lO1xuICAgICAgICBjbS5pbmRlbnRMaW5lKGxpbmUsIG51bGwsIHRydWUpO1xuICAgICAgICBjbS5pbmRlbnRMaW5lKGxpbmUgKyAxLCBudWxsLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbnRyYWN0U2VsZWN0aW9uKHNlbCkge1xuICAgIHZhciBpbnZlcnRlZCA9IENvZGVNaXJyb3IuY21wUG9zKHNlbC5hbmNob3IsIHNlbC5oZWFkKSA+IDA7XG4gICAgcmV0dXJuIHthbmNob3I6IG5ldyBQb3Moc2VsLmFuY2hvci5saW5lLCBzZWwuYW5jaG9yLmNoICsgKGludmVydGVkID8gLTEgOiAxKSksXG4gICAgICAgICAgICBoZWFkOiBuZXcgUG9zKHNlbC5oZWFkLmxpbmUsIHNlbC5oZWFkLmNoICsgKGludmVydGVkID8gMSA6IC0xKSl9O1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ2hhcihjbSwgY2gpIHtcbiAgICB2YXIgY29uZiA9IGdldENvbmZpZyhjbSk7XG4gICAgaWYgKCFjb25mIHx8IGNtLmdldE9wdGlvbihcImRpc2FibGVJbnB1dFwiKSkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcblxuICAgIHZhciBwYWlycyA9IGdldE9wdGlvbihjb25mLCBcInBhaXJzXCIpO1xuICAgIHZhciBwb3MgPSBwYWlycy5pbmRleE9mKGNoKTtcbiAgICBpZiAocG9zID09IC0xKSByZXR1cm4gQ29kZU1pcnJvci5QYXNzO1xuICAgIHZhciB0cmlwbGVzID0gZ2V0T3B0aW9uKGNvbmYsIFwidHJpcGxlc1wiKTtcblxuICAgIHZhciBpZGVudGljYWwgPSBwYWlycy5jaGFyQXQocG9zICsgMSkgPT0gY2g7XG4gICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCk7XG4gICAgdmFyIG9wZW5pbmcgPSBwb3MgJSAyID09IDA7XG5cbiAgICB2YXIgdHlwZSwgbmV4dDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHJhbmdlID0gcmFuZ2VzW2ldLCBjdXIgPSByYW5nZS5oZWFkLCBjdXJUeXBlO1xuICAgICAgdmFyIG5leHQgPSBjbS5nZXRSYW5nZShjdXIsIFBvcyhjdXIubGluZSwgY3VyLmNoICsgMSkpO1xuICAgICAgaWYgKG9wZW5pbmcgJiYgIXJhbmdlLmVtcHR5KCkpIHtcbiAgICAgICAgY3VyVHlwZSA9IFwic3Vycm91bmRcIjtcbiAgICAgIH0gZWxzZSBpZiAoKGlkZW50aWNhbCB8fCAhb3BlbmluZykgJiYgbmV4dCA9PSBjaCkge1xuICAgICAgICBpZiAodHJpcGxlcy5pbmRleE9mKGNoKSA+PSAwICYmIGNtLmdldFJhbmdlKGN1ciwgUG9zKGN1ci5saW5lLCBjdXIuY2ggKyAzKSkgPT0gY2ggKyBjaCArIGNoKVxuICAgICAgICAgIGN1clR5cGUgPSBcInNraXBUaHJlZVwiO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgY3VyVHlwZSA9IFwic2tpcFwiO1xuICAgICAgfSBlbHNlIGlmIChpZGVudGljYWwgJiYgY3VyLmNoID4gMSAmJiB0cmlwbGVzLmluZGV4T2YoY2gpID49IDAgJiZcbiAgICAgICAgICAgICAgICAgY20uZ2V0UmFuZ2UoUG9zKGN1ci5saW5lLCBjdXIuY2ggLSAyKSwgY3VyKSA9PSBjaCArIGNoICYmXG4gICAgICAgICAgICAgICAgIChjdXIuY2ggPD0gMiB8fCBjbS5nZXRSYW5nZShQb3MoY3VyLmxpbmUsIGN1ci5jaCAtIDMpLCBQb3MoY3VyLmxpbmUsIGN1ci5jaCAtIDIpKSAhPSBjaCkpIHtcbiAgICAgICAgY3VyVHlwZSA9IFwiYWRkRm91clwiO1xuICAgICAgfSBlbHNlIGlmIChpZGVudGljYWwpIHtcbiAgICAgICAgaWYgKCFDb2RlTWlycm9yLmlzV29yZENoYXIobmV4dCkgJiYgZW50ZXJpbmdTdHJpbmcoY20sIGN1ciwgY2gpKSBjdXJUeXBlID0gXCJib3RoXCI7XG4gICAgICAgIGVsc2UgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgICAgIH0gZWxzZSBpZiAob3BlbmluZyAmJiAoY20uZ2V0TGluZShjdXIubGluZSkubGVuZ3RoID09IGN1ci5jaCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0Nsb3NpbmdCcmFja2V0KG5leHQsIHBhaXJzKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXFxzLy50ZXN0KG5leHQpKSkge1xuICAgICAgICBjdXJUeXBlID0gXCJib3RoXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gQ29kZU1pcnJvci5QYXNzO1xuICAgICAgfVxuICAgICAgaWYgKCF0eXBlKSB0eXBlID0gY3VyVHlwZTtcbiAgICAgIGVsc2UgaWYgKHR5cGUgIT0gY3VyVHlwZSkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgICB9XG5cbiAgICB2YXIgbGVmdCA9IHBvcyAlIDIgPyBwYWlycy5jaGFyQXQocG9zIC0gMSkgOiBjaDtcbiAgICB2YXIgcmlnaHQgPSBwb3MgJSAyID8gY2ggOiBwYWlycy5jaGFyQXQocG9zICsgMSk7XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHR5cGUgPT0gXCJza2lwXCIpIHtcbiAgICAgICAgY20uZXhlY0NvbW1hbmQoXCJnb0NoYXJSaWdodFwiKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBcInNraXBUaHJlZVwiKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKVxuICAgICAgICAgIGNtLmV4ZWNDb21tYW5kKFwiZ29DaGFyUmlnaHRcIik7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJzdXJyb3VuZFwiKSB7XG4gICAgICAgIHZhciBzZWxzID0gY20uZ2V0U2VsZWN0aW9ucygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgc2Vsc1tpXSA9IGxlZnQgKyBzZWxzW2ldICsgcmlnaHQ7XG4gICAgICAgIGNtLnJlcGxhY2VTZWxlY3Rpb25zKHNlbHMsIFwiYXJvdW5kXCIpO1xuICAgICAgICBzZWxzID0gY20ubGlzdFNlbGVjdGlvbnMoKS5zbGljZSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgc2Vsc1tpXSA9IGNvbnRyYWN0U2VsZWN0aW9uKHNlbHNbaV0pO1xuICAgICAgICBjbS5zZXRTZWxlY3Rpb25zKHNlbHMpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09IFwiYm90aFwiKSB7XG4gICAgICAgIGNtLnJlcGxhY2VTZWxlY3Rpb24obGVmdCArIHJpZ2h0LCBudWxsKTtcbiAgICAgICAgY20udHJpZ2dlckVsZWN0cmljKGxlZnQgKyByaWdodCk7XG4gICAgICAgIGNtLmV4ZWNDb21tYW5kKFwiZ29DaGFyTGVmdFwiKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBcImFkZEZvdXJcIikge1xuICAgICAgICBjbS5yZXBsYWNlU2VsZWN0aW9uKGxlZnQgKyBsZWZ0ICsgbGVmdCArIGxlZnQsIFwiYmVmb3JlXCIpO1xuICAgICAgICBjbS5leGVjQ29tbWFuZChcImdvQ2hhclJpZ2h0XCIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNDbG9zaW5nQnJhY2tldChjaCwgcGFpcnMpIHtcbiAgICB2YXIgcG9zID0gcGFpcnMubGFzdEluZGV4T2YoY2gpO1xuICAgIHJldHVybiBwb3MgPiAtMSAmJiBwb3MgJSAyID09IDE7XG4gIH1cblxuICBmdW5jdGlvbiBjaGFyc0Fyb3VuZChjbSwgcG9zKSB7XG4gICAgdmFyIHN0ciA9IGNtLmdldFJhbmdlKFBvcyhwb3MubGluZSwgcG9zLmNoIC0gMSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFBvcyhwb3MubGluZSwgcG9zLmNoICsgMSkpO1xuICAgIHJldHVybiBzdHIubGVuZ3RoID09IDIgPyBzdHIgOiBudWxsO1xuICB9XG5cbiAgLy8gUHJvamVjdCB0aGUgdG9rZW4gdHlwZSB0aGF0IHdpbGwgZXhpc3RzIGFmdGVyIHRoZSBnaXZlbiBjaGFyIGlzXG4gIC8vIHR5cGVkLCBhbmQgdXNlIGl0IHRvIGRldGVybWluZSB3aGV0aGVyIGl0IHdvdWxkIGNhdXNlIHRoZSBzdGFydFxuICAvLyBvZiBhIHN0cmluZyB0b2tlbi5cbiAgZnVuY3Rpb24gZW50ZXJpbmdTdHJpbmcoY20sIHBvcywgY2gpIHtcbiAgICB2YXIgbGluZSA9IGNtLmdldExpbmUocG9zLmxpbmUpO1xuICAgIHZhciB0b2tlbiA9IGNtLmdldFRva2VuQXQocG9zKTtcbiAgICBpZiAoL1xcYnN0cmluZzI/XFxiLy50ZXN0KHRva2VuLnR5cGUpKSByZXR1cm4gZmFsc2U7XG4gICAgdmFyIHN0cmVhbSA9IG5ldyBDb2RlTWlycm9yLlN0cmluZ1N0cmVhbShsaW5lLnNsaWNlKDAsIHBvcy5jaCkgKyBjaCArIGxpbmUuc2xpY2UocG9zLmNoKSwgNCk7XG4gICAgc3RyZWFtLnBvcyA9IHN0cmVhbS5zdGFydCA9IHRva2VuLnN0YXJ0O1xuICAgIGZvciAoOzspIHtcbiAgICAgIHZhciB0eXBlMSA9IGNtLmdldE1vZGUoKS50b2tlbihzdHJlYW0sIHRva2VuLnN0YXRlKTtcbiAgICAgIGlmIChzdHJlYW0ucG9zID49IHBvcy5jaCArIDEpIHJldHVybiAvXFxic3RyaW5nMj9cXGIvLnRlc3QodHlwZTEpO1xuICAgICAgc3RyZWFtLnN0YXJ0ID0gc3RyZWFtLnBvcztcbiAgICB9XG4gIH1cbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCJdLCBtb2QpO1xuICBlbHNlIC8vIFBsYWluIGJyb3dzZXIgZW52XG4gICAgbW9kKENvZGVNaXJyb3IpO1xufSkoZnVuY3Rpb24oQ29kZU1pcnJvcikge1xuICB2YXIgaWVfbHQ4ID0gL01TSUUgXFxkLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmXG4gICAgKGRvY3VtZW50LmRvY3VtZW50TW9kZSA9PSBudWxsIHx8IGRvY3VtZW50LmRvY3VtZW50TW9kZSA8IDgpO1xuXG4gIHZhciBQb3MgPSBDb2RlTWlycm9yLlBvcztcblxuICB2YXIgbWF0Y2hpbmcgPSB7XCIoXCI6IFwiKT5cIiwgXCIpXCI6IFwiKDxcIiwgXCJbXCI6IFwiXT5cIiwgXCJdXCI6IFwiWzxcIiwgXCJ7XCI6IFwifT5cIiwgXCJ9XCI6IFwiezxcIn07XG5cbiAgZnVuY3Rpb24gZmluZE1hdGNoaW5nQnJhY2tldChjbSwgd2hlcmUsIHN0cmljdCwgY29uZmlnKSB7XG4gICAgdmFyIGxpbmUgPSBjbS5nZXRMaW5lSGFuZGxlKHdoZXJlLmxpbmUpLCBwb3MgPSB3aGVyZS5jaCAtIDE7XG4gICAgdmFyIG1hdGNoID0gKHBvcyA+PSAwICYmIG1hdGNoaW5nW2xpbmUudGV4dC5jaGFyQXQocG9zKV0pIHx8IG1hdGNoaW5nW2xpbmUudGV4dC5jaGFyQXQoKytwb3MpXTtcbiAgICBpZiAoIW1hdGNoKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgZGlyID0gbWF0Y2guY2hhckF0KDEpID09IFwiPlwiID8gMSA6IC0xO1xuICAgIGlmIChzdHJpY3QgJiYgKGRpciA+IDApICE9IChwb3MgPT0gd2hlcmUuY2gpKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgc3R5bGUgPSBjbS5nZXRUb2tlblR5cGVBdChQb3Mod2hlcmUubGluZSwgcG9zICsgMSkpO1xuXG4gICAgdmFyIGZvdW5kID0gc2NhbkZvckJyYWNrZXQoY20sIFBvcyh3aGVyZS5saW5lLCBwb3MgKyAoZGlyID4gMCA/IDEgOiAwKSksIGRpciwgc3R5bGUgfHwgbnVsbCwgY29uZmlnKTtcbiAgICBpZiAoZm91bmQgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHtmcm9tOiBQb3Mod2hlcmUubGluZSwgcG9zKSwgdG86IGZvdW5kICYmIGZvdW5kLnBvcyxcbiAgICAgICAgICAgIG1hdGNoOiBmb3VuZCAmJiBmb3VuZC5jaCA9PSBtYXRjaC5jaGFyQXQoMCksIGZvcndhcmQ6IGRpciA+IDB9O1xuICB9XG5cbiAgLy8gYnJhY2tldFJlZ2V4IGlzIHVzZWQgdG8gc3BlY2lmeSB3aGljaCB0eXBlIG9mIGJyYWNrZXQgdG8gc2NhblxuICAvLyBzaG91bGQgYmUgYSByZWdleHAsIGUuZy4gL1tbXFxdXS9cbiAgLy9cbiAgLy8gTm90ZTogSWYgXCJ3aGVyZVwiIGlzIG9uIGFuIG9wZW4gYnJhY2tldCwgdGhlbiB0aGlzIGJyYWNrZXQgaXMgaWdub3JlZC5cbiAgLy9cbiAgLy8gUmV0dXJucyBmYWxzZSB3aGVuIG5vIGJyYWNrZXQgd2FzIGZvdW5kLCBudWxsIHdoZW4gaXQgcmVhY2hlZFxuICAvLyBtYXhTY2FuTGluZXMgYW5kIGdhdmUgdXBcbiAgZnVuY3Rpb24gc2NhbkZvckJyYWNrZXQoY20sIHdoZXJlLCBkaXIsIHN0eWxlLCBjb25maWcpIHtcbiAgICB2YXIgbWF4U2NhbkxlbiA9IChjb25maWcgJiYgY29uZmlnLm1heFNjYW5MaW5lTGVuZ3RoKSB8fCAxMDAwMDtcbiAgICB2YXIgbWF4U2NhbkxpbmVzID0gKGNvbmZpZyAmJiBjb25maWcubWF4U2NhbkxpbmVzKSB8fCAxMDAwO1xuXG4gICAgdmFyIHN0YWNrID0gW107XG4gICAgdmFyIHJlID0gY29uZmlnICYmIGNvbmZpZy5icmFja2V0UmVnZXggPyBjb25maWcuYnJhY2tldFJlZ2V4IDogL1soKXt9W1xcXV0vO1xuICAgIHZhciBsaW5lRW5kID0gZGlyID4gMCA/IE1hdGgubWluKHdoZXJlLmxpbmUgKyBtYXhTY2FuTGluZXMsIGNtLmxhc3RMaW5lKCkgKyAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IE1hdGgubWF4KGNtLmZpcnN0TGluZSgpIC0gMSwgd2hlcmUubGluZSAtIG1heFNjYW5MaW5lcyk7XG4gICAgZm9yICh2YXIgbGluZU5vID0gd2hlcmUubGluZTsgbGluZU5vICE9IGxpbmVFbmQ7IGxpbmVObyArPSBkaXIpIHtcbiAgICAgIHZhciBsaW5lID0gY20uZ2V0TGluZShsaW5lTm8pO1xuICAgICAgaWYgKCFsaW5lKSBjb250aW51ZTtcbiAgICAgIHZhciBwb3MgPSBkaXIgPiAwID8gMCA6IGxpbmUubGVuZ3RoIC0gMSwgZW5kID0gZGlyID4gMCA/IGxpbmUubGVuZ3RoIDogLTE7XG4gICAgICBpZiAobGluZS5sZW5ndGggPiBtYXhTY2FuTGVuKSBjb250aW51ZTtcbiAgICAgIGlmIChsaW5lTm8gPT0gd2hlcmUubGluZSkgcG9zID0gd2hlcmUuY2ggLSAoZGlyIDwgMCA/IDEgOiAwKTtcbiAgICAgIGZvciAoOyBwb3MgIT0gZW5kOyBwb3MgKz0gZGlyKSB7XG4gICAgICAgIHZhciBjaCA9IGxpbmUuY2hhckF0KHBvcyk7XG4gICAgICAgIGlmIChyZS50ZXN0KGNoKSAmJiAoc3R5bGUgPT09IHVuZGVmaW5lZCB8fCBjbS5nZXRUb2tlblR5cGVBdChQb3MobGluZU5vLCBwb3MgKyAxKSkgPT0gc3R5bGUpKSB7XG4gICAgICAgICAgdmFyIG1hdGNoID0gbWF0Y2hpbmdbY2hdO1xuICAgICAgICAgIGlmICgobWF0Y2guY2hhckF0KDEpID09IFwiPlwiKSA9PSAoZGlyID4gMCkpIHN0YWNrLnB1c2goY2gpO1xuICAgICAgICAgIGVsc2UgaWYgKCFzdGFjay5sZW5ndGgpIHJldHVybiB7cG9zOiBQb3MobGluZU5vLCBwb3MpLCBjaDogY2h9O1xuICAgICAgICAgIGVsc2Ugc3RhY2sucG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxpbmVObyAtIGRpciA9PSAoZGlyID4gMCA/IGNtLmxhc3RMaW5lKCkgOiBjbS5maXJzdExpbmUoKSkgPyBmYWxzZSA6IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBtYXRjaEJyYWNrZXRzKGNtLCBhdXRvY2xlYXIsIGNvbmZpZykge1xuICAgIC8vIERpc2FibGUgYnJhY2UgbWF0Y2hpbmcgaW4gbG9uZyBsaW5lcywgc2luY2UgaXQnbGwgY2F1c2UgaHVnZWx5IHNsb3cgdXBkYXRlc1xuICAgIHZhciBtYXhIaWdobGlnaHRMZW4gPSBjbS5zdGF0ZS5tYXRjaEJyYWNrZXRzLm1heEhpZ2hsaWdodExpbmVMZW5ndGggfHwgMTAwMDtcbiAgICB2YXIgbWFya3MgPSBbXSwgcmFuZ2VzID0gY20ubGlzdFNlbGVjdGlvbnMoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG1hdGNoID0gcmFuZ2VzW2ldLmVtcHR5KCkgJiYgZmluZE1hdGNoaW5nQnJhY2tldChjbSwgcmFuZ2VzW2ldLmhlYWQsIGZhbHNlLCBjb25maWcpO1xuICAgICAgaWYgKG1hdGNoICYmIGNtLmdldExpbmUobWF0Y2guZnJvbS5saW5lKS5sZW5ndGggPD0gbWF4SGlnaGxpZ2h0TGVuKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IG1hdGNoLm1hdGNoID8gXCJDb2RlTWlycm9yLW1hdGNoaW5nYnJhY2tldFwiIDogXCJDb2RlTWlycm9yLW5vbm1hdGNoaW5nYnJhY2tldFwiO1xuICAgICAgICBtYXJrcy5wdXNoKGNtLm1hcmtUZXh0KG1hdGNoLmZyb20sIFBvcyhtYXRjaC5mcm9tLmxpbmUsIG1hdGNoLmZyb20uY2ggKyAxKSwge2NsYXNzTmFtZTogc3R5bGV9KSk7XG4gICAgICAgIGlmIChtYXRjaC50byAmJiBjbS5nZXRMaW5lKG1hdGNoLnRvLmxpbmUpLmxlbmd0aCA8PSBtYXhIaWdobGlnaHRMZW4pXG4gICAgICAgICAgbWFya3MucHVzaChjbS5tYXJrVGV4dChtYXRjaC50bywgUG9zKG1hdGNoLnRvLmxpbmUsIG1hdGNoLnRvLmNoICsgMSksIHtjbGFzc05hbWU6IHN0eWxlfSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChtYXJrcy5sZW5ndGgpIHtcbiAgICAgIC8vIEtsdWRnZSB0byB3b3JrIGFyb3VuZCB0aGUgSUUgYnVnIGZyb20gaXNzdWUgIzExOTMsIHdoZXJlIHRleHRcbiAgICAgIC8vIGlucHV0IHN0b3BzIGdvaW5nIHRvIHRoZSB0ZXh0YXJlIHdoZXZlciB0aGlzIGZpcmVzLlxuICAgICAgaWYgKGllX2x0OCAmJiBjbS5zdGF0ZS5mb2N1c2VkKSBjbS5mb2N1cygpO1xuXG4gICAgICB2YXIgY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFya3MubGVuZ3RoOyBpKyspIG1hcmtzW2ldLmNsZWFyKCk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIGlmIChhdXRvY2xlYXIpIHNldFRpbWVvdXQoY2xlYXIsIDgwMCk7XG4gICAgICBlbHNlIHJldHVybiBjbGVhcjtcbiAgICB9XG4gIH1cblxuICB2YXIgY3VycmVudGx5SGlnaGxpZ2h0ZWQgPSBudWxsO1xuICBmdW5jdGlvbiBkb01hdGNoQnJhY2tldHMoY20pIHtcbiAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoY3VycmVudGx5SGlnaGxpZ2h0ZWQpIHtjdXJyZW50bHlIaWdobGlnaHRlZCgpOyBjdXJyZW50bHlIaWdobGlnaHRlZCA9IG51bGw7fVxuICAgICAgY3VycmVudGx5SGlnaGxpZ2h0ZWQgPSBtYXRjaEJyYWNrZXRzKGNtLCBmYWxzZSwgY20uc3RhdGUubWF0Y2hCcmFja2V0cyk7XG4gICAgfSk7XG4gIH1cblxuICBDb2RlTWlycm9yLmRlZmluZU9wdGlvbihcIm1hdGNoQnJhY2tldHNcIiwgZmFsc2UsIGZ1bmN0aW9uKGNtLCB2YWwsIG9sZCkge1xuICAgIGlmIChvbGQgJiYgb2xkICE9IENvZGVNaXJyb3IuSW5pdClcbiAgICAgIGNtLm9mZihcImN1cnNvckFjdGl2aXR5XCIsIGRvTWF0Y2hCcmFja2V0cyk7XG4gICAgaWYgKHZhbCkge1xuICAgICAgY20uc3RhdGUubWF0Y2hCcmFja2V0cyA9IHR5cGVvZiB2YWwgPT0gXCJvYmplY3RcIiA/IHZhbCA6IHt9O1xuICAgICAgY20ub24oXCJjdXJzb3JBY3Rpdml0eVwiLCBkb01hdGNoQnJhY2tldHMpO1xuICAgIH1cbiAgfSk7XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24oXCJtYXRjaEJyYWNrZXRzXCIsIGZ1bmN0aW9uKCkge21hdGNoQnJhY2tldHModGhpcywgdHJ1ZSk7fSk7XG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwiZmluZE1hdGNoaW5nQnJhY2tldFwiLCBmdW5jdGlvbihwb3MsIHN0cmljdCwgY29uZmlnKXtcbiAgICByZXR1cm4gZmluZE1hdGNoaW5nQnJhY2tldCh0aGlzLCBwb3MsIHN0cmljdCwgY29uZmlnKTtcbiAgfSk7XG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwic2NhbkZvckJyYWNrZXRcIiwgZnVuY3Rpb24ocG9zLCBkaXIsIHN0eWxlLCBjb25maWcpe1xuICAgIHJldHVybiBzY2FuRm9yQnJhY2tldCh0aGlzLCBwb3MsIGRpciwgc3R5bGUsIGNvbmZpZyk7XG4gIH0pO1xufSk7XG4iLCIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHA6Ly9jb2RlbWlycm9yLm5ldC9MSUNFTlNFXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZChyZXF1aXJlKFwiLi4vLi4vbGliL2NvZGVtaXJyb3JcIikpO1xuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSAvLyBBTURcbiAgICBkZWZpbmUoW1wiLi4vLi4vbGliL2NvZGVtaXJyb3JcIl0sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICBtb2QoQ29kZU1pcnJvcik7XG59KShmdW5jdGlvbihDb2RlTWlycm9yKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIGZ1bmN0aW9uIGRvRm9sZChjbSwgcG9zLCBvcHRpb25zLCBmb3JjZSkge1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuY2FsbCkge1xuICAgICAgdmFyIGZpbmRlciA9IG9wdGlvbnM7XG4gICAgICBvcHRpb25zID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGZpbmRlciA9IGdldE9wdGlvbihjbSwgb3B0aW9ucywgXCJyYW5nZUZpbmRlclwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwb3MgPT0gXCJudW1iZXJcIikgcG9zID0gQ29kZU1pcnJvci5Qb3MocG9zLCAwKTtcbiAgICB2YXIgbWluU2l6ZSA9IGdldE9wdGlvbihjbSwgb3B0aW9ucywgXCJtaW5Gb2xkU2l6ZVwiKTtcblxuICAgIGZ1bmN0aW9uIGdldFJhbmdlKGFsbG93Rm9sZGVkKSB7XG4gICAgICB2YXIgcmFuZ2UgPSBmaW5kZXIoY20sIHBvcyk7XG4gICAgICBpZiAoIXJhbmdlIHx8IHJhbmdlLnRvLmxpbmUgLSByYW5nZS5mcm9tLmxpbmUgPCBtaW5TaXplKSByZXR1cm4gbnVsbDtcbiAgICAgIHZhciBtYXJrcyA9IGNtLmZpbmRNYXJrc0F0KHJhbmdlLmZyb20pO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrcy5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAobWFya3NbaV0uX19pc0ZvbGQgJiYgZm9yY2UgIT09IFwiZm9sZFwiKSB7XG4gICAgICAgICAgaWYgKCFhbGxvd0ZvbGRlZCkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgcmFuZ2UuY2xlYXJlZCA9IHRydWU7XG4gICAgICAgICAgbWFya3NbaV0uY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJhbmdlO1xuICAgIH1cblxuICAgIHZhciByYW5nZSA9IGdldFJhbmdlKHRydWUpO1xuICAgIGlmIChnZXRPcHRpb24oY20sIG9wdGlvbnMsIFwic2NhblVwXCIpKSB3aGlsZSAoIXJhbmdlICYmIHBvcy5saW5lID4gY20uZmlyc3RMaW5lKCkpIHtcbiAgICAgIHBvcyA9IENvZGVNaXJyb3IuUG9zKHBvcy5saW5lIC0gMSwgMCk7XG4gICAgICByYW5nZSA9IGdldFJhbmdlKGZhbHNlKTtcbiAgICB9XG4gICAgaWYgKCFyYW5nZSB8fCByYW5nZS5jbGVhcmVkIHx8IGZvcmNlID09PSBcInVuZm9sZFwiKSByZXR1cm47XG5cbiAgICB2YXIgbXlXaWRnZXQgPSBtYWtlV2lkZ2V0KGNtLCBvcHRpb25zKTtcbiAgICBDb2RlTWlycm9yLm9uKG15V2lkZ2V0LCBcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBteVJhbmdlLmNsZWFyKCk7XG4gICAgICBDb2RlTWlycm9yLmVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgfSk7XG4gICAgdmFyIG15UmFuZ2UgPSBjbS5tYXJrVGV4dChyYW5nZS5mcm9tLCByYW5nZS50bywge1xuICAgICAgcmVwbGFjZWRXaXRoOiBteVdpZGdldCxcbiAgICAgIGNsZWFyT25FbnRlcjogdHJ1ZSxcbiAgICAgIF9faXNGb2xkOiB0cnVlXG4gICAgfSk7XG4gICAgbXlSYW5nZS5vbihcImNsZWFyXCIsIGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgICBDb2RlTWlycm9yLnNpZ25hbChjbSwgXCJ1bmZvbGRcIiwgY20sIGZyb20sIHRvKTtcbiAgICB9KTtcbiAgICBDb2RlTWlycm9yLnNpZ25hbChjbSwgXCJmb2xkXCIsIGNtLCByYW5nZS5mcm9tLCByYW5nZS50byk7XG4gIH1cblxuICBmdW5jdGlvbiBtYWtlV2lkZ2V0KGNtLCBvcHRpb25zKSB7XG4gICAgdmFyIHdpZGdldCA9IGdldE9wdGlvbihjbSwgb3B0aW9ucywgXCJ3aWRnZXRcIik7XG4gICAgaWYgKHR5cGVvZiB3aWRnZXQgPT0gXCJzdHJpbmdcIikge1xuICAgICAgdmFyIHRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh3aWRnZXQpO1xuICAgICAgd2lkZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgICB3aWRnZXQuYXBwZW5kQ2hpbGQodGV4dCk7XG4gICAgICB3aWRnZXQuY2xhc3NOYW1lID0gXCJDb2RlTWlycm9yLWZvbGRtYXJrZXJcIjtcbiAgICB9XG4gICAgcmV0dXJuIHdpZGdldDtcbiAgfVxuXG4gIC8vIENsdW1zeSBiYWNrd2FyZHMtY29tcGF0aWJsZSBpbnRlcmZhY2VcbiAgQ29kZU1pcnJvci5uZXdGb2xkRnVuY3Rpb24gPSBmdW5jdGlvbihyYW5nZUZpbmRlciwgd2lkZ2V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGNtLCBwb3MpIHsgZG9Gb2xkKGNtLCBwb3MsIHtyYW5nZUZpbmRlcjogcmFuZ2VGaW5kZXIsIHdpZGdldDogd2lkZ2V0fSk7IH07XG4gIH07XG5cbiAgLy8gTmV3LXN0eWxlIGludGVyZmFjZVxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcImZvbGRDb2RlXCIsIGZ1bmN0aW9uKHBvcywgb3B0aW9ucywgZm9yY2UpIHtcbiAgICBkb0ZvbGQodGhpcywgcG9zLCBvcHRpb25zLCBmb3JjZSk7XG4gIH0pO1xuXG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwiaXNGb2xkZWRcIiwgZnVuY3Rpb24ocG9zKSB7XG4gICAgdmFyIG1hcmtzID0gdGhpcy5maW5kTWFya3NBdChwb3MpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFya3MubGVuZ3RoOyArK2kpXG4gICAgICBpZiAobWFya3NbaV0uX19pc0ZvbGQpIHJldHVybiB0cnVlO1xuICB9KTtcblxuICBDb2RlTWlycm9yLmNvbW1hbmRzLnRvZ2dsZUZvbGQgPSBmdW5jdGlvbihjbSkge1xuICAgIGNtLmZvbGRDb2RlKGNtLmdldEN1cnNvcigpKTtcbiAgfTtcbiAgQ29kZU1pcnJvci5jb21tYW5kcy5mb2xkID0gZnVuY3Rpb24oY20pIHtcbiAgICBjbS5mb2xkQ29kZShjbS5nZXRDdXJzb3IoKSwgbnVsbCwgXCJmb2xkXCIpO1xuICB9O1xuICBDb2RlTWlycm9yLmNvbW1hbmRzLnVuZm9sZCA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20uZm9sZENvZGUoY20uZ2V0Q3Vyc29yKCksIG51bGwsIFwidW5mb2xkXCIpO1xuICB9O1xuICBDb2RlTWlycm9yLmNvbW1hbmRzLmZvbGRBbGwgPSBmdW5jdGlvbihjbSkge1xuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIGZvciAodmFyIGkgPSBjbS5maXJzdExpbmUoKSwgZSA9IGNtLmxhc3RMaW5lKCk7IGkgPD0gZTsgaSsrKVxuICAgICAgICBjbS5mb2xkQ29kZShDb2RlTWlycm9yLlBvcyhpLCAwKSwgbnVsbCwgXCJmb2xkXCIpO1xuICAgIH0pO1xuICB9O1xuICBDb2RlTWlycm9yLmNvbW1hbmRzLnVuZm9sZEFsbCA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgaSA9IGNtLmZpcnN0TGluZSgpLCBlID0gY20ubGFzdExpbmUoKTsgaSA8PSBlOyBpKyspXG4gICAgICAgIGNtLmZvbGRDb2RlKENvZGVNaXJyb3IuUG9zKGksIDApLCBudWxsLCBcInVuZm9sZFwiKTtcbiAgICB9KTtcbiAgfTtcblxuICBDb2RlTWlycm9yLnJlZ2lzdGVySGVscGVyKFwiZm9sZFwiLCBcImNvbWJpbmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZ1bmNzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oY20sIHN0YXJ0KSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZ1bmNzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBmb3VuZCA9IGZ1bmNzW2ldKGNtLCBzdGFydCk7XG4gICAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGZvdW5kO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuXG4gIENvZGVNaXJyb3IucmVnaXN0ZXJIZWxwZXIoXCJmb2xkXCIsIFwiYXV0b1wiLCBmdW5jdGlvbihjbSwgc3RhcnQpIHtcbiAgICB2YXIgaGVscGVycyA9IGNtLmdldEhlbHBlcnMoc3RhcnQsIFwiZm9sZFwiKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlbHBlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjdXIgPSBoZWxwZXJzW2ldKGNtLCBzdGFydCk7XG4gICAgICBpZiAoY3VyKSByZXR1cm4gY3VyO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgIHJhbmdlRmluZGVyOiBDb2RlTWlycm9yLmZvbGQuYXV0byxcbiAgICB3aWRnZXQ6IFwiXFx1MjE5NFwiLFxuICAgIG1pbkZvbGRTaXplOiAwLFxuICAgIHNjYW5VcDogZmFsc2VcbiAgfTtcblxuICBDb2RlTWlycm9yLmRlZmluZU9wdGlvbihcImZvbGRPcHRpb25zXCIsIG51bGwpO1xuXG4gIGZ1bmN0aW9uIGdldE9wdGlvbihjbSwgb3B0aW9ucywgbmFtZSkge1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnNbbmFtZV0gIT09IHVuZGVmaW5lZClcbiAgICAgIHJldHVybiBvcHRpb25zW25hbWVdO1xuICAgIHZhciBlZGl0b3JPcHRpb25zID0gY20ub3B0aW9ucy5mb2xkT3B0aW9ucztcbiAgICBpZiAoZWRpdG9yT3B0aW9ucyAmJiBlZGl0b3JPcHRpb25zW25hbWVdICE9PSB1bmRlZmluZWQpXG4gICAgICByZXR1cm4gZWRpdG9yT3B0aW9uc1tuYW1lXTtcbiAgICByZXR1cm4gZGVmYXVsdE9wdGlvbnNbbmFtZV07XG4gIH1cblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcImZvbGRPcHRpb25cIiwgZnVuY3Rpb24ob3B0aW9ucywgbmFtZSkge1xuICAgIHJldHVybiBnZXRPcHRpb24odGhpcywgb3B0aW9ucywgbmFtZSk7XG4gIH0pO1xufSk7XG4iLCIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHA6Ly9jb2RlbWlycm9yLm5ldC9MSUNFTlNFXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZChyZXF1aXJlKFwiLi4vLi4vbGliL2NvZGVtaXJyb3JcIiksIHJlcXVpcmUoXCIuL2ZvbGRjb2RlXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIsIFwiLi9mb2xkY29kZVwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVPcHRpb24oXCJmb2xkR3V0dGVyXCIsIGZhbHNlLCBmdW5jdGlvbihjbSwgdmFsLCBvbGQpIHtcbiAgICBpZiAob2xkICYmIG9sZCAhPSBDb2RlTWlycm9yLkluaXQpIHtcbiAgICAgIGNtLmNsZWFyR3V0dGVyKGNtLnN0YXRlLmZvbGRHdXR0ZXIub3B0aW9ucy5ndXR0ZXIpO1xuICAgICAgY20uc3RhdGUuZm9sZEd1dHRlciA9IG51bGw7XG4gICAgICBjbS5vZmYoXCJndXR0ZXJDbGlja1wiLCBvbkd1dHRlckNsaWNrKTtcbiAgICAgIGNtLm9mZihcImNoYW5nZVwiLCBvbkNoYW5nZSk7XG4gICAgICBjbS5vZmYoXCJ2aWV3cG9ydENoYW5nZVwiLCBvblZpZXdwb3J0Q2hhbmdlKTtcbiAgICAgIGNtLm9mZihcImZvbGRcIiwgb25Gb2xkKTtcbiAgICAgIGNtLm9mZihcInVuZm9sZFwiLCBvbkZvbGQpO1xuICAgICAgY20ub2ZmKFwic3dhcERvY1wiLCB1cGRhdGVJblZpZXdwb3J0KTtcbiAgICB9XG4gICAgaWYgKHZhbCkge1xuICAgICAgY20uc3RhdGUuZm9sZEd1dHRlciA9IG5ldyBTdGF0ZShwYXJzZU9wdGlvbnModmFsKSk7XG4gICAgICB1cGRhdGVJblZpZXdwb3J0KGNtKTtcbiAgICAgIGNtLm9uKFwiZ3V0dGVyQ2xpY2tcIiwgb25HdXR0ZXJDbGljayk7XG4gICAgICBjbS5vbihcImNoYW5nZVwiLCBvbkNoYW5nZSk7XG4gICAgICBjbS5vbihcInZpZXdwb3J0Q2hhbmdlXCIsIG9uVmlld3BvcnRDaGFuZ2UpO1xuICAgICAgY20ub24oXCJmb2xkXCIsIG9uRm9sZCk7XG4gICAgICBjbS5vbihcInVuZm9sZFwiLCBvbkZvbGQpO1xuICAgICAgY20ub24oXCJzd2FwRG9jXCIsIHVwZGF0ZUluVmlld3BvcnQpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFBvcyA9IENvZGVNaXJyb3IuUG9zO1xuXG4gIGZ1bmN0aW9uIFN0YXRlKG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHRoaXMuZnJvbSA9IHRoaXMudG8gPSAwO1xuICB9XG5cbiAgZnVuY3Rpb24gcGFyc2VPcHRpb25zKG9wdHMpIHtcbiAgICBpZiAob3B0cyA9PT0gdHJ1ZSkgb3B0cyA9IHt9O1xuICAgIGlmIChvcHRzLmd1dHRlciA9PSBudWxsKSBvcHRzLmd1dHRlciA9IFwiQ29kZU1pcnJvci1mb2xkZ3V0dGVyXCI7XG4gICAgaWYgKG9wdHMuaW5kaWNhdG9yT3BlbiA9PSBudWxsKSBvcHRzLmluZGljYXRvck9wZW4gPSBcIkNvZGVNaXJyb3ItZm9sZGd1dHRlci1vcGVuXCI7XG4gICAgaWYgKG9wdHMuaW5kaWNhdG9yRm9sZGVkID09IG51bGwpIG9wdHMuaW5kaWNhdG9yRm9sZGVkID0gXCJDb2RlTWlycm9yLWZvbGRndXR0ZXItZm9sZGVkXCI7XG4gICAgcmV0dXJuIG9wdHM7XG4gIH1cblxuICBmdW5jdGlvbiBpc0ZvbGRlZChjbSwgbGluZSkge1xuICAgIHZhciBtYXJrcyA9IGNtLmZpbmRNYXJrc0F0KFBvcyhsaW5lKSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrcy5sZW5ndGg7ICsraSlcbiAgICAgIGlmIChtYXJrc1tpXS5fX2lzRm9sZCAmJiBtYXJrc1tpXS5maW5kKCkuZnJvbS5saW5lID09IGxpbmUpIHJldHVybiBtYXJrc1tpXTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1hcmtlcihzcGVjKSB7XG4gICAgaWYgKHR5cGVvZiBzcGVjID09IFwic3RyaW5nXCIpIHtcbiAgICAgIHZhciBlbHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgZWx0LmNsYXNzTmFtZSA9IHNwZWMgKyBcIiBDb2RlTWlycm9yLWd1dHRlcm1hcmtlci1zdWJ0bGVcIjtcbiAgICAgIHJldHVybiBlbHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzcGVjLmNsb25lTm9kZSh0cnVlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVGb2xkSW5mbyhjbSwgZnJvbSwgdG8pIHtcbiAgICB2YXIgb3B0cyA9IGNtLnN0YXRlLmZvbGRHdXR0ZXIub3B0aW9ucywgY3VyID0gZnJvbTtcbiAgICB2YXIgbWluU2l6ZSA9IGNtLmZvbGRPcHRpb24ob3B0cywgXCJtaW5Gb2xkU2l6ZVwiKTtcbiAgICB2YXIgZnVuYyA9IGNtLmZvbGRPcHRpb24ob3B0cywgXCJyYW5nZUZpbmRlclwiKTtcbiAgICBjbS5lYWNoTGluZShmcm9tLCB0bywgZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIG1hcmsgPSBudWxsO1xuICAgICAgaWYgKGlzRm9sZGVkKGNtLCBjdXIpKSB7XG4gICAgICAgIG1hcmsgPSBtYXJrZXIob3B0cy5pbmRpY2F0b3JGb2xkZWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBvcyA9IFBvcyhjdXIsIDApO1xuICAgICAgICB2YXIgcmFuZ2UgPSBmdW5jICYmIGZ1bmMoY20sIHBvcyk7XG4gICAgICAgIGlmIChyYW5nZSAmJiByYW5nZS50by5saW5lIC0gcmFuZ2UuZnJvbS5saW5lID49IG1pblNpemUpXG4gICAgICAgICAgbWFyayA9IG1hcmtlcihvcHRzLmluZGljYXRvck9wZW4pO1xuICAgICAgfVxuICAgICAgY20uc2V0R3V0dGVyTWFya2VyKGxpbmUsIG9wdHMuZ3V0dGVyLCBtYXJrKTtcbiAgICAgICsrY3VyO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlSW5WaWV3cG9ydChjbSkge1xuICAgIHZhciB2cCA9IGNtLmdldFZpZXdwb3J0KCksIHN0YXRlID0gY20uc3RhdGUuZm9sZEd1dHRlcjtcbiAgICBpZiAoIXN0YXRlKSByZXR1cm47XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgdXBkYXRlRm9sZEluZm8oY20sIHZwLmZyb20sIHZwLnRvKTtcbiAgICB9KTtcbiAgICBzdGF0ZS5mcm9tID0gdnAuZnJvbTsgc3RhdGUudG8gPSB2cC50bztcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uR3V0dGVyQ2xpY2soY20sIGxpbmUsIGd1dHRlcikge1xuICAgIHZhciBzdGF0ZSA9IGNtLnN0YXRlLmZvbGRHdXR0ZXI7XG4gICAgaWYgKCFzdGF0ZSkgcmV0dXJuO1xuICAgIHZhciBvcHRzID0gc3RhdGUub3B0aW9ucztcbiAgICBpZiAoZ3V0dGVyICE9IG9wdHMuZ3V0dGVyKSByZXR1cm47XG4gICAgdmFyIGZvbGRlZCA9IGlzRm9sZGVkKGNtLCBsaW5lKTtcbiAgICBpZiAoZm9sZGVkKSBmb2xkZWQuY2xlYXIoKTtcbiAgICBlbHNlIGNtLmZvbGRDb2RlKFBvcyhsaW5lLCAwKSwgb3B0cy5yYW5nZUZpbmRlcik7XG4gIH1cblxuICBmdW5jdGlvbiBvbkNoYW5nZShjbSkge1xuICAgIHZhciBzdGF0ZSA9IGNtLnN0YXRlLmZvbGRHdXR0ZXI7XG4gICAgaWYgKCFzdGF0ZSkgcmV0dXJuO1xuICAgIHZhciBvcHRzID0gc3RhdGUub3B0aW9ucztcbiAgICBzdGF0ZS5mcm9tID0gc3RhdGUudG8gPSAwO1xuICAgIGNsZWFyVGltZW91dChzdGF0ZS5jaGFuZ2VVcGRhdGUpO1xuICAgIHN0YXRlLmNoYW5nZVVwZGF0ZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHVwZGF0ZUluVmlld3BvcnQoY20pOyB9LCBvcHRzLmZvbGRPbkNoYW5nZVRpbWVTcGFuIHx8IDYwMCk7XG4gIH1cblxuICBmdW5jdGlvbiBvblZpZXdwb3J0Q2hhbmdlKGNtKSB7XG4gICAgdmFyIHN0YXRlID0gY20uc3RhdGUuZm9sZEd1dHRlcjtcbiAgICBpZiAoIXN0YXRlKSByZXR1cm47XG4gICAgdmFyIG9wdHMgPSBzdGF0ZS5vcHRpb25zO1xuICAgIGNsZWFyVGltZW91dChzdGF0ZS5jaGFuZ2VVcGRhdGUpO1xuICAgIHN0YXRlLmNoYW5nZVVwZGF0ZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgdnAgPSBjbS5nZXRWaWV3cG9ydCgpO1xuICAgICAgaWYgKHN0YXRlLmZyb20gPT0gc3RhdGUudG8gfHwgdnAuZnJvbSAtIHN0YXRlLnRvID4gMjAgfHwgc3RhdGUuZnJvbSAtIHZwLnRvID4gMjApIHtcbiAgICAgICAgdXBkYXRlSW5WaWV3cG9ydChjbSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHZwLmZyb20gPCBzdGF0ZS5mcm9tKSB7XG4gICAgICAgICAgICB1cGRhdGVGb2xkSW5mbyhjbSwgdnAuZnJvbSwgc3RhdGUuZnJvbSk7XG4gICAgICAgICAgICBzdGF0ZS5mcm9tID0gdnAuZnJvbTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHZwLnRvID4gc3RhdGUudG8pIHtcbiAgICAgICAgICAgIHVwZGF0ZUZvbGRJbmZvKGNtLCBzdGF0ZS50bywgdnAudG8pO1xuICAgICAgICAgICAgc3RhdGUudG8gPSB2cC50bztcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIG9wdHMudXBkYXRlVmlld3BvcnRUaW1lU3BhbiB8fCA0MDApO1xuICB9XG5cbiAgZnVuY3Rpb24gb25Gb2xkKGNtLCBmcm9tKSB7XG4gICAgdmFyIHN0YXRlID0gY20uc3RhdGUuZm9sZEd1dHRlcjtcbiAgICBpZiAoIXN0YXRlKSByZXR1cm47XG4gICAgdmFyIGxpbmUgPSBmcm9tLmxpbmU7XG4gICAgaWYgKGxpbmUgPj0gc3RhdGUuZnJvbSAmJiBsaW5lIDwgc3RhdGUudG8pXG4gICAgICB1cGRhdGVGb2xkSW5mbyhjbSwgbGluZSwgbGluZSArIDEpO1xuICB9XG59KTtcbiIsIi8vIENvZGVNaXJyb3IsIGNvcHlyaWdodCAoYykgYnkgTWFyaWpuIEhhdmVyYmVrZSBhbmQgb3RoZXJzXG4vLyBEaXN0cmlidXRlZCB1bmRlciBhbiBNSVQgbGljZW5zZTogaHR0cDovL2NvZGVtaXJyb3IubmV0L0xJQ0VOU0VcblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcblwidXNlIHN0cmljdFwiO1xuXG5Db2RlTWlycm9yLnJlZ2lzdGVySGVscGVyKFwiZm9sZFwiLCBcImluZGVudFwiLCBmdW5jdGlvbihjbSwgc3RhcnQpIHtcbiAgdmFyIHRhYlNpemUgPSBjbS5nZXRPcHRpb24oXCJ0YWJTaXplXCIpLCBmaXJzdExpbmUgPSBjbS5nZXRMaW5lKHN0YXJ0LmxpbmUpO1xuICBpZiAoIS9cXFMvLnRlc3QoZmlyc3RMaW5lKSkgcmV0dXJuO1xuICB2YXIgZ2V0SW5kZW50ID0gZnVuY3Rpb24obGluZSkge1xuICAgIHJldHVybiBDb2RlTWlycm9yLmNvdW50Q29sdW1uKGxpbmUsIG51bGwsIHRhYlNpemUpO1xuICB9O1xuICB2YXIgbXlJbmRlbnQgPSBnZXRJbmRlbnQoZmlyc3RMaW5lKTtcbiAgdmFyIGxhc3RMaW5lSW5Gb2xkID0gbnVsbDtcbiAgLy8gR28gdGhyb3VnaCBsaW5lcyB1bnRpbCB3ZSBmaW5kIGEgbGluZSB0aGF0IGRlZmluaXRlbHkgZG9lc24ndCBiZWxvbmcgaW5cbiAgLy8gdGhlIGJsb2NrIHdlJ3JlIGZvbGRpbmcsIG9yIHRvIHRoZSBlbmQuXG4gIGZvciAodmFyIGkgPSBzdGFydC5saW5lICsgMSwgZW5kID0gY20ubGFzdExpbmUoKTsgaSA8PSBlbmQ7ICsraSkge1xuICAgIHZhciBjdXJMaW5lID0gY20uZ2V0TGluZShpKTtcbiAgICB2YXIgY3VySW5kZW50ID0gZ2V0SW5kZW50KGN1ckxpbmUpO1xuICAgIGlmIChjdXJJbmRlbnQgPiBteUluZGVudCkge1xuICAgICAgLy8gTGluZXMgd2l0aCBhIGdyZWF0ZXIgaW5kZW50IGFyZSBjb25zaWRlcmVkIHBhcnQgb2YgdGhlIGJsb2NrLlxuICAgICAgbGFzdExpbmVJbkZvbGQgPSBpO1xuICAgIH0gZWxzZSBpZiAoIS9cXFMvLnRlc3QoY3VyTGluZSkpIHtcbiAgICAgIC8vIEVtcHR5IGxpbmVzIG1pZ2h0IGJlIGJyZWFrcyB3aXRoaW4gdGhlIGJsb2NrIHdlJ3JlIHRyeWluZyB0byBmb2xkLlxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBIG5vbi1lbXB0eSBsaW5lIGF0IGFuIGluZGVudCBlcXVhbCB0byBvciBsZXNzIHRoYW4gb3VycyBtYXJrcyB0aGVcbiAgICAgIC8vIHN0YXJ0IG9mIGFub3RoZXIgYmxvY2suXG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKGxhc3RMaW5lSW5Gb2xkKSByZXR1cm4ge1xuICAgIGZyb206IENvZGVNaXJyb3IuUG9zKHN0YXJ0LmxpbmUsIGZpcnN0TGluZS5sZW5ndGgpLFxuICAgIHRvOiBDb2RlTWlycm9yLlBvcyhsYXN0TGluZUluRm9sZCwgY20uZ2V0TGluZShsYXN0TGluZUluRm9sZCkubGVuZ3RoKVxuICB9O1xufSk7XG5cbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCJdLCBtb2QpO1xuICBlbHNlIC8vIFBsYWluIGJyb3dzZXIgZW52XG4gICAgbW9kKENvZGVNaXJyb3IpO1xufSkoZnVuY3Rpb24oQ29kZU1pcnJvcikge1xuICB2YXIgUG9zID0gQ29kZU1pcnJvci5Qb3M7XG5cbiAgZnVuY3Rpb24gZm9yRWFjaChhcnIsIGYpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgZSA9IGFyci5sZW5ndGg7IGkgPCBlOyArK2kpIGYoYXJyW2ldKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFycmF5Q29udGFpbnMoYXJyLCBpdGVtKSB7XG4gICAgaWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZikge1xuICAgICAgdmFyIGkgPSBhcnIubGVuZ3RoO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoYXJyW2ldID09PSBpdGVtKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGFyci5pbmRleE9mKGl0ZW0pICE9IC0xO1xuICB9XG5cbiAgZnVuY3Rpb24gc2NyaXB0SGludChlZGl0b3IsIGtleXdvcmRzLCBnZXRUb2tlbiwgb3B0aW9ucykge1xuICAgIC8vIEZpbmQgdGhlIHRva2VuIGF0IHRoZSBjdXJzb3JcbiAgICB2YXIgY3VyID0gZWRpdG9yLmdldEN1cnNvcigpLCB0b2tlbiA9IGdldFRva2VuKGVkaXRvciwgY3VyKTtcbiAgICBpZiAoL1xcYig/OnN0cmluZ3xjb21tZW50KVxcYi8udGVzdCh0b2tlbi50eXBlKSkgcmV0dXJuO1xuICAgIHRva2VuLnN0YXRlID0gQ29kZU1pcnJvci5pbm5lck1vZGUoZWRpdG9yLmdldE1vZGUoKSwgdG9rZW4uc3RhdGUpLnN0YXRlO1xuXG4gICAgLy8gSWYgaXQncyBub3QgYSAnd29yZC1zdHlsZScgdG9rZW4sIGlnbm9yZSB0aGUgdG9rZW4uXG4gICAgaWYgKCEvXltcXHckX10qJC8udGVzdCh0b2tlbi5zdHJpbmcpKSB7XG4gICAgICB0b2tlbiA9IHtzdGFydDogY3VyLmNoLCBlbmQ6IGN1ci5jaCwgc3RyaW5nOiBcIlwiLCBzdGF0ZTogdG9rZW4uc3RhdGUsXG4gICAgICAgICAgICAgICB0eXBlOiB0b2tlbi5zdHJpbmcgPT0gXCIuXCIgPyBcInByb3BlcnR5XCIgOiBudWxsfTtcbiAgICB9IGVsc2UgaWYgKHRva2VuLmVuZCA+IGN1ci5jaCkge1xuICAgICAgdG9rZW4uZW5kID0gY3VyLmNoO1xuICAgICAgdG9rZW4uc3RyaW5nID0gdG9rZW4uc3RyaW5nLnNsaWNlKDAsIGN1ci5jaCAtIHRva2VuLnN0YXJ0KTtcbiAgICB9XG5cbiAgICB2YXIgdHByb3AgPSB0b2tlbjtcbiAgICAvLyBJZiBpdCBpcyBhIHByb3BlcnR5LCBmaW5kIG91dCB3aGF0IGl0IGlzIGEgcHJvcGVydHkgb2YuXG4gICAgd2hpbGUgKHRwcm9wLnR5cGUgPT0gXCJwcm9wZXJ0eVwiKSB7XG4gICAgICB0cHJvcCA9IGdldFRva2VuKGVkaXRvciwgUG9zKGN1ci5saW5lLCB0cHJvcC5zdGFydCkpO1xuICAgICAgaWYgKHRwcm9wLnN0cmluZyAhPSBcIi5cIikgcmV0dXJuO1xuICAgICAgdHByb3AgPSBnZXRUb2tlbihlZGl0b3IsIFBvcyhjdXIubGluZSwgdHByb3Auc3RhcnQpKTtcbiAgICAgIGlmICghY29udGV4dCkgdmFyIGNvbnRleHQgPSBbXTtcbiAgICAgIGNvbnRleHQucHVzaCh0cHJvcCk7XG4gICAgfVxuICAgIHJldHVybiB7bGlzdDogZ2V0Q29tcGxldGlvbnModG9rZW4sIGNvbnRleHQsIGtleXdvcmRzLCBvcHRpb25zKSxcbiAgICAgICAgICAgIGZyb206IFBvcyhjdXIubGluZSwgdG9rZW4uc3RhcnQpLFxuICAgICAgICAgICAgdG86IFBvcyhjdXIubGluZSwgdG9rZW4uZW5kKX07XG4gIH1cblxuICBmdW5jdGlvbiBqYXZhc2NyaXB0SGludChlZGl0b3IsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gc2NyaXB0SGludChlZGl0b3IsIGphdmFzY3JpcHRLZXl3b3JkcyxcbiAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZSwgY3VyKSB7cmV0dXJuIGUuZ2V0VG9rZW5BdChjdXIpO30sXG4gICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucyk7XG4gIH07XG4gIENvZGVNaXJyb3IucmVnaXN0ZXJIZWxwZXIoXCJoaW50XCIsIFwiamF2YXNjcmlwdFwiLCBqYXZhc2NyaXB0SGludCk7XG5cbiAgZnVuY3Rpb24gZ2V0Q29mZmVlU2NyaXB0VG9rZW4oZWRpdG9yLCBjdXIpIHtcbiAgLy8gVGhpcyBnZXRUb2tlbiwgaXQgaXMgZm9yIGNvZmZlZXNjcmlwdCwgaW1pdGF0ZXMgdGhlIGJlaGF2aW9yIG9mXG4gIC8vIGdldFRva2VuQXQgbWV0aG9kIGluIGphdmFzY3JpcHQuanMsIHRoYXQgaXMsIHJldHVybmluZyBcInByb3BlcnR5XCJcbiAgLy8gdHlwZSBhbmQgdHJlYXQgXCIuXCIgYXMgaW5kZXBlbmVudCB0b2tlbi5cbiAgICB2YXIgdG9rZW4gPSBlZGl0b3IuZ2V0VG9rZW5BdChjdXIpO1xuICAgIGlmIChjdXIuY2ggPT0gdG9rZW4uc3RhcnQgKyAxICYmIHRva2VuLnN0cmluZy5jaGFyQXQoMCkgPT0gJy4nKSB7XG4gICAgICB0b2tlbi5lbmQgPSB0b2tlbi5zdGFydDtcbiAgICAgIHRva2VuLnN0cmluZyA9ICcuJztcbiAgICAgIHRva2VuLnR5cGUgPSBcInByb3BlcnR5XCI7XG4gICAgfVxuICAgIGVsc2UgaWYgKC9eXFwuW1xcdyRfXSokLy50ZXN0KHRva2VuLnN0cmluZykpIHtcbiAgICAgIHRva2VuLnR5cGUgPSBcInByb3BlcnR5XCI7XG4gICAgICB0b2tlbi5zdGFydCsrO1xuICAgICAgdG9rZW4uc3RyaW5nID0gdG9rZW4uc3RyaW5nLnJlcGxhY2UoL1xcLi8sICcnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRva2VuO1xuICB9XG5cbiAgZnVuY3Rpb24gY29mZmVlc2NyaXB0SGludChlZGl0b3IsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gc2NyaXB0SGludChlZGl0b3IsIGNvZmZlZXNjcmlwdEtleXdvcmRzLCBnZXRDb2ZmZWVTY3JpcHRUb2tlbiwgb3B0aW9ucyk7XG4gIH1cbiAgQ29kZU1pcnJvci5yZWdpc3RlckhlbHBlcihcImhpbnRcIiwgXCJjb2ZmZWVzY3JpcHRcIiwgY29mZmVlc2NyaXB0SGludCk7XG5cbiAgdmFyIHN0cmluZ1Byb3BzID0gKFwiY2hhckF0IGNoYXJDb2RlQXQgaW5kZXhPZiBsYXN0SW5kZXhPZiBzdWJzdHJpbmcgc3Vic3RyIHNsaWNlIHRyaW0gdHJpbUxlZnQgdHJpbVJpZ2h0IFwiICtcbiAgICAgICAgICAgICAgICAgICAgIFwidG9VcHBlckNhc2UgdG9Mb3dlckNhc2Ugc3BsaXQgY29uY2F0IG1hdGNoIHJlcGxhY2Ugc2VhcmNoXCIpLnNwbGl0KFwiIFwiKTtcbiAgdmFyIGFycmF5UHJvcHMgPSAoXCJsZW5ndGggY29uY2F0IGpvaW4gc3BsaWNlIHB1c2ggcG9wIHNoaWZ0IHVuc2hpZnQgc2xpY2UgcmV2ZXJzZSBzb3J0IGluZGV4T2YgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImxhc3RJbmRleE9mIGV2ZXJ5IHNvbWUgZmlsdGVyIGZvckVhY2ggbWFwIHJlZHVjZSByZWR1Y2VSaWdodCBcIikuc3BsaXQoXCIgXCIpO1xuICB2YXIgZnVuY1Byb3BzID0gXCJwcm90b3R5cGUgYXBwbHkgY2FsbCBiaW5kXCIuc3BsaXQoXCIgXCIpO1xuICB2YXIgamF2YXNjcmlwdEtleXdvcmRzID0gKFwiYnJlYWsgY2FzZSBjYXRjaCBjb250aW51ZSBkZWJ1Z2dlciBkZWZhdWx0IGRlbGV0ZSBkbyBlbHNlIGZhbHNlIGZpbmFsbHkgZm9yIGZ1bmN0aW9uIFwiICtcbiAgICAgICAgICAgICAgICAgIFwiaWYgaW4gaW5zdGFuY2VvZiBuZXcgbnVsbCByZXR1cm4gc3dpdGNoIHRocm93IHRydWUgdHJ5IHR5cGVvZiB2YXIgdm9pZCB3aGlsZSB3aXRoXCIpLnNwbGl0KFwiIFwiKTtcbiAgdmFyIGNvZmZlZXNjcmlwdEtleXdvcmRzID0gKFwiYW5kIGJyZWFrIGNhdGNoIGNsYXNzIGNvbnRpbnVlIGRlbGV0ZSBkbyBlbHNlIGV4dGVuZHMgZmFsc2UgZmluYWxseSBmb3IgXCIgK1xuICAgICAgICAgICAgICAgICAgXCJpZiBpbiBpbnN0YW5jZW9mIGlzbnQgbmV3IG5vIG5vdCBudWxsIG9mIG9mZiBvbiBvciByZXR1cm4gc3dpdGNoIHRoZW4gdGhyb3cgdHJ1ZSB0cnkgdHlwZW9mIHVudGlsIHZvaWQgd2hpbGUgd2l0aCB5ZXNcIikuc3BsaXQoXCIgXCIpO1xuXG4gIGZ1bmN0aW9uIGdldENvbXBsZXRpb25zKHRva2VuLCBjb250ZXh0LCBrZXl3b3Jkcywgb3B0aW9ucykge1xuICAgIHZhciBmb3VuZCA9IFtdLCBzdGFydCA9IHRva2VuLnN0cmluZywgZ2xvYmFsID0gb3B0aW9ucyAmJiBvcHRpb25zLmdsb2JhbFNjb3BlIHx8IHdpbmRvdztcbiAgICBmdW5jdGlvbiBtYXliZUFkZChzdHIpIHtcbiAgICAgIGlmIChzdHIubGFzdEluZGV4T2Yoc3RhcnQsIDApID09IDAgJiYgIWFycmF5Q29udGFpbnMoZm91bmQsIHN0cikpIGZvdW5kLnB1c2goc3RyKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2F0aGVyQ29tcGxldGlvbnMob2JqKSB7XG4gICAgICBpZiAodHlwZW9mIG9iaiA9PSBcInN0cmluZ1wiKSBmb3JFYWNoKHN0cmluZ1Byb3BzLCBtYXliZUFkZCk7XG4gICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBBcnJheSkgZm9yRWFjaChhcnJheVByb3BzLCBtYXliZUFkZCk7XG4gICAgICBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBGdW5jdGlvbikgZm9yRWFjaChmdW5jUHJvcHMsIG1heWJlQWRkKTtcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gb2JqKSBtYXliZUFkZChuYW1lKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmJiBjb250ZXh0Lmxlbmd0aCkge1xuICAgICAgLy8gSWYgdGhpcyBpcyBhIHByb3BlcnR5LCBzZWUgaWYgaXQgYmVsb25ncyB0byBzb21lIG9iamVjdCB3ZSBjYW5cbiAgICAgIC8vIGZpbmQgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuXG4gICAgICB2YXIgb2JqID0gY29udGV4dC5wb3AoKSwgYmFzZTtcbiAgICAgIGlmIChvYmoudHlwZSAmJiBvYmoudHlwZS5pbmRleE9mKFwidmFyaWFibGVcIikgPT09IDApIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5hZGRpdGlvbmFsQ29udGV4dClcbiAgICAgICAgICBiYXNlID0gb3B0aW9ucy5hZGRpdGlvbmFsQ29udGV4dFtvYmouc3RyaW5nXTtcbiAgICAgICAgaWYgKCFvcHRpb25zIHx8IG9wdGlvbnMudXNlR2xvYmFsU2NvcGUgIT09IGZhbHNlKVxuICAgICAgICAgIGJhc2UgPSBiYXNlIHx8IGdsb2JhbFtvYmouc3RyaW5nXTtcbiAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBiYXNlID0gXCJcIjtcbiAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUgPT0gXCJhdG9tXCIpIHtcbiAgICAgICAgYmFzZSA9IDE7XG4gICAgICB9IGVsc2UgaWYgKG9iai50eXBlID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBpZiAoZ2xvYmFsLmpRdWVyeSAhPSBudWxsICYmIChvYmouc3RyaW5nID09ICckJyB8fCBvYmouc3RyaW5nID09ICdqUXVlcnknKSAmJlxuICAgICAgICAgICAgKHR5cGVvZiBnbG9iYWwualF1ZXJ5ID09ICdmdW5jdGlvbicpKVxuICAgICAgICAgIGJhc2UgPSBnbG9iYWwualF1ZXJ5KCk7XG4gICAgICAgIGVsc2UgaWYgKGdsb2JhbC5fICE9IG51bGwgJiYgKG9iai5zdHJpbmcgPT0gJ18nKSAmJiAodHlwZW9mIGdsb2JhbC5fID09ICdmdW5jdGlvbicpKVxuICAgICAgICAgIGJhc2UgPSBnbG9iYWwuXygpO1xuICAgICAgfVxuICAgICAgd2hpbGUgKGJhc2UgIT0gbnVsbCAmJiBjb250ZXh0Lmxlbmd0aClcbiAgICAgICAgYmFzZSA9IGJhc2VbY29udGV4dC5wb3AoKS5zdHJpbmddO1xuICAgICAgaWYgKGJhc2UgIT0gbnVsbCkgZ2F0aGVyQ29tcGxldGlvbnMoYmFzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIG5vdCwganVzdCBsb29rIGluIHRoZSBnbG9iYWwgb2JqZWN0IGFuZCBhbnkgbG9jYWwgc2NvcGVcbiAgICAgIC8vIChyZWFkaW5nIGludG8gSlMgbW9kZSBpbnRlcm5hbHMgdG8gZ2V0IGF0IHRoZSBsb2NhbCBhbmQgZ2xvYmFsIHZhcmlhYmxlcylcbiAgICAgIGZvciAodmFyIHYgPSB0b2tlbi5zdGF0ZS5sb2NhbFZhcnM7IHY7IHYgPSB2Lm5leHQpIG1heWJlQWRkKHYubmFtZSk7XG4gICAgICBmb3IgKHZhciB2ID0gdG9rZW4uc3RhdGUuZ2xvYmFsVmFyczsgdjsgdiA9IHYubmV4dCkgbWF5YmVBZGQodi5uYW1lKTtcbiAgICAgIGlmICghb3B0aW9ucyB8fCBvcHRpb25zLnVzZUdsb2JhbFNjb3BlICE9PSBmYWxzZSlcbiAgICAgICAgZ2F0aGVyQ29tcGxldGlvbnMoZ2xvYmFsKTtcbiAgICAgIGZvckVhY2goa2V5d29yZHMsIG1heWJlQWRkKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvdW5kO1xuICB9XG59KTtcbiIsIi8vIENvZGVNaXJyb3IsIGNvcHlyaWdodCAoYykgYnkgTWFyaWpuIEhhdmVyYmVrZSBhbmQgb3RoZXJzXG4vLyBEaXN0cmlidXRlZCB1bmRlciBhbiBNSVQgbGljZW5zZTogaHR0cDovL2NvZGVtaXJyb3IubmV0L0xJQ0VOU0VcblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIEhJTlRfRUxFTUVOVF9DTEFTUyAgICAgICAgPSBcIkNvZGVNaXJyb3ItaGludFwiO1xuICB2YXIgQUNUSVZFX0hJTlRfRUxFTUVOVF9DTEFTUyA9IFwiQ29kZU1pcnJvci1oaW50LWFjdGl2ZVwiO1xuXG4gIC8vIFRoaXMgaXMgdGhlIG9sZCBpbnRlcmZhY2UsIGtlcHQgYXJvdW5kIGZvciBub3cgdG8gc3RheVxuICAvLyBiYWNrd2FyZHMtY29tcGF0aWJsZS5cbiAgQ29kZU1pcnJvci5zaG93SGludCA9IGZ1bmN0aW9uKGNtLCBnZXRIaW50cywgb3B0aW9ucykge1xuICAgIGlmICghZ2V0SGludHMpIHJldHVybiBjbS5zaG93SGludChvcHRpb25zKTtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmFzeW5jKSBnZXRIaW50cy5hc3luYyA9IHRydWU7XG4gICAgdmFyIG5ld09wdHMgPSB7aGludDogZ2V0SGludHN9O1xuICAgIGlmIChvcHRpb25zKSBmb3IgKHZhciBwcm9wIGluIG9wdGlvbnMpIG5ld09wdHNbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgIHJldHVybiBjbS5zaG93SGludChuZXdPcHRzKTtcbiAgfTtcblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcInNob3dIaW50XCIsIGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gcGFyc2VPcHRpb25zKHRoaXMsIHRoaXMuZ2V0Q3Vyc29yKFwic3RhcnRcIiksIG9wdGlvbnMpO1xuICAgIHZhciBzZWxlY3Rpb25zID0gdGhpcy5saXN0U2VsZWN0aW9ucygpXG4gICAgaWYgKHNlbGVjdGlvbnMubGVuZ3RoID4gMSkgcmV0dXJuO1xuICAgIC8vIEJ5IGRlZmF1bHQsIGRvbid0IGFsbG93IGNvbXBsZXRpb24gd2hlbiBzb21ldGhpbmcgaXMgc2VsZWN0ZWQuXG4gICAgLy8gQSBoaW50IGZ1bmN0aW9uIGNhbiBoYXZlIGEgYHN1cHBvcnRzU2VsZWN0aW9uYCBwcm9wZXJ0eSB0b1xuICAgIC8vIGluZGljYXRlIHRoYXQgaXQgY2FuIGhhbmRsZSBzZWxlY3Rpb25zLlxuICAgIGlmICh0aGlzLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcbiAgICAgIGlmICghb3B0aW9ucy5oaW50LnN1cHBvcnRzU2VsZWN0aW9uKSByZXR1cm47XG4gICAgICAvLyBEb24ndCB0cnkgd2l0aCBjcm9zcy1saW5lIHNlbGVjdGlvbnNcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0aW9ucy5sZW5ndGg7IGkrKylcbiAgICAgICAgaWYgKHNlbGVjdGlvbnNbaV0uaGVhZC5saW5lICE9IHNlbGVjdGlvbnNbaV0uYW5jaG9yLmxpbmUpIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0ZS5jb21wbGV0aW9uQWN0aXZlKSB0aGlzLnN0YXRlLmNvbXBsZXRpb25BY3RpdmUuY2xvc2UoKTtcbiAgICB2YXIgY29tcGxldGlvbiA9IHRoaXMuc3RhdGUuY29tcGxldGlvbkFjdGl2ZSA9IG5ldyBDb21wbGV0aW9uKHRoaXMsIG9wdGlvbnMpO1xuICAgIGlmICghY29tcGxldGlvbi5vcHRpb25zLmhpbnQpIHJldHVybjtcblxuICAgIENvZGVNaXJyb3Iuc2lnbmFsKHRoaXMsIFwic3RhcnRDb21wbGV0aW9uXCIsIHRoaXMpO1xuICAgIGNvbXBsZXRpb24udXBkYXRlKHRydWUpO1xuICB9KTtcblxuICBmdW5jdGlvbiBDb21wbGV0aW9uKGNtLCBvcHRpb25zKSB7XG4gICAgdGhpcy5jbSA9IGNtO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy53aWRnZXQgPSBudWxsO1xuICAgIHRoaXMuZGVib3VuY2UgPSAwO1xuICAgIHRoaXMudGljayA9IDA7XG4gICAgdGhpcy5zdGFydFBvcyA9IHRoaXMuY20uZ2V0Q3Vyc29yKFwic3RhcnRcIik7XG4gICAgdGhpcy5zdGFydExlbiA9IHRoaXMuY20uZ2V0TGluZSh0aGlzLnN0YXJ0UG9zLmxpbmUpLmxlbmd0aCAtIHRoaXMuY20uZ2V0U2VsZWN0aW9uKCkubGVuZ3RoO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGNtLm9uKFwiY3Vyc29yQWN0aXZpdHlcIiwgdGhpcy5hY3Rpdml0eUZ1bmMgPSBmdW5jdGlvbigpIHsgc2VsZi5jdXJzb3JBY3Rpdml0eSgpOyB9KTtcbiAgfVxuXG4gIHZhciByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uKGZuKSB7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIDEwMDAvNjApO1xuICB9O1xuICB2YXIgY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgfHwgY2xlYXJUaW1lb3V0O1xuXG4gIENvbXBsZXRpb24ucHJvdG90eXBlID0ge1xuICAgIGNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdGhpcy5hY3RpdmUoKSkgcmV0dXJuO1xuICAgICAgdGhpcy5jbS5zdGF0ZS5jb21wbGV0aW9uQWN0aXZlID0gbnVsbDtcbiAgICAgIHRoaXMudGljayA9IG51bGw7XG4gICAgICB0aGlzLmNtLm9mZihcImN1cnNvckFjdGl2aXR5XCIsIHRoaXMuYWN0aXZpdHlGdW5jKTtcblxuICAgICAgaWYgKHRoaXMud2lkZ2V0ICYmIHRoaXMuZGF0YSkgQ29kZU1pcnJvci5zaWduYWwodGhpcy5kYXRhLCBcImNsb3NlXCIpO1xuICAgICAgaWYgKHRoaXMud2lkZ2V0KSB0aGlzLndpZGdldC5jbG9zZSgpO1xuICAgICAgQ29kZU1pcnJvci5zaWduYWwodGhpcy5jbSwgXCJlbmRDb21wbGV0aW9uXCIsIHRoaXMuY20pO1xuICAgIH0sXG5cbiAgICBhY3RpdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY20uc3RhdGUuY29tcGxldGlvbkFjdGl2ZSA9PSB0aGlzO1xuICAgIH0sXG5cbiAgICBwaWNrOiBmdW5jdGlvbihkYXRhLCBpKSB7XG4gICAgICB2YXIgY29tcGxldGlvbiA9IGRhdGEubGlzdFtpXTtcbiAgICAgIGlmIChjb21wbGV0aW9uLmhpbnQpIGNvbXBsZXRpb24uaGludCh0aGlzLmNtLCBkYXRhLCBjb21wbGV0aW9uKTtcbiAgICAgIGVsc2UgdGhpcy5jbS5yZXBsYWNlUmFuZ2UoZ2V0VGV4dChjb21wbGV0aW9uKSwgY29tcGxldGlvbi5mcm9tIHx8IGRhdGEuZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGlvbi50byB8fCBkYXRhLnRvLCBcImNvbXBsZXRlXCIpO1xuICAgICAgQ29kZU1pcnJvci5zaWduYWwoZGF0YSwgXCJwaWNrXCIsIGNvbXBsZXRpb24pO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0sXG5cbiAgICBjdXJzb3JBY3Rpdml0eTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5kZWJvdW5jZSkge1xuICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmRlYm91bmNlKTtcbiAgICAgICAgdGhpcy5kZWJvdW5jZSA9IDA7XG4gICAgICB9XG5cbiAgICAgIHZhciBwb3MgPSB0aGlzLmNtLmdldEN1cnNvcigpLCBsaW5lID0gdGhpcy5jbS5nZXRMaW5lKHBvcy5saW5lKTtcbiAgICAgIGlmIChwb3MubGluZSAhPSB0aGlzLnN0YXJ0UG9zLmxpbmUgfHwgbGluZS5sZW5ndGggLSBwb3MuY2ggIT0gdGhpcy5zdGFydExlbiAtIHRoaXMuc3RhcnRQb3MuY2ggfHxcbiAgICAgICAgICBwb3MuY2ggPCB0aGlzLnN0YXJ0UG9zLmNoIHx8IHRoaXMuY20uc29tZXRoaW5nU2VsZWN0ZWQoKSB8fFxuICAgICAgICAgIChwb3MuY2ggJiYgdGhpcy5vcHRpb25zLmNsb3NlQ2hhcmFjdGVycy50ZXN0KGxpbmUuY2hhckF0KHBvcy5jaCAtIDEpKSkpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmRlYm91bmNlID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge3NlbGYudXBkYXRlKCk7fSk7XG4gICAgICAgIGlmICh0aGlzLndpZGdldCkgdGhpcy53aWRnZXQuZGlzYWJsZSgpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGZpcnN0KSB7XG4gICAgICBpZiAodGhpcy50aWNrID09IG51bGwpIHJldHVybjtcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhpbnQuYXN5bmMpIHtcbiAgICAgICAgdGhpcy5maW5pc2hVcGRhdGUodGhpcy5vcHRpb25zLmhpbnQodGhpcy5jbSwgdGhpcy5vcHRpb25zKSwgZmlyc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG15VGljayA9ICsrdGhpcy50aWNrLCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5vcHRpb25zLmhpbnQodGhpcy5jbSwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChzZWxmLnRpY2sgPT0gbXlUaWNrKSBzZWxmLmZpbmlzaFVwZGF0ZShkYXRhLCBmaXJzdCk7XG4gICAgICAgIH0sIHRoaXMub3B0aW9ucyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGZpbmlzaFVwZGF0ZTogZnVuY3Rpb24oZGF0YSwgZmlyc3QpIHtcbiAgICAgIGlmICh0aGlzLmRhdGEpIENvZGVNaXJyb3Iuc2lnbmFsKHRoaXMuZGF0YSwgXCJ1cGRhdGVcIik7XG4gICAgICBpZiAoZGF0YSAmJiB0aGlzLmRhdGEgJiYgQ29kZU1pcnJvci5jbXBQb3MoZGF0YS5mcm9tLCB0aGlzLmRhdGEuZnJvbSkpIGRhdGEgPSBudWxsO1xuICAgICAgdGhpcy5kYXRhID0gZGF0YTtcblxuICAgICAgdmFyIHBpY2tlZCA9ICh0aGlzLndpZGdldCAmJiB0aGlzLndpZGdldC5waWNrZWQpIHx8IChmaXJzdCAmJiB0aGlzLm9wdGlvbnMuY29tcGxldGVTaW5nbGUpO1xuICAgICAgaWYgKHRoaXMud2lkZ2V0KSB0aGlzLndpZGdldC5jbG9zZSgpO1xuICAgICAgaWYgKGRhdGEgJiYgZGF0YS5saXN0Lmxlbmd0aCkge1xuICAgICAgICBpZiAocGlja2VkICYmIGRhdGEubGlzdC5sZW5ndGggPT0gMSkge1xuICAgICAgICAgIHRoaXMucGljayhkYXRhLCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLndpZGdldCA9IG5ldyBXaWRnZXQodGhpcywgZGF0YSk7XG4gICAgICAgICAgQ29kZU1pcnJvci5zaWduYWwoZGF0YSwgXCJzaG93blwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBwYXJzZU9wdGlvbnMoY20sIHBvcywgb3B0aW9ucykge1xuICAgIHZhciBlZGl0b3IgPSBjbS5vcHRpb25zLmhpbnRPcHRpb25zO1xuICAgIHZhciBvdXQgPSB7fTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGRlZmF1bHRPcHRpb25zKSBvdXRbcHJvcF0gPSBkZWZhdWx0T3B0aW9uc1twcm9wXTtcbiAgICBpZiAoZWRpdG9yKSBmb3IgKHZhciBwcm9wIGluIGVkaXRvcilcbiAgICAgIGlmIChlZGl0b3JbcHJvcF0gIT09IHVuZGVmaW5lZCkgb3V0W3Byb3BdID0gZWRpdG9yW3Byb3BdO1xuICAgIGlmIChvcHRpb25zKSBmb3IgKHZhciBwcm9wIGluIG9wdGlvbnMpXG4gICAgICBpZiAob3B0aW9uc1twcm9wXSAhPT0gdW5kZWZpbmVkKSBvdXRbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgIGlmIChvdXQuaGludC5yZXNvbHZlKSBvdXQuaGludCA9IG91dC5oaW50LnJlc29sdmUoY20sIHBvcylcbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0VGV4dChjb21wbGV0aW9uKSB7XG4gICAgaWYgKHR5cGVvZiBjb21wbGV0aW9uID09IFwic3RyaW5nXCIpIHJldHVybiBjb21wbGV0aW9uO1xuICAgIGVsc2UgcmV0dXJuIGNvbXBsZXRpb24udGV4dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkS2V5TWFwKGNvbXBsZXRpb24sIGhhbmRsZSkge1xuICAgIHZhciBiYXNlTWFwID0ge1xuICAgICAgVXA6IGZ1bmN0aW9uKCkge2hhbmRsZS5tb3ZlRm9jdXMoLTEpO30sXG4gICAgICBEb3duOiBmdW5jdGlvbigpIHtoYW5kbGUubW92ZUZvY3VzKDEpO30sXG4gICAgICBQYWdlVXA6IGZ1bmN0aW9uKCkge2hhbmRsZS5tb3ZlRm9jdXMoLWhhbmRsZS5tZW51U2l6ZSgpICsgMSwgdHJ1ZSk7fSxcbiAgICAgIFBhZ2VEb3duOiBmdW5jdGlvbigpIHtoYW5kbGUubW92ZUZvY3VzKGhhbmRsZS5tZW51U2l6ZSgpIC0gMSwgdHJ1ZSk7fSxcbiAgICAgIEhvbWU6IGZ1bmN0aW9uKCkge2hhbmRsZS5zZXRGb2N1cygwKTt9LFxuICAgICAgRW5kOiBmdW5jdGlvbigpIHtoYW5kbGUuc2V0Rm9jdXMoaGFuZGxlLmxlbmd0aCAtIDEpO30sXG4gICAgICBFbnRlcjogaGFuZGxlLnBpY2ssXG4gICAgICBUYWI6IGhhbmRsZS5waWNrLFxuICAgICAgRXNjOiBoYW5kbGUuY2xvc2VcbiAgICB9O1xuICAgIHZhciBjdXN0b20gPSBjb21wbGV0aW9uLm9wdGlvbnMuY3VzdG9tS2V5cztcbiAgICB2YXIgb3VyTWFwID0gY3VzdG9tID8ge30gOiBiYXNlTWFwO1xuICAgIGZ1bmN0aW9uIGFkZEJpbmRpbmcoa2V5LCB2YWwpIHtcbiAgICAgIHZhciBib3VuZDtcbiAgICAgIGlmICh0eXBlb2YgdmFsICE9IFwic3RyaW5nXCIpXG4gICAgICAgIGJvdW5kID0gZnVuY3Rpb24oY20pIHsgcmV0dXJuIHZhbChjbSwgaGFuZGxlKTsgfTtcbiAgICAgIC8vIFRoaXMgbWVjaGFuaXNtIGlzIGRlcHJlY2F0ZWRcbiAgICAgIGVsc2UgaWYgKGJhc2VNYXAuaGFzT3duUHJvcGVydHkodmFsKSlcbiAgICAgICAgYm91bmQgPSBiYXNlTWFwW3ZhbF07XG4gICAgICBlbHNlXG4gICAgICAgIGJvdW5kID0gdmFsO1xuICAgICAgb3VyTWFwW2tleV0gPSBib3VuZDtcbiAgICB9XG4gICAgaWYgKGN1c3RvbSlcbiAgICAgIGZvciAodmFyIGtleSBpbiBjdXN0b20pIGlmIChjdXN0b20uaGFzT3duUHJvcGVydHkoa2V5KSlcbiAgICAgICAgYWRkQmluZGluZyhrZXksIGN1c3RvbVtrZXldKTtcbiAgICB2YXIgZXh0cmEgPSBjb21wbGV0aW9uLm9wdGlvbnMuZXh0cmFLZXlzO1xuICAgIGlmIChleHRyYSlcbiAgICAgIGZvciAodmFyIGtleSBpbiBleHRyYSkgaWYgKGV4dHJhLmhhc093blByb3BlcnR5KGtleSkpXG4gICAgICAgIGFkZEJpbmRpbmcoa2V5LCBleHRyYVtrZXldKTtcbiAgICByZXR1cm4gb3VyTWFwO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SGludEVsZW1lbnQoaGludHNFbGVtZW50LCBlbCkge1xuICAgIHdoaWxlIChlbCAmJiBlbCAhPSBoaW50c0VsZW1lbnQpIHtcbiAgICAgIGlmIChlbC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09PSBcIkxJXCIgJiYgZWwucGFyZW50Tm9kZSA9PSBoaW50c0VsZW1lbnQpIHJldHVybiBlbDtcbiAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBXaWRnZXQoY29tcGxldGlvbiwgZGF0YSkge1xuICAgIHRoaXMuY29tcGxldGlvbiA9IGNvbXBsZXRpb247XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICB0aGlzLnBpY2tlZCA9IGZhbHNlO1xuICAgIHZhciB3aWRnZXQgPSB0aGlzLCBjbSA9IGNvbXBsZXRpb24uY207XG5cbiAgICB2YXIgaGludHMgPSB0aGlzLmhpbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInVsXCIpO1xuICAgIGhpbnRzLmNsYXNzTmFtZSA9IFwiQ29kZU1pcnJvci1oaW50c1wiO1xuICAgIHRoaXMuc2VsZWN0ZWRIaW50ID0gZGF0YS5zZWxlY3RlZEhpbnQgfHwgMDtcblxuICAgIHZhciBjb21wbGV0aW9ucyA9IGRhdGEubGlzdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbXBsZXRpb25zLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgZWx0ID0gaGludHMuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpKSwgY3VyID0gY29tcGxldGlvbnNbaV07XG4gICAgICB2YXIgY2xhc3NOYW1lID0gSElOVF9FTEVNRU5UX0NMQVNTICsgKGkgIT0gdGhpcy5zZWxlY3RlZEhpbnQgPyBcIlwiIDogXCIgXCIgKyBBQ1RJVkVfSElOVF9FTEVNRU5UX0NMQVNTKTtcbiAgICAgIGlmIChjdXIuY2xhc3NOYW1lICE9IG51bGwpIGNsYXNzTmFtZSA9IGN1ci5jbGFzc05hbWUgKyBcIiBcIiArIGNsYXNzTmFtZTtcbiAgICAgIGVsdC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgICBpZiAoY3VyLnJlbmRlcikgY3VyLnJlbmRlcihlbHQsIGRhdGEsIGN1cik7XG4gICAgICBlbHNlIGVsdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjdXIuZGlzcGxheVRleHQgfHwgZ2V0VGV4dChjdXIpKSk7XG4gICAgICBlbHQuaGludElkID0gaTtcbiAgICB9XG5cbiAgICB2YXIgcG9zID0gY20uY3Vyc29yQ29vcmRzKGNvbXBsZXRpb24ub3B0aW9ucy5hbGlnbldpdGhXb3JkID8gZGF0YS5mcm9tIDogbnVsbCk7XG4gICAgdmFyIGxlZnQgPSBwb3MubGVmdCwgdG9wID0gcG9zLmJvdHRvbSwgYmVsb3cgPSB0cnVlO1xuICAgIGhpbnRzLnN0eWxlLmxlZnQgPSBsZWZ0ICsgXCJweFwiO1xuICAgIGhpbnRzLnN0eWxlLnRvcCA9IHRvcCArIFwicHhcIjtcbiAgICAvLyBJZiB3ZSdyZSBhdCB0aGUgZWRnZSBvZiB0aGUgc2NyZWVuLCB0aGVuIHdlIHdhbnQgdGhlIG1lbnUgdG8gYXBwZWFyIG9uIHRoZSBsZWZ0IG9mIHRoZSBjdXJzb3IuXG4gICAgdmFyIHdpblcgPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBNYXRoLm1heChkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0V2lkdGgpO1xuICAgIHZhciB3aW5IID0gd2luZG93LmlubmVySGVpZ2h0IHx8IE1hdGgubWF4KGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0KTtcbiAgICAoY29tcGxldGlvbi5vcHRpb25zLmNvbnRhaW5lciB8fCBkb2N1bWVudC5ib2R5KS5hcHBlbmRDaGlsZChoaW50cyk7XG4gICAgdmFyIGJveCA9IGhpbnRzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBvdmVybGFwWSA9IGJveC5ib3R0b20gLSB3aW5IO1xuICAgIGlmIChvdmVybGFwWSA+IDApIHtcbiAgICAgIHZhciBoZWlnaHQgPSBib3guYm90dG9tIC0gYm94LnRvcCwgY3VyVG9wID0gcG9zLnRvcCAtIChwb3MuYm90dG9tIC0gYm94LnRvcCk7XG4gICAgICBpZiAoY3VyVG9wIC0gaGVpZ2h0ID4gMCkgeyAvLyBGaXRzIGFib3ZlIGN1cnNvclxuICAgICAgICBoaW50cy5zdHlsZS50b3AgPSAodG9wID0gcG9zLnRvcCAtIGhlaWdodCkgKyBcInB4XCI7XG4gICAgICAgIGJlbG93ID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKGhlaWdodCA+IHdpbkgpIHtcbiAgICAgICAgaGludHMuc3R5bGUuaGVpZ2h0ID0gKHdpbkggLSA1KSArIFwicHhcIjtcbiAgICAgICAgaGludHMuc3R5bGUudG9wID0gKHRvcCA9IHBvcy5ib3R0b20gLSBib3gudG9wKSArIFwicHhcIjtcbiAgICAgICAgdmFyIGN1cnNvciA9IGNtLmdldEN1cnNvcigpO1xuICAgICAgICBpZiAoZGF0YS5mcm9tLmNoICE9IGN1cnNvci5jaCkge1xuICAgICAgICAgIHBvcyA9IGNtLmN1cnNvckNvb3JkcyhjdXJzb3IpO1xuICAgICAgICAgIGhpbnRzLnN0eWxlLmxlZnQgPSAobGVmdCA9IHBvcy5sZWZ0KSArIFwicHhcIjtcbiAgICAgICAgICBib3ggPSBoaW50cy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB2YXIgb3ZlcmxhcFggPSBib3gucmlnaHQgLSB3aW5XO1xuICAgIGlmIChvdmVybGFwWCA+IDApIHtcbiAgICAgIGlmIChib3gucmlnaHQgLSBib3gubGVmdCA+IHdpblcpIHtcbiAgICAgICAgaGludHMuc3R5bGUud2lkdGggPSAod2luVyAtIDUpICsgXCJweFwiO1xuICAgICAgICBvdmVybGFwWCAtPSAoYm94LnJpZ2h0IC0gYm94LmxlZnQpIC0gd2luVztcbiAgICAgIH1cbiAgICAgIGhpbnRzLnN0eWxlLmxlZnQgPSAobGVmdCA9IHBvcy5sZWZ0IC0gb3ZlcmxhcFgpICsgXCJweFwiO1xuICAgIH1cblxuICAgIGNtLmFkZEtleU1hcCh0aGlzLmtleU1hcCA9IGJ1aWxkS2V5TWFwKGNvbXBsZXRpb24sIHtcbiAgICAgIG1vdmVGb2N1czogZnVuY3Rpb24obiwgYXZvaWRXcmFwKSB7IHdpZGdldC5jaGFuZ2VBY3RpdmUod2lkZ2V0LnNlbGVjdGVkSGludCArIG4sIGF2b2lkV3JhcCk7IH0sXG4gICAgICBzZXRGb2N1czogZnVuY3Rpb24obikgeyB3aWRnZXQuY2hhbmdlQWN0aXZlKG4pOyB9LFxuICAgICAgbWVudVNpemU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gd2lkZ2V0LnNjcmVlbkFtb3VudCgpOyB9LFxuICAgICAgbGVuZ3RoOiBjb21wbGV0aW9ucy5sZW5ndGgsXG4gICAgICBjbG9zZTogZnVuY3Rpb24oKSB7IGNvbXBsZXRpb24uY2xvc2UoKTsgfSxcbiAgICAgIHBpY2s6IGZ1bmN0aW9uKCkgeyB3aWRnZXQucGljaygpOyB9LFxuICAgICAgZGF0YTogZGF0YVxuICAgIH0pKTtcblxuICAgIGlmIChjb21wbGV0aW9uLm9wdGlvbnMuY2xvc2VPblVuZm9jdXMpIHtcbiAgICAgIHZhciBjbG9zaW5nT25CbHVyO1xuICAgICAgY20ub24oXCJibHVyXCIsIHRoaXMub25CbHVyID0gZnVuY3Rpb24oKSB7IGNsb3NpbmdPbkJsdXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjb21wbGV0aW9uLmNsb3NlKCk7IH0sIDEwMCk7IH0pO1xuICAgICAgY20ub24oXCJmb2N1c1wiLCB0aGlzLm9uRm9jdXMgPSBmdW5jdGlvbigpIHsgY2xlYXJUaW1lb3V0KGNsb3NpbmdPbkJsdXIpOyB9KTtcbiAgICB9XG5cbiAgICB2YXIgc3RhcnRTY3JvbGwgPSBjbS5nZXRTY3JvbGxJbmZvKCk7XG4gICAgY20ub24oXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGN1clNjcm9sbCA9IGNtLmdldFNjcm9sbEluZm8oKSwgZWRpdG9yID0gY20uZ2V0V3JhcHBlckVsZW1lbnQoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHZhciBuZXdUb3AgPSB0b3AgKyBzdGFydFNjcm9sbC50b3AgLSBjdXJTY3JvbGwudG9wO1xuICAgICAgdmFyIHBvaW50ID0gbmV3VG9wIC0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IHx8IGRvY3VtZW50LmJvZHkpLnNjcm9sbFRvcCk7XG4gICAgICBpZiAoIWJlbG93KSBwb2ludCArPSBoaW50cy5vZmZzZXRIZWlnaHQ7XG4gICAgICBpZiAocG9pbnQgPD0gZWRpdG9yLnRvcCB8fCBwb2ludCA+PSBlZGl0b3IuYm90dG9tKSByZXR1cm4gY29tcGxldGlvbi5jbG9zZSgpO1xuICAgICAgaGludHMuc3R5bGUudG9wID0gbmV3VG9wICsgXCJweFwiO1xuICAgICAgaGludHMuc3R5bGUubGVmdCA9IChsZWZ0ICsgc3RhcnRTY3JvbGwubGVmdCAtIGN1clNjcm9sbC5sZWZ0KSArIFwicHhcIjtcbiAgICB9KTtcblxuICAgIENvZGVNaXJyb3Iub24oaGludHMsIFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHQgPSBnZXRIaW50RWxlbWVudChoaW50cywgZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50KTtcbiAgICAgIGlmICh0ICYmIHQuaGludElkICE9IG51bGwpIHt3aWRnZXQuY2hhbmdlQWN0aXZlKHQuaGludElkKTsgd2lkZ2V0LnBpY2soKTt9XG4gICAgfSk7XG5cbiAgICBDb2RlTWlycm9yLm9uKGhpbnRzLCBcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciB0ID0gZ2V0SGludEVsZW1lbnQoaGludHMsIGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCk7XG4gICAgICBpZiAodCAmJiB0LmhpbnRJZCAhPSBudWxsKSB7XG4gICAgICAgIHdpZGdldC5jaGFuZ2VBY3RpdmUodC5oaW50SWQpO1xuICAgICAgICBpZiAoY29tcGxldGlvbi5vcHRpb25zLmNvbXBsZXRlT25TaW5nbGVDbGljaykgd2lkZ2V0LnBpY2soKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIENvZGVNaXJyb3Iub24oaGludHMsIFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe2NtLmZvY3VzKCk7fSwgMjApO1xuICAgIH0pO1xuXG4gICAgQ29kZU1pcnJvci5zaWduYWwoZGF0YSwgXCJzZWxlY3RcIiwgY29tcGxldGlvbnNbMF0sIGhpbnRzLmZpcnN0Q2hpbGQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgV2lkZ2V0LnByb3RvdHlwZSA9IHtcbiAgICBjbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5jb21wbGV0aW9uLndpZGdldCAhPSB0aGlzKSByZXR1cm47XG4gICAgICB0aGlzLmNvbXBsZXRpb24ud2lkZ2V0ID0gbnVsbDtcbiAgICAgIHRoaXMuaGludHMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmhpbnRzKTtcbiAgICAgIHRoaXMuY29tcGxldGlvbi5jbS5yZW1vdmVLZXlNYXAodGhpcy5rZXlNYXApO1xuXG4gICAgICB2YXIgY20gPSB0aGlzLmNvbXBsZXRpb24uY207XG4gICAgICBpZiAodGhpcy5jb21wbGV0aW9uLm9wdGlvbnMuY2xvc2VPblVuZm9jdXMpIHtcbiAgICAgICAgY20ub2ZmKFwiYmx1clwiLCB0aGlzLm9uQmx1cik7XG4gICAgICAgIGNtLm9mZihcImZvY3VzXCIsIHRoaXMub25Gb2N1cyk7XG4gICAgICB9XG4gICAgICBjbS5vZmYoXCJzY3JvbGxcIiwgdGhpcy5vblNjcm9sbCk7XG4gICAgfSxcblxuICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5jb21wbGV0aW9uLmNtLnJlbW92ZUtleU1hcCh0aGlzLmtleU1hcCk7XG4gICAgICB2YXIgd2lkZ2V0ID0gdGhpcztcbiAgICAgIHRoaXMua2V5TWFwID0ge0VudGVyOiBmdW5jdGlvbigpIHsgd2lkZ2V0LnBpY2tlZCA9IHRydWU7IH19O1xuICAgICAgdGhpcy5jb21wbGV0aW9uLmNtLmFkZEtleU1hcCh0aGlzLmtleU1hcCk7XG4gICAgfSxcblxuICAgIHBpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5jb21wbGV0aW9uLnBpY2sodGhpcy5kYXRhLCB0aGlzLnNlbGVjdGVkSGludCk7XG4gICAgfSxcblxuICAgIGNoYW5nZUFjdGl2ZTogZnVuY3Rpb24oaSwgYXZvaWRXcmFwKSB7XG4gICAgICBpZiAoaSA+PSB0aGlzLmRhdGEubGlzdC5sZW5ndGgpXG4gICAgICAgIGkgPSBhdm9pZFdyYXAgPyB0aGlzLmRhdGEubGlzdC5sZW5ndGggLSAxIDogMDtcbiAgICAgIGVsc2UgaWYgKGkgPCAwKVxuICAgICAgICBpID0gYXZvaWRXcmFwID8gMCAgOiB0aGlzLmRhdGEubGlzdC5sZW5ndGggLSAxO1xuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRIaW50ID09IGkpIHJldHVybjtcbiAgICAgIHZhciBub2RlID0gdGhpcy5oaW50cy5jaGlsZE5vZGVzW3RoaXMuc2VsZWN0ZWRIaW50XTtcbiAgICAgIG5vZGUuY2xhc3NOYW1lID0gbm9kZS5jbGFzc05hbWUucmVwbGFjZShcIiBcIiArIEFDVElWRV9ISU5UX0VMRU1FTlRfQ0xBU1MsIFwiXCIpO1xuICAgICAgbm9kZSA9IHRoaXMuaGludHMuY2hpbGROb2Rlc1t0aGlzLnNlbGVjdGVkSGludCA9IGldO1xuICAgICAgbm9kZS5jbGFzc05hbWUgKz0gXCIgXCIgKyBBQ1RJVkVfSElOVF9FTEVNRU5UX0NMQVNTO1xuICAgICAgaWYgKG5vZGUub2Zmc2V0VG9wIDwgdGhpcy5oaW50cy5zY3JvbGxUb3ApXG4gICAgICAgIHRoaXMuaGludHMuc2Nyb2xsVG9wID0gbm9kZS5vZmZzZXRUb3AgLSAzO1xuICAgICAgZWxzZSBpZiAobm9kZS5vZmZzZXRUb3AgKyBub2RlLm9mZnNldEhlaWdodCA+IHRoaXMuaGludHMuc2Nyb2xsVG9wICsgdGhpcy5oaW50cy5jbGllbnRIZWlnaHQpXG4gICAgICAgIHRoaXMuaGludHMuc2Nyb2xsVG9wID0gbm9kZS5vZmZzZXRUb3AgKyBub2RlLm9mZnNldEhlaWdodCAtIHRoaXMuaGludHMuY2xpZW50SGVpZ2h0ICsgMztcbiAgICAgIENvZGVNaXJyb3Iuc2lnbmFsKHRoaXMuZGF0YSwgXCJzZWxlY3RcIiwgdGhpcy5kYXRhLmxpc3RbdGhpcy5zZWxlY3RlZEhpbnRdLCBub2RlKTtcbiAgICB9LFxuXG4gICAgc2NyZWVuQW1vdW50OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMuaGludHMuY2xpZW50SGVpZ2h0IC8gdGhpcy5oaW50cy5maXJzdENoaWxkLm9mZnNldEhlaWdodCkgfHwgMTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gYXBwbGljYWJsZUhlbHBlcnMoY20sIGhlbHBlcnMpIHtcbiAgICBpZiAoIWNtLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHJldHVybiBoZWxwZXJzXG4gICAgdmFyIHJlc3VsdCA9IFtdXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWxwZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgaWYgKGhlbHBlcnNbaV0uc3VwcG9ydHNTZWxlY3Rpb24pIHJlc3VsdC5wdXNoKGhlbHBlcnNbaV0pXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgZnVuY3Rpb24gcmVzb2x2ZUF1dG9IaW50cyhjbSwgcG9zKSB7XG4gICAgdmFyIGhlbHBlcnMgPSBjbS5nZXRIZWxwZXJzKHBvcywgXCJoaW50XCIpLCB3b3Jkc1xuICAgIGlmIChoZWxwZXJzLmxlbmd0aCkge1xuICAgICAgdmFyIGFzeW5jID0gZmFsc2UsIHJlc29sdmVkXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlbHBlcnMubGVuZ3RoOyBpKyspIGlmIChoZWxwZXJzW2ldLmFzeW5jKSBhc3luYyA9IHRydWVcbiAgICAgIGlmIChhc3luYykge1xuICAgICAgICByZXNvbHZlZCA9IGZ1bmN0aW9uKGNtLCBjYWxsYmFjaywgb3B0aW9ucykge1xuICAgICAgICAgIHZhciBhcHAgPSBhcHBsaWNhYmxlSGVscGVycyhjbSwgaGVscGVycylcbiAgICAgICAgICBmdW5jdGlvbiBydW4oaSwgcmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoaSA9PSBhcHAubGVuZ3RoKSByZXR1cm4gY2FsbGJhY2sobnVsbClcbiAgICAgICAgICAgIHZhciBoZWxwZXIgPSBhcHBbaV1cbiAgICAgICAgICAgIGlmIChoZWxwZXIuYXN5bmMpIHtcbiAgICAgICAgICAgICAgaGVscGVyKGNtLCBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSBjYWxsYmFjayhyZXN1bHQpXG4gICAgICAgICAgICAgICAgZWxzZSBydW4oaSArIDEpXG4gICAgICAgICAgICAgIH0sIG9wdGlvbnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyKGNtLCBvcHRpb25zKVxuICAgICAgICAgICAgICBpZiAocmVzdWx0KSBjYWxsYmFjayhyZXN1bHQpXG4gICAgICAgICAgICAgIGVsc2UgcnVuKGkgKyAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBydW4oMClcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlZC5hc3luYyA9IHRydWVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmVkID0gZnVuY3Rpb24oY20sIG9wdGlvbnMpIHtcbiAgICAgICAgICB2YXIgYXBwID0gYXBwbGljYWJsZUhlbHBlcnMoY20sIGhlbHBlcnMpXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcHAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjdXIgPSBhcHBbaV0oY20sIG9wdGlvbnMpXG4gICAgICAgICAgICBpZiAoY3VyICYmIGN1ci5saXN0Lmxlbmd0aCkgcmV0dXJuIGN1clxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzb2x2ZWQuc3VwcG9ydHNTZWxlY3Rpb24gPSB0cnVlXG4gICAgICByZXR1cm4gcmVzb2x2ZWRcbiAgICB9IGVsc2UgaWYgKHdvcmRzID0gY20uZ2V0SGVscGVyKGNtLmdldEN1cnNvcigpLCBcImhpbnRXb3Jkc1wiKSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNtKSB7IHJldHVybiBDb2RlTWlycm9yLmhpbnQuZnJvbUxpc3QoY20sIHt3b3Jkczogd29yZHN9KSB9XG4gICAgfSBlbHNlIGlmIChDb2RlTWlycm9yLmhpbnQuYW55d29yZCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNtLCBvcHRpb25zKSB7IHJldHVybiBDb2RlTWlycm9yLmhpbnQuYW55d29yZChjbSwgb3B0aW9ucykgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7fVxuICAgIH1cbiAgfVxuXG4gIENvZGVNaXJyb3IucmVnaXN0ZXJIZWxwZXIoXCJoaW50XCIsIFwiYXV0b1wiLCB7XG4gICAgcmVzb2x2ZTogcmVzb2x2ZUF1dG9IaW50c1xuICB9KTtcblxuICBDb2RlTWlycm9yLnJlZ2lzdGVySGVscGVyKFwiaGludFwiLCBcImZyb21MaXN0XCIsIGZ1bmN0aW9uKGNtLCBvcHRpb25zKSB7XG4gICAgdmFyIGN1ciA9IGNtLmdldEN1cnNvcigpLCB0b2tlbiA9IGNtLmdldFRva2VuQXQoY3VyKTtcbiAgICB2YXIgdG8gPSBDb2RlTWlycm9yLlBvcyhjdXIubGluZSwgdG9rZW4uZW5kKTtcbiAgICBpZiAodG9rZW4uc3RyaW5nICYmIC9cXHcvLnRlc3QodG9rZW4uc3RyaW5nW3Rva2VuLnN0cmluZy5sZW5ndGggLSAxXSkpIHtcbiAgICAgIHZhciB0ZXJtID0gdG9rZW4uc3RyaW5nLCBmcm9tID0gQ29kZU1pcnJvci5Qb3MoY3VyLmxpbmUsIHRva2VuLnN0YXJ0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHRlcm0gPSBcIlwiLCBmcm9tID0gdG87XG4gICAgfVxuICAgIHZhciBmb3VuZCA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy53b3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHdvcmQgPSBvcHRpb25zLndvcmRzW2ldO1xuICAgICAgaWYgKHdvcmQuc2xpY2UoMCwgdGVybS5sZW5ndGgpID09IHRlcm0pXG4gICAgICAgIGZvdW5kLnB1c2god29yZCk7XG4gICAgfVxuXG4gICAgaWYgKGZvdW5kLmxlbmd0aCkgcmV0dXJuIHtsaXN0OiBmb3VuZCwgZnJvbTogZnJvbSwgdG86IHRvfTtcbiAgfSk7XG5cbiAgQ29kZU1pcnJvci5jb21tYW5kcy5hdXRvY29tcGxldGUgPSBDb2RlTWlycm9yLnNob3dIaW50O1xuXG4gIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBoaW50OiBDb2RlTWlycm9yLmhpbnQuYXV0byxcbiAgICBjb21wbGV0ZVNpbmdsZTogdHJ1ZSxcbiAgICBhbGlnbldpdGhXb3JkOiB0cnVlLFxuICAgIGNsb3NlQ2hhcmFjdGVyczogL1tcXHMoKVxcW1xcXXt9Ozo+LF0vLFxuICAgIGNsb3NlT25VbmZvY3VzOiB0cnVlLFxuICAgIGNvbXBsZXRlT25TaW5nbGVDbGljazogZmFsc2UsXG4gICAgY29udGFpbmVyOiBudWxsLFxuICAgIGN1c3RvbUtleXM6IG51bGwsXG4gICAgZXh0cmFLZXlzOiBudWxsXG4gIH07XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVPcHRpb24oXCJoaW50T3B0aW9uc1wiLCBudWxsKTtcbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4vLyBEZWZpbmUgc2VhcmNoIGNvbW1hbmRzLiBEZXBlbmRzIG9uIGRpYWxvZy5qcyBvciBhbm90aGVyXG4vLyBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgb3BlbkRpYWxvZyBtZXRob2QuXG5cbi8vIFJlcGxhY2Ugd29ya3MgYSBsaXR0bGUgb2RkbHkgLS0gaXQgd2lsbCBkbyB0aGUgcmVwbGFjZSBvbiB0aGUgbmV4dFxuLy8gQ3RybC1HIChvciB3aGF0ZXZlciBpcyBib3VuZCB0byBmaW5kTmV4dCkgcHJlc3MuIFlvdSBwcmV2ZW50IGFcbi8vIHJlcGxhY2UgYnkgbWFraW5nIHN1cmUgdGhlIG1hdGNoIGlzIG5vIGxvbmdlciBzZWxlY3RlZCB3aGVuIGhpdHRpbmdcbi8vIEN0cmwtRy5cblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSwgcmVxdWlyZShcIi4vc2VhcmNoY3Vyc29yXCIpLCByZXF1aXJlKFwiLi4vZGlhbG9nL2RpYWxvZ1wiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiLCBcIi4vc2VhcmNoY3Vyc29yXCIsIFwiLi4vZGlhbG9nL2RpYWxvZ1wiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgZnVuY3Rpb24gc2VhcmNoT3ZlcmxheShxdWVyeSwgY2FzZUluc2Vuc2l0aXZlKSB7XG4gICAgaWYgKHR5cGVvZiBxdWVyeSA9PSBcInN0cmluZ1wiKVxuICAgICAgcXVlcnkgPSBuZXcgUmVnRXhwKHF1ZXJ5LnJlcGxhY2UoL1tcXC1cXFtcXF1cXC9cXHtcXH1cXChcXClcXCpcXCtcXD9cXC5cXFxcXFxeXFwkXFx8XS9nLCBcIlxcXFwkJlwiKSwgY2FzZUluc2Vuc2l0aXZlID8gXCJnaVwiIDogXCJnXCIpO1xuICAgIGVsc2UgaWYgKCFxdWVyeS5nbG9iYWwpXG4gICAgICBxdWVyeSA9IG5ldyBSZWdFeHAocXVlcnkuc291cmNlLCBxdWVyeS5pZ25vcmVDYXNlID8gXCJnaVwiIDogXCJnXCIpO1xuXG4gICAgcmV0dXJuIHt0b2tlbjogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICBxdWVyeS5sYXN0SW5kZXggPSBzdHJlYW0ucG9zO1xuICAgICAgdmFyIG1hdGNoID0gcXVlcnkuZXhlYyhzdHJlYW0uc3RyaW5nKTtcbiAgICAgIGlmIChtYXRjaCAmJiBtYXRjaC5pbmRleCA9PSBzdHJlYW0ucG9zKSB7XG4gICAgICAgIHN0cmVhbS5wb3MgKz0gbWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICByZXR1cm4gXCJzZWFyY2hpbmdcIjtcbiAgICAgIH0gZWxzZSBpZiAobWF0Y2gpIHtcbiAgICAgICAgc3RyZWFtLnBvcyA9IG1hdGNoLmluZGV4O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyZWFtLnNraXBUb0VuZCgpO1xuICAgICAgfVxuICAgIH19O1xuICB9XG5cbiAgZnVuY3Rpb24gU2VhcmNoU3RhdGUoKSB7XG4gICAgdGhpcy5wb3NGcm9tID0gdGhpcy5wb3NUbyA9IHRoaXMubGFzdFF1ZXJ5ID0gdGhpcy5xdWVyeSA9IG51bGw7XG4gICAgdGhpcy5vdmVybGF5ID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNlYXJjaFN0YXRlKGNtKSB7XG4gICAgcmV0dXJuIGNtLnN0YXRlLnNlYXJjaCB8fCAoY20uc3RhdGUuc2VhcmNoID0gbmV3IFNlYXJjaFN0YXRlKCkpO1xuICB9XG5cbiAgZnVuY3Rpb24gcXVlcnlDYXNlSW5zZW5zaXRpdmUocXVlcnkpIHtcbiAgICByZXR1cm4gdHlwZW9mIHF1ZXJ5ID09IFwic3RyaW5nXCIgJiYgcXVlcnkgPT0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNlYXJjaEN1cnNvcihjbSwgcXVlcnksIHBvcykge1xuICAgIC8vIEhldXJpc3RpYzogaWYgdGhlIHF1ZXJ5IHN0cmluZyBpcyBhbGwgbG93ZXJjYXNlLCBkbyBhIGNhc2UgaW5zZW5zaXRpdmUgc2VhcmNoLlxuICAgIHJldHVybiBjbS5nZXRTZWFyY2hDdXJzb3IocXVlcnksIHBvcywgcXVlcnlDYXNlSW5zZW5zaXRpdmUocXVlcnkpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBlcnNpc3RlbnREaWFsb2coY20sIHRleHQsIGRlZmx0LCBmKSB7XG4gICAgY20ub3BlbkRpYWxvZyh0ZXh0LCBmLCB7XG4gICAgICB2YWx1ZTogZGVmbHQsXG4gICAgICBzZWxlY3RWYWx1ZU9uT3BlbjogdHJ1ZSxcbiAgICAgIGNsb3NlT25FbnRlcjogZmFsc2UsXG4gICAgICBvbkNsb3NlOiBmdW5jdGlvbigpIHsgY2xlYXJTZWFyY2goY20pOyB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBkaWFsb2coY20sIHRleHQsIHNob3J0VGV4dCwgZGVmbHQsIGYpIHtcbiAgICBpZiAoY20ub3BlbkRpYWxvZykgY20ub3BlbkRpYWxvZyh0ZXh0LCBmLCB7dmFsdWU6IGRlZmx0LCBzZWxlY3RWYWx1ZU9uT3BlbjogdHJ1ZX0pO1xuICAgIGVsc2UgZihwcm9tcHQoc2hvcnRUZXh0LCBkZWZsdCkpO1xuICB9XG5cbiAgZnVuY3Rpb24gY29uZmlybURpYWxvZyhjbSwgdGV4dCwgc2hvcnRUZXh0LCBmcykge1xuICAgIGlmIChjbS5vcGVuQ29uZmlybSkgY20ub3BlbkNvbmZpcm0odGV4dCwgZnMpO1xuICAgIGVsc2UgaWYgKGNvbmZpcm0oc2hvcnRUZXh0KSkgZnNbMF0oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhcnNlU3RyaW5nKHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvXFxcXCguKS9nLCBmdW5jdGlvbihfLCBjaCkge1xuICAgICAgaWYgKGNoID09IFwiblwiKSByZXR1cm4gXCJcXG5cIlxuICAgICAgaWYgKGNoID09IFwiclwiKSByZXR1cm4gXCJcXHJcIlxuICAgICAgcmV0dXJuIGNoXG4gICAgfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhcnNlUXVlcnkocXVlcnkpIHtcbiAgICB2YXIgaXNSRSA9IHF1ZXJ5Lm1hdGNoKC9eXFwvKC4qKVxcLyhbYS16XSopJC8pO1xuICAgIGlmIChpc1JFKSB7XG4gICAgICB0cnkgeyBxdWVyeSA9IG5ldyBSZWdFeHAoaXNSRVsxXSwgaXNSRVsyXS5pbmRleE9mKFwiaVwiKSA9PSAtMSA/IFwiXCIgOiBcImlcIik7IH1cbiAgICAgIGNhdGNoKGUpIHt9IC8vIE5vdCBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBhZnRlciBhbGwsIGRvIGEgc3RyaW5nIHNlYXJjaFxuICAgIH0gZWxzZSB7XG4gICAgICBxdWVyeSA9IHBhcnNlU3RyaW5nKHF1ZXJ5KVxuICAgIH1cbiAgICBpZiAodHlwZW9mIHF1ZXJ5ID09IFwic3RyaW5nXCIgPyBxdWVyeSA9PSBcIlwiIDogcXVlcnkudGVzdChcIlwiKSlcbiAgICAgIHF1ZXJ5ID0gL3heLztcbiAgICByZXR1cm4gcXVlcnk7XG4gIH1cblxuICB2YXIgcXVlcnlEaWFsb2cgPVxuICAgICdTZWFyY2g6IDxpbnB1dCB0eXBlPVwidGV4dFwiIHN0eWxlPVwid2lkdGg6IDEwZW1cIiBjbGFzcz1cIkNvZGVNaXJyb3Itc2VhcmNoLWZpZWxkXCIvPiA8c3BhbiBzdHlsZT1cImNvbG9yOiAjODg4XCIgY2xhc3M9XCJDb2RlTWlycm9yLXNlYXJjaC1oaW50XCI+KFVzZSAvcmUvIHN5bnRheCBmb3IgcmVnZXhwIHNlYXJjaCk8L3NwYW4+JztcblxuICBmdW5jdGlvbiBzdGFydFNlYXJjaChjbSwgc3RhdGUsIHF1ZXJ5KSB7XG4gICAgc3RhdGUucXVlcnlUZXh0ID0gcXVlcnk7XG4gICAgc3RhdGUucXVlcnkgPSBwYXJzZVF1ZXJ5KHF1ZXJ5KTtcbiAgICBjbS5yZW1vdmVPdmVybGF5KHN0YXRlLm92ZXJsYXksIHF1ZXJ5Q2FzZUluc2Vuc2l0aXZlKHN0YXRlLnF1ZXJ5KSk7XG4gICAgc3RhdGUub3ZlcmxheSA9IHNlYXJjaE92ZXJsYXkoc3RhdGUucXVlcnksIHF1ZXJ5Q2FzZUluc2Vuc2l0aXZlKHN0YXRlLnF1ZXJ5KSk7XG4gICAgY20uYWRkT3ZlcmxheShzdGF0ZS5vdmVybGF5KTtcbiAgICBpZiAoY20uc2hvd01hdGNoZXNPblNjcm9sbGJhcikge1xuICAgICAgaWYgKHN0YXRlLmFubm90YXRlKSB7IHN0YXRlLmFubm90YXRlLmNsZWFyKCk7IHN0YXRlLmFubm90YXRlID0gbnVsbDsgfVxuICAgICAgc3RhdGUuYW5ub3RhdGUgPSBjbS5zaG93TWF0Y2hlc09uU2Nyb2xsYmFyKHN0YXRlLnF1ZXJ5LCBxdWVyeUNhc2VJbnNlbnNpdGl2ZShzdGF0ZS5xdWVyeSkpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGRvU2VhcmNoKGNtLCByZXYsIHBlcnNpc3RlbnQpIHtcbiAgICB2YXIgc3RhdGUgPSBnZXRTZWFyY2hTdGF0ZShjbSk7XG4gICAgaWYgKHN0YXRlLnF1ZXJ5KSByZXR1cm4gZmluZE5leHQoY20sIHJldik7XG4gICAgdmFyIHEgPSBjbS5nZXRTZWxlY3Rpb24oKSB8fCBzdGF0ZS5sYXN0UXVlcnk7XG4gICAgaWYgKHBlcnNpc3RlbnQgJiYgY20ub3BlbkRpYWxvZykge1xuICAgICAgdmFyIGhpZGluZyA9IG51bGxcbiAgICAgIHBlcnNpc3RlbnREaWFsb2coY20sIHF1ZXJ5RGlhbG9nLCBxLCBmdW5jdGlvbihxdWVyeSwgZXZlbnQpIHtcbiAgICAgICAgQ29kZU1pcnJvci5lX3N0b3AoZXZlbnQpO1xuICAgICAgICBpZiAoIXF1ZXJ5KSByZXR1cm47XG4gICAgICAgIGlmIChxdWVyeSAhPSBzdGF0ZS5xdWVyeVRleHQpIHN0YXJ0U2VhcmNoKGNtLCBzdGF0ZSwgcXVlcnkpO1xuICAgICAgICBpZiAoaGlkaW5nKSBoaWRpbmcuc3R5bGUub3BhY2l0eSA9IDFcbiAgICAgICAgZmluZE5leHQoY20sIGV2ZW50LnNoaWZ0S2V5LCBmdW5jdGlvbihfLCB0bykge1xuICAgICAgICAgIHZhciBkaWFsb2dcbiAgICAgICAgICBpZiAodG8ubGluZSA8IDMgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvciAmJlxuICAgICAgICAgICAgICAoZGlhbG9nID0gY20uZGlzcGxheS53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoXCIuQ29kZU1pcnJvci1kaWFsb2dcIikpICYmXG4gICAgICAgICAgICAgIGRpYWxvZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gLSA0ID4gY20uY3Vyc29yQ29vcmRzKHRvLCBcIndpbmRvd1wiKS50b3ApXG4gICAgICAgICAgICAoaGlkaW5nID0gZGlhbG9nKS5zdHlsZS5vcGFjaXR5ID0gLjRcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaWFsb2coY20sIHF1ZXJ5RGlhbG9nLCBcIlNlYXJjaCBmb3I6XCIsIHEsIGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgIGlmIChxdWVyeSAmJiAhc3RhdGUucXVlcnkpIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgICAgICBzdGFydFNlYXJjaChjbSwgc3RhdGUsIHF1ZXJ5KTtcbiAgICAgICAgICBzdGF0ZS5wb3NGcm9tID0gc3RhdGUucG9zVG8gPSBjbS5nZXRDdXJzb3IoKTtcbiAgICAgICAgICBmaW5kTmV4dChjbSwgcmV2KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBmaW5kTmV4dChjbSwgcmV2LCBjYWxsYmFjaykge2NtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RhdGUgPSBnZXRTZWFyY2hTdGF0ZShjbSk7XG4gICAgdmFyIGN1cnNvciA9IGdldFNlYXJjaEN1cnNvcihjbSwgc3RhdGUucXVlcnksIHJldiA/IHN0YXRlLnBvc0Zyb20gOiBzdGF0ZS5wb3NUbyk7XG4gICAgaWYgKCFjdXJzb3IuZmluZChyZXYpKSB7XG4gICAgICBjdXJzb3IgPSBnZXRTZWFyY2hDdXJzb3IoY20sIHN0YXRlLnF1ZXJ5LCByZXYgPyBDb2RlTWlycm9yLlBvcyhjbS5sYXN0TGluZSgpKSA6IENvZGVNaXJyb3IuUG9zKGNtLmZpcnN0TGluZSgpLCAwKSk7XG4gICAgICBpZiAoIWN1cnNvci5maW5kKHJldikpIHJldHVybjtcbiAgICB9XG4gICAgY20uc2V0U2VsZWN0aW9uKGN1cnNvci5mcm9tKCksIGN1cnNvci50bygpKTtcbiAgICBjbS5zY3JvbGxJbnRvVmlldyh7ZnJvbTogY3Vyc29yLmZyb20oKSwgdG86IGN1cnNvci50bygpfSwgMjApO1xuICAgIHN0YXRlLnBvc0Zyb20gPSBjdXJzb3IuZnJvbSgpOyBzdGF0ZS5wb3NUbyA9IGN1cnNvci50bygpO1xuICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soY3Vyc29yLmZyb20oKSwgY3Vyc29yLnRvKCkpXG4gIH0pO31cblxuICBmdW5jdGlvbiBjbGVhclNlYXJjaChjbSkge2NtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RhdGUgPSBnZXRTZWFyY2hTdGF0ZShjbSk7XG4gICAgc3RhdGUubGFzdFF1ZXJ5ID0gc3RhdGUucXVlcnk7XG4gICAgaWYgKCFzdGF0ZS5xdWVyeSkgcmV0dXJuO1xuICAgIHN0YXRlLnF1ZXJ5ID0gc3RhdGUucXVlcnlUZXh0ID0gbnVsbDtcbiAgICBjbS5yZW1vdmVPdmVybGF5KHN0YXRlLm92ZXJsYXkpO1xuICAgIGlmIChzdGF0ZS5hbm5vdGF0ZSkgeyBzdGF0ZS5hbm5vdGF0ZS5jbGVhcigpOyBzdGF0ZS5hbm5vdGF0ZSA9IG51bGw7IH1cbiAgfSk7fVxuXG4gIHZhciByZXBsYWNlUXVlcnlEaWFsb2cgPVxuICAgICcgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgc3R5bGU9XCJ3aWR0aDogMTBlbVwiIGNsYXNzPVwiQ29kZU1pcnJvci1zZWFyY2gtZmllbGRcIi8+IDxzcGFuIHN0eWxlPVwiY29sb3I6ICM4ODhcIiBjbGFzcz1cIkNvZGVNaXJyb3Itc2VhcmNoLWhpbnRcIj4oVXNlIC9yZS8gc3ludGF4IGZvciByZWdleHAgc2VhcmNoKTwvc3Bhbj4nO1xuICB2YXIgcmVwbGFjZW1lbnRRdWVyeURpYWxvZyA9ICdXaXRoOiA8aW5wdXQgdHlwZT1cInRleHRcIiBzdHlsZT1cIndpZHRoOiAxMGVtXCIgY2xhc3M9XCJDb2RlTWlycm9yLXNlYXJjaC1maWVsZFwiLz4nO1xuICB2YXIgZG9SZXBsYWNlQ29uZmlybSA9IFwiUmVwbGFjZT8gPGJ1dHRvbj5ZZXM8L2J1dHRvbj4gPGJ1dHRvbj5ObzwvYnV0dG9uPiA8YnV0dG9uPkFsbDwvYnV0dG9uPiA8YnV0dG9uPlN0b3A8L2J1dHRvbj5cIjtcblxuICBmdW5jdGlvbiByZXBsYWNlQWxsKGNtLCBxdWVyeSwgdGV4dCkge1xuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIGZvciAodmFyIGN1cnNvciA9IGdldFNlYXJjaEN1cnNvcihjbSwgcXVlcnkpOyBjdXJzb3IuZmluZE5leHQoKTspIHtcbiAgICAgICAgaWYgKHR5cGVvZiBxdWVyeSAhPSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgdmFyIG1hdGNoID0gY20uZ2V0UmFuZ2UoY3Vyc29yLmZyb20oKSwgY3Vyc29yLnRvKCkpLm1hdGNoKHF1ZXJ5KTtcbiAgICAgICAgICBjdXJzb3IucmVwbGFjZSh0ZXh0LnJlcGxhY2UoL1xcJChcXGQpL2csIGZ1bmN0aW9uKF8sIGkpIHtyZXR1cm4gbWF0Y2hbaV07fSkpO1xuICAgICAgICB9IGVsc2UgY3Vyc29yLnJlcGxhY2UodGV4dCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXBsYWNlKGNtLCBhbGwpIHtcbiAgICBpZiAoY20uZ2V0T3B0aW9uKFwicmVhZE9ubHlcIikpIHJldHVybjtcbiAgICB2YXIgcXVlcnkgPSBjbS5nZXRTZWxlY3Rpb24oKSB8fCBnZXRTZWFyY2hTdGF0ZShjbSkubGFzdFF1ZXJ5O1xuICAgIHZhciBkaWFsb2dUZXh0ID0gYWxsID8gXCJSZXBsYWNlIGFsbDpcIiA6IFwiUmVwbGFjZTpcIlxuICAgIGRpYWxvZyhjbSwgZGlhbG9nVGV4dCArIHJlcGxhY2VRdWVyeURpYWxvZywgZGlhbG9nVGV4dCwgcXVlcnksIGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICBpZiAoIXF1ZXJ5KSByZXR1cm47XG4gICAgICBxdWVyeSA9IHBhcnNlUXVlcnkocXVlcnkpO1xuICAgICAgZGlhbG9nKGNtLCByZXBsYWNlbWVudFF1ZXJ5RGlhbG9nLCBcIlJlcGxhY2Ugd2l0aDpcIiwgXCJcIiwgZnVuY3Rpb24odGV4dCkge1xuICAgICAgICB0ZXh0ID0gcGFyc2VTdHJpbmcodGV4dClcbiAgICAgICAgaWYgKGFsbCkge1xuICAgICAgICAgIHJlcGxhY2VBbGwoY20sIHF1ZXJ5LCB0ZXh0KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNsZWFyU2VhcmNoKGNtKTtcbiAgICAgICAgICB2YXIgY3Vyc29yID0gZ2V0U2VhcmNoQ3Vyc29yKGNtLCBxdWVyeSwgY20uZ2V0Q3Vyc29yKCkpO1xuICAgICAgICAgIHZhciBhZHZhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBjdXJzb3IuZnJvbSgpLCBtYXRjaDtcbiAgICAgICAgICAgIGlmICghKG1hdGNoID0gY3Vyc29yLmZpbmROZXh0KCkpKSB7XG4gICAgICAgICAgICAgIGN1cnNvciA9IGdldFNlYXJjaEN1cnNvcihjbSwgcXVlcnkpO1xuICAgICAgICAgICAgICBpZiAoIShtYXRjaCA9IGN1cnNvci5maW5kTmV4dCgpKSB8fFxuICAgICAgICAgICAgICAgICAgKHN0YXJ0ICYmIGN1cnNvci5mcm9tKCkubGluZSA9PSBzdGFydC5saW5lICYmIGN1cnNvci5mcm9tKCkuY2ggPT0gc3RhcnQuY2gpKSByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjbS5zZXRTZWxlY3Rpb24oY3Vyc29yLmZyb20oKSwgY3Vyc29yLnRvKCkpO1xuICAgICAgICAgICAgY20uc2Nyb2xsSW50b1ZpZXcoe2Zyb206IGN1cnNvci5mcm9tKCksIHRvOiBjdXJzb3IudG8oKX0pO1xuICAgICAgICAgICAgY29uZmlybURpYWxvZyhjbSwgZG9SZXBsYWNlQ29uZmlybSwgXCJSZXBsYWNlP1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBbZnVuY3Rpb24oKSB7ZG9SZXBsYWNlKG1hdGNoKTt9LCBhZHZhbmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7cmVwbGFjZUFsbChjbSwgcXVlcnksIHRleHQpfV0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIGRvUmVwbGFjZSA9IGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICAgICAgICBjdXJzb3IucmVwbGFjZSh0eXBlb2YgcXVlcnkgPT0gXCJzdHJpbmdcIiA/IHRleHQgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5yZXBsYWNlKC9cXCQoXFxkKS9nLCBmdW5jdGlvbihfLCBpKSB7cmV0dXJuIG1hdGNoW2ldO30pKTtcbiAgICAgICAgICAgIGFkdmFuY2UoKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGFkdmFuY2UoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBDb2RlTWlycm9yLmNvbW1hbmRzLmZpbmQgPSBmdW5jdGlvbihjbSkge2NsZWFyU2VhcmNoKGNtKTsgZG9TZWFyY2goY20pO307XG4gIENvZGVNaXJyb3IuY29tbWFuZHMuZmluZFBlcnNpc3RlbnQgPSBmdW5jdGlvbihjbSkge2NsZWFyU2VhcmNoKGNtKTsgZG9TZWFyY2goY20sIGZhbHNlLCB0cnVlKTt9O1xuICBDb2RlTWlycm9yLmNvbW1hbmRzLmZpbmROZXh0ID0gZG9TZWFyY2g7XG4gIENvZGVNaXJyb3IuY29tbWFuZHMuZmluZFByZXYgPSBmdW5jdGlvbihjbSkge2RvU2VhcmNoKGNtLCB0cnVlKTt9O1xuICBDb2RlTWlycm9yLmNvbW1hbmRzLmNsZWFyU2VhcmNoID0gY2xlYXJTZWFyY2g7XG4gIENvZGVNaXJyb3IuY29tbWFuZHMucmVwbGFjZSA9IHJlcGxhY2U7XG4gIENvZGVNaXJyb3IuY29tbWFuZHMucmVwbGFjZUFsbCA9IGZ1bmN0aW9uKGNtKSB7cmVwbGFjZShjbSwgdHJ1ZSk7fTtcbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCIpKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkgLy8gQU1EXG4gICAgZGVmaW5lKFtcIi4uLy4uL2xpYi9jb2RlbWlycm9yXCJdLCBtb2QpO1xuICBlbHNlIC8vIFBsYWluIGJyb3dzZXIgZW52XG4gICAgbW9kKENvZGVNaXJyb3IpO1xufSkoZnVuY3Rpb24oQ29kZU1pcnJvcikge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgdmFyIFBvcyA9IENvZGVNaXJyb3IuUG9zO1xuXG4gIGZ1bmN0aW9uIFNlYXJjaEN1cnNvcihkb2MsIHF1ZXJ5LCBwb3MsIGNhc2VGb2xkKSB7XG4gICAgdGhpcy5hdE9jY3VycmVuY2UgPSBmYWxzZTsgdGhpcy5kb2MgPSBkb2M7XG4gICAgaWYgKGNhc2VGb2xkID09IG51bGwgJiYgdHlwZW9mIHF1ZXJ5ID09IFwic3RyaW5nXCIpIGNhc2VGb2xkID0gZmFsc2U7XG5cbiAgICBwb3MgPSBwb3MgPyBkb2MuY2xpcFBvcyhwb3MpIDogUG9zKDAsIDApO1xuICAgIHRoaXMucG9zID0ge2Zyb206IHBvcywgdG86IHBvc307XG5cbiAgICAvLyBUaGUgbWF0Y2hlcyBtZXRob2QgaXMgZmlsbGVkIGluIGJhc2VkIG9uIHRoZSB0eXBlIG9mIHF1ZXJ5LlxuICAgIC8vIEl0IHRha2VzIGEgcG9zaXRpb24gYW5kIGEgZGlyZWN0aW9uLCBhbmQgcmV0dXJucyBhbiBvYmplY3RcbiAgICAvLyBkZXNjcmliaW5nIHRoZSBuZXh0IG9jY3VycmVuY2Ugb2YgdGhlIHF1ZXJ5LCBvciBudWxsIGlmIG5vXG4gICAgLy8gbW9yZSBtYXRjaGVzIHdlcmUgZm91bmQuXG4gICAgaWYgKHR5cGVvZiBxdWVyeSAhPSBcInN0cmluZ1wiKSB7IC8vIFJlZ2V4cCBtYXRjaFxuICAgICAgaWYgKCFxdWVyeS5nbG9iYWwpIHF1ZXJ5ID0gbmV3IFJlZ0V4cChxdWVyeS5zb3VyY2UsIHF1ZXJ5Lmlnbm9yZUNhc2UgPyBcImlnXCIgOiBcImdcIik7XG4gICAgICB0aGlzLm1hdGNoZXMgPSBmdW5jdGlvbihyZXZlcnNlLCBwb3MpIHtcbiAgICAgICAgaWYgKHJldmVyc2UpIHtcbiAgICAgICAgICBxdWVyeS5sYXN0SW5kZXggPSAwO1xuICAgICAgICAgIHZhciBsaW5lID0gZG9jLmdldExpbmUocG9zLmxpbmUpLnNsaWNlKDAsIHBvcy5jaCksIGN1dE9mZiA9IDAsIG1hdGNoLCBzdGFydDtcbiAgICAgICAgICBmb3IgKDs7KSB7XG4gICAgICAgICAgICBxdWVyeS5sYXN0SW5kZXggPSBjdXRPZmY7XG4gICAgICAgICAgICB2YXIgbmV3TWF0Y2ggPSBxdWVyeS5leGVjKGxpbmUpO1xuICAgICAgICAgICAgaWYgKCFuZXdNYXRjaCkgYnJlYWs7XG4gICAgICAgICAgICBtYXRjaCA9IG5ld01hdGNoO1xuICAgICAgICAgICAgc3RhcnQgPSBtYXRjaC5pbmRleDtcbiAgICAgICAgICAgIGN1dE9mZiA9IG1hdGNoLmluZGV4ICsgKG1hdGNoWzBdLmxlbmd0aCB8fCAxKTtcbiAgICAgICAgICAgIGlmIChjdXRPZmYgPT0gbGluZS5sZW5ndGgpIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbWF0Y2hMZW4gPSAobWF0Y2ggJiYgbWF0Y2hbMF0ubGVuZ3RoKSB8fCAwO1xuICAgICAgICAgIGlmICghbWF0Y2hMZW4pIHtcbiAgICAgICAgICAgIGlmIChzdGFydCA9PSAwICYmIGxpbmUubGVuZ3RoID09IDApIHttYXRjaCA9IHVuZGVmaW5lZDt9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydCAhPSBkb2MuZ2V0TGluZShwb3MubGluZSkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIG1hdGNoTGVuKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHF1ZXJ5Lmxhc3RJbmRleCA9IHBvcy5jaDtcbiAgICAgICAgICB2YXIgbGluZSA9IGRvYy5nZXRMaW5lKHBvcy5saW5lKSwgbWF0Y2ggPSBxdWVyeS5leGVjKGxpbmUpO1xuICAgICAgICAgIHZhciBtYXRjaExlbiA9IChtYXRjaCAmJiBtYXRjaFswXS5sZW5ndGgpIHx8IDA7XG4gICAgICAgICAgdmFyIHN0YXJ0ID0gbWF0Y2ggJiYgbWF0Y2guaW5kZXg7XG4gICAgICAgICAgaWYgKHN0YXJ0ICsgbWF0Y2hMZW4gIT0gbGluZS5sZW5ndGggJiYgIW1hdGNoTGVuKSBtYXRjaExlbiA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoTGVuKVxuICAgICAgICAgIHJldHVybiB7ZnJvbTogUG9zKHBvcy5saW5lLCBzdGFydCksXG4gICAgICAgICAgICAgICAgICB0bzogUG9zKHBvcy5saW5lLCBzdGFydCArIG1hdGNoTGVuKSxcbiAgICAgICAgICAgICAgICAgIG1hdGNoOiBtYXRjaH07XG4gICAgICB9O1xuICAgIH0gZWxzZSB7IC8vIFN0cmluZyBxdWVyeVxuICAgICAgdmFyIG9yaWdRdWVyeSA9IHF1ZXJ5O1xuICAgICAgaWYgKGNhc2VGb2xkKSBxdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICB2YXIgZm9sZCA9IGNhc2VGb2xkID8gZnVuY3Rpb24oc3RyKXtyZXR1cm4gc3RyLnRvTG93ZXJDYXNlKCk7fSA6IGZ1bmN0aW9uKHN0cil7cmV0dXJuIHN0cjt9O1xuICAgICAgdmFyIHRhcmdldCA9IHF1ZXJ5LnNwbGl0KFwiXFxuXCIpO1xuICAgICAgLy8gRGlmZmVyZW50IG1ldGhvZHMgZm9yIHNpbmdsZS1saW5lIGFuZCBtdWx0aS1saW5lIHF1ZXJpZXNcbiAgICAgIGlmICh0YXJnZXQubGVuZ3RoID09IDEpIHtcbiAgICAgICAgaWYgKCFxdWVyeS5sZW5ndGgpIHtcbiAgICAgICAgICAvLyBFbXB0eSBzdHJpbmcgd291bGQgbWF0Y2ggYW55dGhpbmcgYW5kIG5ldmVyIHByb2dyZXNzLCBzb1xuICAgICAgICAgIC8vIHdlIGRlZmluZSBpdCB0byBtYXRjaCBub3RoaW5nIGluc3RlYWQuXG4gICAgICAgICAgdGhpcy5tYXRjaGVzID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm1hdGNoZXMgPSBmdW5jdGlvbihyZXZlcnNlLCBwb3MpIHtcbiAgICAgICAgICAgIGlmIChyZXZlcnNlKSB7XG4gICAgICAgICAgICAgIHZhciBvcmlnID0gZG9jLmdldExpbmUocG9zLmxpbmUpLnNsaWNlKDAsIHBvcy5jaCksIGxpbmUgPSBmb2xkKG9yaWcpO1xuICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBsaW5lLmxhc3RJbmRleE9mKHF1ZXJ5KTtcbiAgICAgICAgICAgICAgaWYgKG1hdGNoID4gLTEpIHtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IGFkanVzdFBvcyhvcmlnLCBsaW5lLCBtYXRjaCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtmcm9tOiBQb3MocG9zLmxpbmUsIG1hdGNoKSwgdG86IFBvcyhwb3MubGluZSwgbWF0Y2ggKyBvcmlnUXVlcnkubGVuZ3RoKX07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgdmFyIG9yaWcgPSBkb2MuZ2V0TGluZShwb3MubGluZSkuc2xpY2UocG9zLmNoKSwgbGluZSA9IGZvbGQob3JpZyk7XG4gICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBsaW5lLmluZGV4T2YocXVlcnkpO1xuICAgICAgICAgICAgICAgaWYgKG1hdGNoID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgbWF0Y2ggPSBhZGp1c3RQb3Mob3JpZywgbGluZSwgbWF0Y2gpICsgcG9zLmNoO1xuICAgICAgICAgICAgICAgICByZXR1cm4ge2Zyb206IFBvcyhwb3MubGluZSwgbWF0Y2gpLCB0bzogUG9zKHBvcy5saW5lLCBtYXRjaCArIG9yaWdRdWVyeS5sZW5ndGgpfTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgb3JpZ1RhcmdldCA9IG9yaWdRdWVyeS5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgdGhpcy5tYXRjaGVzID0gZnVuY3Rpb24ocmV2ZXJzZSwgcG9zKSB7XG4gICAgICAgICAgdmFyIGxhc3QgPSB0YXJnZXQubGVuZ3RoIC0gMTtcbiAgICAgICAgICBpZiAocmV2ZXJzZSkge1xuICAgICAgICAgICAgaWYgKHBvcy5saW5lIC0gKHRhcmdldC5sZW5ndGggLSAxKSA8IGRvYy5maXJzdExpbmUoKSkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGZvbGQoZG9jLmdldExpbmUocG9zLmxpbmUpLnNsaWNlKDAsIG9yaWdUYXJnZXRbbGFzdF0ubGVuZ3RoKSkgIT0gdGFyZ2V0W3RhcmdldC5sZW5ndGggLSAxXSkgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIHRvID0gUG9zKHBvcy5saW5lLCBvcmlnVGFyZ2V0W2xhc3RdLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKHZhciBsbiA9IHBvcy5saW5lIC0gMSwgaSA9IGxhc3QgLSAxOyBpID49IDE7IC0taSwgLS1sbilcbiAgICAgICAgICAgICAgaWYgKHRhcmdldFtpXSAhPSBmb2xkKGRvYy5nZXRMaW5lKGxuKSkpIHJldHVybjtcbiAgICAgICAgICAgIHZhciBsaW5lID0gZG9jLmdldExpbmUobG4pLCBjdXQgPSBsaW5lLmxlbmd0aCAtIG9yaWdUYXJnZXRbMF0ubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGZvbGQobGluZS5zbGljZShjdXQpKSAhPSB0YXJnZXRbMF0pIHJldHVybjtcbiAgICAgICAgICAgIHJldHVybiB7ZnJvbTogUG9zKGxuLCBjdXQpLCB0bzogdG99O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAocG9zLmxpbmUgKyAodGFyZ2V0Lmxlbmd0aCAtIDEpID4gZG9jLmxhc3RMaW5lKCkpIHJldHVybjtcbiAgICAgICAgICAgIHZhciBsaW5lID0gZG9jLmdldExpbmUocG9zLmxpbmUpLCBjdXQgPSBsaW5lLmxlbmd0aCAtIG9yaWdUYXJnZXRbMF0ubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGZvbGQobGluZS5zbGljZShjdXQpKSAhPSB0YXJnZXRbMF0pIHJldHVybjtcbiAgICAgICAgICAgIHZhciBmcm9tID0gUG9zKHBvcy5saW5lLCBjdXQpO1xuICAgICAgICAgICAgZm9yICh2YXIgbG4gPSBwb3MubGluZSArIDEsIGkgPSAxOyBpIDwgbGFzdDsgKytpLCArK2xuKVxuICAgICAgICAgICAgICBpZiAodGFyZ2V0W2ldICE9IGZvbGQoZG9jLmdldExpbmUobG4pKSkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKGZvbGQoZG9jLmdldExpbmUobG4pLnNsaWNlKDAsIG9yaWdUYXJnZXRbbGFzdF0ubGVuZ3RoKSkgIT0gdGFyZ2V0W2xhc3RdKSByZXR1cm47XG4gICAgICAgICAgICByZXR1cm4ge2Zyb206IGZyb20sIHRvOiBQb3MobG4sIG9yaWdUYXJnZXRbbGFzdF0ubGVuZ3RoKX07XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIFNlYXJjaEN1cnNvci5wcm90b3R5cGUgPSB7XG4gICAgZmluZE5leHQ6IGZ1bmN0aW9uKCkge3JldHVybiB0aGlzLmZpbmQoZmFsc2UpO30sXG4gICAgZmluZFByZXZpb3VzOiBmdW5jdGlvbigpIHtyZXR1cm4gdGhpcy5maW5kKHRydWUpO30sXG5cbiAgICBmaW5kOiBmdW5jdGlvbihyZXZlcnNlKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXMsIHBvcyA9IHRoaXMuZG9jLmNsaXBQb3MocmV2ZXJzZSA/IHRoaXMucG9zLmZyb20gOiB0aGlzLnBvcy50byk7XG4gICAgICBmdW5jdGlvbiBzYXZlUG9zQW5kRmFpbChsaW5lKSB7XG4gICAgICAgIHZhciBwb3MgPSBQb3MobGluZSwgMCk7XG4gICAgICAgIHNlbGYucG9zID0ge2Zyb206IHBvcywgdG86IHBvc307XG4gICAgICAgIHNlbGYuYXRPY2N1cnJlbmNlID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgZm9yICg7Oykge1xuICAgICAgICBpZiAodGhpcy5wb3MgPSB0aGlzLm1hdGNoZXMocmV2ZXJzZSwgcG9zKSkge1xuICAgICAgICAgIHRoaXMuYXRPY2N1cnJlbmNlID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5wb3MubWF0Y2ggfHwgdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmV2ZXJzZSkge1xuICAgICAgICAgIGlmICghcG9zLmxpbmUpIHJldHVybiBzYXZlUG9zQW5kRmFpbCgwKTtcbiAgICAgICAgICBwb3MgPSBQb3MocG9zLmxpbmUtMSwgdGhpcy5kb2MuZ2V0TGluZShwb3MubGluZS0xKS5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhciBtYXhMaW5lID0gdGhpcy5kb2MubGluZUNvdW50KCk7XG4gICAgICAgICAgaWYgKHBvcy5saW5lID09IG1heExpbmUgLSAxKSByZXR1cm4gc2F2ZVBvc0FuZEZhaWwobWF4TGluZSk7XG4gICAgICAgICAgcG9zID0gUG9zKHBvcy5saW5lICsgMSwgMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZnJvbTogZnVuY3Rpb24oKSB7aWYgKHRoaXMuYXRPY2N1cnJlbmNlKSByZXR1cm4gdGhpcy5wb3MuZnJvbTt9LFxuICAgIHRvOiBmdW5jdGlvbigpIHtpZiAodGhpcy5hdE9jY3VycmVuY2UpIHJldHVybiB0aGlzLnBvcy50bzt9LFxuXG4gICAgcmVwbGFjZTogZnVuY3Rpb24obmV3VGV4dCwgb3JpZ2luKSB7XG4gICAgICBpZiAoIXRoaXMuYXRPY2N1cnJlbmNlKSByZXR1cm47XG4gICAgICB2YXIgbGluZXMgPSBDb2RlTWlycm9yLnNwbGl0TGluZXMobmV3VGV4dCk7XG4gICAgICB0aGlzLmRvYy5yZXBsYWNlUmFuZ2UobGluZXMsIHRoaXMucG9zLmZyb20sIHRoaXMucG9zLnRvLCBvcmlnaW4pO1xuICAgICAgdGhpcy5wb3MudG8gPSBQb3ModGhpcy5wb3MuZnJvbS5saW5lICsgbGluZXMubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLmxlbmd0aCArIChsaW5lcy5sZW5ndGggPT0gMSA/IHRoaXMucG9zLmZyb20uY2ggOiAwKSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIE1hcHMgYSBwb3NpdGlvbiBpbiBhIGNhc2UtZm9sZGVkIGxpbmUgYmFjayB0byBhIHBvc2l0aW9uIGluIHRoZSBvcmlnaW5hbCBsaW5lXG4gIC8vIChjb21wZW5zYXRpbmcgZm9yIGNvZGVwb2ludHMgaW5jcmVhc2luZyBpbiBudW1iZXIgZHVyaW5nIGZvbGRpbmcpXG4gIGZ1bmN0aW9uIGFkanVzdFBvcyhvcmlnLCBmb2xkZWQsIHBvcykge1xuICAgIGlmIChvcmlnLmxlbmd0aCA9PSBmb2xkZWQubGVuZ3RoKSByZXR1cm4gcG9zO1xuICAgIGZvciAodmFyIHBvczEgPSBNYXRoLm1pbihwb3MsIG9yaWcubGVuZ3RoKTs7KSB7XG4gICAgICB2YXIgbGVuMSA9IG9yaWcuc2xpY2UoMCwgcG9zMSkudG9Mb3dlckNhc2UoKS5sZW5ndGg7XG4gICAgICBpZiAobGVuMSA8IHBvcykgKytwb3MxO1xuICAgICAgZWxzZSBpZiAobGVuMSA+IHBvcykgLS1wb3MxO1xuICAgICAgZWxzZSByZXR1cm4gcG9zMTtcbiAgICB9XG4gIH1cblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcImdldFNlYXJjaEN1cnNvclwiLCBmdW5jdGlvbihxdWVyeSwgcG9zLCBjYXNlRm9sZCkge1xuICAgIHJldHVybiBuZXcgU2VhcmNoQ3Vyc29yKHRoaXMuZG9jLCBxdWVyeSwgcG9zLCBjYXNlRm9sZCk7XG4gIH0pO1xuICBDb2RlTWlycm9yLmRlZmluZURvY0V4dGVuc2lvbihcImdldFNlYXJjaEN1cnNvclwiLCBmdW5jdGlvbihxdWVyeSwgcG9zLCBjYXNlRm9sZCkge1xuICAgIHJldHVybiBuZXcgU2VhcmNoQ3Vyc29yKHRoaXMsIHF1ZXJ5LCBwb3MsIGNhc2VGb2xkKTtcbiAgfSk7XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24oXCJzZWxlY3RNYXRjaGVzXCIsIGZ1bmN0aW9uKHF1ZXJ5LCBjYXNlRm9sZCkge1xuICAgIHZhciByYW5nZXMgPSBbXTtcbiAgICB2YXIgY3VyID0gdGhpcy5nZXRTZWFyY2hDdXJzb3IocXVlcnksIHRoaXMuZ2V0Q3Vyc29yKFwiZnJvbVwiKSwgY2FzZUZvbGQpO1xuICAgIHdoaWxlIChjdXIuZmluZE5leHQoKSkge1xuICAgICAgaWYgKENvZGVNaXJyb3IuY21wUG9zKGN1ci50bygpLCB0aGlzLmdldEN1cnNvcihcInRvXCIpKSA+IDApIGJyZWFrO1xuICAgICAgcmFuZ2VzLnB1c2goe2FuY2hvcjogY3VyLmZyb20oKSwgaGVhZDogY3VyLnRvKCl9KTtcbiAgICB9XG4gICAgaWYgKHJhbmdlcy5sZW5ndGgpXG4gICAgICB0aGlzLnNldFNlbGVjdGlvbnMocmFuZ2VzLCAwKTtcbiAgfSk7XG59KTtcbiIsIi8vIENvZGVNaXJyb3IsIGNvcHlyaWdodCAoYykgYnkgTWFyaWpuIEhhdmVyYmVrZSBhbmQgb3RoZXJzXG4vLyBEaXN0cmlidXRlZCB1bmRlciBhbiBNSVQgbGljZW5zZTogaHR0cDovL2NvZGVtaXJyb3IubmV0L0xJQ0VOU0VcblxuKGZ1bmN0aW9uKG1vZCkge1xuICBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIC8vIENvbW1vbkpTXG4gICAgbW9kKHJlcXVpcmUoXCIuLi8uLi9saWIvY29kZW1pcnJvclwiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi8uLi9saWIvY29kZW1pcnJvclwiXSwgbW9kKTtcbiAgZWxzZSAvLyBQbGFpbiBicm93c2VyIGVudlxuICAgIG1vZChDb2RlTWlycm9yKTtcbn0pKGZ1bmN0aW9uKENvZGVNaXJyb3IpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIFBvcyA9IENvZGVNaXJyb3IuUG9zO1xuXG4gIGZ1bmN0aW9uIGZpbmRQYXJhZ3JhcGgoY20sIHBvcywgb3B0aW9ucykge1xuICAgIHZhciBzdGFydFJFID0gb3B0aW9ucy5wYXJhZ3JhcGhTdGFydCB8fCBjbS5nZXRIZWxwZXIocG9zLCBcInBhcmFncmFwaFN0YXJ0XCIpO1xuICAgIGZvciAodmFyIHN0YXJ0ID0gcG9zLmxpbmUsIGZpcnN0ID0gY20uZmlyc3RMaW5lKCk7IHN0YXJ0ID4gZmlyc3Q7IC0tc3RhcnQpIHtcbiAgICAgIHZhciBsaW5lID0gY20uZ2V0TGluZShzdGFydCk7XG4gICAgICBpZiAoc3RhcnRSRSAmJiBzdGFydFJFLnRlc3QobGluZSkpIGJyZWFrO1xuICAgICAgaWYgKCEvXFxTLy50ZXN0KGxpbmUpKSB7ICsrc3RhcnQ7IGJyZWFrOyB9XG4gICAgfVxuICAgIHZhciBlbmRSRSA9IG9wdGlvbnMucGFyYWdyYXBoRW5kIHx8IGNtLmdldEhlbHBlcihwb3MsIFwicGFyYWdyYXBoRW5kXCIpO1xuICAgIGZvciAodmFyIGVuZCA9IHBvcy5saW5lICsgMSwgbGFzdCA9IGNtLmxhc3RMaW5lKCk7IGVuZCA8PSBsYXN0OyArK2VuZCkge1xuICAgICAgdmFyIGxpbmUgPSBjbS5nZXRMaW5lKGVuZCk7XG4gICAgICBpZiAoZW5kUkUgJiYgZW5kUkUudGVzdChsaW5lKSkgeyArK2VuZDsgYnJlYWs7IH1cbiAgICAgIGlmICghL1xcUy8udGVzdChsaW5lKSkgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiB7ZnJvbTogc3RhcnQsIHRvOiBlbmR9O1xuICB9XG5cbiAgZnVuY3Rpb24gZmluZEJyZWFrUG9pbnQodGV4dCwgY29sdW1uLCB3cmFwT24sIGtpbGxUcmFpbGluZ1NwYWNlKSB7XG4gICAgZm9yICh2YXIgYXQgPSBjb2x1bW47IGF0ID4gMDsgLS1hdClcbiAgICAgIGlmICh3cmFwT24udGVzdCh0ZXh0LnNsaWNlKGF0IC0gMSwgYXQgKyAxKSkpIGJyZWFrO1xuICAgIGZvciAodmFyIGZpcnN0ID0gdHJ1ZTs7IGZpcnN0ID0gZmFsc2UpIHtcbiAgICAgIHZhciBlbmRPZlRleHQgPSBhdDtcbiAgICAgIGlmIChraWxsVHJhaWxpbmdTcGFjZSlcbiAgICAgICAgd2hpbGUgKHRleHQuY2hhckF0KGVuZE9mVGV4dCAtIDEpID09IFwiIFwiKSAtLWVuZE9mVGV4dDtcbiAgICAgIGlmIChlbmRPZlRleHQgPT0gMCAmJiBmaXJzdCkgYXQgPSBjb2x1bW47XG4gICAgICBlbHNlIHJldHVybiB7ZnJvbTogZW5kT2ZUZXh0LCB0bzogYXR9O1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHdyYXBSYW5nZShjbSwgZnJvbSwgdG8sIG9wdGlvbnMpIHtcbiAgICBmcm9tID0gY20uY2xpcFBvcyhmcm9tKTsgdG8gPSBjbS5jbGlwUG9zKHRvKTtcbiAgICB2YXIgY29sdW1uID0gb3B0aW9ucy5jb2x1bW4gfHwgODA7XG4gICAgdmFyIHdyYXBPbiA9IG9wdGlvbnMud3JhcE9uIHx8IC9cXHNcXFN8LVteXFwuXFxkXS87XG4gICAgdmFyIGtpbGxUcmFpbGluZyA9IG9wdGlvbnMua2lsbFRyYWlsaW5nU3BhY2UgIT09IGZhbHNlO1xuICAgIHZhciBjaGFuZ2VzID0gW10sIGN1ckxpbmUgPSBcIlwiLCBjdXJObyA9IGZyb20ubGluZTtcbiAgICB2YXIgbGluZXMgPSBjbS5nZXRSYW5nZShmcm9tLCB0bywgZmFsc2UpO1xuICAgIGlmICghbGluZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgbGVhZGluZ1NwYWNlID0gbGluZXNbMF0ubWF0Y2goL15bIFxcdF0qLylbMF07XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgdGV4dCA9IGxpbmVzW2ldLCBvbGRMZW4gPSBjdXJMaW5lLmxlbmd0aCwgc3BhY2VJbnNlcnRlZCA9IDA7XG4gICAgICBpZiAoY3VyTGluZSAmJiB0ZXh0ICYmICF3cmFwT24udGVzdChjdXJMaW5lLmNoYXJBdChjdXJMaW5lLmxlbmd0aCAtIDEpICsgdGV4dC5jaGFyQXQoMCkpKSB7XG4gICAgICAgIGN1ckxpbmUgKz0gXCIgXCI7XG4gICAgICAgIHNwYWNlSW5zZXJ0ZWQgPSAxO1xuICAgICAgfVxuICAgICAgdmFyIHNwYWNlVHJpbW1lZCA9IFwiXCI7XG4gICAgICBpZiAoaSkge1xuICAgICAgICBzcGFjZVRyaW1tZWQgPSB0ZXh0Lm1hdGNoKC9eXFxzKi8pWzBdO1xuICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZShzcGFjZVRyaW1tZWQubGVuZ3RoKTtcbiAgICAgIH1cbiAgICAgIGN1ckxpbmUgKz0gdGV4dDtcbiAgICAgIGlmIChpKSB7XG4gICAgICAgIHZhciBmaXJzdEJyZWFrID0gY3VyTGluZS5sZW5ndGggPiBjb2x1bW4gJiYgbGVhZGluZ1NwYWNlID09IHNwYWNlVHJpbW1lZCAmJlxuICAgICAgICAgIGZpbmRCcmVha1BvaW50KGN1ckxpbmUsIGNvbHVtbiwgd3JhcE9uLCBraWxsVHJhaWxpbmcpO1xuICAgICAgICAvLyBJZiB0aGlzIGlzbid0IGJyb2tlbiwgb3IgaXMgYnJva2VuIGF0IGEgZGlmZmVyZW50IHBvaW50LCByZW1vdmUgb2xkIGJyZWFrXG4gICAgICAgIGlmICghZmlyc3RCcmVhayB8fCBmaXJzdEJyZWFrLmZyb20gIT0gb2xkTGVuIHx8IGZpcnN0QnJlYWsudG8gIT0gb2xkTGVuICsgc3BhY2VJbnNlcnRlZCkge1xuICAgICAgICAgIGNoYW5nZXMucHVzaCh7dGV4dDogW3NwYWNlSW5zZXJ0ZWQgPyBcIiBcIiA6IFwiXCJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogUG9zKGN1ck5vLCBvbGRMZW4pLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG86IFBvcyhjdXJObyArIDEsIHNwYWNlVHJpbW1lZC5sZW5ndGgpfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VyTGluZSA9IGxlYWRpbmdTcGFjZSArIHRleHQ7XG4gICAgICAgICAgKytjdXJObztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgd2hpbGUgKGN1ckxpbmUubGVuZ3RoID4gY29sdW1uKSB7XG4gICAgICAgIHZhciBicCA9IGZpbmRCcmVha1BvaW50KGN1ckxpbmUsIGNvbHVtbiwgd3JhcE9uLCBraWxsVHJhaWxpbmcpO1xuICAgICAgICBjaGFuZ2VzLnB1c2goe3RleHQ6IFtcIlwiLCBsZWFkaW5nU3BhY2VdLFxuICAgICAgICAgICAgICAgICAgICAgIGZyb206IFBvcyhjdXJObywgYnAuZnJvbSksXG4gICAgICAgICAgICAgICAgICAgICAgdG86IFBvcyhjdXJObywgYnAudG8pfSk7XG4gICAgICAgIGN1ckxpbmUgPSBsZWFkaW5nU3BhY2UgKyBjdXJMaW5lLnNsaWNlKGJwLnRvKTtcbiAgICAgICAgKytjdXJObztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNoYW5nZXMubGVuZ3RoKSBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGNoYW5nZSA9IGNoYW5nZXNbaV07XG4gICAgICAgIGlmIChjaGFuZ2UudGV4dCB8fCBDb2RlTWlycm9yLmNtcFBvcyhjaGFuZ2UuZnJvbSwgY2hhbmdlLnRvKSlcbiAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoY2hhbmdlLnRleHQsIGNoYW5nZS5mcm9tLCBjaGFuZ2UudG8pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBjaGFuZ2VzLmxlbmd0aCA/IHtmcm9tOiBjaGFuZ2VzWzBdLmZyb20sIHRvOiBDb2RlTWlycm9yLmNoYW5nZUVuZChjaGFuZ2VzW2NoYW5nZXMubGVuZ3RoIC0gMV0pfSA6IG51bGw7XG4gIH1cblxuICBDb2RlTWlycm9yLmRlZmluZUV4dGVuc2lvbihcIndyYXBQYXJhZ3JhcGhcIiwgZnVuY3Rpb24ocG9zLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgaWYgKCFwb3MpIHBvcyA9IHRoaXMuZ2V0Q3Vyc29yKCk7XG4gICAgdmFyIHBhcmEgPSBmaW5kUGFyYWdyYXBoKHRoaXMsIHBvcywgb3B0aW9ucyk7XG4gICAgcmV0dXJuIHdyYXBSYW5nZSh0aGlzLCBQb3MocGFyYS5mcm9tLCAwKSwgUG9zKHBhcmEudG8gLSAxKSwgb3B0aW9ucyk7XG4gIH0pO1xuXG4gIENvZGVNaXJyb3IuY29tbWFuZHMud3JhcExpbmVzID0gZnVuY3Rpb24oY20pIHtcbiAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmFuZ2VzID0gY20ubGlzdFNlbGVjdGlvbnMoKSwgYXQgPSBjbS5sYXN0TGluZSgpICsgMTtcbiAgICAgIGZvciAodmFyIGkgPSByYW5nZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgdmFyIHJhbmdlID0gcmFuZ2VzW2ldLCBzcGFuO1xuICAgICAgICBpZiAocmFuZ2UuZW1wdHkoKSkge1xuICAgICAgICAgIHZhciBwYXJhID0gZmluZFBhcmFncmFwaChjbSwgcmFuZ2UuaGVhZCwge30pO1xuICAgICAgICAgIHNwYW4gPSB7ZnJvbTogUG9zKHBhcmEuZnJvbSwgMCksIHRvOiBQb3MocGFyYS50byAtIDEpfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzcGFuID0ge2Zyb206IHJhbmdlLmZyb20oKSwgdG86IHJhbmdlLnRvKCl9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcGFuLnRvLmxpbmUgPj0gYXQpIGNvbnRpbnVlO1xuICAgICAgICBhdCA9IHNwYW4uZnJvbS5saW5lO1xuICAgICAgICB3cmFwUmFuZ2UoY20sIHNwYW4uZnJvbSwgc3Bhbi50bywge30pO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwid3JhcFJhbmdlXCIsIGZ1bmN0aW9uKGZyb20sIHRvLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHdyYXBSYW5nZSh0aGlzLCBmcm9tLCB0bywgb3B0aW9ucyB8fCB7fSk7XG4gIH0pO1xuXG4gIENvZGVNaXJyb3IuZGVmaW5lRXh0ZW5zaW9uKFwid3JhcFBhcmFncmFwaHNJblJhbmdlXCIsIGZ1bmN0aW9uKGZyb20sIHRvLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdmFyIGNtID0gdGhpcywgcGFyYXMgPSBbXTtcbiAgICBmb3IgKHZhciBsaW5lID0gZnJvbS5saW5lOyBsaW5lIDw9IHRvLmxpbmU7KSB7XG4gICAgICB2YXIgcGFyYSA9IGZpbmRQYXJhZ3JhcGgoY20sIFBvcyhsaW5lLCAwKSwgb3B0aW9ucyk7XG4gICAgICBwYXJhcy5wdXNoKHBhcmEpO1xuICAgICAgbGluZSA9IHBhcmEudG87XG4gICAgfVxuICAgIHZhciBtYWRlQ2hhbmdlID0gZmFsc2U7XG4gICAgaWYgKHBhcmFzLmxlbmd0aCkgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgaSA9IHBhcmFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKVxuICAgICAgICBtYWRlQ2hhbmdlID0gbWFkZUNoYW5nZSB8fCB3cmFwUmFuZ2UoY20sIFBvcyhwYXJhc1tpXS5mcm9tLCAwKSwgUG9zKHBhcmFzW2ldLnRvIC0gMSksIG9wdGlvbnMpO1xuICAgIH0pO1xuICAgIHJldHVybiBtYWRlQ2hhbmdlO1xuICB9KTtcbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4vLyBBIHJvdWdoIGFwcHJveGltYXRpb24gb2YgU3VibGltZSBUZXh0J3Mga2V5YmluZGluZ3Ncbi8vIERlcGVuZHMgb24gYWRkb24vc2VhcmNoL3NlYXJjaGN1cnNvci5qcyBhbmQgb3B0aW9uYWxseSBhZGRvbi9kaWFsb2cvZGlhbG9ncy5qc1xuXG4oZnVuY3Rpb24obW9kKSB7XG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgPT0gXCJvYmplY3RcIikgLy8gQ29tbW9uSlNcbiAgICBtb2QocmVxdWlyZShcIi4uL2xpYi9jb2RlbWlycm9yXCIpLCByZXF1aXJlKFwiLi4vYWRkb24vc2VhcmNoL3NlYXJjaGN1cnNvclwiKSwgcmVxdWlyZShcIi4uL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0c1wiKSk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIGRlZmluZShbXCIuLi9saWIvY29kZW1pcnJvclwiLCBcIi4uL2FkZG9uL3NlYXJjaC9zZWFyY2hjdXJzb3JcIiwgXCIuLi9hZGRvbi9lZGl0L21hdGNoYnJhY2tldHNcIl0sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICBtb2QoQ29kZU1pcnJvcik7XG59KShmdW5jdGlvbihDb2RlTWlycm9yKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBtYXAgPSBDb2RlTWlycm9yLmtleU1hcC5zdWJsaW1lID0ge2ZhbGx0aHJvdWdoOiBcImRlZmF1bHRcIn07XG4gIHZhciBjbWRzID0gQ29kZU1pcnJvci5jb21tYW5kcztcbiAgdmFyIFBvcyA9IENvZGVNaXJyb3IuUG9zO1xuICB2YXIgbWFjID0gQ29kZU1pcnJvci5rZXlNYXBbXCJkZWZhdWx0XCJdID09IENvZGVNaXJyb3Iua2V5TWFwLm1hY0RlZmF1bHQ7XG4gIHZhciBjdHJsID0gbWFjID8gXCJDbWQtXCIgOiBcIkN0cmwtXCI7XG5cbiAgLy8gVGhpcyBpcyBub3QgZXhhY3RseSBTdWJsaW1lJ3MgYWxnb3JpdGhtLiBJIGNvdWxkbid0IG1ha2UgaGVhZHMgb3IgdGFpbHMgb2YgdGhhdC5cbiAgZnVuY3Rpb24gZmluZFBvc1N1YndvcmQoZG9jLCBzdGFydCwgZGlyKSB7XG4gICAgaWYgKGRpciA8IDAgJiYgc3RhcnQuY2ggPT0gMCkgcmV0dXJuIGRvYy5jbGlwUG9zKFBvcyhzdGFydC5saW5lIC0gMSkpO1xuICAgIHZhciBsaW5lID0gZG9jLmdldExpbmUoc3RhcnQubGluZSk7XG4gICAgaWYgKGRpciA+IDAgJiYgc3RhcnQuY2ggPj0gbGluZS5sZW5ndGgpIHJldHVybiBkb2MuY2xpcFBvcyhQb3Moc3RhcnQubGluZSArIDEsIDApKTtcbiAgICB2YXIgc3RhdGUgPSBcInN0YXJ0XCIsIHR5cGU7XG4gICAgZm9yICh2YXIgcG9zID0gc3RhcnQuY2gsIGUgPSBkaXIgPCAwID8gMCA6IGxpbmUubGVuZ3RoLCBpID0gMDsgcG9zICE9IGU7IHBvcyArPSBkaXIsIGkrKykge1xuICAgICAgdmFyIG5leHQgPSBsaW5lLmNoYXJBdChkaXIgPCAwID8gcG9zIC0gMSA6IHBvcyk7XG4gICAgICB2YXIgY2F0ID0gbmV4dCAhPSBcIl9cIiAmJiBDb2RlTWlycm9yLmlzV29yZENoYXIobmV4dCkgPyBcIndcIiA6IFwib1wiO1xuICAgICAgaWYgKGNhdCA9PSBcIndcIiAmJiBuZXh0LnRvVXBwZXJDYXNlKCkgPT0gbmV4dCkgY2F0ID0gXCJXXCI7XG4gICAgICBpZiAoc3RhdGUgPT0gXCJzdGFydFwiKSB7XG4gICAgICAgIGlmIChjYXQgIT0gXCJvXCIpIHsgc3RhdGUgPSBcImluXCI7IHR5cGUgPSBjYXQ7IH1cbiAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT0gXCJpblwiKSB7XG4gICAgICAgIGlmICh0eXBlICE9IGNhdCkge1xuICAgICAgICAgIGlmICh0eXBlID09IFwid1wiICYmIGNhdCA9PSBcIldcIiAmJiBkaXIgPCAwKSBwb3MtLTtcbiAgICAgICAgICBpZiAodHlwZSA9PSBcIldcIiAmJiBjYXQgPT0gXCJ3XCIgJiYgZGlyID4gMCkgeyB0eXBlID0gXCJ3XCI7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFBvcyhzdGFydC5saW5lLCBwb3MpO1xuICB9XG5cbiAgZnVuY3Rpb24gbW92ZVN1YndvcmQoY20sIGRpcikge1xuICAgIGNtLmV4dGVuZFNlbGVjdGlvbnNCeShmdW5jdGlvbihyYW5nZSkge1xuICAgICAgaWYgKGNtLmRpc3BsYXkuc2hpZnQgfHwgY20uZG9jLmV4dGVuZCB8fCByYW5nZS5lbXB0eSgpKVxuICAgICAgICByZXR1cm4gZmluZFBvc1N1YndvcmQoY20uZG9jLCByYW5nZS5oZWFkLCBkaXIpO1xuICAgICAgZWxzZVxuICAgICAgICByZXR1cm4gZGlyIDwgMCA/IHJhbmdlLmZyb20oKSA6IHJhbmdlLnRvKCk7XG4gICAgfSk7XG4gIH1cblxuICBjbWRzW21hcFtcIkFsdC1MZWZ0XCJdID0gXCJnb1N1YndvcmRMZWZ0XCJdID0gZnVuY3Rpb24oY20pIHsgbW92ZVN1YndvcmQoY20sIC0xKTsgfTtcbiAgY21kc1ttYXBbXCJBbHQtUmlnaHRcIl0gPSBcImdvU3Vid29yZFJpZ2h0XCJdID0gZnVuY3Rpb24oY20pIHsgbW92ZVN1YndvcmQoY20sIDEpOyB9O1xuXG4gIHZhciBzY3JvbGxMaW5lQ29tYm8gPSBtYWMgPyBcIkN0cmwtQWx0LVwiIDogXCJDdHJsLVwiO1xuXG4gIGNtZHNbbWFwW3Njcm9sbExpbmVDb21ibyArIFwiVXBcIl0gPSBcInNjcm9sbExpbmVVcFwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgdmFyIGluZm8gPSBjbS5nZXRTY3JvbGxJbmZvKCk7XG4gICAgaWYgKCFjbS5zb21ldGhpbmdTZWxlY3RlZCgpKSB7XG4gICAgICB2YXIgdmlzaWJsZUJvdHRvbUxpbmUgPSBjbS5saW5lQXRIZWlnaHQoaW5mby50b3AgKyBpbmZvLmNsaWVudEhlaWdodCwgXCJsb2NhbFwiKTtcbiAgICAgIGlmIChjbS5nZXRDdXJzb3IoKS5saW5lID49IHZpc2libGVCb3R0b21MaW5lKVxuICAgICAgICBjbS5leGVjQ29tbWFuZChcImdvTGluZVVwXCIpO1xuICAgIH1cbiAgICBjbS5zY3JvbGxUbyhudWxsLCBpbmZvLnRvcCAtIGNtLmRlZmF1bHRUZXh0SGVpZ2h0KCkpO1xuICB9O1xuICBjbWRzW21hcFtzY3JvbGxMaW5lQ29tYm8gKyBcIkRvd25cIl0gPSBcInNjcm9sbExpbmVEb3duXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgaW5mbyA9IGNtLmdldFNjcm9sbEluZm8oKTtcbiAgICBpZiAoIWNtLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcbiAgICAgIHZhciB2aXNpYmxlVG9wTGluZSA9IGNtLmxpbmVBdEhlaWdodChpbmZvLnRvcCwgXCJsb2NhbFwiKSsxO1xuICAgICAgaWYgKGNtLmdldEN1cnNvcigpLmxpbmUgPD0gdmlzaWJsZVRvcExpbmUpXG4gICAgICAgIGNtLmV4ZWNDb21tYW5kKFwiZ29MaW5lRG93blwiKTtcbiAgICB9XG4gICAgY20uc2Nyb2xsVG8obnVsbCwgaW5mby50b3AgKyBjbS5kZWZhdWx0VGV4dEhlaWdodCgpKTtcbiAgfTtcblxuICBjbWRzW21hcFtcIlNoaWZ0LVwiICsgY3RybCArIFwiTFwiXSA9IFwic3BsaXRTZWxlY3Rpb25CeUxpbmVcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIHZhciByYW5nZXMgPSBjbS5saXN0U2VsZWN0aW9ucygpLCBsaW5lUmFuZ2VzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmcm9tID0gcmFuZ2VzW2ldLmZyb20oKSwgdG8gPSByYW5nZXNbaV0udG8oKTtcbiAgICAgIGZvciAodmFyIGxpbmUgPSBmcm9tLmxpbmU7IGxpbmUgPD0gdG8ubGluZTsgKytsaW5lKVxuICAgICAgICBpZiAoISh0by5saW5lID4gZnJvbS5saW5lICYmIGxpbmUgPT0gdG8ubGluZSAmJiB0by5jaCA9PSAwKSlcbiAgICAgICAgICBsaW5lUmFuZ2VzLnB1c2goe2FuY2hvcjogbGluZSA9PSBmcm9tLmxpbmUgPyBmcm9tIDogUG9zKGxpbmUsIDApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZDogbGluZSA9PSB0by5saW5lID8gdG8gOiBQb3MobGluZSl9KTtcbiAgICB9XG4gICAgY20uc2V0U2VsZWN0aW9ucyhsaW5lUmFuZ2VzLCAwKTtcbiAgfTtcblxuICBtYXBbXCJTaGlmdC1UYWJcIl0gPSBcImluZGVudExlc3NcIjtcblxuICBjbWRzW21hcFtcIkVzY1wiXSA9IFwic2luZ2xlU2VsZWN0aW9uVG9wXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgcmFuZ2UgPSBjbS5saXN0U2VsZWN0aW9ucygpWzBdO1xuICAgIGNtLnNldFNlbGVjdGlvbihyYW5nZS5hbmNob3IsIHJhbmdlLmhlYWQsIHtzY3JvbGw6IGZhbHNlfSk7XG4gIH07XG5cbiAgY21kc1ttYXBbY3RybCArIFwiTFwiXSA9IFwic2VsZWN0TGluZVwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCksIGV4dGVuZGVkID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciByYW5nZSA9IHJhbmdlc1tpXTtcbiAgICAgIGV4dGVuZGVkLnB1c2goe2FuY2hvcjogUG9zKHJhbmdlLmZyb20oKS5saW5lLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgIGhlYWQ6IFBvcyhyYW5nZS50bygpLmxpbmUgKyAxLCAwKX0pO1xuICAgIH1cbiAgICBjbS5zZXRTZWxlY3Rpb25zKGV4dGVuZGVkKTtcbiAgfTtcblxuICBtYXBbXCJTaGlmdC1cIiArIGN0cmwgKyBcIktcIl0gPSBcImRlbGV0ZUxpbmVcIjtcblxuICBmdW5jdGlvbiBpbnNlcnRMaW5lKGNtLCBhYm92ZSkge1xuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIHZhciBsZW4gPSBjbS5saXN0U2VsZWN0aW9ucygpLmxlbmd0aCwgbmV3U2VsZWN0aW9uID0gW10sIGxhc3QgPSAtMTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIGhlYWQgPSBjbS5saXN0U2VsZWN0aW9ucygpW2ldLmhlYWQ7XG4gICAgICAgIGlmIChoZWFkLmxpbmUgPD0gbGFzdCkgY29udGludWU7XG4gICAgICAgIHZhciBhdCA9IFBvcyhoZWFkLmxpbmUgKyAoYWJvdmUgPyAwIDogMSksIDApO1xuICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoXCJcXG5cIiwgYXQsIG51bGwsIFwiK2luc2VydExpbmVcIik7XG4gICAgICAgIGNtLmluZGVudExpbmUoYXQubGluZSwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgIG5ld1NlbGVjdGlvbi5wdXNoKHtoZWFkOiBhdCwgYW5jaG9yOiBhdH0pO1xuICAgICAgICBsYXN0ID0gaGVhZC5saW5lICsgMTtcbiAgICAgIH1cbiAgICAgIGNtLnNldFNlbGVjdGlvbnMobmV3U2VsZWN0aW9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNtZHNbbWFwW2N0cmwgKyBcIkVudGVyXCJdID0gXCJpbnNlcnRMaW5lQWZ0ZXJcIl0gPSBmdW5jdGlvbihjbSkgeyBpbnNlcnRMaW5lKGNtLCBmYWxzZSk7IH07XG5cbiAgY21kc1ttYXBbXCJTaGlmdC1cIiArIGN0cmwgKyBcIkVudGVyXCJdID0gXCJpbnNlcnRMaW5lQmVmb3JlXCJdID0gZnVuY3Rpb24oY20pIHsgaW5zZXJ0TGluZShjbSwgdHJ1ZSk7IH07XG5cbiAgZnVuY3Rpb24gd29yZEF0KGNtLCBwb3MpIHtcbiAgICB2YXIgc3RhcnQgPSBwb3MuY2gsIGVuZCA9IHN0YXJ0LCBsaW5lID0gY20uZ2V0TGluZShwb3MubGluZSk7XG4gICAgd2hpbGUgKHN0YXJ0ICYmIENvZGVNaXJyb3IuaXNXb3JkQ2hhcihsaW5lLmNoYXJBdChzdGFydCAtIDEpKSkgLS1zdGFydDtcbiAgICB3aGlsZSAoZW5kIDwgbGluZS5sZW5ndGggJiYgQ29kZU1pcnJvci5pc1dvcmRDaGFyKGxpbmUuY2hhckF0KGVuZCkpKSArK2VuZDtcbiAgICByZXR1cm4ge2Zyb206IFBvcyhwb3MubGluZSwgc3RhcnQpLCB0bzogUG9zKHBvcy5saW5lLCBlbmQpLCB3b3JkOiBsaW5lLnNsaWNlKHN0YXJ0LCBlbmQpfTtcbiAgfVxuXG4gIGNtZHNbbWFwW2N0cmwgKyBcIkRcIl0gPSBcInNlbGVjdE5leHRPY2N1cnJlbmNlXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgZnJvbSA9IGNtLmdldEN1cnNvcihcImZyb21cIiksIHRvID0gY20uZ2V0Q3Vyc29yKFwidG9cIik7XG4gICAgdmFyIGZ1bGxXb3JkID0gY20uc3RhdGUuc3VibGltZUZpbmRGdWxsV29yZCA9PSBjbS5kb2Muc2VsO1xuICAgIGlmIChDb2RlTWlycm9yLmNtcFBvcyhmcm9tLCB0bykgPT0gMCkge1xuICAgICAgdmFyIHdvcmQgPSB3b3JkQXQoY20sIGZyb20pO1xuICAgICAgaWYgKCF3b3JkLndvcmQpIHJldHVybjtcbiAgICAgIGNtLnNldFNlbGVjdGlvbih3b3JkLmZyb20sIHdvcmQudG8pO1xuICAgICAgZnVsbFdvcmQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdGV4dCA9IGNtLmdldFJhbmdlKGZyb20sIHRvKTtcbiAgICAgIHZhciBxdWVyeSA9IGZ1bGxXb3JkID8gbmV3IFJlZ0V4cChcIlxcXFxiXCIgKyB0ZXh0ICsgXCJcXFxcYlwiKSA6IHRleHQ7XG4gICAgICB2YXIgY3VyID0gY20uZ2V0U2VhcmNoQ3Vyc29yKHF1ZXJ5LCB0byk7XG4gICAgICBpZiAoY3VyLmZpbmROZXh0KCkpIHtcbiAgICAgICAgY20uYWRkU2VsZWN0aW9uKGN1ci5mcm9tKCksIGN1ci50bygpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1ciA9IGNtLmdldFNlYXJjaEN1cnNvcihxdWVyeSwgUG9zKGNtLmZpcnN0TGluZSgpLCAwKSk7XG4gICAgICAgIGlmIChjdXIuZmluZE5leHQoKSlcbiAgICAgICAgICBjbS5hZGRTZWxlY3Rpb24oY3VyLmZyb20oKSwgY3VyLnRvKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZnVsbFdvcmQpXG4gICAgICBjbS5zdGF0ZS5zdWJsaW1lRmluZEZ1bGxXb3JkID0gY20uZG9jLnNlbDtcbiAgfTtcblxuICB2YXIgbWlycm9yID0gXCIoKXt9W11cIjtcbiAgZnVuY3Rpb24gc2VsZWN0QmV0d2VlbkJyYWNrZXRzKGNtKSB7XG4gICAgdmFyIHBvcyA9IGNtLmdldEN1cnNvcigpLCBvcGVuaW5nID0gY20uc2NhbkZvckJyYWNrZXQocG9zLCAtMSk7XG4gICAgaWYgKCFvcGVuaW5nKSByZXR1cm47XG4gICAgZm9yICg7Oykge1xuICAgICAgdmFyIGNsb3NpbmcgPSBjbS5zY2FuRm9yQnJhY2tldChwb3MsIDEpO1xuICAgICAgaWYgKCFjbG9zaW5nKSByZXR1cm47XG4gICAgICBpZiAoY2xvc2luZy5jaCA9PSBtaXJyb3IuY2hhckF0KG1pcnJvci5pbmRleE9mKG9wZW5pbmcuY2gpICsgMSkpIHtcbiAgICAgICAgY20uc2V0U2VsZWN0aW9uKFBvcyhvcGVuaW5nLnBvcy5saW5lLCBvcGVuaW5nLnBvcy5jaCArIDEpLCBjbG9zaW5nLnBvcywgZmFsc2UpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHBvcyA9IFBvcyhjbG9zaW5nLnBvcy5saW5lLCBjbG9zaW5nLnBvcy5jaCArIDEpO1xuICAgIH1cbiAgfVxuXG4gIGNtZHNbbWFwW1wiU2hpZnQtXCIgKyBjdHJsICsgXCJTcGFjZVwiXSA9IFwic2VsZWN0U2NvcGVcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIHNlbGVjdEJldHdlZW5CcmFja2V0cyhjbSkgfHwgY20uZXhlY0NvbW1hbmQoXCJzZWxlY3RBbGxcIik7XG4gIH07XG4gIGNtZHNbbWFwW1wiU2hpZnQtXCIgKyBjdHJsICsgXCJNXCJdID0gXCJzZWxlY3RCZXR3ZWVuQnJhY2tldHNcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIGlmICghc2VsZWN0QmV0d2VlbkJyYWNrZXRzKGNtKSkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgfTtcblxuICBjbWRzW21hcFtjdHJsICsgXCJNXCJdID0gXCJnb1RvQnJhY2tldFwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20uZXh0ZW5kU2VsZWN0aW9uc0J5KGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICB2YXIgbmV4dCA9IGNtLnNjYW5Gb3JCcmFja2V0KHJhbmdlLmhlYWQsIDEpO1xuICAgICAgaWYgKG5leHQgJiYgQ29kZU1pcnJvci5jbXBQb3MobmV4dC5wb3MsIHJhbmdlLmhlYWQpICE9IDApIHJldHVybiBuZXh0LnBvcztcbiAgICAgIHZhciBwcmV2ID0gY20uc2NhbkZvckJyYWNrZXQocmFuZ2UuaGVhZCwgLTEpO1xuICAgICAgcmV0dXJuIHByZXYgJiYgUG9zKHByZXYucG9zLmxpbmUsIHByZXYucG9zLmNoICsgMSkgfHwgcmFuZ2UuaGVhZDtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgc3dhcExpbmVDb21ibyA9IG1hYyA/IFwiQ21kLUN0cmwtXCIgOiBcIlNoaWZ0LUN0cmwtXCI7XG5cbiAgY21kc1ttYXBbc3dhcExpbmVDb21ibyArIFwiVXBcIl0gPSBcInN3YXBMaW5lVXBcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIHZhciByYW5nZXMgPSBjbS5saXN0U2VsZWN0aW9ucygpLCBsaW5lc1RvTW92ZSA9IFtdLCBhdCA9IGNtLmZpcnN0TGluZSgpIC0gMSwgbmV3U2VscyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV0sIGZyb20gPSByYW5nZS5mcm9tKCkubGluZSAtIDEsIHRvID0gcmFuZ2UudG8oKS5saW5lO1xuICAgICAgbmV3U2Vscy5wdXNoKHthbmNob3I6IFBvcyhyYW5nZS5hbmNob3IubGluZSAtIDEsIHJhbmdlLmFuY2hvci5jaCksXG4gICAgICAgICAgICAgICAgICAgIGhlYWQ6IFBvcyhyYW5nZS5oZWFkLmxpbmUgLSAxLCByYW5nZS5oZWFkLmNoKX0pO1xuICAgICAgaWYgKHJhbmdlLnRvKCkuY2ggPT0gMCAmJiAhcmFuZ2UuZW1wdHkoKSkgLS10bztcbiAgICAgIGlmIChmcm9tID4gYXQpIGxpbmVzVG9Nb3ZlLnB1c2goZnJvbSwgdG8pO1xuICAgICAgZWxzZSBpZiAobGluZXNUb01vdmUubGVuZ3RoKSBsaW5lc1RvTW92ZVtsaW5lc1RvTW92ZS5sZW5ndGggLSAxXSA9IHRvO1xuICAgICAgYXQgPSB0bztcbiAgICB9XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lc1RvTW92ZS5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICB2YXIgZnJvbSA9IGxpbmVzVG9Nb3ZlW2ldLCB0byA9IGxpbmVzVG9Nb3ZlW2kgKyAxXTtcbiAgICAgICAgdmFyIGxpbmUgPSBjbS5nZXRMaW5lKGZyb20pO1xuICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoXCJcIiwgUG9zKGZyb20sIDApLCBQb3MoZnJvbSArIDEsIDApLCBcIitzd2FwTGluZVwiKTtcbiAgICAgICAgaWYgKHRvID4gY20ubGFzdExpbmUoKSlcbiAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoXCJcXG5cIiArIGxpbmUsIFBvcyhjbS5sYXN0TGluZSgpKSwgbnVsbCwgXCIrc3dhcExpbmVcIik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UobGluZSArIFwiXFxuXCIsIFBvcyh0bywgMCksIG51bGwsIFwiK3N3YXBMaW5lXCIpO1xuICAgICAgfVxuICAgICAgY20uc2V0U2VsZWN0aW9ucyhuZXdTZWxzKTtcbiAgICAgIGNtLnNjcm9sbEludG9WaWV3KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgY21kc1ttYXBbc3dhcExpbmVDb21ibyArIFwiRG93blwiXSA9IFwic3dhcExpbmVEb3duXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgcmFuZ2VzID0gY20ubGlzdFNlbGVjdGlvbnMoKSwgbGluZXNUb01vdmUgPSBbXSwgYXQgPSBjbS5sYXN0TGluZSgpICsgMTtcbiAgICBmb3IgKHZhciBpID0gcmFuZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV0sIGZyb20gPSByYW5nZS50bygpLmxpbmUgKyAxLCB0byA9IHJhbmdlLmZyb20oKS5saW5lO1xuICAgICAgaWYgKHJhbmdlLnRvKCkuY2ggPT0gMCAmJiAhcmFuZ2UuZW1wdHkoKSkgZnJvbS0tO1xuICAgICAgaWYgKGZyb20gPCBhdCkgbGluZXNUb01vdmUucHVzaChmcm9tLCB0byk7XG4gICAgICBlbHNlIGlmIChsaW5lc1RvTW92ZS5sZW5ndGgpIGxpbmVzVG9Nb3ZlW2xpbmVzVG9Nb3ZlLmxlbmd0aCAtIDFdID0gdG87XG4gICAgICBhdCA9IHRvO1xuICAgIH1cbiAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBpID0gbGluZXNUb01vdmUubGVuZ3RoIC0gMjsgaSA+PSAwOyBpIC09IDIpIHtcbiAgICAgICAgdmFyIGZyb20gPSBsaW5lc1RvTW92ZVtpXSwgdG8gPSBsaW5lc1RvTW92ZVtpICsgMV07XG4gICAgICAgIHZhciBsaW5lID0gY20uZ2V0TGluZShmcm9tKTtcbiAgICAgICAgaWYgKGZyb20gPT0gY20ubGFzdExpbmUoKSlcbiAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoXCJcIiwgUG9zKGZyb20gLSAxKSwgUG9zKGZyb20pLCBcIitzd2FwTGluZVwiKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZShcIlwiLCBQb3MoZnJvbSwgMCksIFBvcyhmcm9tICsgMSwgMCksIFwiK3N3YXBMaW5lXCIpO1xuICAgICAgICBjbS5yZXBsYWNlUmFuZ2UobGluZSArIFwiXFxuXCIsIFBvcyh0bywgMCksIG51bGwsIFwiK3N3YXBMaW5lXCIpO1xuICAgICAgfVxuICAgICAgY20uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICB9KTtcbiAgfTtcblxuICBtYXBbY3RybCArIFwiL1wiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20udG9nZ2xlQ29tbWVudCh7IGluZGVudDogdHJ1ZSB9KTtcbiAgfVxuXG4gIGNtZHNbbWFwW2N0cmwgKyBcIkpcIl0gPSBcImpvaW5MaW5lc1wiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCksIGpvaW5lZCA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV0sIGZyb20gPSByYW5nZS5mcm9tKCk7XG4gICAgICB2YXIgc3RhcnQgPSBmcm9tLmxpbmUsIGVuZCA9IHJhbmdlLnRvKCkubGluZTtcbiAgICAgIHdoaWxlIChpIDwgcmFuZ2VzLmxlbmd0aCAtIDEgJiYgcmFuZ2VzW2kgKyAxXS5mcm9tKCkubGluZSA9PSBlbmQpXG4gICAgICAgIGVuZCA9IHJhbmdlc1srK2ldLnRvKCkubGluZTtcbiAgICAgIGpvaW5lZC5wdXNoKHtzdGFydDogc3RhcnQsIGVuZDogZW5kLCBhbmNob3I6ICFyYW5nZS5lbXB0eSgpICYmIGZyb219KTtcbiAgICB9XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG9mZnNldCA9IDAsIHJhbmdlcyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqb2luZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG9iaiA9IGpvaW5lZFtpXTtcbiAgICAgICAgdmFyIGFuY2hvciA9IG9iai5hbmNob3IgJiYgUG9zKG9iai5hbmNob3IubGluZSAtIG9mZnNldCwgb2JqLmFuY2hvci5jaCksIGhlYWQ7XG4gICAgICAgIGZvciAodmFyIGxpbmUgPSBvYmouc3RhcnQ7IGxpbmUgPD0gb2JqLmVuZDsgbGluZSsrKSB7XG4gICAgICAgICAgdmFyIGFjdHVhbCA9IGxpbmUgLSBvZmZzZXQ7XG4gICAgICAgICAgaWYgKGxpbmUgPT0gb2JqLmVuZCkgaGVhZCA9IFBvcyhhY3R1YWwsIGNtLmdldExpbmUoYWN0dWFsKS5sZW5ndGggKyAxKTtcbiAgICAgICAgICBpZiAoYWN0dWFsIDwgY20ubGFzdExpbmUoKSkge1xuICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKFwiIFwiLCBQb3MoYWN0dWFsKSwgUG9zKGFjdHVhbCArIDEsIC9eXFxzKi8uZXhlYyhjbS5nZXRMaW5lKGFjdHVhbCArIDEpKVswXS5sZW5ndGgpKTtcbiAgICAgICAgICAgICsrb2Zmc2V0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByYW5nZXMucHVzaCh7YW5jaG9yOiBhbmNob3IgfHwgaGVhZCwgaGVhZDogaGVhZH0pO1xuICAgICAgfVxuICAgICAgY20uc2V0U2VsZWN0aW9ucyhyYW5nZXMsIDApO1xuICAgIH0pO1xuICB9O1xuXG4gIGNtZHNbbWFwW1wiU2hpZnQtXCIgKyBjdHJsICsgXCJEXCJdID0gXCJkdXBsaWNhdGVMaW5lXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmFuZ2VDb3VudCA9IGNtLmxpc3RTZWxlY3Rpb25zKCkubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZUNvdW50OyBpKyspIHtcbiAgICAgICAgdmFyIHJhbmdlID0gY20ubGlzdFNlbGVjdGlvbnMoKVtpXTtcbiAgICAgICAgaWYgKHJhbmdlLmVtcHR5KCkpXG4gICAgICAgICAgY20ucmVwbGFjZVJhbmdlKGNtLmdldExpbmUocmFuZ2UuaGVhZC5saW5lKSArIFwiXFxuXCIsIFBvcyhyYW5nZS5oZWFkLmxpbmUsIDApKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZShjbS5nZXRSYW5nZShyYW5nZS5mcm9tKCksIHJhbmdlLnRvKCkpLCByYW5nZS5mcm9tKCkpO1xuICAgICAgfVxuICAgICAgY20uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICB9KTtcbiAgfTtcblxuICBtYXBbY3RybCArIFwiVFwiXSA9IFwidHJhbnNwb3NlQ2hhcnNcIjtcblxuICBmdW5jdGlvbiBzb3J0TGluZXMoY20sIGNhc2VTZW5zaXRpdmUpIHtcbiAgICB2YXIgcmFuZ2VzID0gY20ubGlzdFNlbGVjdGlvbnMoKSwgdG9Tb3J0ID0gW10sIHNlbGVjdGVkO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICBpZiAocmFuZ2UuZW1wdHkoKSkgY29udGludWU7XG4gICAgICB2YXIgZnJvbSA9IHJhbmdlLmZyb20oKS5saW5lLCB0byA9IHJhbmdlLnRvKCkubGluZTtcbiAgICAgIHdoaWxlIChpIDwgcmFuZ2VzLmxlbmd0aCAtIDEgJiYgcmFuZ2VzW2kgKyAxXS5mcm9tKCkubGluZSA9PSB0bylcbiAgICAgICAgdG8gPSByYW5nZVsrK2ldLnRvKCkubGluZTtcbiAgICAgIHRvU29ydC5wdXNoKGZyb20sIHRvKTtcbiAgICB9XG4gICAgaWYgKHRvU29ydC5sZW5ndGgpIHNlbGVjdGVkID0gdHJ1ZTtcbiAgICBlbHNlIHRvU29ydC5wdXNoKGNtLmZpcnN0TGluZSgpLCBjbS5sYXN0TGluZSgpKTtcblxuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIHZhciByYW5nZXMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9Tb3J0Lmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgIHZhciBmcm9tID0gdG9Tb3J0W2ldLCB0byA9IHRvU29ydFtpICsgMV07XG4gICAgICAgIHZhciBzdGFydCA9IFBvcyhmcm9tLCAwKSwgZW5kID0gUG9zKHRvKTtcbiAgICAgICAgdmFyIGxpbmVzID0gY20uZ2V0UmFuZ2Uoc3RhcnQsIGVuZCwgZmFsc2UpO1xuICAgICAgICBpZiAoY2FzZVNlbnNpdGl2ZSlcbiAgICAgICAgICBsaW5lcy5zb3J0KCk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICBsaW5lcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIHZhciBhdSA9IGEudG9VcHBlckNhc2UoKSwgYnUgPSBiLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBpZiAoYXUgIT0gYnUpIHsgYSA9IGF1OyBiID0gYnU7IH1cbiAgICAgICAgICAgIHJldHVybiBhIDwgYiA/IC0xIDogYSA9PSBiID8gMCA6IDE7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGNtLnJlcGxhY2VSYW5nZShsaW5lcywgc3RhcnQsIGVuZCk7XG4gICAgICAgIGlmIChzZWxlY3RlZCkgcmFuZ2VzLnB1c2goe2FuY2hvcjogc3RhcnQsIGhlYWQ6IGVuZH0pO1xuICAgICAgfVxuICAgICAgaWYgKHNlbGVjdGVkKSBjbS5zZXRTZWxlY3Rpb25zKHJhbmdlcywgMCk7XG4gICAgfSk7XG4gIH1cblxuICBjbWRzW21hcFtcIkY5XCJdID0gXCJzb3J0TGluZXNcIl0gPSBmdW5jdGlvbihjbSkgeyBzb3J0TGluZXMoY20sIHRydWUpOyB9O1xuICBjbWRzW21hcFtjdHJsICsgXCJGOVwiXSA9IFwic29ydExpbmVzSW5zZW5zaXRpdmVcIl0gPSBmdW5jdGlvbihjbSkgeyBzb3J0TGluZXMoY20sIGZhbHNlKTsgfTtcblxuICBjbWRzW21hcFtcIkYyXCJdID0gXCJuZXh0Qm9va21hcmtcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIHZhciBtYXJrcyA9IGNtLnN0YXRlLnN1YmxpbWVCb29rbWFya3M7XG4gICAgaWYgKG1hcmtzKSB3aGlsZSAobWFya3MubGVuZ3RoKSB7XG4gICAgICB2YXIgY3VycmVudCA9IG1hcmtzLnNoaWZ0KCk7XG4gICAgICB2YXIgZm91bmQgPSBjdXJyZW50LmZpbmQoKTtcbiAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICBtYXJrcy5wdXNoKGN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gY20uc2V0U2VsZWN0aW9uKGZvdW5kLmZyb20sIGZvdW5kLnRvKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY21kc1ttYXBbXCJTaGlmdC1GMlwiXSA9IFwicHJldkJvb2ttYXJrXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgbWFya3MgPSBjbS5zdGF0ZS5zdWJsaW1lQm9va21hcmtzO1xuICAgIGlmIChtYXJrcykgd2hpbGUgKG1hcmtzLmxlbmd0aCkge1xuICAgICAgbWFya3MudW5zaGlmdChtYXJrcy5wb3AoKSk7XG4gICAgICB2YXIgZm91bmQgPSBtYXJrc1ttYXJrcy5sZW5ndGggLSAxXS5maW5kKCk7XG4gICAgICBpZiAoIWZvdW5kKVxuICAgICAgICBtYXJrcy5wb3AoKTtcbiAgICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIGNtLnNldFNlbGVjdGlvbihmb3VuZC5mcm9tLCBmb3VuZC50byk7XG4gICAgfVxuICB9O1xuXG4gIGNtZHNbbWFwW2N0cmwgKyBcIkYyXCJdID0gXCJ0b2dnbGVCb29rbWFya1wiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCk7XG4gICAgdmFyIG1hcmtzID0gY20uc3RhdGUuc3VibGltZUJvb2ttYXJrcyB8fCAoY20uc3RhdGUuc3VibGltZUJvb2ttYXJrcyA9IFtdKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZyb20gPSByYW5nZXNbaV0uZnJvbSgpLCB0byA9IHJhbmdlc1tpXS50bygpO1xuICAgICAgdmFyIGZvdW5kID0gY20uZmluZE1hcmtzKGZyb20sIHRvKTtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZm91bmQubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKGZvdW5kW2pdLnN1YmxpbWVCb29rbWFyaykge1xuICAgICAgICAgIGZvdW5kW2pdLmNsZWFyKCk7XG4gICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBtYXJrcy5sZW5ndGg7IGsrKylcbiAgICAgICAgICAgIGlmIChtYXJrc1trXSA9PSBmb3VuZFtqXSlcbiAgICAgICAgICAgICAgbWFya3Muc3BsaWNlKGstLSwgMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChqID09IGZvdW5kLmxlbmd0aClcbiAgICAgICAgbWFya3MucHVzaChjbS5tYXJrVGV4dChmcm9tLCB0bywge3N1YmxpbWVCb29rbWFyazogdHJ1ZSwgY2xlYXJXaGVuRW1wdHk6IGZhbHNlfSkpO1xuICAgIH1cbiAgfTtcblxuICBjbWRzW21hcFtcIlNoaWZ0LVwiICsgY3RybCArIFwiRjJcIl0gPSBcImNsZWFyQm9va21hcmtzXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgbWFya3MgPSBjbS5zdGF0ZS5zdWJsaW1lQm9va21hcmtzO1xuICAgIGlmIChtYXJrcykgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrcy5sZW5ndGg7IGkrKykgbWFya3NbaV0uY2xlYXIoKTtcbiAgICBtYXJrcy5sZW5ndGggPSAwO1xuICB9O1xuXG4gIGNtZHNbbWFwW1wiQWx0LUYyXCJdID0gXCJzZWxlY3RCb29rbWFya3NcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIHZhciBtYXJrcyA9IGNtLnN0YXRlLnN1YmxpbWVCb29rbWFya3MsIHJhbmdlcyA9IFtdO1xuICAgIGlmIChtYXJrcykgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZvdW5kID0gbWFya3NbaV0uZmluZCgpO1xuICAgICAgaWYgKCFmb3VuZClcbiAgICAgICAgbWFya3Muc3BsaWNlKGktLSwgMCk7XG4gICAgICBlbHNlXG4gICAgICAgIHJhbmdlcy5wdXNoKHthbmNob3I6IGZvdW5kLmZyb20sIGhlYWQ6IGZvdW5kLnRvfSk7XG4gICAgfVxuICAgIGlmIChyYW5nZXMubGVuZ3RoKVxuICAgICAgY20uc2V0U2VsZWN0aW9ucyhyYW5nZXMsIDApO1xuICB9O1xuXG4gIG1hcFtcIkFsdC1RXCJdID0gXCJ3cmFwTGluZXNcIjtcblxuICB2YXIgY0sgPSBjdHJsICsgXCJLIFwiO1xuXG4gIGZ1bmN0aW9uIG1vZGlmeVdvcmRPclNlbGVjdGlvbihjbSwgbW9kKSB7XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCksIGluZGljZXMgPSBbXSwgcmVwbGFjZW1lbnRzID0gW107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICAgIGlmIChyYW5nZS5lbXB0eSgpKSB7IGluZGljZXMucHVzaChpKTsgcmVwbGFjZW1lbnRzLnB1c2goXCJcIik7IH1cbiAgICAgICAgZWxzZSByZXBsYWNlbWVudHMucHVzaChtb2QoY20uZ2V0UmFuZ2UocmFuZ2UuZnJvbSgpLCByYW5nZS50bygpKSkpO1xuICAgICAgfVxuICAgICAgY20ucmVwbGFjZVNlbGVjdGlvbnMocmVwbGFjZW1lbnRzLCBcImFyb3VuZFwiLCBcImNhc2VcIik7XG4gICAgICBmb3IgKHZhciBpID0gaW5kaWNlcy5sZW5ndGggLSAxLCBhdDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgdmFyIHJhbmdlID0gcmFuZ2VzW2luZGljZXNbaV1dO1xuICAgICAgICBpZiAoYXQgJiYgQ29kZU1pcnJvci5jbXBQb3MocmFuZ2UuaGVhZCwgYXQpID4gMCkgY29udGludWU7XG4gICAgICAgIHZhciB3b3JkID0gd29yZEF0KGNtLCByYW5nZS5oZWFkKTtcbiAgICAgICAgYXQgPSB3b3JkLmZyb207XG4gICAgICAgIGNtLnJlcGxhY2VSYW5nZShtb2Qod29yZC53b3JkKSwgd29yZC5mcm9tLCB3b3JkLnRvKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG1hcFtjSyArIGN0cmwgKyBcIkJhY2tzcGFjZVwiXSA9IFwiZGVsTGluZUxlZnRcIjtcblxuICBjbWRzW21hcFtcIkJhY2tzcGFjZVwiXSA9IFwic21hcnRCYWNrc3BhY2VcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIGlmIChjbS5zb21ldGhpbmdTZWxlY3RlZCgpKSByZXR1cm4gQ29kZU1pcnJvci5QYXNzO1xuXG4gICAgdmFyIGN1cnNvciA9IGNtLmdldEN1cnNvcigpO1xuICAgIHZhciB0b1N0YXJ0T2ZMaW5lID0gY20uZ2V0UmFuZ2Uoe2xpbmU6IGN1cnNvci5saW5lLCBjaDogMH0sIGN1cnNvcik7XG4gICAgdmFyIGNvbHVtbiA9IENvZGVNaXJyb3IuY291bnRDb2x1bW4odG9TdGFydE9mTGluZSwgbnVsbCwgY20uZ2V0T3B0aW9uKFwidGFiU2l6ZVwiKSk7XG4gICAgdmFyIGluZGVudFVuaXQgPSBjbS5nZXRPcHRpb24oXCJpbmRlbnRVbml0XCIpO1xuXG4gICAgaWYgKHRvU3RhcnRPZkxpbmUgJiYgIS9cXFMvLnRlc3QodG9TdGFydE9mTGluZSkgJiYgY29sdW1uICUgaW5kZW50VW5pdCA9PSAwKSB7XG4gICAgICB2YXIgcHJldkluZGVudCA9IG5ldyBQb3MoY3Vyc29yLmxpbmUsXG4gICAgICAgIENvZGVNaXJyb3IuZmluZENvbHVtbih0b1N0YXJ0T2ZMaW5lLCBjb2x1bW4gLSBpbmRlbnRVbml0LCBpbmRlbnRVbml0KSk7XG5cbiAgICAgIC8vIElmIG5vIHNtYXJ0IGRlbGV0ZSBpcyBoYXBwZW5pbmcgKGR1ZSB0byB0YWIgc2l6aW5nKSBqdXN0IGRvIGEgcmVndWxhciBkZWxldGVcbiAgICAgIGlmIChwcmV2SW5kZW50LmNoID09IGN1cnNvci5jaCkgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcblxuICAgICAgcmV0dXJuIGNtLnJlcGxhY2VSYW5nZShcIlwiLCBwcmV2SW5kZW50LCBjdXJzb3IsIFwiK2RlbGV0ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIENvZGVNaXJyb3IuUGFzcztcbiAgICB9XG4gIH07XG5cbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJLXCJdID0gXCJkZWxMaW5lUmlnaHRcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIGNtLm9wZXJhdGlvbihmdW5jdGlvbigpIHtcbiAgICAgIHZhciByYW5nZXMgPSBjbS5saXN0U2VsZWN0aW9ucygpO1xuICAgICAgZm9yICh2YXIgaSA9IHJhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSlcbiAgICAgICAgY20ucmVwbGFjZVJhbmdlKFwiXCIsIHJhbmdlc1tpXS5hbmNob3IsIFBvcyhyYW5nZXNbaV0udG8oKS5saW5lKSwgXCIrZGVsZXRlXCIpO1xuICAgICAgY20uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICB9KTtcbiAgfTtcblxuICBjbWRzW21hcFtjSyArIGN0cmwgKyBcIlVcIl0gPSBcInVwY2FzZUF0Q3Vyc29yXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICBtb2RpZnlXb3JkT3JTZWxlY3Rpb24oY20sIGZ1bmN0aW9uKHN0cikgeyByZXR1cm4gc3RyLnRvVXBwZXJDYXNlKCk7IH0pO1xuICB9O1xuICBjbWRzW21hcFtjSyArIGN0cmwgKyBcIkxcIl0gPSBcImRvd25jYXNlQXRDdXJzb3JcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIG1vZGlmeVdvcmRPclNlbGVjdGlvbihjbSwgZnVuY3Rpb24oc3RyKSB7IHJldHVybiBzdHIudG9Mb3dlckNhc2UoKTsgfSk7XG4gIH07XG5cbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJTcGFjZVwiXSA9IFwic2V0U3VibGltZU1hcmtcIl0gPSBmdW5jdGlvbihjbSkge1xuICAgIGlmIChjbS5zdGF0ZS5zdWJsaW1lTWFyaykgY20uc3RhdGUuc3VibGltZU1hcmsuY2xlYXIoKTtcbiAgICBjbS5zdGF0ZS5zdWJsaW1lTWFyayA9IGNtLnNldEJvb2ttYXJrKGNtLmdldEN1cnNvcigpKTtcbiAgfTtcbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJBXCJdID0gXCJzZWxlY3RUb1N1YmxpbWVNYXJrXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgZm91bmQgPSBjbS5zdGF0ZS5zdWJsaW1lTWFyayAmJiBjbS5zdGF0ZS5zdWJsaW1lTWFyay5maW5kKCk7XG4gICAgaWYgKGZvdW5kKSBjbS5zZXRTZWxlY3Rpb24oY20uZ2V0Q3Vyc29yKCksIGZvdW5kKTtcbiAgfTtcbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJXXCJdID0gXCJkZWxldGVUb1N1YmxpbWVNYXJrXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgZm91bmQgPSBjbS5zdGF0ZS5zdWJsaW1lTWFyayAmJiBjbS5zdGF0ZS5zdWJsaW1lTWFyay5maW5kKCk7XG4gICAgaWYgKGZvdW5kKSB7XG4gICAgICB2YXIgZnJvbSA9IGNtLmdldEN1cnNvcigpLCB0byA9IGZvdW5kO1xuICAgICAgaWYgKENvZGVNaXJyb3IuY21wUG9zKGZyb20sIHRvKSA+IDApIHsgdmFyIHRtcCA9IHRvOyB0byA9IGZyb207IGZyb20gPSB0bXA7IH1cbiAgICAgIGNtLnN0YXRlLnN1YmxpbWVLaWxsZWQgPSBjbS5nZXRSYW5nZShmcm9tLCB0byk7XG4gICAgICBjbS5yZXBsYWNlUmFuZ2UoXCJcIiwgZnJvbSwgdG8pO1xuICAgIH1cbiAgfTtcbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJYXCJdID0gXCJzd2FwV2l0aFN1YmxpbWVNYXJrXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgZm91bmQgPSBjbS5zdGF0ZS5zdWJsaW1lTWFyayAmJiBjbS5zdGF0ZS5zdWJsaW1lTWFyay5maW5kKCk7XG4gICAgaWYgKGZvdW5kKSB7XG4gICAgICBjbS5zdGF0ZS5zdWJsaW1lTWFyay5jbGVhcigpO1xuICAgICAgY20uc3RhdGUuc3VibGltZU1hcmsgPSBjbS5zZXRCb29rbWFyayhjbS5nZXRDdXJzb3IoKSk7XG4gICAgICBjbS5zZXRDdXJzb3IoZm91bmQpO1xuICAgIH1cbiAgfTtcbiAgY21kc1ttYXBbY0sgKyBjdHJsICsgXCJZXCJdID0gXCJzdWJsaW1lWWFua1wiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgaWYgKGNtLnN0YXRlLnN1YmxpbWVLaWxsZWQgIT0gbnVsbClcbiAgICAgIGNtLnJlcGxhY2VTZWxlY3Rpb24oY20uc3RhdGUuc3VibGltZUtpbGxlZCwgbnVsbCwgXCJwYXN0ZVwiKTtcbiAgfTtcblxuICBtYXBbY0sgKyBjdHJsICsgXCJHXCJdID0gXCJjbGVhckJvb2ttYXJrc1wiO1xuICBjbWRzW21hcFtjSyArIGN0cmwgKyBcIkNcIl0gPSBcInNob3dJbkNlbnRlclwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgdmFyIHBvcyA9IGNtLmN1cnNvckNvb3JkcyhudWxsLCBcImxvY2FsXCIpO1xuICAgIGNtLnNjcm9sbFRvKG51bGwsIChwb3MudG9wICsgcG9zLmJvdHRvbSkgLyAyIC0gY20uZ2V0U2Nyb2xsSW5mbygpLmNsaWVudEhlaWdodCAvIDIpO1xuICB9O1xuXG4gIGNtZHNbbWFwW1wiU2hpZnQtQWx0LVVwXCJdID0gXCJzZWxlY3RMaW5lc1Vwd2FyZFwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICAgIGlmIChyYW5nZS5oZWFkLmxpbmUgPiBjbS5maXJzdExpbmUoKSlcbiAgICAgICAgICBjbS5hZGRTZWxlY3Rpb24oUG9zKHJhbmdlLmhlYWQubGluZSAtIDEsIHJhbmdlLmhlYWQuY2gpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY21kc1ttYXBbXCJTaGlmdC1BbHQtRG93blwiXSA9IFwic2VsZWN0TGluZXNEb3dud2FyZFwiXSA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXNbaV07XG4gICAgICAgIGlmIChyYW5nZS5oZWFkLmxpbmUgPCBjbS5sYXN0TGluZSgpKVxuICAgICAgICAgIGNtLmFkZFNlbGVjdGlvbihQb3MocmFuZ2UuaGVhZC5saW5lICsgMSwgcmFuZ2UuaGVhZC5jaCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGdldFRhcmdldChjbSkge1xuICAgIHZhciBmcm9tID0gY20uZ2V0Q3Vyc29yKFwiZnJvbVwiKSwgdG8gPSBjbS5nZXRDdXJzb3IoXCJ0b1wiKTtcbiAgICBpZiAoQ29kZU1pcnJvci5jbXBQb3MoZnJvbSwgdG8pID09IDApIHtcbiAgICAgIHZhciB3b3JkID0gd29yZEF0KGNtLCBmcm9tKTtcbiAgICAgIGlmICghd29yZC53b3JkKSByZXR1cm47XG4gICAgICBmcm9tID0gd29yZC5mcm9tO1xuICAgICAgdG8gPSB3b3JkLnRvO1xuICAgIH1cbiAgICByZXR1cm4ge2Zyb206IGZyb20sIHRvOiB0bywgcXVlcnk6IGNtLmdldFJhbmdlKGZyb20sIHRvKSwgd29yZDogd29yZH07XG4gIH1cblxuICBmdW5jdGlvbiBmaW5kQW5kR29UbyhjbSwgZm9yd2FyZCkge1xuICAgIHZhciB0YXJnZXQgPSBnZXRUYXJnZXQoY20pO1xuICAgIGlmICghdGFyZ2V0KSByZXR1cm47XG4gICAgdmFyIHF1ZXJ5ID0gdGFyZ2V0LnF1ZXJ5O1xuICAgIHZhciBjdXIgPSBjbS5nZXRTZWFyY2hDdXJzb3IocXVlcnksIGZvcndhcmQgPyB0YXJnZXQudG8gOiB0YXJnZXQuZnJvbSk7XG5cbiAgICBpZiAoZm9yd2FyZCA/IGN1ci5maW5kTmV4dCgpIDogY3VyLmZpbmRQcmV2aW91cygpKSB7XG4gICAgICBjbS5zZXRTZWxlY3Rpb24oY3VyLmZyb20oKSwgY3VyLnRvKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXIgPSBjbS5nZXRTZWFyY2hDdXJzb3IocXVlcnksIGZvcndhcmQgPyBQb3MoY20uZmlyc3RMaW5lKCksIDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBjbS5jbGlwUG9zKFBvcyhjbS5sYXN0TGluZSgpKSkpO1xuICAgICAgaWYgKGZvcndhcmQgPyBjdXIuZmluZE5leHQoKSA6IGN1ci5maW5kUHJldmlvdXMoKSlcbiAgICAgICAgY20uc2V0U2VsZWN0aW9uKGN1ci5mcm9tKCksIGN1ci50bygpKTtcbiAgICAgIGVsc2UgaWYgKHRhcmdldC53b3JkKVxuICAgICAgICBjbS5zZXRTZWxlY3Rpb24odGFyZ2V0LmZyb20sIHRhcmdldC50byk7XG4gICAgfVxuICB9O1xuICBjbWRzW21hcFtjdHJsICsgXCJGM1wiXSA9IFwiZmluZFVuZGVyXCJdID0gZnVuY3Rpb24oY20pIHsgZmluZEFuZEdvVG8oY20sIHRydWUpOyB9O1xuICBjbWRzW21hcFtcIlNoaWZ0LVwiICsgY3RybCArIFwiRjNcIl0gPSBcImZpbmRVbmRlclByZXZpb3VzXCJdID0gZnVuY3Rpb24oY20pIHsgZmluZEFuZEdvVG8oY20sZmFsc2UpOyB9O1xuICBjbWRzW21hcFtcIkFsdC1GM1wiXSA9IFwiZmluZEFsbFVuZGVyXCJdID0gZnVuY3Rpb24oY20pIHtcbiAgICB2YXIgdGFyZ2V0ID0gZ2V0VGFyZ2V0KGNtKTtcbiAgICBpZiAoIXRhcmdldCkgcmV0dXJuO1xuICAgIHZhciBjdXIgPSBjbS5nZXRTZWFyY2hDdXJzb3IodGFyZ2V0LnF1ZXJ5KTtcbiAgICB2YXIgbWF0Y2hlcyA9IFtdO1xuICAgIHZhciBwcmltYXJ5SW5kZXggPSAtMTtcbiAgICB3aGlsZSAoY3VyLmZpbmROZXh0KCkpIHtcbiAgICAgIG1hdGNoZXMucHVzaCh7YW5jaG9yOiBjdXIuZnJvbSgpLCBoZWFkOiBjdXIudG8oKX0pO1xuICAgICAgaWYgKGN1ci5mcm9tKCkubGluZSA8PSB0YXJnZXQuZnJvbS5saW5lICYmIGN1ci5mcm9tKCkuY2ggPD0gdGFyZ2V0LmZyb20uY2gpXG4gICAgICAgIHByaW1hcnlJbmRleCsrO1xuICAgIH1cbiAgICBjbS5zZXRTZWxlY3Rpb25zKG1hdGNoZXMsIHByaW1hcnlJbmRleCk7XG4gIH07XG5cbiAgbWFwW1wiU2hpZnQtXCIgKyBjdHJsICsgXCJbXCJdID0gXCJmb2xkXCI7XG4gIG1hcFtcIlNoaWZ0LVwiICsgY3RybCArIFwiXVwiXSA9IFwidW5mb2xkXCI7XG4gIG1hcFtjSyArIGN0cmwgKyBcIjBcIl0gPSBtYXBbY0sgKyBjdHJsICsgXCJqXCJdID0gXCJ1bmZvbGRBbGxcIjtcblxuICBtYXBbY3RybCArIFwiSVwiXSA9IFwiZmluZEluY3JlbWVudGFsXCI7XG4gIG1hcFtcIlNoaWZ0LVwiICsgY3RybCArIFwiSVwiXSA9IFwiZmluZEluY3JlbWVudGFsUmV2ZXJzZVwiO1xuICBtYXBbY3RybCArIFwiSFwiXSA9IFwicmVwbGFjZVwiO1xuICBtYXBbXCJGM1wiXSA9IFwiZmluZE5leHRcIjtcbiAgbWFwW1wiU2hpZnQtRjNcIl0gPSBcImZpbmRQcmV2XCI7XG5cbiAgQ29kZU1pcnJvci5ub3JtYWxpemVLZXlNYXAobWFwKTtcbn0pO1xuIiwiLy8gQ29kZU1pcnJvciwgY29weXJpZ2h0IChjKSBieSBNYXJpam4gSGF2ZXJiZWtlIGFuZCBvdGhlcnNcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIGFuIE1JVCBsaWNlbnNlOiBodHRwOi8vY29kZW1pcnJvci5uZXQvTElDRU5TRVxuXG4vLyBUaGlzIGlzIENvZGVNaXJyb3IgKGh0dHA6Ly9jb2RlbWlycm9yLm5ldCksIGEgY29kZSBlZGl0b3Jcbi8vIGltcGxlbWVudGVkIGluIEphdmFTY3JpcHQgb24gdG9wIG9mIHRoZSBicm93c2VyJ3MgRE9NLlxuLy9cbi8vIFlvdSBjYW4gZmluZCBzb21lIHRlY2huaWNhbCBiYWNrZ3JvdW5kIGZvciBzb21lIG9mIHRoZSBjb2RlIGJlbG93XG4vLyBhdCBodHRwOi8vbWFyaWpuaGF2ZXJiZWtlLm5sL2Jsb2cvI2NtLWludGVybmFscyAuXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZHVsZS5leHBvcnRzID0gbW9kKCk7XG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIC8vIEFNRFxuICAgIHJldHVybiBkZWZpbmUoW10sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICB0aGlzLkNvZGVNaXJyb3IgPSBtb2QoKTtcbn0pKGZ1bmN0aW9uKCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICAvLyBCUk9XU0VSIFNOSUZGSU5HXG5cbiAgLy8gS2x1ZGdlcyBmb3IgYnVncyBhbmQgYmVoYXZpb3IgZGlmZmVyZW5jZXMgdGhhdCBjYW4ndCBiZSBmZWF0dXJlXG4gIC8vIGRldGVjdGVkIGFyZSBlbmFibGVkIGJhc2VkIG9uIHVzZXJBZ2VudCBldGMgc25pZmZpbmcuXG4gIHZhciB1c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICB2YXIgcGxhdGZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm07XG5cbiAgdmFyIGdlY2tvID0gL2dlY2tvXFwvXFxkL2kudGVzdCh1c2VyQWdlbnQpO1xuICB2YXIgaWVfdXB0bzEwID0gL01TSUUgXFxkLy50ZXN0KHVzZXJBZ2VudCk7XG4gIHZhciBpZV8xMXVwID0gL1RyaWRlbnRcXC8oPzpbNy05XXxcXGR7Mix9KVxcLi4qcnY6KFxcZCspLy5leGVjKHVzZXJBZ2VudCk7XG4gIHZhciBpZSA9IGllX3VwdG8xMCB8fCBpZV8xMXVwO1xuICB2YXIgaWVfdmVyc2lvbiA9IGllICYmIChpZV91cHRvMTAgPyBkb2N1bWVudC5kb2N1bWVudE1vZGUgfHwgNiA6IGllXzExdXBbMV0pO1xuICB2YXIgd2Via2l0ID0gL1dlYktpdFxcLy8udGVzdCh1c2VyQWdlbnQpO1xuICB2YXIgcXR3ZWJraXQgPSB3ZWJraXQgJiYgL1F0XFwvXFxkK1xcLlxcZCsvLnRlc3QodXNlckFnZW50KTtcbiAgdmFyIGNocm9tZSA9IC9DaHJvbWVcXC8vLnRlc3QodXNlckFnZW50KTtcbiAgdmFyIHByZXN0byA9IC9PcGVyYVxcLy8udGVzdCh1c2VyQWdlbnQpO1xuICB2YXIgc2FmYXJpID0gL0FwcGxlIENvbXB1dGVyLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpO1xuICB2YXIgbWFjX2dlTW91bnRhaW5MaW9uID0gL01hYyBPUyBYIDFcXGRcXEQoWzgtOV18XFxkXFxkKVxcRC8udGVzdCh1c2VyQWdlbnQpO1xuICB2YXIgcGhhbnRvbSA9IC9QaGFudG9tSlMvLnRlc3QodXNlckFnZW50KTtcblxuICB2YXIgaW9zID0gL0FwcGxlV2ViS2l0Ly50ZXN0KHVzZXJBZ2VudCkgJiYgL01vYmlsZVxcL1xcdysvLnRlc3QodXNlckFnZW50KTtcbiAgLy8gVGhpcyBpcyB3b2VmdWxseSBpbmNvbXBsZXRlLiBTdWdnZXN0aW9ucyBmb3IgYWx0ZXJuYXRpdmUgbWV0aG9kcyB3ZWxjb21lLlxuICB2YXIgbW9iaWxlID0gaW9zIHx8IC9BbmRyb2lkfHdlYk9TfEJsYWNrQmVycnl8T3BlcmEgTWluaXxPcGVyYSBNb2JpfElFTW9iaWxlL2kudGVzdCh1c2VyQWdlbnQpO1xuICB2YXIgbWFjID0gaW9zIHx8IC9NYWMvLnRlc3QocGxhdGZvcm0pO1xuICB2YXIgd2luZG93cyA9IC93aW4vaS50ZXN0KHBsYXRmb3JtKTtcblxuICB2YXIgcHJlc3RvX3ZlcnNpb24gPSBwcmVzdG8gJiYgdXNlckFnZW50Lm1hdGNoKC9WZXJzaW9uXFwvKFxcZCpcXC5cXGQqKS8pO1xuICBpZiAocHJlc3RvX3ZlcnNpb24pIHByZXN0b192ZXJzaW9uID0gTnVtYmVyKHByZXN0b192ZXJzaW9uWzFdKTtcbiAgaWYgKHByZXN0b192ZXJzaW9uICYmIHByZXN0b192ZXJzaW9uID49IDE1KSB7IHByZXN0byA9IGZhbHNlOyB3ZWJraXQgPSB0cnVlOyB9XG4gIC8vIFNvbWUgYnJvd3NlcnMgdXNlIHRoZSB3cm9uZyBldmVudCBwcm9wZXJ0aWVzIHRvIHNpZ25hbCBjbWQvY3RybCBvbiBPUyBYXG4gIHZhciBmbGlwQ3RybENtZCA9IG1hYyAmJiAocXR3ZWJraXQgfHwgcHJlc3RvICYmIChwcmVzdG9fdmVyc2lvbiA9PSBudWxsIHx8IHByZXN0b192ZXJzaW9uIDwgMTIuMTEpKTtcbiAgdmFyIGNhcHR1cmVSaWdodENsaWNrID0gZ2Vja28gfHwgKGllICYmIGllX3ZlcnNpb24gPj0gOSk7XG5cbiAgLy8gT3B0aW1pemUgc29tZSBjb2RlIHdoZW4gdGhlc2UgZmVhdHVyZXMgYXJlIG5vdCB1c2VkLlxuICB2YXIgc2F3UmVhZE9ubHlTcGFucyA9IGZhbHNlLCBzYXdDb2xsYXBzZWRTcGFucyA9IGZhbHNlO1xuXG4gIC8vIEVESVRPUiBDT05TVFJVQ1RPUlxuXG4gIC8vIEEgQ29kZU1pcnJvciBpbnN0YW5jZSByZXByZXNlbnRzIGFuIGVkaXRvci4gVGhpcyBpcyB0aGUgb2JqZWN0XG4gIC8vIHRoYXQgdXNlciBjb2RlIGlzIHVzdWFsbHkgZGVhbGluZyB3aXRoLlxuXG4gIGZ1bmN0aW9uIENvZGVNaXJyb3IocGxhY2UsIG9wdGlvbnMpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgQ29kZU1pcnJvcikpIHJldHVybiBuZXcgQ29kZU1pcnJvcihwbGFjZSwgb3B0aW9ucyk7XG5cbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gb3B0aW9ucyA/IGNvcHlPYmoob3B0aW9ucykgOiB7fTtcbiAgICAvLyBEZXRlcm1pbmUgZWZmZWN0aXZlIG9wdGlvbnMgYmFzZWQgb24gZ2l2ZW4gdmFsdWVzIGFuZCBkZWZhdWx0cy5cbiAgICBjb3B5T2JqKGRlZmF1bHRzLCBvcHRpb25zLCBmYWxzZSk7XG4gICAgc2V0R3V0dGVyc0ZvckxpbmVOdW1iZXJzKG9wdGlvbnMpO1xuXG4gICAgdmFyIGRvYyA9IG9wdGlvbnMudmFsdWU7XG4gICAgaWYgKHR5cGVvZiBkb2MgPT0gXCJzdHJpbmdcIikgZG9jID0gbmV3IERvYyhkb2MsIG9wdGlvbnMubW9kZSwgbnVsbCwgb3B0aW9ucy5saW5lU2VwYXJhdG9yKTtcbiAgICB0aGlzLmRvYyA9IGRvYztcblxuICAgIHZhciBpbnB1dCA9IG5ldyBDb2RlTWlycm9yLmlucHV0U3R5bGVzW29wdGlvbnMuaW5wdXRTdHlsZV0odGhpcyk7XG4gICAgdmFyIGRpc3BsYXkgPSB0aGlzLmRpc3BsYXkgPSBuZXcgRGlzcGxheShwbGFjZSwgZG9jLCBpbnB1dCk7XG4gICAgZGlzcGxheS53cmFwcGVyLkNvZGVNaXJyb3IgPSB0aGlzO1xuICAgIHVwZGF0ZUd1dHRlcnModGhpcyk7XG4gICAgdGhlbWVDaGFuZ2VkKHRoaXMpO1xuICAgIGlmIChvcHRpb25zLmxpbmVXcmFwcGluZylcbiAgICAgIHRoaXMuZGlzcGxheS53cmFwcGVyLmNsYXNzTmFtZSArPSBcIiBDb2RlTWlycm9yLXdyYXBcIjtcbiAgICBpZiAob3B0aW9ucy5hdXRvZm9jdXMgJiYgIW1vYmlsZSkgZGlzcGxheS5pbnB1dC5mb2N1cygpO1xuICAgIGluaXRTY3JvbGxiYXJzKHRoaXMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGtleU1hcHM6IFtdLCAgLy8gc3RvcmVzIG1hcHMgYWRkZWQgYnkgYWRkS2V5TWFwXG4gICAgICBvdmVybGF5czogW10sIC8vIGhpZ2hsaWdodGluZyBvdmVybGF5cywgYXMgYWRkZWQgYnkgYWRkT3ZlcmxheVxuICAgICAgbW9kZUdlbjogMCwgICAvLyBidW1wZWQgd2hlbiBtb2RlL292ZXJsYXkgY2hhbmdlcywgdXNlZCB0byBpbnZhbGlkYXRlIGhpZ2hsaWdodGluZyBpbmZvXG4gICAgICBvdmVyd3JpdGU6IGZhbHNlLFxuICAgICAgZGVsYXlpbmdCbHVyRXZlbnQ6IGZhbHNlLFxuICAgICAgZm9jdXNlZDogZmFsc2UsXG4gICAgICBzdXBwcmVzc0VkaXRzOiBmYWxzZSwgLy8gdXNlZCB0byBkaXNhYmxlIGVkaXRpbmcgZHVyaW5nIGtleSBoYW5kbGVycyB3aGVuIGluIHJlYWRPbmx5IG1vZGVcbiAgICAgIHBhc3RlSW5jb21pbmc6IGZhbHNlLCBjdXRJbmNvbWluZzogZmFsc2UsIC8vIGhlbHAgcmVjb2duaXplIHBhc3RlL2N1dCBlZGl0cyBpbiBpbnB1dC5wb2xsXG4gICAgICBzZWxlY3RpbmdUZXh0OiBmYWxzZSxcbiAgICAgIGRyYWdnaW5nVGV4dDogZmFsc2UsXG4gICAgICBoaWdobGlnaHQ6IG5ldyBEZWxheWVkKCksIC8vIHN0b3JlcyBoaWdobGlnaHQgd29ya2VyIHRpbWVvdXRcbiAgICAgIGtleVNlcTogbnVsbCwgIC8vIFVuZmluaXNoZWQga2V5IHNlcXVlbmNlXG4gICAgICBzcGVjaWFsQ2hhcnM6IG51bGxcbiAgICB9O1xuXG4gICAgdmFyIGNtID0gdGhpcztcblxuICAgIC8vIE92ZXJyaWRlIG1hZ2ljIHRleHRhcmVhIGNvbnRlbnQgcmVzdG9yZSB0aGF0IElFIHNvbWV0aW1lcyBkb2VzXG4gICAgLy8gb24gb3VyIGhpZGRlbiB0ZXh0YXJlYSBvbiByZWxvYWRcbiAgICBpZiAoaWUgJiYgaWVfdmVyc2lvbiA8IDExKSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjbS5kaXNwbGF5LmlucHV0LnJlc2V0KHRydWUpOyB9LCAyMCk7XG5cbiAgICByZWdpc3RlckV2ZW50SGFuZGxlcnModGhpcyk7XG4gICAgZW5zdXJlR2xvYmFsSGFuZGxlcnMoKTtcblxuICAgIHN0YXJ0T3BlcmF0aW9uKHRoaXMpO1xuICAgIHRoaXMuY3VyT3AuZm9yY2VVcGRhdGUgPSB0cnVlO1xuICAgIGF0dGFjaERvYyh0aGlzLCBkb2MpO1xuXG4gICAgaWYgKChvcHRpb25zLmF1dG9mb2N1cyAmJiAhbW9iaWxlKSB8fCBjbS5oYXNGb2N1cygpKVxuICAgICAgc2V0VGltZW91dChiaW5kKG9uRm9jdXMsIHRoaXMpLCAyMCk7XG4gICAgZWxzZVxuICAgICAgb25CbHVyKHRoaXMpO1xuXG4gICAgZm9yICh2YXIgb3B0IGluIG9wdGlvbkhhbmRsZXJzKSBpZiAob3B0aW9uSGFuZGxlcnMuaGFzT3duUHJvcGVydHkob3B0KSlcbiAgICAgIG9wdGlvbkhhbmRsZXJzW29wdF0odGhpcywgb3B0aW9uc1tvcHRdLCBJbml0KTtcbiAgICBtYXliZVVwZGF0ZUxpbmVOdW1iZXJXaWR0aCh0aGlzKTtcbiAgICBpZiAob3B0aW9ucy5maW5pc2hJbml0KSBvcHRpb25zLmZpbmlzaEluaXQodGhpcyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbml0SG9va3MubGVuZ3RoOyArK2kpIGluaXRIb29rc1tpXSh0aGlzKTtcbiAgICBlbmRPcGVyYXRpb24odGhpcyk7XG4gICAgLy8gU3VwcHJlc3Mgb3B0aW1pemVsZWdpYmlsaXR5IGluIFdlYmtpdCwgc2luY2UgaXQgYnJlYWtzIHRleHRcbiAgICAvLyBtZWFzdXJpbmcgb24gbGluZSB3cmFwcGluZyBib3VuZGFyaWVzLlxuICAgIGlmICh3ZWJraXQgJiYgb3B0aW9ucy5saW5lV3JhcHBpbmcgJiZcbiAgICAgICAgZ2V0Q29tcHV0ZWRTdHlsZShkaXNwbGF5LmxpbmVEaXYpLnRleHRSZW5kZXJpbmcgPT0gXCJvcHRpbWl6ZWxlZ2liaWxpdHlcIilcbiAgICAgIGRpc3BsYXkubGluZURpdi5zdHlsZS50ZXh0UmVuZGVyaW5nID0gXCJhdXRvXCI7XG4gIH1cblxuICAvLyBESVNQTEFZIENPTlNUUlVDVE9SXG5cbiAgLy8gVGhlIGRpc3BsYXkgaGFuZGxlcyB0aGUgRE9NIGludGVncmF0aW9uLCBib3RoIGZvciBpbnB1dCByZWFkaW5nXG4gIC8vIGFuZCBjb250ZW50IGRyYXdpbmcuIEl0IGhvbGRzIHJlZmVyZW5jZXMgdG8gRE9NIG5vZGVzIGFuZFxuICAvLyBkaXNwbGF5LXJlbGF0ZWQgc3RhdGUuXG5cbiAgZnVuY3Rpb24gRGlzcGxheShwbGFjZSwgZG9jLCBpbnB1dCkge1xuICAgIHZhciBkID0gdGhpcztcbiAgICB0aGlzLmlucHV0ID0gaW5wdXQ7XG5cbiAgICAvLyBDb3ZlcnMgYm90dG9tLXJpZ2h0IHNxdWFyZSB3aGVuIGJvdGggc2Nyb2xsYmFycyBhcmUgcHJlc2VudC5cbiAgICBkLnNjcm9sbGJhckZpbGxlciA9IGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3Itc2Nyb2xsYmFyLWZpbGxlclwiKTtcbiAgICBkLnNjcm9sbGJhckZpbGxlci5zZXRBdHRyaWJ1dGUoXCJjbS1ub3QtY29udGVudFwiLCBcInRydWVcIik7XG4gICAgLy8gQ292ZXJzIGJvdHRvbSBvZiBndXR0ZXIgd2hlbiBjb3Zlckd1dHRlck5leHRUb1Njcm9sbGJhciBpcyBvblxuICAgIC8vIGFuZCBoIHNjcm9sbGJhciBpcyBwcmVzZW50LlxuICAgIGQuZ3V0dGVyRmlsbGVyID0gZWx0KFwiZGl2XCIsIG51bGwsIFwiQ29kZU1pcnJvci1ndXR0ZXItZmlsbGVyXCIpO1xuICAgIGQuZ3V0dGVyRmlsbGVyLnNldEF0dHJpYnV0ZShcImNtLW5vdC1jb250ZW50XCIsIFwidHJ1ZVwiKTtcbiAgICAvLyBXaWxsIGNvbnRhaW4gdGhlIGFjdHVhbCBjb2RlLCBwb3NpdGlvbmVkIHRvIGNvdmVyIHRoZSB2aWV3cG9ydC5cbiAgICBkLmxpbmVEaXYgPSBlbHQoXCJkaXZcIiwgbnVsbCwgXCJDb2RlTWlycm9yLWNvZGVcIik7XG4gICAgLy8gRWxlbWVudHMgYXJlIGFkZGVkIHRvIHRoZXNlIHRvIHJlcHJlc2VudCBzZWxlY3Rpb24gYW5kIGN1cnNvcnMuXG4gICAgZC5zZWxlY3Rpb25EaXYgPSBlbHQoXCJkaXZcIiwgbnVsbCwgbnVsbCwgXCJwb3NpdGlvbjogcmVsYXRpdmU7IHotaW5kZXg6IDFcIik7XG4gICAgZC5jdXJzb3JEaXYgPSBlbHQoXCJkaXZcIiwgbnVsbCwgXCJDb2RlTWlycm9yLWN1cnNvcnNcIik7XG4gICAgLy8gQSB2aXNpYmlsaXR5OiBoaWRkZW4gZWxlbWVudCB1c2VkIHRvIGZpbmQgdGhlIHNpemUgb2YgdGhpbmdzLlxuICAgIGQubWVhc3VyZSA9IGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3ItbWVhc3VyZVwiKTtcbiAgICAvLyBXaGVuIGxpbmVzIG91dHNpZGUgb2YgdGhlIHZpZXdwb3J0IGFyZSBtZWFzdXJlZCwgdGhleSBhcmUgZHJhd24gaW4gdGhpcy5cbiAgICBkLmxpbmVNZWFzdXJlID0gZWx0KFwiZGl2XCIsIG51bGwsIFwiQ29kZU1pcnJvci1tZWFzdXJlXCIpO1xuICAgIC8vIFdyYXBzIGV2ZXJ5dGhpbmcgdGhhdCBuZWVkcyB0byBleGlzdCBpbnNpZGUgdGhlIHZlcnRpY2FsbHktcGFkZGVkIGNvb3JkaW5hdGUgc3lzdGVtXG4gICAgZC5saW5lU3BhY2UgPSBlbHQoXCJkaXZcIiwgW2QubWVhc3VyZSwgZC5saW5lTWVhc3VyZSwgZC5zZWxlY3Rpb25EaXYsIGQuY3Vyc29yRGl2LCBkLmxpbmVEaXZdLFxuICAgICAgICAgICAgICAgICAgICAgIG51bGwsIFwicG9zaXRpb246IHJlbGF0aXZlOyBvdXRsaW5lOiBub25lXCIpO1xuICAgIC8vIE1vdmVkIGFyb3VuZCBpdHMgcGFyZW50IHRvIGNvdmVyIHZpc2libGUgdmlldy5cbiAgICBkLm1vdmVyID0gZWx0KFwiZGl2XCIsIFtlbHQoXCJkaXZcIiwgW2QubGluZVNwYWNlXSwgXCJDb2RlTWlycm9yLWxpbmVzXCIpXSwgbnVsbCwgXCJwb3NpdGlvbjogcmVsYXRpdmVcIik7XG4gICAgLy8gU2V0IHRvIHRoZSBoZWlnaHQgb2YgdGhlIGRvY3VtZW50LCBhbGxvd2luZyBzY3JvbGxpbmcuXG4gICAgZC5zaXplciA9IGVsdChcImRpdlwiLCBbZC5tb3Zlcl0sIFwiQ29kZU1pcnJvci1zaXplclwiKTtcbiAgICBkLnNpemVyV2lkdGggPSBudWxsO1xuICAgIC8vIEJlaGF2aW9yIG9mIGVsdHMgd2l0aCBvdmVyZmxvdzogYXV0byBhbmQgcGFkZGluZyBpc1xuICAgIC8vIGluY29uc2lzdGVudCBhY3Jvc3MgYnJvd3NlcnMuIFRoaXMgaXMgdXNlZCB0byBlbnN1cmUgdGhlXG4gICAgLy8gc2Nyb2xsYWJsZSBhcmVhIGlzIGJpZyBlbm91Z2guXG4gICAgZC5oZWlnaHRGb3JjZXIgPSBlbHQoXCJkaXZcIiwgbnVsbCwgbnVsbCwgXCJwb3NpdGlvbjogYWJzb2x1dGU7IGhlaWdodDogXCIgKyBzY3JvbGxlckdhcCArIFwicHg7IHdpZHRoOiAxcHg7XCIpO1xuICAgIC8vIFdpbGwgY29udGFpbiB0aGUgZ3V0dGVycywgaWYgYW55LlxuICAgIGQuZ3V0dGVycyA9IGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3ItZ3V0dGVyc1wiKTtcbiAgICBkLmxpbmVHdXR0ZXIgPSBudWxsO1xuICAgIC8vIEFjdHVhbCBzY3JvbGxhYmxlIGVsZW1lbnQuXG4gICAgZC5zY3JvbGxlciA9IGVsdChcImRpdlwiLCBbZC5zaXplciwgZC5oZWlnaHRGb3JjZXIsIGQuZ3V0dGVyc10sIFwiQ29kZU1pcnJvci1zY3JvbGxcIik7XG4gICAgZC5zY3JvbGxlci5zZXRBdHRyaWJ1dGUoXCJ0YWJJbmRleFwiLCBcIi0xXCIpO1xuICAgIC8vIFRoZSBlbGVtZW50IGluIHdoaWNoIHRoZSBlZGl0b3IgbGl2ZXMuXG4gICAgZC53cmFwcGVyID0gZWx0KFwiZGl2XCIsIFtkLnNjcm9sbGJhckZpbGxlciwgZC5ndXR0ZXJGaWxsZXIsIGQuc2Nyb2xsZXJdLCBcIkNvZGVNaXJyb3JcIik7XG5cbiAgICAvLyBXb3JrIGFyb3VuZCBJRTcgei1pbmRleCBidWcgKG5vdCBwZXJmZWN0LCBoZW5jZSBJRTcgbm90IHJlYWxseSBiZWluZyBzdXBwb3J0ZWQpXG4gICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCA4KSB7IGQuZ3V0dGVycy5zdHlsZS56SW5kZXggPSAtMTsgZC5zY3JvbGxlci5zdHlsZS5wYWRkaW5nUmlnaHQgPSAwOyB9XG4gICAgaWYgKCF3ZWJraXQgJiYgIShnZWNrbyAmJiBtb2JpbGUpKSBkLnNjcm9sbGVyLmRyYWdnYWJsZSA9IHRydWU7XG5cbiAgICBpZiAocGxhY2UpIHtcbiAgICAgIGlmIChwbGFjZS5hcHBlbmRDaGlsZCkgcGxhY2UuYXBwZW5kQ2hpbGQoZC53cmFwcGVyKTtcbiAgICAgIGVsc2UgcGxhY2UoZC53cmFwcGVyKTtcbiAgICB9XG5cbiAgICAvLyBDdXJyZW50IHJlbmRlcmVkIHJhbmdlIChtYXkgYmUgYmlnZ2VyIHRoYW4gdGhlIHZpZXcgd2luZG93KS5cbiAgICBkLnZpZXdGcm9tID0gZC52aWV3VG8gPSBkb2MuZmlyc3Q7XG4gICAgZC5yZXBvcnRlZFZpZXdGcm9tID0gZC5yZXBvcnRlZFZpZXdUbyA9IGRvYy5maXJzdDtcbiAgICAvLyBJbmZvcm1hdGlvbiBhYm91dCB0aGUgcmVuZGVyZWQgbGluZXMuXG4gICAgZC52aWV3ID0gW107XG4gICAgZC5yZW5kZXJlZFZpZXcgPSBudWxsO1xuICAgIC8vIEhvbGRzIGluZm8gYWJvdXQgYSBzaW5nbGUgcmVuZGVyZWQgbGluZSB3aGVuIGl0IHdhcyByZW5kZXJlZFxuICAgIC8vIGZvciBtZWFzdXJlbWVudCwgd2hpbGUgbm90IGluIHZpZXcuXG4gICAgZC5leHRlcm5hbE1lYXN1cmVkID0gbnVsbDtcbiAgICAvLyBFbXB0eSBzcGFjZSAoaW4gcGl4ZWxzKSBhYm92ZSB0aGUgdmlld1xuICAgIGQudmlld09mZnNldCA9IDA7XG4gICAgZC5sYXN0V3JhcEhlaWdodCA9IGQubGFzdFdyYXBXaWR0aCA9IDA7XG4gICAgZC51cGRhdGVMaW5lTnVtYmVycyA9IG51bGw7XG5cbiAgICBkLm5hdGl2ZUJhcldpZHRoID0gZC5iYXJIZWlnaHQgPSBkLmJhcldpZHRoID0gMDtcbiAgICBkLnNjcm9sbGJhcnNDbGlwcGVkID0gZmFsc2U7XG5cbiAgICAvLyBVc2VkIHRvIG9ubHkgcmVzaXplIHRoZSBsaW5lIG51bWJlciBndXR0ZXIgd2hlbiBuZWNlc3NhcnkgKHdoZW5cbiAgICAvLyB0aGUgYW1vdW50IG9mIGxpbmVzIGNyb3NzZXMgYSBib3VuZGFyeSB0aGF0IG1ha2VzIGl0cyB3aWR0aCBjaGFuZ2UpXG4gICAgZC5saW5lTnVtV2lkdGggPSBkLmxpbmVOdW1Jbm5lcldpZHRoID0gZC5saW5lTnVtQ2hhcnMgPSBudWxsO1xuICAgIC8vIFNldCB0byB0cnVlIHdoZW4gYSBub24taG9yaXpvbnRhbC1zY3JvbGxpbmcgbGluZSB3aWRnZXQgaXNcbiAgICAvLyBhZGRlZC4gQXMgYW4gb3B0aW1pemF0aW9uLCBsaW5lIHdpZGdldCBhbGlnbmluZyBpcyBza2lwcGVkIHdoZW5cbiAgICAvLyB0aGlzIGlzIGZhbHNlLlxuICAgIGQuYWxpZ25XaWRnZXRzID0gZmFsc2U7XG5cbiAgICBkLmNhY2hlZENoYXJXaWR0aCA9IGQuY2FjaGVkVGV4dEhlaWdodCA9IGQuY2FjaGVkUGFkZGluZ0ggPSBudWxsO1xuXG4gICAgLy8gVHJhY2tzIHRoZSBtYXhpbXVtIGxpbmUgbGVuZ3RoIHNvIHRoYXQgdGhlIGhvcml6b250YWwgc2Nyb2xsYmFyXG4gICAgLy8gY2FuIGJlIGtlcHQgc3RhdGljIHdoZW4gc2Nyb2xsaW5nLlxuICAgIGQubWF4TGluZSA9IG51bGw7XG4gICAgZC5tYXhMaW5lTGVuZ3RoID0gMDtcbiAgICBkLm1heExpbmVDaGFuZ2VkID0gZmFsc2U7XG5cbiAgICAvLyBVc2VkIGZvciBtZWFzdXJpbmcgd2hlZWwgc2Nyb2xsaW5nIGdyYW51bGFyaXR5XG4gICAgZC53aGVlbERYID0gZC53aGVlbERZID0gZC53aGVlbFN0YXJ0WCA9IGQud2hlZWxTdGFydFkgPSBudWxsO1xuXG4gICAgLy8gVHJ1ZSB3aGVuIHNoaWZ0IGlzIGhlbGQgZG93bi5cbiAgICBkLnNoaWZ0ID0gZmFsc2U7XG5cbiAgICAvLyBVc2VkIHRvIHRyYWNrIHdoZXRoZXIgYW55dGhpbmcgaGFwcGVuZWQgc2luY2UgdGhlIGNvbnRleHQgbWVudVxuICAgIC8vIHdhcyBvcGVuZWQuXG4gICAgZC5zZWxGb3JDb250ZXh0TWVudSA9IG51bGw7XG5cbiAgICBkLmFjdGl2ZVRvdWNoID0gbnVsbDtcblxuICAgIGlucHV0LmluaXQoZCk7XG4gIH1cblxuICAvLyBTVEFURSBVUERBVEVTXG5cbiAgLy8gVXNlZCB0byBnZXQgdGhlIGVkaXRvciBpbnRvIGEgY29uc2lzdGVudCBzdGF0ZSBhZ2FpbiB3aGVuIG9wdGlvbnMgY2hhbmdlLlxuXG4gIGZ1bmN0aW9uIGxvYWRNb2RlKGNtKSB7XG4gICAgY20uZG9jLm1vZGUgPSBDb2RlTWlycm9yLmdldE1vZGUoY20ub3B0aW9ucywgY20uZG9jLm1vZGVPcHRpb24pO1xuICAgIHJlc2V0TW9kZVN0YXRlKGNtKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0TW9kZVN0YXRlKGNtKSB7XG4gICAgY20uZG9jLml0ZXIoZnVuY3Rpb24obGluZSkge1xuICAgICAgaWYgKGxpbmUuc3RhdGVBZnRlcikgbGluZS5zdGF0ZUFmdGVyID0gbnVsbDtcbiAgICAgIGlmIChsaW5lLnN0eWxlcykgbGluZS5zdHlsZXMgPSBudWxsO1xuICAgIH0pO1xuICAgIGNtLmRvYy5mcm9udGllciA9IGNtLmRvYy5maXJzdDtcbiAgICBzdGFydFdvcmtlcihjbSwgMTAwKTtcbiAgICBjbS5zdGF0ZS5tb2RlR2VuKys7XG4gICAgaWYgKGNtLmN1ck9wKSByZWdDaGFuZ2UoY20pO1xuICB9XG5cbiAgZnVuY3Rpb24gd3JhcHBpbmdDaGFuZ2VkKGNtKSB7XG4gICAgaWYgKGNtLm9wdGlvbnMubGluZVdyYXBwaW5nKSB7XG4gICAgICBhZGRDbGFzcyhjbS5kaXNwbGF5LndyYXBwZXIsIFwiQ29kZU1pcnJvci13cmFwXCIpO1xuICAgICAgY20uZGlzcGxheS5zaXplci5zdHlsZS5taW5XaWR0aCA9IFwiXCI7XG4gICAgICBjbS5kaXNwbGF5LnNpemVyV2lkdGggPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBybUNsYXNzKGNtLmRpc3BsYXkud3JhcHBlciwgXCJDb2RlTWlycm9yLXdyYXBcIik7XG4gICAgICBmaW5kTWF4TGluZShjbSk7XG4gICAgfVxuICAgIGVzdGltYXRlTGluZUhlaWdodHMoY20pO1xuICAgIHJlZ0NoYW5nZShjbSk7XG4gICAgY2xlYXJDYWNoZXMoY20pO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXt1cGRhdGVTY3JvbGxiYXJzKGNtKTt9LCAxMDApO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgZXN0aW1hdGVzIHRoZSBoZWlnaHQgb2YgYSBsaW5lLCB0byB1c2UgYXNcbiAgLy8gZmlyc3QgYXBwcm94aW1hdGlvbiB1bnRpbCB0aGUgbGluZSBiZWNvbWVzIHZpc2libGUgKGFuZCBpcyB0aHVzXG4gIC8vIHByb3Blcmx5IG1lYXN1cmFibGUpLlxuICBmdW5jdGlvbiBlc3RpbWF0ZUhlaWdodChjbSkge1xuICAgIHZhciB0aCA9IHRleHRIZWlnaHQoY20uZGlzcGxheSksIHdyYXBwaW5nID0gY20ub3B0aW9ucy5saW5lV3JhcHBpbmc7XG4gICAgdmFyIHBlckxpbmUgPSB3cmFwcGluZyAmJiBNYXRoLm1heCg1LCBjbS5kaXNwbGF5LnNjcm9sbGVyLmNsaWVudFdpZHRoIC8gY2hhcldpZHRoKGNtLmRpc3BsYXkpIC0gMyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIGlmIChsaW5lSXNIaWRkZW4oY20uZG9jLCBsaW5lKSkgcmV0dXJuIDA7XG5cbiAgICAgIHZhciB3aWRnZXRzSGVpZ2h0ID0gMDtcbiAgICAgIGlmIChsaW5lLndpZGdldHMpIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZS53aWRnZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChsaW5lLndpZGdldHNbaV0uaGVpZ2h0KSB3aWRnZXRzSGVpZ2h0ICs9IGxpbmUud2lkZ2V0c1tpXS5oZWlnaHQ7XG4gICAgICB9XG5cbiAgICAgIGlmICh3cmFwcGluZylcbiAgICAgICAgcmV0dXJuIHdpZGdldHNIZWlnaHQgKyAoTWF0aC5jZWlsKGxpbmUudGV4dC5sZW5ndGggLyBwZXJMaW5lKSB8fCAxKSAqIHRoO1xuICAgICAgZWxzZVxuICAgICAgICByZXR1cm4gd2lkZ2V0c0hlaWdodCArIHRoO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBlc3RpbWF0ZUxpbmVIZWlnaHRzKGNtKSB7XG4gICAgdmFyIGRvYyA9IGNtLmRvYywgZXN0ID0gZXN0aW1hdGVIZWlnaHQoY20pO1xuICAgIGRvYy5pdGVyKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHZhciBlc3RIZWlnaHQgPSBlc3QobGluZSk7XG4gICAgICBpZiAoZXN0SGVpZ2h0ICE9IGxpbmUuaGVpZ2h0KSB1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsIGVzdEhlaWdodCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB0aGVtZUNoYW5nZWQoY20pIHtcbiAgICBjbS5kaXNwbGF5LndyYXBwZXIuY2xhc3NOYW1lID0gY20uZGlzcGxheS53cmFwcGVyLmNsYXNzTmFtZS5yZXBsYWNlKC9cXHMqY20tcy1cXFMrL2csIFwiXCIpICtcbiAgICAgIGNtLm9wdGlvbnMudGhlbWUucmVwbGFjZSgvKF58XFxzKVxccyovZywgXCIgY20tcy1cIik7XG4gICAgY2xlYXJDYWNoZXMoY20pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ3V0dGVyc0NoYW5nZWQoY20pIHtcbiAgICB1cGRhdGVHdXR0ZXJzKGNtKTtcbiAgICByZWdDaGFuZ2UoY20pO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXthbGlnbkhvcml6b250YWxseShjbSk7fSwgMjApO1xuICB9XG5cbiAgLy8gUmVidWlsZCB0aGUgZ3V0dGVyIGVsZW1lbnRzLCBlbnN1cmUgdGhlIG1hcmdpbiB0byB0aGUgbGVmdCBvZiB0aGVcbiAgLy8gY29kZSBtYXRjaGVzIHRoZWlyIHdpZHRoLlxuICBmdW5jdGlvbiB1cGRhdGVHdXR0ZXJzKGNtKSB7XG4gICAgdmFyIGd1dHRlcnMgPSBjbS5kaXNwbGF5Lmd1dHRlcnMsIHNwZWNzID0gY20ub3B0aW9ucy5ndXR0ZXJzO1xuICAgIHJlbW92ZUNoaWxkcmVuKGd1dHRlcnMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlY3MubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBndXR0ZXJDbGFzcyA9IHNwZWNzW2ldO1xuICAgICAgdmFyIGdFbHQgPSBndXR0ZXJzLmFwcGVuZENoaWxkKGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3ItZ3V0dGVyIFwiICsgZ3V0dGVyQ2xhc3MpKTtcbiAgICAgIGlmIChndXR0ZXJDbGFzcyA9PSBcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIikge1xuICAgICAgICBjbS5kaXNwbGF5LmxpbmVHdXR0ZXIgPSBnRWx0O1xuICAgICAgICBnRWx0LnN0eWxlLndpZHRoID0gKGNtLmRpc3BsYXkubGluZU51bVdpZHRoIHx8IDEpICsgXCJweFwiO1xuICAgICAgfVxuICAgIH1cbiAgICBndXR0ZXJzLnN0eWxlLmRpc3BsYXkgPSBpID8gXCJcIiA6IFwibm9uZVwiO1xuICAgIHVwZGF0ZUd1dHRlclNwYWNlKGNtKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZUd1dHRlclNwYWNlKGNtKSB7XG4gICAgdmFyIHdpZHRoID0gY20uZGlzcGxheS5ndXR0ZXJzLm9mZnNldFdpZHRoO1xuICAgIGNtLmRpc3BsYXkuc2l6ZXIuc3R5bGUubWFyZ2luTGVmdCA9IHdpZHRoICsgXCJweFwiO1xuICB9XG5cbiAgLy8gQ29tcHV0ZSB0aGUgY2hhcmFjdGVyIGxlbmd0aCBvZiBhIGxpbmUsIHRha2luZyBpbnRvIGFjY291bnRcbiAgLy8gY29sbGFwc2VkIHJhbmdlcyAoc2VlIG1hcmtUZXh0KSB0aGF0IG1pZ2h0IGhpZGUgcGFydHMsIGFuZCBqb2luXG4gIC8vIG90aGVyIGxpbmVzIG9udG8gaXQuXG4gIGZ1bmN0aW9uIGxpbmVMZW5ndGgobGluZSkge1xuICAgIGlmIChsaW5lLmhlaWdodCA9PSAwKSByZXR1cm4gMDtcbiAgICB2YXIgbGVuID0gbGluZS50ZXh0Lmxlbmd0aCwgbWVyZ2VkLCBjdXIgPSBsaW5lO1xuICAgIHdoaWxlIChtZXJnZWQgPSBjb2xsYXBzZWRTcGFuQXRTdGFydChjdXIpKSB7XG4gICAgICB2YXIgZm91bmQgPSBtZXJnZWQuZmluZCgwLCB0cnVlKTtcbiAgICAgIGN1ciA9IGZvdW5kLmZyb20ubGluZTtcbiAgICAgIGxlbiArPSBmb3VuZC5mcm9tLmNoIC0gZm91bmQudG8uY2g7XG4gICAgfVxuICAgIGN1ciA9IGxpbmU7XG4gICAgd2hpbGUgKG1lcmdlZCA9IGNvbGxhcHNlZFNwYW5BdEVuZChjdXIpKSB7XG4gICAgICB2YXIgZm91bmQgPSBtZXJnZWQuZmluZCgwLCB0cnVlKTtcbiAgICAgIGxlbiAtPSBjdXIudGV4dC5sZW5ndGggLSBmb3VuZC5mcm9tLmNoO1xuICAgICAgY3VyID0gZm91bmQudG8ubGluZTtcbiAgICAgIGxlbiArPSBjdXIudGV4dC5sZW5ndGggLSBmb3VuZC50by5jaDtcbiAgICB9XG4gICAgcmV0dXJuIGxlbjtcbiAgfVxuXG4gIC8vIEZpbmQgdGhlIGxvbmdlc3QgbGluZSBpbiB0aGUgZG9jdW1lbnQuXG4gIGZ1bmN0aW9uIGZpbmRNYXhMaW5lKGNtKSB7XG4gICAgdmFyIGQgPSBjbS5kaXNwbGF5LCBkb2MgPSBjbS5kb2M7XG4gICAgZC5tYXhMaW5lID0gZ2V0TGluZShkb2MsIGRvYy5maXJzdCk7XG4gICAgZC5tYXhMaW5lTGVuZ3RoID0gbGluZUxlbmd0aChkLm1heExpbmUpO1xuICAgIGQubWF4TGluZUNoYW5nZWQgPSB0cnVlO1xuICAgIGRvYy5pdGVyKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIHZhciBsZW4gPSBsaW5lTGVuZ3RoKGxpbmUpO1xuICAgICAgaWYgKGxlbiA+IGQubWF4TGluZUxlbmd0aCkge1xuICAgICAgICBkLm1heExpbmVMZW5ndGggPSBsZW47XG4gICAgICAgIGQubWF4TGluZSA9IGxpbmU7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBNYWtlIHN1cmUgdGhlIGd1dHRlcnMgb3B0aW9ucyBjb250YWlucyB0aGUgZWxlbWVudFxuICAvLyBcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIiB3aGVuIHRoZSBsaW5lTnVtYmVycyBvcHRpb24gaXMgdHJ1ZS5cbiAgZnVuY3Rpb24gc2V0R3V0dGVyc0ZvckxpbmVOdW1iZXJzKG9wdGlvbnMpIHtcbiAgICB2YXIgZm91bmQgPSBpbmRleE9mKG9wdGlvbnMuZ3V0dGVycywgXCJDb2RlTWlycm9yLWxpbmVudW1iZXJzXCIpO1xuICAgIGlmIChmb3VuZCA9PSAtMSAmJiBvcHRpb25zLmxpbmVOdW1iZXJzKSB7XG4gICAgICBvcHRpb25zLmd1dHRlcnMgPSBvcHRpb25zLmd1dHRlcnMuY29uY2F0KFtcIkNvZGVNaXJyb3ItbGluZW51bWJlcnNcIl0pO1xuICAgIH0gZWxzZSBpZiAoZm91bmQgPiAtMSAmJiAhb3B0aW9ucy5saW5lTnVtYmVycykge1xuICAgICAgb3B0aW9ucy5ndXR0ZXJzID0gb3B0aW9ucy5ndXR0ZXJzLnNsaWNlKDApO1xuICAgICAgb3B0aW9ucy5ndXR0ZXJzLnNwbGljZShmb3VuZCwgMSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU0NST0xMQkFSU1xuXG4gIC8vIFByZXBhcmUgRE9NIHJlYWRzIG5lZWRlZCB0byB1cGRhdGUgdGhlIHNjcm9sbGJhcnMuIERvbmUgaW4gb25lXG4gIC8vIHNob3QgdG8gbWluaW1pemUgdXBkYXRlL21lYXN1cmUgcm91bmR0cmlwcy5cbiAgZnVuY3Rpb24gbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pIHtcbiAgICB2YXIgZCA9IGNtLmRpc3BsYXksIGd1dHRlclcgPSBkLmd1dHRlcnMub2Zmc2V0V2lkdGg7XG4gICAgdmFyIGRvY0ggPSBNYXRoLnJvdW5kKGNtLmRvYy5oZWlnaHQgKyBwYWRkaW5nVmVydChjbS5kaXNwbGF5KSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNsaWVudEhlaWdodDogZC5zY3JvbGxlci5jbGllbnRIZWlnaHQsXG4gICAgICB2aWV3SGVpZ2h0OiBkLndyYXBwZXIuY2xpZW50SGVpZ2h0LFxuICAgICAgc2Nyb2xsV2lkdGg6IGQuc2Nyb2xsZXIuc2Nyb2xsV2lkdGgsIGNsaWVudFdpZHRoOiBkLnNjcm9sbGVyLmNsaWVudFdpZHRoLFxuICAgICAgdmlld1dpZHRoOiBkLndyYXBwZXIuY2xpZW50V2lkdGgsXG4gICAgICBiYXJMZWZ0OiBjbS5vcHRpb25zLmZpeGVkR3V0dGVyID8gZ3V0dGVyVyA6IDAsXG4gICAgICBkb2NIZWlnaHQ6IGRvY0gsXG4gICAgICBzY3JvbGxIZWlnaHQ6IGRvY0ggKyBzY3JvbGxHYXAoY20pICsgZC5iYXJIZWlnaHQsXG4gICAgICBuYXRpdmVCYXJXaWR0aDogZC5uYXRpdmVCYXJXaWR0aCxcbiAgICAgIGd1dHRlcldpZHRoOiBndXR0ZXJXXG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIE5hdGl2ZVNjcm9sbGJhcnMocGxhY2UsIHNjcm9sbCwgY20pIHtcbiAgICB0aGlzLmNtID0gY207XG4gICAgdmFyIHZlcnQgPSB0aGlzLnZlcnQgPSBlbHQoXCJkaXZcIiwgW2VsdChcImRpdlwiLCBudWxsLCBudWxsLCBcIm1pbi13aWR0aDogMXB4XCIpXSwgXCJDb2RlTWlycm9yLXZzY3JvbGxiYXJcIik7XG4gICAgdmFyIGhvcml6ID0gdGhpcy5ob3JpeiA9IGVsdChcImRpdlwiLCBbZWx0KFwiZGl2XCIsIG51bGwsIG51bGwsIFwiaGVpZ2h0OiAxMDAlOyBtaW4taGVpZ2h0OiAxcHhcIildLCBcIkNvZGVNaXJyb3ItaHNjcm9sbGJhclwiKTtcbiAgICBwbGFjZSh2ZXJ0KTsgcGxhY2UoaG9yaXopO1xuXG4gICAgb24odmVydCwgXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodmVydC5jbGllbnRIZWlnaHQpIHNjcm9sbCh2ZXJ0LnNjcm9sbFRvcCwgXCJ2ZXJ0aWNhbFwiKTtcbiAgICB9KTtcbiAgICBvbihob3JpeiwgXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoaG9yaXouY2xpZW50V2lkdGgpIHNjcm9sbChob3Jpei5zY3JvbGxMZWZ0LCBcImhvcml6b250YWxcIik7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNoZWNrZWRPdmVybGF5ID0gZmFsc2U7XG4gICAgLy8gTmVlZCB0byBzZXQgYSBtaW5pbXVtIHdpZHRoIHRvIHNlZSB0aGUgc2Nyb2xsYmFyIG9uIElFNyAoYnV0IG11c3Qgbm90IHNldCBpdCBvbiBJRTgpLlxuICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgOCkgdGhpcy5ob3Jpei5zdHlsZS5taW5IZWlnaHQgPSB0aGlzLnZlcnQuc3R5bGUubWluV2lkdGggPSBcIjE4cHhcIjtcbiAgfVxuXG4gIE5hdGl2ZVNjcm9sbGJhcnMucHJvdG90eXBlID0gY29weU9iaih7XG4gICAgdXBkYXRlOiBmdW5jdGlvbihtZWFzdXJlKSB7XG4gICAgICB2YXIgbmVlZHNIID0gbWVhc3VyZS5zY3JvbGxXaWR0aCA+IG1lYXN1cmUuY2xpZW50V2lkdGggKyAxO1xuICAgICAgdmFyIG5lZWRzViA9IG1lYXN1cmUuc2Nyb2xsSGVpZ2h0ID4gbWVhc3VyZS5jbGllbnRIZWlnaHQgKyAxO1xuICAgICAgdmFyIHNXaWR0aCA9IG1lYXN1cmUubmF0aXZlQmFyV2lkdGg7XG5cbiAgICAgIGlmIChuZWVkc1YpIHtcbiAgICAgICAgdGhpcy52ZXJ0LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgIHRoaXMudmVydC5zdHlsZS5ib3R0b20gPSBuZWVkc0ggPyBzV2lkdGggKyBcInB4XCIgOiBcIjBcIjtcbiAgICAgICAgdmFyIHRvdGFsSGVpZ2h0ID0gbWVhc3VyZS52aWV3SGVpZ2h0IC0gKG5lZWRzSCA/IHNXaWR0aCA6IDApO1xuICAgICAgICAvLyBBIGJ1ZyBpbiBJRTggY2FuIGNhdXNlIHRoaXMgdmFsdWUgdG8gYmUgbmVnYXRpdmUsIHNvIGd1YXJkIGl0LlxuICAgICAgICB0aGlzLnZlcnQuZmlyc3RDaGlsZC5zdHlsZS5oZWlnaHQgPVxuICAgICAgICAgIE1hdGgubWF4KDAsIG1lYXN1cmUuc2Nyb2xsSGVpZ2h0IC0gbWVhc3VyZS5jbGllbnRIZWlnaHQgKyB0b3RhbEhlaWdodCkgKyBcInB4XCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnZlcnQuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgICAgIHRoaXMudmVydC5maXJzdENoaWxkLnN0eWxlLmhlaWdodCA9IFwiMFwiO1xuICAgICAgfVxuXG4gICAgICBpZiAobmVlZHNIKSB7XG4gICAgICAgIHRoaXMuaG9yaXouc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgdGhpcy5ob3Jpei5zdHlsZS5yaWdodCA9IG5lZWRzViA/IHNXaWR0aCArIFwicHhcIiA6IFwiMFwiO1xuICAgICAgICB0aGlzLmhvcml6LnN0eWxlLmxlZnQgPSBtZWFzdXJlLmJhckxlZnQgKyBcInB4XCI7XG4gICAgICAgIHZhciB0b3RhbFdpZHRoID0gbWVhc3VyZS52aWV3V2lkdGggLSBtZWFzdXJlLmJhckxlZnQgLSAobmVlZHNWID8gc1dpZHRoIDogMCk7XG4gICAgICAgIHRoaXMuaG9yaXouZmlyc3RDaGlsZC5zdHlsZS53aWR0aCA9XG4gICAgICAgICAgKG1lYXN1cmUuc2Nyb2xsV2lkdGggLSBtZWFzdXJlLmNsaWVudFdpZHRoICsgdG90YWxXaWR0aCkgKyBcInB4XCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhvcml6LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICB0aGlzLmhvcml6LmZpcnN0Q2hpbGQuc3R5bGUud2lkdGggPSBcIjBcIjtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmNoZWNrZWRPdmVybGF5ICYmIG1lYXN1cmUuY2xpZW50SGVpZ2h0ID4gMCkge1xuICAgICAgICBpZiAoc1dpZHRoID09IDApIHRoaXMub3ZlcmxheUhhY2soKTtcbiAgICAgICAgdGhpcy5jaGVja2VkT3ZlcmxheSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7cmlnaHQ6IG5lZWRzViA/IHNXaWR0aCA6IDAsIGJvdHRvbTogbmVlZHNIID8gc1dpZHRoIDogMH07XG4gICAgfSxcbiAgICBzZXRTY3JvbGxMZWZ0OiBmdW5jdGlvbihwb3MpIHtcbiAgICAgIGlmICh0aGlzLmhvcml6LnNjcm9sbExlZnQgIT0gcG9zKSB0aGlzLmhvcml6LnNjcm9sbExlZnQgPSBwb3M7XG4gICAgfSxcbiAgICBzZXRTY3JvbGxUb3A6IGZ1bmN0aW9uKHBvcykge1xuICAgICAgaWYgKHRoaXMudmVydC5zY3JvbGxUb3AgIT0gcG9zKSB0aGlzLnZlcnQuc2Nyb2xsVG9wID0gcG9zO1xuICAgIH0sXG4gICAgb3ZlcmxheUhhY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHcgPSBtYWMgJiYgIW1hY19nZU1vdW50YWluTGlvbiA/IFwiMTJweFwiIDogXCIxOHB4XCI7XG4gICAgICB0aGlzLmhvcml6LnN0eWxlLm1pbkhlaWdodCA9IHRoaXMudmVydC5zdHlsZS5taW5XaWR0aCA9IHc7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgYmFyTW91c2VEb3duID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoZV90YXJnZXQoZSkgIT0gc2VsZi52ZXJ0ICYmIGVfdGFyZ2V0KGUpICE9IHNlbGYuaG9yaXopXG4gICAgICAgICAgb3BlcmF0aW9uKHNlbGYuY20sIG9uTW91c2VEb3duKShlKTtcbiAgICAgIH07XG4gICAgICBvbih0aGlzLnZlcnQsIFwibW91c2Vkb3duXCIsIGJhck1vdXNlRG93bik7XG4gICAgICBvbih0aGlzLmhvcml6LCBcIm1vdXNlZG93blwiLCBiYXJNb3VzZURvd24pO1xuICAgIH0sXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBhcmVudCA9IHRoaXMuaG9yaXoucGFyZW50Tm9kZTtcbiAgICAgIHBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLmhvcml6KTtcbiAgICAgIHBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLnZlcnQpO1xuICAgIH1cbiAgfSwgTmF0aXZlU2Nyb2xsYmFycy5wcm90b3R5cGUpO1xuXG4gIGZ1bmN0aW9uIE51bGxTY3JvbGxiYXJzKCkge31cblxuICBOdWxsU2Nyb2xsYmFycy5wcm90b3R5cGUgPSBjb3B5T2JqKHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKCkgeyByZXR1cm4ge2JvdHRvbTogMCwgcmlnaHQ6IDB9OyB9LFxuICAgIHNldFNjcm9sbExlZnQ6IGZ1bmN0aW9uKCkge30sXG4gICAgc2V0U2Nyb2xsVG9wOiBmdW5jdGlvbigpIHt9LFxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHt9XG4gIH0sIE51bGxTY3JvbGxiYXJzLnByb3RvdHlwZSk7XG5cbiAgQ29kZU1pcnJvci5zY3JvbGxiYXJNb2RlbCA9IHtcIm5hdGl2ZVwiOiBOYXRpdmVTY3JvbGxiYXJzLCBcIm51bGxcIjogTnVsbFNjcm9sbGJhcnN9O1xuXG4gIGZ1bmN0aW9uIGluaXRTY3JvbGxiYXJzKGNtKSB7XG4gICAgaWYgKGNtLmRpc3BsYXkuc2Nyb2xsYmFycykge1xuICAgICAgY20uZGlzcGxheS5zY3JvbGxiYXJzLmNsZWFyKCk7XG4gICAgICBpZiAoY20uZGlzcGxheS5zY3JvbGxiYXJzLmFkZENsYXNzKVxuICAgICAgICBybUNsYXNzKGNtLmRpc3BsYXkud3JhcHBlciwgY20uZGlzcGxheS5zY3JvbGxiYXJzLmFkZENsYXNzKTtcbiAgICB9XG5cbiAgICBjbS5kaXNwbGF5LnNjcm9sbGJhcnMgPSBuZXcgQ29kZU1pcnJvci5zY3JvbGxiYXJNb2RlbFtjbS5vcHRpb25zLnNjcm9sbGJhclN0eWxlXShmdW5jdGlvbihub2RlKSB7XG4gICAgICBjbS5kaXNwbGF5LndyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vZGUsIGNtLmRpc3BsYXkuc2Nyb2xsYmFyRmlsbGVyKTtcbiAgICAgIC8vIFByZXZlbnQgY2xpY2tzIGluIHRoZSBzY3JvbGxiYXJzIGZyb20ga2lsbGluZyBmb2N1c1xuICAgICAgb24obm9kZSwgXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjbS5zdGF0ZS5mb2N1c2VkKSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjbS5kaXNwbGF5LmlucHV0LmZvY3VzKCk7IH0sIDApO1xuICAgICAgfSk7XG4gICAgICBub2RlLnNldEF0dHJpYnV0ZShcImNtLW5vdC1jb250ZW50XCIsIFwidHJ1ZVwiKTtcbiAgICB9LCBmdW5jdGlvbihwb3MsIGF4aXMpIHtcbiAgICAgIGlmIChheGlzID09IFwiaG9yaXpvbnRhbFwiKSBzZXRTY3JvbGxMZWZ0KGNtLCBwb3MpO1xuICAgICAgZWxzZSBzZXRTY3JvbGxUb3AoY20sIHBvcyk7XG4gICAgfSwgY20pO1xuICAgIGlmIChjbS5kaXNwbGF5LnNjcm9sbGJhcnMuYWRkQ2xhc3MpXG4gICAgICBhZGRDbGFzcyhjbS5kaXNwbGF5LndyYXBwZXIsIGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5hZGRDbGFzcyk7XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVTY3JvbGxiYXJzKGNtLCBtZWFzdXJlKSB7XG4gICAgaWYgKCFtZWFzdXJlKSBtZWFzdXJlID0gbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pO1xuICAgIHZhciBzdGFydFdpZHRoID0gY20uZGlzcGxheS5iYXJXaWR0aCwgc3RhcnRIZWlnaHQgPSBjbS5kaXNwbGF5LmJhckhlaWdodDtcbiAgICB1cGRhdGVTY3JvbGxiYXJzSW5uZXIoY20sIG1lYXN1cmUpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNCAmJiBzdGFydFdpZHRoICE9IGNtLmRpc3BsYXkuYmFyV2lkdGggfHwgc3RhcnRIZWlnaHQgIT0gY20uZGlzcGxheS5iYXJIZWlnaHQ7IGkrKykge1xuICAgICAgaWYgKHN0YXJ0V2lkdGggIT0gY20uZGlzcGxheS5iYXJXaWR0aCAmJiBjbS5vcHRpb25zLmxpbmVXcmFwcGluZylcbiAgICAgICAgdXBkYXRlSGVpZ2h0c0luVmlld3BvcnQoY20pO1xuICAgICAgdXBkYXRlU2Nyb2xsYmFyc0lubmVyKGNtLCBtZWFzdXJlRm9yU2Nyb2xsYmFycyhjbSkpO1xuICAgICAgc3RhcnRXaWR0aCA9IGNtLmRpc3BsYXkuYmFyV2lkdGg7IHN0YXJ0SGVpZ2h0ID0gY20uZGlzcGxheS5iYXJIZWlnaHQ7XG4gICAgfVxuICB9XG5cbiAgLy8gUmUtc3luY2hyb25pemUgdGhlIGZha2Ugc2Nyb2xsYmFycyB3aXRoIHRoZSBhY3R1YWwgc2l6ZSBvZiB0aGVcbiAgLy8gY29udGVudC5cbiAgZnVuY3Rpb24gdXBkYXRlU2Nyb2xsYmFyc0lubmVyKGNtLCBtZWFzdXJlKSB7XG4gICAgdmFyIGQgPSBjbS5kaXNwbGF5O1xuICAgIHZhciBzaXplcyA9IGQuc2Nyb2xsYmFycy51cGRhdGUobWVhc3VyZSk7XG5cbiAgICBkLnNpemVyLnN0eWxlLnBhZGRpbmdSaWdodCA9IChkLmJhcldpZHRoID0gc2l6ZXMucmlnaHQpICsgXCJweFwiO1xuICAgIGQuc2l6ZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IChkLmJhckhlaWdodCA9IHNpemVzLmJvdHRvbSkgKyBcInB4XCI7XG5cbiAgICBpZiAoc2l6ZXMucmlnaHQgJiYgc2l6ZXMuYm90dG9tKSB7XG4gICAgICBkLnNjcm9sbGJhckZpbGxlci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgZC5zY3JvbGxiYXJGaWxsZXIuc3R5bGUuaGVpZ2h0ID0gc2l6ZXMuYm90dG9tICsgXCJweFwiO1xuICAgICAgZC5zY3JvbGxiYXJGaWxsZXIuc3R5bGUud2lkdGggPSBzaXplcy5yaWdodCArIFwicHhcIjtcbiAgICB9IGVsc2UgZC5zY3JvbGxiYXJGaWxsZXIuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgaWYgKHNpemVzLmJvdHRvbSAmJiBjbS5vcHRpb25zLmNvdmVyR3V0dGVyTmV4dFRvU2Nyb2xsYmFyICYmIGNtLm9wdGlvbnMuZml4ZWRHdXR0ZXIpIHtcbiAgICAgIGQuZ3V0dGVyRmlsbGVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICBkLmd1dHRlckZpbGxlci5zdHlsZS5oZWlnaHQgPSBzaXplcy5ib3R0b20gKyBcInB4XCI7XG4gICAgICBkLmd1dHRlckZpbGxlci5zdHlsZS53aWR0aCA9IG1lYXN1cmUuZ3V0dGVyV2lkdGggKyBcInB4XCI7XG4gICAgfSBlbHNlIGQuZ3V0dGVyRmlsbGVyLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICB9XG5cbiAgLy8gQ29tcHV0ZSB0aGUgbGluZXMgdGhhdCBhcmUgdmlzaWJsZSBpbiBhIGdpdmVuIHZpZXdwb3J0IChkZWZhdWx0c1xuICAvLyB0aGUgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uKS4gdmlld3BvcnQgbWF5IGNvbnRhaW4gdG9wLFxuICAvLyBoZWlnaHQsIGFuZCBlbnN1cmUgKHNlZSBvcC5zY3JvbGxUb1BvcykgcHJvcGVydGllcy5cbiAgZnVuY3Rpb24gdmlzaWJsZUxpbmVzKGRpc3BsYXksIGRvYywgdmlld3BvcnQpIHtcbiAgICB2YXIgdG9wID0gdmlld3BvcnQgJiYgdmlld3BvcnQudG9wICE9IG51bGwgPyBNYXRoLm1heCgwLCB2aWV3cG9ydC50b3ApIDogZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A7XG4gICAgdG9wID0gTWF0aC5mbG9vcih0b3AgLSBwYWRkaW5nVG9wKGRpc3BsYXkpKTtcbiAgICB2YXIgYm90dG9tID0gdmlld3BvcnQgJiYgdmlld3BvcnQuYm90dG9tICE9IG51bGwgPyB2aWV3cG9ydC5ib3R0b20gOiB0b3AgKyBkaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0O1xuXG4gICAgdmFyIGZyb20gPSBsaW5lQXRIZWlnaHQoZG9jLCB0b3ApLCB0byA9IGxpbmVBdEhlaWdodChkb2MsIGJvdHRvbSk7XG4gICAgLy8gRW5zdXJlIGlzIGEge2Zyb206IHtsaW5lLCBjaH0sIHRvOiB7bGluZSwgY2h9fSBvYmplY3QsIGFuZFxuICAgIC8vIGZvcmNlcyB0aG9zZSBsaW5lcyBpbnRvIHRoZSB2aWV3cG9ydCAoaWYgcG9zc2libGUpLlxuICAgIGlmICh2aWV3cG9ydCAmJiB2aWV3cG9ydC5lbnN1cmUpIHtcbiAgICAgIHZhciBlbnN1cmVGcm9tID0gdmlld3BvcnQuZW5zdXJlLmZyb20ubGluZSwgZW5zdXJlVG8gPSB2aWV3cG9ydC5lbnN1cmUudG8ubGluZTtcbiAgICAgIGlmIChlbnN1cmVGcm9tIDwgZnJvbSkge1xuICAgICAgICBmcm9tID0gZW5zdXJlRnJvbTtcbiAgICAgICAgdG8gPSBsaW5lQXRIZWlnaHQoZG9jLCBoZWlnaHRBdExpbmUoZ2V0TGluZShkb2MsIGVuc3VyZUZyb20pKSArIGRpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQpO1xuICAgICAgfSBlbHNlIGlmIChNYXRoLm1pbihlbnN1cmVUbywgZG9jLmxhc3RMaW5lKCkpID49IHRvKSB7XG4gICAgICAgIGZyb20gPSBsaW5lQXRIZWlnaHQoZG9jLCBoZWlnaHRBdExpbmUoZ2V0TGluZShkb2MsIGVuc3VyZVRvKSkgLSBkaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0KTtcbiAgICAgICAgdG8gPSBlbnN1cmVUbztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtmcm9tOiBmcm9tLCB0bzogTWF0aC5tYXgodG8sIGZyb20gKyAxKX07XG4gIH1cblxuICAvLyBMSU5FIE5VTUJFUlNcblxuICAvLyBSZS1hbGlnbiBsaW5lIG51bWJlcnMgYW5kIGd1dHRlciBtYXJrcyB0byBjb21wZW5zYXRlIGZvclxuICAvLyBob3Jpem9udGFsIHNjcm9sbGluZy5cbiAgZnVuY3Rpb24gYWxpZ25Ib3Jpem9udGFsbHkoY20pIHtcbiAgICB2YXIgZGlzcGxheSA9IGNtLmRpc3BsYXksIHZpZXcgPSBkaXNwbGF5LnZpZXc7XG4gICAgaWYgKCFkaXNwbGF5LmFsaWduV2lkZ2V0cyAmJiAoIWRpc3BsYXkuZ3V0dGVycy5maXJzdENoaWxkIHx8ICFjbS5vcHRpb25zLmZpeGVkR3V0dGVyKSkgcmV0dXJuO1xuICAgIHZhciBjb21wID0gY29tcGVuc2F0ZUZvckhTY3JvbGwoZGlzcGxheSkgLSBkaXNwbGF5LnNjcm9sbGVyLnNjcm9sbExlZnQgKyBjbS5kb2Muc2Nyb2xsTGVmdDtcbiAgICB2YXIgZ3V0dGVyVyA9IGRpc3BsYXkuZ3V0dGVycy5vZmZzZXRXaWR0aCwgbGVmdCA9IGNvbXAgKyBcInB4XCI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSBpZiAoIXZpZXdbaV0uaGlkZGVuKSB7XG4gICAgICBpZiAoY20ub3B0aW9ucy5maXhlZEd1dHRlciAmJiB2aWV3W2ldLmd1dHRlcilcbiAgICAgICAgdmlld1tpXS5ndXR0ZXIuc3R5bGUubGVmdCA9IGxlZnQ7XG4gICAgICB2YXIgYWxpZ24gPSB2aWV3W2ldLmFsaWduYWJsZTtcbiAgICAgIGlmIChhbGlnbikgZm9yICh2YXIgaiA9IDA7IGogPCBhbGlnbi5sZW5ndGg7IGorKylcbiAgICAgICAgYWxpZ25bal0uc3R5bGUubGVmdCA9IGxlZnQ7XG4gICAgfVxuICAgIGlmIChjbS5vcHRpb25zLmZpeGVkR3V0dGVyKVxuICAgICAgZGlzcGxheS5ndXR0ZXJzLnN0eWxlLmxlZnQgPSAoY29tcCArIGd1dHRlclcpICsgXCJweFwiO1xuICB9XG5cbiAgLy8gVXNlZCB0byBlbnN1cmUgdGhhdCB0aGUgbGluZSBudW1iZXIgZ3V0dGVyIGlzIHN0aWxsIHRoZSByaWdodFxuICAvLyBzaXplIGZvciB0aGUgY3VycmVudCBkb2N1bWVudCBzaXplLiBSZXR1cm5zIHRydWUgd2hlbiBhbiB1cGRhdGVcbiAgLy8gaXMgbmVlZGVkLlxuICBmdW5jdGlvbiBtYXliZVVwZGF0ZUxpbmVOdW1iZXJXaWR0aChjbSkge1xuICAgIGlmICghY20ub3B0aW9ucy5saW5lTnVtYmVycykgcmV0dXJuIGZhbHNlO1xuICAgIHZhciBkb2MgPSBjbS5kb2MsIGxhc3QgPSBsaW5lTnVtYmVyRm9yKGNtLm9wdGlvbnMsIGRvYy5maXJzdCArIGRvYy5zaXplIC0gMSksIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgIGlmIChsYXN0Lmxlbmd0aCAhPSBkaXNwbGF5LmxpbmVOdW1DaGFycykge1xuICAgICAgdmFyIHRlc3QgPSBkaXNwbGF5Lm1lYXN1cmUuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsIFtlbHQoXCJkaXZcIiwgbGFzdCldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ29kZU1pcnJvci1saW5lbnVtYmVyIENvZGVNaXJyb3ItZ3V0dGVyLWVsdFwiKSk7XG4gICAgICB2YXIgaW5uZXJXID0gdGVzdC5maXJzdENoaWxkLm9mZnNldFdpZHRoLCBwYWRkaW5nID0gdGVzdC5vZmZzZXRXaWR0aCAtIGlubmVyVztcbiAgICAgIGRpc3BsYXkubGluZUd1dHRlci5zdHlsZS53aWR0aCA9IFwiXCI7XG4gICAgICBkaXNwbGF5LmxpbmVOdW1Jbm5lcldpZHRoID0gTWF0aC5tYXgoaW5uZXJXLCBkaXNwbGF5LmxpbmVHdXR0ZXIub2Zmc2V0V2lkdGggLSBwYWRkaW5nKSArIDE7XG4gICAgICBkaXNwbGF5LmxpbmVOdW1XaWR0aCA9IGRpc3BsYXkubGluZU51bUlubmVyV2lkdGggKyBwYWRkaW5nO1xuICAgICAgZGlzcGxheS5saW5lTnVtQ2hhcnMgPSBkaXNwbGF5LmxpbmVOdW1Jbm5lcldpZHRoID8gbGFzdC5sZW5ndGggOiAtMTtcbiAgICAgIGRpc3BsYXkubGluZUd1dHRlci5zdHlsZS53aWR0aCA9IGRpc3BsYXkubGluZU51bVdpZHRoICsgXCJweFwiO1xuICAgICAgdXBkYXRlR3V0dGVyU3BhY2UoY20pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxpbmVOdW1iZXJGb3Iob3B0aW9ucywgaSkge1xuICAgIHJldHVybiBTdHJpbmcob3B0aW9ucy5saW5lTnVtYmVyRm9ybWF0dGVyKGkgKyBvcHRpb25zLmZpcnN0TGluZU51bWJlcikpO1xuICB9XG5cbiAgLy8gQ29tcHV0ZXMgZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0ICsgZGlzcGxheS5ndXR0ZXJzLm9mZnNldFdpZHRoLFxuICAvLyBidXQgdXNpbmcgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IHRvIGdldCBhIHN1Yi1waXhlbC1hY2N1cmF0ZVxuICAvLyByZXN1bHQuXG4gIGZ1bmN0aW9uIGNvbXBlbnNhdGVGb3JIU2Nyb2xsKGRpc3BsYXkpIHtcbiAgICByZXR1cm4gZGlzcGxheS5zY3JvbGxlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IC0gZGlzcGxheS5zaXplci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICB9XG5cbiAgLy8gRElTUExBWSBEUkFXSU5HXG5cbiAgZnVuY3Rpb24gRGlzcGxheVVwZGF0ZShjbSwgdmlld3BvcnQsIGZvcmNlKSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuXG4gICAgdGhpcy52aWV3cG9ydCA9IHZpZXdwb3J0O1xuICAgIC8vIFN0b3JlIHNvbWUgdmFsdWVzIHRoYXQgd2UnbGwgbmVlZCBsYXRlciAoYnV0IGRvbid0IHdhbnQgdG8gZm9yY2UgYSByZWxheW91dCBmb3IpXG4gICAgdGhpcy52aXNpYmxlID0gdmlzaWJsZUxpbmVzKGRpc3BsYXksIGNtLmRvYywgdmlld3BvcnQpO1xuICAgIHRoaXMuZWRpdG9ySXNIaWRkZW4gPSAhZGlzcGxheS53cmFwcGVyLm9mZnNldFdpZHRoO1xuICAgIHRoaXMud3JhcHBlckhlaWdodCA9IGRpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQ7XG4gICAgdGhpcy53cmFwcGVyV2lkdGggPSBkaXNwbGF5LndyYXBwZXIuY2xpZW50V2lkdGg7XG4gICAgdGhpcy5vbGREaXNwbGF5V2lkdGggPSBkaXNwbGF5V2lkdGgoY20pO1xuICAgIHRoaXMuZm9yY2UgPSBmb3JjZTtcbiAgICB0aGlzLmRpbXMgPSBnZXREaW1lbnNpb25zKGNtKTtcbiAgICB0aGlzLmV2ZW50cyA9IFtdO1xuICB9XG5cbiAgRGlzcGxheVVwZGF0ZS5wcm90b3R5cGUuc2lnbmFsID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICAgIGlmIChoYXNIYW5kbGVyKGVtaXR0ZXIsIHR5cGUpKVxuICAgICAgdGhpcy5ldmVudHMucHVzaChhcmd1bWVudHMpO1xuICB9O1xuICBEaXNwbGF5VXBkYXRlLnByb3RvdHlwZS5maW5pc2ggPSBmdW5jdGlvbigpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZXZlbnRzLmxlbmd0aDsgaSsrKVxuICAgICAgc2lnbmFsLmFwcGx5KG51bGwsIHRoaXMuZXZlbnRzW2ldKTtcbiAgfTtcblxuICBmdW5jdGlvbiBtYXliZUNsaXBTY3JvbGxiYXJzKGNtKSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgIGlmICghZGlzcGxheS5zY3JvbGxiYXJzQ2xpcHBlZCAmJiBkaXNwbGF5LnNjcm9sbGVyLm9mZnNldFdpZHRoKSB7XG4gICAgICBkaXNwbGF5Lm5hdGl2ZUJhcldpZHRoID0gZGlzcGxheS5zY3JvbGxlci5vZmZzZXRXaWR0aCAtIGRpc3BsYXkuc2Nyb2xsZXIuY2xpZW50V2lkdGg7XG4gICAgICBkaXNwbGF5LmhlaWdodEZvcmNlci5zdHlsZS5oZWlnaHQgPSBzY3JvbGxHYXAoY20pICsgXCJweFwiO1xuICAgICAgZGlzcGxheS5zaXplci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAtZGlzcGxheS5uYXRpdmVCYXJXaWR0aCArIFwicHhcIjtcbiAgICAgIGRpc3BsYXkuc2l6ZXIuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA9IHNjcm9sbEdhcChjbSkgKyBcInB4XCI7XG4gICAgICBkaXNwbGF5LnNjcm9sbGJhcnNDbGlwcGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvLyBEb2VzIHRoZSBhY3R1YWwgdXBkYXRpbmcgb2YgdGhlIGxpbmUgZGlzcGxheS4gQmFpbHMgb3V0XG4gIC8vIChyZXR1cm5pbmcgZmFsc2UpIHdoZW4gdGhlcmUgaXMgbm90aGluZyB0byBiZSBkb25lIGFuZCBmb3JjZWQgaXNcbiAgLy8gZmFsc2UuXG4gIGZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlJZk5lZWRlZChjbSwgdXBkYXRlKSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5LCBkb2MgPSBjbS5kb2M7XG5cbiAgICBpZiAodXBkYXRlLmVkaXRvcklzSGlkZGVuKSB7XG4gICAgICByZXNldFZpZXcoY20pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEJhaWwgb3V0IGlmIHRoZSB2aXNpYmxlIGFyZWEgaXMgYWxyZWFkeSByZW5kZXJlZCBhbmQgbm90aGluZyBjaGFuZ2VkLlxuICAgIGlmICghdXBkYXRlLmZvcmNlICYmXG4gICAgICAgIHVwZGF0ZS52aXNpYmxlLmZyb20gPj0gZGlzcGxheS52aWV3RnJvbSAmJiB1cGRhdGUudmlzaWJsZS50byA8PSBkaXNwbGF5LnZpZXdUbyAmJlxuICAgICAgICAoZGlzcGxheS51cGRhdGVMaW5lTnVtYmVycyA9PSBudWxsIHx8IGRpc3BsYXkudXBkYXRlTGluZU51bWJlcnMgPj0gZGlzcGxheS52aWV3VG8pICYmXG4gICAgICAgIGRpc3BsYXkucmVuZGVyZWRWaWV3ID09IGRpc3BsYXkudmlldyAmJiBjb3VudERpcnR5VmlldyhjbSkgPT0gMClcbiAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIGlmIChtYXliZVVwZGF0ZUxpbmVOdW1iZXJXaWR0aChjbSkpIHtcbiAgICAgIHJlc2V0VmlldyhjbSk7XG4gICAgICB1cGRhdGUuZGltcyA9IGdldERpbWVuc2lvbnMoY20pO1xuICAgIH1cblxuICAgIC8vIENvbXB1dGUgYSBzdWl0YWJsZSBuZXcgdmlld3BvcnQgKGZyb20gJiB0bylcbiAgICB2YXIgZW5kID0gZG9jLmZpcnN0ICsgZG9jLnNpemU7XG4gICAgdmFyIGZyb20gPSBNYXRoLm1heCh1cGRhdGUudmlzaWJsZS5mcm9tIC0gY20ub3B0aW9ucy52aWV3cG9ydE1hcmdpbiwgZG9jLmZpcnN0KTtcbiAgICB2YXIgdG8gPSBNYXRoLm1pbihlbmQsIHVwZGF0ZS52aXNpYmxlLnRvICsgY20ub3B0aW9ucy52aWV3cG9ydE1hcmdpbik7XG4gICAgaWYgKGRpc3BsYXkudmlld0Zyb20gPCBmcm9tICYmIGZyb20gLSBkaXNwbGF5LnZpZXdGcm9tIDwgMjApIGZyb20gPSBNYXRoLm1heChkb2MuZmlyc3QsIGRpc3BsYXkudmlld0Zyb20pO1xuICAgIGlmIChkaXNwbGF5LnZpZXdUbyA+IHRvICYmIGRpc3BsYXkudmlld1RvIC0gdG8gPCAyMCkgdG8gPSBNYXRoLm1pbihlbmQsIGRpc3BsYXkudmlld1RvKTtcbiAgICBpZiAoc2F3Q29sbGFwc2VkU3BhbnMpIHtcbiAgICAgIGZyb20gPSB2aXN1YWxMaW5lTm8oY20uZG9jLCBmcm9tKTtcbiAgICAgIHRvID0gdmlzdWFsTGluZUVuZE5vKGNtLmRvYywgdG8pO1xuICAgIH1cblxuICAgIHZhciBkaWZmZXJlbnQgPSBmcm9tICE9IGRpc3BsYXkudmlld0Zyb20gfHwgdG8gIT0gZGlzcGxheS52aWV3VG8gfHxcbiAgICAgIGRpc3BsYXkubGFzdFdyYXBIZWlnaHQgIT0gdXBkYXRlLndyYXBwZXJIZWlnaHQgfHwgZGlzcGxheS5sYXN0V3JhcFdpZHRoICE9IHVwZGF0ZS53cmFwcGVyV2lkdGg7XG4gICAgYWRqdXN0VmlldyhjbSwgZnJvbSwgdG8pO1xuXG4gICAgZGlzcGxheS52aWV3T2Zmc2V0ID0gaGVpZ2h0QXRMaW5lKGdldExpbmUoY20uZG9jLCBkaXNwbGF5LnZpZXdGcm9tKSk7XG4gICAgLy8gUG9zaXRpb24gdGhlIG1vdmVyIGRpdiB0byBhbGlnbiB3aXRoIHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvblxuICAgIGNtLmRpc3BsYXkubW92ZXIuc3R5bGUudG9wID0gZGlzcGxheS52aWV3T2Zmc2V0ICsgXCJweFwiO1xuXG4gICAgdmFyIHRvVXBkYXRlID0gY291bnREaXJ0eVZpZXcoY20pO1xuICAgIGlmICghZGlmZmVyZW50ICYmIHRvVXBkYXRlID09IDAgJiYgIXVwZGF0ZS5mb3JjZSAmJiBkaXNwbGF5LnJlbmRlcmVkVmlldyA9PSBkaXNwbGF5LnZpZXcgJiZcbiAgICAgICAgKGRpc3BsYXkudXBkYXRlTGluZU51bWJlcnMgPT0gbnVsbCB8fCBkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzID49IGRpc3BsYXkudmlld1RvKSlcbiAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIC8vIEZvciBiaWcgY2hhbmdlcywgd2UgaGlkZSB0aGUgZW5jbG9zaW5nIGVsZW1lbnQgZHVyaW5nIHRoZVxuICAgIC8vIHVwZGF0ZSwgc2luY2UgdGhhdCBzcGVlZHMgdXAgdGhlIG9wZXJhdGlvbnMgb24gbW9zdCBicm93c2Vycy5cbiAgICB2YXIgZm9jdXNlZCA9IGFjdGl2ZUVsdCgpO1xuICAgIGlmICh0b1VwZGF0ZSA+IDQpIGRpc3BsYXkubGluZURpdi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgcGF0Y2hEaXNwbGF5KGNtLCBkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzLCB1cGRhdGUuZGltcyk7XG4gICAgaWYgKHRvVXBkYXRlID4gNCkgZGlzcGxheS5saW5lRGl2LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgIGRpc3BsYXkucmVuZGVyZWRWaWV3ID0gZGlzcGxheS52aWV3O1xuICAgIC8vIFRoZXJlIG1pZ2h0IGhhdmUgYmVlbiBhIHdpZGdldCB3aXRoIGEgZm9jdXNlZCBlbGVtZW50IHRoYXQgZ290XG4gICAgLy8gaGlkZGVuIG9yIHVwZGF0ZWQsIGlmIHNvIHJlLWZvY3VzIGl0LlxuICAgIGlmIChmb2N1c2VkICYmIGFjdGl2ZUVsdCgpICE9IGZvY3VzZWQgJiYgZm9jdXNlZC5vZmZzZXRIZWlnaHQpIGZvY3VzZWQuZm9jdXMoKTtcblxuICAgIC8vIFByZXZlbnQgc2VsZWN0aW9uIGFuZCBjdXJzb3JzIGZyb20gaW50ZXJmZXJpbmcgd2l0aCB0aGUgc2Nyb2xsXG4gICAgLy8gd2lkdGggYW5kIGhlaWdodC5cbiAgICByZW1vdmVDaGlsZHJlbihkaXNwbGF5LmN1cnNvckRpdik7XG4gICAgcmVtb3ZlQ2hpbGRyZW4oZGlzcGxheS5zZWxlY3Rpb25EaXYpO1xuICAgIGRpc3BsYXkuZ3V0dGVycy5zdHlsZS5oZWlnaHQgPSBkaXNwbGF5LnNpemVyLnN0eWxlLm1pbkhlaWdodCA9IDA7XG5cbiAgICBpZiAoZGlmZmVyZW50KSB7XG4gICAgICBkaXNwbGF5Lmxhc3RXcmFwSGVpZ2h0ID0gdXBkYXRlLndyYXBwZXJIZWlnaHQ7XG4gICAgICBkaXNwbGF5Lmxhc3RXcmFwV2lkdGggPSB1cGRhdGUud3JhcHBlcldpZHRoO1xuICAgICAgc3RhcnRXb3JrZXIoY20sIDQwMCk7XG4gICAgfVxuXG4gICAgZGlzcGxheS51cGRhdGVMaW5lTnVtYmVycyA9IG51bGw7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBvc3RVcGRhdGVEaXNwbGF5KGNtLCB1cGRhdGUpIHtcbiAgICB2YXIgdmlld3BvcnQgPSB1cGRhdGUudmlld3BvcnQ7XG4gICAgZm9yICh2YXIgZmlyc3QgPSB0cnVlOzsgZmlyc3QgPSBmYWxzZSkge1xuICAgICAgaWYgKCFmaXJzdCB8fCAhY20ub3B0aW9ucy5saW5lV3JhcHBpbmcgfHwgdXBkYXRlLm9sZERpc3BsYXlXaWR0aCA9PSBkaXNwbGF5V2lkdGgoY20pKSB7XG4gICAgICAgIC8vIENsaXAgZm9yY2VkIHZpZXdwb3J0IHRvIGFjdHVhbCBzY3JvbGxhYmxlIGFyZWEuXG4gICAgICAgIGlmICh2aWV3cG9ydCAmJiB2aWV3cG9ydC50b3AgIT0gbnVsbClcbiAgICAgICAgICB2aWV3cG9ydCA9IHt0b3A6IE1hdGgubWluKGNtLmRvYy5oZWlnaHQgKyBwYWRkaW5nVmVydChjbS5kaXNwbGF5KSAtIGRpc3BsYXlIZWlnaHQoY20pLCB2aWV3cG9ydC50b3ApfTtcbiAgICAgICAgLy8gVXBkYXRlZCBsaW5lIGhlaWdodHMgbWlnaHQgcmVzdWx0IGluIHRoZSBkcmF3biBhcmVhIG5vdFxuICAgICAgICAvLyBhY3R1YWxseSBjb3ZlcmluZyB0aGUgdmlld3BvcnQuIEtlZXAgbG9vcGluZyB1bnRpbCBpdCBkb2VzLlxuICAgICAgICB1cGRhdGUudmlzaWJsZSA9IHZpc2libGVMaW5lcyhjbS5kaXNwbGF5LCBjbS5kb2MsIHZpZXdwb3J0KTtcbiAgICAgICAgaWYgKHVwZGF0ZS52aXNpYmxlLmZyb20gPj0gY20uZGlzcGxheS52aWV3RnJvbSAmJiB1cGRhdGUudmlzaWJsZS50byA8PSBjbS5kaXNwbGF5LnZpZXdUbylcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICghdXBkYXRlRGlzcGxheUlmTmVlZGVkKGNtLCB1cGRhdGUpKSBicmVhaztcbiAgICAgIHVwZGF0ZUhlaWdodHNJblZpZXdwb3J0KGNtKTtcbiAgICAgIHZhciBiYXJNZWFzdXJlID0gbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pO1xuICAgICAgdXBkYXRlU2VsZWN0aW9uKGNtKTtcbiAgICAgIHNldERvY3VtZW50SGVpZ2h0KGNtLCBiYXJNZWFzdXJlKTtcbiAgICAgIHVwZGF0ZVNjcm9sbGJhcnMoY20sIGJhck1lYXN1cmUpO1xuICAgIH1cblxuICAgIHVwZGF0ZS5zaWduYWwoY20sIFwidXBkYXRlXCIsIGNtKTtcbiAgICBpZiAoY20uZGlzcGxheS52aWV3RnJvbSAhPSBjbS5kaXNwbGF5LnJlcG9ydGVkVmlld0Zyb20gfHwgY20uZGlzcGxheS52aWV3VG8gIT0gY20uZGlzcGxheS5yZXBvcnRlZFZpZXdUbykge1xuICAgICAgdXBkYXRlLnNpZ25hbChjbSwgXCJ2aWV3cG9ydENoYW5nZVwiLCBjbSwgY20uZGlzcGxheS52aWV3RnJvbSwgY20uZGlzcGxheS52aWV3VG8pO1xuICAgICAgY20uZGlzcGxheS5yZXBvcnRlZFZpZXdGcm9tID0gY20uZGlzcGxheS52aWV3RnJvbTsgY20uZGlzcGxheS5yZXBvcnRlZFZpZXdUbyA9IGNtLmRpc3BsYXkudmlld1RvO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZURpc3BsYXlTaW1wbGUoY20sIHZpZXdwb3J0KSB7XG4gICAgdmFyIHVwZGF0ZSA9IG5ldyBEaXNwbGF5VXBkYXRlKGNtLCB2aWV3cG9ydCk7XG4gICAgaWYgKHVwZGF0ZURpc3BsYXlJZk5lZWRlZChjbSwgdXBkYXRlKSkge1xuICAgICAgdXBkYXRlSGVpZ2h0c0luVmlld3BvcnQoY20pO1xuICAgICAgcG9zdFVwZGF0ZURpc3BsYXkoY20sIHVwZGF0ZSk7XG4gICAgICB2YXIgYmFyTWVhc3VyZSA9IG1lYXN1cmVGb3JTY3JvbGxiYXJzKGNtKTtcbiAgICAgIHVwZGF0ZVNlbGVjdGlvbihjbSk7XG4gICAgICBzZXREb2N1bWVudEhlaWdodChjbSwgYmFyTWVhc3VyZSk7XG4gICAgICB1cGRhdGVTY3JvbGxiYXJzKGNtLCBiYXJNZWFzdXJlKTtcbiAgICAgIHVwZGF0ZS5maW5pc2goKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZXREb2N1bWVudEhlaWdodChjbSwgbWVhc3VyZSkge1xuICAgIGNtLmRpc3BsYXkuc2l6ZXIuc3R5bGUubWluSGVpZ2h0ID0gbWVhc3VyZS5kb2NIZWlnaHQgKyBcInB4XCI7XG4gICAgdmFyIHRvdGFsID0gbWVhc3VyZS5kb2NIZWlnaHQgKyBjbS5kaXNwbGF5LmJhckhlaWdodDtcbiAgICBjbS5kaXNwbGF5LmhlaWdodEZvcmNlci5zdHlsZS50b3AgPSB0b3RhbCArIFwicHhcIjtcbiAgICBjbS5kaXNwbGF5Lmd1dHRlcnMuc3R5bGUuaGVpZ2h0ID0gTWF0aC5tYXgodG90YWwgKyBzY3JvbGxHYXAoY20pLCBtZWFzdXJlLmNsaWVudEhlaWdodCkgKyBcInB4XCI7XG4gIH1cblxuICAvLyBSZWFkIHRoZSBhY3R1YWwgaGVpZ2h0cyBvZiB0aGUgcmVuZGVyZWQgbGluZXMsIGFuZCB1cGRhdGUgdGhlaXJcbiAgLy8gc3RvcmVkIGhlaWdodHMgdG8gbWF0Y2guXG4gIGZ1bmN0aW9uIHVwZGF0ZUhlaWdodHNJblZpZXdwb3J0KGNtKSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgIHZhciBwcmV2Qm90dG9tID0gZGlzcGxheS5saW5lRGl2Lm9mZnNldFRvcDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpc3BsYXkudmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGN1ciA9IGRpc3BsYXkudmlld1tpXSwgaGVpZ2h0O1xuICAgICAgaWYgKGN1ci5oaWRkZW4pIGNvbnRpbnVlO1xuICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCA4KSB7XG4gICAgICAgIHZhciBib3QgPSBjdXIubm9kZS5vZmZzZXRUb3AgKyBjdXIubm9kZS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIGhlaWdodCA9IGJvdCAtIHByZXZCb3R0b207XG4gICAgICAgIHByZXZCb3R0b20gPSBib3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgYm94ID0gY3VyLm5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGhlaWdodCA9IGJveC5ib3R0b20gLSBib3gudG9wO1xuICAgICAgfVxuICAgICAgdmFyIGRpZmYgPSBjdXIubGluZS5oZWlnaHQgLSBoZWlnaHQ7XG4gICAgICBpZiAoaGVpZ2h0IDwgMikgaGVpZ2h0ID0gdGV4dEhlaWdodChkaXNwbGF5KTtcbiAgICAgIGlmIChkaWZmID4gLjAwMSB8fCBkaWZmIDwgLS4wMDEpIHtcbiAgICAgICAgdXBkYXRlTGluZUhlaWdodChjdXIubGluZSwgaGVpZ2h0KTtcbiAgICAgICAgdXBkYXRlV2lkZ2V0SGVpZ2h0KGN1ci5saW5lKTtcbiAgICAgICAgaWYgKGN1ci5yZXN0KSBmb3IgKHZhciBqID0gMDsgaiA8IGN1ci5yZXN0Lmxlbmd0aDsgaisrKVxuICAgICAgICAgIHVwZGF0ZVdpZGdldEhlaWdodChjdXIucmVzdFtqXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gUmVhZCBhbmQgc3RvcmUgdGhlIGhlaWdodCBvZiBsaW5lIHdpZGdldHMgYXNzb2NpYXRlZCB3aXRoIHRoZVxuICAvLyBnaXZlbiBsaW5lLlxuICBmdW5jdGlvbiB1cGRhdGVXaWRnZXRIZWlnaHQobGluZSkge1xuICAgIGlmIChsaW5lLndpZGdldHMpIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZS53aWRnZXRzLmxlbmd0aDsgKytpKVxuICAgICAgbGluZS53aWRnZXRzW2ldLmhlaWdodCA9IGxpbmUud2lkZ2V0c1tpXS5ub2RlLm9mZnNldEhlaWdodDtcbiAgfVxuXG4gIC8vIERvIGEgYnVsay1yZWFkIG9mIHRoZSBET00gcG9zaXRpb25zIGFuZCBzaXplcyBuZWVkZWQgdG8gZHJhdyB0aGVcbiAgLy8gdmlldywgc28gdGhhdCB3ZSBkb24ndCBpbnRlcmxlYXZlIHJlYWRpbmcgYW5kIHdyaXRpbmcgdG8gdGhlIERPTS5cbiAgZnVuY3Rpb24gZ2V0RGltZW5zaW9ucyhjbSkge1xuICAgIHZhciBkID0gY20uZGlzcGxheSwgbGVmdCA9IHt9LCB3aWR0aCA9IHt9O1xuICAgIHZhciBndXR0ZXJMZWZ0ID0gZC5ndXR0ZXJzLmNsaWVudExlZnQ7XG4gICAgZm9yICh2YXIgbiA9IGQuZ3V0dGVycy5maXJzdENoaWxkLCBpID0gMDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcsICsraSkge1xuICAgICAgbGVmdFtjbS5vcHRpb25zLmd1dHRlcnNbaV1dID0gbi5vZmZzZXRMZWZ0ICsgbi5jbGllbnRMZWZ0ICsgZ3V0dGVyTGVmdDtcbiAgICAgIHdpZHRoW2NtLm9wdGlvbnMuZ3V0dGVyc1tpXV0gPSBuLmNsaWVudFdpZHRoO1xuICAgIH1cbiAgICByZXR1cm4ge2ZpeGVkUG9zOiBjb21wZW5zYXRlRm9ySFNjcm9sbChkKSxcbiAgICAgICAgICAgIGd1dHRlclRvdGFsV2lkdGg6IGQuZ3V0dGVycy5vZmZzZXRXaWR0aCxcbiAgICAgICAgICAgIGd1dHRlckxlZnQ6IGxlZnQsXG4gICAgICAgICAgICBndXR0ZXJXaWR0aDogd2lkdGgsXG4gICAgICAgICAgICB3cmFwcGVyV2lkdGg6IGQud3JhcHBlci5jbGllbnRXaWR0aH07XG4gIH1cblxuICAvLyBTeW5jIHRoZSBhY3R1YWwgZGlzcGxheSBET00gc3RydWN0dXJlIHdpdGggZGlzcGxheS52aWV3LCByZW1vdmluZ1xuICAvLyBub2RlcyBmb3IgbGluZXMgdGhhdCBhcmUgbm8gbG9uZ2VyIGluIHZpZXcsIGFuZCBjcmVhdGluZyB0aGUgb25lc1xuICAvLyB0aGF0IGFyZSBub3QgdGhlcmUgeWV0LCBhbmQgdXBkYXRpbmcgdGhlIG9uZXMgdGhhdCBhcmUgb3V0IG9mXG4gIC8vIGRhdGUuXG4gIGZ1bmN0aW9uIHBhdGNoRGlzcGxheShjbSwgdXBkYXRlTnVtYmVyc0Zyb20sIGRpbXMpIHtcbiAgICB2YXIgZGlzcGxheSA9IGNtLmRpc3BsYXksIGxpbmVOdW1iZXJzID0gY20ub3B0aW9ucy5saW5lTnVtYmVycztcbiAgICB2YXIgY29udGFpbmVyID0gZGlzcGxheS5saW5lRGl2LCBjdXIgPSBjb250YWluZXIuZmlyc3RDaGlsZDtcblxuICAgIGZ1bmN0aW9uIHJtKG5vZGUpIHtcbiAgICAgIHZhciBuZXh0ID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgIC8vIFdvcmtzIGFyb3VuZCBhIHRocm93LXNjcm9sbCBidWcgaW4gT1MgWCBXZWJraXRcbiAgICAgIGlmICh3ZWJraXQgJiYgbWFjICYmIGNtLmRpc3BsYXkuY3VycmVudFdoZWVsVGFyZ2V0ID09IG5vZGUpXG4gICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgZWxzZVxuICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9XG5cbiAgICB2YXIgdmlldyA9IGRpc3BsYXkudmlldywgbGluZU4gPSBkaXNwbGF5LnZpZXdGcm9tO1xuICAgIC8vIExvb3Agb3ZlciB0aGUgZWxlbWVudHMgaW4gdGhlIHZpZXcsIHN5bmNpbmcgY3VyICh0aGUgRE9NIG5vZGVzXG4gICAgLy8gaW4gZGlzcGxheS5saW5lRGl2KSB3aXRoIHRoZSB2aWV3IGFzIHdlIGdvLlxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGxpbmVWaWV3ID0gdmlld1tpXTtcbiAgICAgIGlmIChsaW5lVmlldy5oaWRkZW4pIHtcbiAgICAgIH0gZWxzZSBpZiAoIWxpbmVWaWV3Lm5vZGUgfHwgbGluZVZpZXcubm9kZS5wYXJlbnROb2RlICE9IGNvbnRhaW5lcikgeyAvLyBOb3QgZHJhd24geWV0XG4gICAgICAgIHZhciBub2RlID0gYnVpbGRMaW5lRWxlbWVudChjbSwgbGluZVZpZXcsIGxpbmVOLCBkaW1zKTtcbiAgICAgICAgY29udGFpbmVyLmluc2VydEJlZm9yZShub2RlLCBjdXIpO1xuICAgICAgfSBlbHNlIHsgLy8gQWxyZWFkeSBkcmF3blxuICAgICAgICB3aGlsZSAoY3VyICE9IGxpbmVWaWV3Lm5vZGUpIGN1ciA9IHJtKGN1cik7XG4gICAgICAgIHZhciB1cGRhdGVOdW1iZXIgPSBsaW5lTnVtYmVycyAmJiB1cGRhdGVOdW1iZXJzRnJvbSAhPSBudWxsICYmXG4gICAgICAgICAgdXBkYXRlTnVtYmVyc0Zyb20gPD0gbGluZU4gJiYgbGluZVZpZXcubGluZU51bWJlcjtcbiAgICAgICAgaWYgKGxpbmVWaWV3LmNoYW5nZXMpIHtcbiAgICAgICAgICBpZiAoaW5kZXhPZihsaW5lVmlldy5jaGFuZ2VzLCBcImd1dHRlclwiKSA+IC0xKSB1cGRhdGVOdW1iZXIgPSBmYWxzZTtcbiAgICAgICAgICB1cGRhdGVMaW5lRm9yQ2hhbmdlcyhjbSwgbGluZVZpZXcsIGxpbmVOLCBkaW1zKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXBkYXRlTnVtYmVyKSB7XG4gICAgICAgICAgcmVtb3ZlQ2hpbGRyZW4obGluZVZpZXcubGluZU51bWJlcik7XG4gICAgICAgICAgbGluZVZpZXcubGluZU51bWJlci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShsaW5lTnVtYmVyRm9yKGNtLm9wdGlvbnMsIGxpbmVOKSkpO1xuICAgICAgICB9XG4gICAgICAgIGN1ciA9IGxpbmVWaWV3Lm5vZGUubmV4dFNpYmxpbmc7XG4gICAgICB9XG4gICAgICBsaW5lTiArPSBsaW5lVmlldy5zaXplO1xuICAgIH1cbiAgICB3aGlsZSAoY3VyKSBjdXIgPSBybShjdXIpO1xuICB9XG5cbiAgLy8gV2hlbiBhbiBhc3BlY3Qgb2YgYSBsaW5lIGNoYW5nZXMsIGEgc3RyaW5nIGlzIGFkZGVkIHRvXG4gIC8vIGxpbmVWaWV3LmNoYW5nZXMuIFRoaXMgdXBkYXRlcyB0aGUgcmVsZXZhbnQgcGFydCBvZiB0aGUgbGluZSdzXG4gIC8vIERPTSBzdHJ1Y3R1cmUuXG4gIGZ1bmN0aW9uIHVwZGF0ZUxpbmVGb3JDaGFuZ2VzKGNtLCBsaW5lVmlldywgbGluZU4sIGRpbXMpIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpbmVWaWV3LmNoYW5nZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHZhciB0eXBlID0gbGluZVZpZXcuY2hhbmdlc1tqXTtcbiAgICAgIGlmICh0eXBlID09IFwidGV4dFwiKSB1cGRhdGVMaW5lVGV4dChjbSwgbGluZVZpZXcpO1xuICAgICAgZWxzZSBpZiAodHlwZSA9PSBcImd1dHRlclwiKSB1cGRhdGVMaW5lR3V0dGVyKGNtLCBsaW5lVmlldywgbGluZU4sIGRpbXMpO1xuICAgICAgZWxzZSBpZiAodHlwZSA9PSBcImNsYXNzXCIpIHVwZGF0ZUxpbmVDbGFzc2VzKGxpbmVWaWV3KTtcbiAgICAgIGVsc2UgaWYgKHR5cGUgPT0gXCJ3aWRnZXRcIikgdXBkYXRlTGluZVdpZGdldHMoY20sIGxpbmVWaWV3LCBkaW1zKTtcbiAgICB9XG4gICAgbGluZVZpZXcuY2hhbmdlcyA9IG51bGw7XG4gIH1cblxuICAvLyBMaW5lcyB3aXRoIGd1dHRlciBlbGVtZW50cywgd2lkZ2V0cyBvciBhIGJhY2tncm91bmQgY2xhc3MgbmVlZCB0b1xuICAvLyBiZSB3cmFwcGVkLCBhbmQgaGF2ZSB0aGUgZXh0cmEgZWxlbWVudHMgYWRkZWQgdG8gdGhlIHdyYXBwZXIgZGl2XG4gIGZ1bmN0aW9uIGVuc3VyZUxpbmVXcmFwcGVkKGxpbmVWaWV3KSB7XG4gICAgaWYgKGxpbmVWaWV3Lm5vZGUgPT0gbGluZVZpZXcudGV4dCkge1xuICAgICAgbGluZVZpZXcubm9kZSA9IGVsdChcImRpdlwiLCBudWxsLCBudWxsLCBcInBvc2l0aW9uOiByZWxhdGl2ZVwiKTtcbiAgICAgIGlmIChsaW5lVmlldy50ZXh0LnBhcmVudE5vZGUpXG4gICAgICAgIGxpbmVWaWV3LnRleHQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobGluZVZpZXcubm9kZSwgbGluZVZpZXcudGV4dCk7XG4gICAgICBsaW5lVmlldy5ub2RlLmFwcGVuZENoaWxkKGxpbmVWaWV3LnRleHQpO1xuICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCA4KSBsaW5lVmlldy5ub2RlLnN0eWxlLnpJbmRleCA9IDI7XG4gICAgfVxuICAgIHJldHVybiBsaW5lVmlldy5ub2RlO1xuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlTGluZUJhY2tncm91bmQobGluZVZpZXcpIHtcbiAgICB2YXIgY2xzID0gbGluZVZpZXcuYmdDbGFzcyA/IGxpbmVWaWV3LmJnQ2xhc3MgKyBcIiBcIiArIChsaW5lVmlldy5saW5lLmJnQ2xhc3MgfHwgXCJcIikgOiBsaW5lVmlldy5saW5lLmJnQ2xhc3M7XG4gICAgaWYgKGNscykgY2xzICs9IFwiIENvZGVNaXJyb3ItbGluZWJhY2tncm91bmRcIjtcbiAgICBpZiAobGluZVZpZXcuYmFja2dyb3VuZCkge1xuICAgICAgaWYgKGNscykgbGluZVZpZXcuYmFja2dyb3VuZC5jbGFzc05hbWUgPSBjbHM7XG4gICAgICBlbHNlIHsgbGluZVZpZXcuYmFja2dyb3VuZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxpbmVWaWV3LmJhY2tncm91bmQpOyBsaW5lVmlldy5iYWNrZ3JvdW5kID0gbnVsbDsgfVxuICAgIH0gZWxzZSBpZiAoY2xzKSB7XG4gICAgICB2YXIgd3JhcCA9IGVuc3VyZUxpbmVXcmFwcGVkKGxpbmVWaWV3KTtcbiAgICAgIGxpbmVWaWV3LmJhY2tncm91bmQgPSB3cmFwLmluc2VydEJlZm9yZShlbHQoXCJkaXZcIiwgbnVsbCwgY2xzKSwgd3JhcC5maXJzdENoaWxkKTtcbiAgICB9XG4gIH1cblxuICAvLyBXcmFwcGVyIGFyb3VuZCBidWlsZExpbmVDb250ZW50IHdoaWNoIHdpbGwgcmV1c2UgdGhlIHN0cnVjdHVyZVxuICAvLyBpbiBkaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQgd2hlbiBwb3NzaWJsZS5cbiAgZnVuY3Rpb24gZ2V0TGluZUNvbnRlbnQoY20sIGxpbmVWaWV3KSB7XG4gICAgdmFyIGV4dCA9IGNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZDtcbiAgICBpZiAoZXh0ICYmIGV4dC5saW5lID09IGxpbmVWaWV3LmxpbmUpIHtcbiAgICAgIGNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZCA9IG51bGw7XG4gICAgICBsaW5lVmlldy5tZWFzdXJlID0gZXh0Lm1lYXN1cmU7XG4gICAgICByZXR1cm4gZXh0LmJ1aWx0O1xuICAgIH1cbiAgICByZXR1cm4gYnVpbGRMaW5lQ29udGVudChjbSwgbGluZVZpZXcpO1xuICB9XG5cbiAgLy8gUmVkcmF3IHRoZSBsaW5lJ3MgdGV4dC4gSW50ZXJhY3RzIHdpdGggdGhlIGJhY2tncm91bmQgYW5kIHRleHRcbiAgLy8gY2xhc3NlcyBiZWNhdXNlIHRoZSBtb2RlIG1heSBvdXRwdXQgdG9rZW5zIHRoYXQgaW5mbHVlbmNlIHRoZXNlXG4gIC8vIGNsYXNzZXMuXG4gIGZ1bmN0aW9uIHVwZGF0ZUxpbmVUZXh0KGNtLCBsaW5lVmlldykge1xuICAgIHZhciBjbHMgPSBsaW5lVmlldy50ZXh0LmNsYXNzTmFtZTtcbiAgICB2YXIgYnVpbHQgPSBnZXRMaW5lQ29udGVudChjbSwgbGluZVZpZXcpO1xuICAgIGlmIChsaW5lVmlldy50ZXh0ID09IGxpbmVWaWV3Lm5vZGUpIGxpbmVWaWV3Lm5vZGUgPSBidWlsdC5wcmU7XG4gICAgbGluZVZpZXcudGV4dC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChidWlsdC5wcmUsIGxpbmVWaWV3LnRleHQpO1xuICAgIGxpbmVWaWV3LnRleHQgPSBidWlsdC5wcmU7XG4gICAgaWYgKGJ1aWx0LmJnQ2xhc3MgIT0gbGluZVZpZXcuYmdDbGFzcyB8fCBidWlsdC50ZXh0Q2xhc3MgIT0gbGluZVZpZXcudGV4dENsYXNzKSB7XG4gICAgICBsaW5lVmlldy5iZ0NsYXNzID0gYnVpbHQuYmdDbGFzcztcbiAgICAgIGxpbmVWaWV3LnRleHRDbGFzcyA9IGJ1aWx0LnRleHRDbGFzcztcbiAgICAgIHVwZGF0ZUxpbmVDbGFzc2VzKGxpbmVWaWV3KTtcbiAgICB9IGVsc2UgaWYgKGNscykge1xuICAgICAgbGluZVZpZXcudGV4dC5jbGFzc05hbWUgPSBjbHM7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlTGluZUNsYXNzZXMobGluZVZpZXcpIHtcbiAgICB1cGRhdGVMaW5lQmFja2dyb3VuZChsaW5lVmlldyk7XG4gICAgaWYgKGxpbmVWaWV3LmxpbmUud3JhcENsYXNzKVxuICAgICAgZW5zdXJlTGluZVdyYXBwZWQobGluZVZpZXcpLmNsYXNzTmFtZSA9IGxpbmVWaWV3LmxpbmUud3JhcENsYXNzO1xuICAgIGVsc2UgaWYgKGxpbmVWaWV3Lm5vZGUgIT0gbGluZVZpZXcudGV4dClcbiAgICAgIGxpbmVWaWV3Lm5vZGUuY2xhc3NOYW1lID0gXCJcIjtcbiAgICB2YXIgdGV4dENsYXNzID0gbGluZVZpZXcudGV4dENsYXNzID8gbGluZVZpZXcudGV4dENsYXNzICsgXCIgXCIgKyAobGluZVZpZXcubGluZS50ZXh0Q2xhc3MgfHwgXCJcIikgOiBsaW5lVmlldy5saW5lLnRleHRDbGFzcztcbiAgICBsaW5lVmlldy50ZXh0LmNsYXNzTmFtZSA9IHRleHRDbGFzcyB8fCBcIlwiO1xuICB9XG5cbiAgZnVuY3Rpb24gdXBkYXRlTGluZUd1dHRlcihjbSwgbGluZVZpZXcsIGxpbmVOLCBkaW1zKSB7XG4gICAgaWYgKGxpbmVWaWV3Lmd1dHRlcikge1xuICAgICAgbGluZVZpZXcubm9kZS5yZW1vdmVDaGlsZChsaW5lVmlldy5ndXR0ZXIpO1xuICAgICAgbGluZVZpZXcuZ3V0dGVyID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKGxpbmVWaWV3Lmd1dHRlckJhY2tncm91bmQpIHtcbiAgICAgIGxpbmVWaWV3Lm5vZGUucmVtb3ZlQ2hpbGQobGluZVZpZXcuZ3V0dGVyQmFja2dyb3VuZCk7XG4gICAgICBsaW5lVmlldy5ndXR0ZXJCYWNrZ3JvdW5kID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKGxpbmVWaWV3LmxpbmUuZ3V0dGVyQ2xhc3MpIHtcbiAgICAgIHZhciB3cmFwID0gZW5zdXJlTGluZVdyYXBwZWQobGluZVZpZXcpO1xuICAgICAgbGluZVZpZXcuZ3V0dGVyQmFja2dyb3VuZCA9IGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3ItZ3V0dGVyLWJhY2tncm91bmQgXCIgKyBsaW5lVmlldy5saW5lLmd1dHRlckNsYXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxlZnQ6IFwiICsgKGNtLm9wdGlvbnMuZml4ZWRHdXR0ZXIgPyBkaW1zLmZpeGVkUG9zIDogLWRpbXMuZ3V0dGVyVG90YWxXaWR0aCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB4OyB3aWR0aDogXCIgKyBkaW1zLmd1dHRlclRvdGFsV2lkdGggKyBcInB4XCIpO1xuICAgICAgd3JhcC5pbnNlcnRCZWZvcmUobGluZVZpZXcuZ3V0dGVyQmFja2dyb3VuZCwgbGluZVZpZXcudGV4dCk7XG4gICAgfVxuICAgIHZhciBtYXJrZXJzID0gbGluZVZpZXcubGluZS5ndXR0ZXJNYXJrZXJzO1xuICAgIGlmIChjbS5vcHRpb25zLmxpbmVOdW1iZXJzIHx8IG1hcmtlcnMpIHtcbiAgICAgIHZhciB3cmFwID0gZW5zdXJlTGluZVdyYXBwZWQobGluZVZpZXcpO1xuICAgICAgdmFyIGd1dHRlcldyYXAgPSBsaW5lVmlldy5ndXR0ZXIgPSBlbHQoXCJkaXZcIiwgbnVsbCwgXCJDb2RlTWlycm9yLWd1dHRlci13cmFwcGVyXCIsIFwibGVmdDogXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNtLm9wdGlvbnMuZml4ZWRHdXR0ZXIgPyBkaW1zLmZpeGVkUG9zIDogLWRpbXMuZ3V0dGVyVG90YWxXaWR0aCkgKyBcInB4XCIpO1xuICAgICAgY20uZGlzcGxheS5pbnB1dC5zZXRVbmVkaXRhYmxlKGd1dHRlcldyYXApO1xuICAgICAgd3JhcC5pbnNlcnRCZWZvcmUoZ3V0dGVyV3JhcCwgbGluZVZpZXcudGV4dCk7XG4gICAgICBpZiAobGluZVZpZXcubGluZS5ndXR0ZXJDbGFzcylcbiAgICAgICAgZ3V0dGVyV3JhcC5jbGFzc05hbWUgKz0gXCIgXCIgKyBsaW5lVmlldy5saW5lLmd1dHRlckNsYXNzO1xuICAgICAgaWYgKGNtLm9wdGlvbnMubGluZU51bWJlcnMgJiYgKCFtYXJrZXJzIHx8ICFtYXJrZXJzW1wiQ29kZU1pcnJvci1saW5lbnVtYmVyc1wiXSkpXG4gICAgICAgIGxpbmVWaWV3LmxpbmVOdW1iZXIgPSBndXR0ZXJXcmFwLmFwcGVuZENoaWxkKFxuICAgICAgICAgIGVsdChcImRpdlwiLCBsaW5lTnVtYmVyRm9yKGNtLm9wdGlvbnMsIGxpbmVOKSxcbiAgICAgICAgICAgICAgXCJDb2RlTWlycm9yLWxpbmVudW1iZXIgQ29kZU1pcnJvci1ndXR0ZXItZWx0XCIsXG4gICAgICAgICAgICAgIFwibGVmdDogXCIgKyBkaW1zLmd1dHRlckxlZnRbXCJDb2RlTWlycm9yLWxpbmVudW1iZXJzXCJdICsgXCJweDsgd2lkdGg6IFwiXG4gICAgICAgICAgICAgICsgY20uZGlzcGxheS5saW5lTnVtSW5uZXJXaWR0aCArIFwicHhcIikpO1xuICAgICAgaWYgKG1hcmtlcnMpIGZvciAodmFyIGsgPSAwOyBrIDwgY20ub3B0aW9ucy5ndXR0ZXJzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgIHZhciBpZCA9IGNtLm9wdGlvbnMuZ3V0dGVyc1trXSwgZm91bmQgPSBtYXJrZXJzLmhhc093blByb3BlcnR5KGlkKSAmJiBtYXJrZXJzW2lkXTtcbiAgICAgICAgaWYgKGZvdW5kKVxuICAgICAgICAgIGd1dHRlcldyYXAuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsIFtmb3VuZF0sIFwiQ29kZU1pcnJvci1ndXR0ZXItZWx0XCIsIFwibGVmdDogXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpbXMuZ3V0dGVyTGVmdFtpZF0gKyBcInB4OyB3aWR0aDogXCIgKyBkaW1zLmd1dHRlcldpZHRoW2lkXSArIFwicHhcIikpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZUxpbmVXaWRnZXRzKGNtLCBsaW5lVmlldywgZGltcykge1xuICAgIGlmIChsaW5lVmlldy5hbGlnbmFibGUpIGxpbmVWaWV3LmFsaWduYWJsZSA9IG51bGw7XG4gICAgZm9yICh2YXIgbm9kZSA9IGxpbmVWaWV3Lm5vZGUuZmlyc3RDaGlsZCwgbmV4dDsgbm9kZTsgbm9kZSA9IG5leHQpIHtcbiAgICAgIHZhciBuZXh0ID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgIGlmIChub2RlLmNsYXNzTmFtZSA9PSBcIkNvZGVNaXJyb3ItbGluZXdpZGdldFwiKVxuICAgICAgICBsaW5lVmlldy5ub2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xuICAgIH1cbiAgICBpbnNlcnRMaW5lV2lkZ2V0cyhjbSwgbGluZVZpZXcsIGRpbXMpO1xuICB9XG5cbiAgLy8gQnVpbGQgYSBsaW5lJ3MgRE9NIHJlcHJlc2VudGF0aW9uIGZyb20gc2NyYXRjaFxuICBmdW5jdGlvbiBidWlsZExpbmVFbGVtZW50KGNtLCBsaW5lVmlldywgbGluZU4sIGRpbXMpIHtcbiAgICB2YXIgYnVpbHQgPSBnZXRMaW5lQ29udGVudChjbSwgbGluZVZpZXcpO1xuICAgIGxpbmVWaWV3LnRleHQgPSBsaW5lVmlldy5ub2RlID0gYnVpbHQucHJlO1xuICAgIGlmIChidWlsdC5iZ0NsYXNzKSBsaW5lVmlldy5iZ0NsYXNzID0gYnVpbHQuYmdDbGFzcztcbiAgICBpZiAoYnVpbHQudGV4dENsYXNzKSBsaW5lVmlldy50ZXh0Q2xhc3MgPSBidWlsdC50ZXh0Q2xhc3M7XG5cbiAgICB1cGRhdGVMaW5lQ2xhc3NlcyhsaW5lVmlldyk7XG4gICAgdXBkYXRlTGluZUd1dHRlcihjbSwgbGluZVZpZXcsIGxpbmVOLCBkaW1zKTtcbiAgICBpbnNlcnRMaW5lV2lkZ2V0cyhjbSwgbGluZVZpZXcsIGRpbXMpO1xuICAgIHJldHVybiBsaW5lVmlldy5ub2RlO1xuICB9XG5cbiAgLy8gQSBsaW5lVmlldyBtYXkgY29udGFpbiBtdWx0aXBsZSBsb2dpY2FsIGxpbmVzICh3aGVuIG1lcmdlZCBieVxuICAvLyBjb2xsYXBzZWQgc3BhbnMpLiBUaGUgd2lkZ2V0cyBmb3IgYWxsIG9mIHRoZW0gbmVlZCB0byBiZSBkcmF3bi5cbiAgZnVuY3Rpb24gaW5zZXJ0TGluZVdpZGdldHMoY20sIGxpbmVWaWV3LCBkaW1zKSB7XG4gICAgaW5zZXJ0TGluZVdpZGdldHNGb3IoY20sIGxpbmVWaWV3LmxpbmUsIGxpbmVWaWV3LCBkaW1zLCB0cnVlKTtcbiAgICBpZiAobGluZVZpZXcucmVzdCkgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lVmlldy5yZXN0Lmxlbmd0aDsgaSsrKVxuICAgICAgaW5zZXJ0TGluZVdpZGdldHNGb3IoY20sIGxpbmVWaWV3LnJlc3RbaV0sIGxpbmVWaWV3LCBkaW1zLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBpbnNlcnRMaW5lV2lkZ2V0c0ZvcihjbSwgbGluZSwgbGluZVZpZXcsIGRpbXMsIGFsbG93QWJvdmUpIHtcbiAgICBpZiAoIWxpbmUud2lkZ2V0cykgcmV0dXJuO1xuICAgIHZhciB3cmFwID0gZW5zdXJlTGluZVdyYXBwZWQobGluZVZpZXcpO1xuICAgIGZvciAodmFyIGkgPSAwLCB3cyA9IGxpbmUud2lkZ2V0czsgaSA8IHdzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgd2lkZ2V0ID0gd3NbaV0sIG5vZGUgPSBlbHQoXCJkaXZcIiwgW3dpZGdldC5ub2RlXSwgXCJDb2RlTWlycm9yLWxpbmV3aWRnZXRcIik7XG4gICAgICBpZiAoIXdpZGdldC5oYW5kbGVNb3VzZUV2ZW50cykgbm9kZS5zZXRBdHRyaWJ1dGUoXCJjbS1pZ25vcmUtZXZlbnRzXCIsIFwidHJ1ZVwiKTtcbiAgICAgIHBvc2l0aW9uTGluZVdpZGdldCh3aWRnZXQsIG5vZGUsIGxpbmVWaWV3LCBkaW1zKTtcbiAgICAgIGNtLmRpc3BsYXkuaW5wdXQuc2V0VW5lZGl0YWJsZShub2RlKTtcbiAgICAgIGlmIChhbGxvd0Fib3ZlICYmIHdpZGdldC5hYm92ZSlcbiAgICAgICAgd3JhcC5pbnNlcnRCZWZvcmUobm9kZSwgbGluZVZpZXcuZ3V0dGVyIHx8IGxpbmVWaWV3LnRleHQpO1xuICAgICAgZWxzZVxuICAgICAgICB3cmFwLmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgc2lnbmFsTGF0ZXIod2lkZ2V0LCBcInJlZHJhd1wiKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwb3NpdGlvbkxpbmVXaWRnZXQod2lkZ2V0LCBub2RlLCBsaW5lVmlldywgZGltcykge1xuICAgIGlmICh3aWRnZXQubm9IU2Nyb2xsKSB7XG4gICAgICAobGluZVZpZXcuYWxpZ25hYmxlIHx8IChsaW5lVmlldy5hbGlnbmFibGUgPSBbXSkpLnB1c2gobm9kZSk7XG4gICAgICB2YXIgd2lkdGggPSBkaW1zLndyYXBwZXJXaWR0aDtcbiAgICAgIG5vZGUuc3R5bGUubGVmdCA9IGRpbXMuZml4ZWRQb3MgKyBcInB4XCI7XG4gICAgICBpZiAoIXdpZGdldC5jb3Zlckd1dHRlcikge1xuICAgICAgICB3aWR0aCAtPSBkaW1zLmd1dHRlclRvdGFsV2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUucGFkZGluZ0xlZnQgPSBkaW1zLmd1dHRlclRvdGFsV2lkdGggKyBcInB4XCI7XG4gICAgICB9XG4gICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGggKyBcInB4XCI7XG4gICAgfVxuICAgIGlmICh3aWRnZXQuY292ZXJHdXR0ZXIpIHtcbiAgICAgIG5vZGUuc3R5bGUuekluZGV4ID0gNTtcbiAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSBcInJlbGF0aXZlXCI7XG4gICAgICBpZiAoIXdpZGdldC5ub0hTY3JvbGwpIG5vZGUuc3R5bGUubWFyZ2luTGVmdCA9IC1kaW1zLmd1dHRlclRvdGFsV2lkdGggKyBcInB4XCI7XG4gICAgfVxuICB9XG5cbiAgLy8gUE9TSVRJT04gT0JKRUNUXG5cbiAgLy8gQSBQb3MgaW5zdGFuY2UgcmVwcmVzZW50cyBhIHBvc2l0aW9uIHdpdGhpbiB0aGUgdGV4dC5cbiAgdmFyIFBvcyA9IENvZGVNaXJyb3IuUG9zID0gZnVuY3Rpb24obGluZSwgY2gpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUG9zKSkgcmV0dXJuIG5ldyBQb3MobGluZSwgY2gpO1xuICAgIHRoaXMubGluZSA9IGxpbmU7IHRoaXMuY2ggPSBjaDtcbiAgfTtcblxuICAvLyBDb21wYXJlIHR3byBwb3NpdGlvbnMsIHJldHVybiAwIGlmIHRoZXkgYXJlIHRoZSBzYW1lLCBhIG5lZ2F0aXZlXG4gIC8vIG51bWJlciB3aGVuIGEgaXMgbGVzcywgYW5kIGEgcG9zaXRpdmUgbnVtYmVyIG90aGVyd2lzZS5cbiAgdmFyIGNtcCA9IENvZGVNaXJyb3IuY21wUG9zID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYS5saW5lIC0gYi5saW5lIHx8IGEuY2ggLSBiLmNoOyB9O1xuXG4gIGZ1bmN0aW9uIGNvcHlQb3MoeCkge3JldHVybiBQb3MoeC5saW5lLCB4LmNoKTt9XG4gIGZ1bmN0aW9uIG1heFBvcyhhLCBiKSB7IHJldHVybiBjbXAoYSwgYikgPCAwID8gYiA6IGE7IH1cbiAgZnVuY3Rpb24gbWluUG9zKGEsIGIpIHsgcmV0dXJuIGNtcChhLCBiKSA8IDAgPyBhIDogYjsgfVxuXG4gIC8vIElOUFVUIEhBTkRMSU5HXG5cbiAgZnVuY3Rpb24gZW5zdXJlRm9jdXMoY20pIHtcbiAgICBpZiAoIWNtLnN0YXRlLmZvY3VzZWQpIHsgY20uZGlzcGxheS5pbnB1dC5mb2N1cygpOyBvbkZvY3VzKGNtKTsgfVxuICB9XG5cbiAgZnVuY3Rpb24gaXNSZWFkT25seShjbSkge1xuICAgIHJldHVybiBjbS5vcHRpb25zLnJlYWRPbmx5IHx8IGNtLmRvYy5jYW50RWRpdDtcbiAgfVxuXG4gIC8vIFRoaXMgd2lsbCBiZSBzZXQgdG8gYW4gYXJyYXkgb2Ygc3RyaW5ncyB3aGVuIGNvcHlpbmcsIHNvIHRoYXQsXG4gIC8vIHdoZW4gcGFzdGluZywgd2Uga25vdyB3aGF0IGtpbmQgb2Ygc2VsZWN0aW9ucyB0aGUgY29waWVkIHRleHRcbiAgLy8gd2FzIG1hZGUgb3V0IG9mLlxuICB2YXIgbGFzdENvcGllZCA9IG51bGw7XG5cbiAgZnVuY3Rpb24gYXBwbHlUZXh0SW5wdXQoY20sIGluc2VydGVkLCBkZWxldGVkLCBzZWwsIG9yaWdpbikge1xuICAgIHZhciBkb2MgPSBjbS5kb2M7XG4gICAgY20uZGlzcGxheS5zaGlmdCA9IGZhbHNlO1xuICAgIGlmICghc2VsKSBzZWwgPSBkb2Muc2VsO1xuXG4gICAgdmFyIHBhc3RlID0gY20uc3RhdGUucGFzdGVJbmNvbWluZyB8fCBvcmlnaW4gPT0gXCJwYXN0ZVwiO1xuICAgIHZhciB0ZXh0TGluZXMgPSBkb2Muc3BsaXRMaW5lcyhpbnNlcnRlZCksIG11bHRpUGFzdGUgPSBudWxsO1xuICAgIC8vIFdoZW4gcGFzaW5nIE4gbGluZXMgaW50byBOIHNlbGVjdGlvbnMsIGluc2VydCBvbmUgbGluZSBwZXIgc2VsZWN0aW9uXG4gICAgaWYgKHBhc3RlICYmIHNlbC5yYW5nZXMubGVuZ3RoID4gMSkge1xuICAgICAgaWYgKGxhc3RDb3BpZWQgJiYgbGFzdENvcGllZC5qb2luKFwiXFxuXCIpID09IGluc2VydGVkKSB7XG4gICAgICAgIGlmIChzZWwucmFuZ2VzLmxlbmd0aCAlIGxhc3RDb3BpZWQubGVuZ3RoID09IDApIHtcbiAgICAgICAgICBtdWx0aVBhc3RlID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0Q29waWVkLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgbXVsdGlQYXN0ZS5wdXNoKGRvYy5zcGxpdExpbmVzKGxhc3RDb3BpZWRbaV0pKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0ZXh0TGluZXMubGVuZ3RoID09IHNlbC5yYW5nZXMubGVuZ3RoKSB7XG4gICAgICAgIG11bHRpUGFzdGUgPSBtYXAodGV4dExpbmVzLCBmdW5jdGlvbihsKSB7IHJldHVybiBbbF07IH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vcm1hbCBiZWhhdmlvciBpcyB0byBpbnNlcnQgdGhlIG5ldyB0ZXh0IGludG8gZXZlcnkgc2VsZWN0aW9uXG4gICAgZm9yICh2YXIgaSA9IHNlbC5yYW5nZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciByYW5nZSA9IHNlbC5yYW5nZXNbaV07XG4gICAgICB2YXIgZnJvbSA9IHJhbmdlLmZyb20oKSwgdG8gPSByYW5nZS50bygpO1xuICAgICAgaWYgKHJhbmdlLmVtcHR5KCkpIHtcbiAgICAgICAgaWYgKGRlbGV0ZWQgJiYgZGVsZXRlZCA+IDApIC8vIEhhbmRsZSBkZWxldGlvblxuICAgICAgICAgIGZyb20gPSBQb3MoZnJvbS5saW5lLCBmcm9tLmNoIC0gZGVsZXRlZCk7XG4gICAgICAgIGVsc2UgaWYgKGNtLnN0YXRlLm92ZXJ3cml0ZSAmJiAhcGFzdGUpIC8vIEhhbmRsZSBvdmVyd3JpdGVcbiAgICAgICAgICB0byA9IFBvcyh0by5saW5lLCBNYXRoLm1pbihnZXRMaW5lKGRvYywgdG8ubGluZSkudGV4dC5sZW5ndGgsIHRvLmNoICsgbHN0KHRleHRMaW5lcykubGVuZ3RoKSk7XG4gICAgICB9XG4gICAgICB2YXIgdXBkYXRlSW5wdXQgPSBjbS5jdXJPcC51cGRhdGVJbnB1dDtcbiAgICAgIHZhciBjaGFuZ2VFdmVudCA9IHtmcm9tOiBmcm9tLCB0bzogdG8sIHRleHQ6IG11bHRpUGFzdGUgPyBtdWx0aVBhc3RlW2kgJSBtdWx0aVBhc3RlLmxlbmd0aF0gOiB0ZXh0TGluZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBvcmlnaW4gfHwgKHBhc3RlID8gXCJwYXN0ZVwiIDogY20uc3RhdGUuY3V0SW5jb21pbmcgPyBcImN1dFwiIDogXCIraW5wdXRcIil9O1xuICAgICAgbWFrZUNoYW5nZShjbS5kb2MsIGNoYW5nZUV2ZW50KTtcbiAgICAgIHNpZ25hbExhdGVyKGNtLCBcImlucHV0UmVhZFwiLCBjbSwgY2hhbmdlRXZlbnQpO1xuICAgIH1cbiAgICBpZiAoaW5zZXJ0ZWQgJiYgIXBhc3RlKVxuICAgICAgdHJpZ2dlckVsZWN0cmljKGNtLCBpbnNlcnRlZCk7XG5cbiAgICBlbnN1cmVDdXJzb3JWaXNpYmxlKGNtKTtcbiAgICBjbS5jdXJPcC51cGRhdGVJbnB1dCA9IHVwZGF0ZUlucHV0O1xuICAgIGNtLmN1ck9wLnR5cGluZyA9IHRydWU7XG4gICAgY20uc3RhdGUucGFzdGVJbmNvbWluZyA9IGNtLnN0YXRlLmN1dEluY29taW5nID0gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVQYXN0ZShlLCBjbSkge1xuICAgIHZhciBwYXN0ZWQgPSBlLmNsaXBib2FyZERhdGEgJiYgZS5jbGlwYm9hcmREYXRhLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpO1xuICAgIGlmIChwYXN0ZWQpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmICghaXNSZWFkT25seShjbSkgJiYgIWNtLm9wdGlvbnMuZGlzYWJsZUlucHV0KVxuICAgICAgICBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHsgYXBwbHlUZXh0SW5wdXQoY20sIHBhc3RlZCwgMCwgbnVsbCwgXCJwYXN0ZVwiKTsgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB0cmlnZ2VyRWxlY3RyaWMoY20sIGluc2VydGVkKSB7XG4gICAgLy8gV2hlbiBhbiAnZWxlY3RyaWMnIGNoYXJhY3RlciBpcyBpbnNlcnRlZCwgaW1tZWRpYXRlbHkgdHJpZ2dlciBhIHJlaW5kZW50XG4gICAgaWYgKCFjbS5vcHRpb25zLmVsZWN0cmljQ2hhcnMgfHwgIWNtLm9wdGlvbnMuc21hcnRJbmRlbnQpIHJldHVybjtcbiAgICB2YXIgc2VsID0gY20uZG9jLnNlbDtcblxuICAgIGZvciAodmFyIGkgPSBzZWwucmFuZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgcmFuZ2UgPSBzZWwucmFuZ2VzW2ldO1xuICAgICAgaWYgKHJhbmdlLmhlYWQuY2ggPiAxMDAgfHwgKGkgJiYgc2VsLnJhbmdlc1tpIC0gMV0uaGVhZC5saW5lID09IHJhbmdlLmhlYWQubGluZSkpIGNvbnRpbnVlO1xuICAgICAgdmFyIG1vZGUgPSBjbS5nZXRNb2RlQXQocmFuZ2UuaGVhZCk7XG4gICAgICB2YXIgaW5kZW50ZWQgPSBmYWxzZTtcbiAgICAgIGlmIChtb2RlLmVsZWN0cmljQ2hhcnMpIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBtb2RlLmVsZWN0cmljQ2hhcnMubGVuZ3RoOyBqKyspXG4gICAgICAgICAgaWYgKGluc2VydGVkLmluZGV4T2YobW9kZS5lbGVjdHJpY0NoYXJzLmNoYXJBdChqKSkgPiAtMSkge1xuICAgICAgICAgICAgaW5kZW50ZWQgPSBpbmRlbnRMaW5lKGNtLCByYW5nZS5oZWFkLmxpbmUsIFwic21hcnRcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG1vZGUuZWxlY3RyaWNJbnB1dCkge1xuICAgICAgICBpZiAobW9kZS5lbGVjdHJpY0lucHV0LnRlc3QoZ2V0TGluZShjbS5kb2MsIHJhbmdlLmhlYWQubGluZSkudGV4dC5zbGljZSgwLCByYW5nZS5oZWFkLmNoKSkpXG4gICAgICAgICAgaW5kZW50ZWQgPSBpbmRlbnRMaW5lKGNtLCByYW5nZS5oZWFkLmxpbmUsIFwic21hcnRcIik7XG4gICAgICB9XG4gICAgICBpZiAoaW5kZW50ZWQpIHNpZ25hbExhdGVyKGNtLCBcImVsZWN0cmljSW5wdXRcIiwgY20sIHJhbmdlLmhlYWQubGluZSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY29weWFibGVSYW5nZXMoY20pIHtcbiAgICB2YXIgdGV4dCA9IFtdLCByYW5nZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNtLmRvYy5zZWwucmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbGluZSA9IGNtLmRvYy5zZWwucmFuZ2VzW2ldLmhlYWQubGluZTtcbiAgICAgIHZhciBsaW5lUmFuZ2UgPSB7YW5jaG9yOiBQb3MobGluZSwgMCksIGhlYWQ6IFBvcyhsaW5lICsgMSwgMCl9O1xuICAgICAgcmFuZ2VzLnB1c2gobGluZVJhbmdlKTtcbiAgICAgIHRleHQucHVzaChjbS5nZXRSYW5nZShsaW5lUmFuZ2UuYW5jaG9yLCBsaW5lUmFuZ2UuaGVhZCkpO1xuICAgIH1cbiAgICByZXR1cm4ge3RleHQ6IHRleHQsIHJhbmdlczogcmFuZ2VzfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRpc2FibGVCcm93c2VyTWFnaWMoZmllbGQpIHtcbiAgICBmaWVsZC5zZXRBdHRyaWJ1dGUoXCJhdXRvY29ycmVjdFwiLCBcIm9mZlwiKTtcbiAgICBmaWVsZC5zZXRBdHRyaWJ1dGUoXCJhdXRvY2FwaXRhbGl6ZVwiLCBcIm9mZlwiKTtcbiAgICBmaWVsZC5zZXRBdHRyaWJ1dGUoXCJzcGVsbGNoZWNrXCIsIFwiZmFsc2VcIik7XG4gIH1cblxuICAvLyBURVhUQVJFQSBJTlBVVCBTVFlMRVxuXG4gIGZ1bmN0aW9uIFRleHRhcmVhSW5wdXQoY20pIHtcbiAgICB0aGlzLmNtID0gY207XG4gICAgLy8gU2VlIGlucHV0LnBvbGwgYW5kIGlucHV0LnJlc2V0XG4gICAgdGhpcy5wcmV2SW5wdXQgPSBcIlwiO1xuXG4gICAgLy8gRmxhZyB0aGF0IGluZGljYXRlcyB3aGV0aGVyIHdlIGV4cGVjdCBpbnB1dCB0byBhcHBlYXIgcmVhbCBzb29uXG4gICAgLy8gbm93IChhZnRlciBzb21lIGV2ZW50IGxpa2UgJ2tleXByZXNzJyBvciAnaW5wdXQnKSBhbmQgYXJlXG4gICAgLy8gcG9sbGluZyBpbnRlbnNpdmVseS5cbiAgICB0aGlzLnBvbGxpbmdGYXN0ID0gZmFsc2U7XG4gICAgLy8gU2VsZi1yZXNldHRpbmcgdGltZW91dCBmb3IgdGhlIHBvbGxlclxuICAgIHRoaXMucG9sbGluZyA9IG5ldyBEZWxheWVkKCk7XG4gICAgLy8gVHJhY2tzIHdoZW4gaW5wdXQucmVzZXQgaGFzIHB1bnRlZCB0byBqdXN0IHB1dHRpbmcgYSBzaG9ydFxuICAgIC8vIHN0cmluZyBpbnRvIHRoZSB0ZXh0YXJlYSBpbnN0ZWFkIG9mIHRoZSBmdWxsIHNlbGVjdGlvbi5cbiAgICB0aGlzLmluYWNjdXJhdGVTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAvLyBVc2VkIHRvIHdvcmsgYXJvdW5kIElFIGlzc3VlIHdpdGggc2VsZWN0aW9uIGJlaW5nIGZvcmdvdHRlbiB3aGVuIGZvY3VzIG1vdmVzIGF3YXkgZnJvbSB0ZXh0YXJlYVxuICAgIHRoaXMuaGFzU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5jb21wb3NpbmcgPSBudWxsO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGhpZGRlblRleHRhcmVhKCkge1xuICAgIHZhciB0ZSA9IGVsdChcInRleHRhcmVhXCIsIG51bGwsIG51bGwsIFwicG9zaXRpb246IGFic29sdXRlOyBwYWRkaW5nOiAwOyB3aWR0aDogMXB4OyBoZWlnaHQ6IDFlbTsgb3V0bGluZTogbm9uZVwiKTtcbiAgICB2YXIgZGl2ID0gZWx0KFwiZGl2XCIsIFt0ZV0sIG51bGwsIFwib3ZlcmZsb3c6IGhpZGRlbjsgcG9zaXRpb246IHJlbGF0aXZlOyB3aWR0aDogM3B4OyBoZWlnaHQ6IDBweDtcIik7XG4gICAgLy8gVGhlIHRleHRhcmVhIGlzIGtlcHQgcG9zaXRpb25lZCBuZWFyIHRoZSBjdXJzb3IgdG8gcHJldmVudCB0aGVcbiAgICAvLyBmYWN0IHRoYXQgaXQnbGwgYmUgc2Nyb2xsZWQgaW50byB2aWV3IG9uIGlucHV0IGZyb20gc2Nyb2xsaW5nXG4gICAgLy8gb3VyIGZha2UgY3Vyc29yIG91dCBvZiB2aWV3LiBPbiB3ZWJraXQsIHdoZW4gd3JhcD1vZmYsIHBhc3RlIGlzXG4gICAgLy8gdmVyeSBzbG93LiBTbyBtYWtlIHRoZSBhcmVhIHdpZGUgaW5zdGVhZC5cbiAgICBpZiAod2Via2l0KSB0ZS5zdHlsZS53aWR0aCA9IFwiMTAwMHB4XCI7XG4gICAgZWxzZSB0ZS5zZXRBdHRyaWJ1dGUoXCJ3cmFwXCIsIFwib2ZmXCIpO1xuICAgIC8vIElmIGJvcmRlcjogMDsgLS0gaU9TIGZhaWxzIHRvIG9wZW4ga2V5Ym9hcmQgKGlzc3VlICMxMjg3KVxuICAgIGlmIChpb3MpIHRlLnN0eWxlLmJvcmRlciA9IFwiMXB4IHNvbGlkIGJsYWNrXCI7XG4gICAgZGlzYWJsZUJyb3dzZXJNYWdpYyh0ZSk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfVxuXG4gIFRleHRhcmVhSW5wdXQucHJvdG90eXBlID0gY29weU9iaih7XG4gICAgaW5pdDogZnVuY3Rpb24oZGlzcGxheSkge1xuICAgICAgdmFyIGlucHV0ID0gdGhpcywgY20gPSB0aGlzLmNtO1xuXG4gICAgICAvLyBXcmFwcyBhbmQgaGlkZXMgaW5wdXQgdGV4dGFyZWFcbiAgICAgIHZhciBkaXYgPSB0aGlzLndyYXBwZXIgPSBoaWRkZW5UZXh0YXJlYSgpO1xuICAgICAgLy8gVGhlIHNlbWloaWRkZW4gdGV4dGFyZWEgdGhhdCBpcyBmb2N1c2VkIHdoZW4gdGhlIGVkaXRvciBpc1xuICAgICAgLy8gZm9jdXNlZCwgYW5kIHJlY2VpdmVzIGlucHV0LlxuICAgICAgdmFyIHRlID0gdGhpcy50ZXh0YXJlYSA9IGRpdi5maXJzdENoaWxkO1xuICAgICAgZGlzcGxheS53cmFwcGVyLmluc2VydEJlZm9yZShkaXYsIGRpc3BsYXkud3JhcHBlci5maXJzdENoaWxkKTtcblxuICAgICAgLy8gTmVlZGVkIHRvIGhpZGUgYmlnIGJsdWUgYmxpbmtpbmcgY3Vyc29yIG9uIE1vYmlsZSBTYWZhcmkgKGRvZXNuJ3Qgc2VlbSB0byB3b3JrIGluIGlPUyA4IGFueW1vcmUpXG4gICAgICBpZiAoaW9zKSB0ZS5zdHlsZS53aWR0aCA9IFwiMHB4XCI7XG5cbiAgICAgIG9uKHRlLCBcImlucHV0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoaWUgJiYgaWVfdmVyc2lvbiA+PSA5ICYmIGlucHV0Lmhhc1NlbGVjdGlvbikgaW5wdXQuaGFzU2VsZWN0aW9uID0gbnVsbDtcbiAgICAgICAgaW5wdXQucG9sbCgpO1xuICAgICAgfSk7XG5cbiAgICAgIG9uKHRlLCBcInBhc3RlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGhhbmRsZVBhc3RlKGUsIGNtKSkgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgY20uc3RhdGUucGFzdGVJbmNvbWluZyA9IHRydWU7XG4gICAgICAgIGlucHV0LmZhc3RQb2xsKCk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gcHJlcGFyZUNvcHlDdXQoZSkge1xuICAgICAgICBpZiAoY20uc29tZXRoaW5nU2VsZWN0ZWQoKSkge1xuICAgICAgICAgIGxhc3RDb3BpZWQgPSBjbS5nZXRTZWxlY3Rpb25zKCk7XG4gICAgICAgICAgaWYgKGlucHV0LmluYWNjdXJhdGVTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGlucHV0LnByZXZJbnB1dCA9IFwiXCI7XG4gICAgICAgICAgICBpbnB1dC5pbmFjY3VyYXRlU2VsZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB0ZS52YWx1ZSA9IGxhc3RDb3BpZWQuam9pbihcIlxcblwiKTtcbiAgICAgICAgICAgIHNlbGVjdElucHV0KHRlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIWNtLm9wdGlvbnMubGluZVdpc2VDb3B5Q3V0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciByYW5nZXMgPSBjb3B5YWJsZVJhbmdlcyhjbSk7XG4gICAgICAgICAgbGFzdENvcGllZCA9IHJhbmdlcy50ZXh0O1xuICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJjdXRcIikge1xuICAgICAgICAgICAgY20uc2V0U2VsZWN0aW9ucyhyYW5nZXMucmFuZ2VzLCBudWxsLCBzZWxfZG9udFNjcm9sbCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0LnByZXZJbnB1dCA9IFwiXCI7XG4gICAgICAgICAgICB0ZS52YWx1ZSA9IHJhbmdlcy50ZXh0LmpvaW4oXCJcXG5cIik7XG4gICAgICAgICAgICBzZWxlY3RJbnB1dCh0ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlLnR5cGUgPT0gXCJjdXRcIikgY20uc3RhdGUuY3V0SW5jb21pbmcgPSB0cnVlO1xuICAgICAgfVxuICAgICAgb24odGUsIFwiY3V0XCIsIHByZXBhcmVDb3B5Q3V0KTtcbiAgICAgIG9uKHRlLCBcImNvcHlcIiwgcHJlcGFyZUNvcHlDdXQpO1xuXG4gICAgICBvbihkaXNwbGF5LnNjcm9sbGVyLCBcInBhc3RlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGV2ZW50SW5XaWRnZXQoZGlzcGxheSwgZSkpIHJldHVybjtcbiAgICAgICAgY20uc3RhdGUucGFzdGVJbmNvbWluZyA9IHRydWU7XG4gICAgICAgIGlucHV0LmZvY3VzKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gUHJldmVudCBub3JtYWwgc2VsZWN0aW9uIGluIHRoZSBlZGl0b3IgKHdlIGhhbmRsZSBvdXIgb3duKVxuICAgICAgb24oZGlzcGxheS5saW5lU3BhY2UsIFwic2VsZWN0c3RhcnRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoIWV2ZW50SW5XaWRnZXQoZGlzcGxheSwgZSkpIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICB9KTtcblxuICAgICAgb24odGUsIFwiY29tcG9zaXRpb25zdGFydFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gY20uZ2V0Q3Vyc29yKFwiZnJvbVwiKTtcbiAgICAgICAgaWYgKGlucHV0LmNvbXBvc2luZykgaW5wdXQuY29tcG9zaW5nLnJhbmdlLmNsZWFyKClcbiAgICAgICAgaW5wdXQuY29tcG9zaW5nID0ge1xuICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICByYW5nZTogY20ubWFya1RleHQoc3RhcnQsIGNtLmdldEN1cnNvcihcInRvXCIpLCB7Y2xhc3NOYW1lOiBcIkNvZGVNaXJyb3ItY29tcG9zaW5nXCJ9KVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBvbih0ZSwgXCJjb21wb3NpdGlvbmVuZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGlucHV0LmNvbXBvc2luZykge1xuICAgICAgICAgIGlucHV0LnBvbGwoKTtcbiAgICAgICAgICBpbnB1dC5jb21wb3NpbmcucmFuZ2UuY2xlYXIoKTtcbiAgICAgICAgICBpbnB1dC5jb21wb3NpbmcgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgcHJlcGFyZVNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAvLyBSZWRyYXcgdGhlIHNlbGVjdGlvbiBhbmQvb3IgY3Vyc29yXG4gICAgICB2YXIgY20gPSB0aGlzLmNtLCBkaXNwbGF5ID0gY20uZGlzcGxheSwgZG9jID0gY20uZG9jO1xuICAgICAgdmFyIHJlc3VsdCA9IHByZXBhcmVTZWxlY3Rpb24oY20pO1xuXG4gICAgICAvLyBNb3ZlIHRoZSBoaWRkZW4gdGV4dGFyZWEgbmVhciB0aGUgY3Vyc29yIHRvIHByZXZlbnQgc2Nyb2xsaW5nIGFydGlmYWN0c1xuICAgICAgaWYgKGNtLm9wdGlvbnMubW92ZUlucHV0V2l0aEN1cnNvcikge1xuICAgICAgICB2YXIgaGVhZFBvcyA9IGN1cnNvckNvb3JkcyhjbSwgZG9jLnNlbC5wcmltYXJ5KCkuaGVhZCwgXCJkaXZcIik7XG4gICAgICAgIHZhciB3cmFwT2ZmID0gZGlzcGxheS53cmFwcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBsaW5lT2ZmID0gZGlzcGxheS5saW5lRGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICByZXN1bHQudGVUb3AgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihkaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0IC0gMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRQb3MudG9wICsgbGluZU9mZi50b3AgLSB3cmFwT2ZmLnRvcCkpO1xuICAgICAgICByZXN1bHQudGVMZWZ0ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oZGlzcGxheS53cmFwcGVyLmNsaWVudFdpZHRoIC0gMTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkUG9zLmxlZnQgKyBsaW5lT2ZmLmxlZnQgLSB3cmFwT2ZmLmxlZnQpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG4gICAgc2hvd1NlbGVjdGlvbjogZnVuY3Rpb24oZHJhd24pIHtcbiAgICAgIHZhciBjbSA9IHRoaXMuY20sIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQoZGlzcGxheS5jdXJzb3JEaXYsIGRyYXduLmN1cnNvcnMpO1xuICAgICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQoZGlzcGxheS5zZWxlY3Rpb25EaXYsIGRyYXduLnNlbGVjdGlvbik7XG4gICAgICBpZiAoZHJhd24udGVUb3AgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLndyYXBwZXIuc3R5bGUudG9wID0gZHJhd24udGVUb3AgKyBcInB4XCI7XG4gICAgICAgIHRoaXMud3JhcHBlci5zdHlsZS5sZWZ0ID0gZHJhd24udGVMZWZ0ICsgXCJweFwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBSZXNldCB0aGUgaW5wdXQgdG8gY29ycmVzcG9uZCB0byB0aGUgc2VsZWN0aW9uIChvciB0byBiZSBlbXB0eSxcbiAgICAvLyB3aGVuIG5vdCB0eXBpbmcgYW5kIG5vdGhpbmcgaXMgc2VsZWN0ZWQpXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKHR5cGluZykge1xuICAgICAgaWYgKHRoaXMuY29udGV4dE1lbnVQZW5kaW5nKSByZXR1cm47XG4gICAgICB2YXIgbWluaW1hbCwgc2VsZWN0ZWQsIGNtID0gdGhpcy5jbSwgZG9jID0gY20uZG9jO1xuICAgICAgaWYgKGNtLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcbiAgICAgICAgdGhpcy5wcmV2SW5wdXQgPSBcIlwiO1xuICAgICAgICB2YXIgcmFuZ2UgPSBkb2Muc2VsLnByaW1hcnkoKTtcbiAgICAgICAgbWluaW1hbCA9IGhhc0NvcHlFdmVudCAmJlxuICAgICAgICAgIChyYW5nZS50bygpLmxpbmUgLSByYW5nZS5mcm9tKCkubGluZSA+IDEwMCB8fCAoc2VsZWN0ZWQgPSBjbS5nZXRTZWxlY3Rpb24oKSkubGVuZ3RoID4gMTAwMCk7XG4gICAgICAgIHZhciBjb250ZW50ID0gbWluaW1hbCA/IFwiLVwiIDogc2VsZWN0ZWQgfHwgY20uZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMudGV4dGFyZWEudmFsdWUgPSBjb250ZW50O1xuICAgICAgICBpZiAoY20uc3RhdGUuZm9jdXNlZCkgc2VsZWN0SW5wdXQodGhpcy50ZXh0YXJlYSk7XG4gICAgICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uID49IDkpIHRoaXMuaGFzU2VsZWN0aW9uID0gY29udGVudDtcbiAgICAgIH0gZWxzZSBpZiAoIXR5cGluZykge1xuICAgICAgICB0aGlzLnByZXZJbnB1dCA9IHRoaXMudGV4dGFyZWEudmFsdWUgPSBcIlwiO1xuICAgICAgICBpZiAoaWUgJiYgaWVfdmVyc2lvbiA+PSA5KSB0aGlzLmhhc1NlbGVjdGlvbiA9IG51bGw7XG4gICAgICB9XG4gICAgICB0aGlzLmluYWNjdXJhdGVTZWxlY3Rpb24gPSBtaW5pbWFsO1xuICAgIH0sXG5cbiAgICBnZXRGaWVsZDogZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzLnRleHRhcmVhOyB9LFxuXG4gICAgc3VwcG9ydHNUb3VjaDogZnVuY3Rpb24oKSB7IHJldHVybiBmYWxzZTsgfSxcblxuICAgIGZvY3VzOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLmNtLm9wdGlvbnMucmVhZE9ubHkgIT0gXCJub2N1cnNvclwiICYmICghbW9iaWxlIHx8IGFjdGl2ZUVsdCgpICE9IHRoaXMudGV4dGFyZWEpKSB7XG4gICAgICAgIHRyeSB7IHRoaXMudGV4dGFyZWEuZm9jdXMoKTsgfVxuICAgICAgICBjYXRjaCAoZSkge30gLy8gSUU4IHdpbGwgdGhyb3cgaWYgdGhlIHRleHRhcmVhIGlzIGRpc3BsYXk6IG5vbmUgb3Igbm90IGluIERPTVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBibHVyOiBmdW5jdGlvbigpIHsgdGhpcy50ZXh0YXJlYS5ibHVyKCk7IH0sXG5cbiAgICByZXNldFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMud3JhcHBlci5zdHlsZS50b3AgPSB0aGlzLndyYXBwZXIuc3R5bGUubGVmdCA9IDA7XG4gICAgfSxcblxuICAgIHJlY2VpdmVkRm9jdXM6IGZ1bmN0aW9uKCkgeyB0aGlzLnNsb3dQb2xsKCk7IH0sXG5cbiAgICAvLyBQb2xsIGZvciBpbnB1dCBjaGFuZ2VzLCB1c2luZyB0aGUgbm9ybWFsIHJhdGUgb2YgcG9sbGluZy4gVGhpc1xuICAgIC8vIHJ1bnMgYXMgbG9uZyBhcyB0aGUgZWRpdG9yIGlzIGZvY3VzZWQuXG4gICAgc2xvd1BvbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGlucHV0ID0gdGhpcztcbiAgICAgIGlmIChpbnB1dC5wb2xsaW5nRmFzdCkgcmV0dXJuO1xuICAgICAgaW5wdXQucG9sbGluZy5zZXQodGhpcy5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlucHV0LnBvbGwoKTtcbiAgICAgICAgaWYgKGlucHV0LmNtLnN0YXRlLmZvY3VzZWQpIGlucHV0LnNsb3dQb2xsKCk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy8gV2hlbiBhbiBldmVudCBoYXMganVzdCBjb21lIGluIHRoYXQgaXMgbGlrZWx5IHRvIGFkZCBvciBjaGFuZ2VcbiAgICAvLyBzb21ldGhpbmcgaW4gdGhlIGlucHV0IHRleHRhcmVhLCB3ZSBwb2xsIGZhc3RlciwgdG8gZW5zdXJlIHRoYXRcbiAgICAvLyB0aGUgY2hhbmdlIGFwcGVhcnMgb24gdGhlIHNjcmVlbiBxdWlja2x5LlxuICAgIGZhc3RQb2xsOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBtaXNzZWQgPSBmYWxzZSwgaW5wdXQgPSB0aGlzO1xuICAgICAgaW5wdXQucG9sbGluZ0Zhc3QgPSB0cnVlO1xuICAgICAgZnVuY3Rpb24gcCgpIHtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSBpbnB1dC5wb2xsKCk7XG4gICAgICAgIGlmICghY2hhbmdlZCAmJiAhbWlzc2VkKSB7bWlzc2VkID0gdHJ1ZTsgaW5wdXQucG9sbGluZy5zZXQoNjAsIHApO31cbiAgICAgICAgZWxzZSB7aW5wdXQucG9sbGluZ0Zhc3QgPSBmYWxzZTsgaW5wdXQuc2xvd1BvbGwoKTt9XG4gICAgICB9XG4gICAgICBpbnB1dC5wb2xsaW5nLnNldCgyMCwgcCk7XG4gICAgfSxcblxuICAgIC8vIFJlYWQgaW5wdXQgZnJvbSB0aGUgdGV4dGFyZWEsIGFuZCB1cGRhdGUgdGhlIGRvY3VtZW50IHRvIG1hdGNoLlxuICAgIC8vIFdoZW4gc29tZXRoaW5nIGlzIHNlbGVjdGVkLCBpdCBpcyBwcmVzZW50IGluIHRoZSB0ZXh0YXJlYSwgYW5kXG4gICAgLy8gc2VsZWN0ZWQgKHVubGVzcyBpdCBpcyBodWdlLCBpbiB3aGljaCBjYXNlIGEgcGxhY2Vob2xkZXIgaXNcbiAgICAvLyB1c2VkKS4gV2hlbiBub3RoaW5nIGlzIHNlbGVjdGVkLCB0aGUgY3Vyc29yIHNpdHMgYWZ0ZXIgcHJldmlvdXNseVxuICAgIC8vIHNlZW4gdGV4dCAoY2FuIGJlIGVtcHR5KSwgd2hpY2ggaXMgc3RvcmVkIGluIHByZXZJbnB1dCAod2UgbXVzdFxuICAgIC8vIG5vdCByZXNldCB0aGUgdGV4dGFyZWEgd2hlbiB0eXBpbmcsIGJlY2F1c2UgdGhhdCBicmVha3MgSU1FKS5cbiAgICBwb2xsOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjbSA9IHRoaXMuY20sIGlucHV0ID0gdGhpcy50ZXh0YXJlYSwgcHJldklucHV0ID0gdGhpcy5wcmV2SW5wdXQ7XG4gICAgICAvLyBTaW5jZSB0aGlzIGlzIGNhbGxlZCBhICpsb3QqLCB0cnkgdG8gYmFpbCBvdXQgYXMgY2hlYXBseSBhc1xuICAgICAgLy8gcG9zc2libGUgd2hlbiBpdCBpcyBjbGVhciB0aGF0IG5vdGhpbmcgaGFwcGVuZWQuIGhhc1NlbGVjdGlvblxuICAgICAgLy8gd2lsbCBiZSB0aGUgY2FzZSB3aGVuIHRoZXJlIGlzIGEgbG90IG9mIHRleHQgaW4gdGhlIHRleHRhcmVhLFxuICAgICAgLy8gaW4gd2hpY2ggY2FzZSByZWFkaW5nIGl0cyB2YWx1ZSB3b3VsZCBiZSBleHBlbnNpdmUuXG4gICAgICBpZiAodGhpcy5jb250ZXh0TWVudVBlbmRpbmcgfHwgIWNtLnN0YXRlLmZvY3VzZWQgfHxcbiAgICAgICAgICAoaGFzU2VsZWN0aW9uKGlucHV0KSAmJiAhcHJldklucHV0ICYmICF0aGlzLmNvbXBvc2luZykgfHxcbiAgICAgICAgICBpc1JlYWRPbmx5KGNtKSB8fCBjbS5vcHRpb25zLmRpc2FibGVJbnB1dCB8fCBjbS5zdGF0ZS5rZXlTZXEpXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgdmFyIHRleHQgPSBpbnB1dC52YWx1ZTtcbiAgICAgIC8vIElmIG5vdGhpbmcgY2hhbmdlZCwgYmFpbC5cbiAgICAgIGlmICh0ZXh0ID09IHByZXZJbnB1dCAmJiAhY20uc29tZXRoaW5nU2VsZWN0ZWQoKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgLy8gV29yayBhcm91bmQgbm9uc2Vuc2ljYWwgc2VsZWN0aW9uIHJlc2V0dGluZyBpbiBJRTkvMTAsIGFuZFxuICAgICAgLy8gaW5leHBsaWNhYmxlIGFwcGVhcmFuY2Ugb2YgcHJpdmF0ZSBhcmVhIHVuaWNvZGUgY2hhcmFjdGVycyBvblxuICAgICAgLy8gc29tZSBrZXkgY29tYm9zIGluIE1hYyAoIzI2ODkpLlxuICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPj0gOSAmJiB0aGlzLmhhc1NlbGVjdGlvbiA9PT0gdGV4dCB8fFxuICAgICAgICAgIG1hYyAmJiAvW1xcdWY3MDAtXFx1ZjdmZl0vLnRlc3QodGV4dCkpIHtcbiAgICAgICAgY20uZGlzcGxheS5pbnB1dC5yZXNldCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChjbS5kb2Muc2VsID09IGNtLmRpc3BsYXkuc2VsRm9yQ29udGV4dE1lbnUpIHtcbiAgICAgICAgdmFyIGZpcnN0ID0gdGV4dC5jaGFyQ29kZUF0KDApO1xuICAgICAgICBpZiAoZmlyc3QgPT0gMHgyMDBiICYmICFwcmV2SW5wdXQpIHByZXZJbnB1dCA9IFwiXFx1MjAwYlwiO1xuICAgICAgICBpZiAoZmlyc3QgPT0gMHgyMWRhKSB7IHRoaXMucmVzZXQoKTsgcmV0dXJuIHRoaXMuY20uZXhlY0NvbW1hbmQoXCJ1bmRvXCIpOyB9XG4gICAgICB9XG4gICAgICAvLyBGaW5kIHRoZSBwYXJ0IG9mIHRoZSBpbnB1dCB0aGF0IGlzIGFjdHVhbGx5IG5ld1xuICAgICAgdmFyIHNhbWUgPSAwLCBsID0gTWF0aC5taW4ocHJldklucHV0Lmxlbmd0aCwgdGV4dC5sZW5ndGgpO1xuICAgICAgd2hpbGUgKHNhbWUgPCBsICYmIHByZXZJbnB1dC5jaGFyQ29kZUF0KHNhbWUpID09IHRleHQuY2hhckNvZGVBdChzYW1lKSkgKytzYW1lO1xuXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgICAgYXBwbHlUZXh0SW5wdXQoY20sIHRleHQuc2xpY2Uoc2FtZSksIHByZXZJbnB1dC5sZW5ndGggLSBzYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICBudWxsLCBzZWxmLmNvbXBvc2luZyA/IFwiKmNvbXBvc2VcIiA6IG51bGwpO1xuXG4gICAgICAgIC8vIERvbid0IGxlYXZlIGxvbmcgdGV4dCBpbiB0aGUgdGV4dGFyZWEsIHNpbmNlIGl0IG1ha2VzIGZ1cnRoZXIgcG9sbGluZyBzbG93XG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDEwMDAgfHwgdGV4dC5pbmRleE9mKFwiXFxuXCIpID4gLTEpIGlucHV0LnZhbHVlID0gc2VsZi5wcmV2SW5wdXQgPSBcIlwiO1xuICAgICAgICBlbHNlIHNlbGYucHJldklucHV0ID0gdGV4dDtcblxuICAgICAgICBpZiAoc2VsZi5jb21wb3NpbmcpIHtcbiAgICAgICAgICBzZWxmLmNvbXBvc2luZy5yYW5nZS5jbGVhcigpO1xuICAgICAgICAgIHNlbGYuY29tcG9zaW5nLnJhbmdlID0gY20ubWFya1RleHQoc2VsZi5jb21wb3Npbmcuc3RhcnQsIGNtLmdldEN1cnNvcihcInRvXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NsYXNzTmFtZTogXCJDb2RlTWlycm9yLWNvbXBvc2luZ1wifSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcblxuICAgIGVuc3VyZVBvbGxlZDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5wb2xsaW5nRmFzdCAmJiB0aGlzLnBvbGwoKSkgdGhpcy5wb2xsaW5nRmFzdCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBvbktleVByZXNzOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uID49IDkpIHRoaXMuaGFzU2VsZWN0aW9uID0gbnVsbDtcbiAgICAgIHRoaXMuZmFzdFBvbGwoKTtcbiAgICB9LFxuXG4gICAgb25Db250ZXh0TWVudTogZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIGlucHV0ID0gdGhpcywgY20gPSBpbnB1dC5jbSwgZGlzcGxheSA9IGNtLmRpc3BsYXksIHRlID0gaW5wdXQudGV4dGFyZWE7XG4gICAgICB2YXIgcG9zID0gcG9zRnJvbU1vdXNlKGNtLCBlKSwgc2Nyb2xsUG9zID0gZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A7XG4gICAgICBpZiAoIXBvcyB8fCBwcmVzdG8pIHJldHVybjsgLy8gT3BlcmEgaXMgZGlmZmljdWx0LlxuXG4gICAgICAvLyBSZXNldCB0aGUgY3VycmVudCB0ZXh0IHNlbGVjdGlvbiBvbmx5IGlmIHRoZSBjbGljayBpcyBkb25lIG91dHNpZGUgb2YgdGhlIHNlbGVjdGlvblxuICAgICAgLy8gYW5kICdyZXNldFNlbGVjdGlvbk9uQ29udGV4dE1lbnUnIG9wdGlvbiBpcyB0cnVlLlxuICAgICAgdmFyIHJlc2V0ID0gY20ub3B0aW9ucy5yZXNldFNlbGVjdGlvbk9uQ29udGV4dE1lbnU7XG4gICAgICBpZiAocmVzZXQgJiYgY20uZG9jLnNlbC5jb250YWlucyhwb3MpID09IC0xKVxuICAgICAgICBvcGVyYXRpb24oY20sIHNldFNlbGVjdGlvbikoY20uZG9jLCBzaW1wbGVTZWxlY3Rpb24ocG9zKSwgc2VsX2RvbnRTY3JvbGwpO1xuXG4gICAgICB2YXIgb2xkQ1NTID0gdGUuc3R5bGUuY3NzVGV4dDtcbiAgICAgIGlucHV0LndyYXBwZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgICB0ZS5zdHlsZS5jc3NUZXh0ID0gXCJwb3NpdGlvbjogZml4ZWQ7IHdpZHRoOiAzMHB4OyBoZWlnaHQ6IDMwcHg7IHRvcDogXCIgKyAoZS5jbGllbnRZIC0gNSkgK1xuICAgICAgICBcInB4OyBsZWZ0OiBcIiArIChlLmNsaWVudFggLSA1KSArIFwicHg7IHotaW5kZXg6IDEwMDA7IGJhY2tncm91bmQ6IFwiICtcbiAgICAgICAgKGllID8gXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIC4wNSlcIiA6IFwidHJhbnNwYXJlbnRcIikgK1xuICAgICAgICBcIjsgb3V0bGluZTogbm9uZTsgYm9yZGVyLXdpZHRoOiAwOyBvdXRsaW5lOiBub25lOyBvdmVyZmxvdzogaGlkZGVuOyBvcGFjaXR5OiAuMDU7IGZpbHRlcjogYWxwaGEob3BhY2l0eT01KTtcIjtcbiAgICAgIGlmICh3ZWJraXQpIHZhciBvbGRTY3JvbGxZID0gd2luZG93LnNjcm9sbFk7IC8vIFdvcmsgYXJvdW5kIENocm9tZSBpc3N1ZSAoIzI3MTIpXG4gICAgICBkaXNwbGF5LmlucHV0LmZvY3VzKCk7XG4gICAgICBpZiAod2Via2l0KSB3aW5kb3cuc2Nyb2xsVG8obnVsbCwgb2xkU2Nyb2xsWSk7XG4gICAgICBkaXNwbGF5LmlucHV0LnJlc2V0KCk7XG4gICAgICAvLyBBZGRzIFwiU2VsZWN0IGFsbFwiIHRvIGNvbnRleHQgbWVudSBpbiBGRlxuICAgICAgaWYgKCFjbS5zb21ldGhpbmdTZWxlY3RlZCgpKSB0ZS52YWx1ZSA9IGlucHV0LnByZXZJbnB1dCA9IFwiIFwiO1xuICAgICAgaW5wdXQuY29udGV4dE1lbnVQZW5kaW5nID0gdHJ1ZTtcbiAgICAgIGRpc3BsYXkuc2VsRm9yQ29udGV4dE1lbnUgPSBjbS5kb2Muc2VsO1xuICAgICAgY2xlYXJUaW1lb3V0KGRpc3BsYXkuZGV0ZWN0aW5nU2VsZWN0QWxsKTtcblxuICAgICAgLy8gU2VsZWN0LWFsbCB3aWxsIGJlIGdyZXllZCBvdXQgaWYgdGhlcmUncyBub3RoaW5nIHRvIHNlbGVjdCwgc29cbiAgICAgIC8vIHRoaXMgYWRkcyBhIHplcm8td2lkdGggc3BhY2Ugc28gdGhhdCB3ZSBjYW4gbGF0ZXIgY2hlY2sgd2hldGhlclxuICAgICAgLy8gaXQgZ290IHNlbGVjdGVkLlxuICAgICAgZnVuY3Rpb24gcHJlcGFyZVNlbGVjdEFsbEhhY2soKSB7XG4gICAgICAgIGlmICh0ZS5zZWxlY3Rpb25TdGFydCAhPSBudWxsKSB7XG4gICAgICAgICAgdmFyIHNlbGVjdGVkID0gY20uc29tZXRoaW5nU2VsZWN0ZWQoKTtcbiAgICAgICAgICB2YXIgZXh0dmFsID0gXCJcXHUyMDBiXCIgKyAoc2VsZWN0ZWQgPyB0ZS52YWx1ZSA6IFwiXCIpO1xuICAgICAgICAgIHRlLnZhbHVlID0gXCJcXHUyMWRhXCI7IC8vIFVzZWQgdG8gY2F0Y2ggY29udGV4dC1tZW51IHVuZG9cbiAgICAgICAgICB0ZS52YWx1ZSA9IGV4dHZhbDtcbiAgICAgICAgICBpbnB1dC5wcmV2SW5wdXQgPSBzZWxlY3RlZCA/IFwiXCIgOiBcIlxcdTIwMGJcIjtcbiAgICAgICAgICB0ZS5zZWxlY3Rpb25TdGFydCA9IDE7IHRlLnNlbGVjdGlvbkVuZCA9IGV4dHZhbC5sZW5ndGg7XG4gICAgICAgICAgLy8gUmUtc2V0IHRoaXMsIGluIGNhc2Ugc29tZSBvdGhlciBoYW5kbGVyIHRvdWNoZWQgdGhlXG4gICAgICAgICAgLy8gc2VsZWN0aW9uIGluIHRoZSBtZWFudGltZS5cbiAgICAgICAgICBkaXNwbGF5LnNlbEZvckNvbnRleHRNZW51ID0gY20uZG9jLnNlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZnVuY3Rpb24gcmVoaWRlKCkge1xuICAgICAgICBpbnB1dC5jb250ZXh0TWVudVBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgaW5wdXQud3JhcHBlci5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcbiAgICAgICAgdGUuc3R5bGUuY3NzVGV4dCA9IG9sZENTUztcbiAgICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCA5KSBkaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsVG9wKGRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsVG9wID0gc2Nyb2xsUG9zKTtcblxuICAgICAgICAvLyBUcnkgdG8gZGV0ZWN0IHRoZSB1c2VyIGNob29zaW5nIHNlbGVjdC1hbGxcbiAgICAgICAgaWYgKHRlLnNlbGVjdGlvblN0YXJ0ICE9IG51bGwpIHtcbiAgICAgICAgICBpZiAoIWllIHx8IChpZSAmJiBpZV92ZXJzaW9uIDwgOSkpIHByZXBhcmVTZWxlY3RBbGxIYWNrKCk7XG4gICAgICAgICAgdmFyIGkgPSAwLCBwb2xsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoZGlzcGxheS5zZWxGb3JDb250ZXh0TWVudSA9PSBjbS5kb2Muc2VsICYmIHRlLnNlbGVjdGlvblN0YXJ0ID09IDAgJiZcbiAgICAgICAgICAgICAgICB0ZS5zZWxlY3Rpb25FbmQgPiAwICYmIGlucHV0LnByZXZJbnB1dCA9PSBcIlxcdTIwMGJcIilcbiAgICAgICAgICAgICAgb3BlcmF0aW9uKGNtLCBjb21tYW5kcy5zZWxlY3RBbGwpKGNtKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGkrKyA8IDEwKSBkaXNwbGF5LmRldGVjdGluZ1NlbGVjdEFsbCA9IHNldFRpbWVvdXQocG9sbCwgNTAwKTtcbiAgICAgICAgICAgIGVsc2UgZGlzcGxheS5pbnB1dC5yZXNldCgpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZGlzcGxheS5kZXRlY3RpbmdTZWxlY3RBbGwgPSBzZXRUaW1lb3V0KHBvbGwsIDIwMCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPj0gOSkgcHJlcGFyZVNlbGVjdEFsbEhhY2soKTtcbiAgICAgIGlmIChjYXB0dXJlUmlnaHRDbGljaykge1xuICAgICAgICBlX3N0b3AoZSk7XG4gICAgICAgIHZhciBtb3VzZXVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgb2ZmKHdpbmRvdywgXCJtb3VzZXVwXCIsIG1vdXNldXApO1xuICAgICAgICAgIHNldFRpbWVvdXQocmVoaWRlLCAyMCk7XG4gICAgICAgIH07XG4gICAgICAgIG9uKHdpbmRvdywgXCJtb3VzZXVwXCIsIG1vdXNldXApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0VGltZW91dChyZWhpZGUsIDUwKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVhZE9ubHlDaGFuZ2VkOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIGlmICghdmFsKSB0aGlzLnJlc2V0KCk7XG4gICAgfSxcblxuICAgIHNldFVuZWRpdGFibGU6IG5vdGhpbmcsXG5cbiAgICBuZWVkc0NvbnRlbnRBdHRyaWJ1dGU6IGZhbHNlXG4gIH0sIFRleHRhcmVhSW5wdXQucHJvdG90eXBlKTtcblxuICAvLyBDT05URU5URURJVEFCTEUgSU5QVVQgU1RZTEVcblxuICBmdW5jdGlvbiBDb250ZW50RWRpdGFibGVJbnB1dChjbSkge1xuICAgIHRoaXMuY20gPSBjbTtcbiAgICB0aGlzLmxhc3RBbmNob3JOb2RlID0gdGhpcy5sYXN0QW5jaG9yT2Zmc2V0ID0gdGhpcy5sYXN0Rm9jdXNOb2RlID0gdGhpcy5sYXN0Rm9jdXNPZmZzZXQgPSBudWxsO1xuICAgIHRoaXMucG9sbGluZyA9IG5ldyBEZWxheWVkKCk7XG4gICAgdGhpcy5ncmFjZVBlcmlvZCA9IGZhbHNlO1xuICB9XG5cbiAgQ29udGVudEVkaXRhYmxlSW5wdXQucHJvdG90eXBlID0gY29weU9iaih7XG4gICAgaW5pdDogZnVuY3Rpb24oZGlzcGxheSkge1xuICAgICAgdmFyIGlucHV0ID0gdGhpcywgY20gPSBpbnB1dC5jbTtcbiAgICAgIHZhciBkaXYgPSBpbnB1dC5kaXYgPSBkaXNwbGF5LmxpbmVEaXY7XG4gICAgICBkaXNhYmxlQnJvd3Nlck1hZ2ljKGRpdik7XG5cbiAgICAgIG9uKGRpdiwgXCJwYXN0ZVwiLCBmdW5jdGlvbihlKSB7IGhhbmRsZVBhc3RlKGUsIGNtKTsgfSlcblxuICAgICAgb24oZGl2LCBcImNvbXBvc2l0aW9uc3RhcnRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgZGF0YSA9IGUuZGF0YTtcbiAgICAgICAgaW5wdXQuY29tcG9zaW5nID0ge3NlbDogY20uZG9jLnNlbCwgZGF0YTogZGF0YSwgc3RhcnREYXRhOiBkYXRhfTtcbiAgICAgICAgaWYgKCFkYXRhKSByZXR1cm47XG4gICAgICAgIHZhciBwcmltID0gY20uZG9jLnNlbC5wcmltYXJ5KCk7XG4gICAgICAgIHZhciBsaW5lID0gY20uZ2V0TGluZShwcmltLmhlYWQubGluZSk7XG4gICAgICAgIHZhciBmb3VuZCA9IGxpbmUuaW5kZXhPZihkYXRhLCBNYXRoLm1heCgwLCBwcmltLmhlYWQuY2ggLSBkYXRhLmxlbmd0aCkpO1xuICAgICAgICBpZiAoZm91bmQgPiAtMSAmJiBmb3VuZCA8PSBwcmltLmhlYWQuY2gpXG4gICAgICAgICAgaW5wdXQuY29tcG9zaW5nLnNlbCA9IHNpbXBsZVNlbGVjdGlvbihQb3MocHJpbS5oZWFkLmxpbmUsIGZvdW5kKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBvcyhwcmltLmhlYWQubGluZSwgZm91bmQgKyBkYXRhLmxlbmd0aCkpO1xuICAgICAgfSk7XG4gICAgICBvbihkaXYsIFwiY29tcG9zaXRpb251cGRhdGVcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICBpbnB1dC5jb21wb3NpbmcuZGF0YSA9IGUuZGF0YTtcbiAgICAgIH0pO1xuICAgICAgb24oZGl2LCBcImNvbXBvc2l0aW9uZW5kXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIG91cnMgPSBpbnB1dC5jb21wb3Npbmc7XG4gICAgICAgIGlmICghb3VycykgcmV0dXJuO1xuICAgICAgICBpZiAoZS5kYXRhICE9IG91cnMuc3RhcnREYXRhICYmICEvXFx1MjAwYi8udGVzdChlLmRhdGEpKVxuICAgICAgICAgIG91cnMuZGF0YSA9IGUuZGF0YTtcbiAgICAgICAgLy8gTmVlZCBhIHNtYWxsIGRlbGF5IHRvIHByZXZlbnQgb3RoZXIgY29kZSAoaW5wdXQgZXZlbnQsXG4gICAgICAgIC8vIHNlbGVjdGlvbiBwb2xsaW5nKSBmcm9tIGRvaW5nIGRhbWFnZSB3aGVuIGZpcmVkIHJpZ2h0IGFmdGVyXG4gICAgICAgIC8vIGNvbXBvc2l0aW9uZW5kLlxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICghb3Vycy5oYW5kbGVkKVxuICAgICAgICAgICAgaW5wdXQuYXBwbHlDb21wb3NpdGlvbihvdXJzKTtcbiAgICAgICAgICBpZiAoaW5wdXQuY29tcG9zaW5nID09IG91cnMpXG4gICAgICAgICAgICBpbnB1dC5jb21wb3NpbmcgPSBudWxsO1xuICAgICAgICB9LCA1MCk7XG4gICAgICB9KTtcblxuICAgICAgb24oZGl2LCBcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlucHV0LmZvcmNlQ29tcG9zaXRpb25FbmQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBvbihkaXYsIFwiaW5wdXRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChpbnB1dC5jb21wb3NpbmcpIHJldHVybjtcbiAgICAgICAgaWYgKGlzUmVhZE9ubHkoY20pIHx8ICFpbnB1dC5wb2xsQ29udGVudCgpKVxuICAgICAgICAgIHJ1bkluT3AoaW5wdXQuY20sIGZ1bmN0aW9uKCkge3JlZ0NoYW5nZShjbSk7fSk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gb25Db3B5Q3V0KGUpIHtcbiAgICAgICAgaWYgKGNtLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcbiAgICAgICAgICBsYXN0Q29waWVkID0gY20uZ2V0U2VsZWN0aW9ucygpO1xuICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJjdXRcIikgY20ucmVwbGFjZVNlbGVjdGlvbihcIlwiLCBudWxsLCBcImN1dFwiKTtcbiAgICAgICAgfSBlbHNlIGlmICghY20ub3B0aW9ucy5saW5lV2lzZUNvcHlDdXQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHJhbmdlcyA9IGNvcHlhYmxlUmFuZ2VzKGNtKTtcbiAgICAgICAgICBsYXN0Q29waWVkID0gcmFuZ2VzLnRleHQ7XG4gICAgICAgICAgaWYgKGUudHlwZSA9PSBcImN1dFwiKSB7XG4gICAgICAgICAgICBjbS5vcGVyYXRpb24oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNtLnNldFNlbGVjdGlvbnMocmFuZ2VzLnJhbmdlcywgMCwgc2VsX2RvbnRTY3JvbGwpO1xuICAgICAgICAgICAgICBjbS5yZXBsYWNlU2VsZWN0aW9uKFwiXCIsIG51bGwsIFwiY3V0XCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGlPUyBleHBvc2VzIHRoZSBjbGlwYm9hcmQgQVBJLCBidXQgc2VlbXMgdG8gZGlzY2FyZCBjb250ZW50IGluc2VydGVkIGludG8gaXRcbiAgICAgICAgaWYgKGUuY2xpcGJvYXJkRGF0YSAmJiAhaW9zKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGUuY2xpcGJvYXJkRGF0YS5jbGVhckRhdGEoKTtcbiAgICAgICAgICBlLmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgbGFzdENvcGllZC5qb2luKFwiXFxuXCIpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPbGQtZmFzaGlvbmVkIGJyaWVmbHktZm9jdXMtYS10ZXh0YXJlYSBoYWNrXG4gICAgICAgICAgdmFyIGtsdWRnZSA9IGhpZGRlblRleHRhcmVhKCksIHRlID0ga2x1ZGdlLmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgY20uZGlzcGxheS5saW5lU3BhY2UuaW5zZXJ0QmVmb3JlKGtsdWRnZSwgY20uZGlzcGxheS5saW5lU3BhY2UuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgdGUudmFsdWUgPSBsYXN0Q29waWVkLmpvaW4oXCJcXG5cIik7XG4gICAgICAgICAgdmFyIGhhZEZvY3VzID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgICBzZWxlY3RJbnB1dCh0ZSk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNtLmRpc3BsYXkubGluZVNwYWNlLnJlbW92ZUNoaWxkKGtsdWRnZSk7XG4gICAgICAgICAgICBoYWRGb2N1cy5mb2N1cygpO1xuICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgb24oZGl2LCBcImNvcHlcIiwgb25Db3B5Q3V0KTtcbiAgICAgIG9uKGRpdiwgXCJjdXRcIiwgb25Db3B5Q3V0KTtcbiAgICB9LFxuXG4gICAgcHJlcGFyZVNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gcHJlcGFyZVNlbGVjdGlvbih0aGlzLmNtLCBmYWxzZSk7XG4gICAgICByZXN1bHQuZm9jdXMgPSB0aGlzLmNtLnN0YXRlLmZvY3VzZWQ7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbiAgICBzaG93U2VsZWN0aW9uOiBmdW5jdGlvbihpbmZvKSB7XG4gICAgICBpZiAoIWluZm8gfHwgIXRoaXMuY20uZGlzcGxheS52aWV3Lmxlbmd0aCkgcmV0dXJuO1xuICAgICAgaWYgKGluZm8uZm9jdXMpIHRoaXMuc2hvd1ByaW1hcnlTZWxlY3Rpb24oKTtcbiAgICAgIHRoaXMuc2hvd011bHRpcGxlU2VsZWN0aW9ucyhpbmZvKTtcbiAgICB9LFxuXG4gICAgc2hvd1ByaW1hcnlTZWxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKSwgcHJpbSA9IHRoaXMuY20uZG9jLnNlbC5wcmltYXJ5KCk7XG4gICAgICB2YXIgY3VyQW5jaG9yID0gZG9tVG9Qb3ModGhpcy5jbSwgc2VsLmFuY2hvck5vZGUsIHNlbC5hbmNob3JPZmZzZXQpO1xuICAgICAgdmFyIGN1ckZvY3VzID0gZG9tVG9Qb3ModGhpcy5jbSwgc2VsLmZvY3VzTm9kZSwgc2VsLmZvY3VzT2Zmc2V0KTtcbiAgICAgIGlmIChjdXJBbmNob3IgJiYgIWN1ckFuY2hvci5iYWQgJiYgY3VyRm9jdXMgJiYgIWN1ckZvY3VzLmJhZCAmJlxuICAgICAgICAgIGNtcChtaW5Qb3MoY3VyQW5jaG9yLCBjdXJGb2N1cyksIHByaW0uZnJvbSgpKSA9PSAwICYmXG4gICAgICAgICAgY21wKG1heFBvcyhjdXJBbmNob3IsIGN1ckZvY3VzKSwgcHJpbS50bygpKSA9PSAwKVxuICAgICAgICByZXR1cm47XG5cbiAgICAgIHZhciBzdGFydCA9IHBvc1RvRE9NKHRoaXMuY20sIHByaW0uZnJvbSgpKTtcbiAgICAgIHZhciBlbmQgPSBwb3NUb0RPTSh0aGlzLmNtLCBwcmltLnRvKCkpO1xuICAgICAgaWYgKCFzdGFydCAmJiAhZW5kKSByZXR1cm47XG5cbiAgICAgIHZhciB2aWV3ID0gdGhpcy5jbS5kaXNwbGF5LnZpZXc7XG4gICAgICB2YXIgb2xkID0gc2VsLnJhbmdlQ291bnQgJiYgc2VsLmdldFJhbmdlQXQoMCk7XG4gICAgICBpZiAoIXN0YXJ0KSB7XG4gICAgICAgIHN0YXJ0ID0ge25vZGU6IHZpZXdbMF0ubWVhc3VyZS5tYXBbMl0sIG9mZnNldDogMH07XG4gICAgICB9IGVsc2UgaWYgKCFlbmQpIHsgLy8gRklYTUUgZGFuZ2Vyb3VzbHkgaGFja3lcbiAgICAgICAgdmFyIG1lYXN1cmUgPSB2aWV3W3ZpZXcubGVuZ3RoIC0gMV0ubWVhc3VyZTtcbiAgICAgICAgdmFyIG1hcCA9IG1lYXN1cmUubWFwcyA/IG1lYXN1cmUubWFwc1ttZWFzdXJlLm1hcHMubGVuZ3RoIC0gMV0gOiBtZWFzdXJlLm1hcDtcbiAgICAgICAgZW5kID0ge25vZGU6IG1hcFttYXAubGVuZ3RoIC0gMV0sIG9mZnNldDogbWFwW21hcC5sZW5ndGggLSAyXSAtIG1hcFttYXAubGVuZ3RoIC0gM119O1xuICAgICAgfVxuXG4gICAgICB0cnkgeyB2YXIgcm5nID0gcmFuZ2Uoc3RhcnQubm9kZSwgc3RhcnQub2Zmc2V0LCBlbmQub2Zmc2V0LCBlbmQubm9kZSk7IH1cbiAgICAgIGNhdGNoKGUpIHt9IC8vIE91ciBtb2RlbCBvZiB0aGUgRE9NIG1pZ2h0IGJlIG91dGRhdGVkLCBpbiB3aGljaCBjYXNlIHRoZSByYW5nZSB3ZSB0cnkgdG8gc2V0IGNhbiBiZSBpbXBvc3NpYmxlXG4gICAgICBpZiAocm5nKSB7XG4gICAgICAgIHNlbC5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICAgICAgc2VsLmFkZFJhbmdlKHJuZyk7XG4gICAgICAgIGlmIChvbGQgJiYgc2VsLmFuY2hvck5vZGUgPT0gbnVsbCkgc2VsLmFkZFJhbmdlKG9sZCk7XG4gICAgICAgIGVsc2UgaWYgKGdlY2tvKSB0aGlzLnN0YXJ0R3JhY2VQZXJpb2QoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucmVtZW1iZXJTZWxlY3Rpb24oKTtcbiAgICB9LFxuXG4gICAgc3RhcnRHcmFjZVBlcmlvZDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaW5wdXQgPSB0aGlzO1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZ3JhY2VQZXJpb2QpO1xuICAgICAgdGhpcy5ncmFjZVBlcmlvZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlucHV0LmdyYWNlUGVyaW9kID0gZmFsc2U7XG4gICAgICAgIGlmIChpbnB1dC5zZWxlY3Rpb25DaGFuZ2VkKCkpXG4gICAgICAgICAgaW5wdXQuY20ub3BlcmF0aW9uKGZ1bmN0aW9uKCkgeyBpbnB1dC5jbS5jdXJPcC5zZWxlY3Rpb25DaGFuZ2VkID0gdHJ1ZTsgfSk7XG4gICAgICB9LCAyMCk7XG4gICAgfSxcblxuICAgIHNob3dNdWx0aXBsZVNlbGVjdGlvbnM6IGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgIHJlbW92ZUNoaWxkcmVuQW5kQWRkKHRoaXMuY20uZGlzcGxheS5jdXJzb3JEaXYsIGluZm8uY3Vyc29ycyk7XG4gICAgICByZW1vdmVDaGlsZHJlbkFuZEFkZCh0aGlzLmNtLmRpc3BsYXkuc2VsZWN0aW9uRGl2LCBpbmZvLnNlbGVjdGlvbik7XG4gICAgfSxcblxuICAgIHJlbWVtYmVyU2VsZWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICB0aGlzLmxhc3RBbmNob3JOb2RlID0gc2VsLmFuY2hvck5vZGU7IHRoaXMubGFzdEFuY2hvck9mZnNldCA9IHNlbC5hbmNob3JPZmZzZXQ7XG4gICAgICB0aGlzLmxhc3RGb2N1c05vZGUgPSBzZWwuZm9jdXNOb2RlOyB0aGlzLmxhc3RGb2N1c09mZnNldCA9IHNlbC5mb2N1c09mZnNldDtcbiAgICB9LFxuXG4gICAgc2VsZWN0aW9uSW5FZGl0b3I6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICAgIGlmICghc2VsLnJhbmdlQ291bnQpIHJldHVybiBmYWxzZTtcbiAgICAgIHZhciBub2RlID0gc2VsLmdldFJhbmdlQXQoMCkuY29tbW9uQW5jZXN0b3JDb250YWluZXI7XG4gICAgICByZXR1cm4gY29udGFpbnModGhpcy5kaXYsIG5vZGUpO1xuICAgIH0sXG5cbiAgICBmb2N1czogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5jbS5vcHRpb25zLnJlYWRPbmx5ICE9IFwibm9jdXJzb3JcIikgdGhpcy5kaXYuZm9jdXMoKTtcbiAgICB9LFxuICAgIGJsdXI6IGZ1bmN0aW9uKCkgeyB0aGlzLmRpdi5ibHVyKCk7IH0sXG4gICAgZ2V0RmllbGQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5kaXY7IH0sXG5cbiAgICBzdXBwb3J0c1RvdWNoOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0sXG5cbiAgICByZWNlaXZlZEZvY3VzOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBpbnB1dCA9IHRoaXM7XG4gICAgICBpZiAodGhpcy5zZWxlY3Rpb25JbkVkaXRvcigpKVxuICAgICAgICB0aGlzLnBvbGxTZWxlY3Rpb24oKTtcbiAgICAgIGVsc2VcbiAgICAgICAgcnVuSW5PcCh0aGlzLmNtLCBmdW5jdGlvbigpIHsgaW5wdXQuY20uY3VyT3Auc2VsZWN0aW9uQ2hhbmdlZCA9IHRydWU7IH0pO1xuXG4gICAgICBmdW5jdGlvbiBwb2xsKCkge1xuICAgICAgICBpZiAoaW5wdXQuY20uc3RhdGUuZm9jdXNlZCkge1xuICAgICAgICAgIGlucHV0LnBvbGxTZWxlY3Rpb24oKTtcbiAgICAgICAgICBpbnB1dC5wb2xsaW5nLnNldChpbnB1dC5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCwgcG9sbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMucG9sbGluZy5zZXQodGhpcy5jbS5vcHRpb25zLnBvbGxJbnRlcnZhbCwgcG9sbCk7XG4gICAgfSxcblxuICAgIHNlbGVjdGlvbkNoYW5nZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICAgIHJldHVybiBzZWwuYW5jaG9yTm9kZSAhPSB0aGlzLmxhc3RBbmNob3JOb2RlIHx8IHNlbC5hbmNob3JPZmZzZXQgIT0gdGhpcy5sYXN0QW5jaG9yT2Zmc2V0IHx8XG4gICAgICAgIHNlbC5mb2N1c05vZGUgIT0gdGhpcy5sYXN0Rm9jdXNOb2RlIHx8IHNlbC5mb2N1c09mZnNldCAhPSB0aGlzLmxhc3RGb2N1c09mZnNldDtcbiAgICB9LFxuXG4gICAgcG9sbFNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXRoaXMuY29tcG9zaW5nICYmICF0aGlzLmdyYWNlUGVyaW9kICYmIHRoaXMuc2VsZWN0aW9uQ2hhbmdlZCgpKSB7XG4gICAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCksIGNtID0gdGhpcy5jbTtcbiAgICAgICAgdGhpcy5yZW1lbWJlclNlbGVjdGlvbigpO1xuICAgICAgICB2YXIgYW5jaG9yID0gZG9tVG9Qb3MoY20sIHNlbC5hbmNob3JOb2RlLCBzZWwuYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgdmFyIGhlYWQgPSBkb21Ub1BvcyhjbSwgc2VsLmZvY3VzTm9kZSwgc2VsLmZvY3VzT2Zmc2V0KTtcbiAgICAgICAgaWYgKGFuY2hvciAmJiBoZWFkKSBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZXRTZWxlY3Rpb24oY20uZG9jLCBzaW1wbGVTZWxlY3Rpb24oYW5jaG9yLCBoZWFkKSwgc2VsX2RvbnRTY3JvbGwpO1xuICAgICAgICAgIGlmIChhbmNob3IuYmFkIHx8IGhlYWQuYmFkKSBjbS5jdXJPcC5zZWxlY3Rpb25DaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHBvbGxDb250ZW50OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjbSA9IHRoaXMuY20sIGRpc3BsYXkgPSBjbS5kaXNwbGF5LCBzZWwgPSBjbS5kb2Muc2VsLnByaW1hcnkoKTtcbiAgICAgIHZhciBmcm9tID0gc2VsLmZyb20oKSwgdG8gPSBzZWwudG8oKTtcbiAgICAgIGlmIChmcm9tLmxpbmUgPCBkaXNwbGF5LnZpZXdGcm9tIHx8IHRvLmxpbmUgPiBkaXNwbGF5LnZpZXdUbyAtIDEpIHJldHVybiBmYWxzZTtcblxuICAgICAgdmFyIGZyb21JbmRleDtcbiAgICAgIGlmIChmcm9tLmxpbmUgPT0gZGlzcGxheS52aWV3RnJvbSB8fCAoZnJvbUluZGV4ID0gZmluZFZpZXdJbmRleChjbSwgZnJvbS5saW5lKSkgPT0gMCkge1xuICAgICAgICB2YXIgZnJvbUxpbmUgPSBsaW5lTm8oZGlzcGxheS52aWV3WzBdLmxpbmUpO1xuICAgICAgICB2YXIgZnJvbU5vZGUgPSBkaXNwbGF5LnZpZXdbMF0ubm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBmcm9tTGluZSA9IGxpbmVObyhkaXNwbGF5LnZpZXdbZnJvbUluZGV4XS5saW5lKTtcbiAgICAgICAgdmFyIGZyb21Ob2RlID0gZGlzcGxheS52aWV3W2Zyb21JbmRleCAtIDFdLm5vZGUubmV4dFNpYmxpbmc7XG4gICAgICB9XG4gICAgICB2YXIgdG9JbmRleCA9IGZpbmRWaWV3SW5kZXgoY20sIHRvLmxpbmUpO1xuICAgICAgaWYgKHRvSW5kZXggPT0gZGlzcGxheS52aWV3Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgdmFyIHRvTGluZSA9IGRpc3BsYXkudmlld1RvIC0gMTtcbiAgICAgICAgdmFyIHRvTm9kZSA9IGRpc3BsYXkubGluZURpdi5sYXN0Q2hpbGQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdG9MaW5lID0gbGluZU5vKGRpc3BsYXkudmlld1t0b0luZGV4ICsgMV0ubGluZSkgLSAxO1xuICAgICAgICB2YXIgdG9Ob2RlID0gZGlzcGxheS52aWV3W3RvSW5kZXggKyAxXS5ub2RlLnByZXZpb3VzU2libGluZztcbiAgICAgIH1cblxuICAgICAgdmFyIG5ld1RleHQgPSBjbS5kb2Muc3BsaXRMaW5lcyhkb21UZXh0QmV0d2VlbihjbSwgZnJvbU5vZGUsIHRvTm9kZSwgZnJvbUxpbmUsIHRvTGluZSkpO1xuICAgICAgdmFyIG9sZFRleHQgPSBnZXRCZXR3ZWVuKGNtLmRvYywgUG9zKGZyb21MaW5lLCAwKSwgUG9zKHRvTGluZSwgZ2V0TGluZShjbS5kb2MsIHRvTGluZSkudGV4dC5sZW5ndGgpKTtcbiAgICAgIHdoaWxlIChuZXdUZXh0Lmxlbmd0aCA+IDEgJiYgb2xkVGV4dC5sZW5ndGggPiAxKSB7XG4gICAgICAgIGlmIChsc3QobmV3VGV4dCkgPT0gbHN0KG9sZFRleHQpKSB7IG5ld1RleHQucG9wKCk7IG9sZFRleHQucG9wKCk7IHRvTGluZS0tOyB9XG4gICAgICAgIGVsc2UgaWYgKG5ld1RleHRbMF0gPT0gb2xkVGV4dFswXSkgeyBuZXdUZXh0LnNoaWZ0KCk7IG9sZFRleHQuc2hpZnQoKTsgZnJvbUxpbmUrKzsgfVxuICAgICAgICBlbHNlIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICB2YXIgY3V0RnJvbnQgPSAwLCBjdXRFbmQgPSAwO1xuICAgICAgdmFyIG5ld1RvcCA9IG5ld1RleHRbMF0sIG9sZFRvcCA9IG9sZFRleHRbMF0sIG1heEN1dEZyb250ID0gTWF0aC5taW4obmV3VG9wLmxlbmd0aCwgb2xkVG9wLmxlbmd0aCk7XG4gICAgICB3aGlsZSAoY3V0RnJvbnQgPCBtYXhDdXRGcm9udCAmJiBuZXdUb3AuY2hhckNvZGVBdChjdXRGcm9udCkgPT0gb2xkVG9wLmNoYXJDb2RlQXQoY3V0RnJvbnQpKVxuICAgICAgICArK2N1dEZyb250O1xuICAgICAgdmFyIG5ld0JvdCA9IGxzdChuZXdUZXh0KSwgb2xkQm90ID0gbHN0KG9sZFRleHQpO1xuICAgICAgdmFyIG1heEN1dEVuZCA9IE1hdGgubWluKG5ld0JvdC5sZW5ndGggLSAobmV3VGV4dC5sZW5ndGggPT0gMSA/IGN1dEZyb250IDogMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkQm90Lmxlbmd0aCAtIChvbGRUZXh0Lmxlbmd0aCA9PSAxID8gY3V0RnJvbnQgOiAwKSk7XG4gICAgICB3aGlsZSAoY3V0RW5kIDwgbWF4Q3V0RW5kICYmXG4gICAgICAgICAgICAgbmV3Qm90LmNoYXJDb2RlQXQobmV3Qm90Lmxlbmd0aCAtIGN1dEVuZCAtIDEpID09IG9sZEJvdC5jaGFyQ29kZUF0KG9sZEJvdC5sZW5ndGggLSBjdXRFbmQgLSAxKSlcbiAgICAgICAgKytjdXRFbmQ7XG5cbiAgICAgIG5ld1RleHRbbmV3VGV4dC5sZW5ndGggLSAxXSA9IG5ld0JvdC5zbGljZSgwLCBuZXdCb3QubGVuZ3RoIC0gY3V0RW5kKTtcbiAgICAgIG5ld1RleHRbMF0gPSBuZXdUZXh0WzBdLnNsaWNlKGN1dEZyb250KTtcblxuICAgICAgdmFyIGNoRnJvbSA9IFBvcyhmcm9tTGluZSwgY3V0RnJvbnQpO1xuICAgICAgdmFyIGNoVG8gPSBQb3ModG9MaW5lLCBvbGRUZXh0Lmxlbmd0aCA/IGxzdChvbGRUZXh0KS5sZW5ndGggLSBjdXRFbmQgOiAwKTtcbiAgICAgIGlmIChuZXdUZXh0Lmxlbmd0aCA+IDEgfHwgbmV3VGV4dFswXSB8fCBjbXAoY2hGcm9tLCBjaFRvKSkge1xuICAgICAgICByZXBsYWNlUmFuZ2UoY20uZG9jLCBuZXdUZXh0LCBjaEZyb20sIGNoVG8sIFwiK2lucHV0XCIpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZW5zdXJlUG9sbGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuZm9yY2VDb21wb3NpdGlvbkVuZCgpO1xuICAgIH0sXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5mb3JjZUNvbXBvc2l0aW9uRW5kKCk7XG4gICAgfSxcbiAgICBmb3JjZUNvbXBvc2l0aW9uRW5kOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdGhpcy5jb21wb3NpbmcgfHwgdGhpcy5jb21wb3NpbmcuaGFuZGxlZCkgcmV0dXJuO1xuICAgICAgdGhpcy5hcHBseUNvbXBvc2l0aW9uKHRoaXMuY29tcG9zaW5nKTtcbiAgICAgIHRoaXMuY29tcG9zaW5nLmhhbmRsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5kaXYuYmx1cigpO1xuICAgICAgdGhpcy5kaXYuZm9jdXMoKTtcbiAgICB9LFxuICAgIGFwcGx5Q29tcG9zaXRpb246IGZ1bmN0aW9uKGNvbXBvc2luZykge1xuICAgICAgaWYgKGlzUmVhZE9ubHkodGhpcy5jbSkpXG4gICAgICAgIG9wZXJhdGlvbih0aGlzLmNtLCByZWdDaGFuZ2UpKHRoaXMuY20pXG4gICAgICBlbHNlIGlmIChjb21wb3NpbmcuZGF0YSAmJiBjb21wb3NpbmcuZGF0YSAhPSBjb21wb3Npbmcuc3RhcnREYXRhKVxuICAgICAgICBvcGVyYXRpb24odGhpcy5jbSwgYXBwbHlUZXh0SW5wdXQpKHRoaXMuY20sIGNvbXBvc2luZy5kYXRhLCAwLCBjb21wb3Npbmcuc2VsKTtcbiAgICB9LFxuXG4gICAgc2V0VW5lZGl0YWJsZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgbm9kZS5jb250ZW50RWRpdGFibGUgPSBcImZhbHNlXCJcbiAgICB9LFxuXG4gICAgb25LZXlQcmVzczogZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKCFpc1JlYWRPbmx5KHRoaXMuY20pKVxuICAgICAgICBvcGVyYXRpb24odGhpcy5jbSwgYXBwbHlUZXh0SW5wdXQpKHRoaXMuY20sIFN0cmluZy5mcm9tQ2hhckNvZGUoZS5jaGFyQ29kZSA9PSBudWxsID8gZS5rZXlDb2RlIDogZS5jaGFyQ29kZSksIDApO1xuICAgIH0sXG5cbiAgICByZWFkT25seUNoYW5nZWQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgdGhpcy5kaXYuY29udGVudEVkaXRhYmxlID0gU3RyaW5nKHZhbCAhPSBcIm5vY3Vyc29yXCIpXG4gICAgfSxcblxuICAgIG9uQ29udGV4dE1lbnU6IG5vdGhpbmcsXG4gICAgcmVzZXRQb3NpdGlvbjogbm90aGluZyxcblxuICAgIG5lZWRzQ29udGVudEF0dHJpYnV0ZTogdHJ1ZVxuICB9LCBDb250ZW50RWRpdGFibGVJbnB1dC5wcm90b3R5cGUpO1xuXG4gIGZ1bmN0aW9uIHBvc1RvRE9NKGNtLCBwb3MpIHtcbiAgICB2YXIgdmlldyA9IGZpbmRWaWV3Rm9yTGluZShjbSwgcG9zLmxpbmUpO1xuICAgIGlmICghdmlldyB8fCB2aWV3LmhpZGRlbikgcmV0dXJuIG51bGw7XG4gICAgdmFyIGxpbmUgPSBnZXRMaW5lKGNtLmRvYywgcG9zLmxpbmUpO1xuICAgIHZhciBpbmZvID0gbWFwRnJvbUxpbmVWaWV3KHZpZXcsIGxpbmUsIHBvcy5saW5lKTtcblxuICAgIHZhciBvcmRlciA9IGdldE9yZGVyKGxpbmUpLCBzaWRlID0gXCJsZWZ0XCI7XG4gICAgaWYgKG9yZGVyKSB7XG4gICAgICB2YXIgcGFydFBvcyA9IGdldEJpZGlQYXJ0QXQob3JkZXIsIHBvcy5jaCk7XG4gICAgICBzaWRlID0gcGFydFBvcyAlIDIgPyBcInJpZ2h0XCIgOiBcImxlZnRcIjtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IG5vZGVBbmRPZmZzZXRJbkxpbmVNYXAoaW5mby5tYXAsIHBvcy5jaCwgc2lkZSk7XG4gICAgcmVzdWx0Lm9mZnNldCA9IHJlc3VsdC5jb2xsYXBzZSA9PSBcInJpZ2h0XCIgPyByZXN1bHQuZW5kIDogcmVzdWx0LnN0YXJ0O1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBmdW5jdGlvbiBiYWRQb3MocG9zLCBiYWQpIHsgaWYgKGJhZCkgcG9zLmJhZCA9IHRydWU7IHJldHVybiBwb3M7IH1cblxuICBmdW5jdGlvbiBkb21Ub1BvcyhjbSwgbm9kZSwgb2Zmc2V0KSB7XG4gICAgdmFyIGxpbmVOb2RlO1xuICAgIGlmIChub2RlID09IGNtLmRpc3BsYXkubGluZURpdikge1xuICAgICAgbGluZU5vZGUgPSBjbS5kaXNwbGF5LmxpbmVEaXYuY2hpbGROb2Rlc1tvZmZzZXRdO1xuICAgICAgaWYgKCFsaW5lTm9kZSkgcmV0dXJuIGJhZFBvcyhjbS5jbGlwUG9zKFBvcyhjbS5kaXNwbGF5LnZpZXdUbyAtIDEpKSwgdHJ1ZSk7XG4gICAgICBub2RlID0gbnVsbDsgb2Zmc2V0ID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsaW5lTm9kZSA9IG5vZGU7OyBsaW5lTm9kZSA9IGxpbmVOb2RlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgaWYgKCFsaW5lTm9kZSB8fCBsaW5lTm9kZSA9PSBjbS5kaXNwbGF5LmxpbmVEaXYpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAobGluZU5vZGUucGFyZW50Tm9kZSAmJiBsaW5lTm9kZS5wYXJlbnROb2RlID09IGNtLmRpc3BsYXkubGluZURpdikgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY20uZGlzcGxheS52aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbGluZVZpZXcgPSBjbS5kaXNwbGF5LnZpZXdbaV07XG4gICAgICBpZiAobGluZVZpZXcubm9kZSA9PSBsaW5lTm9kZSlcbiAgICAgICAgcmV0dXJuIGxvY2F0ZU5vZGVJbkxpbmVWaWV3KGxpbmVWaWV3LCBub2RlLCBvZmZzZXQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvY2F0ZU5vZGVJbkxpbmVWaWV3KGxpbmVWaWV3LCBub2RlLCBvZmZzZXQpIHtcbiAgICB2YXIgd3JhcHBlciA9IGxpbmVWaWV3LnRleHQuZmlyc3RDaGlsZCwgYmFkID0gZmFsc2U7XG4gICAgaWYgKCFub2RlIHx8ICFjb250YWlucyh3cmFwcGVyLCBub2RlKSkgcmV0dXJuIGJhZFBvcyhQb3MobGluZU5vKGxpbmVWaWV3LmxpbmUpLCAwKSwgdHJ1ZSk7XG4gICAgaWYgKG5vZGUgPT0gd3JhcHBlcikge1xuICAgICAgYmFkID0gdHJ1ZTtcbiAgICAgIG5vZGUgPSB3cmFwcGVyLmNoaWxkTm9kZXNbb2Zmc2V0XTtcbiAgICAgIG9mZnNldCA9IDA7XG4gICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgdmFyIGxpbmUgPSBsaW5lVmlldy5yZXN0ID8gbHN0KGxpbmVWaWV3LnJlc3QpIDogbGluZVZpZXcubGluZTtcbiAgICAgICAgcmV0dXJuIGJhZFBvcyhQb3MobGluZU5vKGxpbmUpLCBsaW5lLnRleHQubGVuZ3RoKSwgYmFkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdGV4dE5vZGUgPSBub2RlLm5vZGVUeXBlID09IDMgPyBub2RlIDogbnVsbCwgdG9wTm9kZSA9IG5vZGU7XG4gICAgaWYgKCF0ZXh0Tm9kZSAmJiBub2RlLmNoaWxkTm9kZXMubGVuZ3RoID09IDEgJiYgbm9kZS5maXJzdENoaWxkLm5vZGVUeXBlID09IDMpIHtcbiAgICAgIHRleHROb2RlID0gbm9kZS5maXJzdENoaWxkO1xuICAgICAgaWYgKG9mZnNldCkgb2Zmc2V0ID0gdGV4dE5vZGUubm9kZVZhbHVlLmxlbmd0aDtcbiAgICB9XG4gICAgd2hpbGUgKHRvcE5vZGUucGFyZW50Tm9kZSAhPSB3cmFwcGVyKSB0b3BOb2RlID0gdG9wTm9kZS5wYXJlbnROb2RlO1xuICAgIHZhciBtZWFzdXJlID0gbGluZVZpZXcubWVhc3VyZSwgbWFwcyA9IG1lYXN1cmUubWFwcztcblxuICAgIGZ1bmN0aW9uIGZpbmQodGV4dE5vZGUsIHRvcE5vZGUsIG9mZnNldCkge1xuICAgICAgZm9yICh2YXIgaSA9IC0xOyBpIDwgKG1hcHMgPyBtYXBzLmxlbmd0aCA6IDApOyBpKyspIHtcbiAgICAgICAgdmFyIG1hcCA9IGkgPCAwID8gbWVhc3VyZS5tYXAgOiBtYXBzW2ldO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hcC5sZW5ndGg7IGogKz0gMykge1xuICAgICAgICAgIHZhciBjdXJOb2RlID0gbWFwW2ogKyAyXTtcbiAgICAgICAgICBpZiAoY3VyTm9kZSA9PSB0ZXh0Tm9kZSB8fCBjdXJOb2RlID09IHRvcE5vZGUpIHtcbiAgICAgICAgICAgIHZhciBsaW5lID0gbGluZU5vKGkgPCAwID8gbGluZVZpZXcubGluZSA6IGxpbmVWaWV3LnJlc3RbaV0pO1xuICAgICAgICAgICAgdmFyIGNoID0gbWFwW2pdICsgb2Zmc2V0O1xuICAgICAgICAgICAgaWYgKG9mZnNldCA8IDAgfHwgY3VyTm9kZSAhPSB0ZXh0Tm9kZSkgY2ggPSBtYXBbaiArIChvZmZzZXQgPyAxIDogMCldO1xuICAgICAgICAgICAgcmV0dXJuIFBvcyhsaW5lLCBjaCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBmb3VuZCA9IGZpbmQodGV4dE5vZGUsIHRvcE5vZGUsIG9mZnNldCk7XG4gICAgaWYgKGZvdW5kKSByZXR1cm4gYmFkUG9zKGZvdW5kLCBiYWQpO1xuXG4gICAgLy8gRklYTUUgdGhpcyBpcyBhbGwgcmVhbGx5IHNoYWt5LiBtaWdodCBoYW5kbGUgdGhlIGZldyBjYXNlcyBpdCBuZWVkcyB0byBoYW5kbGUsIGJ1dCBsaWtlbHkgdG8gY2F1c2UgcHJvYmxlbXNcbiAgICBmb3IgKHZhciBhZnRlciA9IHRvcE5vZGUubmV4dFNpYmxpbmcsIGRpc3QgPSB0ZXh0Tm9kZSA/IHRleHROb2RlLm5vZGVWYWx1ZS5sZW5ndGggLSBvZmZzZXQgOiAwOyBhZnRlcjsgYWZ0ZXIgPSBhZnRlci5uZXh0U2libGluZykge1xuICAgICAgZm91bmQgPSBmaW5kKGFmdGVyLCBhZnRlci5maXJzdENoaWxkLCAwKTtcbiAgICAgIGlmIChmb3VuZClcbiAgICAgICAgcmV0dXJuIGJhZFBvcyhQb3MoZm91bmQubGluZSwgZm91bmQuY2ggLSBkaXN0KSwgYmFkKTtcbiAgICAgIGVsc2VcbiAgICAgICAgZGlzdCArPSBhZnRlci50ZXh0Q29udGVudC5sZW5ndGg7XG4gICAgfVxuICAgIGZvciAodmFyIGJlZm9yZSA9IHRvcE5vZGUucHJldmlvdXNTaWJsaW5nLCBkaXN0ID0gb2Zmc2V0OyBiZWZvcmU7IGJlZm9yZSA9IGJlZm9yZS5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgIGZvdW5kID0gZmluZChiZWZvcmUsIGJlZm9yZS5maXJzdENoaWxkLCAtMSk7XG4gICAgICBpZiAoZm91bmQpXG4gICAgICAgIHJldHVybiBiYWRQb3MoUG9zKGZvdW5kLmxpbmUsIGZvdW5kLmNoICsgZGlzdCksIGJhZCk7XG4gICAgICBlbHNlXG4gICAgICAgIGRpc3QgKz0gYWZ0ZXIudGV4dENvbnRlbnQubGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGRvbVRleHRCZXR3ZWVuKGNtLCBmcm9tLCB0bywgZnJvbUxpbmUsIHRvTGluZSkge1xuICAgIHZhciB0ZXh0ID0gXCJcIiwgY2xvc2luZyA9IGZhbHNlLCBsaW5lU2VwID0gY20uZG9jLmxpbmVTZXBhcmF0b3IoKTtcbiAgICBmdW5jdGlvbiByZWNvZ25pemVNYXJrZXIoaWQpIHsgcmV0dXJuIGZ1bmN0aW9uKG1hcmtlcikgeyByZXR1cm4gbWFya2VyLmlkID09IGlkOyB9OyB9XG4gICAgZnVuY3Rpb24gd2Fsayhub2RlKSB7XG4gICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxKSB7XG4gICAgICAgIHZhciBjbVRleHQgPSBub2RlLmdldEF0dHJpYnV0ZShcImNtLXRleHRcIik7XG4gICAgICAgIGlmIChjbVRleHQgIT0gbnVsbCkge1xuICAgICAgICAgIGlmIChjbVRleHQgPT0gXCJcIikgY21UZXh0ID0gbm9kZS50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHUyMDBiL2csIFwiXCIpO1xuICAgICAgICAgIHRleHQgKz0gY21UZXh0O1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWFya2VySUQgPSBub2RlLmdldEF0dHJpYnV0ZShcImNtLW1hcmtlclwiKSwgcmFuZ2U7XG4gICAgICAgIGlmIChtYXJrZXJJRCkge1xuICAgICAgICAgIHZhciBmb3VuZCA9IGNtLmZpbmRNYXJrcyhQb3MoZnJvbUxpbmUsIDApLCBQb3ModG9MaW5lICsgMSwgMCksIHJlY29nbml6ZU1hcmtlcigrbWFya2VySUQpKTtcbiAgICAgICAgICBpZiAoZm91bmQubGVuZ3RoICYmIChyYW5nZSA9IGZvdW5kWzBdLmZpbmQoKSkpXG4gICAgICAgICAgICB0ZXh0ICs9IGdldEJldHdlZW4oY20uZG9jLCByYW5nZS5mcm9tLCByYW5nZS50bykuam9pbihsaW5lU2VwKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKFwiY29udGVudGVkaXRhYmxlXCIpID09IFwiZmFsc2VcIikgcmV0dXJuO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICB3YWxrKG5vZGUuY2hpbGROb2Rlc1tpXSk7XG4gICAgICAgIGlmICgvXihwcmV8ZGl2fHApJC9pLnRlc3Qobm9kZS5ub2RlTmFtZSkpXG4gICAgICAgICAgY2xvc2luZyA9IHRydWU7XG4gICAgICB9IGVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT0gMykge1xuICAgICAgICB2YXIgdmFsID0gbm9kZS5ub2RlVmFsdWU7XG4gICAgICAgIGlmICghdmFsKSByZXR1cm47XG4gICAgICAgIGlmIChjbG9zaW5nKSB7XG4gICAgICAgICAgdGV4dCArPSBsaW5lU2VwO1xuICAgICAgICAgIGNsb3NpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0ZXh0ICs9IHZhbDtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICg7Oykge1xuICAgICAgd2Fsayhmcm9tKTtcbiAgICAgIGlmIChmcm9tID09IHRvKSBicmVhaztcbiAgICAgIGZyb20gPSBmcm9tLm5leHRTaWJsaW5nO1xuICAgIH1cbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuXG4gIENvZGVNaXJyb3IuaW5wdXRTdHlsZXMgPSB7XCJ0ZXh0YXJlYVwiOiBUZXh0YXJlYUlucHV0LCBcImNvbnRlbnRlZGl0YWJsZVwiOiBDb250ZW50RWRpdGFibGVJbnB1dH07XG5cbiAgLy8gU0VMRUNUSU9OIC8gQ1VSU09SXG5cbiAgLy8gU2VsZWN0aW9uIG9iamVjdHMgYXJlIGltbXV0YWJsZS4gQSBuZXcgb25lIGlzIGNyZWF0ZWQgZXZlcnkgdGltZVxuICAvLyB0aGUgc2VsZWN0aW9uIGNoYW5nZXMuIEEgc2VsZWN0aW9uIGlzIG9uZSBvciBtb3JlIG5vbi1vdmVybGFwcGluZ1xuICAvLyAoYW5kIG5vbi10b3VjaGluZykgcmFuZ2VzLCBzb3J0ZWQsIGFuZCBhbiBpbnRlZ2VyIHRoYXQgaW5kaWNhdGVzXG4gIC8vIHdoaWNoIG9uZSBpcyB0aGUgcHJpbWFyeSBzZWxlY3Rpb24gKHRoZSBvbmUgdGhhdCdzIHNjcm9sbGVkIGludG9cbiAgLy8gdmlldywgdGhhdCBnZXRDdXJzb3IgcmV0dXJucywgZXRjKS5cbiAgZnVuY3Rpb24gU2VsZWN0aW9uKHJhbmdlcywgcHJpbUluZGV4KSB7XG4gICAgdGhpcy5yYW5nZXMgPSByYW5nZXM7XG4gICAgdGhpcy5wcmltSW5kZXggPSBwcmltSW5kZXg7XG4gIH1cblxuICBTZWxlY3Rpb24ucHJvdG90eXBlID0ge1xuICAgIHByaW1hcnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5yYW5nZXNbdGhpcy5wcmltSW5kZXhdOyB9LFxuICAgIGVxdWFsczogZnVuY3Rpb24ob3RoZXIpIHtcbiAgICAgIGlmIChvdGhlciA9PSB0aGlzKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGlmIChvdGhlci5wcmltSW5kZXggIT0gdGhpcy5wcmltSW5kZXggfHwgb3RoZXIucmFuZ2VzLmxlbmd0aCAhPSB0aGlzLnJhbmdlcy5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGhlcmUgPSB0aGlzLnJhbmdlc1tpXSwgdGhlcmUgPSBvdGhlci5yYW5nZXNbaV07XG4gICAgICAgIGlmIChjbXAoaGVyZS5hbmNob3IsIHRoZXJlLmFuY2hvcikgIT0gMCB8fCBjbXAoaGVyZS5oZWFkLCB0aGVyZS5oZWFkKSAhPSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGRlZXBDb3B5OiBmdW5jdGlvbigpIHtcbiAgICAgIGZvciAodmFyIG91dCA9IFtdLCBpID0gMDsgaSA8IHRoaXMucmFuZ2VzLmxlbmd0aDsgaSsrKVxuICAgICAgICBvdXRbaV0gPSBuZXcgUmFuZ2UoY29weVBvcyh0aGlzLnJhbmdlc1tpXS5hbmNob3IpLCBjb3B5UG9zKHRoaXMucmFuZ2VzW2ldLmhlYWQpKTtcbiAgICAgIHJldHVybiBuZXcgU2VsZWN0aW9uKG91dCwgdGhpcy5wcmltSW5kZXgpO1xuICAgIH0sXG4gICAgc29tZXRoaW5nU2VsZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnJhbmdlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgaWYgKCF0aGlzLnJhbmdlc1tpXS5lbXB0eSgpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuICAgIGNvbnRhaW5zOiBmdW5jdGlvbihwb3MsIGVuZCkge1xuICAgICAgaWYgKCFlbmQpIGVuZCA9IHBvcztcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5yYW5nZXNbaV07XG4gICAgICAgIGlmIChjbXAoZW5kLCByYW5nZS5mcm9tKCkpID49IDAgJiYgY21wKHBvcywgcmFuZ2UudG8oKSkgPD0gMClcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gUmFuZ2UoYW5jaG9yLCBoZWFkKSB7XG4gICAgdGhpcy5hbmNob3IgPSBhbmNob3I7IHRoaXMuaGVhZCA9IGhlYWQ7XG4gIH1cblxuICBSYW5nZS5wcm90b3R5cGUgPSB7XG4gICAgZnJvbTogZnVuY3Rpb24oKSB7IHJldHVybiBtaW5Qb3ModGhpcy5hbmNob3IsIHRoaXMuaGVhZCk7IH0sXG4gICAgdG86IGZ1bmN0aW9uKCkgeyByZXR1cm4gbWF4UG9zKHRoaXMuYW5jaG9yLCB0aGlzLmhlYWQpOyB9LFxuICAgIGVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmhlYWQubGluZSA9PSB0aGlzLmFuY2hvci5saW5lICYmIHRoaXMuaGVhZC5jaCA9PSB0aGlzLmFuY2hvci5jaDtcbiAgICB9XG4gIH07XG5cbiAgLy8gVGFrZSBhbiB1bnNvcnRlZCwgcG90ZW50aWFsbHkgb3ZlcmxhcHBpbmcgc2V0IG9mIHJhbmdlcywgYW5kXG4gIC8vIGJ1aWxkIGEgc2VsZWN0aW9uIG91dCBvZiBpdC4gJ0NvbnN1bWVzJyByYW5nZXMgYXJyYXkgKG1vZGlmeWluZ1xuICAvLyBpdCkuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMsIHByaW1JbmRleCkge1xuICAgIHZhciBwcmltID0gcmFuZ2VzW3ByaW1JbmRleF07XG4gICAgcmFuZ2VzLnNvcnQoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gY21wKGEuZnJvbSgpLCBiLmZyb20oKSk7IH0pO1xuICAgIHByaW1JbmRleCA9IGluZGV4T2YocmFuZ2VzLCBwcmltKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGN1ciA9IHJhbmdlc1tpXSwgcHJldiA9IHJhbmdlc1tpIC0gMV07XG4gICAgICBpZiAoY21wKHByZXYudG8oKSwgY3VyLmZyb20oKSkgPj0gMCkge1xuICAgICAgICB2YXIgZnJvbSA9IG1pblBvcyhwcmV2LmZyb20oKSwgY3VyLmZyb20oKSksIHRvID0gbWF4UG9zKHByZXYudG8oKSwgY3VyLnRvKCkpO1xuICAgICAgICB2YXIgaW52ID0gcHJldi5lbXB0eSgpID8gY3VyLmZyb20oKSA9PSBjdXIuaGVhZCA6IHByZXYuZnJvbSgpID09IHByZXYuaGVhZDtcbiAgICAgICAgaWYgKGkgPD0gcHJpbUluZGV4KSAtLXByaW1JbmRleDtcbiAgICAgICAgcmFuZ2VzLnNwbGljZSgtLWksIDIsIG5ldyBSYW5nZShpbnYgPyB0byA6IGZyb20sIGludiA/IGZyb20gOiB0bykpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFNlbGVjdGlvbihyYW5nZXMsIHByaW1JbmRleCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaW1wbGVTZWxlY3Rpb24oYW5jaG9yLCBoZWFkKSB7XG4gICAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oW25ldyBSYW5nZShhbmNob3IsIGhlYWQgfHwgYW5jaG9yKV0sIDApO1xuICB9XG5cbiAgLy8gTW9zdCBvZiB0aGUgZXh0ZXJuYWwgQVBJIGNsaXBzIGdpdmVuIHBvc2l0aW9ucyB0byBtYWtlIHN1cmUgdGhleVxuICAvLyBhY3R1YWxseSBleGlzdCB3aXRoaW4gdGhlIGRvY3VtZW50LlxuICBmdW5jdGlvbiBjbGlwTGluZShkb2MsIG4pIHtyZXR1cm4gTWF0aC5tYXgoZG9jLmZpcnN0LCBNYXRoLm1pbihuLCBkb2MuZmlyc3QgKyBkb2Muc2l6ZSAtIDEpKTt9XG4gIGZ1bmN0aW9uIGNsaXBQb3MoZG9jLCBwb3MpIHtcbiAgICBpZiAocG9zLmxpbmUgPCBkb2MuZmlyc3QpIHJldHVybiBQb3MoZG9jLmZpcnN0LCAwKTtcbiAgICB2YXIgbGFzdCA9IGRvYy5maXJzdCArIGRvYy5zaXplIC0gMTtcbiAgICBpZiAocG9zLmxpbmUgPiBsYXN0KSByZXR1cm4gUG9zKGxhc3QsIGdldExpbmUoZG9jLCBsYXN0KS50ZXh0Lmxlbmd0aCk7XG4gICAgcmV0dXJuIGNsaXBUb0xlbihwb3MsIGdldExpbmUoZG9jLCBwb3MubGluZSkudGV4dC5sZW5ndGgpO1xuICB9XG4gIGZ1bmN0aW9uIGNsaXBUb0xlbihwb3MsIGxpbmVsZW4pIHtcbiAgICB2YXIgY2ggPSBwb3MuY2g7XG4gICAgaWYgKGNoID09IG51bGwgfHwgY2ggPiBsaW5lbGVuKSByZXR1cm4gUG9zKHBvcy5saW5lLCBsaW5lbGVuKTtcbiAgICBlbHNlIGlmIChjaCA8IDApIHJldHVybiBQb3MocG9zLmxpbmUsIDApO1xuICAgIGVsc2UgcmV0dXJuIHBvcztcbiAgfVxuICBmdW5jdGlvbiBpc0xpbmUoZG9jLCBsKSB7cmV0dXJuIGwgPj0gZG9jLmZpcnN0ICYmIGwgPCBkb2MuZmlyc3QgKyBkb2Muc2l6ZTt9XG4gIGZ1bmN0aW9uIGNsaXBQb3NBcnJheShkb2MsIGFycmF5KSB7XG4gICAgZm9yICh2YXIgb3V0ID0gW10sIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIG91dFtpXSA9IGNsaXBQb3MoZG9jLCBhcnJheVtpXSk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIC8vIFNFTEVDVElPTiBVUERBVEVTXG5cbiAgLy8gVGhlICdzY3JvbGwnIHBhcmFtZXRlciBnaXZlbiB0byBtYW55IG9mIHRoZXNlIGluZGljYXRlZCB3aGV0aGVyXG4gIC8vIHRoZSBuZXcgY3Vyc29yIHBvc2l0aW9uIHNob3VsZCBiZSBzY3JvbGxlZCBpbnRvIHZpZXcgYWZ0ZXJcbiAgLy8gbW9kaWZ5aW5nIHRoZSBzZWxlY3Rpb24uXG5cbiAgLy8gSWYgc2hpZnQgaXMgaGVsZCBvciB0aGUgZXh0ZW5kIGZsYWcgaXMgc2V0LCBleHRlbmRzIGEgcmFuZ2UgdG9cbiAgLy8gaW5jbHVkZSBhIGdpdmVuIHBvc2l0aW9uIChhbmQgb3B0aW9uYWxseSBhIHNlY29uZCBwb3NpdGlvbikuXG4gIC8vIE90aGVyd2lzZSwgc2ltcGx5IHJldHVybnMgdGhlIHJhbmdlIGJldHdlZW4gdGhlIGdpdmVuIHBvc2l0aW9ucy5cbiAgLy8gVXNlZCBmb3IgY3Vyc29yIG1vdGlvbiBhbmQgc3VjaC5cbiAgZnVuY3Rpb24gZXh0ZW5kUmFuZ2UoZG9jLCByYW5nZSwgaGVhZCwgb3RoZXIpIHtcbiAgICBpZiAoZG9jLmNtICYmIGRvYy5jbS5kaXNwbGF5LnNoaWZ0IHx8IGRvYy5leHRlbmQpIHtcbiAgICAgIHZhciBhbmNob3IgPSByYW5nZS5hbmNob3I7XG4gICAgICBpZiAob3RoZXIpIHtcbiAgICAgICAgdmFyIHBvc0JlZm9yZSA9IGNtcChoZWFkLCBhbmNob3IpIDwgMDtcbiAgICAgICAgaWYgKHBvc0JlZm9yZSAhPSAoY21wKG90aGVyLCBhbmNob3IpIDwgMCkpIHtcbiAgICAgICAgICBhbmNob3IgPSBoZWFkO1xuICAgICAgICAgIGhlYWQgPSBvdGhlcjtcbiAgICAgICAgfSBlbHNlIGlmIChwb3NCZWZvcmUgIT0gKGNtcChoZWFkLCBvdGhlcikgPCAwKSkge1xuICAgICAgICAgIGhlYWQgPSBvdGhlcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBSYW5nZShhbmNob3IsIGhlYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbmV3IFJhbmdlKG90aGVyIHx8IGhlYWQsIGhlYWQpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEV4dGVuZCB0aGUgcHJpbWFyeSBzZWxlY3Rpb24gcmFuZ2UsIGRpc2NhcmQgdGhlIHJlc3QuXG4gIGZ1bmN0aW9uIGV4dGVuZFNlbGVjdGlvbihkb2MsIGhlYWQsIG90aGVyLCBvcHRpb25zKSB7XG4gICAgc2V0U2VsZWN0aW9uKGRvYywgbmV3IFNlbGVjdGlvbihbZXh0ZW5kUmFuZ2UoZG9jLCBkb2Muc2VsLnByaW1hcnkoKSwgaGVhZCwgb3RoZXIpXSwgMCksIG9wdGlvbnMpO1xuICB9XG5cbiAgLy8gRXh0ZW5kIGFsbCBzZWxlY3Rpb25zIChwb3MgaXMgYW4gYXJyYXkgb2Ygc2VsZWN0aW9ucyB3aXRoIGxlbmd0aFxuICAvLyBlcXVhbCB0aGUgbnVtYmVyIG9mIHNlbGVjdGlvbnMpXG4gIGZ1bmN0aW9uIGV4dGVuZFNlbGVjdGlvbnMoZG9jLCBoZWFkcywgb3B0aW9ucykge1xuICAgIGZvciAodmFyIG91dCA9IFtdLCBpID0gMDsgaSA8IGRvYy5zZWwucmFuZ2VzLmxlbmd0aDsgaSsrKVxuICAgICAgb3V0W2ldID0gZXh0ZW5kUmFuZ2UoZG9jLCBkb2Muc2VsLnJhbmdlc1tpXSwgaGVhZHNbaV0sIG51bGwpO1xuICAgIHZhciBuZXdTZWwgPSBub3JtYWxpemVTZWxlY3Rpb24ob3V0LCBkb2Muc2VsLnByaW1JbmRleCk7XG4gICAgc2V0U2VsZWN0aW9uKGRvYywgbmV3U2VsLCBvcHRpb25zKTtcbiAgfVxuXG4gIC8vIFVwZGF0ZXMgYSBzaW5nbGUgcmFuZ2UgaW4gdGhlIHNlbGVjdGlvbi5cbiAgZnVuY3Rpb24gcmVwbGFjZU9uZVNlbGVjdGlvbihkb2MsIGksIHJhbmdlLCBvcHRpb25zKSB7XG4gICAgdmFyIHJhbmdlcyA9IGRvYy5zZWwucmFuZ2VzLnNsaWNlKDApO1xuICAgIHJhbmdlc1tpXSA9IHJhbmdlO1xuICAgIHNldFNlbGVjdGlvbihkb2MsIG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMsIGRvYy5zZWwucHJpbUluZGV4KSwgb3B0aW9ucyk7XG4gIH1cblxuICAvLyBSZXNldCB0aGUgc2VsZWN0aW9uIHRvIGEgc2luZ2xlIHJhbmdlLlxuICBmdW5jdGlvbiBzZXRTaW1wbGVTZWxlY3Rpb24oZG9jLCBhbmNob3IsIGhlYWQsIG9wdGlvbnMpIHtcbiAgICBzZXRTZWxlY3Rpb24oZG9jLCBzaW1wbGVTZWxlY3Rpb24oYW5jaG9yLCBoZWFkKSwgb3B0aW9ucyk7XG4gIH1cblxuICAvLyBHaXZlIGJlZm9yZVNlbGVjdGlvbkNoYW5nZSBoYW5kbGVycyBhIGNoYW5nZSB0byBpbmZsdWVuY2UgYVxuICAvLyBzZWxlY3Rpb24gdXBkYXRlLlxuICBmdW5jdGlvbiBmaWx0ZXJTZWxlY3Rpb25DaGFuZ2UoZG9jLCBzZWwpIHtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgcmFuZ2VzOiBzZWwucmFuZ2VzLFxuICAgICAgdXBkYXRlOiBmdW5jdGlvbihyYW5nZXMpIHtcbiAgICAgICAgdGhpcy5yYW5nZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgdGhpcy5yYW5nZXNbaV0gPSBuZXcgUmFuZ2UoY2xpcFBvcyhkb2MsIHJhbmdlc1tpXS5hbmNob3IpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaXBQb3MoZG9jLCByYW5nZXNbaV0uaGVhZCkpO1xuICAgICAgfVxuICAgIH07XG4gICAgc2lnbmFsKGRvYywgXCJiZWZvcmVTZWxlY3Rpb25DaGFuZ2VcIiwgZG9jLCBvYmopO1xuICAgIGlmIChkb2MuY20pIHNpZ25hbChkb2MuY20sIFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIsIGRvYy5jbSwgb2JqKTtcbiAgICBpZiAob2JqLnJhbmdlcyAhPSBzZWwucmFuZ2VzKSByZXR1cm4gbm9ybWFsaXplU2VsZWN0aW9uKG9iai5yYW5nZXMsIG9iai5yYW5nZXMubGVuZ3RoIC0gMSk7XG4gICAgZWxzZSByZXR1cm4gc2VsO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0U2VsZWN0aW9uUmVwbGFjZUhpc3RvcnkoZG9jLCBzZWwsIG9wdGlvbnMpIHtcbiAgICB2YXIgZG9uZSA9IGRvYy5oaXN0b3J5LmRvbmUsIGxhc3QgPSBsc3QoZG9uZSk7XG4gICAgaWYgKGxhc3QgJiYgbGFzdC5yYW5nZXMpIHtcbiAgICAgIGRvbmVbZG9uZS5sZW5ndGggLSAxXSA9IHNlbDtcbiAgICAgIHNldFNlbGVjdGlvbk5vVW5kbyhkb2MsIHNlbCwgb3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFNlbGVjdGlvbihkb2MsIHNlbCwgb3B0aW9ucyk7XG4gICAgfVxuICB9XG5cbiAgLy8gU2V0IGEgbmV3IHNlbGVjdGlvbi5cbiAgZnVuY3Rpb24gc2V0U2VsZWN0aW9uKGRvYywgc2VsLCBvcHRpb25zKSB7XG4gICAgc2V0U2VsZWN0aW9uTm9VbmRvKGRvYywgc2VsLCBvcHRpb25zKTtcbiAgICBhZGRTZWxlY3Rpb25Ub0hpc3RvcnkoZG9jLCBkb2Muc2VsLCBkb2MuY20gPyBkb2MuY20uY3VyT3AuaWQgOiBOYU4sIG9wdGlvbnMpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0U2VsZWN0aW9uTm9VbmRvKGRvYywgc2VsLCBvcHRpb25zKSB7XG4gICAgaWYgKGhhc0hhbmRsZXIoZG9jLCBcImJlZm9yZVNlbGVjdGlvbkNoYW5nZVwiKSB8fCBkb2MuY20gJiYgaGFzSGFuZGxlcihkb2MuY20sIFwiYmVmb3JlU2VsZWN0aW9uQ2hhbmdlXCIpKVxuICAgICAgc2VsID0gZmlsdGVyU2VsZWN0aW9uQ2hhbmdlKGRvYywgc2VsKTtcblxuICAgIHZhciBiaWFzID0gb3B0aW9ucyAmJiBvcHRpb25zLmJpYXMgfHxcbiAgICAgIChjbXAoc2VsLnByaW1hcnkoKS5oZWFkLCBkb2Muc2VsLnByaW1hcnkoKS5oZWFkKSA8IDAgPyAtMSA6IDEpO1xuICAgIHNldFNlbGVjdGlvbklubmVyKGRvYywgc2tpcEF0b21pY0luU2VsZWN0aW9uKGRvYywgc2VsLCBiaWFzLCB0cnVlKSk7XG5cbiAgICBpZiAoIShvcHRpb25zICYmIG9wdGlvbnMuc2Nyb2xsID09PSBmYWxzZSkgJiYgZG9jLmNtKVxuICAgICAgZW5zdXJlQ3Vyc29yVmlzaWJsZShkb2MuY20pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0U2VsZWN0aW9uSW5uZXIoZG9jLCBzZWwpIHtcbiAgICBpZiAoc2VsLmVxdWFscyhkb2Muc2VsKSkgcmV0dXJuO1xuXG4gICAgZG9jLnNlbCA9IHNlbDtcblxuICAgIGlmIChkb2MuY20pIHtcbiAgICAgIGRvYy5jbS5jdXJPcC51cGRhdGVJbnB1dCA9IGRvYy5jbS5jdXJPcC5zZWxlY3Rpb25DaGFuZ2VkID0gdHJ1ZTtcbiAgICAgIHNpZ25hbEN1cnNvckFjdGl2aXR5KGRvYy5jbSk7XG4gICAgfVxuICAgIHNpZ25hbExhdGVyKGRvYywgXCJjdXJzb3JBY3Rpdml0eVwiLCBkb2MpO1xuICB9XG5cbiAgLy8gVmVyaWZ5IHRoYXQgdGhlIHNlbGVjdGlvbiBkb2VzIG5vdCBwYXJ0aWFsbHkgc2VsZWN0IGFueSBhdG9taWNcbiAgLy8gbWFya2VkIHJhbmdlcy5cbiAgZnVuY3Rpb24gcmVDaGVja1NlbGVjdGlvbihkb2MpIHtcbiAgICBzZXRTZWxlY3Rpb25Jbm5lcihkb2MsIHNraXBBdG9taWNJblNlbGVjdGlvbihkb2MsIGRvYy5zZWwsIG51bGwsIGZhbHNlKSwgc2VsX2RvbnRTY3JvbGwpO1xuICB9XG5cbiAgLy8gUmV0dXJuIGEgc2VsZWN0aW9uIHRoYXQgZG9lcyBub3QgcGFydGlhbGx5IHNlbGVjdCBhbnkgYXRvbWljXG4gIC8vIHJhbmdlcy5cbiAgZnVuY3Rpb24gc2tpcEF0b21pY0luU2VsZWN0aW9uKGRvYywgc2VsLCBiaWFzLCBtYXlDbGVhcikge1xuICAgIHZhciBvdXQ7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWwucmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcmFuZ2UgPSBzZWwucmFuZ2VzW2ldO1xuICAgICAgdmFyIG5ld0FuY2hvciA9IHNraXBBdG9taWMoZG9jLCByYW5nZS5hbmNob3IsIGJpYXMsIG1heUNsZWFyKTtcbiAgICAgIHZhciBuZXdIZWFkID0gc2tpcEF0b21pYyhkb2MsIHJhbmdlLmhlYWQsIGJpYXMsIG1heUNsZWFyKTtcbiAgICAgIGlmIChvdXQgfHwgbmV3QW5jaG9yICE9IHJhbmdlLmFuY2hvciB8fCBuZXdIZWFkICE9IHJhbmdlLmhlYWQpIHtcbiAgICAgICAgaWYgKCFvdXQpIG91dCA9IHNlbC5yYW5nZXMuc2xpY2UoMCwgaSk7XG4gICAgICAgIG91dFtpXSA9IG5ldyBSYW5nZShuZXdBbmNob3IsIG5ld0hlYWQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0ID8gbm9ybWFsaXplU2VsZWN0aW9uKG91dCwgc2VsLnByaW1JbmRleCkgOiBzZWw7XG4gIH1cblxuICAvLyBFbnN1cmUgYSBnaXZlbiBwb3NpdGlvbiBpcyBub3QgaW5zaWRlIGFuIGF0b21pYyByYW5nZS5cbiAgZnVuY3Rpb24gc2tpcEF0b21pYyhkb2MsIHBvcywgYmlhcywgbWF5Q2xlYXIpIHtcbiAgICB2YXIgZmxpcHBlZCA9IGZhbHNlLCBjdXJQb3MgPSBwb3M7XG4gICAgdmFyIGRpciA9IGJpYXMgfHwgMTtcbiAgICBkb2MuY2FudEVkaXQgPSBmYWxzZTtcbiAgICBzZWFyY2g6IGZvciAoOzspIHtcbiAgICAgIHZhciBsaW5lID0gZ2V0TGluZShkb2MsIGN1clBvcy5saW5lKTtcbiAgICAgIGlmIChsaW5lLm1hcmtlZFNwYW5zKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZS5tYXJrZWRTcGFucy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgIHZhciBzcCA9IGxpbmUubWFya2VkU3BhbnNbaV0sIG0gPSBzcC5tYXJrZXI7XG4gICAgICAgICAgaWYgKChzcC5mcm9tID09IG51bGwgfHwgKG0uaW5jbHVzaXZlTGVmdCA/IHNwLmZyb20gPD0gY3VyUG9zLmNoIDogc3AuZnJvbSA8IGN1clBvcy5jaCkpICYmXG4gICAgICAgICAgICAgIChzcC50byA9PSBudWxsIHx8IChtLmluY2x1c2l2ZVJpZ2h0ID8gc3AudG8gPj0gY3VyUG9zLmNoIDogc3AudG8gPiBjdXJQb3MuY2gpKSkge1xuICAgICAgICAgICAgaWYgKG1heUNsZWFyKSB7XG4gICAgICAgICAgICAgIHNpZ25hbChtLCBcImJlZm9yZUN1cnNvckVudGVyXCIpO1xuICAgICAgICAgICAgICBpZiAobS5leHBsaWNpdGx5Q2xlYXJlZCkge1xuICAgICAgICAgICAgICAgIGlmICghbGluZS5tYXJrZWRTcGFucykgYnJlYWs7XG4gICAgICAgICAgICAgICAgZWxzZSB7LS1pOyBjb250aW51ZTt9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbS5hdG9taWMpIGNvbnRpbnVlO1xuICAgICAgICAgICAgdmFyIG5ld1BvcyA9IG0uZmluZChkaXIgPCAwID8gLTEgOiAxKTtcbiAgICAgICAgICAgIGlmIChjbXAobmV3UG9zLCBjdXJQb3MpID09IDApIHtcbiAgICAgICAgICAgICAgbmV3UG9zLmNoICs9IGRpcjtcbiAgICAgICAgICAgICAgaWYgKG5ld1Bvcy5jaCA8IDApIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3UG9zLmxpbmUgPiBkb2MuZmlyc3QpIG5ld1BvcyA9IGNsaXBQb3MoZG9jLCBQb3MobmV3UG9zLmxpbmUgLSAxKSk7XG4gICAgICAgICAgICAgICAgZWxzZSBuZXdQb3MgPSBudWxsO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5ld1Bvcy5jaCA+IGxpbmUudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3UG9zLmxpbmUgPCBkb2MuZmlyc3QgKyBkb2Muc2l6ZSAtIDEpIG5ld1BvcyA9IFBvcyhuZXdQb3MubGluZSArIDEsIDApO1xuICAgICAgICAgICAgICAgIGVsc2UgbmV3UG9zID0gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoIW5ld1Bvcykge1xuICAgICAgICAgICAgICAgIGlmIChmbGlwcGVkKSB7XG4gICAgICAgICAgICAgICAgICAvLyBEcml2ZW4gaW4gYSBjb3JuZXIgLS0gbm8gdmFsaWQgY3Vyc29yIHBvc2l0aW9uIGZvdW5kIGF0IGFsbFxuICAgICAgICAgICAgICAgICAgLy8gLS0gdHJ5IGFnYWluICp3aXRoKiBjbGVhcmluZywgaWYgd2UgZGlkbid0IGFscmVhZHlcbiAgICAgICAgICAgICAgICAgIGlmICghbWF5Q2xlYXIpIHJldHVybiBza2lwQXRvbWljKGRvYywgcG9zLCBiaWFzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgdHVybiBvZmYgZWRpdGluZyB1bnRpbCBmdXJ0aGVyIG5vdGljZSwgYW5kIHJldHVybiB0aGUgc3RhcnQgb2YgdGhlIGRvY1xuICAgICAgICAgICAgICAgICAgZG9jLmNhbnRFZGl0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBQb3MoZG9jLmZpcnN0LCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmxpcHBlZCA9IHRydWU7IG5ld1BvcyA9IHBvczsgZGlyID0gLWRpcjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VyUG9zID0gbmV3UG9zO1xuICAgICAgICAgICAgY29udGludWUgc2VhcmNoO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGN1clBvcztcbiAgICB9XG4gIH1cblxuICAvLyBTRUxFQ1RJT04gRFJBV0lOR1xuXG4gIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvbihjbSkge1xuICAgIGNtLmRpc3BsYXkuaW5wdXQuc2hvd1NlbGVjdGlvbihjbS5kaXNwbGF5LmlucHV0LnByZXBhcmVTZWxlY3Rpb24oKSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcmVwYXJlU2VsZWN0aW9uKGNtLCBwcmltYXJ5KSB7XG4gICAgdmFyIGRvYyA9IGNtLmRvYywgcmVzdWx0ID0ge307XG4gICAgdmFyIGN1ckZyYWdtZW50ID0gcmVzdWx0LmN1cnNvcnMgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgdmFyIHNlbEZyYWdtZW50ID0gcmVzdWx0LnNlbGVjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jLnNlbC5yYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwcmltYXJ5ID09PSBmYWxzZSAmJiBpID09IGRvYy5zZWwucHJpbUluZGV4KSBjb250aW51ZTtcbiAgICAgIHZhciByYW5nZSA9IGRvYy5zZWwucmFuZ2VzW2ldO1xuICAgICAgdmFyIGNvbGxhcHNlZCA9IHJhbmdlLmVtcHR5KCk7XG4gICAgICBpZiAoY29sbGFwc2VkIHx8IGNtLm9wdGlvbnMuc2hvd0N1cnNvcldoZW5TZWxlY3RpbmcpXG4gICAgICAgIGRyYXdTZWxlY3Rpb25DdXJzb3IoY20sIHJhbmdlLmhlYWQsIGN1ckZyYWdtZW50KTtcbiAgICAgIGlmICghY29sbGFwc2VkKVxuICAgICAgICBkcmF3U2VsZWN0aW9uUmFuZ2UoY20sIHJhbmdlLCBzZWxGcmFnbWVudCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBEcmF3cyBhIGN1cnNvciBmb3IgdGhlIGdpdmVuIHJhbmdlXG4gIGZ1bmN0aW9uIGRyYXdTZWxlY3Rpb25DdXJzb3IoY20sIGhlYWQsIG91dHB1dCkge1xuICAgIHZhciBwb3MgPSBjdXJzb3JDb29yZHMoY20sIGhlYWQsIFwiZGl2XCIsIG51bGwsIG51bGwsICFjbS5vcHRpb25zLnNpbmdsZUN1cnNvckhlaWdodFBlckxpbmUpO1xuXG4gICAgdmFyIGN1cnNvciA9IG91dHB1dC5hcHBlbmRDaGlsZChlbHQoXCJkaXZcIiwgXCJcXHUwMGEwXCIsIFwiQ29kZU1pcnJvci1jdXJzb3JcIikpO1xuICAgIGN1cnNvci5zdHlsZS5sZWZ0ID0gcG9zLmxlZnQgKyBcInB4XCI7XG4gICAgY3Vyc29yLnN0eWxlLnRvcCA9IHBvcy50b3AgKyBcInB4XCI7XG4gICAgY3Vyc29yLnN0eWxlLmhlaWdodCA9IE1hdGgubWF4KDAsIHBvcy5ib3R0b20gLSBwb3MudG9wKSAqIGNtLm9wdGlvbnMuY3Vyc29ySGVpZ2h0ICsgXCJweFwiO1xuXG4gICAgaWYgKHBvcy5vdGhlcikge1xuICAgICAgLy8gU2Vjb25kYXJ5IGN1cnNvciwgc2hvd24gd2hlbiBvbiBhICdqdW1wJyBpbiBiaS1kaXJlY3Rpb25hbCB0ZXh0XG4gICAgICB2YXIgb3RoZXJDdXJzb3IgPSBvdXRwdXQuYXBwZW5kQ2hpbGQoZWx0KFwiZGl2XCIsIFwiXFx1MDBhMFwiLCBcIkNvZGVNaXJyb3ItY3Vyc29yIENvZGVNaXJyb3Itc2Vjb25kYXJ5Y3Vyc29yXCIpKTtcbiAgICAgIG90aGVyQ3Vyc29yLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgb3RoZXJDdXJzb3Iuc3R5bGUubGVmdCA9IHBvcy5vdGhlci5sZWZ0ICsgXCJweFwiO1xuICAgICAgb3RoZXJDdXJzb3Iuc3R5bGUudG9wID0gcG9zLm90aGVyLnRvcCArIFwicHhcIjtcbiAgICAgIG90aGVyQ3Vyc29yLnN0eWxlLmhlaWdodCA9IChwb3Mub3RoZXIuYm90dG9tIC0gcG9zLm90aGVyLnRvcCkgKiAuODUgKyBcInB4XCI7XG4gICAgfVxuICB9XG5cbiAgLy8gRHJhd3MgdGhlIGdpdmVuIHJhbmdlIGFzIGEgaGlnaGxpZ2h0ZWQgc2VsZWN0aW9uXG4gIGZ1bmN0aW9uIGRyYXdTZWxlY3Rpb25SYW5nZShjbSwgcmFuZ2UsIG91dHB1dCkge1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgZG9jID0gY20uZG9jO1xuICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB2YXIgcGFkZGluZyA9IHBhZGRpbmdIKGNtLmRpc3BsYXkpLCBsZWZ0U2lkZSA9IHBhZGRpbmcubGVmdDtcbiAgICB2YXIgcmlnaHRTaWRlID0gTWF0aC5tYXgoZGlzcGxheS5zaXplcldpZHRoLCBkaXNwbGF5V2lkdGgoY20pIC0gZGlzcGxheS5zaXplci5vZmZzZXRMZWZ0KSAtIHBhZGRpbmcucmlnaHQ7XG5cbiAgICBmdW5jdGlvbiBhZGQobGVmdCwgdG9wLCB3aWR0aCwgYm90dG9tKSB7XG4gICAgICBpZiAodG9wIDwgMCkgdG9wID0gMDtcbiAgICAgIHRvcCA9IE1hdGgucm91bmQodG9wKTtcbiAgICAgIGJvdHRvbSA9IE1hdGgucm91bmQoYm90dG9tKTtcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGVsdChcImRpdlwiLCBudWxsLCBcIkNvZGVNaXJyb3Itc2VsZWN0ZWRcIiwgXCJwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IFwiICsgbGVmdCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJweDsgdG9wOiBcIiArIHRvcCArIFwicHg7IHdpZHRoOiBcIiArICh3aWR0aCA9PSBudWxsID8gcmlnaHRTaWRlIC0gbGVmdCA6IHdpZHRoKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJweDsgaGVpZ2h0OiBcIiArIChib3R0b20gLSB0b3ApICsgXCJweFwiKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJhd0ZvckxpbmUobGluZSwgZnJvbUFyZywgdG9BcmcpIHtcbiAgICAgIHZhciBsaW5lT2JqID0gZ2V0TGluZShkb2MsIGxpbmUpO1xuICAgICAgdmFyIGxpbmVMZW4gPSBsaW5lT2JqLnRleHQubGVuZ3RoO1xuICAgICAgdmFyIHN0YXJ0LCBlbmQ7XG4gICAgICBmdW5jdGlvbiBjb29yZHMoY2gsIGJpYXMpIHtcbiAgICAgICAgcmV0dXJuIGNoYXJDb29yZHMoY20sIFBvcyhsaW5lLCBjaCksIFwiZGl2XCIsIGxpbmVPYmosIGJpYXMpO1xuICAgICAgfVxuXG4gICAgICBpdGVyYXRlQmlkaVNlY3Rpb25zKGdldE9yZGVyKGxpbmVPYmopLCBmcm9tQXJnIHx8IDAsIHRvQXJnID09IG51bGwgPyBsaW5lTGVuIDogdG9BcmcsIGZ1bmN0aW9uKGZyb20sIHRvLCBkaXIpIHtcbiAgICAgICAgdmFyIGxlZnRQb3MgPSBjb29yZHMoZnJvbSwgXCJsZWZ0XCIpLCByaWdodFBvcywgbGVmdCwgcmlnaHQ7XG4gICAgICAgIGlmIChmcm9tID09IHRvKSB7XG4gICAgICAgICAgcmlnaHRQb3MgPSBsZWZ0UG9zO1xuICAgICAgICAgIGxlZnQgPSByaWdodCA9IGxlZnRQb3MubGVmdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByaWdodFBvcyA9IGNvb3Jkcyh0byAtIDEsIFwicmlnaHRcIik7XG4gICAgICAgICAgaWYgKGRpciA9PSBcInJ0bFwiKSB7IHZhciB0bXAgPSBsZWZ0UG9zOyBsZWZ0UG9zID0gcmlnaHRQb3M7IHJpZ2h0UG9zID0gdG1wOyB9XG4gICAgICAgICAgbGVmdCA9IGxlZnRQb3MubGVmdDtcbiAgICAgICAgICByaWdodCA9IHJpZ2h0UG9zLnJpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChmcm9tQXJnID09IG51bGwgJiYgZnJvbSA9PSAwKSBsZWZ0ID0gbGVmdFNpZGU7XG4gICAgICAgIGlmIChyaWdodFBvcy50b3AgLSBsZWZ0UG9zLnRvcCA+IDMpIHsgLy8gRGlmZmVyZW50IGxpbmVzLCBkcmF3IHRvcCBwYXJ0XG4gICAgICAgICAgYWRkKGxlZnQsIGxlZnRQb3MudG9wLCBudWxsLCBsZWZ0UG9zLmJvdHRvbSk7XG4gICAgICAgICAgbGVmdCA9IGxlZnRTaWRlO1xuICAgICAgICAgIGlmIChsZWZ0UG9zLmJvdHRvbSA8IHJpZ2h0UG9zLnRvcCkgYWRkKGxlZnQsIGxlZnRQb3MuYm90dG9tLCBudWxsLCByaWdodFBvcy50b3ApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0b0FyZyA9PSBudWxsICYmIHRvID09IGxpbmVMZW4pIHJpZ2h0ID0gcmlnaHRTaWRlO1xuICAgICAgICBpZiAoIXN0YXJ0IHx8IGxlZnRQb3MudG9wIDwgc3RhcnQudG9wIHx8IGxlZnRQb3MudG9wID09IHN0YXJ0LnRvcCAmJiBsZWZ0UG9zLmxlZnQgPCBzdGFydC5sZWZ0KVxuICAgICAgICAgIHN0YXJ0ID0gbGVmdFBvcztcbiAgICAgICAgaWYgKCFlbmQgfHwgcmlnaHRQb3MuYm90dG9tID4gZW5kLmJvdHRvbSB8fCByaWdodFBvcy5ib3R0b20gPT0gZW5kLmJvdHRvbSAmJiByaWdodFBvcy5yaWdodCA+IGVuZC5yaWdodClcbiAgICAgICAgICBlbmQgPSByaWdodFBvcztcbiAgICAgICAgaWYgKGxlZnQgPCBsZWZ0U2lkZSArIDEpIGxlZnQgPSBsZWZ0U2lkZTtcbiAgICAgICAgYWRkKGxlZnQsIHJpZ2h0UG9zLnRvcCwgcmlnaHQgLSBsZWZ0LCByaWdodFBvcy5ib3R0b20pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4ge3N0YXJ0OiBzdGFydCwgZW5kOiBlbmR9O1xuICAgIH1cblxuICAgIHZhciBzRnJvbSA9IHJhbmdlLmZyb20oKSwgc1RvID0gcmFuZ2UudG8oKTtcbiAgICBpZiAoc0Zyb20ubGluZSA9PSBzVG8ubGluZSkge1xuICAgICAgZHJhd0ZvckxpbmUoc0Zyb20ubGluZSwgc0Zyb20uY2gsIHNUby5jaCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBmcm9tTGluZSA9IGdldExpbmUoZG9jLCBzRnJvbS5saW5lKSwgdG9MaW5lID0gZ2V0TGluZShkb2MsIHNUby5saW5lKTtcbiAgICAgIHZhciBzaW5nbGVWTGluZSA9IHZpc3VhbExpbmUoZnJvbUxpbmUpID09IHZpc3VhbExpbmUodG9MaW5lKTtcbiAgICAgIHZhciBsZWZ0RW5kID0gZHJhd0ZvckxpbmUoc0Zyb20ubGluZSwgc0Zyb20uY2gsIHNpbmdsZVZMaW5lID8gZnJvbUxpbmUudGV4dC5sZW5ndGggKyAxIDogbnVsbCkuZW5kO1xuICAgICAgdmFyIHJpZ2h0U3RhcnQgPSBkcmF3Rm9yTGluZShzVG8ubGluZSwgc2luZ2xlVkxpbmUgPyAwIDogbnVsbCwgc1RvLmNoKS5zdGFydDtcbiAgICAgIGlmIChzaW5nbGVWTGluZSkge1xuICAgICAgICBpZiAobGVmdEVuZC50b3AgPCByaWdodFN0YXJ0LnRvcCAtIDIpIHtcbiAgICAgICAgICBhZGQobGVmdEVuZC5yaWdodCwgbGVmdEVuZC50b3AsIG51bGwsIGxlZnRFbmQuYm90dG9tKTtcbiAgICAgICAgICBhZGQobGVmdFNpZGUsIHJpZ2h0U3RhcnQudG9wLCByaWdodFN0YXJ0LmxlZnQsIHJpZ2h0U3RhcnQuYm90dG9tKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZGQobGVmdEVuZC5yaWdodCwgbGVmdEVuZC50b3AsIHJpZ2h0U3RhcnQubGVmdCAtIGxlZnRFbmQucmlnaHQsIGxlZnRFbmQuYm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGxlZnRFbmQuYm90dG9tIDwgcmlnaHRTdGFydC50b3ApXG4gICAgICAgIGFkZChsZWZ0U2lkZSwgbGVmdEVuZC5ib3R0b20sIG51bGwsIHJpZ2h0U3RhcnQudG9wKTtcbiAgICB9XG5cbiAgICBvdXRwdXQuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9XG5cbiAgLy8gQ3Vyc29yLWJsaW5raW5nXG4gIGZ1bmN0aW9uIHJlc3RhcnRCbGluayhjbSkge1xuICAgIGlmICghY20uc3RhdGUuZm9jdXNlZCkgcmV0dXJuO1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheTtcbiAgICBjbGVhckludGVydmFsKGRpc3BsYXkuYmxpbmtlcik7XG4gICAgdmFyIG9uID0gdHJ1ZTtcbiAgICBkaXNwbGF5LmN1cnNvckRpdi5zdHlsZS52aXNpYmlsaXR5ID0gXCJcIjtcbiAgICBpZiAoY20ub3B0aW9ucy5jdXJzb3JCbGlua1JhdGUgPiAwKVxuICAgICAgZGlzcGxheS5ibGlua2VyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIGRpc3BsYXkuY3Vyc29yRGl2LnN0eWxlLnZpc2liaWxpdHkgPSAob24gPSAhb24pID8gXCJcIiA6IFwiaGlkZGVuXCI7XG4gICAgICB9LCBjbS5vcHRpb25zLmN1cnNvckJsaW5rUmF0ZSk7XG4gICAgZWxzZSBpZiAoY20ub3B0aW9ucy5jdXJzb3JCbGlua1JhdGUgPCAwKVxuICAgICAgZGlzcGxheS5jdXJzb3JEaXYuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gIH1cblxuICAvLyBISUdITElHSFQgV09SS0VSXG5cbiAgZnVuY3Rpb24gc3RhcnRXb3JrZXIoY20sIHRpbWUpIHtcbiAgICBpZiAoY20uZG9jLm1vZGUuc3RhcnRTdGF0ZSAmJiBjbS5kb2MuZnJvbnRpZXIgPCBjbS5kaXNwbGF5LnZpZXdUbylcbiAgICAgIGNtLnN0YXRlLmhpZ2hsaWdodC5zZXQodGltZSwgYmluZChoaWdobGlnaHRXb3JrZXIsIGNtKSk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWdobGlnaHRXb3JrZXIoY20pIHtcbiAgICB2YXIgZG9jID0gY20uZG9jO1xuICAgIGlmIChkb2MuZnJvbnRpZXIgPCBkb2MuZmlyc3QpIGRvYy5mcm9udGllciA9IGRvYy5maXJzdDtcbiAgICBpZiAoZG9jLmZyb250aWVyID49IGNtLmRpc3BsYXkudmlld1RvKSByZXR1cm47XG4gICAgdmFyIGVuZCA9ICtuZXcgRGF0ZSArIGNtLm9wdGlvbnMud29ya1RpbWU7XG4gICAgdmFyIHN0YXRlID0gY29weVN0YXRlKGRvYy5tb2RlLCBnZXRTdGF0ZUJlZm9yZShjbSwgZG9jLmZyb250aWVyKSk7XG4gICAgdmFyIGNoYW5nZWRMaW5lcyA9IFtdO1xuXG4gICAgZG9jLml0ZXIoZG9jLmZyb250aWVyLCBNYXRoLm1pbihkb2MuZmlyc3QgKyBkb2Muc2l6ZSwgY20uZGlzcGxheS52aWV3VG8gKyA1MDApLCBmdW5jdGlvbihsaW5lKSB7XG4gICAgICBpZiAoZG9jLmZyb250aWVyID49IGNtLmRpc3BsYXkudmlld0Zyb20pIHsgLy8gVmlzaWJsZVxuICAgICAgICB2YXIgb2xkU3R5bGVzID0gbGluZS5zdHlsZXMsIHRvb0xvbmcgPSBsaW5lLnRleHQubGVuZ3RoID4gY20ub3B0aW9ucy5tYXhIaWdobGlnaHRMZW5ndGg7XG4gICAgICAgIHZhciBoaWdobGlnaHRlZCA9IGhpZ2hsaWdodExpbmUoY20sIGxpbmUsIHRvb0xvbmcgPyBjb3B5U3RhdGUoZG9jLm1vZGUsIHN0YXRlKSA6IHN0YXRlLCB0cnVlKTtcbiAgICAgICAgbGluZS5zdHlsZXMgPSBoaWdobGlnaHRlZC5zdHlsZXM7XG4gICAgICAgIHZhciBvbGRDbHMgPSBsaW5lLnN0eWxlQ2xhc3NlcywgbmV3Q2xzID0gaGlnaGxpZ2h0ZWQuY2xhc3NlcztcbiAgICAgICAgaWYgKG5ld0NscykgbGluZS5zdHlsZUNsYXNzZXMgPSBuZXdDbHM7XG4gICAgICAgIGVsc2UgaWYgKG9sZENscykgbGluZS5zdHlsZUNsYXNzZXMgPSBudWxsO1xuICAgICAgICB2YXIgaXNjaGFuZ2UgPSAhb2xkU3R5bGVzIHx8IG9sZFN0eWxlcy5sZW5ndGggIT0gbGluZS5zdHlsZXMubGVuZ3RoIHx8XG4gICAgICAgICAgb2xkQ2xzICE9IG5ld0NscyAmJiAoIW9sZENscyB8fCAhbmV3Q2xzIHx8IG9sZENscy5iZ0NsYXNzICE9IG5ld0Nscy5iZ0NsYXNzIHx8IG9sZENscy50ZXh0Q2xhc3MgIT0gbmV3Q2xzLnRleHRDbGFzcyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyAhaXNjaGFuZ2UgJiYgaSA8IG9sZFN0eWxlcy5sZW5ndGg7ICsraSkgaXNjaGFuZ2UgPSBvbGRTdHlsZXNbaV0gIT0gbGluZS5zdHlsZXNbaV07XG4gICAgICAgIGlmIChpc2NoYW5nZSkgY2hhbmdlZExpbmVzLnB1c2goZG9jLmZyb250aWVyKTtcbiAgICAgICAgbGluZS5zdGF0ZUFmdGVyID0gdG9vTG9uZyA/IHN0YXRlIDogY29weVN0YXRlKGRvYy5tb2RlLCBzdGF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobGluZS50ZXh0Lmxlbmd0aCA8PSBjbS5vcHRpb25zLm1heEhpZ2hsaWdodExlbmd0aClcbiAgICAgICAgICBwcm9jZXNzTGluZShjbSwgbGluZS50ZXh0LCBzdGF0ZSk7XG4gICAgICAgIGxpbmUuc3RhdGVBZnRlciA9IGRvYy5mcm9udGllciAlIDUgPT0gMCA/IGNvcHlTdGF0ZShkb2MubW9kZSwgc3RhdGUpIDogbnVsbDtcbiAgICAgIH1cbiAgICAgICsrZG9jLmZyb250aWVyO1xuICAgICAgaWYgKCtuZXcgRGF0ZSA+IGVuZCkge1xuICAgICAgICBzdGFydFdvcmtlcihjbSwgY20ub3B0aW9ucy53b3JrRGVsYXkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoY2hhbmdlZExpbmVzLmxlbmd0aCkgcnVuSW5PcChjbSwgZnVuY3Rpb24oKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZWRMaW5lcy5sZW5ndGg7IGkrKylcbiAgICAgICAgcmVnTGluZUNoYW5nZShjbSwgY2hhbmdlZExpbmVzW2ldLCBcInRleHRcIik7XG4gICAgfSk7XG4gIH1cblxuICAvLyBGaW5kcyB0aGUgbGluZSB0byBzdGFydCB3aXRoIHdoZW4gc3RhcnRpbmcgYSBwYXJzZS4gVHJpZXMgdG9cbiAgLy8gZmluZCBhIGxpbmUgd2l0aCBhIHN0YXRlQWZ0ZXIsIHNvIHRoYXQgaXQgY2FuIHN0YXJ0IHdpdGggYVxuICAvLyB2YWxpZCBzdGF0ZS4gSWYgdGhhdCBmYWlscywgaXQgcmV0dXJucyB0aGUgbGluZSB3aXRoIHRoZVxuICAvLyBzbWFsbGVzdCBpbmRlbnRhdGlvbiwgd2hpY2ggdGVuZHMgdG8gbmVlZCB0aGUgbGVhc3QgY29udGV4dCB0b1xuICAvLyBwYXJzZSBjb3JyZWN0bHkuXG4gIGZ1bmN0aW9uIGZpbmRTdGFydExpbmUoY20sIG4sIHByZWNpc2UpIHtcbiAgICB2YXIgbWluaW5kZW50LCBtaW5saW5lLCBkb2MgPSBjbS5kb2M7XG4gICAgdmFyIGxpbSA9IHByZWNpc2UgPyAtMSA6IG4gLSAoY20uZG9jLm1vZGUuaW5uZXJNb2RlID8gMTAwMCA6IDEwMCk7XG4gICAgZm9yICh2YXIgc2VhcmNoID0gbjsgc2VhcmNoID4gbGltOyAtLXNlYXJjaCkge1xuICAgICAgaWYgKHNlYXJjaCA8PSBkb2MuZmlyc3QpIHJldHVybiBkb2MuZmlyc3Q7XG4gICAgICB2YXIgbGluZSA9IGdldExpbmUoZG9jLCBzZWFyY2ggLSAxKTtcbiAgICAgIGlmIChsaW5lLnN0YXRlQWZ0ZXIgJiYgKCFwcmVjaXNlIHx8IHNlYXJjaCA8PSBkb2MuZnJvbnRpZXIpKSByZXR1cm4gc2VhcmNoO1xuICAgICAgdmFyIGluZGVudGVkID0gY291bnRDb2x1bW4obGluZS50ZXh0LCBudWxsLCBjbS5vcHRpb25zLnRhYlNpemUpO1xuICAgICAgaWYgKG1pbmxpbmUgPT0gbnVsbCB8fCBtaW5pbmRlbnQgPiBpbmRlbnRlZCkge1xuICAgICAgICBtaW5saW5lID0gc2VhcmNoIC0gMTtcbiAgICAgICAgbWluaW5kZW50ID0gaW5kZW50ZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtaW5saW5lO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U3RhdGVCZWZvcmUoY20sIG4sIHByZWNpc2UpIHtcbiAgICB2YXIgZG9jID0gY20uZG9jLCBkaXNwbGF5ID0gY20uZGlzcGxheTtcbiAgICBpZiAoIWRvYy5tb2RlLnN0YXJ0U3RhdGUpIHJldHVybiB0cnVlO1xuICAgIHZhciBwb3MgPSBmaW5kU3RhcnRMaW5lKGNtLCBuLCBwcmVjaXNlKSwgc3RhdGUgPSBwb3MgPiBkb2MuZmlyc3QgJiYgZ2V0TGluZShkb2MsIHBvcy0xKS5zdGF0ZUFmdGVyO1xuICAgIGlmICghc3RhdGUpIHN0YXRlID0gc3RhcnRTdGF0ZShkb2MubW9kZSk7XG4gICAgZWxzZSBzdGF0ZSA9IGNvcHlTdGF0ZShkb2MubW9kZSwgc3RhdGUpO1xuICAgIGRvYy5pdGVyKHBvcywgbiwgZnVuY3Rpb24obGluZSkge1xuICAgICAgcHJvY2Vzc0xpbmUoY20sIGxpbmUudGV4dCwgc3RhdGUpO1xuICAgICAgdmFyIHNhdmUgPSBwb3MgPT0gbiAtIDEgfHwgcG9zICUgNSA9PSAwIHx8IHBvcyA+PSBkaXNwbGF5LnZpZXdGcm9tICYmIHBvcyA8IGRpc3BsYXkudmlld1RvO1xuICAgICAgbGluZS5zdGF0ZUFmdGVyID0gc2F2ZSA/IGNvcHlTdGF0ZShkb2MubW9kZSwgc3RhdGUpIDogbnVsbDtcbiAgICAgICsrcG9zO1xuICAgIH0pO1xuICAgIGlmIChwcmVjaXNlKSBkb2MuZnJvbnRpZXIgPSBwb3M7XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG5cbiAgLy8gUE9TSVRJT04gTUVBU1VSRU1FTlRcblxuICBmdW5jdGlvbiBwYWRkaW5nVG9wKGRpc3BsYXkpIHtyZXR1cm4gZGlzcGxheS5saW5lU3BhY2Uub2Zmc2V0VG9wO31cbiAgZnVuY3Rpb24gcGFkZGluZ1ZlcnQoZGlzcGxheSkge3JldHVybiBkaXNwbGF5Lm1vdmVyLm9mZnNldEhlaWdodCAtIGRpc3BsYXkubGluZVNwYWNlLm9mZnNldEhlaWdodDt9XG4gIGZ1bmN0aW9uIHBhZGRpbmdIKGRpc3BsYXkpIHtcbiAgICBpZiAoZGlzcGxheS5jYWNoZWRQYWRkaW5nSCkgcmV0dXJuIGRpc3BsYXkuY2FjaGVkUGFkZGluZ0g7XG4gICAgdmFyIGUgPSByZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5Lm1lYXN1cmUsIGVsdChcInByZVwiLCBcInhcIikpO1xuICAgIHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlID8gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZSkgOiBlLmN1cnJlbnRTdHlsZTtcbiAgICB2YXIgZGF0YSA9IHtsZWZ0OiBwYXJzZUludChzdHlsZS5wYWRkaW5nTGVmdCksIHJpZ2h0OiBwYXJzZUludChzdHlsZS5wYWRkaW5nUmlnaHQpfTtcbiAgICBpZiAoIWlzTmFOKGRhdGEubGVmdCkgJiYgIWlzTmFOKGRhdGEucmlnaHQpKSBkaXNwbGF5LmNhY2hlZFBhZGRpbmdIID0gZGF0YTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNjcm9sbEdhcChjbSkgeyByZXR1cm4gc2Nyb2xsZXJHYXAgLSBjbS5kaXNwbGF5Lm5hdGl2ZUJhcldpZHRoOyB9XG4gIGZ1bmN0aW9uIGRpc3BsYXlXaWR0aChjbSkge1xuICAgIHJldHVybiBjbS5kaXNwbGF5LnNjcm9sbGVyLmNsaWVudFdpZHRoIC0gc2Nyb2xsR2FwKGNtKSAtIGNtLmRpc3BsYXkuYmFyV2lkdGg7XG4gIH1cbiAgZnVuY3Rpb24gZGlzcGxheUhlaWdodChjbSkge1xuICAgIHJldHVybiBjbS5kaXNwbGF5LnNjcm9sbGVyLmNsaWVudEhlaWdodCAtIHNjcm9sbEdhcChjbSkgLSBjbS5kaXNwbGF5LmJhckhlaWdodDtcbiAgfVxuXG4gIC8vIEVuc3VyZSB0aGUgbGluZVZpZXcud3JhcHBpbmcuaGVpZ2h0cyBhcnJheSBpcyBwb3B1bGF0ZWQuIFRoaXMgaXNcbiAgLy8gYW4gYXJyYXkgb2YgYm90dG9tIG9mZnNldHMgZm9yIHRoZSBsaW5lcyB0aGF0IG1ha2UgdXAgYSBkcmF3blxuICAvLyBsaW5lLiBXaGVuIGxpbmVXcmFwcGluZyBpcyBvbiwgdGhlcmUgbWlnaHQgYmUgbW9yZSB0aGFuIG9uZVxuICAvLyBoZWlnaHQuXG4gIGZ1bmN0aW9uIGVuc3VyZUxpbmVIZWlnaHRzKGNtLCBsaW5lVmlldywgcmVjdCkge1xuICAgIHZhciB3cmFwcGluZyA9IGNtLm9wdGlvbnMubGluZVdyYXBwaW5nO1xuICAgIHZhciBjdXJXaWR0aCA9IHdyYXBwaW5nICYmIGRpc3BsYXlXaWR0aChjbSk7XG4gICAgaWYgKCFsaW5lVmlldy5tZWFzdXJlLmhlaWdodHMgfHwgd3JhcHBpbmcgJiYgbGluZVZpZXcubWVhc3VyZS53aWR0aCAhPSBjdXJXaWR0aCkge1xuICAgICAgdmFyIGhlaWdodHMgPSBsaW5lVmlldy5tZWFzdXJlLmhlaWdodHMgPSBbXTtcbiAgICAgIGlmICh3cmFwcGluZykge1xuICAgICAgICBsaW5lVmlldy5tZWFzdXJlLndpZHRoID0gY3VyV2lkdGg7XG4gICAgICAgIHZhciByZWN0cyA9IGxpbmVWaWV3LnRleHQuZmlyc3RDaGlsZC5nZXRDbGllbnRSZWN0cygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlY3RzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgIHZhciBjdXIgPSByZWN0c1tpXSwgbmV4dCA9IHJlY3RzW2kgKyAxXTtcbiAgICAgICAgICBpZiAoTWF0aC5hYnMoY3VyLmJvdHRvbSAtIG5leHQuYm90dG9tKSA+IDIpXG4gICAgICAgICAgICBoZWlnaHRzLnB1c2goKGN1ci5ib3R0b20gKyBuZXh0LnRvcCkgLyAyIC0gcmVjdC50b3ApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBoZWlnaHRzLnB1c2gocmVjdC5ib3R0b20gLSByZWN0LnRvcCk7XG4gICAgfVxuICB9XG5cbiAgLy8gRmluZCBhIGxpbmUgbWFwIChtYXBwaW5nIGNoYXJhY3RlciBvZmZzZXRzIHRvIHRleHQgbm9kZXMpIGFuZCBhXG4gIC8vIG1lYXN1cmVtZW50IGNhY2hlIGZvciB0aGUgZ2l2ZW4gbGluZSBudW1iZXIuIChBIGxpbmUgdmlldyBtaWdodFxuICAvLyBjb250YWluIG11bHRpcGxlIGxpbmVzIHdoZW4gY29sbGFwc2VkIHJhbmdlcyBhcmUgcHJlc2VudC4pXG4gIGZ1bmN0aW9uIG1hcEZyb21MaW5lVmlldyhsaW5lVmlldywgbGluZSwgbGluZU4pIHtcbiAgICBpZiAobGluZVZpZXcubGluZSA9PSBsaW5lKVxuICAgICAgcmV0dXJuIHttYXA6IGxpbmVWaWV3Lm1lYXN1cmUubWFwLCBjYWNoZTogbGluZVZpZXcubWVhc3VyZS5jYWNoZX07XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lVmlldy5yZXN0Lmxlbmd0aDsgaSsrKVxuICAgICAgaWYgKGxpbmVWaWV3LnJlc3RbaV0gPT0gbGluZSlcbiAgICAgICAgcmV0dXJuIHttYXA6IGxpbmVWaWV3Lm1lYXN1cmUubWFwc1tpXSwgY2FjaGU6IGxpbmVWaWV3Lm1lYXN1cmUuY2FjaGVzW2ldfTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVWaWV3LnJlc3QubGVuZ3RoOyBpKyspXG4gICAgICBpZiAobGluZU5vKGxpbmVWaWV3LnJlc3RbaV0pID4gbGluZU4pXG4gICAgICAgIHJldHVybiB7bWFwOiBsaW5lVmlldy5tZWFzdXJlLm1hcHNbaV0sIGNhY2hlOiBsaW5lVmlldy5tZWFzdXJlLmNhY2hlc1tpXSwgYmVmb3JlOiB0cnVlfTtcbiAgfVxuXG4gIC8vIFJlbmRlciBhIGxpbmUgaW50byB0aGUgaGlkZGVuIG5vZGUgZGlzcGxheS5leHRlcm5hbE1lYXN1cmVkLiBVc2VkXG4gIC8vIHdoZW4gbWVhc3VyZW1lbnQgaXMgbmVlZGVkIGZvciBhIGxpbmUgdGhhdCdzIG5vdCBpbiB0aGUgdmlld3BvcnQuXG4gIGZ1bmN0aW9uIHVwZGF0ZUV4dGVybmFsTWVhc3VyZW1lbnQoY20sIGxpbmUpIHtcbiAgICBsaW5lID0gdmlzdWFsTGluZShsaW5lKTtcbiAgICB2YXIgbGluZU4gPSBsaW5lTm8obGluZSk7XG4gICAgdmFyIHZpZXcgPSBjbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQgPSBuZXcgTGluZVZpZXcoY20uZG9jLCBsaW5lLCBsaW5lTik7XG4gICAgdmlldy5saW5lTiA9IGxpbmVOO1xuICAgIHZhciBidWlsdCA9IHZpZXcuYnVpbHQgPSBidWlsZExpbmVDb250ZW50KGNtLCB2aWV3KTtcbiAgICB2aWV3LnRleHQgPSBidWlsdC5wcmU7XG4gICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQoY20uZGlzcGxheS5saW5lTWVhc3VyZSwgYnVpbHQucHJlKTtcbiAgICByZXR1cm4gdmlldztcbiAgfVxuXG4gIC8vIEdldCBhIHt0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHR9IGJveCAoaW4gbGluZS1sb2NhbCBjb29yZGluYXRlcylcbiAgLy8gZm9yIGEgZ2l2ZW4gY2hhcmFjdGVyLlxuICBmdW5jdGlvbiBtZWFzdXJlQ2hhcihjbSwgbGluZSwgY2gsIGJpYXMpIHtcbiAgICByZXR1cm4gbWVhc3VyZUNoYXJQcmVwYXJlZChjbSwgcHJlcGFyZU1lYXN1cmVGb3JMaW5lKGNtLCBsaW5lKSwgY2gsIGJpYXMpO1xuICB9XG5cbiAgLy8gRmluZCBhIGxpbmUgdmlldyB0aGF0IGNvcnJlc3BvbmRzIHRvIHRoZSBnaXZlbiBsaW5lIG51bWJlci5cbiAgZnVuY3Rpb24gZmluZFZpZXdGb3JMaW5lKGNtLCBsaW5lTikge1xuICAgIGlmIChsaW5lTiA+PSBjbS5kaXNwbGF5LnZpZXdGcm9tICYmIGxpbmVOIDwgY20uZGlzcGxheS52aWV3VG8pXG4gICAgICByZXR1cm4gY20uZGlzcGxheS52aWV3W2ZpbmRWaWV3SW5kZXgoY20sIGxpbmVOKV07XG4gICAgdmFyIGV4dCA9IGNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZDtcbiAgICBpZiAoZXh0ICYmIGxpbmVOID49IGV4dC5saW5lTiAmJiBsaW5lTiA8IGV4dC5saW5lTiArIGV4dC5zaXplKVxuICAgICAgcmV0dXJuIGV4dDtcbiAgfVxuXG4gIC8vIE1lYXN1cmVtZW50IGNhbiBiZSBzcGxpdCBpbiB0d28gc3RlcHMsIHRoZSBzZXQtdXAgd29yayB0aGF0XG4gIC8vIGFwcGxpZXMgdG8gdGhlIHdob2xlIGxpbmUsIGFuZCB0aGUgbWVhc3VyZW1lbnQgb2YgdGhlIGFjdHVhbFxuICAvLyBjaGFyYWN0ZXIuIEZ1bmN0aW9ucyBsaWtlIGNvb3Jkc0NoYXIsIHRoYXQgbmVlZCB0byBkbyBhIGxvdCBvZlxuICAvLyBtZWFzdXJlbWVudHMgaW4gYSByb3csIGNhbiB0aHVzIGVuc3VyZSB0aGF0IHRoZSBzZXQtdXAgd29yayBpc1xuICAvLyBvbmx5IGRvbmUgb25jZS5cbiAgZnVuY3Rpb24gcHJlcGFyZU1lYXN1cmVGb3JMaW5lKGNtLCBsaW5lKSB7XG4gICAgdmFyIGxpbmVOID0gbGluZU5vKGxpbmUpO1xuICAgIHZhciB2aWV3ID0gZmluZFZpZXdGb3JMaW5lKGNtLCBsaW5lTik7XG4gICAgaWYgKHZpZXcgJiYgIXZpZXcudGV4dCkge1xuICAgICAgdmlldyA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh2aWV3ICYmIHZpZXcuY2hhbmdlcykge1xuICAgICAgdXBkYXRlTGluZUZvckNoYW5nZXMoY20sIHZpZXcsIGxpbmVOLCBnZXREaW1lbnNpb25zKGNtKSk7XG4gICAgICBjbS5jdXJPcC5mb3JjZVVwZGF0ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmICghdmlldylcbiAgICAgIHZpZXcgPSB1cGRhdGVFeHRlcm5hbE1lYXN1cmVtZW50KGNtLCBsaW5lKTtcblxuICAgIHZhciBpbmZvID0gbWFwRnJvbUxpbmVWaWV3KHZpZXcsIGxpbmUsIGxpbmVOKTtcbiAgICByZXR1cm4ge1xuICAgICAgbGluZTogbGluZSwgdmlldzogdmlldywgcmVjdDogbnVsbCxcbiAgICAgIG1hcDogaW5mby5tYXAsIGNhY2hlOiBpbmZvLmNhY2hlLCBiZWZvcmU6IGluZm8uYmVmb3JlLFxuICAgICAgaGFzSGVpZ2h0czogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgLy8gR2l2ZW4gYSBwcmVwYXJlZCBtZWFzdXJlbWVudCBvYmplY3QsIG1lYXN1cmVzIHRoZSBwb3NpdGlvbiBvZiBhblxuICAvLyBhY3R1YWwgY2hhcmFjdGVyIChvciBmZXRjaGVzIGl0IGZyb20gdGhlIGNhY2hlKS5cbiAgZnVuY3Rpb24gbWVhc3VyZUNoYXJQcmVwYXJlZChjbSwgcHJlcGFyZWQsIGNoLCBiaWFzLCB2YXJIZWlnaHQpIHtcbiAgICBpZiAocHJlcGFyZWQuYmVmb3JlKSBjaCA9IC0xO1xuICAgIHZhciBrZXkgPSBjaCArIChiaWFzIHx8IFwiXCIpLCBmb3VuZDtcbiAgICBpZiAocHJlcGFyZWQuY2FjaGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgZm91bmQgPSBwcmVwYXJlZC5jYWNoZVtrZXldO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIXByZXBhcmVkLnJlY3QpXG4gICAgICAgIHByZXBhcmVkLnJlY3QgPSBwcmVwYXJlZC52aWV3LnRleHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBpZiAoIXByZXBhcmVkLmhhc0hlaWdodHMpIHtcbiAgICAgICAgZW5zdXJlTGluZUhlaWdodHMoY20sIHByZXBhcmVkLnZpZXcsIHByZXBhcmVkLnJlY3QpO1xuICAgICAgICBwcmVwYXJlZC5oYXNIZWlnaHRzID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGZvdW5kID0gbWVhc3VyZUNoYXJJbm5lcihjbSwgcHJlcGFyZWQsIGNoLCBiaWFzKTtcbiAgICAgIGlmICghZm91bmQuYm9ndXMpIHByZXBhcmVkLmNhY2hlW2tleV0gPSBmb3VuZDtcbiAgICB9XG4gICAgcmV0dXJuIHtsZWZ0OiBmb3VuZC5sZWZ0LCByaWdodDogZm91bmQucmlnaHQsXG4gICAgICAgICAgICB0b3A6IHZhckhlaWdodCA/IGZvdW5kLnJ0b3AgOiBmb3VuZC50b3AsXG4gICAgICAgICAgICBib3R0b206IHZhckhlaWdodCA/IGZvdW5kLnJib3R0b20gOiBmb3VuZC5ib3R0b219O1xuICB9XG5cbiAgdmFyIG51bGxSZWN0ID0ge2xlZnQ6IDAsIHJpZ2h0OiAwLCB0b3A6IDAsIGJvdHRvbTogMH07XG5cbiAgZnVuY3Rpb24gbm9kZUFuZE9mZnNldEluTGluZU1hcChtYXAsIGNoLCBiaWFzKSB7XG4gICAgdmFyIG5vZGUsIHN0YXJ0LCBlbmQsIGNvbGxhcHNlO1xuICAgIC8vIEZpcnN0LCBzZWFyY2ggdGhlIGxpbmUgbWFwIGZvciB0aGUgdGV4dCBub2RlIGNvcnJlc3BvbmRpbmcgdG8sXG4gICAgLy8gb3IgY2xvc2VzdCB0bywgdGhlIHRhcmdldCBjaGFyYWN0ZXIuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXAubGVuZ3RoOyBpICs9IDMpIHtcbiAgICAgIHZhciBtU3RhcnQgPSBtYXBbaV0sIG1FbmQgPSBtYXBbaSArIDFdO1xuICAgICAgaWYgKGNoIDwgbVN0YXJ0KSB7XG4gICAgICAgIHN0YXJ0ID0gMDsgZW5kID0gMTtcbiAgICAgICAgY29sbGFwc2UgPSBcImxlZnRcIjtcbiAgICAgIH0gZWxzZSBpZiAoY2ggPCBtRW5kKSB7XG4gICAgICAgIHN0YXJ0ID0gY2ggLSBtU3RhcnQ7XG4gICAgICAgIGVuZCA9IHN0YXJ0ICsgMTtcbiAgICAgIH0gZWxzZSBpZiAoaSA9PSBtYXAubGVuZ3RoIC0gMyB8fCBjaCA9PSBtRW5kICYmIG1hcFtpICsgM10gPiBjaCkge1xuICAgICAgICBlbmQgPSBtRW5kIC0gbVN0YXJ0O1xuICAgICAgICBzdGFydCA9IGVuZCAtIDE7XG4gICAgICAgIGlmIChjaCA+PSBtRW5kKSBjb2xsYXBzZSA9IFwicmlnaHRcIjtcbiAgICAgIH1cbiAgICAgIGlmIChzdGFydCAhPSBudWxsKSB7XG4gICAgICAgIG5vZGUgPSBtYXBbaSArIDJdO1xuICAgICAgICBpZiAobVN0YXJ0ID09IG1FbmQgJiYgYmlhcyA9PSAobm9kZS5pbnNlcnRMZWZ0ID8gXCJsZWZ0XCIgOiBcInJpZ2h0XCIpKVxuICAgICAgICAgIGNvbGxhcHNlID0gYmlhcztcbiAgICAgICAgaWYgKGJpYXMgPT0gXCJsZWZ0XCIgJiYgc3RhcnQgPT0gMClcbiAgICAgICAgICB3aGlsZSAoaSAmJiBtYXBbaSAtIDJdID09IG1hcFtpIC0gM10gJiYgbWFwW2kgLSAxXS5pbnNlcnRMZWZ0KSB7XG4gICAgICAgICAgICBub2RlID0gbWFwWyhpIC09IDMpICsgMl07XG4gICAgICAgICAgICBjb2xsYXBzZSA9IFwibGVmdFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgaWYgKGJpYXMgPT0gXCJyaWdodFwiICYmIHN0YXJ0ID09IG1FbmQgLSBtU3RhcnQpXG4gICAgICAgICAgd2hpbGUgKGkgPCBtYXAubGVuZ3RoIC0gMyAmJiBtYXBbaSArIDNdID09IG1hcFtpICsgNF0gJiYgIW1hcFtpICsgNV0uaW5zZXJ0TGVmdCkge1xuICAgICAgICAgICAgbm9kZSA9IG1hcFsoaSArPSAzKSArIDJdO1xuICAgICAgICAgICAgY29sbGFwc2UgPSBcInJpZ2h0XCI7XG4gICAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtub2RlOiBub2RlLCBzdGFydDogc3RhcnQsIGVuZDogZW5kLCBjb2xsYXBzZTogY29sbGFwc2UsIGNvdmVyU3RhcnQ6IG1TdGFydCwgY292ZXJFbmQ6IG1FbmR9O1xuICB9XG5cbiAgZnVuY3Rpb24gbWVhc3VyZUNoYXJJbm5lcihjbSwgcHJlcGFyZWQsIGNoLCBiaWFzKSB7XG4gICAgdmFyIHBsYWNlID0gbm9kZUFuZE9mZnNldEluTGluZU1hcChwcmVwYXJlZC5tYXAsIGNoLCBiaWFzKTtcbiAgICB2YXIgbm9kZSA9IHBsYWNlLm5vZGUsIHN0YXJ0ID0gcGxhY2Uuc3RhcnQsIGVuZCA9IHBsYWNlLmVuZCwgY29sbGFwc2UgPSBwbGFjZS5jb2xsYXBzZTtcblxuICAgIHZhciByZWN0O1xuICAgIGlmIChub2RlLm5vZGVUeXBlID09IDMpIHsgLy8gSWYgaXQgaXMgYSB0ZXh0IG5vZGUsIHVzZSBhIHJhbmdlIHRvIHJldHJpZXZlIHRoZSBjb29yZGluYXRlcy5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7IC8vIFJldHJ5IGEgbWF4aW11bSBvZiA0IHRpbWVzIHdoZW4gbm9uc2Vuc2UgcmVjdGFuZ2xlcyBhcmUgcmV0dXJuZWRcbiAgICAgICAgd2hpbGUgKHN0YXJ0ICYmIGlzRXh0ZW5kaW5nQ2hhcihwcmVwYXJlZC5saW5lLnRleHQuY2hhckF0KHBsYWNlLmNvdmVyU3RhcnQgKyBzdGFydCkpKSAtLXN0YXJ0O1xuICAgICAgICB3aGlsZSAocGxhY2UuY292ZXJTdGFydCArIGVuZCA8IHBsYWNlLmNvdmVyRW5kICYmIGlzRXh0ZW5kaW5nQ2hhcihwcmVwYXJlZC5saW5lLnRleHQuY2hhckF0KHBsYWNlLmNvdmVyU3RhcnQgKyBlbmQpKSkgKytlbmQ7XG4gICAgICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgOSAmJiBzdGFydCA9PSAwICYmIGVuZCA9PSBwbGFjZS5jb3ZlckVuZCAtIHBsYWNlLmNvdmVyU3RhcnQpIHtcbiAgICAgICAgICByZWN0ID0gbm9kZS5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB9IGVsc2UgaWYgKGllICYmIGNtLm9wdGlvbnMubGluZVdyYXBwaW5nKSB7XG4gICAgICAgICAgdmFyIHJlY3RzID0gcmFuZ2Uobm9kZSwgc3RhcnQsIGVuZCkuZ2V0Q2xpZW50UmVjdHMoKTtcbiAgICAgICAgICBpZiAocmVjdHMubGVuZ3RoKVxuICAgICAgICAgICAgcmVjdCA9IHJlY3RzW2JpYXMgPT0gXCJyaWdodFwiID8gcmVjdHMubGVuZ3RoIC0gMSA6IDBdO1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJlY3QgPSBudWxsUmVjdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWN0ID0gcmFuZ2Uobm9kZSwgc3RhcnQsIGVuZCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgfHwgbnVsbFJlY3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlY3QubGVmdCB8fCByZWN0LnJpZ2h0IHx8IHN0YXJ0ID09IDApIGJyZWFrO1xuICAgICAgICBlbmQgPSBzdGFydDtcbiAgICAgICAgc3RhcnQgPSBzdGFydCAtIDE7XG4gICAgICAgIGNvbGxhcHNlID0gXCJyaWdodFwiO1xuICAgICAgfVxuICAgICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCAxMSkgcmVjdCA9IG1heWJlVXBkYXRlUmVjdEZvclpvb21pbmcoY20uZGlzcGxheS5tZWFzdXJlLCByZWN0KTtcbiAgICB9IGVsc2UgeyAvLyBJZiBpdCBpcyBhIHdpZGdldCwgc2ltcGx5IGdldCB0aGUgYm94IGZvciB0aGUgd2hvbGUgd2lkZ2V0LlxuICAgICAgaWYgKHN0YXJ0ID4gMCkgY29sbGFwc2UgPSBiaWFzID0gXCJyaWdodFwiO1xuICAgICAgdmFyIHJlY3RzO1xuICAgICAgaWYgKGNtLm9wdGlvbnMubGluZVdyYXBwaW5nICYmIChyZWN0cyA9IG5vZGUuZ2V0Q2xpZW50UmVjdHMoKSkubGVuZ3RoID4gMSlcbiAgICAgICAgcmVjdCA9IHJlY3RzW2JpYXMgPT0gXCJyaWdodFwiID8gcmVjdHMubGVuZ3RoIC0gMSA6IDBdO1xuICAgICAgZWxzZVxuICAgICAgICByZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB9XG4gICAgaWYgKGllICYmIGllX3ZlcnNpb24gPCA5ICYmICFzdGFydCAmJiAoIXJlY3QgfHwgIXJlY3QubGVmdCAmJiAhcmVjdC5yaWdodCkpIHtcbiAgICAgIHZhciByU3BhbiA9IG5vZGUucGFyZW50Tm9kZS5nZXRDbGllbnRSZWN0cygpWzBdO1xuICAgICAgaWYgKHJTcGFuKVxuICAgICAgICByZWN0ID0ge2xlZnQ6IHJTcGFuLmxlZnQsIHJpZ2h0OiByU3Bhbi5sZWZ0ICsgY2hhcldpZHRoKGNtLmRpc3BsYXkpLCB0b3A6IHJTcGFuLnRvcCwgYm90dG9tOiByU3Bhbi5ib3R0b219O1xuICAgICAgZWxzZVxuICAgICAgICByZWN0ID0gbnVsbFJlY3Q7XG4gICAgfVxuXG4gICAgdmFyIHJ0b3AgPSByZWN0LnRvcCAtIHByZXBhcmVkLnJlY3QudG9wLCByYm90ID0gcmVjdC5ib3R0b20gLSBwcmVwYXJlZC5yZWN0LnRvcDtcbiAgICB2YXIgbWlkID0gKHJ0b3AgKyByYm90KSAvIDI7XG4gICAgdmFyIGhlaWdodHMgPSBwcmVwYXJlZC52aWV3Lm1lYXN1cmUuaGVpZ2h0cztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlaWdodHMubGVuZ3RoIC0gMTsgaSsrKVxuICAgICAgaWYgKG1pZCA8IGhlaWdodHNbaV0pIGJyZWFrO1xuICAgIHZhciB0b3AgPSBpID8gaGVpZ2h0c1tpIC0gMV0gOiAwLCBib3QgPSBoZWlnaHRzW2ldO1xuICAgIHZhciByZXN1bHQgPSB7bGVmdDogKGNvbGxhcHNlID09IFwicmlnaHRcIiA/IHJlY3QucmlnaHQgOiByZWN0LmxlZnQpIC0gcHJlcGFyZWQucmVjdC5sZWZ0LFxuICAgICAgICAgICAgICAgICAgcmlnaHQ6IChjb2xsYXBzZSA9PSBcImxlZnRcIiA/IHJlY3QubGVmdCA6IHJlY3QucmlnaHQpIC0gcHJlcGFyZWQucmVjdC5sZWZ0LFxuICAgICAgICAgICAgICAgICAgdG9wOiB0b3AsIGJvdHRvbTogYm90fTtcbiAgICBpZiAoIXJlY3QubGVmdCAmJiAhcmVjdC5yaWdodCkgcmVzdWx0LmJvZ3VzID0gdHJ1ZTtcbiAgICBpZiAoIWNtLm9wdGlvbnMuc2luZ2xlQ3Vyc29ySGVpZ2h0UGVyTGluZSkgeyByZXN1bHQucnRvcCA9IHJ0b3A7IHJlc3VsdC5yYm90dG9tID0gcmJvdDsgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vIFdvcmsgYXJvdW5kIHByb2JsZW0gd2l0aCBib3VuZGluZyBjbGllbnQgcmVjdHMgb24gcmFuZ2VzIGJlaW5nXG4gIC8vIHJldHVybmVkIGluY29ycmVjdGx5IHdoZW4gem9vbWVkIG9uIElFMTAgYW5kIGJlbG93LlxuICBmdW5jdGlvbiBtYXliZVVwZGF0ZVJlY3RGb3Jab29taW5nKG1lYXN1cmUsIHJlY3QpIHtcbiAgICBpZiAoIXdpbmRvdy5zY3JlZW4gfHwgc2NyZWVuLmxvZ2ljYWxYRFBJID09IG51bGwgfHxcbiAgICAgICAgc2NyZWVuLmxvZ2ljYWxYRFBJID09IHNjcmVlbi5kZXZpY2VYRFBJIHx8ICFoYXNCYWRab29tZWRSZWN0cyhtZWFzdXJlKSlcbiAgICAgIHJldHVybiByZWN0O1xuICAgIHZhciBzY2FsZVggPSBzY3JlZW4ubG9naWNhbFhEUEkgLyBzY3JlZW4uZGV2aWNlWERQSTtcbiAgICB2YXIgc2NhbGVZID0gc2NyZWVuLmxvZ2ljYWxZRFBJIC8gc2NyZWVuLmRldmljZVlEUEk7XG4gICAgcmV0dXJuIHtsZWZ0OiByZWN0LmxlZnQgKiBzY2FsZVgsIHJpZ2h0OiByZWN0LnJpZ2h0ICogc2NhbGVYLFxuICAgICAgICAgICAgdG9wOiByZWN0LnRvcCAqIHNjYWxlWSwgYm90dG9tOiByZWN0LmJvdHRvbSAqIHNjYWxlWX07XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlRm9yKGxpbmVWaWV3KSB7XG4gICAgaWYgKGxpbmVWaWV3Lm1lYXN1cmUpIHtcbiAgICAgIGxpbmVWaWV3Lm1lYXN1cmUuY2FjaGUgPSB7fTtcbiAgICAgIGxpbmVWaWV3Lm1lYXN1cmUuaGVpZ2h0cyA9IG51bGw7XG4gICAgICBpZiAobGluZVZpZXcucmVzdCkgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lVmlldy5yZXN0Lmxlbmd0aDsgaSsrKVxuICAgICAgICBsaW5lVmlldy5tZWFzdXJlLmNhY2hlc1tpXSA9IHt9O1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGUoY20pIHtcbiAgICBjbS5kaXNwbGF5LmV4dGVybmFsTWVhc3VyZSA9IG51bGw7XG4gICAgcmVtb3ZlQ2hpbGRyZW4oY20uZGlzcGxheS5saW5lTWVhc3VyZSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbS5kaXNwbGF5LnZpZXcubGVuZ3RoOyBpKyspXG4gICAgICBjbGVhckxpbmVNZWFzdXJlbWVudENhY2hlRm9yKGNtLmRpc3BsYXkudmlld1tpXSk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhckNhY2hlcyhjbSkge1xuICAgIGNsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGUoY20pO1xuICAgIGNtLmRpc3BsYXkuY2FjaGVkQ2hhcldpZHRoID0gY20uZGlzcGxheS5jYWNoZWRUZXh0SGVpZ2h0ID0gY20uZGlzcGxheS5jYWNoZWRQYWRkaW5nSCA9IG51bGw7XG4gICAgaWYgKCFjbS5vcHRpb25zLmxpbmVXcmFwcGluZykgY20uZGlzcGxheS5tYXhMaW5lQ2hhbmdlZCA9IHRydWU7XG4gICAgY20uZGlzcGxheS5saW5lTnVtQ2hhcnMgPSBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gcGFnZVNjcm9sbFgoKSB7IHJldHVybiB3aW5kb3cucGFnZVhPZmZzZXQgfHwgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCB8fCBkb2N1bWVudC5ib2R5KS5zY3JvbGxMZWZ0OyB9XG4gIGZ1bmN0aW9uIHBhZ2VTY3JvbGxZKCkgeyByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwgZG9jdW1lbnQuYm9keSkuc2Nyb2xsVG9wOyB9XG5cbiAgLy8gQ29udmVydHMgYSB7dG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0fSBib3ggZnJvbSBsaW5lLWxvY2FsXG4gIC8vIGNvb3JkaW5hdGVzIGludG8gYW5vdGhlciBjb29yZGluYXRlIHN5c3RlbS4gQ29udGV4dCBtYXkgYmUgb25lIG9mXG4gIC8vIFwibGluZVwiLCBcImRpdlwiIChkaXNwbGF5LmxpbmVEaXYpLCBcImxvY2FsXCIvbnVsbCAoZWRpdG9yKSwgXCJ3aW5kb3dcIixcbiAgLy8gb3IgXCJwYWdlXCIuXG4gIGZ1bmN0aW9uIGludG9Db29yZFN5c3RlbShjbSwgbGluZU9iaiwgcmVjdCwgY29udGV4dCkge1xuICAgIGlmIChsaW5lT2JqLndpZGdldHMpIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZU9iai53aWRnZXRzLmxlbmd0aDsgKytpKSBpZiAobGluZU9iai53aWRnZXRzW2ldLmFib3ZlKSB7XG4gICAgICB2YXIgc2l6ZSA9IHdpZGdldEhlaWdodChsaW5lT2JqLndpZGdldHNbaV0pO1xuICAgICAgcmVjdC50b3AgKz0gc2l6ZTsgcmVjdC5ib3R0b20gKz0gc2l6ZTtcbiAgICB9XG4gICAgaWYgKGNvbnRleHQgPT0gXCJsaW5lXCIpIHJldHVybiByZWN0O1xuICAgIGlmICghY29udGV4dCkgY29udGV4dCA9IFwibG9jYWxcIjtcbiAgICB2YXIgeU9mZiA9IGhlaWdodEF0TGluZShsaW5lT2JqKTtcbiAgICBpZiAoY29udGV4dCA9PSBcImxvY2FsXCIpIHlPZmYgKz0gcGFkZGluZ1RvcChjbS5kaXNwbGF5KTtcbiAgICBlbHNlIHlPZmYgLT0gY20uZGlzcGxheS52aWV3T2Zmc2V0O1xuICAgIGlmIChjb250ZXh0ID09IFwicGFnZVwiIHx8IGNvbnRleHQgPT0gXCJ3aW5kb3dcIikge1xuICAgICAgdmFyIGxPZmYgPSBjbS5kaXNwbGF5LmxpbmVTcGFjZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIHlPZmYgKz0gbE9mZi50b3AgKyAoY29udGV4dCA9PSBcIndpbmRvd1wiID8gMCA6IHBhZ2VTY3JvbGxZKCkpO1xuICAgICAgdmFyIHhPZmYgPSBsT2ZmLmxlZnQgKyAoY29udGV4dCA9PSBcIndpbmRvd1wiID8gMCA6IHBhZ2VTY3JvbGxYKCkpO1xuICAgICAgcmVjdC5sZWZ0ICs9IHhPZmY7IHJlY3QucmlnaHQgKz0geE9mZjtcbiAgICB9XG4gICAgcmVjdC50b3AgKz0geU9mZjsgcmVjdC5ib3R0b20gKz0geU9mZjtcbiAgICByZXR1cm4gcmVjdDtcbiAgfVxuXG4gIC8vIENvdmVydHMgYSBib3ggZnJvbSBcImRpdlwiIGNvb3JkcyB0byBhbm90aGVyIGNvb3JkaW5hdGUgc3lzdGVtLlxuICAvLyBDb250ZXh0IG1heSBiZSBcIndpbmRvd1wiLCBcInBhZ2VcIiwgXCJkaXZcIiwgb3IgXCJsb2NhbFwiL251bGwuXG4gIGZ1bmN0aW9uIGZyb21Db29yZFN5c3RlbShjbSwgY29vcmRzLCBjb250ZXh0KSB7XG4gICAgaWYgKGNvbnRleHQgPT0gXCJkaXZcIikgcmV0dXJuIGNvb3JkcztcbiAgICB2YXIgbGVmdCA9IGNvb3Jkcy5sZWZ0LCB0b3AgPSBjb29yZHMudG9wO1xuICAgIC8vIEZpcnN0IG1vdmUgaW50byBcInBhZ2VcIiBjb29yZGluYXRlIHN5c3RlbVxuICAgIGlmIChjb250ZXh0ID09IFwicGFnZVwiKSB7XG4gICAgICBsZWZ0IC09IHBhZ2VTY3JvbGxYKCk7XG4gICAgICB0b3AgLT0gcGFnZVNjcm9sbFkoKTtcbiAgICB9IGVsc2UgaWYgKGNvbnRleHQgPT0gXCJsb2NhbFwiIHx8ICFjb250ZXh0KSB7XG4gICAgICB2YXIgbG9jYWxCb3ggPSBjbS5kaXNwbGF5LnNpemVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgbGVmdCArPSBsb2NhbEJveC5sZWZ0O1xuICAgICAgdG9wICs9IGxvY2FsQm94LnRvcDtcbiAgICB9XG5cbiAgICB2YXIgbGluZVNwYWNlQm94ID0gY20uZGlzcGxheS5saW5lU3BhY2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHtsZWZ0OiBsZWZ0IC0gbGluZVNwYWNlQm94LmxlZnQsIHRvcDogdG9wIC0gbGluZVNwYWNlQm94LnRvcH07XG4gIH1cblxuICBmdW5jdGlvbiBjaGFyQ29vcmRzKGNtLCBwb3MsIGNvbnRleHQsIGxpbmVPYmosIGJpYXMpIHtcbiAgICBpZiAoIWxpbmVPYmopIGxpbmVPYmogPSBnZXRMaW5lKGNtLmRvYywgcG9zLmxpbmUpO1xuICAgIHJldHVybiBpbnRvQ29vcmRTeXN0ZW0oY20sIGxpbmVPYmosIG1lYXN1cmVDaGFyKGNtLCBsaW5lT2JqLCBwb3MuY2gsIGJpYXMpLCBjb250ZXh0KTtcbiAgfVxuXG4gIC8vIFJldHVybnMgYSBib3ggZm9yIGEgZ2l2ZW4gY3Vyc29yIHBvc2l0aW9uLCB3aGljaCBtYXkgaGF2ZSBhblxuICAvLyAnb3RoZXInIHByb3BlcnR5IGNvbnRhaW5pbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBzZWNvbmRhcnkgY3Vyc29yXG4gIC8vIG9uIGEgYmlkaSBib3VuZGFyeS5cbiAgZnVuY3Rpb24gY3Vyc29yQ29vcmRzKGNtLCBwb3MsIGNvbnRleHQsIGxpbmVPYmosIHByZXBhcmVkTWVhc3VyZSwgdmFySGVpZ2h0KSB7XG4gICAgbGluZU9iaiA9IGxpbmVPYmogfHwgZ2V0TGluZShjbS5kb2MsIHBvcy5saW5lKTtcbiAgICBpZiAoIXByZXBhcmVkTWVhc3VyZSkgcHJlcGFyZWRNZWFzdXJlID0gcHJlcGFyZU1lYXN1cmVGb3JMaW5lKGNtLCBsaW5lT2JqKTtcbiAgICBmdW5jdGlvbiBnZXQoY2gsIHJpZ2h0KSB7XG4gICAgICB2YXIgbSA9IG1lYXN1cmVDaGFyUHJlcGFyZWQoY20sIHByZXBhcmVkTWVhc3VyZSwgY2gsIHJpZ2h0ID8gXCJyaWdodFwiIDogXCJsZWZ0XCIsIHZhckhlaWdodCk7XG4gICAgICBpZiAocmlnaHQpIG0ubGVmdCA9IG0ucmlnaHQ7IGVsc2UgbS5yaWdodCA9IG0ubGVmdDtcbiAgICAgIHJldHVybiBpbnRvQ29vcmRTeXN0ZW0oY20sIGxpbmVPYmosIG0sIGNvbnRleHQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRCaWRpKGNoLCBwYXJ0UG9zKSB7XG4gICAgICB2YXIgcGFydCA9IG9yZGVyW3BhcnRQb3NdLCByaWdodCA9IHBhcnQubGV2ZWwgJSAyO1xuICAgICAgaWYgKGNoID09IGJpZGlMZWZ0KHBhcnQpICYmIHBhcnRQb3MgJiYgcGFydC5sZXZlbCA8IG9yZGVyW3BhcnRQb3MgLSAxXS5sZXZlbCkge1xuICAgICAgICBwYXJ0ID0gb3JkZXJbLS1wYXJ0UG9zXTtcbiAgICAgICAgY2ggPSBiaWRpUmlnaHQocGFydCkgLSAocGFydC5sZXZlbCAlIDIgPyAwIDogMSk7XG4gICAgICAgIHJpZ2h0ID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAoY2ggPT0gYmlkaVJpZ2h0KHBhcnQpICYmIHBhcnRQb3MgPCBvcmRlci5sZW5ndGggLSAxICYmIHBhcnQubGV2ZWwgPCBvcmRlcltwYXJ0UG9zICsgMV0ubGV2ZWwpIHtcbiAgICAgICAgcGFydCA9IG9yZGVyWysrcGFydFBvc107XG4gICAgICAgIGNoID0gYmlkaUxlZnQocGFydCkgLSBwYXJ0LmxldmVsICUgMjtcbiAgICAgICAgcmlnaHQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChyaWdodCAmJiBjaCA9PSBwYXJ0LnRvICYmIGNoID4gcGFydC5mcm9tKSByZXR1cm4gZ2V0KGNoIC0gMSk7XG4gICAgICByZXR1cm4gZ2V0KGNoLCByaWdodCk7XG4gICAgfVxuICAgIHZhciBvcmRlciA9IGdldE9yZGVyKGxpbmVPYmopLCBjaCA9IHBvcy5jaDtcbiAgICBpZiAoIW9yZGVyKSByZXR1cm4gZ2V0KGNoKTtcbiAgICB2YXIgcGFydFBvcyA9IGdldEJpZGlQYXJ0QXQob3JkZXIsIGNoKTtcbiAgICB2YXIgdmFsID0gZ2V0QmlkaShjaCwgcGFydFBvcyk7XG4gICAgaWYgKGJpZGlPdGhlciAhPSBudWxsKSB2YWwub3RoZXIgPSBnZXRCaWRpKGNoLCBiaWRpT3RoZXIpO1xuICAgIHJldHVybiB2YWw7XG4gIH1cblxuICAvLyBVc2VkIHRvIGNoZWFwbHkgZXN0aW1hdGUgdGhlIGNvb3JkaW5hdGVzIGZvciBhIHBvc2l0aW9uLiBVc2VkIGZvclxuICAvLyBpbnRlcm1lZGlhdGUgc2Nyb2xsIHVwZGF0ZXMuXG4gIGZ1bmN0aW9uIGVzdGltYXRlQ29vcmRzKGNtLCBwb3MpIHtcbiAgICB2YXIgbGVmdCA9IDAsIHBvcyA9IGNsaXBQb3MoY20uZG9jLCBwb3MpO1xuICAgIGlmICghY20ub3B0aW9ucy5saW5lV3JhcHBpbmcpIGxlZnQgPSBjaGFyV2lkdGgoY20uZGlzcGxheSkgKiBwb3MuY2g7XG4gICAgdmFyIGxpbmVPYmogPSBnZXRMaW5lKGNtLmRvYywgcG9zLmxpbmUpO1xuICAgIHZhciB0b3AgPSBoZWlnaHRBdExpbmUobGluZU9iaikgKyBwYWRkaW5nVG9wKGNtLmRpc3BsYXkpO1xuICAgIHJldHVybiB7bGVmdDogbGVmdCwgcmlnaHQ6IGxlZnQsIHRvcDogdG9wLCBib3R0b206IHRvcCArIGxpbmVPYmouaGVpZ2h0fTtcbiAgfVxuXG4gIC8vIFBvc2l0aW9ucyByZXR1cm5lZCBieSBjb29yZHNDaGFyIGNvbnRhaW4gc29tZSBleHRyYSBpbmZvcm1hdGlvbi5cbiAgLy8geFJlbCBpcyB0aGUgcmVsYXRpdmUgeCBwb3NpdGlvbiBvZiB0aGUgaW5wdXQgY29vcmRpbmF0ZXMgY29tcGFyZWRcbiAgLy8gdG8gdGhlIGZvdW5kIHBvc2l0aW9uIChzbyB4UmVsID4gMCBtZWFucyB0aGUgY29vcmRpbmF0ZXMgYXJlIHRvXG4gIC8vIHRoZSByaWdodCBvZiB0aGUgY2hhcmFjdGVyIHBvc2l0aW9uLCBmb3IgZXhhbXBsZSkuIFdoZW4gb3V0c2lkZVxuICAvLyBpcyB0cnVlLCB0aGF0IG1lYW5zIHRoZSBjb29yZGluYXRlcyBsaWUgb3V0c2lkZSB0aGUgbGluZSdzXG4gIC8vIHZlcnRpY2FsIHJhbmdlLlxuICBmdW5jdGlvbiBQb3NXaXRoSW5mbyhsaW5lLCBjaCwgb3V0c2lkZSwgeFJlbCkge1xuICAgIHZhciBwb3MgPSBQb3MobGluZSwgY2gpO1xuICAgIHBvcy54UmVsID0geFJlbDtcbiAgICBpZiAob3V0c2lkZSkgcG9zLm91dHNpZGUgPSB0cnVlO1xuICAgIHJldHVybiBwb3M7XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSBjaGFyYWN0ZXIgcG9zaXRpb24gY2xvc2VzdCB0byB0aGUgZ2l2ZW4gY29vcmRpbmF0ZXMuXG4gIC8vIElucHV0IG11c3QgYmUgbGluZVNwYWNlLWxvY2FsIChcImRpdlwiIGNvb3JkaW5hdGUgc3lzdGVtKS5cbiAgZnVuY3Rpb24gY29vcmRzQ2hhcihjbSwgeCwgeSkge1xuICAgIHZhciBkb2MgPSBjbS5kb2M7XG4gICAgeSArPSBjbS5kaXNwbGF5LnZpZXdPZmZzZXQ7XG4gICAgaWYgKHkgPCAwKSByZXR1cm4gUG9zV2l0aEluZm8oZG9jLmZpcnN0LCAwLCB0cnVlLCAtMSk7XG4gICAgdmFyIGxpbmVOID0gbGluZUF0SGVpZ2h0KGRvYywgeSksIGxhc3QgPSBkb2MuZmlyc3QgKyBkb2Muc2l6ZSAtIDE7XG4gICAgaWYgKGxpbmVOID4gbGFzdClcbiAgICAgIHJldHVybiBQb3NXaXRoSW5mbyhkb2MuZmlyc3QgKyBkb2Muc2l6ZSAtIDEsIGdldExpbmUoZG9jLCBsYXN0KS50ZXh0Lmxlbmd0aCwgdHJ1ZSwgMSk7XG4gICAgaWYgKHggPCAwKSB4ID0gMDtcblxuICAgIHZhciBsaW5lT2JqID0gZ2V0TGluZShkb2MsIGxpbmVOKTtcbiAgICBmb3IgKDs7KSB7XG4gICAgICB2YXIgZm91bmQgPSBjb29yZHNDaGFySW5uZXIoY20sIGxpbmVPYmosIGxpbmVOLCB4LCB5KTtcbiAgICAgIHZhciBtZXJnZWQgPSBjb2xsYXBzZWRTcGFuQXRFbmQobGluZU9iaik7XG4gICAgICB2YXIgbWVyZ2VkUG9zID0gbWVyZ2VkICYmIG1lcmdlZC5maW5kKDAsIHRydWUpO1xuICAgICAgaWYgKG1lcmdlZCAmJiAoZm91bmQuY2ggPiBtZXJnZWRQb3MuZnJvbS5jaCB8fCBmb3VuZC5jaCA9PSBtZXJnZWRQb3MuZnJvbS5jaCAmJiBmb3VuZC54UmVsID4gMCkpXG4gICAgICAgIGxpbmVOID0gbGluZU5vKGxpbmVPYmogPSBtZXJnZWRQb3MudG8ubGluZSk7XG4gICAgICBlbHNlXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjb29yZHNDaGFySW5uZXIoY20sIGxpbmVPYmosIGxpbmVObywgeCwgeSkge1xuICAgIHZhciBpbm5lck9mZiA9IHkgLSBoZWlnaHRBdExpbmUobGluZU9iaik7XG4gICAgdmFyIHdyb25nTGluZSA9IGZhbHNlLCBhZGp1c3QgPSAyICogY20uZGlzcGxheS53cmFwcGVyLmNsaWVudFdpZHRoO1xuICAgIHZhciBwcmVwYXJlZE1lYXN1cmUgPSBwcmVwYXJlTWVhc3VyZUZvckxpbmUoY20sIGxpbmVPYmopO1xuXG4gICAgZnVuY3Rpb24gZ2V0WChjaCkge1xuICAgICAgdmFyIHNwID0gY3Vyc29yQ29vcmRzKGNtLCBQb3MobGluZU5vLCBjaCksIFwibGluZVwiLCBsaW5lT2JqLCBwcmVwYXJlZE1lYXN1cmUpO1xuICAgICAgd3JvbmdMaW5lID0gdHJ1ZTtcbiAgICAgIGlmIChpbm5lck9mZiA+IHNwLmJvdHRvbSkgcmV0dXJuIHNwLmxlZnQgLSBhZGp1c3Q7XG4gICAgICBlbHNlIGlmIChpbm5lck9mZiA8IHNwLnRvcCkgcmV0dXJuIHNwLmxlZnQgKyBhZGp1c3Q7XG4gICAgICBlbHNlIHdyb25nTGluZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuIHNwLmxlZnQ7XG4gICAgfVxuXG4gICAgdmFyIGJpZGkgPSBnZXRPcmRlcihsaW5lT2JqKSwgZGlzdCA9IGxpbmVPYmoudGV4dC5sZW5ndGg7XG4gICAgdmFyIGZyb20gPSBsaW5lTGVmdChsaW5lT2JqKSwgdG8gPSBsaW5lUmlnaHQobGluZU9iaik7XG4gICAgdmFyIGZyb21YID0gZ2V0WChmcm9tKSwgZnJvbU91dHNpZGUgPSB3cm9uZ0xpbmUsIHRvWCA9IGdldFgodG8pLCB0b091dHNpZGUgPSB3cm9uZ0xpbmU7XG5cbiAgICBpZiAoeCA+IHRvWCkgcmV0dXJuIFBvc1dpdGhJbmZvKGxpbmVObywgdG8sIHRvT3V0c2lkZSwgMSk7XG4gICAgLy8gRG8gYSBiaW5hcnkgc2VhcmNoIGJldHdlZW4gdGhlc2UgYm91bmRzLlxuICAgIGZvciAoOzspIHtcbiAgICAgIGlmIChiaWRpID8gdG8gPT0gZnJvbSB8fCB0byA9PSBtb3ZlVmlzdWFsbHkobGluZU9iaiwgZnJvbSwgMSkgOiB0byAtIGZyb20gPD0gMSkge1xuICAgICAgICB2YXIgY2ggPSB4IDwgZnJvbVggfHwgeCAtIGZyb21YIDw9IHRvWCAtIHggPyBmcm9tIDogdG87XG4gICAgICAgIHZhciB4RGlmZiA9IHggLSAoY2ggPT0gZnJvbSA/IGZyb21YIDogdG9YKTtcbiAgICAgICAgd2hpbGUgKGlzRXh0ZW5kaW5nQ2hhcihsaW5lT2JqLnRleHQuY2hhckF0KGNoKSkpICsrY2g7XG4gICAgICAgIHZhciBwb3MgPSBQb3NXaXRoSW5mbyhsaW5lTm8sIGNoLCBjaCA9PSBmcm9tID8gZnJvbU91dHNpZGUgOiB0b091dHNpZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4RGlmZiA8IC0xID8gLTEgOiB4RGlmZiA+IDEgPyAxIDogMCk7XG4gICAgICAgIHJldHVybiBwb3M7XG4gICAgICB9XG4gICAgICB2YXIgc3RlcCA9IE1hdGguY2VpbChkaXN0IC8gMiksIG1pZGRsZSA9IGZyb20gKyBzdGVwO1xuICAgICAgaWYgKGJpZGkpIHtcbiAgICAgICAgbWlkZGxlID0gZnJvbTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGVwOyArK2kpIG1pZGRsZSA9IG1vdmVWaXN1YWxseShsaW5lT2JqLCBtaWRkbGUsIDEpO1xuICAgICAgfVxuICAgICAgdmFyIG1pZGRsZVggPSBnZXRYKG1pZGRsZSk7XG4gICAgICBpZiAobWlkZGxlWCA+IHgpIHt0byA9IG1pZGRsZTsgdG9YID0gbWlkZGxlWDsgaWYgKHRvT3V0c2lkZSA9IHdyb25nTGluZSkgdG9YICs9IDEwMDA7IGRpc3QgPSBzdGVwO31cbiAgICAgIGVsc2Uge2Zyb20gPSBtaWRkbGU7IGZyb21YID0gbWlkZGxlWDsgZnJvbU91dHNpZGUgPSB3cm9uZ0xpbmU7IGRpc3QgLT0gc3RlcDt9XG4gICAgfVxuICB9XG5cbiAgdmFyIG1lYXN1cmVUZXh0O1xuICAvLyBDb21wdXRlIHRoZSBkZWZhdWx0IHRleHQgaGVpZ2h0LlxuICBmdW5jdGlvbiB0ZXh0SGVpZ2h0KGRpc3BsYXkpIHtcbiAgICBpZiAoZGlzcGxheS5jYWNoZWRUZXh0SGVpZ2h0ICE9IG51bGwpIHJldHVybiBkaXNwbGF5LmNhY2hlZFRleHRIZWlnaHQ7XG4gICAgaWYgKG1lYXN1cmVUZXh0ID09IG51bGwpIHtcbiAgICAgIG1lYXN1cmVUZXh0ID0gZWx0KFwicHJlXCIpO1xuICAgICAgLy8gTWVhc3VyZSBhIGJ1bmNoIG9mIGxpbmVzLCBmb3IgYnJvd3NlcnMgdGhhdCBjb21wdXRlXG4gICAgICAvLyBmcmFjdGlvbmFsIGhlaWdodHMuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ5OyArK2kpIHtcbiAgICAgICAgbWVhc3VyZVRleHQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJ4XCIpKTtcbiAgICAgICAgbWVhc3VyZVRleHQuYXBwZW5kQ2hpbGQoZWx0KFwiYnJcIikpO1xuICAgICAgfVxuICAgICAgbWVhc3VyZVRleHQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJ4XCIpKTtcbiAgICB9XG4gICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQoZGlzcGxheS5tZWFzdXJlLCBtZWFzdXJlVGV4dCk7XG4gICAgdmFyIGhlaWdodCA9IG1lYXN1cmVUZXh0Lm9mZnNldEhlaWdodCAvIDUwO1xuICAgIGlmIChoZWlnaHQgPiAzKSBkaXNwbGF5LmNhY2hlZFRleHRIZWlnaHQgPSBoZWlnaHQ7XG4gICAgcmVtb3ZlQ2hpbGRyZW4oZGlzcGxheS5tZWFzdXJlKTtcbiAgICByZXR1cm4gaGVpZ2h0IHx8IDE7XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSBkZWZhdWx0IGNoYXJhY3RlciB3aWR0aC5cbiAgZnVuY3Rpb24gY2hhcldpZHRoKGRpc3BsYXkpIHtcbiAgICBpZiAoZGlzcGxheS5jYWNoZWRDaGFyV2lkdGggIT0gbnVsbCkgcmV0dXJuIGRpc3BsYXkuY2FjaGVkQ2hhcldpZHRoO1xuICAgIHZhciBhbmNob3IgPSBlbHQoXCJzcGFuXCIsIFwieHh4eHh4eHh4eFwiKTtcbiAgICB2YXIgcHJlID0gZWx0KFwicHJlXCIsIFthbmNob3JdKTtcbiAgICByZW1vdmVDaGlsZHJlbkFuZEFkZChkaXNwbGF5Lm1lYXN1cmUsIHByZSk7XG4gICAgdmFyIHJlY3QgPSBhbmNob3IuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIHdpZHRoID0gKHJlY3QucmlnaHQgLSByZWN0LmxlZnQpIC8gMTA7XG4gICAgaWYgKHdpZHRoID4gMikgZGlzcGxheS5jYWNoZWRDaGFyV2lkdGggPSB3aWR0aDtcbiAgICByZXR1cm4gd2lkdGggfHwgMTA7XG4gIH1cblxuICAvLyBPUEVSQVRJT05TXG5cbiAgLy8gT3BlcmF0aW9ucyBhcmUgdXNlZCB0byB3cmFwIGEgc2VyaWVzIG9mIGNoYW5nZXMgdG8gdGhlIGVkaXRvclxuICAvLyBzdGF0ZSBpbiBzdWNoIGEgd2F5IHRoYXQgZWFjaCBjaGFuZ2Ugd29uJ3QgaGF2ZSB0byB1cGRhdGUgdGhlXG4gIC8vIGN1cnNvciBhbmQgZGlzcGxheSAod2hpY2ggd291bGQgYmUgYXdrd2FyZCwgc2xvdywgYW5kXG4gIC8vIGVycm9yLXByb25lKS4gSW5zdGVhZCwgZGlzcGxheSB1cGRhdGVzIGFyZSBiYXRjaGVkIGFuZCB0aGVuIGFsbFxuICAvLyBjb21iaW5lZCBhbmQgZXhlY3V0ZWQgYXQgb25jZS5cblxuICB2YXIgb3BlcmF0aW9uR3JvdXAgPSBudWxsO1xuXG4gIHZhciBuZXh0T3BJZCA9IDA7XG4gIC8vIFN0YXJ0IGEgbmV3IG9wZXJhdGlvbi5cbiAgZnVuY3Rpb24gc3RhcnRPcGVyYXRpb24oY20pIHtcbiAgICBjbS5jdXJPcCA9IHtcbiAgICAgIGNtOiBjbSxcbiAgICAgIHZpZXdDaGFuZ2VkOiBmYWxzZSwgICAgICAvLyBGbGFnIHRoYXQgaW5kaWNhdGVzIHRoYXQgbGluZXMgbWlnaHQgbmVlZCB0byBiZSByZWRyYXduXG4gICAgICBzdGFydEhlaWdodDogY20uZG9jLmhlaWdodCwgLy8gVXNlZCB0byBkZXRlY3QgbmVlZCB0byB1cGRhdGUgc2Nyb2xsYmFyXG4gICAgICBmb3JjZVVwZGF0ZTogZmFsc2UsICAgICAgLy8gVXNlZCB0byBmb3JjZSBhIHJlZHJhd1xuICAgICAgdXBkYXRlSW5wdXQ6IG51bGwsICAgICAgIC8vIFdoZXRoZXIgdG8gcmVzZXQgdGhlIGlucHV0IHRleHRhcmVhXG4gICAgICB0eXBpbmc6IGZhbHNlLCAgICAgICAgICAgLy8gV2hldGhlciB0aGlzIHJlc2V0IHNob3VsZCBiZSBjYXJlZnVsIHRvIGxlYXZlIGV4aXN0aW5nIHRleHQgKGZvciBjb21wb3NpdGluZylcbiAgICAgIGNoYW5nZU9ianM6IG51bGwsICAgICAgICAvLyBBY2N1bXVsYXRlZCBjaGFuZ2VzLCBmb3IgZmlyaW5nIGNoYW5nZSBldmVudHNcbiAgICAgIGN1cnNvckFjdGl2aXR5SGFuZGxlcnM6IG51bGwsIC8vIFNldCBvZiBoYW5kbGVycyB0byBmaXJlIGN1cnNvckFjdGl2aXR5IG9uXG4gICAgICBjdXJzb3JBY3Rpdml0eUNhbGxlZDogMCwgLy8gVHJhY2tzIHdoaWNoIGN1cnNvckFjdGl2aXR5IGhhbmRsZXJzIGhhdmUgYmVlbiBjYWxsZWQgYWxyZWFkeVxuICAgICAgc2VsZWN0aW9uQ2hhbmdlZDogZmFsc2UsIC8vIFdoZXRoZXIgdGhlIHNlbGVjdGlvbiBuZWVkcyB0byBiZSByZWRyYXduXG4gICAgICB1cGRhdGVNYXhMaW5lOiBmYWxzZSwgICAgLy8gU2V0IHdoZW4gdGhlIHdpZGVzdCBsaW5lIG5lZWRzIHRvIGJlIGRldGVybWluZWQgYW5ld1xuICAgICAgc2Nyb2xsTGVmdDogbnVsbCwgc2Nyb2xsVG9wOiBudWxsLCAvLyBJbnRlcm1lZGlhdGUgc2Nyb2xsIHBvc2l0aW9uLCBub3QgcHVzaGVkIHRvIERPTSB5ZXRcbiAgICAgIHNjcm9sbFRvUG9zOiBudWxsLCAgICAgICAvLyBVc2VkIHRvIHNjcm9sbCB0byBhIHNwZWNpZmljIHBvc2l0aW9uXG4gICAgICBmb2N1czogZmFsc2UsXG4gICAgICBpZDogKytuZXh0T3BJZCAgICAgICAgICAgLy8gVW5pcXVlIElEXG4gICAgfTtcbiAgICBpZiAob3BlcmF0aW9uR3JvdXApIHtcbiAgICAgIG9wZXJhdGlvbkdyb3VwLm9wcy5wdXNoKGNtLmN1ck9wKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY20uY3VyT3Aub3duc0dyb3VwID0gb3BlcmF0aW9uR3JvdXAgPSB7XG4gICAgICAgIG9wczogW2NtLmN1ck9wXSxcbiAgICAgICAgZGVsYXllZENhbGxiYWNrczogW11cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZmlyZUNhbGxiYWNrc0Zvck9wcyhncm91cCkge1xuICAgIC8vIENhbGxzIGRlbGF5ZWQgY2FsbGJhY2tzIGFuZCBjdXJzb3JBY3Rpdml0eSBoYW5kbGVycyB1bnRpbCBub1xuICAgIC8vIG5ldyBvbmVzIGFwcGVhclxuICAgIHZhciBjYWxsYmFja3MgPSBncm91cC5kZWxheWVkQ2FsbGJhY2tzLCBpID0gMDtcbiAgICBkbyB7XG4gICAgICBmb3IgKDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKylcbiAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwobnVsbCk7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGdyb3VwLm9wcy5sZW5ndGg7IGorKykge1xuICAgICAgICB2YXIgb3AgPSBncm91cC5vcHNbal07XG4gICAgICAgIGlmIChvcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzKVxuICAgICAgICAgIHdoaWxlIChvcC5jdXJzb3JBY3Rpdml0eUNhbGxlZCA8IG9wLmN1cnNvckFjdGl2aXR5SGFuZGxlcnMubGVuZ3RoKVxuICAgICAgICAgICAgb3AuY3Vyc29yQWN0aXZpdHlIYW5kbGVyc1tvcC5jdXJzb3JBY3Rpdml0eUNhbGxlZCsrXS5jYWxsKG51bGwsIG9wLmNtKTtcbiAgICAgIH1cbiAgICB9IHdoaWxlIChpIDwgY2FsbGJhY2tzLmxlbmd0aCk7XG4gIH1cblxuICAvLyBGaW5pc2ggYW4gb3BlcmF0aW9uLCB1cGRhdGluZyB0aGUgZGlzcGxheSBhbmQgc2lnbmFsbGluZyBkZWxheWVkIGV2ZW50c1xuICBmdW5jdGlvbiBlbmRPcGVyYXRpb24oY20pIHtcbiAgICB2YXIgb3AgPSBjbS5jdXJPcCwgZ3JvdXAgPSBvcC5vd25zR3JvdXA7XG4gICAgaWYgKCFncm91cCkgcmV0dXJuO1xuXG4gICAgdHJ5IHsgZmlyZUNhbGxiYWNrc0Zvck9wcyhncm91cCk7IH1cbiAgICBmaW5hbGx5IHtcbiAgICAgIG9wZXJhdGlvbkdyb3VwID0gbnVsbDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXAub3BzLmxlbmd0aDsgaSsrKVxuICAgICAgICBncm91cC5vcHNbaV0uY20uY3VyT3AgPSBudWxsO1xuICAgICAgZW5kT3BlcmF0aW9ucyhncm91cCk7XG4gICAgfVxuICB9XG5cbiAgLy8gVGhlIERPTSB1cGRhdGVzIGRvbmUgd2hlbiBhbiBvcGVyYXRpb24gZmluaXNoZXMgYXJlIGJhdGNoZWQgc29cbiAgLy8gdGhhdCB0aGUgbWluaW11bSBudW1iZXIgb2YgcmVsYXlvdXRzIGFyZSByZXF1aXJlZC5cbiAgZnVuY3Rpb24gZW5kT3BlcmF0aW9ucyhncm91cCkge1xuICAgIHZhciBvcHMgPSBncm91cC5vcHM7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHMubGVuZ3RoOyBpKyspIC8vIFJlYWQgRE9NXG4gICAgICBlbmRPcGVyYXRpb25fUjEob3BzW2ldKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wcy5sZW5ndGg7IGkrKykgLy8gV3JpdGUgRE9NIChtYXliZSlcbiAgICAgIGVuZE9wZXJhdGlvbl9XMShvcHNbaV0pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3BzLmxlbmd0aDsgaSsrKSAvLyBSZWFkIERPTVxuICAgICAgZW5kT3BlcmF0aW9uX1IyKG9wc1tpXSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHMubGVuZ3RoOyBpKyspIC8vIFdyaXRlIERPTSAobWF5YmUpXG4gICAgICBlbmRPcGVyYXRpb25fVzIob3BzW2ldKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wcy5sZW5ndGg7IGkrKykgLy8gUmVhZCBET01cbiAgICAgIGVuZE9wZXJhdGlvbl9maW5pc2gob3BzW2ldKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGVuZE9wZXJhdGlvbl9SMShvcCkge1xuICAgIHZhciBjbSA9IG9wLmNtLCBkaXNwbGF5ID0gY20uZGlzcGxheTtcbiAgICBtYXliZUNsaXBTY3JvbGxiYXJzKGNtKTtcbiAgICBpZiAob3AudXBkYXRlTWF4TGluZSkgZmluZE1heExpbmUoY20pO1xuXG4gICAgb3AubXVzdFVwZGF0ZSA9IG9wLnZpZXdDaGFuZ2VkIHx8IG9wLmZvcmNlVXBkYXRlIHx8IG9wLnNjcm9sbFRvcCAhPSBudWxsIHx8XG4gICAgICBvcC5zY3JvbGxUb1BvcyAmJiAob3Auc2Nyb2xsVG9Qb3MuZnJvbS5saW5lIDwgZGlzcGxheS52aWV3RnJvbSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgIG9wLnNjcm9sbFRvUG9zLnRvLmxpbmUgPj0gZGlzcGxheS52aWV3VG8pIHx8XG4gICAgICBkaXNwbGF5Lm1heExpbmVDaGFuZ2VkICYmIGNtLm9wdGlvbnMubGluZVdyYXBwaW5nO1xuICAgIG9wLnVwZGF0ZSA9IG9wLm11c3RVcGRhdGUgJiZcbiAgICAgIG5ldyBEaXNwbGF5VXBkYXRlKGNtLCBvcC5tdXN0VXBkYXRlICYmIHt0b3A6IG9wLnNjcm9sbFRvcCwgZW5zdXJlOiBvcC5zY3JvbGxUb1Bvc30sIG9wLmZvcmNlVXBkYXRlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGVuZE9wZXJhdGlvbl9XMShvcCkge1xuICAgIG9wLnVwZGF0ZWREaXNwbGF5ID0gb3AubXVzdFVwZGF0ZSAmJiB1cGRhdGVEaXNwbGF5SWZOZWVkZWQob3AuY20sIG9wLnVwZGF0ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBlbmRPcGVyYXRpb25fUjIob3ApIHtcbiAgICB2YXIgY20gPSBvcC5jbSwgZGlzcGxheSA9IGNtLmRpc3BsYXk7XG4gICAgaWYgKG9wLnVwZGF0ZWREaXNwbGF5KSB1cGRhdGVIZWlnaHRzSW5WaWV3cG9ydChjbSk7XG5cbiAgICBvcC5iYXJNZWFzdXJlID0gbWVhc3VyZUZvclNjcm9sbGJhcnMoY20pO1xuXG4gICAgLy8gSWYgdGhlIG1heCBsaW5lIGNoYW5nZWQgc2luY2UgaXQgd2FzIGxhc3QgbWVhc3VyZWQsIG1lYXN1cmUgaXQsXG4gICAgLy8gYW5kIGVuc3VyZSB0aGUgZG9jdW1lbnQncyB3aWR0aCBtYXRjaGVzIGl0LlxuICAgIC8vIHVwZGF0ZURpc3BsYXlfVzIgd2lsbCB1c2UgdGhlc2UgcHJvcGVydGllcyB0byBkbyB0aGUgYWN0dWFsIHJlc2l6aW5nXG4gICAgaWYgKGRpc3BsYXkubWF4TGluZUNoYW5nZWQgJiYgIWNtLm9wdGlvbnMubGluZVdyYXBwaW5nKSB7XG4gICAgICBvcC5hZGp1c3RXaWR0aFRvID0gbWVhc3VyZUNoYXIoY20sIGRpc3BsYXkubWF4TGluZSwgZGlzcGxheS5tYXhMaW5lLnRleHQubGVuZ3RoKS5sZWZ0ICsgMztcbiAgICAgIGNtLmRpc3BsYXkuc2l6ZXJXaWR0aCA9IG9wLmFkanVzdFdpZHRoVG87XG4gICAgICBvcC5iYXJNZWFzdXJlLnNjcm9sbFdpZHRoID1cbiAgICAgICAgTWF0aC5tYXgoZGlzcGxheS5zY3JvbGxlci5jbGllbnRXaWR0aCwgZGlzcGxheS5zaXplci5vZmZzZXRMZWZ0ICsgb3AuYWRqdXN0V2lkdGhUbyArIHNjcm9sbEdhcChjbSkgKyBjbS5kaXNwbGF5LmJhcldpZHRoKTtcbiAgICAgIG9wLm1heFNjcm9sbExlZnQgPSBNYXRoLm1heCgwLCBkaXNwbGF5LnNpemVyLm9mZnNldExlZnQgKyBvcC5hZGp1c3RXaWR0aFRvIC0gZGlzcGxheVdpZHRoKGNtKSk7XG4gICAgfVxuXG4gICAgaWYgKG9wLnVwZGF0ZWREaXNwbGF5IHx8IG9wLnNlbGVjdGlvbkNoYW5nZWQpXG4gICAgICBvcC5wcmVwYXJlZFNlbGVjdGlvbiA9IGRpc3BsYXkuaW5wdXQucHJlcGFyZVNlbGVjdGlvbigpO1xuICB9XG5cbiAgZnVuY3Rpb24gZW5kT3BlcmF0aW9uX1cyKG9wKSB7XG4gICAgdmFyIGNtID0gb3AuY207XG5cbiAgICBpZiAob3AuYWRqdXN0V2lkdGhUbyAhPSBudWxsKSB7XG4gICAgICBjbS5kaXNwbGF5LnNpemVyLnN0eWxlLm1pbldpZHRoID0gb3AuYWRqdXN0V2lkdGhUbyArIFwicHhcIjtcbiAgICAgIGlmIChvcC5tYXhTY3JvbGxMZWZ0IDwgY20uZG9jLnNjcm9sbExlZnQpXG4gICAgICAgIHNldFNjcm9sbExlZnQoY20sIE1hdGgubWluKGNtLmRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsTGVmdCwgb3AubWF4U2Nyb2xsTGVmdCksIHRydWUpO1xuICAgICAgY20uZGlzcGxheS5tYXhMaW5lQ2hhbmdlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChvcC5wcmVwYXJlZFNlbGVjdGlvbilcbiAgICAgIGNtLmRpc3BsYXkuaW5wdXQuc2hvd1NlbGVjdGlvbihvcC5wcmVwYXJlZFNlbGVjdGlvbik7XG4gICAgaWYgKG9wLnVwZGF0ZWREaXNwbGF5KVxuICAgICAgc2V0RG9jdW1lbnRIZWlnaHQoY20sIG9wLmJhck1lYXN1cmUpO1xuICAgIGlmIChvcC51cGRhdGVkRGlzcGxheSB8fCBvcC5zdGFydEhlaWdodCAhPSBjbS5kb2MuaGVpZ2h0KVxuICAgICAgdXBkYXRlU2Nyb2xsYmFycyhjbSwgb3AuYmFyTWVhc3VyZSk7XG5cbiAgICBpZiAob3Auc2VsZWN0aW9uQ2hhbmdlZCkgcmVzdGFydEJsaW5rKGNtKTtcblxuICAgIGlmIChjbS5zdGF0ZS5mb2N1c2VkICYmIG9wLnVwZGF0ZUlucHV0KVxuICAgICAgY20uZGlzcGxheS5pbnB1dC5yZXNldChvcC50eXBpbmcpO1xuICAgIGlmIChvcC5mb2N1cyAmJiBvcC5mb2N1cyA9PSBhY3RpdmVFbHQoKSkgZW5zdXJlRm9jdXMob3AuY20pO1xuICB9XG5cbiAgZnVuY3Rpb24gZW5kT3BlcmF0aW9uX2ZpbmlzaChvcCkge1xuICAgIHZhciBjbSA9IG9wLmNtLCBkaXNwbGF5ID0gY20uZGlzcGxheSwgZG9jID0gY20uZG9jO1xuXG4gICAgaWYgKG9wLnVwZGF0ZWREaXNwbGF5KSBwb3N0VXBkYXRlRGlzcGxheShjbSwgb3AudXBkYXRlKTtcblxuICAgIC8vIEFib3J0IG1vdXNlIHdoZWVsIGRlbHRhIG1lYXN1cmVtZW50LCB3aGVuIHNjcm9sbGluZyBleHBsaWNpdGx5XG4gICAgaWYgKGRpc3BsYXkud2hlZWxTdGFydFggIT0gbnVsbCAmJiAob3Auc2Nyb2xsVG9wICE9IG51bGwgfHwgb3Auc2Nyb2xsTGVmdCAhPSBudWxsIHx8IG9wLnNjcm9sbFRvUG9zKSlcbiAgICAgIGRpc3BsYXkud2hlZWxTdGFydFggPSBkaXNwbGF5LndoZWVsU3RhcnRZID0gbnVsbDtcblxuICAgIC8vIFByb3BhZ2F0ZSB0aGUgc2Nyb2xsIHBvc2l0aW9uIHRvIHRoZSBhY3R1YWwgRE9NIHNjcm9sbGVyXG4gICAgaWYgKG9wLnNjcm9sbFRvcCAhPSBudWxsICYmIChkaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcCAhPSBvcC5zY3JvbGxUb3AgfHwgb3AuZm9yY2VTY3JvbGwpKSB7XG4gICAgICBkb2Muc2Nyb2xsVG9wID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oZGlzcGxheS5zY3JvbGxlci5zY3JvbGxIZWlnaHQgLSBkaXNwbGF5LnNjcm9sbGVyLmNsaWVudEhlaWdodCwgb3Auc2Nyb2xsVG9wKSk7XG4gICAgICBkaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsVG9wKGRvYy5zY3JvbGxUb3ApO1xuICAgICAgZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3AgPSBkb2Muc2Nyb2xsVG9wO1xuICAgIH1cbiAgICBpZiAob3Auc2Nyb2xsTGVmdCAhPSBudWxsICYmIChkaXNwbGF5LnNjcm9sbGVyLnNjcm9sbExlZnQgIT0gb3Auc2Nyb2xsTGVmdCB8fCBvcC5mb3JjZVNjcm9sbCkpIHtcbiAgICAgIGRvYy5zY3JvbGxMZWZ0ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oZGlzcGxheS5zY3JvbGxlci5zY3JvbGxXaWR0aCAtIGRpc3BsYXlXaWR0aChjbSksIG9wLnNjcm9sbExlZnQpKTtcbiAgICAgIGRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxMZWZ0KGRvYy5zY3JvbGxMZWZ0KTtcbiAgICAgIGRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsTGVmdCA9IGRvYy5zY3JvbGxMZWZ0O1xuICAgICAgYWxpZ25Ib3Jpem9udGFsbHkoY20pO1xuICAgIH1cbiAgICAvLyBJZiB3ZSBuZWVkIHRvIHNjcm9sbCBhIHNwZWNpZmljIHBvc2l0aW9uIGludG8gdmlldywgZG8gc28uXG4gICAgaWYgKG9wLnNjcm9sbFRvUG9zKSB7XG4gICAgICB2YXIgY29vcmRzID0gc2Nyb2xsUG9zSW50b1ZpZXcoY20sIGNsaXBQb3MoZG9jLCBvcC5zY3JvbGxUb1Bvcy5mcm9tKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGlwUG9zKGRvYywgb3Auc2Nyb2xsVG9Qb3MudG8pLCBvcC5zY3JvbGxUb1Bvcy5tYXJnaW4pO1xuICAgICAgaWYgKG9wLnNjcm9sbFRvUG9zLmlzQ3Vyc29yICYmIGNtLnN0YXRlLmZvY3VzZWQpIG1heWJlU2Nyb2xsV2luZG93KGNtLCBjb29yZHMpO1xuICAgIH1cblxuICAgIC8vIEZpcmUgZXZlbnRzIGZvciBtYXJrZXJzIHRoYXQgYXJlIGhpZGRlbi91bmlkZGVuIGJ5IGVkaXRpbmcgb3JcbiAgICAvLyB1bmRvaW5nXG4gICAgdmFyIGhpZGRlbiA9IG9wLm1heWJlSGlkZGVuTWFya2VycywgdW5oaWRkZW4gPSBvcC5tYXliZVVuaGlkZGVuTWFya2VycztcbiAgICBpZiAoaGlkZGVuKSBmb3IgKHZhciBpID0gMDsgaSA8IGhpZGRlbi5sZW5ndGg7ICsraSlcbiAgICAgIGlmICghaGlkZGVuW2ldLmxpbmVzLmxlbmd0aCkgc2lnbmFsKGhpZGRlbltpXSwgXCJoaWRlXCIpO1xuICAgIGlmICh1bmhpZGRlbikgZm9yICh2YXIgaSA9IDA7IGkgPCB1bmhpZGRlbi5sZW5ndGg7ICsraSlcbiAgICAgIGlmICh1bmhpZGRlbltpXS5saW5lcy5sZW5ndGgpIHNpZ25hbCh1bmhpZGRlbltpXSwgXCJ1bmhpZGVcIik7XG5cbiAgICBpZiAoZGlzcGxheS53cmFwcGVyLm9mZnNldEhlaWdodClcbiAgICAgIGRvYy5zY3JvbGxUb3AgPSBjbS5kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcDtcblxuICAgIC8vIEZpcmUgY2hhbmdlIGV2ZW50cywgYW5kIGRlbGF5ZWQgZXZlbnQgaGFuZGxlcnNcbiAgICBpZiAob3AuY2hhbmdlT2JqcylcbiAgICAgIHNpZ25hbChjbSwgXCJjaGFuZ2VzXCIsIGNtLCBvcC5jaGFuZ2VPYmpzKTtcbiAgICBpZiAob3AudXBkYXRlKVxuICAgICAgb3AudXBkYXRlLmZpbmlzaCgpO1xuICB9XG5cbiAgLy8gUnVuIHRoZSBnaXZlbiBmdW5jdGlvbiBpbiBhbiBvcGVyYXRpb25cbiAgZnVuY3Rpb24gcnVuSW5PcChjbSwgZikge1xuICAgIGlmIChjbS5jdXJPcCkgcmV0dXJuIGYoKTtcbiAgICBzdGFydE9wZXJhdGlvbihjbSk7XG4gICAgdHJ5IHsgcmV0dXJuIGYoKTsgfVxuICAgIGZpbmFsbHkgeyBlbmRPcGVyYXRpb24oY20pOyB9XG4gIH1cbiAgLy8gV3JhcHMgYSBmdW5jdGlvbiBpbiBhbiBvcGVyYXRpb24uIFJldHVybnMgdGhlIHdyYXBwZWQgZnVuY3Rpb24uXG4gIGZ1bmN0aW9uIG9wZXJhdGlvbihjbSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChjbS5jdXJPcCkgcmV0dXJuIGYuYXBwbHkoY20sIGFyZ3VtZW50cyk7XG4gICAgICBzdGFydE9wZXJhdGlvbihjbSk7XG4gICAgICB0cnkgeyByZXR1cm4gZi5hcHBseShjbSwgYXJndW1lbnRzKTsgfVxuICAgICAgZmluYWxseSB7IGVuZE9wZXJhdGlvbihjbSk7IH1cbiAgICB9O1xuICB9XG4gIC8vIFVzZWQgdG8gYWRkIG1ldGhvZHMgdG8gZWRpdG9yIGFuZCBkb2MgaW5zdGFuY2VzLCB3cmFwcGluZyB0aGVtIGluXG4gIC8vIG9wZXJhdGlvbnMuXG4gIGZ1bmN0aW9uIG1ldGhvZE9wKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5jdXJPcCkgcmV0dXJuIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHN0YXJ0T3BlcmF0aW9uKHRoaXMpO1xuICAgICAgdHJ5IHsgcmV0dXJuIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfVxuICAgICAgZmluYWxseSB7IGVuZE9wZXJhdGlvbih0aGlzKTsgfVxuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gZG9jTWV0aG9kT3AoZikge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjbSA9IHRoaXMuY207XG4gICAgICBpZiAoIWNtIHx8IGNtLmN1ck9wKSByZXR1cm4gZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgc3RhcnRPcGVyYXRpb24oY20pO1xuICAgICAgdHJ5IHsgcmV0dXJuIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfVxuICAgICAgZmluYWxseSB7IGVuZE9wZXJhdGlvbihjbSk7IH1cbiAgICB9O1xuICB9XG5cbiAgLy8gVklFVyBUUkFDS0lOR1xuXG4gIC8vIFRoZXNlIG9iamVjdHMgYXJlIHVzZWQgdG8gcmVwcmVzZW50IHRoZSB2aXNpYmxlIChjdXJyZW50bHkgZHJhd24pXG4gIC8vIHBhcnQgb2YgdGhlIGRvY3VtZW50LiBBIExpbmVWaWV3IG1heSBjb3JyZXNwb25kIHRvIG11bHRpcGxlXG4gIC8vIGxvZ2ljYWwgbGluZXMsIGlmIHRob3NlIGFyZSBjb25uZWN0ZWQgYnkgY29sbGFwc2VkIHJhbmdlcy5cbiAgZnVuY3Rpb24gTGluZVZpZXcoZG9jLCBsaW5lLCBsaW5lTikge1xuICAgIC8vIFRoZSBzdGFydGluZyBsaW5lXG4gICAgdGhpcy5saW5lID0gbGluZTtcbiAgICAvLyBDb250aW51aW5nIGxpbmVzLCBpZiBhbnlcbiAgICB0aGlzLnJlc3QgPSB2aXN1YWxMaW5lQ29udGludWVkKGxpbmUpO1xuICAgIC8vIE51bWJlciBvZiBsb2dpY2FsIGxpbmVzIGluIHRoaXMgdmlzdWFsIGxpbmVcbiAgICB0aGlzLnNpemUgPSB0aGlzLnJlc3QgPyBsaW5lTm8obHN0KHRoaXMucmVzdCkpIC0gbGluZU4gKyAxIDogMTtcbiAgICB0aGlzLm5vZGUgPSB0aGlzLnRleHQgPSBudWxsO1xuICAgIHRoaXMuaGlkZGVuID0gbGluZUlzSGlkZGVuKGRvYywgbGluZSk7XG4gIH1cblxuICAvLyBDcmVhdGUgYSByYW5nZSBvZiBMaW5lVmlldyBvYmplY3RzIGZvciB0aGUgZ2l2ZW4gbGluZXMuXG4gIGZ1bmN0aW9uIGJ1aWxkVmlld0FycmF5KGNtLCBmcm9tLCB0bykge1xuICAgIHZhciBhcnJheSA9IFtdLCBuZXh0UG9zO1xuICAgIGZvciAodmFyIHBvcyA9IGZyb207IHBvcyA8IHRvOyBwb3MgPSBuZXh0UG9zKSB7XG4gICAgICB2YXIgdmlldyA9IG5ldyBMaW5lVmlldyhjbS5kb2MsIGdldExpbmUoY20uZG9jLCBwb3MpLCBwb3MpO1xuICAgICAgbmV4dFBvcyA9IHBvcyArIHZpZXcuc2l6ZTtcbiAgICAgIGFycmF5LnB1c2godmlldyk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbiAgfVxuXG4gIC8vIFVwZGF0ZXMgdGhlIGRpc3BsYXkudmlldyBkYXRhIHN0cnVjdHVyZSBmb3IgYSBnaXZlbiBjaGFuZ2UgdG8gdGhlXG4gIC8vIGRvY3VtZW50LiBGcm9tIGFuZCB0byBhcmUgaW4gcHJlLWNoYW5nZSBjb29yZGluYXRlcy4gTGVuZGlmZiBpc1xuICAvLyB0aGUgYW1vdW50IG9mIGxpbmVzIGFkZGVkIG9yIHN1YnRyYWN0ZWQgYnkgdGhlIGNoYW5nZS4gVGhpcyBpc1xuICAvLyB1c2VkIGZvciBjaGFuZ2VzIHRoYXQgc3BhbiBtdWx0aXBsZSBsaW5lcywgb3IgY2hhbmdlIHRoZSB3YXlcbiAgLy8gbGluZXMgYXJlIGRpdmlkZWQgaW50byB2aXN1YWwgbGluZXMuIHJlZ0xpbmVDaGFuZ2UgKGJlbG93KVxuICAvLyByZWdpc3RlcnMgc2luZ2xlLWxpbmUgY2hhbmdlcy5cbiAgZnVuY3Rpb24gcmVnQ2hhbmdlKGNtLCBmcm9tLCB0bywgbGVuZGlmZikge1xuICAgIGlmIChmcm9tID09IG51bGwpIGZyb20gPSBjbS5kb2MuZmlyc3Q7XG4gICAgaWYgKHRvID09IG51bGwpIHRvID0gY20uZG9jLmZpcnN0ICsgY20uZG9jLnNpemU7XG4gICAgaWYgKCFsZW5kaWZmKSBsZW5kaWZmID0gMDtcblxuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheTtcbiAgICBpZiAobGVuZGlmZiAmJiB0byA8IGRpc3BsYXkudmlld1RvICYmXG4gICAgICAgIChkaXNwbGF5LnVwZGF0ZUxpbmVOdW1iZXJzID09IG51bGwgfHwgZGlzcGxheS51cGRhdGVMaW5lTnVtYmVycyA+IGZyb20pKVxuICAgICAgZGlzcGxheS51cGRhdGVMaW5lTnVtYmVycyA9IGZyb207XG5cbiAgICBjbS5jdXJPcC52aWV3Q2hhbmdlZCA9IHRydWU7XG5cbiAgICBpZiAoZnJvbSA+PSBkaXNwbGF5LnZpZXdUbykgeyAvLyBDaGFuZ2UgYWZ0ZXJcbiAgICAgIGlmIChzYXdDb2xsYXBzZWRTcGFucyAmJiB2aXN1YWxMaW5lTm8oY20uZG9jLCBmcm9tKSA8IGRpc3BsYXkudmlld1RvKVxuICAgICAgICByZXNldFZpZXcoY20pO1xuICAgIH0gZWxzZSBpZiAodG8gPD0gZGlzcGxheS52aWV3RnJvbSkgeyAvLyBDaGFuZ2UgYmVmb3JlXG4gICAgICBpZiAoc2F3Q29sbGFwc2VkU3BhbnMgJiYgdmlzdWFsTGluZUVuZE5vKGNtLmRvYywgdG8gKyBsZW5kaWZmKSA+IGRpc3BsYXkudmlld0Zyb20pIHtcbiAgICAgICAgcmVzZXRWaWV3KGNtKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpc3BsYXkudmlld0Zyb20gKz0gbGVuZGlmZjtcbiAgICAgICAgZGlzcGxheS52aWV3VG8gKz0gbGVuZGlmZjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGZyb20gPD0gZGlzcGxheS52aWV3RnJvbSAmJiB0byA+PSBkaXNwbGF5LnZpZXdUbykgeyAvLyBGdWxsIG92ZXJsYXBcbiAgICAgIHJlc2V0VmlldyhjbSk7XG4gICAgfSBlbHNlIGlmIChmcm9tIDw9IGRpc3BsYXkudmlld0Zyb20pIHsgLy8gVG9wIG92ZXJsYXBcbiAgICAgIHZhciBjdXQgPSB2aWV3Q3V0dGluZ1BvaW50KGNtLCB0bywgdG8gKyBsZW5kaWZmLCAxKTtcbiAgICAgIGlmIChjdXQpIHtcbiAgICAgICAgZGlzcGxheS52aWV3ID0gZGlzcGxheS52aWV3LnNsaWNlKGN1dC5pbmRleCk7XG4gICAgICAgIGRpc3BsYXkudmlld0Zyb20gPSBjdXQubGluZU47XG4gICAgICAgIGRpc3BsYXkudmlld1RvICs9IGxlbmRpZmY7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNldFZpZXcoY20pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodG8gPj0gZGlzcGxheS52aWV3VG8pIHsgLy8gQm90dG9tIG92ZXJsYXBcbiAgICAgIHZhciBjdXQgPSB2aWV3Q3V0dGluZ1BvaW50KGNtLCBmcm9tLCBmcm9tLCAtMSk7XG4gICAgICBpZiAoY3V0KSB7XG4gICAgICAgIGRpc3BsYXkudmlldyA9IGRpc3BsYXkudmlldy5zbGljZSgwLCBjdXQuaW5kZXgpO1xuICAgICAgICBkaXNwbGF5LnZpZXdUbyA9IGN1dC5saW5lTjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc2V0VmlldyhjbSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHsgLy8gR2FwIGluIHRoZSBtaWRkbGVcbiAgICAgIHZhciBjdXRUb3AgPSB2aWV3Q3V0dGluZ1BvaW50KGNtLCBmcm9tLCBmcm9tLCAtMSk7XG4gICAgICB2YXIgY3V0Qm90ID0gdmlld0N1dHRpbmdQb2ludChjbSwgdG8sIHRvICsgbGVuZGlmZiwgMSk7XG4gICAgICBpZiAoY3V0VG9wICYmIGN1dEJvdCkge1xuICAgICAgICBkaXNwbGF5LnZpZXcgPSBkaXNwbGF5LnZpZXcuc2xpY2UoMCwgY3V0VG9wLmluZGV4KVxuICAgICAgICAgIC5jb25jYXQoYnVpbGRWaWV3QXJyYXkoY20sIGN1dFRvcC5saW5lTiwgY3V0Qm90LmxpbmVOKSlcbiAgICAgICAgICAuY29uY2F0KGRpc3BsYXkudmlldy5zbGljZShjdXRCb3QuaW5kZXgpKTtcbiAgICAgICAgZGlzcGxheS52aWV3VG8gKz0gbGVuZGlmZjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc2V0VmlldyhjbSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGV4dCA9IGRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZDtcbiAgICBpZiAoZXh0KSB7XG4gICAgICBpZiAodG8gPCBleHQubGluZU4pXG4gICAgICAgIGV4dC5saW5lTiArPSBsZW5kaWZmO1xuICAgICAgZWxzZSBpZiAoZnJvbSA8IGV4dC5saW5lTiArIGV4dC5zaXplKVxuICAgICAgICBkaXNwbGF5LmV4dGVybmFsTWVhc3VyZWQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8vIFJlZ2lzdGVyIGEgY2hhbmdlIHRvIGEgc2luZ2xlIGxpbmUuIFR5cGUgbXVzdCBiZSBvbmUgb2YgXCJ0ZXh0XCIsXG4gIC8vIFwiZ3V0dGVyXCIsIFwiY2xhc3NcIiwgXCJ3aWRnZXRcIlxuICBmdW5jdGlvbiByZWdMaW5lQ2hhbmdlKGNtLCBsaW5lLCB0eXBlKSB7XG4gICAgY20uY3VyT3Audmlld0NoYW5nZWQgPSB0cnVlO1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgZXh0ID0gY20uZGlzcGxheS5leHRlcm5hbE1lYXN1cmVkO1xuICAgIGlmIChleHQgJiYgbGluZSA+PSBleHQubGluZU4gJiYgbGluZSA8IGV4dC5saW5lTiArIGV4dC5zaXplKVxuICAgICAgZGlzcGxheS5leHRlcm5hbE1lYXN1cmVkID0gbnVsbDtcblxuICAgIGlmIChsaW5lIDwgZGlzcGxheS52aWV3RnJvbSB8fCBsaW5lID49IGRpc3BsYXkudmlld1RvKSByZXR1cm47XG4gICAgdmFyIGxpbmVWaWV3ID0gZGlzcGxheS52aWV3W2ZpbmRWaWV3SW5kZXgoY20sIGxpbmUpXTtcbiAgICBpZiAobGluZVZpZXcubm9kZSA9PSBudWxsKSByZXR1cm47XG4gICAgdmFyIGFyciA9IGxpbmVWaWV3LmNoYW5nZXMgfHwgKGxpbmVWaWV3LmNoYW5nZXMgPSBbXSk7XG4gICAgaWYgKGluZGV4T2YoYXJyLCB0eXBlKSA9PSAtMSkgYXJyLnB1c2godHlwZSk7XG4gIH1cblxuICAvLyBDbGVhciB0aGUgdmlldy5cbiAgZnVuY3Rpb24gcmVzZXRWaWV3KGNtKSB7XG4gICAgY20uZGlzcGxheS52aWV3RnJvbSA9IGNtLmRpc3BsYXkudmlld1RvID0gY20uZG9jLmZpcnN0O1xuICAgIGNtLmRpc3BsYXkudmlldyA9IFtdO1xuICAgIGNtLmRpc3BsYXkudmlld09mZnNldCA9IDA7XG4gIH1cblxuICAvLyBGaW5kIHRoZSB2aWV3IGVsZW1lbnQgY29ycmVzcG9uZGluZyB0byBhIGdpdmVuIGxpbmUuIFJldHVybiBudWxsXG4gIC8vIHdoZW4gdGhlIGxpbmUgaXNuJ3QgdmlzaWJsZS5cbiAgZnVuY3Rpb24gZmluZFZpZXdJbmRleChjbSwgbikge1xuICAgIGlmIChuID49IGNtLmRpc3BsYXkudmlld1RvKSByZXR1cm4gbnVsbDtcbiAgICBuIC09IGNtLmRpc3BsYXkudmlld0Zyb207XG4gICAgaWYgKG4gPCAwKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgdmlldyA9IGNtLmRpc3BsYXkudmlldztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICAgIG4gLT0gdmlld1tpXS5zaXplO1xuICAgICAgaWYgKG4gPCAwKSByZXR1cm4gaTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB2aWV3Q3V0dGluZ1BvaW50KGNtLCBvbGROLCBuZXdOLCBkaXIpIHtcbiAgICB2YXIgaW5kZXggPSBmaW5kVmlld0luZGV4KGNtLCBvbGROKSwgZGlmZiwgdmlldyA9IGNtLmRpc3BsYXkudmlldztcbiAgICBpZiAoIXNhd0NvbGxhcHNlZFNwYW5zIHx8IG5ld04gPT0gY20uZG9jLmZpcnN0ICsgY20uZG9jLnNpemUpXG4gICAgICByZXR1cm4ge2luZGV4OiBpbmRleCwgbGluZU46IG5ld059O1xuICAgIGZvciAodmFyIGkgPSAwLCBuID0gY20uZGlzcGxheS52aWV3RnJvbTsgaSA8IGluZGV4OyBpKyspXG4gICAgICBuICs9IHZpZXdbaV0uc2l6ZTtcbiAgICBpZiAobiAhPSBvbGROKSB7XG4gICAgICBpZiAoZGlyID4gMCkge1xuICAgICAgICBpZiAoaW5kZXggPT0gdmlldy5sZW5ndGggLSAxKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZGlmZiA9IChuICsgdmlld1tpbmRleF0uc2l6ZSkgLSBvbGROO1xuICAgICAgICBpbmRleCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGlmZiA9IG4gLSBvbGROO1xuICAgICAgfVxuICAgICAgb2xkTiArPSBkaWZmOyBuZXdOICs9IGRpZmY7XG4gICAgfVxuICAgIHdoaWxlICh2aXN1YWxMaW5lTm8oY20uZG9jLCBuZXdOKSAhPSBuZXdOKSB7XG4gICAgICBpZiAoaW5kZXggPT0gKGRpciA8IDAgPyAwIDogdmlldy5sZW5ndGggLSAxKSkgcmV0dXJuIG51bGw7XG4gICAgICBuZXdOICs9IGRpciAqIHZpZXdbaW5kZXggLSAoZGlyIDwgMCA/IDEgOiAwKV0uc2l6ZTtcbiAgICAgIGluZGV4ICs9IGRpcjtcbiAgICB9XG4gICAgcmV0dXJuIHtpbmRleDogaW5kZXgsIGxpbmVOOiBuZXdOfTtcbiAgfVxuXG4gIC8vIEZvcmNlIHRoZSB2aWV3IHRvIGNvdmVyIGEgZ2l2ZW4gcmFuZ2UsIGFkZGluZyBlbXB0eSB2aWV3IGVsZW1lbnRcbiAgLy8gb3IgY2xpcHBpbmcgb2ZmIGV4aXN0aW5nIG9uZXMgYXMgbmVlZGVkLlxuICBmdW5jdGlvbiBhZGp1c3RWaWV3KGNtLCBmcm9tLCB0bykge1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgdmlldyA9IGRpc3BsYXkudmlldztcbiAgICBpZiAodmlldy5sZW5ndGggPT0gMCB8fCBmcm9tID49IGRpc3BsYXkudmlld1RvIHx8IHRvIDw9IGRpc3BsYXkudmlld0Zyb20pIHtcbiAgICAgIGRpc3BsYXkudmlldyA9IGJ1aWxkVmlld0FycmF5KGNtLCBmcm9tLCB0byk7XG4gICAgICBkaXNwbGF5LnZpZXdGcm9tID0gZnJvbTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGRpc3BsYXkudmlld0Zyb20gPiBmcm9tKVxuICAgICAgICBkaXNwbGF5LnZpZXcgPSBidWlsZFZpZXdBcnJheShjbSwgZnJvbSwgZGlzcGxheS52aWV3RnJvbSkuY29uY2F0KGRpc3BsYXkudmlldyk7XG4gICAgICBlbHNlIGlmIChkaXNwbGF5LnZpZXdGcm9tIDwgZnJvbSlcbiAgICAgICAgZGlzcGxheS52aWV3ID0gZGlzcGxheS52aWV3LnNsaWNlKGZpbmRWaWV3SW5kZXgoY20sIGZyb20pKTtcbiAgICAgIGRpc3BsYXkudmlld0Zyb20gPSBmcm9tO1xuICAgICAgaWYgKGRpc3BsYXkudmlld1RvIDwgdG8pXG4gICAgICAgIGRpc3BsYXkudmlldyA9IGRpc3BsYXkudmlldy5jb25jYXQoYnVpbGRWaWV3QXJyYXkoY20sIGRpc3BsYXkudmlld1RvLCB0bykpO1xuICAgICAgZWxzZSBpZiAoZGlzcGxheS52aWV3VG8gPiB0bylcbiAgICAgICAgZGlzcGxheS52aWV3ID0gZGlzcGxheS52aWV3LnNsaWNlKDAsIGZpbmRWaWV3SW5kZXgoY20sIHRvKSk7XG4gICAgfVxuICAgIGRpc3BsYXkudmlld1RvID0gdG87XG4gIH1cblxuICAvLyBDb3VudCB0aGUgbnVtYmVyIG9mIGxpbmVzIGluIHRoZSB2aWV3IHdob3NlIERPTSByZXByZXNlbnRhdGlvbiBpc1xuICAvLyBvdXQgb2YgZGF0ZSAob3Igbm9uZXhpc3RlbnQpLlxuICBmdW5jdGlvbiBjb3VudERpcnR5VmlldyhjbSkge1xuICAgIHZhciB2aWV3ID0gY20uZGlzcGxheS52aWV3LCBkaXJ0eSA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbGluZVZpZXcgPSB2aWV3W2ldO1xuICAgICAgaWYgKCFsaW5lVmlldy5oaWRkZW4gJiYgKCFsaW5lVmlldy5ub2RlIHx8IGxpbmVWaWV3LmNoYW5nZXMpKSArK2RpcnR5O1xuICAgIH1cbiAgICByZXR1cm4gZGlydHk7XG4gIH1cblxuICAvLyBFVkVOVCBIQU5ETEVSU1xuXG4gIC8vIEF0dGFjaCB0aGUgbmVjZXNzYXJ5IGV2ZW50IGhhbmRsZXJzIHdoZW4gaW5pdGlhbGl6aW5nIHRoZSBlZGl0b3JcbiAgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudEhhbmRsZXJzKGNtKSB7XG4gICAgdmFyIGQgPSBjbS5kaXNwbGF5O1xuICAgIG9uKGQuc2Nyb2xsZXIsIFwibW91c2Vkb3duXCIsIG9wZXJhdGlvbihjbSwgb25Nb3VzZURvd24pKTtcbiAgICAvLyBPbGRlciBJRSdzIHdpbGwgbm90IGZpcmUgYSBzZWNvbmQgbW91c2Vkb3duIGZvciBhIGRvdWJsZSBjbGlja1xuICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgMTEpXG4gICAgICBvbihkLnNjcm9sbGVyLCBcImRibGNsaWNrXCIsIG9wZXJhdGlvbihjbSwgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoc2lnbmFsRE9NRXZlbnQoY20sIGUpKSByZXR1cm47XG4gICAgICAgIHZhciBwb3MgPSBwb3NGcm9tTW91c2UoY20sIGUpO1xuICAgICAgICBpZiAoIXBvcyB8fCBjbGlja0luR3V0dGVyKGNtLCBlKSB8fCBldmVudEluV2lkZ2V0KGNtLmRpc3BsYXksIGUpKSByZXR1cm47XG4gICAgICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICAgIHZhciB3b3JkID0gY20uZmluZFdvcmRBdChwb3MpO1xuICAgICAgICBleHRlbmRTZWxlY3Rpb24oY20uZG9jLCB3b3JkLmFuY2hvciwgd29yZC5oZWFkKTtcbiAgICAgIH0pKTtcbiAgICBlbHNlXG4gICAgICBvbihkLnNjcm9sbGVyLCBcImRibGNsaWNrXCIsIGZ1bmN0aW9uKGUpIHsgc2lnbmFsRE9NRXZlbnQoY20sIGUpIHx8IGVfcHJldmVudERlZmF1bHQoZSk7IH0pO1xuICAgIC8vIFNvbWUgYnJvd3NlcnMgZmlyZSBjb250ZXh0bWVudSAqYWZ0ZXIqIG9wZW5pbmcgdGhlIG1lbnUsIGF0XG4gICAgLy8gd2hpY2ggcG9pbnQgd2UgY2FuJ3QgbWVzcyB3aXRoIGl0IGFueW1vcmUuIENvbnRleHQgbWVudSBpc1xuICAgIC8vIGhhbmRsZWQgaW4gb25Nb3VzZURvd24gZm9yIHRoZXNlIGJyb3dzZXJzLlxuICAgIGlmICghY2FwdHVyZVJpZ2h0Q2xpY2spIG9uKGQuc2Nyb2xsZXIsIFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24oZSkge29uQ29udGV4dE1lbnUoY20sIGUpO30pO1xuXG4gICAgLy8gVXNlZCB0byBzdXBwcmVzcyBtb3VzZSBldmVudCBoYW5kbGluZyB3aGVuIGEgdG91Y2ggaGFwcGVuc1xuICAgIHZhciB0b3VjaEZpbmlzaGVkLCBwcmV2VG91Y2ggPSB7ZW5kOiAwfTtcbiAgICBmdW5jdGlvbiBmaW5pc2hUb3VjaCgpIHtcbiAgICAgIGlmIChkLmFjdGl2ZVRvdWNoKSB7XG4gICAgICAgIHRvdWNoRmluaXNoZWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge2QuYWN0aXZlVG91Y2ggPSBudWxsO30sIDEwMDApO1xuICAgICAgICBwcmV2VG91Y2ggPSBkLmFjdGl2ZVRvdWNoO1xuICAgICAgICBwcmV2VG91Y2guZW5kID0gK25ldyBEYXRlO1xuICAgICAgfVxuICAgIH07XG4gICAgZnVuY3Rpb24gaXNNb3VzZUxpa2VUb3VjaEV2ZW50KGUpIHtcbiAgICAgIGlmIChlLnRvdWNoZXMubGVuZ3RoICE9IDEpIHJldHVybiBmYWxzZTtcbiAgICAgIHZhciB0b3VjaCA9IGUudG91Y2hlc1swXTtcbiAgICAgIHJldHVybiB0b3VjaC5yYWRpdXNYIDw9IDEgJiYgdG91Y2gucmFkaXVzWSA8PSAxO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmYXJBd2F5KHRvdWNoLCBvdGhlcikge1xuICAgICAgaWYgKG90aGVyLmxlZnQgPT0gbnVsbCkgcmV0dXJuIHRydWU7XG4gICAgICB2YXIgZHggPSBvdGhlci5sZWZ0IC0gdG91Y2gubGVmdCwgZHkgPSBvdGhlci50b3AgLSB0b3VjaC50b3A7XG4gICAgICByZXR1cm4gZHggKiBkeCArIGR5ICogZHkgPiAyMCAqIDIwO1xuICAgIH1cbiAgICBvbihkLnNjcm9sbGVyLCBcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKCFpc01vdXNlTGlrZVRvdWNoRXZlbnQoZSkpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRvdWNoRmluaXNoZWQpO1xuICAgICAgICB2YXIgbm93ID0gK25ldyBEYXRlO1xuICAgICAgICBkLmFjdGl2ZVRvdWNoID0ge3N0YXJ0OiBub3csIG1vdmVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2OiBub3cgLSBwcmV2VG91Y2guZW5kIDw9IDMwMCA/IHByZXZUb3VjaCA6IG51bGx9O1xuICAgICAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgZC5hY3RpdmVUb3VjaC5sZWZ0ID0gZS50b3VjaGVzWzBdLnBhZ2VYO1xuICAgICAgICAgIGQuYWN0aXZlVG91Y2gudG9wID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgb24oZC5zY3JvbGxlciwgXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoZC5hY3RpdmVUb3VjaCkgZC5hY3RpdmVUb3VjaC5tb3ZlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgb24oZC5zY3JvbGxlciwgXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgdG91Y2ggPSBkLmFjdGl2ZVRvdWNoO1xuICAgICAgaWYgKHRvdWNoICYmICFldmVudEluV2lkZ2V0KGQsIGUpICYmIHRvdWNoLmxlZnQgIT0gbnVsbCAmJlxuICAgICAgICAgICF0b3VjaC5tb3ZlZCAmJiBuZXcgRGF0ZSAtIHRvdWNoLnN0YXJ0IDwgMzAwKSB7XG4gICAgICAgIHZhciBwb3MgPSBjbS5jb29yZHNDaGFyKGQuYWN0aXZlVG91Y2gsIFwicGFnZVwiKSwgcmFuZ2U7XG4gICAgICAgIGlmICghdG91Y2gucHJldiB8fCBmYXJBd2F5KHRvdWNoLCB0b3VjaC5wcmV2KSkgLy8gU2luZ2xlIHRhcFxuICAgICAgICAgIHJhbmdlID0gbmV3IFJhbmdlKHBvcywgcG9zKTtcbiAgICAgICAgZWxzZSBpZiAoIXRvdWNoLnByZXYucHJldiB8fCBmYXJBd2F5KHRvdWNoLCB0b3VjaC5wcmV2LnByZXYpKSAvLyBEb3VibGUgdGFwXG4gICAgICAgICAgcmFuZ2UgPSBjbS5maW5kV29yZEF0KHBvcyk7XG4gICAgICAgIGVsc2UgLy8gVHJpcGxlIHRhcFxuICAgICAgICAgIHJhbmdlID0gbmV3IFJhbmdlKFBvcyhwb3MubGluZSwgMCksIGNsaXBQb3MoY20uZG9jLCBQb3MocG9zLmxpbmUgKyAxLCAwKSkpO1xuICAgICAgICBjbS5zZXRTZWxlY3Rpb24ocmFuZ2UuYW5jaG9yLCByYW5nZS5oZWFkKTtcbiAgICAgICAgY20uZm9jdXMoKTtcbiAgICAgICAgZV9wcmV2ZW50RGVmYXVsdChlKTtcbiAgICAgIH1cbiAgICAgIGZpbmlzaFRvdWNoKCk7XG4gICAgfSk7XG4gICAgb24oZC5zY3JvbGxlciwgXCJ0b3VjaGNhbmNlbFwiLCBmaW5pc2hUb3VjaCk7XG5cbiAgICAvLyBTeW5jIHNjcm9sbGluZyBiZXR3ZWVuIGZha2Ugc2Nyb2xsYmFycyBhbmQgcmVhbCBzY3JvbGxhYmxlXG4gICAgLy8gYXJlYSwgZW5zdXJlIHZpZXdwb3J0IGlzIHVwZGF0ZWQgd2hlbiBzY3JvbGxpbmcuXG4gICAgb24oZC5zY3JvbGxlciwgXCJzY3JvbGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoZC5zY3JvbGxlci5jbGllbnRIZWlnaHQpIHtcbiAgICAgICAgc2V0U2Nyb2xsVG9wKGNtLCBkLnNjcm9sbGVyLnNjcm9sbFRvcCk7XG4gICAgICAgIHNldFNjcm9sbExlZnQoY20sIGQuc2Nyb2xsZXIuc2Nyb2xsTGVmdCwgdHJ1ZSk7XG4gICAgICAgIHNpZ25hbChjbSwgXCJzY3JvbGxcIiwgY20pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gTGlzdGVuIHRvIHdoZWVsIGV2ZW50cyBpbiBvcmRlciB0byB0cnkgYW5kIHVwZGF0ZSB0aGUgdmlld3BvcnQgb24gdGltZS5cbiAgICBvbihkLnNjcm9sbGVyLCBcIm1vdXNld2hlZWxcIiwgZnVuY3Rpb24oZSl7b25TY3JvbGxXaGVlbChjbSwgZSk7fSk7XG4gICAgb24oZC5zY3JvbGxlciwgXCJET01Nb3VzZVNjcm9sbFwiLCBmdW5jdGlvbihlKXtvblNjcm9sbFdoZWVsKGNtLCBlKTt9KTtcblxuICAgIC8vIFByZXZlbnQgd3JhcHBlciBmcm9tIGV2ZXIgc2Nyb2xsaW5nXG4gICAgb24oZC53cmFwcGVyLCBcInNjcm9sbFwiLCBmdW5jdGlvbigpIHsgZC53cmFwcGVyLnNjcm9sbFRvcCA9IGQud3JhcHBlci5zY3JvbGxMZWZ0ID0gMDsgfSk7XG5cbiAgICBkLmRyYWdGdW5jdGlvbnMgPSB7XG4gICAgICBlbnRlcjogZnVuY3Rpb24oZSkge2lmICghc2lnbmFsRE9NRXZlbnQoY20sIGUpKSBlX3N0b3AoZSk7fSxcbiAgICAgIG92ZXI6IGZ1bmN0aW9uKGUpIHtpZiAoIXNpZ25hbERPTUV2ZW50KGNtLCBlKSkgeyBvbkRyYWdPdmVyKGNtLCBlKTsgZV9zdG9wKGUpOyB9fSxcbiAgICAgIHN0YXJ0OiBmdW5jdGlvbihlKXtvbkRyYWdTdGFydChjbSwgZSk7fSxcbiAgICAgIGRyb3A6IG9wZXJhdGlvbihjbSwgb25Ecm9wKSxcbiAgICAgIGxlYXZlOiBmdW5jdGlvbigpIHtjbGVhckRyYWdDdXJzb3IoY20pO31cbiAgICB9O1xuXG4gICAgdmFyIGlucCA9IGQuaW5wdXQuZ2V0RmllbGQoKTtcbiAgICBvbihpbnAsIFwia2V5dXBcIiwgZnVuY3Rpb24oZSkgeyBvbktleVVwLmNhbGwoY20sIGUpOyB9KTtcbiAgICBvbihpbnAsIFwia2V5ZG93blwiLCBvcGVyYXRpb24oY20sIG9uS2V5RG93bikpO1xuICAgIG9uKGlucCwgXCJrZXlwcmVzc1wiLCBvcGVyYXRpb24oY20sIG9uS2V5UHJlc3MpKTtcbiAgICBvbihpbnAsIFwiZm9jdXNcIiwgYmluZChvbkZvY3VzLCBjbSkpO1xuICAgIG9uKGlucCwgXCJibHVyXCIsIGJpbmQob25CbHVyLCBjbSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gZHJhZ0Ryb3BDaGFuZ2VkKGNtLCB2YWx1ZSwgb2xkKSB7XG4gICAgdmFyIHdhc09uID0gb2xkICYmIG9sZCAhPSBDb2RlTWlycm9yLkluaXQ7XG4gICAgaWYgKCF2YWx1ZSAhPSAhd2FzT24pIHtcbiAgICAgIHZhciBmdW5jcyA9IGNtLmRpc3BsYXkuZHJhZ0Z1bmN0aW9ucztcbiAgICAgIHZhciB0b2dnbGUgPSB2YWx1ZSA/IG9uIDogb2ZmO1xuICAgICAgdG9nZ2xlKGNtLmRpc3BsYXkuc2Nyb2xsZXIsIFwiZHJhZ3N0YXJ0XCIsIGZ1bmNzLnN0YXJ0KTtcbiAgICAgIHRvZ2dsZShjbS5kaXNwbGF5LnNjcm9sbGVyLCBcImRyYWdlbnRlclwiLCBmdW5jcy5lbnRlcik7XG4gICAgICB0b2dnbGUoY20uZGlzcGxheS5zY3JvbGxlciwgXCJkcmFnb3ZlclwiLCBmdW5jcy5vdmVyKTtcbiAgICAgIHRvZ2dsZShjbS5kaXNwbGF5LnNjcm9sbGVyLCBcImRyYWdsZWF2ZVwiLCBmdW5jcy5sZWF2ZSk7XG4gICAgICB0b2dnbGUoY20uZGlzcGxheS5zY3JvbGxlciwgXCJkcm9wXCIsIGZ1bmNzLmRyb3ApO1xuICAgIH1cbiAgfVxuXG4gIC8vIENhbGxlZCB3aGVuIHRoZSB3aW5kb3cgcmVzaXplc1xuICBmdW5jdGlvbiBvblJlc2l6ZShjbSkge1xuICAgIHZhciBkID0gY20uZGlzcGxheTtcbiAgICBpZiAoZC5sYXN0V3JhcEhlaWdodCA9PSBkLndyYXBwZXIuY2xpZW50SGVpZ2h0ICYmIGQubGFzdFdyYXBXaWR0aCA9PSBkLndyYXBwZXIuY2xpZW50V2lkdGgpXG4gICAgICByZXR1cm47XG4gICAgLy8gTWlnaHQgYmUgYSB0ZXh0IHNjYWxpbmcgb3BlcmF0aW9uLCBjbGVhciBzaXplIGNhY2hlcy5cbiAgICBkLmNhY2hlZENoYXJXaWR0aCA9IGQuY2FjaGVkVGV4dEhlaWdodCA9IGQuY2FjaGVkUGFkZGluZ0ggPSBudWxsO1xuICAgIGQuc2Nyb2xsYmFyc0NsaXBwZWQgPSBmYWxzZTtcbiAgICBjbS5zZXRTaXplKCk7XG4gIH1cblxuICAvLyBNT1VTRSBFVkVOVFNcblxuICAvLyBSZXR1cm4gdHJ1ZSB3aGVuIHRoZSBnaXZlbiBtb3VzZSBldmVudCBoYXBwZW5lZCBpbiBhIHdpZGdldFxuICBmdW5jdGlvbiBldmVudEluV2lkZ2V0KGRpc3BsYXksIGUpIHtcbiAgICBmb3IgKHZhciBuID0gZV90YXJnZXQoZSk7IG4gIT0gZGlzcGxheS53cmFwcGVyOyBuID0gbi5wYXJlbnROb2RlKSB7XG4gICAgICBpZiAoIW4gfHwgKG4ubm9kZVR5cGUgPT0gMSAmJiBuLmdldEF0dHJpYnV0ZShcImNtLWlnbm9yZS1ldmVudHNcIikgPT0gXCJ0cnVlXCIpIHx8XG4gICAgICAgICAgKG4ucGFyZW50Tm9kZSA9PSBkaXNwbGF5LnNpemVyICYmIG4gIT0gZGlzcGxheS5tb3ZlcikpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdpdmVuIGEgbW91c2UgZXZlbnQsIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgcG9zaXRpb24uIElmIGxpYmVyYWxcbiAgLy8gaXMgZmFsc2UsIGl0IGNoZWNrcyB3aGV0aGVyIGEgZ3V0dGVyIG9yIHNjcm9sbGJhciB3YXMgY2xpY2tlZCxcbiAgLy8gYW5kIHJldHVybnMgbnVsbCBpZiBpdCB3YXMuIGZvclJlY3QgaXMgdXNlZCBieSByZWN0YW5ndWxhclxuICAvLyBzZWxlY3Rpb25zLCBhbmQgdHJpZXMgdG8gZXN0aW1hdGUgYSBjaGFyYWN0ZXIgcG9zaXRpb24gZXZlbiBmb3JcbiAgLy8gY29vcmRpbmF0ZXMgYmV5b25kIHRoZSByaWdodCBvZiB0aGUgdGV4dC5cbiAgZnVuY3Rpb24gcG9zRnJvbU1vdXNlKGNtLCBlLCBsaWJlcmFsLCBmb3JSZWN0KSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgIGlmICghbGliZXJhbCAmJiBlX3RhcmdldChlKS5nZXRBdHRyaWJ1dGUoXCJjbS1ub3QtY29udGVudFwiKSA9PSBcInRydWVcIikgcmV0dXJuIG51bGw7XG5cbiAgICB2YXIgeCwgeSwgc3BhY2UgPSBkaXNwbGF5LmxpbmVTcGFjZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAvLyBGYWlscyB1bnByZWRpY3RhYmx5IG9uIElFWzY3XSB3aGVuIG1vdXNlIGlzIGRyYWdnZWQgYXJvdW5kIHF1aWNrbHkuXG4gICAgdHJ5IHsgeCA9IGUuY2xpZW50WCAtIHNwYWNlLmxlZnQ7IHkgPSBlLmNsaWVudFkgLSBzcGFjZS50b3A7IH1cbiAgICBjYXRjaCAoZSkgeyByZXR1cm4gbnVsbDsgfVxuICAgIHZhciBjb29yZHMgPSBjb29yZHNDaGFyKGNtLCB4LCB5KSwgbGluZTtcbiAgICBpZiAoZm9yUmVjdCAmJiBjb29yZHMueFJlbCA9PSAxICYmIChsaW5lID0gZ2V0TGluZShjbS5kb2MsIGNvb3Jkcy5saW5lKS50ZXh0KS5sZW5ndGggPT0gY29vcmRzLmNoKSB7XG4gICAgICB2YXIgY29sRGlmZiA9IGNvdW50Q29sdW1uKGxpbmUsIGxpbmUubGVuZ3RoLCBjbS5vcHRpb25zLnRhYlNpemUpIC0gbGluZS5sZW5ndGg7XG4gICAgICBjb29yZHMgPSBQb3MoY29vcmRzLmxpbmUsIE1hdGgubWF4KDAsIE1hdGgucm91bmQoKHggLSBwYWRkaW5nSChjbS5kaXNwbGF5KS5sZWZ0KSAvIGNoYXJXaWR0aChjbS5kaXNwbGF5KSkgLSBjb2xEaWZmKSk7XG4gICAgfVxuICAgIHJldHVybiBjb29yZHM7XG4gIH1cblxuICAvLyBBIG1vdXNlIGRvd24gY2FuIGJlIGEgc2luZ2xlIGNsaWNrLCBkb3VibGUgY2xpY2ssIHRyaXBsZSBjbGljayxcbiAgLy8gc3RhcnQgb2Ygc2VsZWN0aW9uIGRyYWcsIHN0YXJ0IG9mIHRleHQgZHJhZywgbmV3IGN1cnNvclxuICAvLyAoY3RybC1jbGljayksIHJlY3RhbmdsZSBkcmFnIChhbHQtZHJhZyksIG9yIHh3aW5cbiAgLy8gbWlkZGxlLWNsaWNrLXBhc3RlLiBPciBpdCBtaWdodCBiZSBhIGNsaWNrIG9uIHNvbWV0aGluZyB3ZSBzaG91bGRcbiAgLy8gbm90IGludGVyZmVyZSB3aXRoLCBzdWNoIGFzIGEgc2Nyb2xsYmFyIG9yIHdpZGdldC5cbiAgZnVuY3Rpb24gb25Nb3VzZURvd24oZSkge1xuICAgIHZhciBjbSA9IHRoaXMsIGRpc3BsYXkgPSBjbS5kaXNwbGF5O1xuICAgIGlmIChkaXNwbGF5LmFjdGl2ZVRvdWNoICYmIGRpc3BsYXkuaW5wdXQuc3VwcG9ydHNUb3VjaCgpIHx8IHNpZ25hbERPTUV2ZW50KGNtLCBlKSkgcmV0dXJuO1xuICAgIGRpc3BsYXkuc2hpZnQgPSBlLnNoaWZ0S2V5O1xuXG4gICAgaWYgKGV2ZW50SW5XaWRnZXQoZGlzcGxheSwgZSkpIHtcbiAgICAgIGlmICghd2Via2l0KSB7XG4gICAgICAgIC8vIEJyaWVmbHkgdHVybiBvZmYgZHJhZ2dhYmlsaXR5LCB0byBhbGxvdyB3aWRnZXRzIHRvIGRvXG4gICAgICAgIC8vIG5vcm1hbCBkcmFnZ2luZyB0aGluZ3MuXG4gICAgICAgIGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ2dhYmxlID0gZmFsc2U7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtkaXNwbGF5LnNjcm9sbGVyLmRyYWdnYWJsZSA9IHRydWU7fSwgMTAwKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNsaWNrSW5HdXR0ZXIoY20sIGUpKSByZXR1cm47XG4gICAgdmFyIHN0YXJ0ID0gcG9zRnJvbU1vdXNlKGNtLCBlKTtcbiAgICB3aW5kb3cuZm9jdXMoKTtcblxuICAgIHN3aXRjaCAoZV9idXR0b24oZSkpIHtcbiAgICBjYXNlIDE6XG4gICAgICAvLyAjMzI2MTogbWFrZSBzdXJlLCB0aGF0IHdlJ3JlIG5vdCBzdGFydGluZyBhIHNlY29uZCBzZWxlY3Rpb25cbiAgICAgIGlmIChjbS5zdGF0ZS5zZWxlY3RpbmdUZXh0KVxuICAgICAgICBjbS5zdGF0ZS5zZWxlY3RpbmdUZXh0KGUpO1xuICAgICAgZWxzZSBpZiAoc3RhcnQpXG4gICAgICAgIGxlZnRCdXR0b25Eb3duKGNtLCBlLCBzdGFydCk7XG4gICAgICBlbHNlIGlmIChlX3RhcmdldChlKSA9PSBkaXNwbGF5LnNjcm9sbGVyKVxuICAgICAgICBlX3ByZXZlbnREZWZhdWx0KGUpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAyOlxuICAgICAgaWYgKHdlYmtpdCkgY20uc3RhdGUubGFzdE1pZGRsZURvd24gPSArbmV3IERhdGU7XG4gICAgICBpZiAoc3RhcnQpIGV4dGVuZFNlbGVjdGlvbihjbS5kb2MsIHN0YXJ0KTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ZGlzcGxheS5pbnB1dC5mb2N1cygpO30sIDIwKTtcbiAgICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDM6XG4gICAgICBpZiAoY2FwdHVyZVJpZ2h0Q2xpY2spIG9uQ29udGV4dE1lbnUoY20sIGUpO1xuICAgICAgZWxzZSBkZWxheUJsdXJFdmVudChjbSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICB2YXIgbGFzdENsaWNrLCBsYXN0RG91YmxlQ2xpY2s7XG4gIGZ1bmN0aW9uIGxlZnRCdXR0b25Eb3duKGNtLCBlLCBzdGFydCkge1xuICAgIGlmIChpZSkgc2V0VGltZW91dChiaW5kKGVuc3VyZUZvY3VzLCBjbSksIDApO1xuICAgIGVsc2UgY20uY3VyT3AuZm9jdXMgPSBhY3RpdmVFbHQoKTtcblxuICAgIHZhciBub3cgPSArbmV3IERhdGUsIHR5cGU7XG4gICAgaWYgKGxhc3REb3VibGVDbGljayAmJiBsYXN0RG91YmxlQ2xpY2sudGltZSA+IG5vdyAtIDQwMCAmJiBjbXAobGFzdERvdWJsZUNsaWNrLnBvcywgc3RhcnQpID09IDApIHtcbiAgICAgIHR5cGUgPSBcInRyaXBsZVwiO1xuICAgIH0gZWxzZSBpZiAobGFzdENsaWNrICYmIGxhc3RDbGljay50aW1lID4gbm93IC0gNDAwICYmIGNtcChsYXN0Q2xpY2sucG9zLCBzdGFydCkgPT0gMCkge1xuICAgICAgdHlwZSA9IFwiZG91YmxlXCI7XG4gICAgICBsYXN0RG91YmxlQ2xpY2sgPSB7dGltZTogbm93LCBwb3M6IHN0YXJ0fTtcbiAgICB9IGVsc2Uge1xuICAgICAgdHlwZSA9IFwic2luZ2xlXCI7XG4gICAgICBsYXN0Q2xpY2sgPSB7dGltZTogbm93LCBwb3M6IHN0YXJ0fTtcbiAgICB9XG5cbiAgICB2YXIgc2VsID0gY20uZG9jLnNlbCwgbW9kaWZpZXIgPSBtYWMgPyBlLm1ldGFLZXkgOiBlLmN0cmxLZXksIGNvbnRhaW5lZDtcbiAgICBpZiAoY20ub3B0aW9ucy5kcmFnRHJvcCAmJiBkcmFnQW5kRHJvcCAmJiAhaXNSZWFkT25seShjbSkgJiZcbiAgICAgICAgdHlwZSA9PSBcInNpbmdsZVwiICYmIChjb250YWluZWQgPSBzZWwuY29udGFpbnMoc3RhcnQpKSA+IC0xICYmXG4gICAgICAgIChjbXAoKGNvbnRhaW5lZCA9IHNlbC5yYW5nZXNbY29udGFpbmVkXSkuZnJvbSgpLCBzdGFydCkgPCAwIHx8IHN0YXJ0LnhSZWwgPiAwKSAmJlxuICAgICAgICAoY21wKGNvbnRhaW5lZC50bygpLCBzdGFydCkgPiAwIHx8IHN0YXJ0LnhSZWwgPCAwKSlcbiAgICAgIGxlZnRCdXR0b25TdGFydERyYWcoY20sIGUsIHN0YXJ0LCBtb2RpZmllcik7XG4gICAgZWxzZVxuICAgICAgbGVmdEJ1dHRvblNlbGVjdChjbSwgZSwgc3RhcnQsIHR5cGUsIG1vZGlmaWVyKTtcbiAgfVxuXG4gIC8vIFN0YXJ0IGEgdGV4dCBkcmFnLiBXaGVuIGl0IGVuZHMsIHNlZSBpZiBhbnkgZHJhZ2dpbmcgYWN0dWFsbHlcbiAgLy8gaGFwcGVuLCBhbmQgdHJlYXQgYXMgYSBjbGljayBpZiBpdCBkaWRuJ3QuXG4gIGZ1bmN0aW9uIGxlZnRCdXR0b25TdGFydERyYWcoY20sIGUsIHN0YXJ0LCBtb2RpZmllcikge1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgc3RhcnRUaW1lID0gK25ldyBEYXRlO1xuICAgIHZhciBkcmFnRW5kID0gb3BlcmF0aW9uKGNtLCBmdW5jdGlvbihlMikge1xuICAgICAgaWYgKHdlYmtpdCkgZGlzcGxheS5zY3JvbGxlci5kcmFnZ2FibGUgPSBmYWxzZTtcbiAgICAgIGNtLnN0YXRlLmRyYWdnaW5nVGV4dCA9IGZhbHNlO1xuICAgICAgb2ZmKGRvY3VtZW50LCBcIm1vdXNldXBcIiwgZHJhZ0VuZCk7XG4gICAgICBvZmYoZGlzcGxheS5zY3JvbGxlciwgXCJkcm9wXCIsIGRyYWdFbmQpO1xuICAgICAgaWYgKE1hdGguYWJzKGUuY2xpZW50WCAtIGUyLmNsaWVudFgpICsgTWF0aC5hYnMoZS5jbGllbnRZIC0gZTIuY2xpZW50WSkgPCAxMCkge1xuICAgICAgICBlX3ByZXZlbnREZWZhdWx0KGUyKTtcbiAgICAgICAgaWYgKCFtb2RpZmllciAmJiArbmV3IERhdGUgLSAyMDAgPCBzdGFydFRpbWUpXG4gICAgICAgICAgZXh0ZW5kU2VsZWN0aW9uKGNtLmRvYywgc3RhcnQpO1xuICAgICAgICAvLyBXb3JrIGFyb3VuZCB1bmV4cGxhaW5hYmxlIGZvY3VzIHByb2JsZW0gaW4gSUU5ICgjMjEyNykgYW5kIENocm9tZSAoIzMwODEpXG4gICAgICAgIGlmICh3ZWJraXQgfHwgaWUgJiYgaWVfdmVyc2lvbiA9PSA5KVxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ZG9jdW1lbnQuYm9keS5mb2N1cygpOyBkaXNwbGF5LmlucHV0LmZvY3VzKCk7fSwgMjApO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgZGlzcGxheS5pbnB1dC5mb2N1cygpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIExldCB0aGUgZHJhZyBoYW5kbGVyIGhhbmRsZSB0aGlzLlxuICAgIGlmICh3ZWJraXQpIGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ2dhYmxlID0gdHJ1ZTtcbiAgICBjbS5zdGF0ZS5kcmFnZ2luZ1RleHQgPSBkcmFnRW5kO1xuICAgIC8vIElFJ3MgYXBwcm9hY2ggdG8gZHJhZ2dhYmxlXG4gICAgaWYgKGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ0Ryb3ApIGRpc3BsYXkuc2Nyb2xsZXIuZHJhZ0Ryb3AoKTtcbiAgICBvbihkb2N1bWVudCwgXCJtb3VzZXVwXCIsIGRyYWdFbmQpO1xuICAgIG9uKGRpc3BsYXkuc2Nyb2xsZXIsIFwiZHJvcFwiLCBkcmFnRW5kKTtcbiAgfVxuXG4gIC8vIE5vcm1hbCBzZWxlY3Rpb24sIGFzIG9wcG9zZWQgdG8gdGV4dCBkcmFnZ2luZy5cbiAgZnVuY3Rpb24gbGVmdEJ1dHRvblNlbGVjdChjbSwgZSwgc3RhcnQsIHR5cGUsIGFkZE5ldykge1xuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgZG9jID0gY20uZG9jO1xuICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG5cbiAgICB2YXIgb3VyUmFuZ2UsIG91ckluZGV4LCBzdGFydFNlbCA9IGRvYy5zZWwsIHJhbmdlcyA9IHN0YXJ0U2VsLnJhbmdlcztcbiAgICBpZiAoYWRkTmV3ICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICBvdXJJbmRleCA9IGRvYy5zZWwuY29udGFpbnMoc3RhcnQpO1xuICAgICAgaWYgKG91ckluZGV4ID4gLTEpXG4gICAgICAgIG91clJhbmdlID0gcmFuZ2VzW291ckluZGV4XTtcbiAgICAgIGVsc2VcbiAgICAgICAgb3VyUmFuZ2UgPSBuZXcgUmFuZ2Uoc3RhcnQsIHN0YXJ0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3VyUmFuZ2UgPSBkb2Muc2VsLnByaW1hcnkoKTtcbiAgICAgIG91ckluZGV4ID0gZG9jLnNlbC5wcmltSW5kZXg7XG4gICAgfVxuXG4gICAgaWYgKGUuYWx0S2V5KSB7XG4gICAgICB0eXBlID0gXCJyZWN0XCI7XG4gICAgICBpZiAoIWFkZE5ldykgb3VyUmFuZ2UgPSBuZXcgUmFuZ2Uoc3RhcnQsIHN0YXJ0KTtcbiAgICAgIHN0YXJ0ID0gcG9zRnJvbU1vdXNlKGNtLCBlLCB0cnVlLCB0cnVlKTtcbiAgICAgIG91ckluZGV4ID0gLTE7XG4gICAgfSBlbHNlIGlmICh0eXBlID09IFwiZG91YmxlXCIpIHtcbiAgICAgIHZhciB3b3JkID0gY20uZmluZFdvcmRBdChzdGFydCk7XG4gICAgICBpZiAoY20uZGlzcGxheS5zaGlmdCB8fCBkb2MuZXh0ZW5kKVxuICAgICAgICBvdXJSYW5nZSA9IGV4dGVuZFJhbmdlKGRvYywgb3VyUmFuZ2UsIHdvcmQuYW5jaG9yLCB3b3JkLmhlYWQpO1xuICAgICAgZWxzZVxuICAgICAgICBvdXJSYW5nZSA9IHdvcmQ7XG4gICAgfSBlbHNlIGlmICh0eXBlID09IFwidHJpcGxlXCIpIHtcbiAgICAgIHZhciBsaW5lID0gbmV3IFJhbmdlKFBvcyhzdGFydC5saW5lLCAwKSwgY2xpcFBvcyhkb2MsIFBvcyhzdGFydC5saW5lICsgMSwgMCkpKTtcbiAgICAgIGlmIChjbS5kaXNwbGF5LnNoaWZ0IHx8IGRvYy5leHRlbmQpXG4gICAgICAgIG91clJhbmdlID0gZXh0ZW5kUmFuZ2UoZG9jLCBvdXJSYW5nZSwgbGluZS5hbmNob3IsIGxpbmUuaGVhZCk7XG4gICAgICBlbHNlXG4gICAgICAgIG91clJhbmdlID0gbGluZTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3VyUmFuZ2UgPSBleHRlbmRSYW5nZShkb2MsIG91clJhbmdlLCBzdGFydCk7XG4gICAgfVxuXG4gICAgaWYgKCFhZGROZXcpIHtcbiAgICAgIG91ckluZGV4ID0gMDtcbiAgICAgIHNldFNlbGVjdGlvbihkb2MsIG5ldyBTZWxlY3Rpb24oW291clJhbmdlXSwgMCksIHNlbF9tb3VzZSk7XG4gICAgICBzdGFydFNlbCA9IGRvYy5zZWw7XG4gICAgfSBlbHNlIGlmIChvdXJJbmRleCA9PSAtMSkge1xuICAgICAgb3VySW5kZXggPSByYW5nZXMubGVuZ3RoO1xuICAgICAgc2V0U2VsZWN0aW9uKGRvYywgbm9ybWFsaXplU2VsZWN0aW9uKHJhbmdlcy5jb25jYXQoW291clJhbmdlXSksIG91ckluZGV4KSxcbiAgICAgICAgICAgICAgICAgICB7c2Nyb2xsOiBmYWxzZSwgb3JpZ2luOiBcIiptb3VzZVwifSk7XG4gICAgfSBlbHNlIGlmIChyYW5nZXMubGVuZ3RoID4gMSAmJiByYW5nZXNbb3VySW5kZXhdLmVtcHR5KCkgJiYgdHlwZSA9PSBcInNpbmdsZVwiICYmICFlLnNoaWZ0S2V5KSB7XG4gICAgICBzZXRTZWxlY3Rpb24oZG9jLCBub3JtYWxpemVTZWxlY3Rpb24ocmFuZ2VzLnNsaWNlKDAsIG91ckluZGV4KS5jb25jYXQocmFuZ2VzLnNsaWNlKG91ckluZGV4ICsgMSkpLCAwKSxcbiAgICAgICAgICAgICAgICAgICB7c2Nyb2xsOiBmYWxzZSwgb3JpZ2luOiBcIiptb3VzZVwifSk7XG4gICAgICBzdGFydFNlbCA9IGRvYy5zZWw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcGxhY2VPbmVTZWxlY3Rpb24oZG9jLCBvdXJJbmRleCwgb3VyUmFuZ2UsIHNlbF9tb3VzZSk7XG4gICAgfVxuXG4gICAgdmFyIGxhc3RQb3MgPSBzdGFydDtcbiAgICBmdW5jdGlvbiBleHRlbmRUbyhwb3MpIHtcbiAgICAgIGlmIChjbXAobGFzdFBvcywgcG9zKSA9PSAwKSByZXR1cm47XG4gICAgICBsYXN0UG9zID0gcG9zO1xuXG4gICAgICBpZiAodHlwZSA9PSBcInJlY3RcIikge1xuICAgICAgICB2YXIgcmFuZ2VzID0gW10sIHRhYlNpemUgPSBjbS5vcHRpb25zLnRhYlNpemU7XG4gICAgICAgIHZhciBzdGFydENvbCA9IGNvdW50Q29sdW1uKGdldExpbmUoZG9jLCBzdGFydC5saW5lKS50ZXh0LCBzdGFydC5jaCwgdGFiU2l6ZSk7XG4gICAgICAgIHZhciBwb3NDb2wgPSBjb3VudENvbHVtbihnZXRMaW5lKGRvYywgcG9zLmxpbmUpLnRleHQsIHBvcy5jaCwgdGFiU2l6ZSk7XG4gICAgICAgIHZhciBsZWZ0ID0gTWF0aC5taW4oc3RhcnRDb2wsIHBvc0NvbCksIHJpZ2h0ID0gTWF0aC5tYXgoc3RhcnRDb2wsIHBvc0NvbCk7XG4gICAgICAgIGZvciAodmFyIGxpbmUgPSBNYXRoLm1pbihzdGFydC5saW5lLCBwb3MubGluZSksIGVuZCA9IE1hdGgubWluKGNtLmxhc3RMaW5lKCksIE1hdGgubWF4KHN0YXJ0LmxpbmUsIHBvcy5saW5lKSk7XG4gICAgICAgICAgICAgbGluZSA8PSBlbmQ7IGxpbmUrKykge1xuICAgICAgICAgIHZhciB0ZXh0ID0gZ2V0TGluZShkb2MsIGxpbmUpLnRleHQsIGxlZnRQb3MgPSBmaW5kQ29sdW1uKHRleHQsIGxlZnQsIHRhYlNpemUpO1xuICAgICAgICAgIGlmIChsZWZ0ID09IHJpZ2h0KVxuICAgICAgICAgICAgcmFuZ2VzLnB1c2gobmV3IFJhbmdlKFBvcyhsaW5lLCBsZWZ0UG9zKSwgUG9zKGxpbmUsIGxlZnRQb3MpKSk7XG4gICAgICAgICAgZWxzZSBpZiAodGV4dC5sZW5ndGggPiBsZWZ0UG9zKVxuICAgICAgICAgICAgcmFuZ2VzLnB1c2gobmV3IFJhbmdlKFBvcyhsaW5lLCBsZWZ0UG9zKSwgUG9zKGxpbmUsIGZpbmRDb2x1bW4odGV4dCwgcmlnaHQsIHRhYlNpemUpKSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmFuZ2VzLmxlbmd0aCkgcmFuZ2VzLnB1c2gobmV3IFJhbmdlKHN0YXJ0LCBzdGFydCkpO1xuICAgICAgICBzZXRTZWxlY3Rpb24oZG9jLCBub3JtYWxpemVTZWxlY3Rpb24oc3RhcnRTZWwucmFuZ2VzLnNsaWNlKDAsIG91ckluZGV4KS5jb25jYXQocmFuZ2VzKSwgb3VySW5kZXgpLFxuICAgICAgICAgICAgICAgICAgICAge29yaWdpbjogXCIqbW91c2VcIiwgc2Nyb2xsOiBmYWxzZX0pO1xuICAgICAgICBjbS5zY3JvbGxJbnRvVmlldyhwb3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG9sZFJhbmdlID0gb3VyUmFuZ2U7XG4gICAgICAgIHZhciBhbmNob3IgPSBvbGRSYW5nZS5hbmNob3IsIGhlYWQgPSBwb3M7XG4gICAgICAgIGlmICh0eXBlICE9IFwic2luZ2xlXCIpIHtcbiAgICAgICAgICBpZiAodHlwZSA9PSBcImRvdWJsZVwiKVxuICAgICAgICAgICAgdmFyIHJhbmdlID0gY20uZmluZFdvcmRBdChwb3MpO1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHZhciByYW5nZSA9IG5ldyBSYW5nZShQb3MocG9zLmxpbmUsIDApLCBjbGlwUG9zKGRvYywgUG9zKHBvcy5saW5lICsgMSwgMCkpKTtcbiAgICAgICAgICBpZiAoY21wKHJhbmdlLmFuY2hvciwgYW5jaG9yKSA+IDApIHtcbiAgICAgICAgICAgIGhlYWQgPSByYW5nZS5oZWFkO1xuICAgICAgICAgICAgYW5jaG9yID0gbWluUG9zKG9sZFJhbmdlLmZyb20oKSwgcmFuZ2UuYW5jaG9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGVhZCA9IHJhbmdlLmFuY2hvcjtcbiAgICAgICAgICAgIGFuY2hvciA9IG1heFBvcyhvbGRSYW5nZS50bygpLCByYW5nZS5oZWFkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJhbmdlcyA9IHN0YXJ0U2VsLnJhbmdlcy5zbGljZSgwKTtcbiAgICAgICAgcmFuZ2VzW291ckluZGV4XSA9IG5ldyBSYW5nZShjbGlwUG9zKGRvYywgYW5jaG9yKSwgaGVhZCk7XG4gICAgICAgIHNldFNlbGVjdGlvbihkb2MsIG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMsIG91ckluZGV4KSwgc2VsX21vdXNlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZWRpdG9yU2l6ZSA9IGRpc3BsYXkud3JhcHBlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAvLyBVc2VkIHRvIGVuc3VyZSB0aW1lb3V0IHJlLXRyaWVzIGRvbid0IGZpcmUgd2hlbiBhbm90aGVyIGV4dGVuZFxuICAgIC8vIGhhcHBlbmVkIGluIHRoZSBtZWFudGltZSAoY2xlYXJUaW1lb3V0IGlzbid0IHJlbGlhYmxlIC0tIGF0XG4gICAgLy8gbGVhc3Qgb24gQ2hyb21lLCB0aGUgdGltZW91dHMgc3RpbGwgaGFwcGVuIGV2ZW4gd2hlbiBjbGVhcmVkLFxuICAgIC8vIGlmIHRoZSBjbGVhciBoYXBwZW5zIGFmdGVyIHRoZWlyIHNjaGVkdWxlZCBmaXJpbmcgdGltZSkuXG4gICAgdmFyIGNvdW50ZXIgPSAwO1xuXG4gICAgZnVuY3Rpb24gZXh0ZW5kKGUpIHtcbiAgICAgIHZhciBjdXJDb3VudCA9ICsrY291bnRlcjtcbiAgICAgIHZhciBjdXIgPSBwb3NGcm9tTW91c2UoY20sIGUsIHRydWUsIHR5cGUgPT0gXCJyZWN0XCIpO1xuICAgICAgaWYgKCFjdXIpIHJldHVybjtcbiAgICAgIGlmIChjbXAoY3VyLCBsYXN0UG9zKSAhPSAwKSB7XG4gICAgICAgIGNtLmN1ck9wLmZvY3VzID0gYWN0aXZlRWx0KCk7XG4gICAgICAgIGV4dGVuZFRvKGN1cik7XG4gICAgICAgIHZhciB2aXNpYmxlID0gdmlzaWJsZUxpbmVzKGRpc3BsYXksIGRvYyk7XG4gICAgICAgIGlmIChjdXIubGluZSA+PSB2aXNpYmxlLnRvIHx8IGN1ci5saW5lIDwgdmlzaWJsZS5mcm9tKVxuICAgICAgICAgIHNldFRpbWVvdXQob3BlcmF0aW9uKGNtLCBmdW5jdGlvbigpe2lmIChjb3VudGVyID09IGN1ckNvdW50KSBleHRlbmQoZSk7fSksIDE1MCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgb3V0c2lkZSA9IGUuY2xpZW50WSA8IGVkaXRvclNpemUudG9wID8gLTIwIDogZS5jbGllbnRZID4gZWRpdG9yU2l6ZS5ib3R0b20gPyAyMCA6IDA7XG4gICAgICAgIGlmIChvdXRzaWRlKSBzZXRUaW1lb3V0KG9wZXJhdGlvbihjbSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGNvdW50ZXIgIT0gY3VyQ291bnQpIHJldHVybjtcbiAgICAgICAgICBkaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcCArPSBvdXRzaWRlO1xuICAgICAgICAgIGV4dGVuZChlKTtcbiAgICAgICAgfSksIDUwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkb25lKGUpIHtcbiAgICAgIGNtLnN0YXRlLnNlbGVjdGluZ1RleHQgPSBmYWxzZTtcbiAgICAgIGNvdW50ZXIgPSBJbmZpbml0eTtcbiAgICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICBkaXNwbGF5LmlucHV0LmZvY3VzKCk7XG4gICAgICBvZmYoZG9jdW1lbnQsIFwibW91c2Vtb3ZlXCIsIG1vdmUpO1xuICAgICAgb2ZmKGRvY3VtZW50LCBcIm1vdXNldXBcIiwgdXApO1xuICAgICAgZG9jLmhpc3RvcnkubGFzdFNlbE9yaWdpbiA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIG1vdmUgPSBvcGVyYXRpb24oY20sIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmICghZV9idXR0b24oZSkpIGRvbmUoZSk7XG4gICAgICBlbHNlIGV4dGVuZChlKTtcbiAgICB9KTtcbiAgICB2YXIgdXAgPSBvcGVyYXRpb24oY20sIGRvbmUpO1xuICAgIGNtLnN0YXRlLnNlbGVjdGluZ1RleHQgPSB1cDtcbiAgICBvbihkb2N1bWVudCwgXCJtb3VzZW1vdmVcIiwgbW92ZSk7XG4gICAgb24oZG9jdW1lbnQsIFwibW91c2V1cFwiLCB1cCk7XG4gIH1cblxuICAvLyBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXZlbnQgaGFwcGVuZWQgaW4gdGhlIGd1dHRlciwgYW5kIGZpcmVzIHRoZVxuICAvLyBoYW5kbGVycyBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgZXZlbnQuXG4gIGZ1bmN0aW9uIGd1dHRlckV2ZW50KGNtLCBlLCB0eXBlLCBwcmV2ZW50LCBzaWduYWxmbikge1xuICAgIHRyeSB7IHZhciBtWCA9IGUuY2xpZW50WCwgbVkgPSBlLmNsaWVudFk7IH1cbiAgICBjYXRjaChlKSB7IHJldHVybiBmYWxzZTsgfVxuICAgIGlmIChtWCA+PSBNYXRoLmZsb29yKGNtLmRpc3BsYXkuZ3V0dGVycy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCkpIHJldHVybiBmYWxzZTtcbiAgICBpZiAocHJldmVudCkgZV9wcmV2ZW50RGVmYXVsdChlKTtcblxuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheTtcbiAgICB2YXIgbGluZUJveCA9IGRpc3BsYXkubGluZURpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmIChtWSA+IGxpbmVCb3guYm90dG9tIHx8ICFoYXNIYW5kbGVyKGNtLCB0eXBlKSkgcmV0dXJuIGVfZGVmYXVsdFByZXZlbnRlZChlKTtcbiAgICBtWSAtPSBsaW5lQm94LnRvcCAtIGRpc3BsYXkudmlld09mZnNldDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY20ub3B0aW9ucy5ndXR0ZXJzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgZyA9IGRpc3BsYXkuZ3V0dGVycy5jaGlsZE5vZGVzW2ldO1xuICAgICAgaWYgKGcgJiYgZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCA+PSBtWCkge1xuICAgICAgICB2YXIgbGluZSA9IGxpbmVBdEhlaWdodChjbS5kb2MsIG1ZKTtcbiAgICAgICAgdmFyIGd1dHRlciA9IGNtLm9wdGlvbnMuZ3V0dGVyc1tpXTtcbiAgICAgICAgc2lnbmFsZm4oY20sIHR5cGUsIGNtLCBsaW5lLCBndXR0ZXIsIGUpO1xuICAgICAgICByZXR1cm4gZV9kZWZhdWx0UHJldmVudGVkKGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNsaWNrSW5HdXR0ZXIoY20sIGUpIHtcbiAgICByZXR1cm4gZ3V0dGVyRXZlbnQoY20sIGUsIFwiZ3V0dGVyQ2xpY2tcIiwgdHJ1ZSwgc2lnbmFsTGF0ZXIpO1xuICB9XG5cbiAgLy8gS2x1ZGdlIHRvIHdvcmsgYXJvdW5kIHN0cmFuZ2UgSUUgYmVoYXZpb3Igd2hlcmUgaXQnbGwgc29tZXRpbWVzXG4gIC8vIHJlLWZpcmUgYSBzZXJpZXMgb2YgZHJhZy1yZWxhdGVkIGV2ZW50cyByaWdodCBhZnRlciB0aGUgZHJvcCAoIzE1NTEpXG4gIHZhciBsYXN0RHJvcCA9IDA7XG5cbiAgZnVuY3Rpb24gb25Ecm9wKGUpIHtcbiAgICB2YXIgY20gPSB0aGlzO1xuICAgIGNsZWFyRHJhZ0N1cnNvcihjbSk7XG4gICAgaWYgKHNpZ25hbERPTUV2ZW50KGNtLCBlKSB8fCBldmVudEluV2lkZ2V0KGNtLmRpc3BsYXksIGUpKVxuICAgICAgcmV0dXJuO1xuICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgaWYgKGllKSBsYXN0RHJvcCA9ICtuZXcgRGF0ZTtcbiAgICB2YXIgcG9zID0gcG9zRnJvbU1vdXNlKGNtLCBlLCB0cnVlKSwgZmlsZXMgPSBlLmRhdGFUcmFuc2Zlci5maWxlcztcbiAgICBpZiAoIXBvcyB8fCBpc1JlYWRPbmx5KGNtKSkgcmV0dXJuO1xuICAgIC8vIE1pZ2h0IGJlIGEgZmlsZSBkcm9wLCBpbiB3aGljaCBjYXNlIHdlIHNpbXBseSBleHRyYWN0IHRoZSB0ZXh0XG4gICAgLy8gYW5kIGluc2VydCBpdC5cbiAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoICYmIHdpbmRvdy5GaWxlUmVhZGVyICYmIHdpbmRvdy5GaWxlKSB7XG4gICAgICB2YXIgbiA9IGZpbGVzLmxlbmd0aCwgdGV4dCA9IEFycmF5KG4pLCByZWFkID0gMDtcbiAgICAgIHZhciBsb2FkRmlsZSA9IGZ1bmN0aW9uKGZpbGUsIGkpIHtcbiAgICAgICAgaWYgKGNtLm9wdGlvbnMuYWxsb3dEcm9wRmlsZVR5cGVzICYmXG4gICAgICAgICAgICBpbmRleE9mKGNtLm9wdGlvbnMuYWxsb3dEcm9wRmlsZVR5cGVzLCBmaWxlLnR5cGUpID09IC0xKVxuICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXI7XG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBvcGVyYXRpb24oY20sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb250ZW50ID0gcmVhZGVyLnJlc3VsdDtcbiAgICAgICAgICBpZiAoL1tcXHgwMC1cXHgwOFxceDBlLVxceDFmXXsyfS8udGVzdChjb250ZW50KSkgY29udGVudCA9IFwiXCI7XG4gICAgICAgICAgdGV4dFtpXSA9IGNvbnRlbnQ7XG4gICAgICAgICAgaWYgKCsrcmVhZCA9PSBuKSB7XG4gICAgICAgICAgICBwb3MgPSBjbGlwUG9zKGNtLmRvYywgcG9zKTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2UgPSB7ZnJvbTogcG9zLCB0bzogcG9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjbS5kb2Muc3BsaXRMaW5lcyh0ZXh0LmpvaW4oY20uZG9jLmxpbmVTZXBhcmF0b3IoKSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW46IFwicGFzdGVcIn07XG4gICAgICAgICAgICBtYWtlQ2hhbmdlKGNtLmRvYywgY2hhbmdlKTtcbiAgICAgICAgICAgIHNldFNlbGVjdGlvblJlcGxhY2VIaXN0b3J5KGNtLmRvYywgc2ltcGxlU2VsZWN0aW9uKHBvcywgY2hhbmdlRW5kKGNoYW5nZSkpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbiAgICAgIH07XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSkgbG9hZEZpbGUoZmlsZXNbaV0sIGkpO1xuICAgIH0gZWxzZSB7IC8vIE5vcm1hbCBkcm9wXG4gICAgICAvLyBEb24ndCBkbyBhIHJlcGxhY2UgaWYgdGhlIGRyb3AgaGFwcGVuZWQgaW5zaWRlIG9mIHRoZSBzZWxlY3RlZCB0ZXh0LlxuICAgICAgaWYgKGNtLnN0YXRlLmRyYWdnaW5nVGV4dCAmJiBjbS5kb2Muc2VsLmNvbnRhaW5zKHBvcykgPiAtMSkge1xuICAgICAgICBjbS5zdGF0ZS5kcmFnZ2luZ1RleHQoZSk7XG4gICAgICAgIC8vIEVuc3VyZSB0aGUgZWRpdG9yIGlzIHJlLWZvY3VzZWRcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtjbS5kaXNwbGF5LmlucHV0LmZvY3VzKCk7fSwgMjApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgdGV4dCA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJUZXh0XCIpO1xuICAgICAgICBpZiAodGV4dCkge1xuICAgICAgICAgIGlmIChjbS5zdGF0ZS5kcmFnZ2luZ1RleHQgJiYgIShtYWMgPyBlLmFsdEtleSA6IGUuY3RybEtleSkpXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSBjbS5saXN0U2VsZWN0aW9ucygpO1xuICAgICAgICAgIHNldFNlbGVjdGlvbk5vVW5kbyhjbS5kb2MsIHNpbXBsZVNlbGVjdGlvbihwb3MsIHBvcykpO1xuICAgICAgICAgIGlmIChzZWxlY3RlZCkgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxlY3RlZC5sZW5ndGg7ICsraSlcbiAgICAgICAgICAgIHJlcGxhY2VSYW5nZShjbS5kb2MsIFwiXCIsIHNlbGVjdGVkW2ldLmFuY2hvciwgc2VsZWN0ZWRbaV0uaGVhZCwgXCJkcmFnXCIpO1xuICAgICAgICAgIGNtLnJlcGxhY2VTZWxlY3Rpb24odGV4dCwgXCJhcm91bmRcIiwgXCJwYXN0ZVwiKTtcbiAgICAgICAgICBjbS5kaXNwbGF5LmlucHV0LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNhdGNoKGUpe31cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvbkRyYWdTdGFydChjbSwgZSkge1xuICAgIGlmIChpZSAmJiAoIWNtLnN0YXRlLmRyYWdnaW5nVGV4dCB8fCArbmV3IERhdGUgLSBsYXN0RHJvcCA8IDEwMCkpIHsgZV9zdG9wKGUpOyByZXR1cm47IH1cbiAgICBpZiAoc2lnbmFsRE9NRXZlbnQoY20sIGUpIHx8IGV2ZW50SW5XaWRnZXQoY20uZGlzcGxheSwgZSkpIHJldHVybjtcblxuICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJUZXh0XCIsIGNtLmdldFNlbGVjdGlvbigpKTtcblxuICAgIC8vIFVzZSBkdW1teSBpbWFnZSBpbnN0ZWFkIG9mIGRlZmF1bHQgYnJvd3NlcnMgaW1hZ2UuXG4gICAgLy8gUmVjZW50IFNhZmFyaSAofjYuMC4yKSBoYXZlIGEgdGVuZGVuY3kgdG8gc2VnZmF1bHQgd2hlbiB0aGlzIGhhcHBlbnMsIHNvIHdlIGRvbid0IGRvIGl0IHRoZXJlLlxuICAgIGlmIChlLmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UgJiYgIXNhZmFyaSkge1xuICAgICAgdmFyIGltZyA9IGVsdChcImltZ1wiLCBudWxsLCBudWxsLCBcInBvc2l0aW9uOiBmaXhlZDsgbGVmdDogMDsgdG9wOiAwO1wiKTtcbiAgICAgIGltZy5zcmMgPSBcImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBQUFBQUNINUJBRUtBQUVBTEFBQUFBQUJBQUVBQUFJQ1RBRUFPdz09XCI7XG4gICAgICBpZiAocHJlc3RvKSB7XG4gICAgICAgIGltZy53aWR0aCA9IGltZy5oZWlnaHQgPSAxO1xuICAgICAgICBjbS5kaXNwbGF5LndyYXBwZXIuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICAgICAgLy8gRm9yY2UgYSByZWxheW91dCwgb3IgT3BlcmEgd29uJ3QgdXNlIG91ciBpbWFnZSBmb3Igc29tZSBvYnNjdXJlIHJlYXNvblxuICAgICAgICBpbWcuX3RvcCA9IGltZy5vZmZzZXRUb3A7XG4gICAgICB9XG4gICAgICBlLmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoaW1nLCAwLCAwKTtcbiAgICAgIGlmIChwcmVzdG8pIGltZy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGltZyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25EcmFnT3ZlcihjbSwgZSkge1xuICAgIHZhciBwb3MgPSBwb3NGcm9tTW91c2UoY20sIGUpO1xuICAgIGlmICghcG9zKSByZXR1cm47XG4gICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgZHJhd1NlbGVjdGlvbkN1cnNvcihjbSwgcG9zLCBmcmFnKTtcbiAgICBpZiAoIWNtLmRpc3BsYXkuZHJhZ0N1cnNvcikge1xuICAgICAgY20uZGlzcGxheS5kcmFnQ3Vyc29yID0gZWx0KFwiZGl2XCIsIG51bGwsIFwiQ29kZU1pcnJvci1jdXJzb3JzIENvZGVNaXJyb3ItZHJhZ2N1cnNvcnNcIik7XG4gICAgICBjbS5kaXNwbGF5LmxpbmVTcGFjZS5pbnNlcnRCZWZvcmUoY20uZGlzcGxheS5kcmFnQ3Vyc29yLCBjbS5kaXNwbGF5LmN1cnNvckRpdik7XG4gICAgfVxuICAgIHJlbW92ZUNoaWxkcmVuQW5kQWRkKGNtLmRpc3BsYXkuZHJhZ0N1cnNvciwgZnJhZyk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhckRyYWdDdXJzb3IoY20pIHtcbiAgICBpZiAoY20uZGlzcGxheS5kcmFnQ3Vyc29yKSB7XG4gICAgICBjbS5kaXNwbGF5LmxpbmVTcGFjZS5yZW1vdmVDaGlsZChjbS5kaXNwbGF5LmRyYWdDdXJzb3IpO1xuICAgICAgY20uZGlzcGxheS5kcmFnQ3Vyc29yID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBTQ1JPTEwgRVZFTlRTXG5cbiAgLy8gU3luYyB0aGUgc2Nyb2xsYWJsZSBhcmVhIGFuZCBzY3JvbGxiYXJzLCBlbnN1cmUgdGhlIHZpZXdwb3J0XG4gIC8vIGNvdmVycyB0aGUgdmlzaWJsZSBhcmVhLlxuICBmdW5jdGlvbiBzZXRTY3JvbGxUb3AoY20sIHZhbCkge1xuICAgIGlmIChNYXRoLmFicyhjbS5kb2Muc2Nyb2xsVG9wIC0gdmFsKSA8IDIpIHJldHVybjtcbiAgICBjbS5kb2Muc2Nyb2xsVG9wID0gdmFsO1xuICAgIGlmICghZ2Vja28pIHVwZGF0ZURpc3BsYXlTaW1wbGUoY20sIHt0b3A6IHZhbH0pO1xuICAgIGlmIChjbS5kaXNwbGF5LnNjcm9sbGVyLnNjcm9sbFRvcCAhPSB2YWwpIGNtLmRpc3BsYXkuc2Nyb2xsZXIuc2Nyb2xsVG9wID0gdmFsO1xuICAgIGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxUb3AodmFsKTtcbiAgICBpZiAoZ2Vja28pIHVwZGF0ZURpc3BsYXlTaW1wbGUoY20pO1xuICAgIHN0YXJ0V29ya2VyKGNtLCAxMDApO1xuICB9XG4gIC8vIFN5bmMgc2Nyb2xsZXIgYW5kIHNjcm9sbGJhciwgZW5zdXJlIHRoZSBndXR0ZXIgZWxlbWVudHMgYXJlXG4gIC8vIGFsaWduZWQuXG4gIGZ1bmN0aW9uIHNldFNjcm9sbExlZnQoY20sIHZhbCwgaXNTY3JvbGxlcikge1xuICAgIGlmIChpc1Njcm9sbGVyID8gdmFsID09IGNtLmRvYy5zY3JvbGxMZWZ0IDogTWF0aC5hYnMoY20uZG9jLnNjcm9sbExlZnQgLSB2YWwpIDwgMikgcmV0dXJuO1xuICAgIHZhbCA9IE1hdGgubWluKHZhbCwgY20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxXaWR0aCAtIGNtLmRpc3BsYXkuc2Nyb2xsZXIuY2xpZW50V2lkdGgpO1xuICAgIGNtLmRvYy5zY3JvbGxMZWZ0ID0gdmFsO1xuICAgIGFsaWduSG9yaXpvbnRhbGx5KGNtKTtcbiAgICBpZiAoY20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0ICE9IHZhbCkgY20uZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0ID0gdmFsO1xuICAgIGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxMZWZ0KHZhbCk7XG4gIH1cblxuICAvLyBTaW5jZSB0aGUgZGVsdGEgdmFsdWVzIHJlcG9ydGVkIG9uIG1vdXNlIHdoZWVsIGV2ZW50cyBhcmVcbiAgLy8gdW5zdGFuZGFyZGl6ZWQgYmV0d2VlbiBicm93c2VycyBhbmQgZXZlbiBicm93c2VyIHZlcnNpb25zLCBhbmRcbiAgLy8gZ2VuZXJhbGx5IGhvcnJpYmx5IHVucHJlZGljdGFibGUsIHRoaXMgY29kZSBzdGFydHMgYnkgbWVhc3VyaW5nXG4gIC8vIHRoZSBzY3JvbGwgZWZmZWN0IHRoYXQgdGhlIGZpcnN0IGZldyBtb3VzZSB3aGVlbCBldmVudHMgaGF2ZSxcbiAgLy8gYW5kLCBmcm9tIHRoYXQsIGRldGVjdHMgdGhlIHdheSBpdCBjYW4gY29udmVydCBkZWx0YXMgdG8gcGl4ZWxcbiAgLy8gb2Zmc2V0cyBhZnRlcndhcmRzLlxuICAvL1xuICAvLyBUaGUgcmVhc29uIHdlIHdhbnQgdG8ga25vdyB0aGUgYW1vdW50IGEgd2hlZWwgZXZlbnQgd2lsbCBzY3JvbGxcbiAgLy8gaXMgdGhhdCBpdCBnaXZlcyB1cyBhIGNoYW5jZSB0byB1cGRhdGUgdGhlIGRpc3BsYXkgYmVmb3JlIHRoZVxuICAvLyBhY3R1YWwgc2Nyb2xsaW5nIGhhcHBlbnMsIHJlZHVjaW5nIGZsaWNrZXJpbmcuXG5cbiAgdmFyIHdoZWVsU2FtcGxlcyA9IDAsIHdoZWVsUGl4ZWxzUGVyVW5pdCA9IG51bGw7XG4gIC8vIEZpbGwgaW4gYSBicm93c2VyLWRldGVjdGVkIHN0YXJ0aW5nIHZhbHVlIG9uIGJyb3dzZXJzIHdoZXJlIHdlXG4gIC8vIGtub3cgb25lLiBUaGVzZSBkb24ndCBoYXZlIHRvIGJlIGFjY3VyYXRlIC0tIHRoZSByZXN1bHQgb2YgdGhlbVxuICAvLyBiZWluZyB3cm9uZyB3b3VsZCBqdXN0IGJlIGEgc2xpZ2h0IGZsaWNrZXIgb24gdGhlIGZpcnN0IHdoZWVsXG4gIC8vIHNjcm9sbCAoaWYgaXQgaXMgbGFyZ2UgZW5vdWdoKS5cbiAgaWYgKGllKSB3aGVlbFBpeGVsc1BlclVuaXQgPSAtLjUzO1xuICBlbHNlIGlmIChnZWNrbykgd2hlZWxQaXhlbHNQZXJVbml0ID0gMTU7XG4gIGVsc2UgaWYgKGNocm9tZSkgd2hlZWxQaXhlbHNQZXJVbml0ID0gLS43O1xuICBlbHNlIGlmIChzYWZhcmkpIHdoZWVsUGl4ZWxzUGVyVW5pdCA9IC0xLzM7XG5cbiAgdmFyIHdoZWVsRXZlbnREZWx0YSA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgZHggPSBlLndoZWVsRGVsdGFYLCBkeSA9IGUud2hlZWxEZWx0YVk7XG4gICAgaWYgKGR4ID09IG51bGwgJiYgZS5kZXRhaWwgJiYgZS5heGlzID09IGUuSE9SSVpPTlRBTF9BWElTKSBkeCA9IGUuZGV0YWlsO1xuICAgIGlmIChkeSA9PSBudWxsICYmIGUuZGV0YWlsICYmIGUuYXhpcyA9PSBlLlZFUlRJQ0FMX0FYSVMpIGR5ID0gZS5kZXRhaWw7XG4gICAgZWxzZSBpZiAoZHkgPT0gbnVsbCkgZHkgPSBlLndoZWVsRGVsdGE7XG4gICAgcmV0dXJuIHt4OiBkeCwgeTogZHl9O1xuICB9O1xuICBDb2RlTWlycm9yLndoZWVsRXZlbnRQaXhlbHMgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyIGRlbHRhID0gd2hlZWxFdmVudERlbHRhKGUpO1xuICAgIGRlbHRhLnggKj0gd2hlZWxQaXhlbHNQZXJVbml0O1xuICAgIGRlbHRhLnkgKj0gd2hlZWxQaXhlbHNQZXJVbml0O1xuICAgIHJldHVybiBkZWx0YTtcbiAgfTtcblxuICBmdW5jdGlvbiBvblNjcm9sbFdoZWVsKGNtLCBlKSB7XG4gICAgdmFyIGRlbHRhID0gd2hlZWxFdmVudERlbHRhKGUpLCBkeCA9IGRlbHRhLngsIGR5ID0gZGVsdGEueTtcblxuICAgIHZhciBkaXNwbGF5ID0gY20uZGlzcGxheSwgc2Nyb2xsID0gZGlzcGxheS5zY3JvbGxlcjtcbiAgICAvLyBRdWl0IGlmIHRoZXJlJ3Mgbm90aGluZyB0byBzY3JvbGwgaGVyZVxuICAgIHZhciBjYW5TY3JvbGxYID0gc2Nyb2xsLnNjcm9sbFdpZHRoID4gc2Nyb2xsLmNsaWVudFdpZHRoO1xuICAgIHZhciBjYW5TY3JvbGxZID0gc2Nyb2xsLnNjcm9sbEhlaWdodCA+IHNjcm9sbC5jbGllbnRIZWlnaHQ7XG4gICAgaWYgKCEoZHggJiYgY2FuU2Nyb2xsWCB8fCBkeSAmJiBjYW5TY3JvbGxZKSkgcmV0dXJuO1xuXG4gICAgLy8gV2Via2l0IGJyb3dzZXJzIG9uIE9TIFggYWJvcnQgbW9tZW50dW0gc2Nyb2xscyB3aGVuIHRoZSB0YXJnZXRcbiAgICAvLyBvZiB0aGUgc2Nyb2xsIGV2ZW50IGlzIHJlbW92ZWQgZnJvbSB0aGUgc2Nyb2xsYWJsZSBlbGVtZW50LlxuICAgIC8vIFRoaXMgaGFjayAoc2VlIHJlbGF0ZWQgY29kZSBpbiBwYXRjaERpc3BsYXkpIG1ha2VzIHN1cmUgdGhlXG4gICAgLy8gZWxlbWVudCBpcyBrZXB0IGFyb3VuZC5cbiAgICBpZiAoZHkgJiYgbWFjICYmIHdlYmtpdCkge1xuICAgICAgb3V0ZXI6IGZvciAodmFyIGN1ciA9IGUudGFyZ2V0LCB2aWV3ID0gZGlzcGxheS52aWV3OyBjdXIgIT0gc2Nyb2xsOyBjdXIgPSBjdXIucGFyZW50Tm9kZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAodmlld1tpXS5ub2RlID09IGN1cikge1xuICAgICAgICAgICAgY20uZGlzcGxheS5jdXJyZW50V2hlZWxUYXJnZXQgPSBjdXI7XG4gICAgICAgICAgICBicmVhayBvdXRlcjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBPbiBzb21lIGJyb3dzZXJzLCBob3Jpem9udGFsIHNjcm9sbGluZyB3aWxsIGNhdXNlIHJlZHJhd3MgdG9cbiAgICAvLyBoYXBwZW4gYmVmb3JlIHRoZSBndXR0ZXIgaGFzIGJlZW4gcmVhbGlnbmVkLCBjYXVzaW5nIGl0IHRvXG4gICAgLy8gd3JpZ2dsZSBhcm91bmQgaW4gYSBtb3N0IHVuc2VlbWx5IHdheS4gV2hlbiB3ZSBoYXZlIGFuXG4gICAgLy8gZXN0aW1hdGVkIHBpeGVscy9kZWx0YSB2YWx1ZSwgd2UganVzdCBoYW5kbGUgaG9yaXpvbnRhbFxuICAgIC8vIHNjcm9sbGluZyBlbnRpcmVseSBoZXJlLiBJdCdsbCBiZSBzbGlnaHRseSBvZmYgZnJvbSBuYXRpdmUsIGJ1dFxuICAgIC8vIGJldHRlciB0aGFuIGdsaXRjaGluZyBvdXQuXG4gICAgaWYgKGR4ICYmICFnZWNrbyAmJiAhcHJlc3RvICYmIHdoZWVsUGl4ZWxzUGVyVW5pdCAhPSBudWxsKSB7XG4gICAgICBpZiAoZHkgJiYgY2FuU2Nyb2xsWSlcbiAgICAgICAgc2V0U2Nyb2xsVG9wKGNtLCBNYXRoLm1heCgwLCBNYXRoLm1pbihzY3JvbGwuc2Nyb2xsVG9wICsgZHkgKiB3aGVlbFBpeGVsc1BlclVuaXQsIHNjcm9sbC5zY3JvbGxIZWlnaHQgLSBzY3JvbGwuY2xpZW50SGVpZ2h0KSkpO1xuICAgICAgc2V0U2Nyb2xsTGVmdChjbSwgTWF0aC5tYXgoMCwgTWF0aC5taW4oc2Nyb2xsLnNjcm9sbExlZnQgKyBkeCAqIHdoZWVsUGl4ZWxzUGVyVW5pdCwgc2Nyb2xsLnNjcm9sbFdpZHRoIC0gc2Nyb2xsLmNsaWVudFdpZHRoKSkpO1xuICAgICAgLy8gT25seSBwcmV2ZW50IGRlZmF1bHQgc2Nyb2xsaW5nIGlmIHZlcnRpY2FsIHNjcm9sbGluZyBpc1xuICAgICAgLy8gYWN0dWFsbHkgcG9zc2libGUuIE90aGVyd2lzZSwgaXQgY2F1c2VzIHZlcnRpY2FsIHNjcm9sbFxuICAgICAgLy8gaml0dGVyIG9uIE9TWCB0cmFja3BhZHMgd2hlbiBkZWx0YVggaXMgc21hbGwgYW5kIGRlbHRhWVxuICAgICAgLy8gaXMgbGFyZ2UgKGlzc3VlICMzNTc5KVxuICAgICAgaWYgKCFkeSB8fCAoZHkgJiYgY2FuU2Nyb2xsWSkpXG4gICAgICAgIGVfcHJldmVudERlZmF1bHQoZSk7XG4gICAgICBkaXNwbGF5LndoZWVsU3RhcnRYID0gbnVsbDsgLy8gQWJvcnQgbWVhc3VyZW1lbnQsIGlmIGluIHByb2dyZXNzXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gJ1Byb2plY3QnIHRoZSB2aXNpYmxlIHZpZXdwb3J0IHRvIGNvdmVyIHRoZSBhcmVhIHRoYXQgaXMgYmVpbmdcbiAgICAvLyBzY3JvbGxlZCBpbnRvIHZpZXcgKGlmIHdlIGtub3cgZW5vdWdoIHRvIGVzdGltYXRlIGl0KS5cbiAgICBpZiAoZHkgJiYgd2hlZWxQaXhlbHNQZXJVbml0ICE9IG51bGwpIHtcbiAgICAgIHZhciBwaXhlbHMgPSBkeSAqIHdoZWVsUGl4ZWxzUGVyVW5pdDtcbiAgICAgIHZhciB0b3AgPSBjbS5kb2Muc2Nyb2xsVG9wLCBib3QgPSB0b3AgKyBkaXNwbGF5LndyYXBwZXIuY2xpZW50SGVpZ2h0O1xuICAgICAgaWYgKHBpeGVscyA8IDApIHRvcCA9IE1hdGgubWF4KDAsIHRvcCArIHBpeGVscyAtIDUwKTtcbiAgICAgIGVsc2UgYm90ID0gTWF0aC5taW4oY20uZG9jLmhlaWdodCwgYm90ICsgcGl4ZWxzICsgNTApO1xuICAgICAgdXBkYXRlRGlzcGxheVNpbXBsZShjbSwge3RvcDogdG9wLCBib3R0b206IGJvdH0pO1xuICAgIH1cblxuICAgIGlmICh3aGVlbFNhbXBsZXMgPCAyMCkge1xuICAgICAgaWYgKGRpc3BsYXkud2hlZWxTdGFydFggPT0gbnVsbCkge1xuICAgICAgICBkaXNwbGF5LndoZWVsU3RhcnRYID0gc2Nyb2xsLnNjcm9sbExlZnQ7IGRpc3BsYXkud2hlZWxTdGFydFkgPSBzY3JvbGwuc2Nyb2xsVG9wO1xuICAgICAgICBkaXNwbGF5LndoZWVsRFggPSBkeDsgZGlzcGxheS53aGVlbERZID0gZHk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGRpc3BsYXkud2hlZWxTdGFydFggPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICAgIHZhciBtb3ZlZFggPSBzY3JvbGwuc2Nyb2xsTGVmdCAtIGRpc3BsYXkud2hlZWxTdGFydFg7XG4gICAgICAgICAgdmFyIG1vdmVkWSA9IHNjcm9sbC5zY3JvbGxUb3AgLSBkaXNwbGF5LndoZWVsU3RhcnRZO1xuICAgICAgICAgIHZhciBzYW1wbGUgPSAobW92ZWRZICYmIGRpc3BsYXkud2hlZWxEWSAmJiBtb3ZlZFkgLyBkaXNwbGF5LndoZWVsRFkpIHx8XG4gICAgICAgICAgICAobW92ZWRYICYmIGRpc3BsYXkud2hlZWxEWCAmJiBtb3ZlZFggLyBkaXNwbGF5LndoZWVsRFgpO1xuICAgICAgICAgIGRpc3BsYXkud2hlZWxTdGFydFggPSBkaXNwbGF5LndoZWVsU3RhcnRZID0gbnVsbDtcbiAgICAgICAgICBpZiAoIXNhbXBsZSkgcmV0dXJuO1xuICAgICAgICAgIHdoZWVsUGl4ZWxzUGVyVW5pdCA9ICh3aGVlbFBpeGVsc1BlclVuaXQgKiB3aGVlbFNhbXBsZXMgKyBzYW1wbGUpIC8gKHdoZWVsU2FtcGxlcyArIDEpO1xuICAgICAgICAgICsrd2hlZWxTYW1wbGVzO1xuICAgICAgICB9LCAyMDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGlzcGxheS53aGVlbERYICs9IGR4OyBkaXNwbGF5LndoZWVsRFkgKz0gZHk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gS0VZIEVWRU5UU1xuXG4gIC8vIFJ1biBhIGhhbmRsZXIgdGhhdCB3YXMgYm91bmQgdG8gYSBrZXkuXG4gIGZ1bmN0aW9uIGRvSGFuZGxlQmluZGluZyhjbSwgYm91bmQsIGRyb3BTaGlmdCkge1xuICAgIGlmICh0eXBlb2YgYm91bmQgPT0gXCJzdHJpbmdcIikge1xuICAgICAgYm91bmQgPSBjb21tYW5kc1tib3VuZF07XG4gICAgICBpZiAoIWJvdW5kKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8vIEVuc3VyZSBwcmV2aW91cyBpbnB1dCBoYXMgYmVlbiByZWFkLCBzbyB0aGF0IHRoZSBoYW5kbGVyIHNlZXMgYVxuICAgIC8vIGNvbnNpc3RlbnQgdmlldyBvZiB0aGUgZG9jdW1lbnRcbiAgICBjbS5kaXNwbGF5LmlucHV0LmVuc3VyZVBvbGxlZCgpO1xuICAgIHZhciBwcmV2U2hpZnQgPSBjbS5kaXNwbGF5LnNoaWZ0LCBkb25lID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChpc1JlYWRPbmx5KGNtKSkgY20uc3RhdGUuc3VwcHJlc3NFZGl0cyA9IHRydWU7XG4gICAgICBpZiAoZHJvcFNoaWZ0KSBjbS5kaXNwbGF5LnNoaWZ0ID0gZmFsc2U7XG4gICAgICBkb25lID0gYm91bmQoY20pICE9IFBhc3M7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGNtLmRpc3BsYXkuc2hpZnQgPSBwcmV2U2hpZnQ7XG4gICAgICBjbS5zdGF0ZS5zdXBwcmVzc0VkaXRzID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBkb25lO1xuICB9XG5cbiAgZnVuY3Rpb24gbG9va3VwS2V5Rm9yRWRpdG9yKGNtLCBuYW1lLCBoYW5kbGUpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNtLnN0YXRlLmtleU1hcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciByZXN1bHQgPSBsb29rdXBLZXkobmFtZSwgY20uc3RhdGUua2V5TWFwc1tpXSwgaGFuZGxlLCBjbSk7XG4gICAgICBpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICByZXR1cm4gKGNtLm9wdGlvbnMuZXh0cmFLZXlzICYmIGxvb2t1cEtleShuYW1lLCBjbS5vcHRpb25zLmV4dHJhS2V5cywgaGFuZGxlLCBjbSkpXG4gICAgICB8fCBsb29rdXBLZXkobmFtZSwgY20ub3B0aW9ucy5rZXlNYXAsIGhhbmRsZSwgY20pO1xuICB9XG5cbiAgdmFyIHN0b3BTZXEgPSBuZXcgRGVsYXllZDtcbiAgZnVuY3Rpb24gZGlzcGF0Y2hLZXkoY20sIG5hbWUsIGUsIGhhbmRsZSkge1xuICAgIHZhciBzZXEgPSBjbS5zdGF0ZS5rZXlTZXE7XG4gICAgaWYgKHNlcSkge1xuICAgICAgaWYgKGlzTW9kaWZpZXJLZXkobmFtZSkpIHJldHVybiBcImhhbmRsZWRcIjtcbiAgICAgIHN0b3BTZXEuc2V0KDUwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNtLnN0YXRlLmtleVNlcSA9PSBzZXEpIHtcbiAgICAgICAgICBjbS5zdGF0ZS5rZXlTZXEgPSBudWxsO1xuICAgICAgICAgIGNtLmRpc3BsYXkuaW5wdXQucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBuYW1lID0gc2VxICsgXCIgXCIgKyBuYW1lO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gbG9va3VwS2V5Rm9yRWRpdG9yKGNtLCBuYW1lLCBoYW5kbGUpO1xuXG4gICAgaWYgKHJlc3VsdCA9PSBcIm11bHRpXCIpXG4gICAgICBjbS5zdGF0ZS5rZXlTZXEgPSBuYW1lO1xuICAgIGlmIChyZXN1bHQgPT0gXCJoYW5kbGVkXCIpXG4gICAgICBzaWduYWxMYXRlcihjbSwgXCJrZXlIYW5kbGVkXCIsIGNtLCBuYW1lLCBlKTtcblxuICAgIGlmIChyZXN1bHQgPT0gXCJoYW5kbGVkXCIgfHwgcmVzdWx0ID09IFwibXVsdGlcIikge1xuICAgICAgZV9wcmV2ZW50RGVmYXVsdChlKTtcbiAgICAgIHJlc3RhcnRCbGluayhjbSk7XG4gICAgfVxuXG4gICAgaWYgKHNlcSAmJiAhcmVzdWx0ICYmIC9cXCckLy50ZXN0KG5hbWUpKSB7XG4gICAgICBlX3ByZXZlbnREZWZhdWx0KGUpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiAhIXJlc3VsdDtcbiAgfVxuXG4gIC8vIEhhbmRsZSBhIGtleSBmcm9tIHRoZSBrZXlkb3duIGV2ZW50LlxuICBmdW5jdGlvbiBoYW5kbGVLZXlCaW5kaW5nKGNtLCBlKSB7XG4gICAgdmFyIG5hbWUgPSBrZXlOYW1lKGUsIHRydWUpO1xuICAgIGlmICghbmFtZSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgaWYgKGUuc2hpZnRLZXkgJiYgIWNtLnN0YXRlLmtleVNlcSkge1xuICAgICAgLy8gRmlyc3QgdHJ5IHRvIHJlc29sdmUgZnVsbCBuYW1lIChpbmNsdWRpbmcgJ1NoaWZ0LScpLiBGYWlsaW5nXG4gICAgICAvLyB0aGF0LCBzZWUgaWYgdGhlcmUgaXMgYSBjdXJzb3ItbW90aW9uIGNvbW1hbmQgKHN0YXJ0aW5nIHdpdGhcbiAgICAgIC8vICdnbycpIGJvdW5kIHRvIHRoZSBrZXluYW1lIHdpdGhvdXQgJ1NoaWZ0LScuXG4gICAgICByZXR1cm4gZGlzcGF0Y2hLZXkoY20sIFwiU2hpZnQtXCIgKyBuYW1lLCBlLCBmdW5jdGlvbihiKSB7cmV0dXJuIGRvSGFuZGxlQmluZGluZyhjbSwgYiwgdHJ1ZSk7fSlcbiAgICAgICAgICB8fCBkaXNwYXRjaEtleShjbSwgbmFtZSwgZSwgZnVuY3Rpb24oYikge1xuICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBiID09IFwic3RyaW5nXCIgPyAvXmdvW0EtWl0vLnRlc3QoYikgOiBiLm1vdGlvbilcbiAgICAgICAgICAgICAgICAgcmV0dXJuIGRvSGFuZGxlQmluZGluZyhjbSwgYik7XG4gICAgICAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkaXNwYXRjaEtleShjbSwgbmFtZSwgZSwgZnVuY3Rpb24oYikgeyByZXR1cm4gZG9IYW5kbGVCaW5kaW5nKGNtLCBiKTsgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gSGFuZGxlIGEga2V5IGZyb20gdGhlIGtleXByZXNzIGV2ZW50XG4gIGZ1bmN0aW9uIGhhbmRsZUNoYXJCaW5kaW5nKGNtLCBlLCBjaCkge1xuICAgIHJldHVybiBkaXNwYXRjaEtleShjbSwgXCInXCIgKyBjaCArIFwiJ1wiLCBlLFxuICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihiKSB7IHJldHVybiBkb0hhbmRsZUJpbmRpbmcoY20sIGIsIHRydWUpOyB9KTtcbiAgfVxuXG4gIHZhciBsYXN0U3RvcHBlZEtleSA9IG51bGw7XG4gIGZ1bmN0aW9uIG9uS2V5RG93bihlKSB7XG4gICAgdmFyIGNtID0gdGhpcztcbiAgICBjbS5jdXJPcC5mb2N1cyA9IGFjdGl2ZUVsdCgpO1xuICAgIGlmIChzaWduYWxET01FdmVudChjbSwgZSkpIHJldHVybjtcbiAgICAvLyBJRSBkb2VzIHN0cmFuZ2UgdGhpbmdzIHdpdGggZXNjYXBlLlxuICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgMTEgJiYgZS5rZXlDb2RlID09IDI3KSBlLnJldHVyblZhbHVlID0gZmFsc2U7XG4gICAgdmFyIGNvZGUgPSBlLmtleUNvZGU7XG4gICAgY20uZGlzcGxheS5zaGlmdCA9IGNvZGUgPT0gMTYgfHwgZS5zaGlmdEtleTtcbiAgICB2YXIgaGFuZGxlZCA9IGhhbmRsZUtleUJpbmRpbmcoY20sIGUpO1xuICAgIGlmIChwcmVzdG8pIHtcbiAgICAgIGxhc3RTdG9wcGVkS2V5ID0gaGFuZGxlZCA/IGNvZGUgOiBudWxsO1xuICAgICAgLy8gT3BlcmEgaGFzIG5vIGN1dCBldmVudC4uLiB3ZSB0cnkgdG8gYXQgbGVhc3QgY2F0Y2ggdGhlIGtleSBjb21ib1xuICAgICAgaWYgKCFoYW5kbGVkICYmIGNvZGUgPT0gODggJiYgIWhhc0NvcHlFdmVudCAmJiAobWFjID8gZS5tZXRhS2V5IDogZS5jdHJsS2V5KSlcbiAgICAgICAgY20ucmVwbGFjZVNlbGVjdGlvbihcIlwiLCBudWxsLCBcImN1dFwiKTtcbiAgICB9XG5cbiAgICAvLyBUdXJuIG1vdXNlIGludG8gY3Jvc3NoYWlyIHdoZW4gQWx0IGlzIGhlbGQgb24gTWFjLlxuICAgIGlmIChjb2RlID09IDE4ICYmICEvXFxiQ29kZU1pcnJvci1jcm9zc2hhaXJcXGIvLnRlc3QoY20uZGlzcGxheS5saW5lRGl2LmNsYXNzTmFtZSkpXG4gICAgICBzaG93Q3Jvc3NIYWlyKGNtKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dDcm9zc0hhaXIoY20pIHtcbiAgICB2YXIgbGluZURpdiA9IGNtLmRpc3BsYXkubGluZURpdjtcbiAgICBhZGRDbGFzcyhsaW5lRGl2LCBcIkNvZGVNaXJyb3ItY3Jvc3NoYWlyXCIpO1xuXG4gICAgZnVuY3Rpb24gdXAoZSkge1xuICAgICAgaWYgKGUua2V5Q29kZSA9PSAxOCB8fCAhZS5hbHRLZXkpIHtcbiAgICAgICAgcm1DbGFzcyhsaW5lRGl2LCBcIkNvZGVNaXJyb3ItY3Jvc3NoYWlyXCIpO1xuICAgICAgICBvZmYoZG9jdW1lbnQsIFwia2V5dXBcIiwgdXApO1xuICAgICAgICBvZmYoZG9jdW1lbnQsIFwibW91c2VvdmVyXCIsIHVwKTtcbiAgICAgIH1cbiAgICB9XG4gICAgb24oZG9jdW1lbnQsIFwia2V5dXBcIiwgdXApO1xuICAgIG9uKGRvY3VtZW50LCBcIm1vdXNlb3ZlclwiLCB1cCk7XG4gIH1cblxuICBmdW5jdGlvbiBvbktleVVwKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09IDE2KSB0aGlzLmRvYy5zZWwuc2hpZnQgPSBmYWxzZTtcbiAgICBzaWduYWxET01FdmVudCh0aGlzLCBlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uS2V5UHJlc3MoZSkge1xuICAgIHZhciBjbSA9IHRoaXM7XG4gICAgaWYgKGV2ZW50SW5XaWRnZXQoY20uZGlzcGxheSwgZSkgfHwgc2lnbmFsRE9NRXZlbnQoY20sIGUpIHx8IGUuY3RybEtleSAmJiAhZS5hbHRLZXkgfHwgbWFjICYmIGUubWV0YUtleSkgcmV0dXJuO1xuICAgIHZhciBrZXlDb2RlID0gZS5rZXlDb2RlLCBjaGFyQ29kZSA9IGUuY2hhckNvZGU7XG4gICAgaWYgKHByZXN0byAmJiBrZXlDb2RlID09IGxhc3RTdG9wcGVkS2V5KSB7bGFzdFN0b3BwZWRLZXkgPSBudWxsOyBlX3ByZXZlbnREZWZhdWx0KGUpOyByZXR1cm47fVxuICAgIGlmICgocHJlc3RvICYmICghZS53aGljaCB8fCBlLndoaWNoIDwgMTApKSAmJiBoYW5kbGVLZXlCaW5kaW5nKGNtLCBlKSkgcmV0dXJuO1xuICAgIHZhciBjaCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUgPT0gbnVsbCA/IGtleUNvZGUgOiBjaGFyQ29kZSk7XG4gICAgaWYgKGhhbmRsZUNoYXJCaW5kaW5nKGNtLCBlLCBjaCkpIHJldHVybjtcbiAgICBjbS5kaXNwbGF5LmlucHV0Lm9uS2V5UHJlc3MoZSk7XG4gIH1cblxuICAvLyBGT0NVUy9CTFVSIEVWRU5UU1xuXG4gIGZ1bmN0aW9uIGRlbGF5Qmx1ckV2ZW50KGNtKSB7XG4gICAgY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQgPSB0cnVlO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQpIHtcbiAgICAgICAgY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQgPSBmYWxzZTtcbiAgICAgICAgb25CbHVyKGNtKTtcbiAgICAgIH1cbiAgICB9LCAxMDApO1xuICB9XG5cbiAgZnVuY3Rpb24gb25Gb2N1cyhjbSkge1xuICAgIGlmIChjbS5zdGF0ZS5kZWxheWluZ0JsdXJFdmVudCkgY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQgPSBmYWxzZTtcblxuICAgIGlmIChjbS5vcHRpb25zLnJlYWRPbmx5ID09IFwibm9jdXJzb3JcIikgcmV0dXJuO1xuICAgIGlmICghY20uc3RhdGUuZm9jdXNlZCkge1xuICAgICAgc2lnbmFsKGNtLCBcImZvY3VzXCIsIGNtKTtcbiAgICAgIGNtLnN0YXRlLmZvY3VzZWQgPSB0cnVlO1xuICAgICAgYWRkQ2xhc3MoY20uZGlzcGxheS53cmFwcGVyLCBcIkNvZGVNaXJyb3ItZm9jdXNlZFwiKTtcbiAgICAgIC8vIFRoaXMgdGVzdCBwcmV2ZW50cyB0aGlzIGZyb20gZmlyaW5nIHdoZW4gYSBjb250ZXh0XG4gICAgICAvLyBtZW51IGlzIGNsb3NlZCAoc2luY2UgdGhlIGlucHV0IHJlc2V0IHdvdWxkIGtpbGwgdGhlXG4gICAgICAvLyBzZWxlY3QtYWxsIGRldGVjdGlvbiBoYWNrKVxuICAgICAgaWYgKCFjbS5jdXJPcCAmJiBjbS5kaXNwbGF5LnNlbEZvckNvbnRleHRNZW51ICE9IGNtLmRvYy5zZWwpIHtcbiAgICAgICAgY20uZGlzcGxheS5pbnB1dC5yZXNldCgpO1xuICAgICAgICBpZiAod2Via2l0KSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjbS5kaXNwbGF5LmlucHV0LnJlc2V0KHRydWUpOyB9LCAyMCk7IC8vIElzc3VlICMxNzMwXG4gICAgICB9XG4gICAgICBjbS5kaXNwbGF5LmlucHV0LnJlY2VpdmVkRm9jdXMoKTtcbiAgICB9XG4gICAgcmVzdGFydEJsaW5rKGNtKTtcbiAgfVxuICBmdW5jdGlvbiBvbkJsdXIoY20pIHtcbiAgICBpZiAoY20uc3RhdGUuZGVsYXlpbmdCbHVyRXZlbnQpIHJldHVybjtcblxuICAgIGlmIChjbS5zdGF0ZS5mb2N1c2VkKSB7XG4gICAgICBzaWduYWwoY20sIFwiYmx1clwiLCBjbSk7XG4gICAgICBjbS5zdGF0ZS5mb2N1c2VkID0gZmFsc2U7XG4gICAgICBybUNsYXNzKGNtLmRpc3BsYXkud3JhcHBlciwgXCJDb2RlTWlycm9yLWZvY3VzZWRcIik7XG4gICAgfVxuICAgIGNsZWFySW50ZXJ2YWwoY20uZGlzcGxheS5ibGlua2VyKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge2lmICghY20uc3RhdGUuZm9jdXNlZCkgY20uZGlzcGxheS5zaGlmdCA9IGZhbHNlO30sIDE1MCk7XG4gIH1cblxuICAvLyBDT05URVhUIE1FTlUgSEFORExJTkdcblxuICAvLyBUbyBtYWtlIHRoZSBjb250ZXh0IG1lbnUgd29yaywgd2UgbmVlZCB0byBicmllZmx5IHVuaGlkZSB0aGVcbiAgLy8gdGV4dGFyZWEgKG1ha2luZyBpdCBhcyB1bm9idHJ1c2l2ZSBhcyBwb3NzaWJsZSkgdG8gbGV0IHRoZVxuICAvLyByaWdodC1jbGljayB0YWtlIGVmZmVjdCBvbiBpdC5cbiAgZnVuY3Rpb24gb25Db250ZXh0TWVudShjbSwgZSkge1xuICAgIGlmIChldmVudEluV2lkZ2V0KGNtLmRpc3BsYXksIGUpIHx8IGNvbnRleHRNZW51SW5HdXR0ZXIoY20sIGUpKSByZXR1cm47XG4gICAgaWYgKHNpZ25hbERPTUV2ZW50KGNtLCBlLCBcImNvbnRleHRtZW51XCIpKSByZXR1cm47XG4gICAgY20uZGlzcGxheS5pbnB1dC5vbkNvbnRleHRNZW51KGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gY29udGV4dE1lbnVJbkd1dHRlcihjbSwgZSkge1xuICAgIGlmICghaGFzSGFuZGxlcihjbSwgXCJndXR0ZXJDb250ZXh0TWVudVwiKSkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiBndXR0ZXJFdmVudChjbSwgZSwgXCJndXR0ZXJDb250ZXh0TWVudVwiLCBmYWxzZSwgc2lnbmFsKTtcbiAgfVxuXG4gIC8vIFVQREFUSU5HXG5cbiAgLy8gQ29tcHV0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGVuZCBvZiBhIGNoYW5nZSAoaXRzICd0bycgcHJvcGVydHlcbiAgLy8gcmVmZXJzIHRvIHRoZSBwcmUtY2hhbmdlIGVuZCkuXG4gIHZhciBjaGFuZ2VFbmQgPSBDb2RlTWlycm9yLmNoYW5nZUVuZCA9IGZ1bmN0aW9uKGNoYW5nZSkge1xuICAgIGlmICghY2hhbmdlLnRleHQpIHJldHVybiBjaGFuZ2UudG87XG4gICAgcmV0dXJuIFBvcyhjaGFuZ2UuZnJvbS5saW5lICsgY2hhbmdlLnRleHQubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgIGxzdChjaGFuZ2UudGV4dCkubGVuZ3RoICsgKGNoYW5nZS50ZXh0Lmxlbmd0aCA9PSAxID8gY2hhbmdlLmZyb20uY2ggOiAwKSk7XG4gIH07XG5cbiAgLy8gQWRqdXN0IGEgcG9zaXRpb24gdG8gcmVmZXIgdG8gdGhlIHBvc3QtY2hhbmdlIHBvc2l0aW9uIG9mIHRoZVxuICAvLyBzYW1lIHRleHQsIG9yIHRoZSBlbmQgb2YgdGhlIGNoYW5nZSBpZiB0aGUgY2hhbmdlIGNvdmVycyBpdC5cbiAgZnVuY3Rpb24gYWRqdXN0Rm9yQ2hhbmdlKHBvcywgY2hhbmdlKSB7XG4gICAgaWYgKGNtcChwb3MsIGNoYW5nZS5mcm9tKSA8IDApIHJldHVybiBwb3M7XG4gICAgaWYgKGNtcChwb3MsIGNoYW5nZS50bykgPD0gMCkgcmV0dXJuIGNoYW5nZUVuZChjaGFuZ2UpO1xuXG4gICAgdmFyIGxpbmUgPSBwb3MubGluZSArIGNoYW5nZS50ZXh0Lmxlbmd0aCAtIChjaGFuZ2UudG8ubGluZSAtIGNoYW5nZS5mcm9tLmxpbmUpIC0gMSwgY2ggPSBwb3MuY2g7XG4gICAgaWYgKHBvcy5saW5lID09IGNoYW5nZS50by5saW5lKSBjaCArPSBjaGFuZ2VFbmQoY2hhbmdlKS5jaCAtIGNoYW5nZS50by5jaDtcbiAgICByZXR1cm4gUG9zKGxpbmUsIGNoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXB1dGVTZWxBZnRlckNoYW5nZShkb2MsIGNoYW5nZSkge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvYy5zZWwucmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcmFuZ2UgPSBkb2Muc2VsLnJhbmdlc1tpXTtcbiAgICAgIG91dC5wdXNoKG5ldyBSYW5nZShhZGp1c3RGb3JDaGFuZ2UocmFuZ2UuYW5jaG9yLCBjaGFuZ2UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdEZvckNoYW5nZShyYW5nZS5oZWFkLCBjaGFuZ2UpKSk7XG4gICAgfVxuICAgIHJldHVybiBub3JtYWxpemVTZWxlY3Rpb24ob3V0LCBkb2Muc2VsLnByaW1JbmRleCk7XG4gIH1cblxuICBmdW5jdGlvbiBvZmZzZXRQb3MocG9zLCBvbGQsIG53KSB7XG4gICAgaWYgKHBvcy5saW5lID09IG9sZC5saW5lKVxuICAgICAgcmV0dXJuIFBvcyhudy5saW5lLCBwb3MuY2ggLSBvbGQuY2ggKyBudy5jaCk7XG4gICAgZWxzZVxuICAgICAgcmV0dXJuIFBvcyhudy5saW5lICsgKHBvcy5saW5lIC0gb2xkLmxpbmUpLCBwb3MuY2gpO1xuICB9XG5cbiAgLy8gVXNlZCBieSByZXBsYWNlU2VsZWN0aW9ucyB0byBhbGxvdyBtb3ZpbmcgdGhlIHNlbGVjdGlvbiB0byB0aGVcbiAgLy8gc3RhcnQgb3IgYXJvdW5kIHRoZSByZXBsYWNlZCB0ZXN0LiBIaW50IG1heSBiZSBcInN0YXJ0XCIgb3IgXCJhcm91bmRcIi5cbiAgZnVuY3Rpb24gY29tcHV0ZVJlcGxhY2VkU2VsKGRvYywgY2hhbmdlcywgaGludCkge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgb2xkUHJldiA9IFBvcyhkb2MuZmlyc3QsIDApLCBuZXdQcmV2ID0gb2xkUHJldjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjaGFuZ2UgPSBjaGFuZ2VzW2ldO1xuICAgICAgdmFyIGZyb20gPSBvZmZzZXRQb3MoY2hhbmdlLmZyb20sIG9sZFByZXYsIG5ld1ByZXYpO1xuICAgICAgdmFyIHRvID0gb2Zmc2V0UG9zKGNoYW5nZUVuZChjaGFuZ2UpLCBvbGRQcmV2LCBuZXdQcmV2KTtcbiAgICAgIG9sZFByZXYgPSBjaGFuZ2UudG87XG4gICAgICBuZXdQcmV2ID0gdG87XG4gICAgICBpZiAoaGludCA9PSBcImFyb3VuZFwiKSB7XG4gICAgICAgIHZhciByYW5nZSA9IGRvYy5zZWwucmFuZ2VzW2ldLCBpbnYgPSBjbXAocmFuZ2UuaGVhZCwgcmFuZ2UuYW5jaG9yKSA8IDA7XG4gICAgICAgIG91dFtpXSA9IG5ldyBSYW5nZShpbnYgPyB0byA6IGZyb20sIGludiA/IGZyb20gOiB0byk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRbaV0gPSBuZXcgUmFuZ2UoZnJvbSwgZnJvbSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgU2VsZWN0aW9uKG91dCwgZG9jLnNlbC5wcmltSW5kZXgpO1xuICB9XG5cbiAgLy8gQWxsb3cgXCJiZWZvcmVDaGFuZ2VcIiBldmVudCBoYW5kbGVycyB0byBpbmZsdWVuY2UgYSBjaGFuZ2VcbiAgZnVuY3Rpb24gZmlsdGVyQ2hhbmdlKGRvYywgY2hhbmdlLCB1cGRhdGUpIHtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgY2FuY2VsZWQ6IGZhbHNlLFxuICAgICAgZnJvbTogY2hhbmdlLmZyb20sXG4gICAgICB0bzogY2hhbmdlLnRvLFxuICAgICAgdGV4dDogY2hhbmdlLnRleHQsXG4gICAgICBvcmlnaW46IGNoYW5nZS5vcmlnaW4sXG4gICAgICBjYW5jZWw6IGZ1bmN0aW9uKCkgeyB0aGlzLmNhbmNlbGVkID0gdHJ1ZTsgfVxuICAgIH07XG4gICAgaWYgKHVwZGF0ZSkgb2JqLnVwZGF0ZSA9IGZ1bmN0aW9uKGZyb20sIHRvLCB0ZXh0LCBvcmlnaW4pIHtcbiAgICAgIGlmIChmcm9tKSB0aGlzLmZyb20gPSBjbGlwUG9zKGRvYywgZnJvbSk7XG4gICAgICBpZiAodG8pIHRoaXMudG8gPSBjbGlwUG9zKGRvYywgdG8pO1xuICAgICAgaWYgKHRleHQpIHRoaXMudGV4dCA9IHRleHQ7XG4gICAgICBpZiAob3JpZ2luICE9PSB1bmRlZmluZWQpIHRoaXMub3JpZ2luID0gb3JpZ2luO1xuICAgIH07XG4gICAgc2lnbmFsKGRvYywgXCJiZWZvcmVDaGFuZ2VcIiwgZG9jLCBvYmopO1xuICAgIGlmIChkb2MuY20pIHNpZ25hbChkb2MuY20sIFwiYmVmb3JlQ2hhbmdlXCIsIGRvYy5jbSwgb2JqKTtcblxuICAgIGlmIChvYmouY2FuY2VsZWQpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB7ZnJvbTogb2JqLmZyb20sIHRvOiBvYmoudG8sIHRleHQ6IG9iai50ZXh0LCBvcmlnaW46IG9iai5vcmlnaW59O1xuICB9XG5cbiAgLy8gQXBwbHkgYSBjaGFuZ2UgdG8gYSBkb2N1bWVudCwgYW5kIGFkZCBpdCB0byB0aGUgZG9jdW1lbnQnc1xuICAvLyBoaXN0b3J5LCBhbmQgcHJvcGFnYXRpbmcgaXQgdG8gYWxsIGxpbmtlZCBkb2N1bWVudHMuXG4gIGZ1bmN0aW9uIG1ha2VDaGFuZ2UoZG9jLCBjaGFuZ2UsIGlnbm9yZVJlYWRPbmx5KSB7XG4gICAgaWYgKGRvYy5jbSkge1xuICAgICAgaWYgKCFkb2MuY20uY3VyT3ApIHJldHVybiBvcGVyYXRpb24oZG9jLmNtLCBtYWtlQ2hhbmdlKShkb2MsIGNoYW5nZSwgaWdub3JlUmVhZE9ubHkpO1xuICAgICAgaWYgKGRvYy5jbS5zdGF0ZS5zdXBwcmVzc0VkaXRzKSByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGhhc0hhbmRsZXIoZG9jLCBcImJlZm9yZUNoYW5nZVwiKSB8fCBkb2MuY20gJiYgaGFzSGFuZGxlcihkb2MuY20sIFwiYmVmb3JlQ2hhbmdlXCIpKSB7XG4gICAgICBjaGFuZ2UgPSBmaWx0ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UsIHRydWUpO1xuICAgICAgaWYgKCFjaGFuZ2UpIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQb3NzaWJseSBzcGxpdCBvciBzdXBwcmVzcyB0aGUgdXBkYXRlIGJhc2VkIG9uIHRoZSBwcmVzZW5jZVxuICAgIC8vIG9mIHJlYWQtb25seSBzcGFucyBpbiBpdHMgcmFuZ2UuXG4gICAgdmFyIHNwbGl0ID0gc2F3UmVhZE9ubHlTcGFucyAmJiAhaWdub3JlUmVhZE9ubHkgJiYgcmVtb3ZlUmVhZE9ubHlSYW5nZXMoZG9jLCBjaGFuZ2UuZnJvbSwgY2hhbmdlLnRvKTtcbiAgICBpZiAoc3BsaXQpIHtcbiAgICAgIGZvciAodmFyIGkgPSBzcGxpdC5sZW5ndGggLSAxOyBpID49IDA7IC0taSlcbiAgICAgICAgbWFrZUNoYW5nZUlubmVyKGRvYywge2Zyb206IHNwbGl0W2ldLmZyb20sIHRvOiBzcGxpdFtpXS50bywgdGV4dDogaSA/IFtcIlwiXSA6IGNoYW5nZS50ZXh0fSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1ha2VDaGFuZ2VJbm5lcihkb2MsIGNoYW5nZSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbWFrZUNoYW5nZUlubmVyKGRvYywgY2hhbmdlKSB7XG4gICAgaWYgKGNoYW5nZS50ZXh0Lmxlbmd0aCA9PSAxICYmIGNoYW5nZS50ZXh0WzBdID09IFwiXCIgJiYgY21wKGNoYW5nZS5mcm9tLCBjaGFuZ2UudG8pID09IDApIHJldHVybjtcbiAgICB2YXIgc2VsQWZ0ZXIgPSBjb21wdXRlU2VsQWZ0ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UpO1xuICAgIGFkZENoYW5nZVRvSGlzdG9yeShkb2MsIGNoYW5nZSwgc2VsQWZ0ZXIsIGRvYy5jbSA/IGRvYy5jbS5jdXJPcC5pZCA6IE5hTik7XG5cbiAgICBtYWtlQ2hhbmdlU2luZ2xlRG9jKGRvYywgY2hhbmdlLCBzZWxBZnRlciwgc3RyZXRjaFNwYW5zT3ZlckNoYW5nZShkb2MsIGNoYW5nZSkpO1xuICAgIHZhciByZWJhc2VkID0gW107XG5cbiAgICBsaW5rZWREb2NzKGRvYywgZnVuY3Rpb24oZG9jLCBzaGFyZWRIaXN0KSB7XG4gICAgICBpZiAoIXNoYXJlZEhpc3QgJiYgaW5kZXhPZihyZWJhc2VkLCBkb2MuaGlzdG9yeSkgPT0gLTEpIHtcbiAgICAgICAgcmViYXNlSGlzdChkb2MuaGlzdG9yeSwgY2hhbmdlKTtcbiAgICAgICAgcmViYXNlZC5wdXNoKGRvYy5oaXN0b3J5KTtcbiAgICAgIH1cbiAgICAgIG1ha2VDaGFuZ2VTaW5nbGVEb2MoZG9jLCBjaGFuZ2UsIG51bGwsIHN0cmV0Y2hTcGFuc092ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UpKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFJldmVydCBhIGNoYW5nZSBzdG9yZWQgaW4gYSBkb2N1bWVudCdzIGhpc3RvcnkuXG4gIGZ1bmN0aW9uIG1ha2VDaGFuZ2VGcm9tSGlzdG9yeShkb2MsIHR5cGUsIGFsbG93U2VsZWN0aW9uT25seSkge1xuICAgIGlmIChkb2MuY20gJiYgZG9jLmNtLnN0YXRlLnN1cHByZXNzRWRpdHMpIHJldHVybjtcblxuICAgIHZhciBoaXN0ID0gZG9jLmhpc3RvcnksIGV2ZW50LCBzZWxBZnRlciA9IGRvYy5zZWw7XG4gICAgdmFyIHNvdXJjZSA9IHR5cGUgPT0gXCJ1bmRvXCIgPyBoaXN0LmRvbmUgOiBoaXN0LnVuZG9uZSwgZGVzdCA9IHR5cGUgPT0gXCJ1bmRvXCIgPyBoaXN0LnVuZG9uZSA6IGhpc3QuZG9uZTtcblxuICAgIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGlzIGEgdXNlYWJsZSBldmVudCAoc28gdGhhdCBjdHJsLXogd29uJ3RcbiAgICAvLyBuZWVkbGVzc2x5IGNsZWFyIHNlbGVjdGlvbiBldmVudHMpXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzb3VyY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgIGV2ZW50ID0gc291cmNlW2ldO1xuICAgICAgaWYgKGFsbG93U2VsZWN0aW9uT25seSA/IGV2ZW50LnJhbmdlcyAmJiAhZXZlbnQuZXF1YWxzKGRvYy5zZWwpIDogIWV2ZW50LnJhbmdlcylcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmIChpID09IHNvdXJjZS5sZW5ndGgpIHJldHVybjtcbiAgICBoaXN0Lmxhc3RPcmlnaW4gPSBoaXN0Lmxhc3RTZWxPcmlnaW4gPSBudWxsO1xuXG4gICAgZm9yICg7Oykge1xuICAgICAgZXZlbnQgPSBzb3VyY2UucG9wKCk7XG4gICAgICBpZiAoZXZlbnQucmFuZ2VzKSB7XG4gICAgICAgIHB1c2hTZWxlY3Rpb25Ub0hpc3RvcnkoZXZlbnQsIGRlc3QpO1xuICAgICAgICBpZiAoYWxsb3dTZWxlY3Rpb25Pbmx5ICYmICFldmVudC5lcXVhbHMoZG9jLnNlbCkpIHtcbiAgICAgICAgICBzZXRTZWxlY3Rpb24oZG9jLCBldmVudCwge2NsZWFyUmVkbzogZmFsc2V9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc2VsQWZ0ZXIgPSBldmVudDtcbiAgICAgIH1cbiAgICAgIGVsc2UgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8gQnVpbGQgdXAgYSByZXZlcnNlIGNoYW5nZSBvYmplY3QgdG8gYWRkIHRvIHRoZSBvcHBvc2l0ZSBoaXN0b3J5XG4gICAgLy8gc3RhY2sgKHJlZG8gd2hlbiB1bmRvaW5nLCBhbmQgdmljZSB2ZXJzYSkuXG4gICAgdmFyIGFudGlDaGFuZ2VzID0gW107XG4gICAgcHVzaFNlbGVjdGlvblRvSGlzdG9yeShzZWxBZnRlciwgZGVzdCk7XG4gICAgZGVzdC5wdXNoKHtjaGFuZ2VzOiBhbnRpQ2hhbmdlcywgZ2VuZXJhdGlvbjogaGlzdC5nZW5lcmF0aW9ufSk7XG4gICAgaGlzdC5nZW5lcmF0aW9uID0gZXZlbnQuZ2VuZXJhdGlvbiB8fCArK2hpc3QubWF4R2VuZXJhdGlvbjtcblxuICAgIHZhciBmaWx0ZXIgPSBoYXNIYW5kbGVyKGRvYywgXCJiZWZvcmVDaGFuZ2VcIikgfHwgZG9jLmNtICYmIGhhc0hhbmRsZXIoZG9jLmNtLCBcImJlZm9yZUNoYW5nZVwiKTtcblxuICAgIGZvciAodmFyIGkgPSBldmVudC5jaGFuZ2VzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICB2YXIgY2hhbmdlID0gZXZlbnQuY2hhbmdlc1tpXTtcbiAgICAgIGNoYW5nZS5vcmlnaW4gPSB0eXBlO1xuICAgICAgaWYgKGZpbHRlciAmJiAhZmlsdGVyQ2hhbmdlKGRvYywgY2hhbmdlLCBmYWxzZSkpIHtcbiAgICAgICAgc291cmNlLmxlbmd0aCA9IDA7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgYW50aUNoYW5nZXMucHVzaChoaXN0b3J5Q2hhbmdlRnJvbUNoYW5nZShkb2MsIGNoYW5nZSkpO1xuXG4gICAgICB2YXIgYWZ0ZXIgPSBpID8gY29tcHV0ZVNlbEFmdGVyQ2hhbmdlKGRvYywgY2hhbmdlKSA6IGxzdChzb3VyY2UpO1xuICAgICAgbWFrZUNoYW5nZVNpbmdsZURvYyhkb2MsIGNoYW5nZSwgYWZ0ZXIsIG1lcmdlT2xkU3BhbnMoZG9jLCBjaGFuZ2UpKTtcbiAgICAgIGlmICghaSAmJiBkb2MuY20pIGRvYy5jbS5zY3JvbGxJbnRvVmlldyh7ZnJvbTogY2hhbmdlLmZyb20sIHRvOiBjaGFuZ2VFbmQoY2hhbmdlKX0pO1xuICAgICAgdmFyIHJlYmFzZWQgPSBbXTtcblxuICAgICAgLy8gUHJvcGFnYXRlIHRvIHRoZSBsaW5rZWQgZG9jdW1lbnRzXG4gICAgICBsaW5rZWREb2NzKGRvYywgZnVuY3Rpb24oZG9jLCBzaGFyZWRIaXN0KSB7XG4gICAgICAgIGlmICghc2hhcmVkSGlzdCAmJiBpbmRleE9mKHJlYmFzZWQsIGRvYy5oaXN0b3J5KSA9PSAtMSkge1xuICAgICAgICAgIHJlYmFzZUhpc3QoZG9jLmhpc3RvcnksIGNoYW5nZSk7XG4gICAgICAgICAgcmViYXNlZC5wdXNoKGRvYy5oaXN0b3J5KTtcbiAgICAgICAgfVxuICAgICAgICBtYWtlQ2hhbmdlU2luZ2xlRG9jKGRvYywgY2hhbmdlLCBudWxsLCBtZXJnZU9sZFNwYW5zKGRvYywgY2hhbmdlKSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBTdWItdmlld3MgbmVlZCB0aGVpciBsaW5lIG51bWJlcnMgc2hpZnRlZCB3aGVuIHRleHQgaXMgYWRkZWRcbiAgLy8gYWJvdmUgb3IgYmVsb3cgdGhlbSBpbiB0aGUgcGFyZW50IGRvY3VtZW50LlxuICBmdW5jdGlvbiBzaGlmdERvYyhkb2MsIGRpc3RhbmNlKSB7XG4gICAgaWYgKGRpc3RhbmNlID09IDApIHJldHVybjtcbiAgICBkb2MuZmlyc3QgKz0gZGlzdGFuY2U7XG4gICAgZG9jLnNlbCA9IG5ldyBTZWxlY3Rpb24obWFwKGRvYy5zZWwucmFuZ2VzLCBmdW5jdGlvbihyYW5nZSkge1xuICAgICAgcmV0dXJuIG5ldyBSYW5nZShQb3MocmFuZ2UuYW5jaG9yLmxpbmUgKyBkaXN0YW5jZSwgcmFuZ2UuYW5jaG9yLmNoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgUG9zKHJhbmdlLmhlYWQubGluZSArIGRpc3RhbmNlLCByYW5nZS5oZWFkLmNoKSk7XG4gICAgfSksIGRvYy5zZWwucHJpbUluZGV4KTtcbiAgICBpZiAoZG9jLmNtKSB7XG4gICAgICByZWdDaGFuZ2UoZG9jLmNtLCBkb2MuZmlyc3QsIGRvYy5maXJzdCAtIGRpc3RhbmNlLCBkaXN0YW5jZSk7XG4gICAgICBmb3IgKHZhciBkID0gZG9jLmNtLmRpc3BsYXksIGwgPSBkLnZpZXdGcm9tOyBsIDwgZC52aWV3VG87IGwrKylcbiAgICAgICAgcmVnTGluZUNoYW5nZShkb2MuY20sIGwsIFwiZ3V0dGVyXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8vIE1vcmUgbG93ZXItbGV2ZWwgY2hhbmdlIGZ1bmN0aW9uLCBoYW5kbGluZyBvbmx5IGEgc2luZ2xlIGRvY3VtZW50XG4gIC8vIChub3QgbGlua2VkIG9uZXMpLlxuICBmdW5jdGlvbiBtYWtlQ2hhbmdlU2luZ2xlRG9jKGRvYywgY2hhbmdlLCBzZWxBZnRlciwgc3BhbnMpIHtcbiAgICBpZiAoZG9jLmNtICYmICFkb2MuY20uY3VyT3ApXG4gICAgICByZXR1cm4gb3BlcmF0aW9uKGRvYy5jbSwgbWFrZUNoYW5nZVNpbmdsZURvYykoZG9jLCBjaGFuZ2UsIHNlbEFmdGVyLCBzcGFucyk7XG5cbiAgICBpZiAoY2hhbmdlLnRvLmxpbmUgPCBkb2MuZmlyc3QpIHtcbiAgICAgIHNoaWZ0RG9jKGRvYywgY2hhbmdlLnRleHQubGVuZ3RoIC0gMSAtIChjaGFuZ2UudG8ubGluZSAtIGNoYW5nZS5mcm9tLmxpbmUpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNoYW5nZS5mcm9tLmxpbmUgPiBkb2MubGFzdExpbmUoKSkgcmV0dXJuO1xuXG4gICAgLy8gQ2xpcCB0aGUgY2hhbmdlIHRvIHRoZSBzaXplIG9mIHRoaXMgZG9jXG4gICAgaWYgKGNoYW5nZS5mcm9tLmxpbmUgPCBkb2MuZmlyc3QpIHtcbiAgICAgIHZhciBzaGlmdCA9IGNoYW5nZS50ZXh0Lmxlbmd0aCAtIDEgLSAoZG9jLmZpcnN0IC0gY2hhbmdlLmZyb20ubGluZSk7XG4gICAgICBzaGlmdERvYyhkb2MsIHNoaWZ0KTtcbiAgICAgIGNoYW5nZSA9IHtmcm9tOiBQb3MoZG9jLmZpcnN0LCAwKSwgdG86IFBvcyhjaGFuZ2UudG8ubGluZSArIHNoaWZ0LCBjaGFuZ2UudG8uY2gpLFxuICAgICAgICAgICAgICAgIHRleHQ6IFtsc3QoY2hhbmdlLnRleHQpXSwgb3JpZ2luOiBjaGFuZ2Uub3JpZ2lufTtcbiAgICB9XG4gICAgdmFyIGxhc3QgPSBkb2MubGFzdExpbmUoKTtcbiAgICBpZiAoY2hhbmdlLnRvLmxpbmUgPiBsYXN0KSB7XG4gICAgICBjaGFuZ2UgPSB7ZnJvbTogY2hhbmdlLmZyb20sIHRvOiBQb3MobGFzdCwgZ2V0TGluZShkb2MsIGxhc3QpLnRleHQubGVuZ3RoKSxcbiAgICAgICAgICAgICAgICB0ZXh0OiBbY2hhbmdlLnRleHRbMF1dLCBvcmlnaW46IGNoYW5nZS5vcmlnaW59O1xuICAgIH1cblxuICAgIGNoYW5nZS5yZW1vdmVkID0gZ2V0QmV0d2Vlbihkb2MsIGNoYW5nZS5mcm9tLCBjaGFuZ2UudG8pO1xuXG4gICAgaWYgKCFzZWxBZnRlcikgc2VsQWZ0ZXIgPSBjb21wdXRlU2VsQWZ0ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UpO1xuICAgIGlmIChkb2MuY20pIG1ha2VDaGFuZ2VTaW5nbGVEb2NJbkVkaXRvcihkb2MuY20sIGNoYW5nZSwgc3BhbnMpO1xuICAgIGVsc2UgdXBkYXRlRG9jKGRvYywgY2hhbmdlLCBzcGFucyk7XG4gICAgc2V0U2VsZWN0aW9uTm9VbmRvKGRvYywgc2VsQWZ0ZXIsIHNlbF9kb250U2Nyb2xsKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSB0aGUgaW50ZXJhY3Rpb24gb2YgYSBjaGFuZ2UgdG8gYSBkb2N1bWVudCB3aXRoIHRoZSBlZGl0b3JcbiAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGlzIHBhcnQgb2YuXG4gIGZ1bmN0aW9uIG1ha2VDaGFuZ2VTaW5nbGVEb2NJbkVkaXRvcihjbSwgY2hhbmdlLCBzcGFucykge1xuICAgIHZhciBkb2MgPSBjbS5kb2MsIGRpc3BsYXkgPSBjbS5kaXNwbGF5LCBmcm9tID0gY2hhbmdlLmZyb20sIHRvID0gY2hhbmdlLnRvO1xuXG4gICAgdmFyIHJlY29tcHV0ZU1heExlbmd0aCA9IGZhbHNlLCBjaGVja1dpZHRoU3RhcnQgPSBmcm9tLmxpbmU7XG4gICAgaWYgKCFjbS5vcHRpb25zLmxpbmVXcmFwcGluZykge1xuICAgICAgY2hlY2tXaWR0aFN0YXJ0ID0gbGluZU5vKHZpc3VhbExpbmUoZ2V0TGluZShkb2MsIGZyb20ubGluZSkpKTtcbiAgICAgIGRvYy5pdGVyKGNoZWNrV2lkdGhTdGFydCwgdG8ubGluZSArIDEsIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgaWYgKGxpbmUgPT0gZGlzcGxheS5tYXhMaW5lKSB7XG4gICAgICAgICAgcmVjb21wdXRlTWF4TGVuZ3RoID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGRvYy5zZWwuY29udGFpbnMoY2hhbmdlLmZyb20sIGNoYW5nZS50bykgPiAtMSlcbiAgICAgIHNpZ25hbEN1cnNvckFjdGl2aXR5KGNtKTtcblxuICAgIHVwZGF0ZURvYyhkb2MsIGNoYW5nZSwgc3BhbnMsIGVzdGltYXRlSGVpZ2h0KGNtKSk7XG5cbiAgICBpZiAoIWNtLm9wdGlvbnMubGluZVdyYXBwaW5nKSB7XG4gICAgICBkb2MuaXRlcihjaGVja1dpZHRoU3RhcnQsIGZyb20ubGluZSArIGNoYW5nZS50ZXh0Lmxlbmd0aCwgZnVuY3Rpb24obGluZSkge1xuICAgICAgICB2YXIgbGVuID0gbGluZUxlbmd0aChsaW5lKTtcbiAgICAgICAgaWYgKGxlbiA+IGRpc3BsYXkubWF4TGluZUxlbmd0aCkge1xuICAgICAgICAgIGRpc3BsYXkubWF4TGluZSA9IGxpbmU7XG4gICAgICAgICAgZGlzcGxheS5tYXhMaW5lTGVuZ3RoID0gbGVuO1xuICAgICAgICAgIGRpc3BsYXkubWF4TGluZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgIHJlY29tcHV0ZU1heExlbmd0aCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChyZWNvbXB1dGVNYXhMZW5ndGgpIGNtLmN1ck9wLnVwZGF0ZU1heExpbmUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIEFkanVzdCBmcm9udGllciwgc2NoZWR1bGUgd29ya2VyXG4gICAgZG9jLmZyb250aWVyID0gTWF0aC5taW4oZG9jLmZyb250aWVyLCBmcm9tLmxpbmUpO1xuICAgIHN0YXJ0V29ya2VyKGNtLCA0MDApO1xuXG4gICAgdmFyIGxlbmRpZmYgPSBjaGFuZ2UudGV4dC5sZW5ndGggLSAodG8ubGluZSAtIGZyb20ubGluZSkgLSAxO1xuICAgIC8vIFJlbWVtYmVyIHRoYXQgdGhlc2UgbGluZXMgY2hhbmdlZCwgZm9yIHVwZGF0aW5nIHRoZSBkaXNwbGF5XG4gICAgaWYgKGNoYW5nZS5mdWxsKVxuICAgICAgcmVnQ2hhbmdlKGNtKTtcbiAgICBlbHNlIGlmIChmcm9tLmxpbmUgPT0gdG8ubGluZSAmJiBjaGFuZ2UudGV4dC5sZW5ndGggPT0gMSAmJiAhaXNXaG9sZUxpbmVVcGRhdGUoY20uZG9jLCBjaGFuZ2UpKVxuICAgICAgcmVnTGluZUNoYW5nZShjbSwgZnJvbS5saW5lLCBcInRleHRcIik7XG4gICAgZWxzZVxuICAgICAgcmVnQ2hhbmdlKGNtLCBmcm9tLmxpbmUsIHRvLmxpbmUgKyAxLCBsZW5kaWZmKTtcblxuICAgIHZhciBjaGFuZ2VzSGFuZGxlciA9IGhhc0hhbmRsZXIoY20sIFwiY2hhbmdlc1wiKSwgY2hhbmdlSGFuZGxlciA9IGhhc0hhbmRsZXIoY20sIFwiY2hhbmdlXCIpO1xuICAgIGlmIChjaGFuZ2VIYW5kbGVyIHx8IGNoYW5nZXNIYW5kbGVyKSB7XG4gICAgICB2YXIgb2JqID0ge1xuICAgICAgICBmcm9tOiBmcm9tLCB0bzogdG8sXG4gICAgICAgIHRleHQ6IGNoYW5nZS50ZXh0LFxuICAgICAgICByZW1vdmVkOiBjaGFuZ2UucmVtb3ZlZCxcbiAgICAgICAgb3JpZ2luOiBjaGFuZ2Uub3JpZ2luXG4gICAgICB9O1xuICAgICAgaWYgKGNoYW5nZUhhbmRsZXIpIHNpZ25hbExhdGVyKGNtLCBcImNoYW5nZVwiLCBjbSwgb2JqKTtcbiAgICAgIGlmIChjaGFuZ2VzSGFuZGxlcikgKGNtLmN1ck9wLmNoYW5nZU9ianMgfHwgKGNtLmN1ck9wLmNoYW5nZU9ianMgPSBbXSkpLnB1c2gob2JqKTtcbiAgICB9XG4gICAgY20uZGlzcGxheS5zZWxGb3JDb250ZXh0TWVudSA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiByZXBsYWNlUmFuZ2UoZG9jLCBjb2RlLCBmcm9tLCB0bywgb3JpZ2luKSB7XG4gICAgaWYgKCF0bykgdG8gPSBmcm9tO1xuICAgIGlmIChjbXAodG8sIGZyb20pIDwgMCkgeyB2YXIgdG1wID0gdG87IHRvID0gZnJvbTsgZnJvbSA9IHRtcDsgfVxuICAgIGlmICh0eXBlb2YgY29kZSA9PSBcInN0cmluZ1wiKSBjb2RlID0gZG9jLnNwbGl0TGluZXMoY29kZSk7XG4gICAgbWFrZUNoYW5nZShkb2MsIHtmcm9tOiBmcm9tLCB0bzogdG8sIHRleHQ6IGNvZGUsIG9yaWdpbjogb3JpZ2lufSk7XG4gIH1cblxuICAvLyBTQ1JPTExJTkcgVEhJTkdTIElOVE8gVklFV1xuXG4gIC8vIElmIGFuIGVkaXRvciBzaXRzIG9uIHRoZSB0b3Agb3IgYm90dG9tIG9mIHRoZSB3aW5kb3csIHBhcnRpYWxseVxuICAvLyBzY3JvbGxlZCBvdXQgb2YgdmlldywgdGhpcyBlbnN1cmVzIHRoYXQgdGhlIGN1cnNvciBpcyB2aXNpYmxlLlxuICBmdW5jdGlvbiBtYXliZVNjcm9sbFdpbmRvdyhjbSwgY29vcmRzKSB7XG4gICAgaWYgKHNpZ25hbERPTUV2ZW50KGNtLCBcInNjcm9sbEN1cnNvckludG9WaWV3XCIpKSByZXR1cm47XG5cbiAgICB2YXIgZGlzcGxheSA9IGNtLmRpc3BsYXksIGJveCA9IGRpc3BsYXkuc2l6ZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIGRvU2Nyb2xsID0gbnVsbDtcbiAgICBpZiAoY29vcmRzLnRvcCArIGJveC50b3AgPCAwKSBkb1Njcm9sbCA9IHRydWU7XG4gICAgZWxzZSBpZiAoY29vcmRzLmJvdHRvbSArIGJveC50b3AgPiAod2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpKSBkb1Njcm9sbCA9IGZhbHNlO1xuICAgIGlmIChkb1Njcm9sbCAhPSBudWxsICYmICFwaGFudG9tKSB7XG4gICAgICB2YXIgc2Nyb2xsTm9kZSA9IGVsdChcImRpdlwiLCBcIlxcdTIwMGJcIiwgbnVsbCwgXCJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvb3Jkcy50b3AgLSBkaXNwbGF5LnZpZXdPZmZzZXQgLSBwYWRkaW5nVG9wKGNtLmRpc3BsYXkpKSArIFwicHg7IGhlaWdodDogXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgKGNvb3Jkcy5ib3R0b20gLSBjb29yZHMudG9wICsgc2Nyb2xsR2FwKGNtKSArIGRpc3BsYXkuYmFySGVpZ2h0KSArIFwicHg7IGxlZnQ6IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3Jkcy5sZWZ0ICsgXCJweDsgd2lkdGg6IDJweDtcIik7XG4gICAgICBjbS5kaXNwbGF5LmxpbmVTcGFjZS5hcHBlbmRDaGlsZChzY3JvbGxOb2RlKTtcbiAgICAgIHNjcm9sbE5vZGUuc2Nyb2xsSW50b1ZpZXcoZG9TY3JvbGwpO1xuICAgICAgY20uZGlzcGxheS5saW5lU3BhY2UucmVtb3ZlQ2hpbGQoc2Nyb2xsTm9kZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU2Nyb2xsIGEgZ2l2ZW4gcG9zaXRpb24gaW50byB2aWV3IChpbW1lZGlhdGVseSksIHZlcmlmeWluZyB0aGF0XG4gIC8vIGl0IGFjdHVhbGx5IGJlY2FtZSB2aXNpYmxlIChhcyBsaW5lIGhlaWdodHMgYXJlIGFjY3VyYXRlbHlcbiAgLy8gbWVhc3VyZWQsIHRoZSBwb3NpdGlvbiBvZiBzb21ldGhpbmcgbWF5ICdkcmlmdCcgZHVyaW5nIGRyYXdpbmcpLlxuICBmdW5jdGlvbiBzY3JvbGxQb3NJbnRvVmlldyhjbSwgcG9zLCBlbmQsIG1hcmdpbikge1xuICAgIGlmIChtYXJnaW4gPT0gbnVsbCkgbWFyZ2luID0gMDtcbiAgICBmb3IgKHZhciBsaW1pdCA9IDA7IGxpbWl0IDwgNTsgbGltaXQrKykge1xuICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZSwgY29vcmRzID0gY3Vyc29yQ29vcmRzKGNtLCBwb3MpO1xuICAgICAgdmFyIGVuZENvb3JkcyA9ICFlbmQgfHwgZW5kID09IHBvcyA/IGNvb3JkcyA6IGN1cnNvckNvb3JkcyhjbSwgZW5kKTtcbiAgICAgIHZhciBzY3JvbGxQb3MgPSBjYWxjdWxhdGVTY3JvbGxQb3MoY20sIE1hdGgubWluKGNvb3Jkcy5sZWZ0LCBlbmRDb29yZHMubGVmdCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGNvb3Jkcy50b3AsIGVuZENvb3Jkcy50b3ApIC0gbWFyZ2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChjb29yZHMubGVmdCwgZW5kQ29vcmRzLmxlZnQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChjb29yZHMuYm90dG9tLCBlbmRDb29yZHMuYm90dG9tKSArIG1hcmdpbik7XG4gICAgICB2YXIgc3RhcnRUb3AgPSBjbS5kb2Muc2Nyb2xsVG9wLCBzdGFydExlZnQgPSBjbS5kb2Muc2Nyb2xsTGVmdDtcbiAgICAgIGlmIChzY3JvbGxQb3Muc2Nyb2xsVG9wICE9IG51bGwpIHtcbiAgICAgICAgc2V0U2Nyb2xsVG9wKGNtLCBzY3JvbGxQb3Muc2Nyb2xsVG9wKTtcbiAgICAgICAgaWYgKE1hdGguYWJzKGNtLmRvYy5zY3JvbGxUb3AgLSBzdGFydFRvcCkgPiAxKSBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChzY3JvbGxQb3Muc2Nyb2xsTGVmdCAhPSBudWxsKSB7XG4gICAgICAgIHNldFNjcm9sbExlZnQoY20sIHNjcm9sbFBvcy5zY3JvbGxMZWZ0KTtcbiAgICAgICAgaWYgKE1hdGguYWJzKGNtLmRvYy5zY3JvbGxMZWZ0IC0gc3RhcnRMZWZ0KSA+IDEpIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKCFjaGFuZ2VkKSBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIGNvb3JkcztcbiAgfVxuXG4gIC8vIFNjcm9sbCBhIGdpdmVuIHNldCBvZiBjb29yZGluYXRlcyBpbnRvIHZpZXcgKGltbWVkaWF0ZWx5KS5cbiAgZnVuY3Rpb24gc2Nyb2xsSW50b1ZpZXcoY20sIHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgdmFyIHNjcm9sbFBvcyA9IGNhbGN1bGF0ZVNjcm9sbFBvcyhjbSwgeDEsIHkxLCB4MiwgeTIpO1xuICAgIGlmIChzY3JvbGxQb3Muc2Nyb2xsVG9wICE9IG51bGwpIHNldFNjcm9sbFRvcChjbSwgc2Nyb2xsUG9zLnNjcm9sbFRvcCk7XG4gICAgaWYgKHNjcm9sbFBvcy5zY3JvbGxMZWZ0ICE9IG51bGwpIHNldFNjcm9sbExlZnQoY20sIHNjcm9sbFBvcy5zY3JvbGxMZWZ0KTtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSBhIG5ldyBzY3JvbGwgcG9zaXRpb24gbmVlZGVkIHRvIHNjcm9sbCB0aGUgZ2l2ZW5cbiAgLy8gcmVjdGFuZ2xlIGludG8gdmlldy4gUmV0dXJucyBhbiBvYmplY3Qgd2l0aCBzY3JvbGxUb3AgYW5kXG4gIC8vIHNjcm9sbExlZnQgcHJvcGVydGllcy4gV2hlbiB0aGVzZSBhcmUgdW5kZWZpbmVkLCB0aGVcbiAgLy8gdmVydGljYWwvaG9yaXpvbnRhbCBwb3NpdGlvbiBkb2VzIG5vdCBuZWVkIHRvIGJlIGFkanVzdGVkLlxuICBmdW5jdGlvbiBjYWxjdWxhdGVTY3JvbGxQb3MoY20sIHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgdmFyIGRpc3BsYXkgPSBjbS5kaXNwbGF5LCBzbmFwTWFyZ2luID0gdGV4dEhlaWdodChjbS5kaXNwbGF5KTtcbiAgICBpZiAoeTEgPCAwKSB5MSA9IDA7XG4gICAgdmFyIHNjcmVlbnRvcCA9IGNtLmN1ck9wICYmIGNtLmN1ck9wLnNjcm9sbFRvcCAhPSBudWxsID8gY20uY3VyT3Auc2Nyb2xsVG9wIDogZGlzcGxheS5zY3JvbGxlci5zY3JvbGxUb3A7XG4gICAgdmFyIHNjcmVlbiA9IGRpc3BsYXlIZWlnaHQoY20pLCByZXN1bHQgPSB7fTtcbiAgICBpZiAoeTIgLSB5MSA+IHNjcmVlbikgeTIgPSB5MSArIHNjcmVlbjtcbiAgICB2YXIgZG9jQm90dG9tID0gY20uZG9jLmhlaWdodCArIHBhZGRpbmdWZXJ0KGRpc3BsYXkpO1xuICAgIHZhciBhdFRvcCA9IHkxIDwgc25hcE1hcmdpbiwgYXRCb3R0b20gPSB5MiA+IGRvY0JvdHRvbSAtIHNuYXBNYXJnaW47XG4gICAgaWYgKHkxIDwgc2NyZWVudG9wKSB7XG4gICAgICByZXN1bHQuc2Nyb2xsVG9wID0gYXRUb3AgPyAwIDogeTE7XG4gICAgfSBlbHNlIGlmICh5MiA+IHNjcmVlbnRvcCArIHNjcmVlbikge1xuICAgICAgdmFyIG5ld1RvcCA9IE1hdGgubWluKHkxLCAoYXRCb3R0b20gPyBkb2NCb3R0b20gOiB5MikgLSBzY3JlZW4pO1xuICAgICAgaWYgKG5ld1RvcCAhPSBzY3JlZW50b3ApIHJlc3VsdC5zY3JvbGxUb3AgPSBuZXdUb3A7XG4gICAgfVxuXG4gICAgdmFyIHNjcmVlbmxlZnQgPSBjbS5jdXJPcCAmJiBjbS5jdXJPcC5zY3JvbGxMZWZ0ICE9IG51bGwgPyBjbS5jdXJPcC5zY3JvbGxMZWZ0IDogZGlzcGxheS5zY3JvbGxlci5zY3JvbGxMZWZ0O1xuICAgIHZhciBzY3JlZW53ID0gZGlzcGxheVdpZHRoKGNtKSAtIChjbS5vcHRpb25zLmZpeGVkR3V0dGVyID8gZGlzcGxheS5ndXR0ZXJzLm9mZnNldFdpZHRoIDogMCk7XG4gICAgdmFyIHRvb1dpZGUgPSB4MiAtIHgxID4gc2NyZWVudztcbiAgICBpZiAodG9vV2lkZSkgeDIgPSB4MSArIHNjcmVlbnc7XG4gICAgaWYgKHgxIDwgMTApXG4gICAgICByZXN1bHQuc2Nyb2xsTGVmdCA9IDA7XG4gICAgZWxzZSBpZiAoeDEgPCBzY3JlZW5sZWZ0KVxuICAgICAgcmVzdWx0LnNjcm9sbExlZnQgPSBNYXRoLm1heCgwLCB4MSAtICh0b29XaWRlID8gMCA6IDEwKSk7XG4gICAgZWxzZSBpZiAoeDIgPiBzY3JlZW53ICsgc2NyZWVubGVmdCAtIDMpXG4gICAgICByZXN1bHQuc2Nyb2xsTGVmdCA9IHgyICsgKHRvb1dpZGUgPyAwIDogMTApIC0gc2NyZWVudztcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gU3RvcmUgYSByZWxhdGl2ZSBhZGp1c3RtZW50IHRvIHRoZSBzY3JvbGwgcG9zaXRpb24gaW4gdGhlIGN1cnJlbnRcbiAgLy8gb3BlcmF0aW9uICh0byBiZSBhcHBsaWVkIHdoZW4gdGhlIG9wZXJhdGlvbiBmaW5pc2hlcykuXG4gIGZ1bmN0aW9uIGFkZFRvU2Nyb2xsUG9zKGNtLCBsZWZ0LCB0b3ApIHtcbiAgICBpZiAobGVmdCAhPSBudWxsIHx8IHRvcCAhPSBudWxsKSByZXNvbHZlU2Nyb2xsVG9Qb3MoY20pO1xuICAgIGlmIChsZWZ0ICE9IG51bGwpXG4gICAgICBjbS5jdXJPcC5zY3JvbGxMZWZ0ID0gKGNtLmN1ck9wLnNjcm9sbExlZnQgPT0gbnVsbCA/IGNtLmRvYy5zY3JvbGxMZWZ0IDogY20uY3VyT3Auc2Nyb2xsTGVmdCkgKyBsZWZ0O1xuICAgIGlmICh0b3AgIT0gbnVsbClcbiAgICAgIGNtLmN1ck9wLnNjcm9sbFRvcCA9IChjbS5jdXJPcC5zY3JvbGxUb3AgPT0gbnVsbCA/IGNtLmRvYy5zY3JvbGxUb3AgOiBjbS5jdXJPcC5zY3JvbGxUb3ApICsgdG9wO1xuICB9XG5cbiAgLy8gTWFrZSBzdXJlIHRoYXQgYXQgdGhlIGVuZCBvZiB0aGUgb3BlcmF0aW9uIHRoZSBjdXJyZW50IGN1cnNvciBpc1xuICAvLyBzaG93bi5cbiAgZnVuY3Rpb24gZW5zdXJlQ3Vyc29yVmlzaWJsZShjbSkge1xuICAgIHJlc29sdmVTY3JvbGxUb1BvcyhjbSk7XG4gICAgdmFyIGN1ciA9IGNtLmdldEN1cnNvcigpLCBmcm9tID0gY3VyLCB0byA9IGN1cjtcbiAgICBpZiAoIWNtLm9wdGlvbnMubGluZVdyYXBwaW5nKSB7XG4gICAgICBmcm9tID0gY3VyLmNoID8gUG9zKGN1ci5saW5lLCBjdXIuY2ggLSAxKSA6IGN1cjtcbiAgICAgIHRvID0gUG9zKGN1ci5saW5lLCBjdXIuY2ggKyAxKTtcbiAgICB9XG4gICAgY20uY3VyT3Auc2Nyb2xsVG9Qb3MgPSB7ZnJvbTogZnJvbSwgdG86IHRvLCBtYXJnaW46IGNtLm9wdGlvbnMuY3Vyc29yU2Nyb2xsTWFyZ2luLCBpc0N1cnNvcjogdHJ1ZX07XG4gIH1cblxuICAvLyBXaGVuIGFuIG9wZXJhdGlvbiBoYXMgaXRzIHNjcm9sbFRvUG9zIHByb3BlcnR5IHNldCwgYW5kIGFub3RoZXJcbiAgLy8gc2Nyb2xsIGFjdGlvbiBpcyBhcHBsaWVkIGJlZm9yZSB0aGUgZW5kIG9mIHRoZSBvcGVyYXRpb24sIHRoaXNcbiAgLy8gJ3NpbXVsYXRlcycgc2Nyb2xsaW5nIHRoYXQgcG9zaXRpb24gaW50byB2aWV3IGluIGEgY2hlYXAgd2F5LCBzb1xuICAvLyB0aGF0IHRoZSBlZmZlY3Qgb2YgaW50ZXJtZWRpYXRlIHNjcm9sbCBjb21tYW5kcyBpcyBub3QgaWdub3JlZC5cbiAgZnVuY3Rpb24gcmVzb2x2ZVNjcm9sbFRvUG9zKGNtKSB7XG4gICAgdmFyIHJhbmdlID0gY20uY3VyT3Auc2Nyb2xsVG9Qb3M7XG4gICAgaWYgKHJhbmdlKSB7XG4gICAgICBjbS5jdXJPcC5zY3JvbGxUb1BvcyA9IG51bGw7XG4gICAgICB2YXIgZnJvbSA9IGVzdGltYXRlQ29vcmRzKGNtLCByYW5nZS5mcm9tKSwgdG8gPSBlc3RpbWF0ZUNvb3JkcyhjbSwgcmFuZ2UudG8pO1xuICAgICAgdmFyIHNQb3MgPSBjYWxjdWxhdGVTY3JvbGxQb3MoY20sIE1hdGgubWluKGZyb20ubGVmdCwgdG8ubGVmdCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihmcm9tLnRvcCwgdG8udG9wKSAtIHJhbmdlLm1hcmdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGZyb20ucmlnaHQsIHRvLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGZyb20uYm90dG9tLCB0by5ib3R0b20pICsgcmFuZ2UubWFyZ2luKTtcbiAgICAgIGNtLnNjcm9sbFRvKHNQb3Muc2Nyb2xsTGVmdCwgc1Bvcy5zY3JvbGxUb3ApO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFQSSBVVElMSVRJRVNcblxuICAvLyBJbmRlbnQgdGhlIGdpdmVuIGxpbmUuIFRoZSBob3cgcGFyYW1ldGVyIGNhbiBiZSBcInNtYXJ0XCIsXG4gIC8vIFwiYWRkXCIvbnVsbCwgXCJzdWJ0cmFjdFwiLCBvciBcInByZXZcIi4gV2hlbiBhZ2dyZXNzaXZlIGlzIGZhbHNlXG4gIC8vICh0eXBpY2FsbHkgc2V0IHRvIHRydWUgZm9yIGZvcmNlZCBzaW5nbGUtbGluZSBpbmRlbnRzKSwgZW1wdHlcbiAgLy8gbGluZXMgYXJlIG5vdCBpbmRlbnRlZCwgYW5kIHBsYWNlcyB3aGVyZSB0aGUgbW9kZSByZXR1cm5zIFBhc3NcbiAgLy8gYXJlIGxlZnQgYWxvbmUuXG4gIGZ1bmN0aW9uIGluZGVudExpbmUoY20sIG4sIGhvdywgYWdncmVzc2l2ZSkge1xuICAgIHZhciBkb2MgPSBjbS5kb2MsIHN0YXRlO1xuICAgIGlmIChob3cgPT0gbnVsbCkgaG93ID0gXCJhZGRcIjtcbiAgICBpZiAoaG93ID09IFwic21hcnRcIikge1xuICAgICAgLy8gRmFsbCBiYWNrIHRvIFwicHJldlwiIHdoZW4gdGhlIG1vZGUgZG9lc24ndCBoYXZlIGFuIGluZGVudGF0aW9uXG4gICAgICAvLyBtZXRob2QuXG4gICAgICBpZiAoIWRvYy5tb2RlLmluZGVudCkgaG93ID0gXCJwcmV2XCI7XG4gICAgICBlbHNlIHN0YXRlID0gZ2V0U3RhdGVCZWZvcmUoY20sIG4pO1xuICAgIH1cblxuICAgIHZhciB0YWJTaXplID0gY20ub3B0aW9ucy50YWJTaXplO1xuICAgIHZhciBsaW5lID0gZ2V0TGluZShkb2MsIG4pLCBjdXJTcGFjZSA9IGNvdW50Q29sdW1uKGxpbmUudGV4dCwgbnVsbCwgdGFiU2l6ZSk7XG4gICAgaWYgKGxpbmUuc3RhdGVBZnRlcikgbGluZS5zdGF0ZUFmdGVyID0gbnVsbDtcbiAgICB2YXIgY3VyU3BhY2VTdHJpbmcgPSBsaW5lLnRleHQubWF0Y2goL15cXHMqLylbMF0sIGluZGVudGF0aW9uO1xuICAgIGlmICghYWdncmVzc2l2ZSAmJiAhL1xcUy8udGVzdChsaW5lLnRleHQpKSB7XG4gICAgICBpbmRlbnRhdGlvbiA9IDA7XG4gICAgICBob3cgPSBcIm5vdFwiO1xuICAgIH0gZWxzZSBpZiAoaG93ID09IFwic21hcnRcIikge1xuICAgICAgaW5kZW50YXRpb24gPSBkb2MubW9kZS5pbmRlbnQoc3RhdGUsIGxpbmUudGV4dC5zbGljZShjdXJTcGFjZVN0cmluZy5sZW5ndGgpLCBsaW5lLnRleHQpO1xuICAgICAgaWYgKGluZGVudGF0aW9uID09IFBhc3MgfHwgaW5kZW50YXRpb24gPiAxNTApIHtcbiAgICAgICAgaWYgKCFhZ2dyZXNzaXZlKSByZXR1cm47XG4gICAgICAgIGhvdyA9IFwicHJldlwiO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaG93ID09IFwicHJldlwiKSB7XG4gICAgICBpZiAobiA+IGRvYy5maXJzdCkgaW5kZW50YXRpb24gPSBjb3VudENvbHVtbihnZXRMaW5lKGRvYywgbi0xKS50ZXh0LCBudWxsLCB0YWJTaXplKTtcbiAgICAgIGVsc2UgaW5kZW50YXRpb24gPSAwO1xuICAgIH0gZWxzZSBpZiAoaG93ID09IFwiYWRkXCIpIHtcbiAgICAgIGluZGVudGF0aW9uID0gY3VyU3BhY2UgKyBjbS5vcHRpb25zLmluZGVudFVuaXQ7XG4gICAgfSBlbHNlIGlmIChob3cgPT0gXCJzdWJ0cmFjdFwiKSB7XG4gICAgICBpbmRlbnRhdGlvbiA9IGN1clNwYWNlIC0gY20ub3B0aW9ucy5pbmRlbnRVbml0O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGhvdyA9PSBcIm51bWJlclwiKSB7XG4gICAgICBpbmRlbnRhdGlvbiA9IGN1clNwYWNlICsgaG93O1xuICAgIH1cbiAgICBpbmRlbnRhdGlvbiA9IE1hdGgubWF4KDAsIGluZGVudGF0aW9uKTtcblxuICAgIHZhciBpbmRlbnRTdHJpbmcgPSBcIlwiLCBwb3MgPSAwO1xuICAgIGlmIChjbS5vcHRpb25zLmluZGVudFdpdGhUYWJzKVxuICAgICAgZm9yICh2YXIgaSA9IE1hdGguZmxvb3IoaW5kZW50YXRpb24gLyB0YWJTaXplKTsgaTsgLS1pKSB7cG9zICs9IHRhYlNpemU7IGluZGVudFN0cmluZyArPSBcIlxcdFwiO31cbiAgICBpZiAocG9zIDwgaW5kZW50YXRpb24pIGluZGVudFN0cmluZyArPSBzcGFjZVN0cihpbmRlbnRhdGlvbiAtIHBvcyk7XG5cbiAgICBpZiAoaW5kZW50U3RyaW5nICE9IGN1clNwYWNlU3RyaW5nKSB7XG4gICAgICByZXBsYWNlUmFuZ2UoZG9jLCBpbmRlbnRTdHJpbmcsIFBvcyhuLCAwKSwgUG9zKG4sIGN1clNwYWNlU3RyaW5nLmxlbmd0aCksIFwiK2lucHV0XCIpO1xuICAgICAgbGluZS5zdGF0ZUFmdGVyID0gbnVsbDtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbnN1cmUgdGhhdCwgaWYgdGhlIGN1cnNvciB3YXMgaW4gdGhlIHdoaXRlc3BhY2UgYXQgdGhlIHN0YXJ0XG4gICAgICAvLyBvZiB0aGUgbGluZSwgaXQgaXMgbW92ZWQgdG8gdGhlIGVuZCBvZiB0aGF0IHNwYWNlLlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2Muc2VsLnJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcmFuZ2UgPSBkb2Muc2VsLnJhbmdlc1tpXTtcbiAgICAgICAgaWYgKHJhbmdlLmhlYWQubGluZSA9PSBuICYmIHJhbmdlLmhlYWQuY2ggPCBjdXJTcGFjZVN0cmluZy5sZW5ndGgpIHtcbiAgICAgICAgICB2YXIgcG9zID0gUG9zKG4sIGN1clNwYWNlU3RyaW5nLmxlbmd0aCk7XG4gICAgICAgICAgcmVwbGFjZU9uZVNlbGVjdGlvbihkb2MsIGksIG5ldyBSYW5nZShwb3MsIHBvcykpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVXRpbGl0eSBmb3IgYXBwbHlpbmcgYSBjaGFuZ2UgdG8gYSBsaW5lIGJ5IGhhbmRsZSBvciBudW1iZXIsXG4gIC8vIHJldHVybmluZyB0aGUgbnVtYmVyIGFuZCBvcHRpb25hbGx5IHJlZ2lzdGVyaW5nIHRoZSBsaW5lIGFzXG4gIC8vIGNoYW5nZWQuXG4gIGZ1bmN0aW9uIGNoYW5nZUxpbmUoZG9jLCBoYW5kbGUsIGNoYW5nZVR5cGUsIG9wKSB7XG4gICAgdmFyIG5vID0gaGFuZGxlLCBsaW5lID0gaGFuZGxlO1xuICAgIGlmICh0eXBlb2YgaGFuZGxlID09IFwibnVtYmVyXCIpIGxpbmUgPSBnZXRMaW5lKGRvYywgY2xpcExpbmUoZG9jLCBoYW5kbGUpKTtcbiAgICBlbHNlIG5vID0gbGluZU5vKGhhbmRsZSk7XG4gICAgaWYgKG5vID09IG51bGwpIHJldHVybiBudWxsO1xuICAgIGlmIChvcChsaW5lLCBubykgJiYgZG9jLmNtKSByZWdMaW5lQ2hhbmdlKGRvYy5jbSwgbm8sIGNoYW5nZVR5cGUpO1xuICAgIHJldHVybiBsaW5lO1xuICB9XG5cbiAgLy8gSGVscGVyIGZvciBkZWxldGluZyB0ZXh0IG5lYXIgdGhlIHNlbGVjdGlvbihzKSwgdXNlZCB0byBpbXBsZW1lbnRcbiAgLy8gYmFja3NwYWNlLCBkZWxldGUsIGFuZCBzaW1pbGFyIGZ1bmN0aW9uYWxpdHkuXG4gIGZ1bmN0aW9uIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sIGNvbXB1dGUpIHtcbiAgICB2YXIgcmFuZ2VzID0gY20uZG9jLnNlbC5yYW5nZXMsIGtpbGwgPSBbXTtcbiAgICAvLyBCdWlsZCB1cCBhIHNldCBvZiByYW5nZXMgdG8ga2lsbCBmaXJzdCwgbWVyZ2luZyBvdmVybGFwcGluZ1xuICAgIC8vIHJhbmdlcy5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHRvS2lsbCA9IGNvbXB1dGUocmFuZ2VzW2ldKTtcbiAgICAgIHdoaWxlIChraWxsLmxlbmd0aCAmJiBjbXAodG9LaWxsLmZyb20sIGxzdChraWxsKS50bykgPD0gMCkge1xuICAgICAgICB2YXIgcmVwbGFjZWQgPSBraWxsLnBvcCgpO1xuICAgICAgICBpZiAoY21wKHJlcGxhY2VkLmZyb20sIHRvS2lsbC5mcm9tKSA8IDApIHtcbiAgICAgICAgICB0b0tpbGwuZnJvbSA9IHJlcGxhY2VkLmZyb207XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGtpbGwucHVzaCh0b0tpbGwpO1xuICAgIH1cbiAgICAvLyBOZXh0LCByZW1vdmUgdGhvc2UgYWN0dWFsIHJhbmdlcy5cbiAgICBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgIGZvciAodmFyIGkgPSBraWxsLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKVxuICAgICAgICByZXBsYWNlUmFuZ2UoY20uZG9jLCBcIlwiLCBraWxsW2ldLmZyb20sIGtpbGxbaV0udG8sIFwiK2RlbGV0ZVwiKTtcbiAgICAgIGVuc3VyZUN1cnNvclZpc2libGUoY20pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gVXNlZCBmb3IgaG9yaXpvbnRhbCByZWxhdGl2ZSBtb3Rpb24uIERpciBpcyAtMSBvciAxIChsZWZ0IG9yXG4gIC8vIHJpZ2h0KSwgdW5pdCBjYW4gYmUgXCJjaGFyXCIsIFwiY29sdW1uXCIgKGxpa2UgY2hhciwgYnV0IGRvZXNuJ3RcbiAgLy8gY3Jvc3MgbGluZSBib3VuZGFyaWVzKSwgXCJ3b3JkXCIgKGFjcm9zcyBuZXh0IHdvcmQpLCBvciBcImdyb3VwXCIgKHRvXG4gIC8vIHRoZSBzdGFydCBvZiBuZXh0IGdyb3VwIG9mIHdvcmQgb3Igbm9uLXdvcmQtbm9uLXdoaXRlc3BhY2VcbiAgLy8gY2hhcnMpLiBUaGUgdmlzdWFsbHkgcGFyYW0gY29udHJvbHMgd2hldGhlciwgaW4gcmlnaHQtdG8tbGVmdFxuICAvLyB0ZXh0LCBkaXJlY3Rpb24gMSBtZWFucyB0byBtb3ZlIHRvd2FyZHMgdGhlIG5leHQgaW5kZXggaW4gdGhlXG4gIC8vIHN0cmluZywgb3IgdG93YXJkcyB0aGUgY2hhcmFjdGVyIHRvIHRoZSByaWdodCBvZiB0aGUgY3VycmVudFxuICAvLyBwb3NpdGlvbi4gVGhlIHJlc3VsdGluZyBwb3NpdGlvbiB3aWxsIGhhdmUgYSBoaXRTaWRlPXRydWVcbiAgLy8gcHJvcGVydHkgaWYgaXQgcmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBkb2N1bWVudC5cbiAgZnVuY3Rpb24gZmluZFBvc0goZG9jLCBwb3MsIGRpciwgdW5pdCwgdmlzdWFsbHkpIHtcbiAgICB2YXIgbGluZSA9IHBvcy5saW5lLCBjaCA9IHBvcy5jaCwgb3JpZ0RpciA9IGRpcjtcbiAgICB2YXIgbGluZU9iaiA9IGdldExpbmUoZG9jLCBsaW5lKTtcbiAgICB2YXIgcG9zc2libGUgPSB0cnVlO1xuICAgIGZ1bmN0aW9uIGZpbmROZXh0TGluZSgpIHtcbiAgICAgIHZhciBsID0gbGluZSArIGRpcjtcbiAgICAgIGlmIChsIDwgZG9jLmZpcnN0IHx8IGwgPj0gZG9jLmZpcnN0ICsgZG9jLnNpemUpIHJldHVybiAocG9zc2libGUgPSBmYWxzZSk7XG4gICAgICBsaW5lID0gbDtcbiAgICAgIHJldHVybiBsaW5lT2JqID0gZ2V0TGluZShkb2MsIGwpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBtb3ZlT25jZShib3VuZFRvTGluZSkge1xuICAgICAgdmFyIG5leHQgPSAodmlzdWFsbHkgPyBtb3ZlVmlzdWFsbHkgOiBtb3ZlTG9naWNhbGx5KShsaW5lT2JqLCBjaCwgZGlyLCB0cnVlKTtcbiAgICAgIGlmIChuZXh0ID09IG51bGwpIHtcbiAgICAgICAgaWYgKCFib3VuZFRvTGluZSAmJiBmaW5kTmV4dExpbmUoKSkge1xuICAgICAgICAgIGlmICh2aXN1YWxseSkgY2ggPSAoZGlyIDwgMCA/IGxpbmVSaWdodCA6IGxpbmVMZWZ0KShsaW5lT2JqKTtcbiAgICAgICAgICBlbHNlIGNoID0gZGlyIDwgMCA/IGxpbmVPYmoudGV4dC5sZW5ndGggOiAwO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIChwb3NzaWJsZSA9IGZhbHNlKTtcbiAgICAgIH0gZWxzZSBjaCA9IG5leHQ7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodW5pdCA9PSBcImNoYXJcIikgbW92ZU9uY2UoKTtcbiAgICBlbHNlIGlmICh1bml0ID09IFwiY29sdW1uXCIpIG1vdmVPbmNlKHRydWUpO1xuICAgIGVsc2UgaWYgKHVuaXQgPT0gXCJ3b3JkXCIgfHwgdW5pdCA9PSBcImdyb3VwXCIpIHtcbiAgICAgIHZhciBzYXdUeXBlID0gbnVsbCwgZ3JvdXAgPSB1bml0ID09IFwiZ3JvdXBcIjtcbiAgICAgIHZhciBoZWxwZXIgPSBkb2MuY20gJiYgZG9jLmNtLmdldEhlbHBlcihwb3MsIFwid29yZENoYXJzXCIpO1xuICAgICAgZm9yICh2YXIgZmlyc3QgPSB0cnVlOzsgZmlyc3QgPSBmYWxzZSkge1xuICAgICAgICBpZiAoZGlyIDwgMCAmJiAhbW92ZU9uY2UoIWZpcnN0KSkgYnJlYWs7XG4gICAgICAgIHZhciBjdXIgPSBsaW5lT2JqLnRleHQuY2hhckF0KGNoKSB8fCBcIlxcblwiO1xuICAgICAgICB2YXIgdHlwZSA9IGlzV29yZENoYXIoY3VyLCBoZWxwZXIpID8gXCJ3XCJcbiAgICAgICAgICA6IGdyb3VwICYmIGN1ciA9PSBcIlxcblwiID8gXCJuXCJcbiAgICAgICAgICA6ICFncm91cCB8fCAvXFxzLy50ZXN0KGN1cikgPyBudWxsXG4gICAgICAgICAgOiBcInBcIjtcbiAgICAgICAgaWYgKGdyb3VwICYmICFmaXJzdCAmJiAhdHlwZSkgdHlwZSA9IFwic1wiO1xuICAgICAgICBpZiAoc2F3VHlwZSAmJiBzYXdUeXBlICE9IHR5cGUpIHtcbiAgICAgICAgICBpZiAoZGlyIDwgMCkge2RpciA9IDE7IG1vdmVPbmNlKCk7fVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUpIHNhd1R5cGUgPSB0eXBlO1xuICAgICAgICBpZiAoZGlyID4gMCAmJiAhbW92ZU9uY2UoIWZpcnN0KSkgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBza2lwQXRvbWljKGRvYywgUG9zKGxpbmUsIGNoKSwgb3JpZ0RpciwgdHJ1ZSk7XG4gICAgaWYgKCFwb3NzaWJsZSkgcmVzdWx0LmhpdFNpZGUgPSB0cnVlO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBGb3IgcmVsYXRpdmUgdmVydGljYWwgbW92ZW1lbnQuIERpciBtYXkgYmUgLTEgb3IgMS4gVW5pdCBjYW4gYmVcbiAgLy8gXCJwYWdlXCIgb3IgXCJsaW5lXCIuIFRoZSByZXN1bHRpbmcgcG9zaXRpb24gd2lsbCBoYXZlIGEgaGl0U2lkZT10cnVlXG4gIC8vIHByb3BlcnR5IGlmIGl0IHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgZG9jdW1lbnQuXG4gIGZ1bmN0aW9uIGZpbmRQb3NWKGNtLCBwb3MsIGRpciwgdW5pdCkge1xuICAgIHZhciBkb2MgPSBjbS5kb2MsIHggPSBwb3MubGVmdCwgeTtcbiAgICBpZiAodW5pdCA9PSBcInBhZ2VcIikge1xuICAgICAgdmFyIHBhZ2VTaXplID0gTWF0aC5taW4oY20uZGlzcGxheS53cmFwcGVyLmNsaWVudEhlaWdodCwgd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpO1xuICAgICAgeSA9IHBvcy50b3AgKyBkaXIgKiAocGFnZVNpemUgLSAoZGlyIDwgMCA/IDEuNSA6IC41KSAqIHRleHRIZWlnaHQoY20uZGlzcGxheSkpO1xuICAgIH0gZWxzZSBpZiAodW5pdCA9PSBcImxpbmVcIikge1xuICAgICAgeSA9IGRpciA+IDAgPyBwb3MuYm90dG9tICsgMyA6IHBvcy50b3AgLSAzO1xuICAgIH1cbiAgICBmb3IgKDs7KSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gY29vcmRzQ2hhcihjbSwgeCwgeSk7XG4gICAgICBpZiAoIXRhcmdldC5vdXRzaWRlKSBicmVhaztcbiAgICAgIGlmIChkaXIgPCAwID8geSA8PSAwIDogeSA+PSBkb2MuaGVpZ2h0KSB7IHRhcmdldC5oaXRTaWRlID0gdHJ1ZTsgYnJlYWs7IH1cbiAgICAgIHkgKz0gZGlyICogNTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfVxuXG4gIC8vIEVESVRPUiBNRVRIT0RTXG5cbiAgLy8gVGhlIHB1YmxpY2x5IHZpc2libGUgQVBJLiBOb3RlIHRoYXQgbWV0aG9kT3AoZikgbWVhbnNcbiAgLy8gJ3dyYXAgZiBpbiBhbiBvcGVyYXRpb24sIHBlcmZvcm1lZCBvbiBpdHMgYHRoaXNgIHBhcmFtZXRlcicuXG5cbiAgLy8gVGhpcyBpcyBub3QgdGhlIGNvbXBsZXRlIHNldCBvZiBlZGl0b3IgbWV0aG9kcy4gTW9zdCBvZiB0aGVcbiAgLy8gbWV0aG9kcyBkZWZpbmVkIG9uIHRoZSBEb2MgdHlwZSBhcmUgYWxzbyBpbmplY3RlZCBpbnRvXG4gIC8vIENvZGVNaXJyb3IucHJvdG90eXBlLCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgYW5kXG4gIC8vIGNvbnZlbmllbmNlLlxuXG4gIENvZGVNaXJyb3IucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb2RlTWlycm9yLFxuICAgIGZvY3VzOiBmdW5jdGlvbigpe3dpbmRvdy5mb2N1cygpOyB0aGlzLmRpc3BsYXkuaW5wdXQuZm9jdXMoKTt9LFxuXG4gICAgc2V0T3B0aW9uOiBmdW5jdGlvbihvcHRpb24sIHZhbHVlKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucywgb2xkID0gb3B0aW9uc1tvcHRpb25dO1xuICAgICAgaWYgKG9wdGlvbnNbb3B0aW9uXSA9PSB2YWx1ZSAmJiBvcHRpb24gIT0gXCJtb2RlXCIpIHJldHVybjtcbiAgICAgIG9wdGlvbnNbb3B0aW9uXSA9IHZhbHVlO1xuICAgICAgaWYgKG9wdGlvbkhhbmRsZXJzLmhhc093blByb3BlcnR5KG9wdGlvbikpXG4gICAgICAgIG9wZXJhdGlvbih0aGlzLCBvcHRpb25IYW5kbGVyc1tvcHRpb25dKSh0aGlzLCB2YWx1ZSwgb2xkKTtcbiAgICB9LFxuXG4gICAgZ2V0T3B0aW9uOiBmdW5jdGlvbihvcHRpb24pIHtyZXR1cm4gdGhpcy5vcHRpb25zW29wdGlvbl07fSxcbiAgICBnZXREb2M6IGZ1bmN0aW9uKCkge3JldHVybiB0aGlzLmRvYzt9LFxuXG4gICAgYWRkS2V5TWFwOiBmdW5jdGlvbihtYXAsIGJvdHRvbSkge1xuICAgICAgdGhpcy5zdGF0ZS5rZXlNYXBzW2JvdHRvbSA/IFwicHVzaFwiIDogXCJ1bnNoaWZ0XCJdKGdldEtleU1hcChtYXApKTtcbiAgICB9LFxuICAgIHJlbW92ZUtleU1hcDogZnVuY3Rpb24obWFwKSB7XG4gICAgICB2YXIgbWFwcyA9IHRoaXMuc3RhdGUua2V5TWFwcztcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFwcy5sZW5ndGg7ICsraSlcbiAgICAgICAgaWYgKG1hcHNbaV0gPT0gbWFwIHx8IG1hcHNbaV0ubmFtZSA9PSBtYXApIHtcbiAgICAgICAgICBtYXBzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBhZGRPdmVybGF5OiBtZXRob2RPcChmdW5jdGlvbihzcGVjLCBvcHRpb25zKSB7XG4gICAgICB2YXIgbW9kZSA9IHNwZWMudG9rZW4gPyBzcGVjIDogQ29kZU1pcnJvci5nZXRNb2RlKHRoaXMub3B0aW9ucywgc3BlYyk7XG4gICAgICBpZiAobW9kZS5zdGFydFN0YXRlKSB0aHJvdyBuZXcgRXJyb3IoXCJPdmVybGF5cyBtYXkgbm90IGJlIHN0YXRlZnVsLlwiKTtcbiAgICAgIHRoaXMuc3RhdGUub3ZlcmxheXMucHVzaCh7bW9kZTogbW9kZSwgbW9kZVNwZWM6IHNwZWMsIG9wYXF1ZTogb3B0aW9ucyAmJiBvcHRpb25zLm9wYXF1ZX0pO1xuICAgICAgdGhpcy5zdGF0ZS5tb2RlR2VuKys7XG4gICAgICByZWdDaGFuZ2UodGhpcyk7XG4gICAgfSksXG4gICAgcmVtb3ZlT3ZlcmxheTogbWV0aG9kT3AoZnVuY3Rpb24oc3BlYykge1xuICAgICAgdmFyIG92ZXJsYXlzID0gdGhpcy5zdGF0ZS5vdmVybGF5cztcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3ZlcmxheXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGN1ciA9IG92ZXJsYXlzW2ldLm1vZGVTcGVjO1xuICAgICAgICBpZiAoY3VyID09IHNwZWMgfHwgdHlwZW9mIHNwZWMgPT0gXCJzdHJpbmdcIiAmJiBjdXIubmFtZSA9PSBzcGVjKSB7XG4gICAgICAgICAgb3ZlcmxheXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIHRoaXMuc3RhdGUubW9kZUdlbisrO1xuICAgICAgICAgIHJlZ0NoYW5nZSh0aGlzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSxcblxuICAgIGluZGVudExpbmU6IG1ldGhvZE9wKGZ1bmN0aW9uKG4sIGRpciwgYWdncmVzc2l2ZSkge1xuICAgICAgaWYgKHR5cGVvZiBkaXIgIT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgZGlyICE9IFwibnVtYmVyXCIpIHtcbiAgICAgICAgaWYgKGRpciA9PSBudWxsKSBkaXIgPSB0aGlzLm9wdGlvbnMuc21hcnRJbmRlbnQgPyBcInNtYXJ0XCIgOiBcInByZXZcIjtcbiAgICAgICAgZWxzZSBkaXIgPSBkaXIgPyBcImFkZFwiIDogXCJzdWJ0cmFjdFwiO1xuICAgICAgfVxuICAgICAgaWYgKGlzTGluZSh0aGlzLmRvYywgbikpIGluZGVudExpbmUodGhpcywgbiwgZGlyLCBhZ2dyZXNzaXZlKTtcbiAgICB9KSxcbiAgICBpbmRlbnRTZWxlY3Rpb246IG1ldGhvZE9wKGZ1bmN0aW9uKGhvdykge1xuICAgICAgdmFyIHJhbmdlcyA9IHRoaXMuZG9jLnNlbC5yYW5nZXMsIGVuZCA9IC0xO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHJhbmdlID0gcmFuZ2VzW2ldO1xuICAgICAgICBpZiAoIXJhbmdlLmVtcHR5KCkpIHtcbiAgICAgICAgICB2YXIgZnJvbSA9IHJhbmdlLmZyb20oKSwgdG8gPSByYW5nZS50bygpO1xuICAgICAgICAgIHZhciBzdGFydCA9IE1hdGgubWF4KGVuZCwgZnJvbS5saW5lKTtcbiAgICAgICAgICBlbmQgPSBNYXRoLm1pbih0aGlzLmxhc3RMaW5lKCksIHRvLmxpbmUgLSAodG8uY2ggPyAwIDogMSkpICsgMTtcbiAgICAgICAgICBmb3IgKHZhciBqID0gc3RhcnQ7IGogPCBlbmQ7ICsrailcbiAgICAgICAgICAgIGluZGVudExpbmUodGhpcywgaiwgaG93KTtcbiAgICAgICAgICB2YXIgbmV3UmFuZ2VzID0gdGhpcy5kb2Muc2VsLnJhbmdlcztcbiAgICAgICAgICBpZiAoZnJvbS5jaCA9PSAwICYmIHJhbmdlcy5sZW5ndGggPT0gbmV3UmFuZ2VzLmxlbmd0aCAmJiBuZXdSYW5nZXNbaV0uZnJvbSgpLmNoID4gMClcbiAgICAgICAgICAgIHJlcGxhY2VPbmVTZWxlY3Rpb24odGhpcy5kb2MsIGksIG5ldyBSYW5nZShmcm9tLCBuZXdSYW5nZXNbaV0udG8oKSksIHNlbF9kb250U2Nyb2xsKTtcbiAgICAgICAgfSBlbHNlIGlmIChyYW5nZS5oZWFkLmxpbmUgPiBlbmQpIHtcbiAgICAgICAgICBpbmRlbnRMaW5lKHRoaXMsIHJhbmdlLmhlYWQubGluZSwgaG93LCB0cnVlKTtcbiAgICAgICAgICBlbmQgPSByYW5nZS5oZWFkLmxpbmU7XG4gICAgICAgICAgaWYgKGkgPT0gdGhpcy5kb2Muc2VsLnByaW1JbmRleCkgZW5zdXJlQ3Vyc29yVmlzaWJsZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuXG4gICAgLy8gRmV0Y2ggdGhlIHBhcnNlciB0b2tlbiBmb3IgYSBnaXZlbiBjaGFyYWN0ZXIuIFVzZWZ1bCBmb3IgaGFja3NcbiAgICAvLyB0aGF0IHdhbnQgdG8gaW5zcGVjdCB0aGUgbW9kZSBzdGF0ZSAoc2F5LCBmb3IgY29tcGxldGlvbikuXG4gICAgZ2V0VG9rZW5BdDogZnVuY3Rpb24ocG9zLCBwcmVjaXNlKSB7XG4gICAgICByZXR1cm4gdGFrZVRva2VuKHRoaXMsIHBvcywgcHJlY2lzZSk7XG4gICAgfSxcblxuICAgIGdldExpbmVUb2tlbnM6IGZ1bmN0aW9uKGxpbmUsIHByZWNpc2UpIHtcbiAgICAgIHJldHVybiB0YWtlVG9rZW4odGhpcywgUG9zKGxpbmUpLCBwcmVjaXNlLCB0cnVlKTtcbiAgICB9LFxuXG4gICAgZ2V0VG9rZW5UeXBlQXQ6IGZ1bmN0aW9uKHBvcykge1xuICAgICAgcG9zID0gY2xpcFBvcyh0aGlzLmRvYywgcG9zKTtcbiAgICAgIHZhciBzdHlsZXMgPSBnZXRMaW5lU3R5bGVzKHRoaXMsIGdldExpbmUodGhpcy5kb2MsIHBvcy5saW5lKSk7XG4gICAgICB2YXIgYmVmb3JlID0gMCwgYWZ0ZXIgPSAoc3R5bGVzLmxlbmd0aCAtIDEpIC8gMiwgY2ggPSBwb3MuY2g7XG4gICAgICB2YXIgdHlwZTtcbiAgICAgIGlmIChjaCA9PSAwKSB0eXBlID0gc3R5bGVzWzJdO1xuICAgICAgZWxzZSBmb3IgKDs7KSB7XG4gICAgICAgIHZhciBtaWQgPSAoYmVmb3JlICsgYWZ0ZXIpID4+IDE7XG4gICAgICAgIGlmICgobWlkID8gc3R5bGVzW21pZCAqIDIgLSAxXSA6IDApID49IGNoKSBhZnRlciA9IG1pZDtcbiAgICAgICAgZWxzZSBpZiAoc3R5bGVzW21pZCAqIDIgKyAxXSA8IGNoKSBiZWZvcmUgPSBtaWQgKyAxO1xuICAgICAgICBlbHNlIHsgdHlwZSA9IHN0eWxlc1ttaWQgKiAyICsgMl07IGJyZWFrOyB9XG4gICAgICB9XG4gICAgICB2YXIgY3V0ID0gdHlwZSA/IHR5cGUuaW5kZXhPZihcImNtLW92ZXJsYXkgXCIpIDogLTE7XG4gICAgICByZXR1cm4gY3V0IDwgMCA/IHR5cGUgOiBjdXQgPT0gMCA/IG51bGwgOiB0eXBlLnNsaWNlKDAsIGN1dCAtIDEpO1xuICAgIH0sXG5cbiAgICBnZXRNb2RlQXQ6IGZ1bmN0aW9uKHBvcykge1xuICAgICAgdmFyIG1vZGUgPSB0aGlzLmRvYy5tb2RlO1xuICAgICAgaWYgKCFtb2RlLmlubmVyTW9kZSkgcmV0dXJuIG1vZGU7XG4gICAgICByZXR1cm4gQ29kZU1pcnJvci5pbm5lck1vZGUobW9kZSwgdGhpcy5nZXRUb2tlbkF0KHBvcykuc3RhdGUpLm1vZGU7XG4gICAgfSxcblxuICAgIGdldEhlbHBlcjogZnVuY3Rpb24ocG9zLCB0eXBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRIZWxwZXJzKHBvcywgdHlwZSlbMF07XG4gICAgfSxcblxuICAgIGdldEhlbHBlcnM6IGZ1bmN0aW9uKHBvcywgdHlwZSkge1xuICAgICAgdmFyIGZvdW5kID0gW107XG4gICAgICBpZiAoIWhlbHBlcnMuaGFzT3duUHJvcGVydHkodHlwZSkpIHJldHVybiBmb3VuZDtcbiAgICAgIHZhciBoZWxwID0gaGVscGVyc1t0eXBlXSwgbW9kZSA9IHRoaXMuZ2V0TW9kZUF0KHBvcyk7XG4gICAgICBpZiAodHlwZW9mIG1vZGVbdHlwZV0gPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBpZiAoaGVscFttb2RlW3R5cGVdXSkgZm91bmQucHVzaChoZWxwW21vZGVbdHlwZV1dKTtcbiAgICAgIH0gZWxzZSBpZiAobW9kZVt0eXBlXSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGVbdHlwZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgdmFsID0gaGVscFttb2RlW3R5cGVdW2ldXTtcbiAgICAgICAgICBpZiAodmFsKSBmb3VuZC5wdXNoKHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobW9kZS5oZWxwZXJUeXBlICYmIGhlbHBbbW9kZS5oZWxwZXJUeXBlXSkge1xuICAgICAgICBmb3VuZC5wdXNoKGhlbHBbbW9kZS5oZWxwZXJUeXBlXSk7XG4gICAgICB9IGVsc2UgaWYgKGhlbHBbbW9kZS5uYW1lXSkge1xuICAgICAgICBmb3VuZC5wdXNoKGhlbHBbbW9kZS5uYW1lXSk7XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhlbHAuX2dsb2JhbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY3VyID0gaGVscC5fZ2xvYmFsW2ldO1xuICAgICAgICBpZiAoY3VyLnByZWQobW9kZSwgdGhpcykgJiYgaW5kZXhPZihmb3VuZCwgY3VyLnZhbCkgPT0gLTEpXG4gICAgICAgICAgZm91bmQucHVzaChjdXIudmFsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgZ2V0U3RhdGVBZnRlcjogZnVuY3Rpb24obGluZSwgcHJlY2lzZSkge1xuICAgICAgdmFyIGRvYyA9IHRoaXMuZG9jO1xuICAgICAgbGluZSA9IGNsaXBMaW5lKGRvYywgbGluZSA9PSBudWxsID8gZG9jLmZpcnN0ICsgZG9jLnNpemUgLSAxOiBsaW5lKTtcbiAgICAgIHJldHVybiBnZXRTdGF0ZUJlZm9yZSh0aGlzLCBsaW5lICsgMSwgcHJlY2lzZSk7XG4gICAgfSxcblxuICAgIGN1cnNvckNvb3JkczogZnVuY3Rpb24oc3RhcnQsIG1vZGUpIHtcbiAgICAgIHZhciBwb3MsIHJhbmdlID0gdGhpcy5kb2Muc2VsLnByaW1hcnkoKTtcbiAgICAgIGlmIChzdGFydCA9PSBudWxsKSBwb3MgPSByYW5nZS5oZWFkO1xuICAgICAgZWxzZSBpZiAodHlwZW9mIHN0YXJ0ID09IFwib2JqZWN0XCIpIHBvcyA9IGNsaXBQb3ModGhpcy5kb2MsIHN0YXJ0KTtcbiAgICAgIGVsc2UgcG9zID0gc3RhcnQgPyByYW5nZS5mcm9tKCkgOiByYW5nZS50bygpO1xuICAgICAgcmV0dXJuIGN1cnNvckNvb3Jkcyh0aGlzLCBwb3MsIG1vZGUgfHwgXCJwYWdlXCIpO1xuICAgIH0sXG5cbiAgICBjaGFyQ29vcmRzOiBmdW5jdGlvbihwb3MsIG1vZGUpIHtcbiAgICAgIHJldHVybiBjaGFyQ29vcmRzKHRoaXMsIGNsaXBQb3ModGhpcy5kb2MsIHBvcyksIG1vZGUgfHwgXCJwYWdlXCIpO1xuICAgIH0sXG5cbiAgICBjb29yZHNDaGFyOiBmdW5jdGlvbihjb29yZHMsIG1vZGUpIHtcbiAgICAgIGNvb3JkcyA9IGZyb21Db29yZFN5c3RlbSh0aGlzLCBjb29yZHMsIG1vZGUgfHwgXCJwYWdlXCIpO1xuICAgICAgcmV0dXJuIGNvb3Jkc0NoYXIodGhpcywgY29vcmRzLmxlZnQsIGNvb3Jkcy50b3ApO1xuICAgIH0sXG5cbiAgICBsaW5lQXRIZWlnaHQ6IGZ1bmN0aW9uKGhlaWdodCwgbW9kZSkge1xuICAgICAgaGVpZ2h0ID0gZnJvbUNvb3JkU3lzdGVtKHRoaXMsIHt0b3A6IGhlaWdodCwgbGVmdDogMH0sIG1vZGUgfHwgXCJwYWdlXCIpLnRvcDtcbiAgICAgIHJldHVybiBsaW5lQXRIZWlnaHQodGhpcy5kb2MsIGhlaWdodCArIHRoaXMuZGlzcGxheS52aWV3T2Zmc2V0KTtcbiAgICB9LFxuICAgIGhlaWdodEF0TGluZTogZnVuY3Rpb24obGluZSwgbW9kZSkge1xuICAgICAgdmFyIGVuZCA9IGZhbHNlLCBsaW5lT2JqO1xuICAgICAgaWYgKHR5cGVvZiBsaW5lID09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgdmFyIGxhc3QgPSB0aGlzLmRvYy5maXJzdCArIHRoaXMuZG9jLnNpemUgLSAxO1xuICAgICAgICBpZiAobGluZSA8IHRoaXMuZG9jLmZpcnN0KSBsaW5lID0gdGhpcy5kb2MuZmlyc3Q7XG4gICAgICAgIGVsc2UgaWYgKGxpbmUgPiBsYXN0KSB7IGxpbmUgPSBsYXN0OyBlbmQgPSB0cnVlOyB9XG4gICAgICAgIGxpbmVPYmogPSBnZXRMaW5lKHRoaXMuZG9jLCBsaW5lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpbmVPYmogPSBsaW5lO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGludG9Db29yZFN5c3RlbSh0aGlzLCBsaW5lT2JqLCB7dG9wOiAwLCBsZWZ0OiAwfSwgbW9kZSB8fCBcInBhZ2VcIikudG9wICtcbiAgICAgICAgKGVuZCA/IHRoaXMuZG9jLmhlaWdodCAtIGhlaWdodEF0TGluZShsaW5lT2JqKSA6IDApO1xuICAgIH0sXG5cbiAgICBkZWZhdWx0VGV4dEhlaWdodDogZnVuY3Rpb24oKSB7IHJldHVybiB0ZXh0SGVpZ2h0KHRoaXMuZGlzcGxheSk7IH0sXG4gICAgZGVmYXVsdENoYXJXaWR0aDogZnVuY3Rpb24oKSB7IHJldHVybiBjaGFyV2lkdGgodGhpcy5kaXNwbGF5KTsgfSxcblxuICAgIHNldEd1dHRlck1hcmtlcjogbWV0aG9kT3AoZnVuY3Rpb24obGluZSwgZ3V0dGVySUQsIHZhbHVlKSB7XG4gICAgICByZXR1cm4gY2hhbmdlTGluZSh0aGlzLmRvYywgbGluZSwgXCJndXR0ZXJcIiwgZnVuY3Rpb24obGluZSkge1xuICAgICAgICB2YXIgbWFya2VycyA9IGxpbmUuZ3V0dGVyTWFya2VycyB8fCAobGluZS5ndXR0ZXJNYXJrZXJzID0ge30pO1xuICAgICAgICBtYXJrZXJzW2d1dHRlcklEXSA9IHZhbHVlO1xuICAgICAgICBpZiAoIXZhbHVlICYmIGlzRW1wdHkobWFya2VycykpIGxpbmUuZ3V0dGVyTWFya2VycyA9IG51bGw7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBjbGVhckd1dHRlcjogbWV0aG9kT3AoZnVuY3Rpb24oZ3V0dGVySUQpIHtcbiAgICAgIHZhciBjbSA9IHRoaXMsIGRvYyA9IGNtLmRvYywgaSA9IGRvYy5maXJzdDtcbiAgICAgIGRvYy5pdGVyKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgaWYgKGxpbmUuZ3V0dGVyTWFya2VycyAmJiBsaW5lLmd1dHRlck1hcmtlcnNbZ3V0dGVySURdKSB7XG4gICAgICAgICAgbGluZS5ndXR0ZXJNYXJrZXJzW2d1dHRlcklEXSA9IG51bGw7XG4gICAgICAgICAgcmVnTGluZUNoYW5nZShjbSwgaSwgXCJndXR0ZXJcIik7XG4gICAgICAgICAgaWYgKGlzRW1wdHkobGluZS5ndXR0ZXJNYXJrZXJzKSkgbGluZS5ndXR0ZXJNYXJrZXJzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICArK2k7XG4gICAgICB9KTtcbiAgICB9KSxcblxuICAgIGxpbmVJbmZvOiBmdW5jdGlvbihsaW5lKSB7XG4gICAgICBpZiAodHlwZW9mIGxpbmUgPT0gXCJudW1iZXJcIikge1xuICAgICAgICBpZiAoIWlzTGluZSh0aGlzLmRvYywgbGluZSkpIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgbiA9IGxpbmU7XG4gICAgICAgIGxpbmUgPSBnZXRMaW5lKHRoaXMuZG9jLCBsaW5lKTtcbiAgICAgICAgaWYgKCFsaW5lKSByZXR1cm4gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuID0gbGluZU5vKGxpbmUpO1xuICAgICAgICBpZiAobiA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7bGluZTogbiwgaGFuZGxlOiBsaW5lLCB0ZXh0OiBsaW5lLnRleHQsIGd1dHRlck1hcmtlcnM6IGxpbmUuZ3V0dGVyTWFya2VycyxcbiAgICAgICAgICAgICAgdGV4dENsYXNzOiBsaW5lLnRleHRDbGFzcywgYmdDbGFzczogbGluZS5iZ0NsYXNzLCB3cmFwQ2xhc3M6IGxpbmUud3JhcENsYXNzLFxuICAgICAgICAgICAgICB3aWRnZXRzOiBsaW5lLndpZGdldHN9O1xuICAgIH0sXG5cbiAgICBnZXRWaWV3cG9ydDogZnVuY3Rpb24oKSB7IHJldHVybiB7ZnJvbTogdGhpcy5kaXNwbGF5LnZpZXdGcm9tLCB0bzogdGhpcy5kaXNwbGF5LnZpZXdUb307fSxcblxuICAgIGFkZFdpZGdldDogZnVuY3Rpb24ocG9zLCBub2RlLCBzY3JvbGwsIHZlcnQsIGhvcml6KSB7XG4gICAgICB2YXIgZGlzcGxheSA9IHRoaXMuZGlzcGxheTtcbiAgICAgIHBvcyA9IGN1cnNvckNvb3Jkcyh0aGlzLCBjbGlwUG9zKHRoaXMuZG9jLCBwb3MpKTtcbiAgICAgIHZhciB0b3AgPSBwb3MuYm90dG9tLCBsZWZ0ID0gcG9zLmxlZnQ7XG4gICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoXCJjbS1pZ25vcmUtZXZlbnRzXCIsIFwidHJ1ZVwiKTtcbiAgICAgIHRoaXMuZGlzcGxheS5pbnB1dC5zZXRVbmVkaXRhYmxlKG5vZGUpO1xuICAgICAgZGlzcGxheS5zaXplci5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgIGlmICh2ZXJ0ID09IFwib3ZlclwiKSB7XG4gICAgICAgIHRvcCA9IHBvcy50b3A7XG4gICAgICB9IGVsc2UgaWYgKHZlcnQgPT0gXCJhYm92ZVwiIHx8IHZlcnQgPT0gXCJuZWFyXCIpIHtcbiAgICAgICAgdmFyIHZzcGFjZSA9IE1hdGgubWF4KGRpc3BsYXkud3JhcHBlci5jbGllbnRIZWlnaHQsIHRoaXMuZG9jLmhlaWdodCksXG4gICAgICAgIGhzcGFjZSA9IE1hdGgubWF4KGRpc3BsYXkuc2l6ZXIuY2xpZW50V2lkdGgsIGRpc3BsYXkubGluZVNwYWNlLmNsaWVudFdpZHRoKTtcbiAgICAgICAgLy8gRGVmYXVsdCB0byBwb3NpdGlvbmluZyBhYm92ZSAoaWYgc3BlY2lmaWVkIGFuZCBwb3NzaWJsZSk7IG90aGVyd2lzZSBkZWZhdWx0IHRvIHBvc2l0aW9uaW5nIGJlbG93XG4gICAgICAgIGlmICgodmVydCA9PSAnYWJvdmUnIHx8IHBvcy5ib3R0b20gKyBub2RlLm9mZnNldEhlaWdodCA+IHZzcGFjZSkgJiYgcG9zLnRvcCA+IG5vZGUub2Zmc2V0SGVpZ2h0KVxuICAgICAgICAgIHRvcCA9IHBvcy50b3AgLSBub2RlLm9mZnNldEhlaWdodDtcbiAgICAgICAgZWxzZSBpZiAocG9zLmJvdHRvbSArIG5vZGUub2Zmc2V0SGVpZ2h0IDw9IHZzcGFjZSlcbiAgICAgICAgICB0b3AgPSBwb3MuYm90dG9tO1xuICAgICAgICBpZiAobGVmdCArIG5vZGUub2Zmc2V0V2lkdGggPiBoc3BhY2UpXG4gICAgICAgICAgbGVmdCA9IGhzcGFjZSAtIG5vZGUub2Zmc2V0V2lkdGg7XG4gICAgICB9XG4gICAgICBub2RlLnN0eWxlLnRvcCA9IHRvcCArIFwicHhcIjtcbiAgICAgIG5vZGUuc3R5bGUubGVmdCA9IG5vZGUuc3R5bGUucmlnaHQgPSBcIlwiO1xuICAgICAgaWYgKGhvcml6ID09IFwicmlnaHRcIikge1xuICAgICAgICBsZWZ0ID0gZGlzcGxheS5zaXplci5jbGllbnRXaWR0aCAtIG5vZGUub2Zmc2V0V2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUucmlnaHQgPSBcIjBweFwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGhvcml6ID09IFwibGVmdFwiKSBsZWZ0ID0gMDtcbiAgICAgICAgZWxzZSBpZiAoaG9yaXogPT0gXCJtaWRkbGVcIikgbGVmdCA9IChkaXNwbGF5LnNpemVyLmNsaWVudFdpZHRoIC0gbm9kZS5vZmZzZXRXaWR0aCkgLyAyO1xuICAgICAgICBub2RlLnN0eWxlLmxlZnQgPSBsZWZ0ICsgXCJweFwiO1xuICAgICAgfVxuICAgICAgaWYgKHNjcm9sbClcbiAgICAgICAgc2Nyb2xsSW50b1ZpZXcodGhpcywgbGVmdCwgdG9wLCBsZWZ0ICsgbm9kZS5vZmZzZXRXaWR0aCwgdG9wICsgbm9kZS5vZmZzZXRIZWlnaHQpO1xuICAgIH0sXG5cbiAgICB0cmlnZ2VyT25LZXlEb3duOiBtZXRob2RPcChvbktleURvd24pLFxuICAgIHRyaWdnZXJPbktleVByZXNzOiBtZXRob2RPcChvbktleVByZXNzKSxcbiAgICB0cmlnZ2VyT25LZXlVcDogb25LZXlVcCxcblxuICAgIGV4ZWNDb21tYW5kOiBmdW5jdGlvbihjbWQpIHtcbiAgICAgIGlmIChjb21tYW5kcy5oYXNPd25Qcm9wZXJ0eShjbWQpKVxuICAgICAgICByZXR1cm4gY29tbWFuZHNbY21kXS5jYWxsKG51bGwsIHRoaXMpO1xuICAgIH0sXG5cbiAgICB0cmlnZ2VyRWxlY3RyaWM6IG1ldGhvZE9wKGZ1bmN0aW9uKHRleHQpIHsgdHJpZ2dlckVsZWN0cmljKHRoaXMsIHRleHQpOyB9KSxcblxuICAgIGZpbmRQb3NIOiBmdW5jdGlvbihmcm9tLCBhbW91bnQsIHVuaXQsIHZpc3VhbGx5KSB7XG4gICAgICB2YXIgZGlyID0gMTtcbiAgICAgIGlmIChhbW91bnQgPCAwKSB7IGRpciA9IC0xOyBhbW91bnQgPSAtYW1vdW50OyB9XG4gICAgICBmb3IgKHZhciBpID0gMCwgY3VyID0gY2xpcFBvcyh0aGlzLmRvYywgZnJvbSk7IGkgPCBhbW91bnQ7ICsraSkge1xuICAgICAgICBjdXIgPSBmaW5kUG9zSCh0aGlzLmRvYywgY3VyLCBkaXIsIHVuaXQsIHZpc3VhbGx5KTtcbiAgICAgICAgaWYgKGN1ci5oaXRTaWRlKSBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiBjdXI7XG4gICAgfSxcblxuICAgIG1vdmVIOiBtZXRob2RPcChmdW5jdGlvbihkaXIsIHVuaXQpIHtcbiAgICAgIHZhciBjbSA9IHRoaXM7XG4gICAgICBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgaWYgKGNtLmRpc3BsYXkuc2hpZnQgfHwgY20uZG9jLmV4dGVuZCB8fCByYW5nZS5lbXB0eSgpKVxuICAgICAgICAgIHJldHVybiBmaW5kUG9zSChjbS5kb2MsIHJhbmdlLmhlYWQsIGRpciwgdW5pdCwgY20ub3B0aW9ucy5ydGxNb3ZlVmlzdWFsbHkpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgcmV0dXJuIGRpciA8IDAgPyByYW5nZS5mcm9tKCkgOiByYW5nZS50bygpO1xuICAgICAgfSwgc2VsX21vdmUpO1xuICAgIH0pLFxuXG4gICAgZGVsZXRlSDogbWV0aG9kT3AoZnVuY3Rpb24oZGlyLCB1bml0KSB7XG4gICAgICB2YXIgc2VsID0gdGhpcy5kb2Muc2VsLCBkb2MgPSB0aGlzLmRvYztcbiAgICAgIGlmIChzZWwuc29tZXRoaW5nU2VsZWN0ZWQoKSlcbiAgICAgICAgZG9jLnJlcGxhY2VTZWxlY3Rpb24oXCJcIiwgbnVsbCwgXCIrZGVsZXRlXCIpO1xuICAgICAgZWxzZVxuICAgICAgICBkZWxldGVOZWFyU2VsZWN0aW9uKHRoaXMsIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgICAgdmFyIG90aGVyID0gZmluZFBvc0goZG9jLCByYW5nZS5oZWFkLCBkaXIsIHVuaXQsIGZhbHNlKTtcbiAgICAgICAgICByZXR1cm4gZGlyIDwgMCA/IHtmcm9tOiBvdGhlciwgdG86IHJhbmdlLmhlYWR9IDoge2Zyb206IHJhbmdlLmhlYWQsIHRvOiBvdGhlcn07XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgZmluZFBvc1Y6IGZ1bmN0aW9uKGZyb20sIGFtb3VudCwgdW5pdCwgZ29hbENvbHVtbikge1xuICAgICAgdmFyIGRpciA9IDEsIHggPSBnb2FsQ29sdW1uO1xuICAgICAgaWYgKGFtb3VudCA8IDApIHsgZGlyID0gLTE7IGFtb3VudCA9IC1hbW91bnQ7IH1cbiAgICAgIGZvciAodmFyIGkgPSAwLCBjdXIgPSBjbGlwUG9zKHRoaXMuZG9jLCBmcm9tKTsgaSA8IGFtb3VudDsgKytpKSB7XG4gICAgICAgIHZhciBjb29yZHMgPSBjdXJzb3JDb29yZHModGhpcywgY3VyLCBcImRpdlwiKTtcbiAgICAgICAgaWYgKHggPT0gbnVsbCkgeCA9IGNvb3Jkcy5sZWZ0O1xuICAgICAgICBlbHNlIGNvb3Jkcy5sZWZ0ID0geDtcbiAgICAgICAgY3VyID0gZmluZFBvc1YodGhpcywgY29vcmRzLCBkaXIsIHVuaXQpO1xuICAgICAgICBpZiAoY3VyLmhpdFNpZGUpIGJyZWFrO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGN1cjtcbiAgICB9LFxuXG4gICAgbW92ZVY6IG1ldGhvZE9wKGZ1bmN0aW9uKGRpciwgdW5pdCkge1xuICAgICAgdmFyIGNtID0gdGhpcywgZG9jID0gdGhpcy5kb2MsIGdvYWxzID0gW107XG4gICAgICB2YXIgY29sbGFwc2UgPSAhY20uZGlzcGxheS5zaGlmdCAmJiAhZG9jLmV4dGVuZCAmJiBkb2Muc2VsLnNvbWV0aGluZ1NlbGVjdGVkKCk7XG4gICAgICBkb2MuZXh0ZW5kU2VsZWN0aW9uc0J5KGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgIGlmIChjb2xsYXBzZSlcbiAgICAgICAgICByZXR1cm4gZGlyIDwgMCA/IHJhbmdlLmZyb20oKSA6IHJhbmdlLnRvKCk7XG4gICAgICAgIHZhciBoZWFkUG9zID0gY3Vyc29yQ29vcmRzKGNtLCByYW5nZS5oZWFkLCBcImRpdlwiKTtcbiAgICAgICAgaWYgKHJhbmdlLmdvYWxDb2x1bW4gIT0gbnVsbCkgaGVhZFBvcy5sZWZ0ID0gcmFuZ2UuZ29hbENvbHVtbjtcbiAgICAgICAgZ29hbHMucHVzaChoZWFkUG9zLmxlZnQpO1xuICAgICAgICB2YXIgcG9zID0gZmluZFBvc1YoY20sIGhlYWRQb3MsIGRpciwgdW5pdCk7XG4gICAgICAgIGlmICh1bml0ID09IFwicGFnZVwiICYmIHJhbmdlID09IGRvYy5zZWwucHJpbWFyeSgpKVxuICAgICAgICAgIGFkZFRvU2Nyb2xsUG9zKGNtLCBudWxsLCBjaGFyQ29vcmRzKGNtLCBwb3MsIFwiZGl2XCIpLnRvcCAtIGhlYWRQb3MudG9wKTtcbiAgICAgICAgcmV0dXJuIHBvcztcbiAgICAgIH0sIHNlbF9tb3ZlKTtcbiAgICAgIGlmIChnb2Fscy5sZW5ndGgpIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jLnNlbC5yYW5nZXMubGVuZ3RoOyBpKyspXG4gICAgICAgIGRvYy5zZWwucmFuZ2VzW2ldLmdvYWxDb2x1bW4gPSBnb2Fsc1tpXTtcbiAgICB9KSxcblxuICAgIC8vIEZpbmQgdGhlIHdvcmQgYXQgdGhlIGdpdmVuIHBvc2l0aW9uIChhcyByZXR1cm5lZCBieSBjb29yZHNDaGFyKS5cbiAgICBmaW5kV29yZEF0OiBmdW5jdGlvbihwb3MpIHtcbiAgICAgIHZhciBkb2MgPSB0aGlzLmRvYywgbGluZSA9IGdldExpbmUoZG9jLCBwb3MubGluZSkudGV4dDtcbiAgICAgIHZhciBzdGFydCA9IHBvcy5jaCwgZW5kID0gcG9zLmNoO1xuICAgICAgaWYgKGxpbmUpIHtcbiAgICAgICAgdmFyIGhlbHBlciA9IHRoaXMuZ2V0SGVscGVyKHBvcywgXCJ3b3JkQ2hhcnNcIik7XG4gICAgICAgIGlmICgocG9zLnhSZWwgPCAwIHx8IGVuZCA9PSBsaW5lLmxlbmd0aCkgJiYgc3RhcnQpIC0tc3RhcnQ7IGVsc2UgKytlbmQ7XG4gICAgICAgIHZhciBzdGFydENoYXIgPSBsaW5lLmNoYXJBdChzdGFydCk7XG4gICAgICAgIHZhciBjaGVjayA9IGlzV29yZENoYXIoc3RhcnRDaGFyLCBoZWxwZXIpXG4gICAgICAgICAgPyBmdW5jdGlvbihjaCkgeyByZXR1cm4gaXNXb3JkQ2hhcihjaCwgaGVscGVyKTsgfVxuICAgICAgICAgIDogL1xccy8udGVzdChzdGFydENoYXIpID8gZnVuY3Rpb24oY2gpIHtyZXR1cm4gL1xccy8udGVzdChjaCk7fVxuICAgICAgICAgIDogZnVuY3Rpb24oY2gpIHtyZXR1cm4gIS9cXHMvLnRlc3QoY2gpICYmICFpc1dvcmRDaGFyKGNoKTt9O1xuICAgICAgICB3aGlsZSAoc3RhcnQgPiAwICYmIGNoZWNrKGxpbmUuY2hhckF0KHN0YXJ0IC0gMSkpKSAtLXN0YXJ0O1xuICAgICAgICB3aGlsZSAoZW5kIDwgbGluZS5sZW5ndGggJiYgY2hlY2sobGluZS5jaGFyQXQoZW5kKSkpICsrZW5kO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBSYW5nZShQb3MocG9zLmxpbmUsIHN0YXJ0KSwgUG9zKHBvcy5saW5lLCBlbmQpKTtcbiAgICB9LFxuXG4gICAgdG9nZ2xlT3ZlcndyaXRlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlICE9IG51bGwgJiYgdmFsdWUgPT0gdGhpcy5zdGF0ZS5vdmVyd3JpdGUpIHJldHVybjtcbiAgICAgIGlmICh0aGlzLnN0YXRlLm92ZXJ3cml0ZSA9ICF0aGlzLnN0YXRlLm92ZXJ3cml0ZSlcbiAgICAgICAgYWRkQ2xhc3ModGhpcy5kaXNwbGF5LmN1cnNvckRpdiwgXCJDb2RlTWlycm9yLW92ZXJ3cml0ZVwiKTtcbiAgICAgIGVsc2VcbiAgICAgICAgcm1DbGFzcyh0aGlzLmRpc3BsYXkuY3Vyc29yRGl2LCBcIkNvZGVNaXJyb3Itb3ZlcndyaXRlXCIpO1xuXG4gICAgICBzaWduYWwodGhpcywgXCJvdmVyd3JpdGVUb2dnbGVcIiwgdGhpcywgdGhpcy5zdGF0ZS5vdmVyd3JpdGUpO1xuICAgIH0sXG4gICAgaGFzRm9jdXM6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5kaXNwbGF5LmlucHV0LmdldEZpZWxkKCkgPT0gYWN0aXZlRWx0KCk7IH0sXG5cbiAgICBzY3JvbGxUbzogbWV0aG9kT3AoZnVuY3Rpb24oeCwgeSkge1xuICAgICAgaWYgKHggIT0gbnVsbCB8fCB5ICE9IG51bGwpIHJlc29sdmVTY3JvbGxUb1Bvcyh0aGlzKTtcbiAgICAgIGlmICh4ICE9IG51bGwpIHRoaXMuY3VyT3Auc2Nyb2xsTGVmdCA9IHg7XG4gICAgICBpZiAoeSAhPSBudWxsKSB0aGlzLmN1ck9wLnNjcm9sbFRvcCA9IHk7XG4gICAgfSksXG4gICAgZ2V0U2Nyb2xsSW5mbzogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLmRpc3BsYXkuc2Nyb2xsZXI7XG4gICAgICByZXR1cm4ge2xlZnQ6IHNjcm9sbGVyLnNjcm9sbExlZnQsIHRvcDogc2Nyb2xsZXIuc2Nyb2xsVG9wLFxuICAgICAgICAgICAgICBoZWlnaHQ6IHNjcm9sbGVyLnNjcm9sbEhlaWdodCAtIHNjcm9sbEdhcCh0aGlzKSAtIHRoaXMuZGlzcGxheS5iYXJIZWlnaHQsXG4gICAgICAgICAgICAgIHdpZHRoOiBzY3JvbGxlci5zY3JvbGxXaWR0aCAtIHNjcm9sbEdhcCh0aGlzKSAtIHRoaXMuZGlzcGxheS5iYXJXaWR0aCxcbiAgICAgICAgICAgICAgY2xpZW50SGVpZ2h0OiBkaXNwbGF5SGVpZ2h0KHRoaXMpLCBjbGllbnRXaWR0aDogZGlzcGxheVdpZHRoKHRoaXMpfTtcbiAgICB9LFxuXG4gICAgc2Nyb2xsSW50b1ZpZXc6IG1ldGhvZE9wKGZ1bmN0aW9uKHJhbmdlLCBtYXJnaW4pIHtcbiAgICAgIGlmIChyYW5nZSA9PSBudWxsKSB7XG4gICAgICAgIHJhbmdlID0ge2Zyb206IHRoaXMuZG9jLnNlbC5wcmltYXJ5KCkuaGVhZCwgdG86IG51bGx9O1xuICAgICAgICBpZiAobWFyZ2luID09IG51bGwpIG1hcmdpbiA9IHRoaXMub3B0aW9ucy5jdXJzb3JTY3JvbGxNYXJnaW47XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiByYW5nZSA9PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJhbmdlID0ge2Zyb206IFBvcyhyYW5nZSwgMCksIHRvOiBudWxsfTtcbiAgICAgIH0gZWxzZSBpZiAocmFuZ2UuZnJvbSA9PSBudWxsKSB7XG4gICAgICAgIHJhbmdlID0ge2Zyb206IHJhbmdlLCB0bzogbnVsbH07XG4gICAgICB9XG4gICAgICBpZiAoIXJhbmdlLnRvKSByYW5nZS50byA9IHJhbmdlLmZyb207XG4gICAgICByYW5nZS5tYXJnaW4gPSBtYXJnaW4gfHwgMDtcblxuICAgICAgaWYgKHJhbmdlLmZyb20ubGluZSAhPSBudWxsKSB7XG4gICAgICAgIHJlc29sdmVTY3JvbGxUb1Bvcyh0aGlzKTtcbiAgICAgICAgdGhpcy5jdXJPcC5zY3JvbGxUb1BvcyA9IHJhbmdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHNQb3MgPSBjYWxjdWxhdGVTY3JvbGxQb3ModGhpcywgTWF0aC5taW4ocmFuZ2UuZnJvbS5sZWZ0LCByYW5nZS50by5sZWZ0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4ocmFuZ2UuZnJvbS50b3AsIHJhbmdlLnRvLnRvcCkgLSByYW5nZS5tYXJnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KHJhbmdlLmZyb20ucmlnaHQsIHJhbmdlLnRvLnJpZ2h0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgocmFuZ2UuZnJvbS5ib3R0b20sIHJhbmdlLnRvLmJvdHRvbSkgKyByYW5nZS5tYXJnaW4pO1xuICAgICAgICB0aGlzLnNjcm9sbFRvKHNQb3Muc2Nyb2xsTGVmdCwgc1Bvcy5zY3JvbGxUb3ApO1xuICAgICAgfVxuICAgIH0pLFxuXG4gICAgc2V0U2l6ZTogbWV0aG9kT3AoZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuICAgICAgdmFyIGNtID0gdGhpcztcbiAgICAgIGZ1bmN0aW9uIGludGVycHJldCh2YWwpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWwgPT0gXCJudW1iZXJcIiB8fCAvXlxcZCskLy50ZXN0KFN0cmluZyh2YWwpKSA/IHZhbCArIFwicHhcIiA6IHZhbDtcbiAgICAgIH1cbiAgICAgIGlmICh3aWR0aCAhPSBudWxsKSBjbS5kaXNwbGF5LndyYXBwZXIuc3R5bGUud2lkdGggPSBpbnRlcnByZXQod2lkdGgpO1xuICAgICAgaWYgKGhlaWdodCAhPSBudWxsKSBjbS5kaXNwbGF5LndyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gaW50ZXJwcmV0KGhlaWdodCk7XG4gICAgICBpZiAoY20ub3B0aW9ucy5saW5lV3JhcHBpbmcpIGNsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGUodGhpcyk7XG4gICAgICB2YXIgbGluZU5vID0gY20uZGlzcGxheS52aWV3RnJvbTtcbiAgICAgIGNtLmRvYy5pdGVyKGxpbmVObywgY20uZGlzcGxheS52aWV3VG8sIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgaWYgKGxpbmUud2lkZ2V0cykgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lLndpZGdldHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgaWYgKGxpbmUud2lkZ2V0c1tpXS5ub0hTY3JvbGwpIHsgcmVnTGluZUNoYW5nZShjbSwgbGluZU5vLCBcIndpZGdldFwiKTsgYnJlYWs7IH1cbiAgICAgICAgKytsaW5lTm87XG4gICAgICB9KTtcbiAgICAgIGNtLmN1ck9wLmZvcmNlVXBkYXRlID0gdHJ1ZTtcbiAgICAgIHNpZ25hbChjbSwgXCJyZWZyZXNoXCIsIHRoaXMpO1xuICAgIH0pLFxuXG4gICAgb3BlcmF0aW9uOiBmdW5jdGlvbihmKXtyZXR1cm4gcnVuSW5PcCh0aGlzLCBmKTt9LFxuXG4gICAgcmVmcmVzaDogbWV0aG9kT3AoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb2xkSGVpZ2h0ID0gdGhpcy5kaXNwbGF5LmNhY2hlZFRleHRIZWlnaHQ7XG4gICAgICByZWdDaGFuZ2UodGhpcyk7XG4gICAgICB0aGlzLmN1ck9wLmZvcmNlVXBkYXRlID0gdHJ1ZTtcbiAgICAgIGNsZWFyQ2FjaGVzKHRoaXMpO1xuICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLmRvYy5zY3JvbGxMZWZ0LCB0aGlzLmRvYy5zY3JvbGxUb3ApO1xuICAgICAgdXBkYXRlR3V0dGVyU3BhY2UodGhpcyk7XG4gICAgICBpZiAob2xkSGVpZ2h0ID09IG51bGwgfHwgTWF0aC5hYnMob2xkSGVpZ2h0IC0gdGV4dEhlaWdodCh0aGlzLmRpc3BsYXkpKSA+IC41KVxuICAgICAgICBlc3RpbWF0ZUxpbmVIZWlnaHRzKHRoaXMpO1xuICAgICAgc2lnbmFsKHRoaXMsIFwicmVmcmVzaFwiLCB0aGlzKTtcbiAgICB9KSxcblxuICAgIHN3YXBEb2M6IG1ldGhvZE9wKGZ1bmN0aW9uKGRvYykge1xuICAgICAgdmFyIG9sZCA9IHRoaXMuZG9jO1xuICAgICAgb2xkLmNtID0gbnVsbDtcbiAgICAgIGF0dGFjaERvYyh0aGlzLCBkb2MpO1xuICAgICAgY2xlYXJDYWNoZXModGhpcyk7XG4gICAgICB0aGlzLmRpc3BsYXkuaW5wdXQucmVzZXQoKTtcbiAgICAgIHRoaXMuc2Nyb2xsVG8oZG9jLnNjcm9sbExlZnQsIGRvYy5zY3JvbGxUb3ApO1xuICAgICAgdGhpcy5jdXJPcC5mb3JjZVNjcm9sbCA9IHRydWU7XG4gICAgICBzaWduYWxMYXRlcih0aGlzLCBcInN3YXBEb2NcIiwgdGhpcywgb2xkKTtcbiAgICAgIHJldHVybiBvbGQ7XG4gICAgfSksXG5cbiAgICBnZXRJbnB1dEZpZWxkOiBmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXkuaW5wdXQuZ2V0RmllbGQoKTt9LFxuICAgIGdldFdyYXBwZXJFbGVtZW50OiBmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXkud3JhcHBlcjt9LFxuICAgIGdldFNjcm9sbGVyRWxlbWVudDogZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNwbGF5LnNjcm9sbGVyO30sXG4gICAgZ2V0R3V0dGVyRWxlbWVudDogZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNwbGF5Lmd1dHRlcnM7fVxuICB9O1xuICBldmVudE1peGluKENvZGVNaXJyb3IpO1xuXG4gIC8vIE9QVElPTiBERUZBVUxUU1xuXG4gIC8vIFRoZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cbiAgdmFyIGRlZmF1bHRzID0gQ29kZU1pcnJvci5kZWZhdWx0cyA9IHt9O1xuICAvLyBGdW5jdGlvbnMgdG8gcnVuIHdoZW4gb3B0aW9ucyBhcmUgY2hhbmdlZC5cbiAgdmFyIG9wdGlvbkhhbmRsZXJzID0gQ29kZU1pcnJvci5vcHRpb25IYW5kbGVycyA9IHt9O1xuXG4gIGZ1bmN0aW9uIG9wdGlvbihuYW1lLCBkZWZsdCwgaGFuZGxlLCBub3RPbkluaXQpIHtcbiAgICBDb2RlTWlycm9yLmRlZmF1bHRzW25hbWVdID0gZGVmbHQ7XG4gICAgaWYgKGhhbmRsZSkgb3B0aW9uSGFuZGxlcnNbbmFtZV0gPVxuICAgICAgbm90T25Jbml0ID8gZnVuY3Rpb24oY20sIHZhbCwgb2xkKSB7aWYgKG9sZCAhPSBJbml0KSBoYW5kbGUoY20sIHZhbCwgb2xkKTt9IDogaGFuZGxlO1xuICB9XG5cbiAgLy8gUGFzc2VkIHRvIG9wdGlvbiBoYW5kbGVycyB3aGVuIHRoZXJlIGlzIG5vIG9sZCB2YWx1ZS5cbiAgdmFyIEluaXQgPSBDb2RlTWlycm9yLkluaXQgPSB7dG9TdHJpbmc6IGZ1bmN0aW9uKCl7cmV0dXJuIFwiQ29kZU1pcnJvci5Jbml0XCI7fX07XG5cbiAgLy8gVGhlc2UgdHdvIGFyZSwgb24gaW5pdCwgY2FsbGVkIGZyb20gdGhlIGNvbnN0cnVjdG9yIGJlY2F1c2UgdGhleVxuICAvLyBoYXZlIHRvIGJlIGluaXRpYWxpemVkIGJlZm9yZSB0aGUgZWRpdG9yIGNhbiBzdGFydCBhdCBhbGwuXG4gIG9wdGlvbihcInZhbHVlXCIsIFwiXCIsIGZ1bmN0aW9uKGNtLCB2YWwpIHtcbiAgICBjbS5zZXRWYWx1ZSh2YWwpO1xuICB9LCB0cnVlKTtcbiAgb3B0aW9uKFwibW9kZVwiLCBudWxsLCBmdW5jdGlvbihjbSwgdmFsKSB7XG4gICAgY20uZG9jLm1vZGVPcHRpb24gPSB2YWw7XG4gICAgbG9hZE1vZGUoY20pO1xuICB9LCB0cnVlKTtcblxuICBvcHRpb24oXCJpbmRlbnRVbml0XCIsIDIsIGxvYWRNb2RlLCB0cnVlKTtcbiAgb3B0aW9uKFwiaW5kZW50V2l0aFRhYnNcIiwgZmFsc2UpO1xuICBvcHRpb24oXCJzbWFydEluZGVudFwiLCB0cnVlKTtcbiAgb3B0aW9uKFwidGFiU2l6ZVwiLCA0LCBmdW5jdGlvbihjbSkge1xuICAgIHJlc2V0TW9kZVN0YXRlKGNtKTtcbiAgICBjbGVhckNhY2hlcyhjbSk7XG4gICAgcmVnQ2hhbmdlKGNtKTtcbiAgfSwgdHJ1ZSk7XG4gIG9wdGlvbihcImxpbmVTZXBhcmF0b3JcIiwgbnVsbCwgZnVuY3Rpb24oY20sIHZhbCkge1xuICAgIGNtLmRvYy5saW5lU2VwID0gdmFsO1xuICAgIGlmICghdmFsKSByZXR1cm47XG4gICAgdmFyIG5ld0JyZWFrcyA9IFtdLCBsaW5lTm8gPSBjbS5kb2MuZmlyc3Q7XG4gICAgY20uZG9jLml0ZXIoZnVuY3Rpb24obGluZSkge1xuICAgICAgZm9yICh2YXIgcG9zID0gMDs7KSB7XG4gICAgICAgIHZhciBmb3VuZCA9IGxpbmUudGV4dC5pbmRleE9mKHZhbCwgcG9zKTtcbiAgICAgICAgaWYgKGZvdW5kID09IC0xKSBicmVhaztcbiAgICAgICAgcG9zID0gZm91bmQgKyB2YWwubGVuZ3RoO1xuICAgICAgICBuZXdCcmVha3MucHVzaChQb3MobGluZU5vLCBmb3VuZCkpO1xuICAgICAgfVxuICAgICAgbGluZU5vKys7XG4gICAgfSk7XG4gICAgZm9yICh2YXIgaSA9IG5ld0JyZWFrcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSlcbiAgICAgIHJlcGxhY2VSYW5nZShjbS5kb2MsIHZhbCwgbmV3QnJlYWtzW2ldLCBQb3MobmV3QnJlYWtzW2ldLmxpbmUsIG5ld0JyZWFrc1tpXS5jaCArIHZhbC5sZW5ndGgpKVxuICB9KTtcbiAgb3B0aW9uKFwic3BlY2lhbENoYXJzXCIsIC9bXFx0XFx1MDAwMC1cXHUwMDE5XFx1MDBhZFxcdTIwMGItXFx1MjAwZlxcdTIwMjhcXHUyMDI5XFx1ZmVmZl0vZywgZnVuY3Rpb24oY20sIHZhbCwgb2xkKSB7XG4gICAgY20uc3RhdGUuc3BlY2lhbENoYXJzID0gbmV3IFJlZ0V4cCh2YWwuc291cmNlICsgKHZhbC50ZXN0KFwiXFx0XCIpID8gXCJcIiA6IFwifFxcdFwiKSwgXCJnXCIpO1xuICAgIGlmIChvbGQgIT0gQ29kZU1pcnJvci5Jbml0KSBjbS5yZWZyZXNoKCk7XG4gIH0pO1xuICBvcHRpb24oXCJzcGVjaWFsQ2hhclBsYWNlaG9sZGVyXCIsIGRlZmF1bHRTcGVjaWFsQ2hhclBsYWNlaG9sZGVyLCBmdW5jdGlvbihjbSkge2NtLnJlZnJlc2goKTt9LCB0cnVlKTtcbiAgb3B0aW9uKFwiZWxlY3RyaWNDaGFyc1wiLCB0cnVlKTtcbiAgb3B0aW9uKFwiaW5wdXRTdHlsZVwiLCBtb2JpbGUgPyBcImNvbnRlbnRlZGl0YWJsZVwiIDogXCJ0ZXh0YXJlYVwiLCBmdW5jdGlvbigpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnB1dFN0eWxlIGNhbiBub3QgKHlldCkgYmUgY2hhbmdlZCBpbiBhIHJ1bm5pbmcgZWRpdG9yXCIpOyAvLyBGSVhNRVxuICB9LCB0cnVlKTtcbiAgb3B0aW9uKFwicnRsTW92ZVZpc3VhbGx5XCIsICF3aW5kb3dzKTtcbiAgb3B0aW9uKFwid2hvbGVMaW5lVXBkYXRlQmVmb3JlXCIsIHRydWUpO1xuXG4gIG9wdGlvbihcInRoZW1lXCIsIFwiZGVmYXVsdFwiLCBmdW5jdGlvbihjbSkge1xuICAgIHRoZW1lQ2hhbmdlZChjbSk7XG4gICAgZ3V0dGVyc0NoYW5nZWQoY20pO1xuICB9LCB0cnVlKTtcbiAgb3B0aW9uKFwia2V5TWFwXCIsIFwiZGVmYXVsdFwiLCBmdW5jdGlvbihjbSwgdmFsLCBvbGQpIHtcbiAgICB2YXIgbmV4dCA9IGdldEtleU1hcCh2YWwpO1xuICAgIHZhciBwcmV2ID0gb2xkICE9IENvZGVNaXJyb3IuSW5pdCAmJiBnZXRLZXlNYXAob2xkKTtcbiAgICBpZiAocHJldiAmJiBwcmV2LmRldGFjaCkgcHJldi5kZXRhY2goY20sIG5leHQpO1xuICAgIGlmIChuZXh0LmF0dGFjaCkgbmV4dC5hdHRhY2goY20sIHByZXYgfHwgbnVsbCk7XG4gIH0pO1xuICBvcHRpb24oXCJleHRyYUtleXNcIiwgbnVsbCk7XG5cbiAgb3B0aW9uKFwibGluZVdyYXBwaW5nXCIsIGZhbHNlLCB3cmFwcGluZ0NoYW5nZWQsIHRydWUpO1xuICBvcHRpb24oXCJndXR0ZXJzXCIsIFtdLCBmdW5jdGlvbihjbSkge1xuICAgIHNldEd1dHRlcnNGb3JMaW5lTnVtYmVycyhjbS5vcHRpb25zKTtcbiAgICBndXR0ZXJzQ2hhbmdlZChjbSk7XG4gIH0sIHRydWUpO1xuICBvcHRpb24oXCJmaXhlZEd1dHRlclwiLCB0cnVlLCBmdW5jdGlvbihjbSwgdmFsKSB7XG4gICAgY20uZGlzcGxheS5ndXR0ZXJzLnN0eWxlLmxlZnQgPSB2YWwgPyBjb21wZW5zYXRlRm9ySFNjcm9sbChjbS5kaXNwbGF5KSArIFwicHhcIiA6IFwiMFwiO1xuICAgIGNtLnJlZnJlc2goKTtcbiAgfSwgdHJ1ZSk7XG4gIG9wdGlvbihcImNvdmVyR3V0dGVyTmV4dFRvU2Nyb2xsYmFyXCIsIGZhbHNlLCBmdW5jdGlvbihjbSkge3VwZGF0ZVNjcm9sbGJhcnMoY20pO30sIHRydWUpO1xuICBvcHRpb24oXCJzY3JvbGxiYXJTdHlsZVwiLCBcIm5hdGl2ZVwiLCBmdW5jdGlvbihjbSkge1xuICAgIGluaXRTY3JvbGxiYXJzKGNtKTtcbiAgICB1cGRhdGVTY3JvbGxiYXJzKGNtKTtcbiAgICBjbS5kaXNwbGF5LnNjcm9sbGJhcnMuc2V0U2Nyb2xsVG9wKGNtLmRvYy5zY3JvbGxUb3ApO1xuICAgIGNtLmRpc3BsYXkuc2Nyb2xsYmFycy5zZXRTY3JvbGxMZWZ0KGNtLmRvYy5zY3JvbGxMZWZ0KTtcbiAgfSwgdHJ1ZSk7XG4gIG9wdGlvbihcImxpbmVOdW1iZXJzXCIsIGZhbHNlLCBmdW5jdGlvbihjbSkge1xuICAgIHNldEd1dHRlcnNGb3JMaW5lTnVtYmVycyhjbS5vcHRpb25zKTtcbiAgICBndXR0ZXJzQ2hhbmdlZChjbSk7XG4gIH0sIHRydWUpO1xuICBvcHRpb24oXCJmaXJzdExpbmVOdW1iZXJcIiwgMSwgZ3V0dGVyc0NoYW5nZWQsIHRydWUpO1xuICBvcHRpb24oXCJsaW5lTnVtYmVyRm9ybWF0dGVyXCIsIGZ1bmN0aW9uKGludGVnZXIpIHtyZXR1cm4gaW50ZWdlcjt9LCBndXR0ZXJzQ2hhbmdlZCwgdHJ1ZSk7XG4gIG9wdGlvbihcInNob3dDdXJzb3JXaGVuU2VsZWN0aW5nXCIsIGZhbHNlLCB1cGRhdGVTZWxlY3Rpb24sIHRydWUpO1xuXG4gIG9wdGlvbihcInJlc2V0U2VsZWN0aW9uT25Db250ZXh0TWVudVwiLCB0cnVlKTtcbiAgb3B0aW9uKFwibGluZVdpc2VDb3B5Q3V0XCIsIHRydWUpO1xuXG4gIG9wdGlvbihcInJlYWRPbmx5XCIsIGZhbHNlLCBmdW5jdGlvbihjbSwgdmFsKSB7XG4gICAgaWYgKHZhbCA9PSBcIm5vY3Vyc29yXCIpIHtcbiAgICAgIG9uQmx1cihjbSk7XG4gICAgICBjbS5kaXNwbGF5LmlucHV0LmJsdXIoKTtcbiAgICAgIGNtLmRpc3BsYXkuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjbS5kaXNwbGF5LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICAgIGNtLmRpc3BsYXkuaW5wdXQucmVhZE9ubHlDaGFuZ2VkKHZhbClcbiAgfSk7XG4gIG9wdGlvbihcImRpc2FibGVJbnB1dFwiLCBmYWxzZSwgZnVuY3Rpb24oY20sIHZhbCkge2lmICghdmFsKSBjbS5kaXNwbGF5LmlucHV0LnJlc2V0KCk7fSwgdHJ1ZSk7XG4gIG9wdGlvbihcImRyYWdEcm9wXCIsIHRydWUsIGRyYWdEcm9wQ2hhbmdlZCk7XG4gIG9wdGlvbihcImFsbG93RHJvcEZpbGVUeXBlc1wiLCBudWxsKTtcblxuICBvcHRpb24oXCJjdXJzb3JCbGlua1JhdGVcIiwgNTMwKTtcbiAgb3B0aW9uKFwiY3Vyc29yU2Nyb2xsTWFyZ2luXCIsIDApO1xuICBvcHRpb24oXCJjdXJzb3JIZWlnaHRcIiwgMSwgdXBkYXRlU2VsZWN0aW9uLCB0cnVlKTtcbiAgb3B0aW9uKFwic2luZ2xlQ3Vyc29ySGVpZ2h0UGVyTGluZVwiLCB0cnVlLCB1cGRhdGVTZWxlY3Rpb24sIHRydWUpO1xuICBvcHRpb24oXCJ3b3JrVGltZVwiLCAxMDApO1xuICBvcHRpb24oXCJ3b3JrRGVsYXlcIiwgMTAwKTtcbiAgb3B0aW9uKFwiZmxhdHRlblNwYW5zXCIsIHRydWUsIHJlc2V0TW9kZVN0YXRlLCB0cnVlKTtcbiAgb3B0aW9uKFwiYWRkTW9kZUNsYXNzXCIsIGZhbHNlLCByZXNldE1vZGVTdGF0ZSwgdHJ1ZSk7XG4gIG9wdGlvbihcInBvbGxJbnRlcnZhbFwiLCAxMDApO1xuICBvcHRpb24oXCJ1bmRvRGVwdGhcIiwgMjAwLCBmdW5jdGlvbihjbSwgdmFsKXtjbS5kb2MuaGlzdG9yeS51bmRvRGVwdGggPSB2YWw7fSk7XG4gIG9wdGlvbihcImhpc3RvcnlFdmVudERlbGF5XCIsIDEyNTApO1xuICBvcHRpb24oXCJ2aWV3cG9ydE1hcmdpblwiLCAxMCwgZnVuY3Rpb24oY20pe2NtLnJlZnJlc2goKTt9LCB0cnVlKTtcbiAgb3B0aW9uKFwibWF4SGlnaGxpZ2h0TGVuZ3RoXCIsIDEwMDAwLCByZXNldE1vZGVTdGF0ZSwgdHJ1ZSk7XG4gIG9wdGlvbihcIm1vdmVJbnB1dFdpdGhDdXJzb3JcIiwgdHJ1ZSwgZnVuY3Rpb24oY20sIHZhbCkge1xuICAgIGlmICghdmFsKSBjbS5kaXNwbGF5LmlucHV0LnJlc2V0UG9zaXRpb24oKTtcbiAgfSk7XG5cbiAgb3B0aW9uKFwidGFiaW5kZXhcIiwgbnVsbCwgZnVuY3Rpb24oY20sIHZhbCkge1xuICAgIGNtLmRpc3BsYXkuaW5wdXQuZ2V0RmllbGQoKS50YWJJbmRleCA9IHZhbCB8fCBcIlwiO1xuICB9KTtcbiAgb3B0aW9uKFwiYXV0b2ZvY3VzXCIsIG51bGwpO1xuXG4gIC8vIE1PREUgREVGSU5JVElPTiBBTkQgUVVFUllJTkdcblxuICAvLyBLbm93biBtb2RlcywgYnkgbmFtZSBhbmQgYnkgTUlNRVxuICB2YXIgbW9kZXMgPSBDb2RlTWlycm9yLm1vZGVzID0ge30sIG1pbWVNb2RlcyA9IENvZGVNaXJyb3IubWltZU1vZGVzID0ge307XG5cbiAgLy8gRXh0cmEgYXJndW1lbnRzIGFyZSBzdG9yZWQgYXMgdGhlIG1vZGUncyBkZXBlbmRlbmNpZXMsIHdoaWNoIGlzXG4gIC8vIHVzZWQgYnkgKGxlZ2FjeSkgbWVjaGFuaXNtcyBsaWtlIGxvYWRtb2RlLmpzIHRvIGF1dG9tYXRpY2FsbHlcbiAgLy8gbG9hZCBhIG1vZGUuIChQcmVmZXJyZWQgbWVjaGFuaXNtIGlzIHRoZSByZXF1aXJlL2RlZmluZSBjYWxscy4pXG4gIENvZGVNaXJyb3IuZGVmaW5lTW9kZSA9IGZ1bmN0aW9uKG5hbWUsIG1vZGUpIHtcbiAgICBpZiAoIUNvZGVNaXJyb3IuZGVmYXVsdHMubW9kZSAmJiBuYW1lICE9IFwibnVsbFwiKSBDb2RlTWlycm9yLmRlZmF1bHRzLm1vZGUgPSBuYW1lO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMilcbiAgICAgIG1vZGUuZGVwZW5kZW5jaWVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICBtb2Rlc1tuYW1lXSA9IG1vZGU7XG4gIH07XG5cbiAgQ29kZU1pcnJvci5kZWZpbmVNSU1FID0gZnVuY3Rpb24obWltZSwgc3BlYykge1xuICAgIG1pbWVNb2Rlc1ttaW1lXSA9IHNwZWM7XG4gIH07XG5cbiAgLy8gR2l2ZW4gYSBNSU1FIHR5cGUsIGEge25hbWUsIC4uLm9wdGlvbnN9IGNvbmZpZyBvYmplY3QsIG9yIGEgbmFtZVxuICAvLyBzdHJpbmcsIHJldHVybiBhIG1vZGUgY29uZmlnIG9iamVjdC5cbiAgQ29kZU1pcnJvci5yZXNvbHZlTW9kZSA9IGZ1bmN0aW9uKHNwZWMpIHtcbiAgICBpZiAodHlwZW9mIHNwZWMgPT0gXCJzdHJpbmdcIiAmJiBtaW1lTW9kZXMuaGFzT3duUHJvcGVydHkoc3BlYykpIHtcbiAgICAgIHNwZWMgPSBtaW1lTW9kZXNbc3BlY107XG4gICAgfSBlbHNlIGlmIChzcGVjICYmIHR5cGVvZiBzcGVjLm5hbWUgPT0gXCJzdHJpbmdcIiAmJiBtaW1lTW9kZXMuaGFzT3duUHJvcGVydHkoc3BlYy5uYW1lKSkge1xuICAgICAgdmFyIGZvdW5kID0gbWltZU1vZGVzW3NwZWMubmFtZV07XG4gICAgICBpZiAodHlwZW9mIGZvdW5kID09IFwic3RyaW5nXCIpIGZvdW5kID0ge25hbWU6IGZvdW5kfTtcbiAgICAgIHNwZWMgPSBjcmVhdGVPYmooZm91bmQsIHNwZWMpO1xuICAgICAgc3BlYy5uYW1lID0gZm91bmQubmFtZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBzcGVjID09IFwic3RyaW5nXCIgJiYgL15bXFx3XFwtXStcXC9bXFx3XFwtXStcXCt4bWwkLy50ZXN0KHNwZWMpKSB7XG4gICAgICByZXR1cm4gQ29kZU1pcnJvci5yZXNvbHZlTW9kZShcImFwcGxpY2F0aW9uL3htbFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBzcGVjID09IFwic3RyaW5nXCIpIHJldHVybiB7bmFtZTogc3BlY307XG4gICAgZWxzZSByZXR1cm4gc3BlYyB8fCB7bmFtZTogXCJudWxsXCJ9O1xuICB9O1xuXG4gIC8vIEdpdmVuIGEgbW9kZSBzcGVjIChhbnl0aGluZyB0aGF0IHJlc29sdmVNb2RlIGFjY2VwdHMpLCBmaW5kIGFuZFxuICAvLyBpbml0aWFsaXplIGFuIGFjdHVhbCBtb2RlIG9iamVjdC5cbiAgQ29kZU1pcnJvci5nZXRNb2RlID0gZnVuY3Rpb24ob3B0aW9ucywgc3BlYykge1xuICAgIHZhciBzcGVjID0gQ29kZU1pcnJvci5yZXNvbHZlTW9kZShzcGVjKTtcbiAgICB2YXIgbWZhY3RvcnkgPSBtb2Rlc1tzcGVjLm5hbWVdO1xuICAgIGlmICghbWZhY3RvcnkpIHJldHVybiBDb2RlTWlycm9yLmdldE1vZGUob3B0aW9ucywgXCJ0ZXh0L3BsYWluXCIpO1xuICAgIHZhciBtb2RlT2JqID0gbWZhY3Rvcnkob3B0aW9ucywgc3BlYyk7XG4gICAgaWYgKG1vZGVFeHRlbnNpb25zLmhhc093blByb3BlcnR5KHNwZWMubmFtZSkpIHtcbiAgICAgIHZhciBleHRzID0gbW9kZUV4dGVuc2lvbnNbc3BlYy5uYW1lXTtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gZXh0cykge1xuICAgICAgICBpZiAoIWV4dHMuaGFzT3duUHJvcGVydHkocHJvcCkpIGNvbnRpbnVlO1xuICAgICAgICBpZiAobW9kZU9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgbW9kZU9ialtcIl9cIiArIHByb3BdID0gbW9kZU9ialtwcm9wXTtcbiAgICAgICAgbW9kZU9ialtwcm9wXSA9IGV4dHNbcHJvcF07XG4gICAgICB9XG4gICAgfVxuICAgIG1vZGVPYmoubmFtZSA9IHNwZWMubmFtZTtcbiAgICBpZiAoc3BlYy5oZWxwZXJUeXBlKSBtb2RlT2JqLmhlbHBlclR5cGUgPSBzcGVjLmhlbHBlclR5cGU7XG4gICAgaWYgKHNwZWMubW9kZVByb3BzKSBmb3IgKHZhciBwcm9wIGluIHNwZWMubW9kZVByb3BzKVxuICAgICAgbW9kZU9ialtwcm9wXSA9IHNwZWMubW9kZVByb3BzW3Byb3BdO1xuXG4gICAgcmV0dXJuIG1vZGVPYmo7XG4gIH07XG5cbiAgLy8gTWluaW1hbCBkZWZhdWx0IG1vZGUuXG4gIENvZGVNaXJyb3IuZGVmaW5lTW9kZShcIm51bGxcIiwgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHt0b2tlbjogZnVuY3Rpb24oc3RyZWFtKSB7c3RyZWFtLnNraXBUb0VuZCgpO319O1xuICB9KTtcbiAgQ29kZU1pcnJvci5kZWZpbmVNSU1FKFwidGV4dC9wbGFpblwiLCBcIm51bGxcIik7XG5cbiAgLy8gVGhpcyBjYW4gYmUgdXNlZCB0byBhdHRhY2ggcHJvcGVydGllcyB0byBtb2RlIG9iamVjdHMgZnJvbVxuICAvLyBvdXRzaWRlIHRoZSBhY3R1YWwgbW9kZSBkZWZpbml0aW9uLlxuICB2YXIgbW9kZUV4dGVuc2lvbnMgPSBDb2RlTWlycm9yLm1vZGVFeHRlbnNpb25zID0ge307XG4gIENvZGVNaXJyb3IuZXh0ZW5kTW9kZSA9IGZ1bmN0aW9uKG1vZGUsIHByb3BlcnRpZXMpIHtcbiAgICB2YXIgZXh0cyA9IG1vZGVFeHRlbnNpb25zLmhhc093blByb3BlcnR5KG1vZGUpID8gbW9kZUV4dGVuc2lvbnNbbW9kZV0gOiAobW9kZUV4dGVuc2lvbnNbbW9kZV0gPSB7fSk7XG4gICAgY29weU9iaihwcm9wZXJ0aWVzLCBleHRzKTtcbiAgfTtcblxuICAvLyBFWFRFTlNJT05TXG5cbiAgQ29kZU1pcnJvci5kZWZpbmVFeHRlbnNpb24gPSBmdW5jdGlvbihuYW1lLCBmdW5jKSB7XG4gICAgQ29kZU1pcnJvci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jO1xuICB9O1xuICBDb2RlTWlycm9yLmRlZmluZURvY0V4dGVuc2lvbiA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHtcbiAgICBEb2MucHJvdG90eXBlW25hbWVdID0gZnVuYztcbiAgfTtcbiAgQ29kZU1pcnJvci5kZWZpbmVPcHRpb24gPSBvcHRpb247XG5cbiAgdmFyIGluaXRIb29rcyA9IFtdO1xuICBDb2RlTWlycm9yLmRlZmluZUluaXRIb29rID0gZnVuY3Rpb24oZikge2luaXRIb29rcy5wdXNoKGYpO307XG5cbiAgdmFyIGhlbHBlcnMgPSBDb2RlTWlycm9yLmhlbHBlcnMgPSB7fTtcbiAgQ29kZU1pcnJvci5yZWdpc3RlckhlbHBlciA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHZhbHVlKSB7XG4gICAgaWYgKCFoZWxwZXJzLmhhc093blByb3BlcnR5KHR5cGUpKSBoZWxwZXJzW3R5cGVdID0gQ29kZU1pcnJvclt0eXBlXSA9IHtfZ2xvYmFsOiBbXX07XG4gICAgaGVscGVyc1t0eXBlXVtuYW1lXSA9IHZhbHVlO1xuICB9O1xuICBDb2RlTWlycm9yLnJlZ2lzdGVyR2xvYmFsSGVscGVyID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgcHJlZGljYXRlLCB2YWx1ZSkge1xuICAgIENvZGVNaXJyb3IucmVnaXN0ZXJIZWxwZXIodHlwZSwgbmFtZSwgdmFsdWUpO1xuICAgIGhlbHBlcnNbdHlwZV0uX2dsb2JhbC5wdXNoKHtwcmVkOiBwcmVkaWNhdGUsIHZhbDogdmFsdWV9KTtcbiAgfTtcblxuICAvLyBNT0RFIFNUQVRFIEhBTkRMSU5HXG5cbiAgLy8gVXRpbGl0eSBmdW5jdGlvbnMgZm9yIHdvcmtpbmcgd2l0aCBzdGF0ZS4gRXhwb3J0ZWQgYmVjYXVzZSBuZXN0ZWRcbiAgLy8gbW9kZXMgbmVlZCB0byBkbyB0aGlzIGZvciB0aGVpciBpbm5lciBtb2Rlcy5cblxuICB2YXIgY29weVN0YXRlID0gQ29kZU1pcnJvci5jb3B5U3RhdGUgPSBmdW5jdGlvbihtb2RlLCBzdGF0ZSkge1xuICAgIGlmIChzdGF0ZSA9PT0gdHJ1ZSkgcmV0dXJuIHN0YXRlO1xuICAgIGlmIChtb2RlLmNvcHlTdGF0ZSkgcmV0dXJuIG1vZGUuY29weVN0YXRlKHN0YXRlKTtcbiAgICB2YXIgbnN0YXRlID0ge307XG4gICAgZm9yICh2YXIgbiBpbiBzdGF0ZSkge1xuICAgICAgdmFyIHZhbCA9IHN0YXRlW25dO1xuICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIEFycmF5KSB2YWwgPSB2YWwuY29uY2F0KFtdKTtcbiAgICAgIG5zdGF0ZVtuXSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIG5zdGF0ZTtcbiAgfTtcblxuICB2YXIgc3RhcnRTdGF0ZSA9IENvZGVNaXJyb3Iuc3RhcnRTdGF0ZSA9IGZ1bmN0aW9uKG1vZGUsIGExLCBhMikge1xuICAgIHJldHVybiBtb2RlLnN0YXJ0U3RhdGUgPyBtb2RlLnN0YXJ0U3RhdGUoYTEsIGEyKSA6IHRydWU7XG4gIH07XG5cbiAgLy8gR2l2ZW4gYSBtb2RlIGFuZCBhIHN0YXRlIChmb3IgdGhhdCBtb2RlKSwgZmluZCB0aGUgaW5uZXIgbW9kZSBhbmRcbiAgLy8gc3RhdGUgYXQgdGhlIHBvc2l0aW9uIHRoYXQgdGhlIHN0YXRlIHJlZmVycyB0by5cbiAgQ29kZU1pcnJvci5pbm5lck1vZGUgPSBmdW5jdGlvbihtb2RlLCBzdGF0ZSkge1xuICAgIHdoaWxlIChtb2RlLmlubmVyTW9kZSkge1xuICAgICAgdmFyIGluZm8gPSBtb2RlLmlubmVyTW9kZShzdGF0ZSk7XG4gICAgICBpZiAoIWluZm8gfHwgaW5mby5tb2RlID09IG1vZGUpIGJyZWFrO1xuICAgICAgc3RhdGUgPSBpbmZvLnN0YXRlO1xuICAgICAgbW9kZSA9IGluZm8ubW9kZTtcbiAgICB9XG4gICAgcmV0dXJuIGluZm8gfHwge21vZGU6IG1vZGUsIHN0YXRlOiBzdGF0ZX07XG4gIH07XG5cbiAgLy8gU1RBTkRBUkQgQ09NTUFORFNcblxuICAvLyBDb21tYW5kcyBhcmUgcGFyYW1ldGVyLWxlc3MgYWN0aW9ucyB0aGF0IGNhbiBiZSBwZXJmb3JtZWQgb24gYW5cbiAgLy8gZWRpdG9yLCBtb3N0bHkgdXNlZCBmb3Iga2V5YmluZGluZ3MuXG4gIHZhciBjb21tYW5kcyA9IENvZGVNaXJyb3IuY29tbWFuZHMgPSB7XG4gICAgc2VsZWN0QWxsOiBmdW5jdGlvbihjbSkge2NtLnNldFNlbGVjdGlvbihQb3MoY20uZmlyc3RMaW5lKCksIDApLCBQb3MoY20ubGFzdExpbmUoKSksIHNlbF9kb250U2Nyb2xsKTt9LFxuICAgIHNpbmdsZVNlbGVjdGlvbjogZnVuY3Rpb24oY20pIHtcbiAgICAgIGNtLnNldFNlbGVjdGlvbihjbS5nZXRDdXJzb3IoXCJhbmNob3JcIiksIGNtLmdldEN1cnNvcihcImhlYWRcIiksIHNlbF9kb250U2Nyb2xsKTtcbiAgICB9LFxuICAgIGtpbGxMaW5lOiBmdW5jdGlvbihjbSkge1xuICAgICAgZGVsZXRlTmVhclNlbGVjdGlvbihjbSwgZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgaWYgKHJhbmdlLmVtcHR5KCkpIHtcbiAgICAgICAgICB2YXIgbGVuID0gZ2V0TGluZShjbS5kb2MsIHJhbmdlLmhlYWQubGluZSkudGV4dC5sZW5ndGg7XG4gICAgICAgICAgaWYgKHJhbmdlLmhlYWQuY2ggPT0gbGVuICYmIHJhbmdlLmhlYWQubGluZSA8IGNtLmxhc3RMaW5lKCkpXG4gICAgICAgICAgICByZXR1cm4ge2Zyb206IHJhbmdlLmhlYWQsIHRvOiBQb3MocmFuZ2UuaGVhZC5saW5lICsgMSwgMCl9O1xuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiB7ZnJvbTogcmFuZ2UuaGVhZCwgdG86IFBvcyhyYW5nZS5oZWFkLmxpbmUsIGxlbil9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7ZnJvbTogcmFuZ2UuZnJvbSgpLCB0bzogcmFuZ2UudG8oKX07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlTGluZTogZnVuY3Rpb24oY20pIHtcbiAgICAgIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgIHJldHVybiB7ZnJvbTogUG9zKHJhbmdlLmZyb20oKS5saW5lLCAwKSxcbiAgICAgICAgICAgICAgICB0bzogY2xpcFBvcyhjbS5kb2MsIFBvcyhyYW5nZS50bygpLmxpbmUgKyAxLCAwKSl9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxMaW5lTGVmdDogZnVuY3Rpb24oY20pIHtcbiAgICAgIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgIHJldHVybiB7ZnJvbTogUG9zKHJhbmdlLmZyb20oKS5saW5lLCAwKSwgdG86IHJhbmdlLmZyb20oKX07XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbFdyYXBwZWRMaW5lTGVmdDogZnVuY3Rpb24oY20pIHtcbiAgICAgIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgIHZhciB0b3AgPSBjbS5jaGFyQ29vcmRzKHJhbmdlLmhlYWQsIFwiZGl2XCIpLnRvcCArIDU7XG4gICAgICAgIHZhciBsZWZ0UG9zID0gY20uY29vcmRzQ2hhcih7bGVmdDogMCwgdG9wOiB0b3B9LCBcImRpdlwiKTtcbiAgICAgICAgcmV0dXJuIHtmcm9tOiBsZWZ0UG9zLCB0bzogcmFuZ2UuZnJvbSgpfTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsV3JhcHBlZExpbmVSaWdodDogZnVuY3Rpb24oY20pIHtcbiAgICAgIGRlbGV0ZU5lYXJTZWxlY3Rpb24oY20sIGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICAgIHZhciB0b3AgPSBjbS5jaGFyQ29vcmRzKHJhbmdlLmhlYWQsIFwiZGl2XCIpLnRvcCArIDU7XG4gICAgICAgIHZhciByaWdodFBvcyA9IGNtLmNvb3Jkc0NoYXIoe2xlZnQ6IGNtLmRpc3BsYXkubGluZURpdi5vZmZzZXRXaWR0aCArIDEwMCwgdG9wOiB0b3B9LCBcImRpdlwiKTtcbiAgICAgICAgcmV0dXJuIHtmcm9tOiByYW5nZS5mcm9tKCksIHRvOiByaWdodFBvcyB9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB1bmRvOiBmdW5jdGlvbihjbSkge2NtLnVuZG8oKTt9LFxuICAgIHJlZG86IGZ1bmN0aW9uKGNtKSB7Y20ucmVkbygpO30sXG4gICAgdW5kb1NlbGVjdGlvbjogZnVuY3Rpb24oY20pIHtjbS51bmRvU2VsZWN0aW9uKCk7fSxcbiAgICByZWRvU2VsZWN0aW9uOiBmdW5jdGlvbihjbSkge2NtLnJlZG9TZWxlY3Rpb24oKTt9LFxuICAgIGdvRG9jU3RhcnQ6IGZ1bmN0aW9uKGNtKSB7Y20uZXh0ZW5kU2VsZWN0aW9uKFBvcyhjbS5maXJzdExpbmUoKSwgMCkpO30sXG4gICAgZ29Eb2NFbmQ6IGZ1bmN0aW9uKGNtKSB7Y20uZXh0ZW5kU2VsZWN0aW9uKFBvcyhjbS5sYXN0TGluZSgpKSk7fSxcbiAgICBnb0xpbmVTdGFydDogZnVuY3Rpb24oY20pIHtcbiAgICAgIGNtLmV4dGVuZFNlbGVjdGlvbnNCeShmdW5jdGlvbihyYW5nZSkgeyByZXR1cm4gbGluZVN0YXJ0KGNtLCByYW5nZS5oZWFkLmxpbmUpOyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtvcmlnaW46IFwiK21vdmVcIiwgYmlhczogMX0pO1xuICAgIH0sXG4gICAgZ29MaW5lU3RhcnRTbWFydDogZnVuY3Rpb24oY20pIHtcbiAgICAgIGNtLmV4dGVuZFNlbGVjdGlvbnNCeShmdW5jdGlvbihyYW5nZSkge1xuICAgICAgICByZXR1cm4gbGluZVN0YXJ0U21hcnQoY20sIHJhbmdlLmhlYWQpO1xuICAgICAgfSwge29yaWdpbjogXCIrbW92ZVwiLCBiaWFzOiAxfSk7XG4gICAgfSxcbiAgICBnb0xpbmVFbmQ6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2UpIHsgcmV0dXJuIGxpbmVFbmQoY20sIHJhbmdlLmhlYWQubGluZSk7IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge29yaWdpbjogXCIrbW92ZVwiLCBiaWFzOiAtMX0pO1xuICAgIH0sXG4gICAgZ29MaW5lUmlnaHQ6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgdmFyIHRvcCA9IGNtLmNoYXJDb29yZHMocmFuZ2UuaGVhZCwgXCJkaXZcIikudG9wICsgNTtcbiAgICAgICAgcmV0dXJuIGNtLmNvb3Jkc0NoYXIoe2xlZnQ6IGNtLmRpc3BsYXkubGluZURpdi5vZmZzZXRXaWR0aCArIDEwMCwgdG9wOiB0b3B9LCBcImRpdlwiKTtcbiAgICAgIH0sIHNlbF9tb3ZlKTtcbiAgICB9LFxuICAgIGdvTGluZUxlZnQ6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgdmFyIHRvcCA9IGNtLmNoYXJDb29yZHMocmFuZ2UuaGVhZCwgXCJkaXZcIikudG9wICsgNTtcbiAgICAgICAgcmV0dXJuIGNtLmNvb3Jkc0NoYXIoe2xlZnQ6IDAsIHRvcDogdG9wfSwgXCJkaXZcIik7XG4gICAgICB9LCBzZWxfbW92ZSk7XG4gICAgfSxcbiAgICBnb0xpbmVMZWZ0U21hcnQ6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBjbS5leHRlbmRTZWxlY3Rpb25zQnkoZnVuY3Rpb24ocmFuZ2UpIHtcbiAgICAgICAgdmFyIHRvcCA9IGNtLmNoYXJDb29yZHMocmFuZ2UuaGVhZCwgXCJkaXZcIikudG9wICsgNTtcbiAgICAgICAgdmFyIHBvcyA9IGNtLmNvb3Jkc0NoYXIoe2xlZnQ6IDAsIHRvcDogdG9wfSwgXCJkaXZcIik7XG4gICAgICAgIGlmIChwb3MuY2ggPCBjbS5nZXRMaW5lKHBvcy5saW5lKS5zZWFyY2goL1xcUy8pKSByZXR1cm4gbGluZVN0YXJ0U21hcnQoY20sIHJhbmdlLmhlYWQpO1xuICAgICAgICByZXR1cm4gcG9zO1xuICAgICAgfSwgc2VsX21vdmUpO1xuICAgIH0sXG4gICAgZ29MaW5lVXA6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZVYoLTEsIFwibGluZVwiKTt9LFxuICAgIGdvTGluZURvd246IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZVYoMSwgXCJsaW5lXCIpO30sXG4gICAgZ29QYWdlVXA6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZVYoLTEsIFwicGFnZVwiKTt9LFxuICAgIGdvUGFnZURvd246IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZVYoMSwgXCJwYWdlXCIpO30sXG4gICAgZ29DaGFyTGVmdDogZnVuY3Rpb24oY20pIHtjbS5tb3ZlSCgtMSwgXCJjaGFyXCIpO30sXG4gICAgZ29DaGFyUmlnaHQ6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZUgoMSwgXCJjaGFyXCIpO30sXG4gICAgZ29Db2x1bW5MZWZ0OiBmdW5jdGlvbihjbSkge2NtLm1vdmVIKC0xLCBcImNvbHVtblwiKTt9LFxuICAgIGdvQ29sdW1uUmlnaHQ6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZUgoMSwgXCJjb2x1bW5cIik7fSxcbiAgICBnb1dvcmRMZWZ0OiBmdW5jdGlvbihjbSkge2NtLm1vdmVIKC0xLCBcIndvcmRcIik7fSxcbiAgICBnb0dyb3VwUmlnaHQ6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZUgoMSwgXCJncm91cFwiKTt9LFxuICAgIGdvR3JvdXBMZWZ0OiBmdW5jdGlvbihjbSkge2NtLm1vdmVIKC0xLCBcImdyb3VwXCIpO30sXG4gICAgZ29Xb3JkUmlnaHQ6IGZ1bmN0aW9uKGNtKSB7Y20ubW92ZUgoMSwgXCJ3b3JkXCIpO30sXG4gICAgZGVsQ2hhckJlZm9yZTogZnVuY3Rpb24oY20pIHtjbS5kZWxldGVIKC0xLCBcImNoYXJcIik7fSxcbiAgICBkZWxDaGFyQWZ0ZXI6IGZ1bmN0aW9uKGNtKSB7Y20uZGVsZXRlSCgxLCBcImNoYXJcIik7fSxcbiAgICBkZWxXb3JkQmVmb3JlOiBmdW5jdGlvbihjbSkge2NtLmRlbGV0ZUgoLTEsIFwid29yZFwiKTt9LFxuICAgIGRlbFdvcmRBZnRlcjogZnVuY3Rpb24oY20pIHtjbS5kZWxldGVIKDEsIFwid29yZFwiKTt9LFxuICAgIGRlbEdyb3VwQmVmb3JlOiBmdW5jdGlvbihjbSkge2NtLmRlbGV0ZUgoLTEsIFwiZ3JvdXBcIik7fSxcbiAgICBkZWxHcm91cEFmdGVyOiBmdW5jdGlvbihjbSkge2NtLmRlbGV0ZUgoMSwgXCJncm91cFwiKTt9LFxuICAgIGluZGVudEF1dG86IGZ1bmN0aW9uKGNtKSB7Y20uaW5kZW50U2VsZWN0aW9uKFwic21hcnRcIik7fSxcbiAgICBpbmRlbnRNb3JlOiBmdW5jdGlvbihjbSkge2NtLmluZGVudFNlbGVjdGlvbihcImFkZFwiKTt9LFxuICAgIGluZGVudExlc3M6IGZ1bmN0aW9uKGNtKSB7Y20uaW5kZW50U2VsZWN0aW9uKFwic3VidHJhY3RcIik7fSxcbiAgICBpbnNlcnRUYWI6IGZ1bmN0aW9uKGNtKSB7Y20ucmVwbGFjZVNlbGVjdGlvbihcIlxcdFwiKTt9LFxuICAgIGluc2VydFNvZnRUYWI6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICB2YXIgc3BhY2VzID0gW10sIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCksIHRhYlNpemUgPSBjbS5vcHRpb25zLnRhYlNpemU7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcG9zID0gcmFuZ2VzW2ldLmZyb20oKTtcbiAgICAgICAgdmFyIGNvbCA9IGNvdW50Q29sdW1uKGNtLmdldExpbmUocG9zLmxpbmUpLCBwb3MuY2gsIHRhYlNpemUpO1xuICAgICAgICBzcGFjZXMucHVzaChuZXcgQXJyYXkodGFiU2l6ZSAtIGNvbCAlIHRhYlNpemUgKyAxKS5qb2luKFwiIFwiKSk7XG4gICAgICB9XG4gICAgICBjbS5yZXBsYWNlU2VsZWN0aW9ucyhzcGFjZXMpO1xuICAgIH0sXG4gICAgZGVmYXVsdFRhYjogZnVuY3Rpb24oY20pIHtcbiAgICAgIGlmIChjbS5zb21ldGhpbmdTZWxlY3RlZCgpKSBjbS5pbmRlbnRTZWxlY3Rpb24oXCJhZGRcIik7XG4gICAgICBlbHNlIGNtLmV4ZWNDb21tYW5kKFwiaW5zZXJ0VGFiXCIpO1xuICAgIH0sXG4gICAgdHJhbnNwb3NlQ2hhcnM6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHJhbmdlcyA9IGNtLmxpc3RTZWxlY3Rpb25zKCksIG5ld1NlbCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBjdXIgPSByYW5nZXNbaV0uaGVhZCwgbGluZSA9IGdldExpbmUoY20uZG9jLCBjdXIubGluZSkudGV4dDtcbiAgICAgICAgICBpZiAobGluZSkge1xuICAgICAgICAgICAgaWYgKGN1ci5jaCA9PSBsaW5lLmxlbmd0aCkgY3VyID0gbmV3IFBvcyhjdXIubGluZSwgY3VyLmNoIC0gMSk7XG4gICAgICAgICAgICBpZiAoY3VyLmNoID4gMCkge1xuICAgICAgICAgICAgICBjdXIgPSBuZXcgUG9zKGN1ci5saW5lLCBjdXIuY2ggKyAxKTtcbiAgICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKGxpbmUuY2hhckF0KGN1ci5jaCAtIDEpICsgbGluZS5jaGFyQXQoY3VyLmNoIC0gMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3MoY3VyLmxpbmUsIGN1ci5jaCAtIDIpLCBjdXIsIFwiK3RyYW5zcG9zZVwiKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VyLmxpbmUgPiBjbS5kb2MuZmlyc3QpIHtcbiAgICAgICAgICAgICAgdmFyIHByZXYgPSBnZXRMaW5lKGNtLmRvYywgY3VyLmxpbmUgLSAxKS50ZXh0O1xuICAgICAgICAgICAgICBpZiAocHJldilcbiAgICAgICAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UobGluZS5jaGFyQXQoMCkgKyBjbS5kb2MubGluZVNlcGFyYXRvcigpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldi5jaGFyQXQocHJldi5sZW5ndGggLSAxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9zKGN1ci5saW5lIC0gMSwgcHJldi5sZW5ndGggLSAxKSwgUG9zKGN1ci5saW5lLCAxKSwgXCIrdHJhbnNwb3NlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBuZXdTZWwucHVzaChuZXcgUmFuZ2UoY3VyLCBjdXIpKTtcbiAgICAgICAgfVxuICAgICAgICBjbS5zZXRTZWxlY3Rpb25zKG5ld1NlbCk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIG5ld2xpbmVBbmRJbmRlbnQ6IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGxlbiA9IGNtLmxpc3RTZWxlY3Rpb25zKCkubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgdmFyIHJhbmdlID0gY20ubGlzdFNlbGVjdGlvbnMoKVtpXTtcbiAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoY20uZG9jLmxpbmVTZXBhcmF0b3IoKSwgcmFuZ2UuYW5jaG9yLCByYW5nZS5oZWFkLCBcIitpbnB1dFwiKTtcbiAgICAgICAgICBjbS5pbmRlbnRMaW5lKHJhbmdlLmZyb20oKS5saW5lICsgMSwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZW5zdXJlQ3Vyc29yVmlzaWJsZShjbSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHRvZ2dsZU92ZXJ3cml0ZTogZnVuY3Rpb24oY20pIHtjbS50b2dnbGVPdmVyd3JpdGUoKTt9XG4gIH07XG5cblxuICAvLyBTVEFOREFSRCBLRVlNQVBTXG5cbiAgdmFyIGtleU1hcCA9IENvZGVNaXJyb3Iua2V5TWFwID0ge307XG5cbiAga2V5TWFwLmJhc2ljID0ge1xuICAgIFwiTGVmdFwiOiBcImdvQ2hhckxlZnRcIiwgXCJSaWdodFwiOiBcImdvQ2hhclJpZ2h0XCIsIFwiVXBcIjogXCJnb0xpbmVVcFwiLCBcIkRvd25cIjogXCJnb0xpbmVEb3duXCIsXG4gICAgXCJFbmRcIjogXCJnb0xpbmVFbmRcIiwgXCJIb21lXCI6IFwiZ29MaW5lU3RhcnRTbWFydFwiLCBcIlBhZ2VVcFwiOiBcImdvUGFnZVVwXCIsIFwiUGFnZURvd25cIjogXCJnb1BhZ2VEb3duXCIsXG4gICAgXCJEZWxldGVcIjogXCJkZWxDaGFyQWZ0ZXJcIiwgXCJCYWNrc3BhY2VcIjogXCJkZWxDaGFyQmVmb3JlXCIsIFwiU2hpZnQtQmFja3NwYWNlXCI6IFwiZGVsQ2hhckJlZm9yZVwiLFxuICAgIFwiVGFiXCI6IFwiZGVmYXVsdFRhYlwiLCBcIlNoaWZ0LVRhYlwiOiBcImluZGVudEF1dG9cIixcbiAgICBcIkVudGVyXCI6IFwibmV3bGluZUFuZEluZGVudFwiLCBcIkluc2VydFwiOiBcInRvZ2dsZU92ZXJ3cml0ZVwiLFxuICAgIFwiRXNjXCI6IFwic2luZ2xlU2VsZWN0aW9uXCJcbiAgfTtcbiAgLy8gTm90ZSB0aGF0IHRoZSBzYXZlIGFuZCBmaW5kLXJlbGF0ZWQgY29tbWFuZHMgYXJlbid0IGRlZmluZWQgYnlcbiAgLy8gZGVmYXVsdC4gVXNlciBjb2RlIG9yIGFkZG9ucyBjYW4gZGVmaW5lIHRoZW0uIFVua25vd24gY29tbWFuZHNcbiAgLy8gYXJlIHNpbXBseSBpZ25vcmVkLlxuICBrZXlNYXAucGNEZWZhdWx0ID0ge1xuICAgIFwiQ3RybC1BXCI6IFwic2VsZWN0QWxsXCIsIFwiQ3RybC1EXCI6IFwiZGVsZXRlTGluZVwiLCBcIkN0cmwtWlwiOiBcInVuZG9cIiwgXCJTaGlmdC1DdHJsLVpcIjogXCJyZWRvXCIsIFwiQ3RybC1ZXCI6IFwicmVkb1wiLFxuICAgIFwiQ3RybC1Ib21lXCI6IFwiZ29Eb2NTdGFydFwiLCBcIkN0cmwtRW5kXCI6IFwiZ29Eb2NFbmRcIiwgXCJDdHJsLVVwXCI6IFwiZ29MaW5lVXBcIiwgXCJDdHJsLURvd25cIjogXCJnb0xpbmVEb3duXCIsXG4gICAgXCJDdHJsLUxlZnRcIjogXCJnb0dyb3VwTGVmdFwiLCBcIkN0cmwtUmlnaHRcIjogXCJnb0dyb3VwUmlnaHRcIiwgXCJBbHQtTGVmdFwiOiBcImdvTGluZVN0YXJ0XCIsIFwiQWx0LVJpZ2h0XCI6IFwiZ29MaW5lRW5kXCIsXG4gICAgXCJDdHJsLUJhY2tzcGFjZVwiOiBcImRlbEdyb3VwQmVmb3JlXCIsIFwiQ3RybC1EZWxldGVcIjogXCJkZWxHcm91cEFmdGVyXCIsIFwiQ3RybC1TXCI6IFwic2F2ZVwiLCBcIkN0cmwtRlwiOiBcImZpbmRcIixcbiAgICBcIkN0cmwtR1wiOiBcImZpbmROZXh0XCIsIFwiU2hpZnQtQ3RybC1HXCI6IFwiZmluZFByZXZcIiwgXCJTaGlmdC1DdHJsLUZcIjogXCJyZXBsYWNlXCIsIFwiU2hpZnQtQ3RybC1SXCI6IFwicmVwbGFjZUFsbFwiLFxuICAgIFwiQ3RybC1bXCI6IFwiaW5kZW50TGVzc1wiLCBcIkN0cmwtXVwiOiBcImluZGVudE1vcmVcIixcbiAgICBcIkN0cmwtVVwiOiBcInVuZG9TZWxlY3Rpb25cIiwgXCJTaGlmdC1DdHJsLVVcIjogXCJyZWRvU2VsZWN0aW9uXCIsIFwiQWx0LVVcIjogXCJyZWRvU2VsZWN0aW9uXCIsXG4gICAgZmFsbHRocm91Z2g6IFwiYmFzaWNcIlxuICB9O1xuICAvLyBWZXJ5IGJhc2ljIHJlYWRsaW5lL2VtYWNzLXN0eWxlIGJpbmRpbmdzLCB3aGljaCBhcmUgc3RhbmRhcmQgb24gTWFjLlxuICBrZXlNYXAuZW1hY3N5ID0ge1xuICAgIFwiQ3RybC1GXCI6IFwiZ29DaGFyUmlnaHRcIiwgXCJDdHJsLUJcIjogXCJnb0NoYXJMZWZ0XCIsIFwiQ3RybC1QXCI6IFwiZ29MaW5lVXBcIiwgXCJDdHJsLU5cIjogXCJnb0xpbmVEb3duXCIsXG4gICAgXCJBbHQtRlwiOiBcImdvV29yZFJpZ2h0XCIsIFwiQWx0LUJcIjogXCJnb1dvcmRMZWZ0XCIsIFwiQ3RybC1BXCI6IFwiZ29MaW5lU3RhcnRcIiwgXCJDdHJsLUVcIjogXCJnb0xpbmVFbmRcIixcbiAgICBcIkN0cmwtVlwiOiBcImdvUGFnZURvd25cIiwgXCJTaGlmdC1DdHJsLVZcIjogXCJnb1BhZ2VVcFwiLCBcIkN0cmwtRFwiOiBcImRlbENoYXJBZnRlclwiLCBcIkN0cmwtSFwiOiBcImRlbENoYXJCZWZvcmVcIixcbiAgICBcIkFsdC1EXCI6IFwiZGVsV29yZEFmdGVyXCIsIFwiQWx0LUJhY2tzcGFjZVwiOiBcImRlbFdvcmRCZWZvcmVcIiwgXCJDdHJsLUtcIjogXCJraWxsTGluZVwiLCBcIkN0cmwtVFwiOiBcInRyYW5zcG9zZUNoYXJzXCJcbiAgfTtcbiAga2V5TWFwLm1hY0RlZmF1bHQgPSB7XG4gICAgXCJDbWQtQVwiOiBcInNlbGVjdEFsbFwiLCBcIkNtZC1EXCI6IFwiZGVsZXRlTGluZVwiLCBcIkNtZC1aXCI6IFwidW5kb1wiLCBcIlNoaWZ0LUNtZC1aXCI6IFwicmVkb1wiLCBcIkNtZC1ZXCI6IFwicmVkb1wiLFxuICAgIFwiQ21kLUhvbWVcIjogXCJnb0RvY1N0YXJ0XCIsIFwiQ21kLVVwXCI6IFwiZ29Eb2NTdGFydFwiLCBcIkNtZC1FbmRcIjogXCJnb0RvY0VuZFwiLCBcIkNtZC1Eb3duXCI6IFwiZ29Eb2NFbmRcIiwgXCJBbHQtTGVmdFwiOiBcImdvR3JvdXBMZWZ0XCIsXG4gICAgXCJBbHQtUmlnaHRcIjogXCJnb0dyb3VwUmlnaHRcIiwgXCJDbWQtTGVmdFwiOiBcImdvTGluZUxlZnRcIiwgXCJDbWQtUmlnaHRcIjogXCJnb0xpbmVSaWdodFwiLCBcIkFsdC1CYWNrc3BhY2VcIjogXCJkZWxHcm91cEJlZm9yZVwiLFxuICAgIFwiQ3RybC1BbHQtQmFja3NwYWNlXCI6IFwiZGVsR3JvdXBBZnRlclwiLCBcIkFsdC1EZWxldGVcIjogXCJkZWxHcm91cEFmdGVyXCIsIFwiQ21kLVNcIjogXCJzYXZlXCIsIFwiQ21kLUZcIjogXCJmaW5kXCIsXG4gICAgXCJDbWQtR1wiOiBcImZpbmROZXh0XCIsIFwiU2hpZnQtQ21kLUdcIjogXCJmaW5kUHJldlwiLCBcIkNtZC1BbHQtRlwiOiBcInJlcGxhY2VcIiwgXCJTaGlmdC1DbWQtQWx0LUZcIjogXCJyZXBsYWNlQWxsXCIsXG4gICAgXCJDbWQtW1wiOiBcImluZGVudExlc3NcIiwgXCJDbWQtXVwiOiBcImluZGVudE1vcmVcIiwgXCJDbWQtQmFja3NwYWNlXCI6IFwiZGVsV3JhcHBlZExpbmVMZWZ0XCIsIFwiQ21kLURlbGV0ZVwiOiBcImRlbFdyYXBwZWRMaW5lUmlnaHRcIixcbiAgICBcIkNtZC1VXCI6IFwidW5kb1NlbGVjdGlvblwiLCBcIlNoaWZ0LUNtZC1VXCI6IFwicmVkb1NlbGVjdGlvblwiLCBcIkN0cmwtVXBcIjogXCJnb0RvY1N0YXJ0XCIsIFwiQ3RybC1Eb3duXCI6IFwiZ29Eb2NFbmRcIixcbiAgICBmYWxsdGhyb3VnaDogW1wiYmFzaWNcIiwgXCJlbWFjc3lcIl1cbiAgfTtcbiAga2V5TWFwW1wiZGVmYXVsdFwiXSA9IG1hYyA/IGtleU1hcC5tYWNEZWZhdWx0IDoga2V5TWFwLnBjRGVmYXVsdDtcblxuICAvLyBLRVlNQVAgRElTUEFUQ0hcblxuICBmdW5jdGlvbiBub3JtYWxpemVLZXlOYW1lKG5hbWUpIHtcbiAgICB2YXIgcGFydHMgPSBuYW1lLnNwbGl0KC8tKD8hJCkvKSwgbmFtZSA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuICAgIHZhciBhbHQsIGN0cmwsIHNoaWZ0LCBjbWQ7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgIHZhciBtb2QgPSBwYXJ0c1tpXTtcbiAgICAgIGlmICgvXihjbWR8bWV0YXxtKSQvaS50ZXN0KG1vZCkpIGNtZCA9IHRydWU7XG4gICAgICBlbHNlIGlmICgvXmEobHQpPyQvaS50ZXN0KG1vZCkpIGFsdCA9IHRydWU7XG4gICAgICBlbHNlIGlmICgvXihjfGN0cmx8Y29udHJvbCkkL2kudGVzdChtb2QpKSBjdHJsID0gdHJ1ZTtcbiAgICAgIGVsc2UgaWYgKC9ecyhoaWZ0KSQvaS50ZXN0KG1vZCkpIHNoaWZ0ID0gdHJ1ZTtcbiAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKFwiVW5yZWNvZ25pemVkIG1vZGlmaWVyIG5hbWU6IFwiICsgbW9kKTtcbiAgICB9XG4gICAgaWYgKGFsdCkgbmFtZSA9IFwiQWx0LVwiICsgbmFtZTtcbiAgICBpZiAoY3RybCkgbmFtZSA9IFwiQ3RybC1cIiArIG5hbWU7XG4gICAgaWYgKGNtZCkgbmFtZSA9IFwiQ21kLVwiICsgbmFtZTtcbiAgICBpZiAoc2hpZnQpIG5hbWUgPSBcIlNoaWZ0LVwiICsgbmFtZTtcbiAgICByZXR1cm4gbmFtZTtcbiAgfVxuXG4gIC8vIFRoaXMgaXMgYSBrbHVkZ2UgdG8ga2VlcCBrZXltYXBzIG1vc3RseSB3b3JraW5nIGFzIHJhdyBvYmplY3RzXG4gIC8vIChiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSkgd2hpbGUgYXQgdGhlIHNhbWUgdGltZSBzdXBwb3J0IGZlYXR1cmVzXG4gIC8vIGxpa2Ugbm9ybWFsaXphdGlvbiBhbmQgbXVsdGktc3Ryb2tlIGtleSBiaW5kaW5ncy4gSXQgY29tcGlsZXMgYVxuICAvLyBuZXcgbm9ybWFsaXplZCBrZXltYXAsIGFuZCB0aGVuIHVwZGF0ZXMgdGhlIG9sZCBvYmplY3QgdG8gcmVmbGVjdFxuICAvLyB0aGlzLlxuICBDb2RlTWlycm9yLm5vcm1hbGl6ZUtleU1hcCA9IGZ1bmN0aW9uKGtleW1hcCkge1xuICAgIHZhciBjb3B5ID0ge307XG4gICAgZm9yICh2YXIga2V5bmFtZSBpbiBrZXltYXApIGlmIChrZXltYXAuaGFzT3duUHJvcGVydHkoa2V5bmFtZSkpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGtleW1hcFtrZXluYW1lXTtcbiAgICAgIGlmICgvXihuYW1lfGZhbGx0aHJvdWdofChkZXxhdCl0YWNoKSQvLnRlc3Qoa2V5bmFtZSkpIGNvbnRpbnVlO1xuICAgICAgaWYgKHZhbHVlID09IFwiLi4uXCIpIHsgZGVsZXRlIGtleW1hcFtrZXluYW1lXTsgY29udGludWU7IH1cblxuICAgICAgdmFyIGtleXMgPSBtYXAoa2V5bmFtZS5zcGxpdChcIiBcIiksIG5vcm1hbGl6ZUtleU5hbWUpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB2YWwsIG5hbWU7XG4gICAgICAgIGlmIChpID09IGtleXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIG5hbWUgPSBrZXlzLmpvaW4oXCIgXCIpO1xuICAgICAgICAgIHZhbCA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5hbWUgPSBrZXlzLnNsaWNlKDAsIGkgKyAxKS5qb2luKFwiIFwiKTtcbiAgICAgICAgICB2YWwgPSBcIi4uLlwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmV2ID0gY29weVtuYW1lXTtcbiAgICAgICAgaWYgKCFwcmV2KSBjb3B5W25hbWVdID0gdmFsO1xuICAgICAgICBlbHNlIGlmIChwcmV2ICE9IHZhbCkgdGhyb3cgbmV3IEVycm9yKFwiSW5jb25zaXN0ZW50IGJpbmRpbmdzIGZvciBcIiArIG5hbWUpO1xuICAgICAgfVxuICAgICAgZGVsZXRlIGtleW1hcFtrZXluYW1lXTtcbiAgICB9XG4gICAgZm9yICh2YXIgcHJvcCBpbiBjb3B5KSBrZXltYXBbcHJvcF0gPSBjb3B5W3Byb3BdO1xuICAgIHJldHVybiBrZXltYXA7XG4gIH07XG5cbiAgdmFyIGxvb2t1cEtleSA9IENvZGVNaXJyb3IubG9va3VwS2V5ID0gZnVuY3Rpb24oa2V5LCBtYXAsIGhhbmRsZSwgY29udGV4dCkge1xuICAgIG1hcCA9IGdldEtleU1hcChtYXApO1xuICAgIHZhciBmb3VuZCA9IG1hcC5jYWxsID8gbWFwLmNhbGwoa2V5LCBjb250ZXh0KSA6IG1hcFtrZXldO1xuICAgIGlmIChmb3VuZCA9PT0gZmFsc2UpIHJldHVybiBcIm5vdGhpbmdcIjtcbiAgICBpZiAoZm91bmQgPT09IFwiLi4uXCIpIHJldHVybiBcIm11bHRpXCI7XG4gICAgaWYgKGZvdW5kICE9IG51bGwgJiYgaGFuZGxlKGZvdW5kKSkgcmV0dXJuIFwiaGFuZGxlZFwiO1xuXG4gICAgaWYgKG1hcC5mYWxsdGhyb3VnaCkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChtYXAuZmFsbHRocm91Z2gpICE9IFwiW29iamVjdCBBcnJheV1cIilcbiAgICAgICAgcmV0dXJuIGxvb2t1cEtleShrZXksIG1hcC5mYWxsdGhyb3VnaCwgaGFuZGxlLCBjb250ZXh0KTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFwLmZhbGx0aHJvdWdoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBsb29rdXBLZXkoa2V5LCBtYXAuZmFsbHRocm91Z2hbaV0sIGhhbmRsZSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIE1vZGlmaWVyIGtleSBwcmVzc2VzIGRvbid0IGNvdW50IGFzICdyZWFsJyBrZXkgcHJlc3NlcyBmb3IgdGhlXG4gIC8vIHB1cnBvc2Ugb2Yga2V5bWFwIGZhbGx0aHJvdWdoLlxuICB2YXIgaXNNb2RpZmllcktleSA9IENvZGVNaXJyb3IuaXNNb2RpZmllcktleSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgdmFyIG5hbWUgPSB0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIiA/IHZhbHVlIDoga2V5TmFtZXNbdmFsdWUua2V5Q29kZV07XG4gICAgcmV0dXJuIG5hbWUgPT0gXCJDdHJsXCIgfHwgbmFtZSA9PSBcIkFsdFwiIHx8IG5hbWUgPT0gXCJTaGlmdFwiIHx8IG5hbWUgPT0gXCJNb2RcIjtcbiAgfTtcblxuICAvLyBMb29rIHVwIHRoZSBuYW1lIG9mIGEga2V5IGFzIGluZGljYXRlZCBieSBhbiBldmVudCBvYmplY3QuXG4gIHZhciBrZXlOYW1lID0gQ29kZU1pcnJvci5rZXlOYW1lID0gZnVuY3Rpb24oZXZlbnQsIG5vU2hpZnQpIHtcbiAgICBpZiAocHJlc3RvICYmIGV2ZW50LmtleUNvZGUgPT0gMzQgJiYgZXZlbnRbXCJjaGFyXCJdKSByZXR1cm4gZmFsc2U7XG4gICAgdmFyIGJhc2UgPSBrZXlOYW1lc1tldmVudC5rZXlDb2RlXSwgbmFtZSA9IGJhc2U7XG4gICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBldmVudC5hbHRHcmFwaEtleSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChldmVudC5hbHRLZXkgJiYgYmFzZSAhPSBcIkFsdFwiKSBuYW1lID0gXCJBbHQtXCIgKyBuYW1lO1xuICAgIGlmICgoZmxpcEN0cmxDbWQgPyBldmVudC5tZXRhS2V5IDogZXZlbnQuY3RybEtleSkgJiYgYmFzZSAhPSBcIkN0cmxcIikgbmFtZSA9IFwiQ3RybC1cIiArIG5hbWU7XG4gICAgaWYgKChmbGlwQ3RybENtZCA/IGV2ZW50LmN0cmxLZXkgOiBldmVudC5tZXRhS2V5KSAmJiBiYXNlICE9IFwiQ21kXCIpIG5hbWUgPSBcIkNtZC1cIiArIG5hbWU7XG4gICAgaWYgKCFub1NoaWZ0ICYmIGV2ZW50LnNoaWZ0S2V5ICYmIGJhc2UgIT0gXCJTaGlmdFwiKSBuYW1lID0gXCJTaGlmdC1cIiArIG5hbWU7XG4gICAgcmV0dXJuIG5hbWU7XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0S2V5TWFwKHZhbCkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsID09IFwic3RyaW5nXCIgPyBrZXlNYXBbdmFsXSA6IHZhbDtcbiAgfVxuXG4gIC8vIEZST01URVhUQVJFQVxuXG4gIENvZGVNaXJyb3IuZnJvbVRleHRBcmVhID0gZnVuY3Rpb24odGV4dGFyZWEsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyA/IGNvcHlPYmoob3B0aW9ucykgOiB7fTtcbiAgICBvcHRpb25zLnZhbHVlID0gdGV4dGFyZWEudmFsdWU7XG4gICAgaWYgKCFvcHRpb25zLnRhYmluZGV4ICYmIHRleHRhcmVhLnRhYkluZGV4KVxuICAgICAgb3B0aW9ucy50YWJpbmRleCA9IHRleHRhcmVhLnRhYkluZGV4O1xuICAgIGlmICghb3B0aW9ucy5wbGFjZWhvbGRlciAmJiB0ZXh0YXJlYS5wbGFjZWhvbGRlcilcbiAgICAgIG9wdGlvbnMucGxhY2Vob2xkZXIgPSB0ZXh0YXJlYS5wbGFjZWhvbGRlcjtcbiAgICAvLyBTZXQgYXV0b2ZvY3VzIHRvIHRydWUgaWYgdGhpcyB0ZXh0YXJlYSBpcyBmb2N1c2VkLCBvciBpZiBpdCBoYXNcbiAgICAvLyBhdXRvZm9jdXMgYW5kIG5vIG90aGVyIGVsZW1lbnQgaXMgZm9jdXNlZC5cbiAgICBpZiAob3B0aW9ucy5hdXRvZm9jdXMgPT0gbnVsbCkge1xuICAgICAgdmFyIGhhc0ZvY3VzID0gYWN0aXZlRWx0KCk7XG4gICAgICBvcHRpb25zLmF1dG9mb2N1cyA9IGhhc0ZvY3VzID09IHRleHRhcmVhIHx8XG4gICAgICAgIHRleHRhcmVhLmdldEF0dHJpYnV0ZShcImF1dG9mb2N1c1wiKSAhPSBudWxsICYmIGhhc0ZvY3VzID09IGRvY3VtZW50LmJvZHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZSgpIHt0ZXh0YXJlYS52YWx1ZSA9IGNtLmdldFZhbHVlKCk7fVxuICAgIGlmICh0ZXh0YXJlYS5mb3JtKSB7XG4gICAgICBvbih0ZXh0YXJlYS5mb3JtLCBcInN1Ym1pdFwiLCBzYXZlKTtcbiAgICAgIC8vIERlcGxvcmFibGUgaGFjayB0byBtYWtlIHRoZSBzdWJtaXQgbWV0aG9kIGRvIHRoZSByaWdodCB0aGluZy5cbiAgICAgIGlmICghb3B0aW9ucy5sZWF2ZVN1Ym1pdE1ldGhvZEFsb25lKSB7XG4gICAgICAgIHZhciBmb3JtID0gdGV4dGFyZWEuZm9ybSwgcmVhbFN1Ym1pdCA9IGZvcm0uc3VibWl0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciB3cmFwcGVkU3VibWl0ID0gZm9ybS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNhdmUoKTtcbiAgICAgICAgICAgIGZvcm0uc3VibWl0ID0gcmVhbFN1Ym1pdDtcbiAgICAgICAgICAgIGZvcm0uc3VibWl0KCk7XG4gICAgICAgICAgICBmb3JtLnN1Ym1pdCA9IHdyYXBwZWRTdWJtaXQ7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgfVxuICAgIH1cblxuICAgIG9wdGlvbnMuZmluaXNoSW5pdCA9IGZ1bmN0aW9uKGNtKSB7XG4gICAgICBjbS5zYXZlID0gc2F2ZTtcbiAgICAgIGNtLmdldFRleHRBcmVhID0gZnVuY3Rpb24oKSB7IHJldHVybiB0ZXh0YXJlYTsgfTtcbiAgICAgIGNtLnRvVGV4dEFyZWEgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY20udG9UZXh0QXJlYSA9IGlzTmFOOyAvLyBQcmV2ZW50IHRoaXMgZnJvbSBiZWluZyByYW4gdHdpY2VcbiAgICAgICAgc2F2ZSgpO1xuICAgICAgICB0ZXh0YXJlYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNtLmdldFdyYXBwZXJFbGVtZW50KCkpO1xuICAgICAgICB0ZXh0YXJlYS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcbiAgICAgICAgaWYgKHRleHRhcmVhLmZvcm0pIHtcbiAgICAgICAgICBvZmYodGV4dGFyZWEuZm9ybSwgXCJzdWJtaXRcIiwgc2F2ZSk7XG4gICAgICAgICAgaWYgKHR5cGVvZiB0ZXh0YXJlYS5mb3JtLnN1Ym1pdCA9PSBcImZ1bmN0aW9uXCIpXG4gICAgICAgICAgICB0ZXh0YXJlYS5mb3JtLnN1Ym1pdCA9IHJlYWxTdWJtaXQ7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfTtcblxuICAgIHRleHRhcmVhLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB2YXIgY20gPSBDb2RlTWlycm9yKGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRleHRhcmVhLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5vZGUsIHRleHRhcmVhLm5leHRTaWJsaW5nKTtcbiAgICB9LCBvcHRpb25zKTtcbiAgICByZXR1cm4gY207XG4gIH07XG5cbiAgLy8gU1RSSU5HIFNUUkVBTVxuXG4gIC8vIEZlZCB0byB0aGUgbW9kZSBwYXJzZXJzLCBwcm92aWRlcyBoZWxwZXIgZnVuY3Rpb25zIHRvIG1ha2VcbiAgLy8gcGFyc2VycyBtb3JlIHN1Y2NpbmN0LlxuXG4gIHZhciBTdHJpbmdTdHJlYW0gPSBDb2RlTWlycm9yLlN0cmluZ1N0cmVhbSA9IGZ1bmN0aW9uKHN0cmluZywgdGFiU2l6ZSkge1xuICAgIHRoaXMucG9zID0gdGhpcy5zdGFydCA9IDA7XG4gICAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG4gICAgdGhpcy50YWJTaXplID0gdGFiU2l6ZSB8fCA4O1xuICAgIHRoaXMubGFzdENvbHVtblBvcyA9IHRoaXMubGFzdENvbHVtblZhbHVlID0gMDtcbiAgICB0aGlzLmxpbmVTdGFydCA9IDA7XG4gIH07XG5cbiAgU3RyaW5nU3RyZWFtLnByb3RvdHlwZSA9IHtcbiAgICBlb2w6IGZ1bmN0aW9uKCkge3JldHVybiB0aGlzLnBvcyA+PSB0aGlzLnN0cmluZy5sZW5ndGg7fSxcbiAgICBzb2w6IGZ1bmN0aW9uKCkge3JldHVybiB0aGlzLnBvcyA9PSB0aGlzLmxpbmVTdGFydDt9LFxuICAgIHBlZWs6IGZ1bmN0aW9uKCkge3JldHVybiB0aGlzLnN0cmluZy5jaGFyQXQodGhpcy5wb3MpIHx8IHVuZGVmaW5lZDt9LFxuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMucG9zIDwgdGhpcy5zdHJpbmcubGVuZ3RoKVxuICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmcuY2hhckF0KHRoaXMucG9zKyspO1xuICAgIH0sXG4gICAgZWF0OiBmdW5jdGlvbihtYXRjaCkge1xuICAgICAgdmFyIGNoID0gdGhpcy5zdHJpbmcuY2hhckF0KHRoaXMucG9zKTtcbiAgICAgIGlmICh0eXBlb2YgbWF0Y2ggPT0gXCJzdHJpbmdcIikgdmFyIG9rID0gY2ggPT0gbWF0Y2g7XG4gICAgICBlbHNlIHZhciBvayA9IGNoICYmIChtYXRjaC50ZXN0ID8gbWF0Y2gudGVzdChjaCkgOiBtYXRjaChjaCkpO1xuICAgICAgaWYgKG9rKSB7Kyt0aGlzLnBvczsgcmV0dXJuIGNoO31cbiAgICB9LFxuICAgIGVhdFdoaWxlOiBmdW5jdGlvbihtYXRjaCkge1xuICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5wb3M7XG4gICAgICB3aGlsZSAodGhpcy5lYXQobWF0Y2gpKXt9XG4gICAgICByZXR1cm4gdGhpcy5wb3MgPiBzdGFydDtcbiAgICB9LFxuICAgIGVhdFNwYWNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzdGFydCA9IHRoaXMucG9zO1xuICAgICAgd2hpbGUgKC9bXFxzXFx1MDBhMF0vLnRlc3QodGhpcy5zdHJpbmcuY2hhckF0KHRoaXMucG9zKSkpICsrdGhpcy5wb3M7XG4gICAgICByZXR1cm4gdGhpcy5wb3MgPiBzdGFydDtcbiAgICB9LFxuICAgIHNraXBUb0VuZDogZnVuY3Rpb24oKSB7dGhpcy5wb3MgPSB0aGlzLnN0cmluZy5sZW5ndGg7fSxcbiAgICBza2lwVG86IGZ1bmN0aW9uKGNoKSB7XG4gICAgICB2YXIgZm91bmQgPSB0aGlzLnN0cmluZy5pbmRleE9mKGNoLCB0aGlzLnBvcyk7XG4gICAgICBpZiAoZm91bmQgPiAtMSkge3RoaXMucG9zID0gZm91bmQ7IHJldHVybiB0cnVlO31cbiAgICB9LFxuICAgIGJhY2tVcDogZnVuY3Rpb24obikge3RoaXMucG9zIC09IG47fSxcbiAgICBjb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMubGFzdENvbHVtblBvcyA8IHRoaXMuc3RhcnQpIHtcbiAgICAgICAgdGhpcy5sYXN0Q29sdW1uVmFsdWUgPSBjb3VudENvbHVtbih0aGlzLnN0cmluZywgdGhpcy5zdGFydCwgdGhpcy50YWJTaXplLCB0aGlzLmxhc3RDb2x1bW5Qb3MsIHRoaXMubGFzdENvbHVtblZhbHVlKTtcbiAgICAgICAgdGhpcy5sYXN0Q29sdW1uUG9zID0gdGhpcy5zdGFydDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmxhc3RDb2x1bW5WYWx1ZSAtICh0aGlzLmxpbmVTdGFydCA/IGNvdW50Q29sdW1uKHRoaXMuc3RyaW5nLCB0aGlzLmxpbmVTdGFydCwgdGhpcy50YWJTaXplKSA6IDApO1xuICAgIH0sXG4gICAgaW5kZW50YXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNvdW50Q29sdW1uKHRoaXMuc3RyaW5nLCBudWxsLCB0aGlzLnRhYlNpemUpIC1cbiAgICAgICAgKHRoaXMubGluZVN0YXJ0ID8gY291bnRDb2x1bW4odGhpcy5zdHJpbmcsIHRoaXMubGluZVN0YXJ0LCB0aGlzLnRhYlNpemUpIDogMCk7XG4gICAgfSxcbiAgICBtYXRjaDogZnVuY3Rpb24ocGF0dGVybiwgY29uc3VtZSwgY2FzZUluc2Vuc2l0aXZlKSB7XG4gICAgICBpZiAodHlwZW9mIHBhdHRlcm4gPT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgY2FzZWQgPSBmdW5jdGlvbihzdHIpIHtyZXR1cm4gY2FzZUluc2Vuc2l0aXZlID8gc3RyLnRvTG93ZXJDYXNlKCkgOiBzdHI7fTtcbiAgICAgICAgdmFyIHN1YnN0ciA9IHRoaXMuc3RyaW5nLnN1YnN0cih0aGlzLnBvcywgcGF0dGVybi5sZW5ndGgpO1xuICAgICAgICBpZiAoY2FzZWQoc3Vic3RyKSA9PSBjYXNlZChwYXR0ZXJuKSkge1xuICAgICAgICAgIGlmIChjb25zdW1lICE9PSBmYWxzZSkgdGhpcy5wb3MgKz0gcGF0dGVybi5sZW5ndGg7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBtYXRjaCA9IHRoaXMuc3RyaW5nLnNsaWNlKHRoaXMucG9zKS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoLmluZGV4ID4gMCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGlmIChtYXRjaCAmJiBjb25zdW1lICE9PSBmYWxzZSkgdGhpcy5wb3MgKz0gbWF0Y2hbMF0ubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICB9XG4gICAgfSxcbiAgICBjdXJyZW50OiBmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0cmluZy5zbGljZSh0aGlzLnN0YXJ0LCB0aGlzLnBvcyk7fSxcbiAgICBoaWRlRmlyc3RDaGFyczogZnVuY3Rpb24obiwgaW5uZXIpIHtcbiAgICAgIHRoaXMubGluZVN0YXJ0ICs9IG47XG4gICAgICB0cnkgeyByZXR1cm4gaW5uZXIoKTsgfVxuICAgICAgZmluYWxseSB7IHRoaXMubGluZVN0YXJ0IC09IG47IH1cbiAgICB9XG4gIH07XG5cbiAgLy8gVEVYVE1BUktFUlNcblxuICAvLyBDcmVhdGVkIHdpdGggbWFya1RleHQgYW5kIHNldEJvb2ttYXJrIG1ldGhvZHMuIEEgVGV4dE1hcmtlciBpcyBhXG4gIC8vIGhhbmRsZSB0aGF0IGNhbiBiZSB1c2VkIHRvIGNsZWFyIG9yIGZpbmQgYSBtYXJrZWQgcG9zaXRpb24gaW4gdGhlXG4gIC8vIGRvY3VtZW50LiBMaW5lIG9iamVjdHMgaG9sZCBhcnJheXMgKG1hcmtlZFNwYW5zKSBjb250YWluaW5nXG4gIC8vIHtmcm9tLCB0bywgbWFya2VyfSBvYmplY3QgcG9pbnRpbmcgdG8gc3VjaCBtYXJrZXIgb2JqZWN0cywgYW5kXG4gIC8vIGluZGljYXRpbmcgdGhhdCBzdWNoIGEgbWFya2VyIGlzIHByZXNlbnQgb24gdGhhdCBsaW5lLiBNdWx0aXBsZVxuICAvLyBsaW5lcyBtYXkgcG9pbnQgdG8gdGhlIHNhbWUgbWFya2VyIHdoZW4gaXQgc3BhbnMgYWNyb3NzIGxpbmVzLlxuICAvLyBUaGUgc3BhbnMgd2lsbCBoYXZlIG51bGwgZm9yIHRoZWlyIGZyb20vdG8gcHJvcGVydGllcyB3aGVuIHRoZVxuICAvLyBtYXJrZXIgY29udGludWVzIGJleW9uZCB0aGUgc3RhcnQvZW5kIG9mIHRoZSBsaW5lLiBNYXJrZXJzIGhhdmVcbiAgLy8gbGlua3MgYmFjayB0byB0aGUgbGluZXMgdGhleSBjdXJyZW50bHkgdG91Y2guXG5cbiAgdmFyIG5leHRNYXJrZXJJZCA9IDA7XG5cbiAgdmFyIFRleHRNYXJrZXIgPSBDb2RlTWlycm9yLlRleHRNYXJrZXIgPSBmdW5jdGlvbihkb2MsIHR5cGUpIHtcbiAgICB0aGlzLmxpbmVzID0gW107XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLmRvYyA9IGRvYztcbiAgICB0aGlzLmlkID0gKytuZXh0TWFya2VySWQ7XG4gIH07XG4gIGV2ZW50TWl4aW4oVGV4dE1hcmtlcik7XG5cbiAgLy8gQ2xlYXIgdGhlIG1hcmtlci5cbiAgVGV4dE1hcmtlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5leHBsaWNpdGx5Q2xlYXJlZCkgcmV0dXJuO1xuICAgIHZhciBjbSA9IHRoaXMuZG9jLmNtLCB3aXRoT3AgPSBjbSAmJiAhY20uY3VyT3A7XG4gICAgaWYgKHdpdGhPcCkgc3RhcnRPcGVyYXRpb24oY20pO1xuICAgIGlmIChoYXNIYW5kbGVyKHRoaXMsIFwiY2xlYXJcIikpIHtcbiAgICAgIHZhciBmb3VuZCA9IHRoaXMuZmluZCgpO1xuICAgICAgaWYgKGZvdW5kKSBzaWduYWxMYXRlcih0aGlzLCBcImNsZWFyXCIsIGZvdW5kLmZyb20sIGZvdW5kLnRvKTtcbiAgICB9XG4gICAgdmFyIG1pbiA9IG51bGwsIG1heCA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgbGluZSA9IHRoaXMubGluZXNbaV07XG4gICAgICB2YXIgc3BhbiA9IGdldE1hcmtlZFNwYW5Gb3IobGluZS5tYXJrZWRTcGFucywgdGhpcyk7XG4gICAgICBpZiAoY20gJiYgIXRoaXMuY29sbGFwc2VkKSByZWdMaW5lQ2hhbmdlKGNtLCBsaW5lTm8obGluZSksIFwidGV4dFwiKTtcbiAgICAgIGVsc2UgaWYgKGNtKSB7XG4gICAgICAgIGlmIChzcGFuLnRvICE9IG51bGwpIG1heCA9IGxpbmVObyhsaW5lKTtcbiAgICAgICAgaWYgKHNwYW4uZnJvbSAhPSBudWxsKSBtaW4gPSBsaW5lTm8obGluZSk7XG4gICAgICB9XG4gICAgICBsaW5lLm1hcmtlZFNwYW5zID0gcmVtb3ZlTWFya2VkU3BhbihsaW5lLm1hcmtlZFNwYW5zLCBzcGFuKTtcbiAgICAgIGlmIChzcGFuLmZyb20gPT0gbnVsbCAmJiB0aGlzLmNvbGxhcHNlZCAmJiAhbGluZUlzSGlkZGVuKHRoaXMuZG9jLCBsaW5lKSAmJiBjbSlcbiAgICAgICAgdXBkYXRlTGluZUhlaWdodChsaW5lLCB0ZXh0SGVpZ2h0KGNtLmRpc3BsYXkpKTtcbiAgICB9XG4gICAgaWYgKGNtICYmIHRoaXMuY29sbGFwc2VkICYmICFjbS5vcHRpb25zLmxpbmVXcmFwcGluZykgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgdmlzdWFsID0gdmlzdWFsTGluZSh0aGlzLmxpbmVzW2ldKSwgbGVuID0gbGluZUxlbmd0aCh2aXN1YWwpO1xuICAgICAgaWYgKGxlbiA+IGNtLmRpc3BsYXkubWF4TGluZUxlbmd0aCkge1xuICAgICAgICBjbS5kaXNwbGF5Lm1heExpbmUgPSB2aXN1YWw7XG4gICAgICAgIGNtLmRpc3BsYXkubWF4TGluZUxlbmd0aCA9IGxlbjtcbiAgICAgICAgY20uZGlzcGxheS5tYXhMaW5lQ2hhbmdlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1pbiAhPSBudWxsICYmIGNtICYmIHRoaXMuY29sbGFwc2VkKSByZWdDaGFuZ2UoY20sIG1pbiwgbWF4ICsgMSk7XG4gICAgdGhpcy5saW5lcy5sZW5ndGggPSAwO1xuICAgIHRoaXMuZXhwbGljaXRseUNsZWFyZWQgPSB0cnVlO1xuICAgIGlmICh0aGlzLmF0b21pYyAmJiB0aGlzLmRvYy5jYW50RWRpdCkge1xuICAgICAgdGhpcy5kb2MuY2FudEVkaXQgPSBmYWxzZTtcbiAgICAgIGlmIChjbSkgcmVDaGVja1NlbGVjdGlvbihjbS5kb2MpO1xuICAgIH1cbiAgICBpZiAoY20pIHNpZ25hbExhdGVyKGNtLCBcIm1hcmtlckNsZWFyZWRcIiwgY20sIHRoaXMpO1xuICAgIGlmICh3aXRoT3ApIGVuZE9wZXJhdGlvbihjbSk7XG4gICAgaWYgKHRoaXMucGFyZW50KSB0aGlzLnBhcmVudC5jbGVhcigpO1xuICB9O1xuXG4gIC8vIEZpbmQgdGhlIHBvc2l0aW9uIG9mIHRoZSBtYXJrZXIgaW4gdGhlIGRvY3VtZW50LiBSZXR1cm5zIGEge2Zyb20sXG4gIC8vIHRvfSBvYmplY3QgYnkgZGVmYXVsdC4gU2lkZSBjYW4gYmUgcGFzc2VkIHRvIGdldCBhIHNwZWNpZmljIHNpZGVcbiAgLy8gLS0gMCAoYm90aCksIC0xIChsZWZ0KSwgb3IgMSAocmlnaHQpLiBXaGVuIGxpbmVPYmogaXMgdHJ1ZSwgdGhlXG4gIC8vIFBvcyBvYmplY3RzIHJldHVybmVkIGNvbnRhaW4gYSBsaW5lIG9iamVjdCwgcmF0aGVyIHRoYW4gYSBsaW5lXG4gIC8vIG51bWJlciAodXNlZCB0byBwcmV2ZW50IGxvb2tpbmcgdXAgdGhlIHNhbWUgbGluZSB0d2ljZSkuXG4gIFRleHRNYXJrZXIucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihzaWRlLCBsaW5lT2JqKSB7XG4gICAgaWYgKHNpZGUgPT0gbnVsbCAmJiB0aGlzLnR5cGUgPT0gXCJib29rbWFya1wiKSBzaWRlID0gMTtcbiAgICB2YXIgZnJvbSwgdG87XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgbGluZSA9IHRoaXMubGluZXNbaV07XG4gICAgICB2YXIgc3BhbiA9IGdldE1hcmtlZFNwYW5Gb3IobGluZS5tYXJrZWRTcGFucywgdGhpcyk7XG4gICAgICBpZiAoc3Bhbi5mcm9tICE9IG51bGwpIHtcbiAgICAgICAgZnJvbSA9IFBvcyhsaW5lT2JqID8gbGluZSA6IGxpbmVObyhsaW5lKSwgc3Bhbi5mcm9tKTtcbiAgICAgICAgaWYgKHNpZGUgPT0gLTEpIHJldHVybiBmcm9tO1xuICAgICAgfVxuICAgICAgaWYgKHNwYW4udG8gIT0gbnVsbCkge1xuICAgICAgICB0byA9IFBvcyhsaW5lT2JqID8gbGluZSA6IGxpbmVObyhsaW5lKSwgc3Bhbi50byk7XG4gICAgICAgIGlmIChzaWRlID09IDEpIHJldHVybiB0bztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZyb20gJiYge2Zyb206IGZyb20sIHRvOiB0b307XG4gIH07XG5cbiAgLy8gU2lnbmFscyB0aGF0IHRoZSBtYXJrZXIncyB3aWRnZXQgY2hhbmdlZCwgYW5kIHN1cnJvdW5kaW5nIGxheW91dFxuICAvLyBzaG91bGQgYmUgcmVjb21wdXRlZC5cbiAgVGV4dE1hcmtlci5wcm90b3R5cGUuY2hhbmdlZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwb3MgPSB0aGlzLmZpbmQoLTEsIHRydWUpLCB3aWRnZXQgPSB0aGlzLCBjbSA9IHRoaXMuZG9jLmNtO1xuICAgIGlmICghcG9zIHx8ICFjbSkgcmV0dXJuO1xuICAgIHJ1bkluT3AoY20sIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxpbmUgPSBwb3MubGluZSwgbGluZU4gPSBsaW5lTm8ocG9zLmxpbmUpO1xuICAgICAgdmFyIHZpZXcgPSBmaW5kVmlld0ZvckxpbmUoY20sIGxpbmVOKTtcbiAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgIGNsZWFyTGluZU1lYXN1cmVtZW50Q2FjaGVGb3Iodmlldyk7XG4gICAgICAgIGNtLmN1ck9wLnNlbGVjdGlvbkNoYW5nZWQgPSBjbS5jdXJPcC5mb3JjZVVwZGF0ZSA9IHRydWU7XG4gICAgICB9XG4gICAgICBjbS5jdXJPcC51cGRhdGVNYXhMaW5lID0gdHJ1ZTtcbiAgICAgIGlmICghbGluZUlzSGlkZGVuKHdpZGdldC5kb2MsIGxpbmUpICYmIHdpZGdldC5oZWlnaHQgIT0gbnVsbCkge1xuICAgICAgICB2YXIgb2xkSGVpZ2h0ID0gd2lkZ2V0LmhlaWdodDtcbiAgICAgICAgd2lkZ2V0LmhlaWdodCA9IG51bGw7XG4gICAgICAgIHZhciBkSGVpZ2h0ID0gd2lkZ2V0SGVpZ2h0KHdpZGdldCkgLSBvbGRIZWlnaHQ7XG4gICAgICAgIGlmIChkSGVpZ2h0KVxuICAgICAgICAgIHVwZGF0ZUxpbmVIZWlnaHQobGluZSwgbGluZS5oZWlnaHQgKyBkSGVpZ2h0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBUZXh0TWFya2VyLnByb3RvdHlwZS5hdHRhY2hMaW5lID0gZnVuY3Rpb24obGluZSkge1xuICAgIGlmICghdGhpcy5saW5lcy5sZW5ndGggJiYgdGhpcy5kb2MuY20pIHtcbiAgICAgIHZhciBvcCA9IHRoaXMuZG9jLmNtLmN1ck9wO1xuICAgICAgaWYgKCFvcC5tYXliZUhpZGRlbk1hcmtlcnMgfHwgaW5kZXhPZihvcC5tYXliZUhpZGRlbk1hcmtlcnMsIHRoaXMpID09IC0xKVxuICAgICAgICAob3AubWF5YmVVbmhpZGRlbk1hcmtlcnMgfHwgKG9wLm1heWJlVW5oaWRkZW5NYXJrZXJzID0gW10pKS5wdXNoKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLmxpbmVzLnB1c2gobGluZSk7XG4gIH07XG4gIFRleHRNYXJrZXIucHJvdG90eXBlLmRldGFjaExpbmUgPSBmdW5jdGlvbihsaW5lKSB7XG4gICAgdGhpcy5saW5lcy5zcGxpY2UoaW5kZXhPZih0aGlzLmxpbmVzLCBsaW5lKSwgMSk7XG4gICAgaWYgKCF0aGlzLmxpbmVzLmxlbmd0aCAmJiB0aGlzLmRvYy5jbSkge1xuICAgICAgdmFyIG9wID0gdGhpcy5kb2MuY20uY3VyT3A7XG4gICAgICAob3AubWF5YmVIaWRkZW5NYXJrZXJzIHx8IChvcC5tYXliZUhpZGRlbk1hcmtlcnMgPSBbXSkpLnB1c2godGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIC8vIENvbGxhcHNlZCBtYXJrZXJzIGhhdmUgdW5pcXVlIGlkcywgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBvcmRlclxuICAvLyB0aGVtLCB3aGljaCBpcyBuZWVkZWQgZm9yIHVuaXF1ZWx5IGRldGVybWluaW5nIGFuIG91dGVyIG1hcmtlclxuICAvLyB3aGVuIHRoZXkgb3ZlcmxhcCAodGhleSBtYXkgbmVzdCwgYnV0IG5vdCBwYXJ0aWFsbHkgb3ZlcmxhcCkuXG4gIHZhciBuZXh0TWFya2VySWQgPSAwO1xuXG4gIC8vIENyZWF0ZSBhIG1hcmtlciwgd2lyZSBpdCB1cCB0byB0aGUgcmlnaHQgbGluZXMsIGFuZFxuICBmdW5jdGlvbiBtYXJrVGV4dChkb2MsIGZyb20sIHRvLCBvcHRpb25zLCB0eXBlKSB7XG4gICAgLy8gU2hhcmVkIG1hcmtlcnMgKGFjcm9zcyBsaW5rZWQgZG9jdW1lbnRzKSBhcmUgaGFuZGxlZCBzZXBhcmF0ZWx5XG4gICAgLy8gKG1hcmtUZXh0U2hhcmVkIHdpbGwgY2FsbCBvdXQgdG8gdGhpcyBhZ2Fpbiwgb25jZSBwZXJcbiAgICAvLyBkb2N1bWVudCkuXG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5zaGFyZWQpIHJldHVybiBtYXJrVGV4dFNoYXJlZChkb2MsIGZyb20sIHRvLCBvcHRpb25zLCB0eXBlKTtcbiAgICAvLyBFbnN1cmUgd2UgYXJlIGluIGFuIG9wZXJhdGlvbi5cbiAgICBpZiAoZG9jLmNtICYmICFkb2MuY20uY3VyT3ApIHJldHVybiBvcGVyYXRpb24oZG9jLmNtLCBtYXJrVGV4dCkoZG9jLCBmcm9tLCB0bywgb3B0aW9ucywgdHlwZSk7XG5cbiAgICB2YXIgbWFya2VyID0gbmV3IFRleHRNYXJrZXIoZG9jLCB0eXBlKSwgZGlmZiA9IGNtcChmcm9tLCB0byk7XG4gICAgaWYgKG9wdGlvbnMpIGNvcHlPYmoob3B0aW9ucywgbWFya2VyLCBmYWxzZSk7XG4gICAgLy8gRG9uJ3QgY29ubmVjdCBlbXB0eSBtYXJrZXJzIHVubGVzcyBjbGVhcldoZW5FbXB0eSBpcyBmYWxzZVxuICAgIGlmIChkaWZmID4gMCB8fCBkaWZmID09IDAgJiYgbWFya2VyLmNsZWFyV2hlbkVtcHR5ICE9PSBmYWxzZSlcbiAgICAgIHJldHVybiBtYXJrZXI7XG4gICAgaWYgKG1hcmtlci5yZXBsYWNlZFdpdGgpIHtcbiAgICAgIC8vIFNob3dpbmcgdXAgYXMgYSB3aWRnZXQgaW1wbGllcyBjb2xsYXBzZWQgKHdpZGdldCByZXBsYWNlcyB0ZXh0KVxuICAgICAgbWFya2VyLmNvbGxhcHNlZCA9IHRydWU7XG4gICAgICBtYXJrZXIud2lkZ2V0Tm9kZSA9IGVsdChcInNwYW5cIiwgW21hcmtlci5yZXBsYWNlZFdpdGhdLCBcIkNvZGVNaXJyb3Itd2lkZ2V0XCIpO1xuICAgICAgaWYgKCFvcHRpb25zLmhhbmRsZU1vdXNlRXZlbnRzKSBtYXJrZXIud2lkZ2V0Tm9kZS5zZXRBdHRyaWJ1dGUoXCJjbS1pZ25vcmUtZXZlbnRzXCIsIFwidHJ1ZVwiKTtcbiAgICAgIGlmIChvcHRpb25zLmluc2VydExlZnQpIG1hcmtlci53aWRnZXROb2RlLmluc2VydExlZnQgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAobWFya2VyLmNvbGxhcHNlZCkge1xuICAgICAgaWYgKGNvbmZsaWN0aW5nQ29sbGFwc2VkUmFuZ2UoZG9jLCBmcm9tLmxpbmUsIGZyb20sIHRvLCBtYXJrZXIpIHx8XG4gICAgICAgICAgZnJvbS5saW5lICE9IHRvLmxpbmUgJiYgY29uZmxpY3RpbmdDb2xsYXBzZWRSYW5nZShkb2MsIHRvLmxpbmUsIGZyb20sIHRvLCBtYXJrZXIpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnNlcnRpbmcgY29sbGFwc2VkIG1hcmtlciBwYXJ0aWFsbHkgb3ZlcmxhcHBpbmcgYW4gZXhpc3Rpbmcgb25lXCIpO1xuICAgICAgc2F3Q29sbGFwc2VkU3BhbnMgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChtYXJrZXIuYWRkVG9IaXN0b3J5KVxuICAgICAgYWRkQ2hhbmdlVG9IaXN0b3J5KGRvYywge2Zyb206IGZyb20sIHRvOiB0bywgb3JpZ2luOiBcIm1hcmtUZXh0XCJ9LCBkb2Muc2VsLCBOYU4pO1xuXG4gICAgdmFyIGN1ckxpbmUgPSBmcm9tLmxpbmUsIGNtID0gZG9jLmNtLCB1cGRhdGVNYXhMaW5lO1xuICAgIGRvYy5pdGVyKGN1ckxpbmUsIHRvLmxpbmUgKyAxLCBmdW5jdGlvbihsaW5lKSB7XG4gICAgICBpZiAoY20gJiYgbWFya2VyLmNvbGxhcHNlZCAmJiAhY20ub3B0aW9ucy5saW5lV3JhcHBpbmcgJiYgdmlzdWFsTGluZShsaW5lKSA9PSBjbS5kaXNwbGF5Lm1heExpbmUpXG4gICAgICAgIHVwZGF0ZU1heExpbmUgPSB0cnVlO1xuICAgICAgaWYgKG1hcmtlci5jb2xsYXBzZWQgJiYgY3VyTGluZSAhPSBmcm9tLmxpbmUpIHVwZGF0ZUxpbmVIZWlnaHQobGluZSwgMCk7XG4gICAgICBhZGRNYXJrZWRTcGFuKGxpbmUsIG5ldyBNYXJrZWRTcGFuKG1hcmtlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyTGluZSA9PSBmcm9tLmxpbmUgPyBmcm9tLmNoIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyTGluZSA9PSB0by5saW5lID8gdG8uY2ggOiBudWxsKSk7XG4gICAgICArK2N1ckxpbmU7XG4gICAgfSk7XG4gICAgLy8gbGluZUlzSGlkZGVuIGRlcGVuZHMgb24gdGhlIHByZXNlbmNlIG9mIHRoZSBzcGFucywgc28gbmVlZHMgYSBzZWNvbmQgcGFzc1xuICAgIGlmIChtYXJrZXIuY29sbGFwc2VkKSBkb2MuaXRlcihmcm9tLmxpbmUsIHRvLmxpbmUgKyAxLCBmdW5jdGlvbihsaW5lKSB7XG4gICAgICBpZiAobGluZUlzSGlkZGVuKGRvYywgbGluZSkpIHVwZGF0ZUxpbmVIZWlnaHQobGluZSwgMCk7XG4gICAgfSk7XG5cbiAgICBpZiAobWFya2VyLmNsZWFyT25FbnRlcikgb24obWFya2VyLCBcImJlZm9yZUN1cnNvckVudGVyXCIsIGZ1bmN0aW9uKCkgeyBtYXJrZXIuY2xlYXIoKTsgfSk7XG5cbiAgICBpZiAobWFya2VyLnJlYWRPbmx5KSB7XG4gICAgICBzYXdSZWFkT25seVNwYW5zID0gdHJ1ZTtcbiAgICAgIGlmIChkb2MuaGlzdG9yeS5kb25lLmxlbmd0aCB8fCBkb2MuaGlzdG9yeS51bmRvbmUubGVuZ3RoKVxuICAgICAgICBkb2MuY2xlYXJIaXN0b3J5KCk7XG4gICAgfVxuICAgIGlmIChtYXJrZXIuY29sbGFwc2VkKSB7XG4gICAgICBtYXJrZXIuaWQgPSArK25leHRNYXJrZXJJZDtcbiAgICAgIG1hcmtlci5hdG9taWMgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoY20pIHtcbiAgICAgIC8vIFN5bmMgZWRpdG9yIHN0YXRlXG4gICAgICBpZiAodXBkYXRlTWF4TGluZSkgY20uY3VyT3AudXBkYXRlTWF4TGluZSA9IHRydWU7XG4gICAgICBpZiAobWFya2VyLmNvbGxhcHNlZClcbiAgICAgICAgcmVnQ2hhbmdlKGNtLCBmcm9tLmxpbmUsIHRvLmxpbmUgKyAxKTtcbiAgICAgIGVsc2UgaWYgKG1hcmtlci5jbGFzc05hbWUgfHwgbWFya2VyLnRpdGxlIHx8IG1hcmtlci5zdGFydFN0eWxlIHx8IG1hcmtlci5lbmRTdHlsZSB8fCBtYXJrZXIuY3NzKVxuICAgICAgICBmb3IgKHZhciBpID0gZnJvbS5saW5lOyBpIDw9IHRvLmxpbmU7IGkrKykgcmVnTGluZUNoYW5nZShjbSwgaSwgXCJ0ZXh0XCIpO1xuICAgICAgaWYgKG1hcmtlci5hdG9taWMpIHJlQ2hlY2tTZWxlY3Rpb24oY20uZG9jKTtcbiAgICAgIHNpZ25hbExhdGVyKGNtLCBcIm1hcmtlckFkZGVkXCIsIGNtLCBtYXJrZXIpO1xuICAgIH1cbiAgICByZXR1cm4gbWFya2VyO1xuICB9XG5cbiAgLy8gU0hBUkVEIFRFWFRNQVJLRVJTXG5cbiAgLy8gQSBzaGFyZWQgbWFya2VyIHNwYW5zIG11bHRpcGxlIGxpbmtlZCBkb2N1bWVudHMuIEl0IGlzXG4gIC8vIGltcGxlbWVudGVkIGFzIGEgbWV0YS1tYXJrZXItb2JqZWN0IGNvbnRyb2xsaW5nIG11bHRpcGxlIG5vcm1hbFxuICAvLyBtYXJrZXJzLlxuICB2YXIgU2hhcmVkVGV4dE1hcmtlciA9IENvZGVNaXJyb3IuU2hhcmVkVGV4dE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlcnMsIHByaW1hcnkpIHtcbiAgICB0aGlzLm1hcmtlcnMgPSBtYXJrZXJzO1xuICAgIHRoaXMucHJpbWFyeSA9IHByaW1hcnk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrZXJzLmxlbmd0aDsgKytpKVxuICAgICAgbWFya2Vyc1tpXS5wYXJlbnQgPSB0aGlzO1xuICB9O1xuICBldmVudE1peGluKFNoYXJlZFRleHRNYXJrZXIpO1xuXG4gIFNoYXJlZFRleHRNYXJrZXIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuZXhwbGljaXRseUNsZWFyZWQpIHJldHVybjtcbiAgICB0aGlzLmV4cGxpY2l0bHlDbGVhcmVkID0gdHJ1ZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWFya2Vycy5sZW5ndGg7ICsraSlcbiAgICAgIHRoaXMubWFya2Vyc1tpXS5jbGVhcigpO1xuICAgIHNpZ25hbExhdGVyKHRoaXMsIFwiY2xlYXJcIik7XG4gIH07XG4gIFNoYXJlZFRleHRNYXJrZXIucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihzaWRlLCBsaW5lT2JqKSB7XG4gICAgcmV0dXJuIHRoaXMucHJpbWFyeS5maW5kKHNpZGUsIGxpbmVPYmopO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1hcmtUZXh0U2hhcmVkKGRvYywgZnJvbSwgdG8sIG9wdGlvbnMsIHR5cGUpIHtcbiAgICBvcHRpb25zID0gY29weU9iaihvcHRpb25zKTtcbiAgICBvcHRpb25zLnNoYXJlZCA9IGZhbHNlO1xuICAgIHZhciBtYXJrZXJzID0gW21hcmtUZXh0KGRvYywgZnJvbSwgdG8sIG9wdGlvbnMsIHR5cGUpXSwgcHJpbWFyeSA9IG1hcmtlcnNbMF07XG4gICAgdmFyIHdpZGdldCA9IG9wdGlvbnMud2lkZ2V0Tm9kZTtcbiAgICBsaW5rZWREb2NzKGRvYywgZnVuY3Rpb24oZG9jKSB7XG4gICAgICBpZiAod2lkZ2V0KSBvcHRpb25zLndpZGdldE5vZGUgPSB3aWRnZXQuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgbWFya2Vycy5wdXNoKG1hcmtUZXh0KGRvYywgY2xpcFBvcyhkb2MsIGZyb20pLCBjbGlwUG9zKGRvYywgdG8pLCBvcHRpb25zLCB0eXBlKSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvYy5saW5rZWQubGVuZ3RoOyArK2kpXG4gICAgICAgIGlmIChkb2MubGlua2VkW2ldLmlzUGFyZW50KSByZXR1cm47XG4gICAgICBwcmltYXJ5ID0gbHN0KG1hcmtlcnMpO1xuICAgIH0pO1xuICAgIHJldHVybiBuZXcgU2hhcmVkVGV4dE1hcmtlcihtYXJrZXJzLCBwcmltYXJ5KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmRTaGFyZWRNYXJrZXJzKGRvYykge1xuICAgIHJldHVybiBkb2MuZmluZE1hcmtzKFBvcyhkb2MuZmlyc3QsIDApLCBkb2MuY2xpcFBvcyhQb3MoZG9jLmxhc3RMaW5lKCkpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihtKSB7IHJldHVybiBtLnBhcmVudDsgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBjb3B5U2hhcmVkTWFya2Vycyhkb2MsIG1hcmtlcnMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBtYXJrZXIgPSBtYXJrZXJzW2ldLCBwb3MgPSBtYXJrZXIuZmluZCgpO1xuICAgICAgdmFyIG1Gcm9tID0gZG9jLmNsaXBQb3MocG9zLmZyb20pLCBtVG8gPSBkb2MuY2xpcFBvcyhwb3MudG8pO1xuICAgICAgaWYgKGNtcChtRnJvbSwgbVRvKSkge1xuICAgICAgICB2YXIgc3ViTWFyayA9IG1hcmtUZXh0KGRvYywgbUZyb20sIG1UbywgbWFya2VyLnByaW1hcnksIG1hcmtlci5wcmltYXJ5LnR5cGUpO1xuICAgICAgICBtYXJrZXIubWFya2Vycy5wdXNoKHN1Yk1hcmspO1xuICAgICAgICBzdWJNYXJrLnBhcmVudCA9IG1hcmtlcjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkZXRhY2hTaGFyZWRNYXJrZXJzKG1hcmtlcnMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBtYXJrZXIgPSBtYXJrZXJzW2ldLCBsaW5rZWQgPSBbbWFya2VyLnByaW1hcnkuZG9jXTs7XG4gICAgICBsaW5rZWREb2NzKG1hcmtlci5wcmltYXJ5LmRvYywgZnVuY3Rpb24oZCkgeyBsaW5rZWQucHVzaChkKTsgfSk7XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1hcmtlci5tYXJrZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBzdWJNYXJrZXIgPSBtYXJrZXIubWFya2Vyc1tqXTtcbiAgICAgICAgaWYgKGluZGV4T2YobGlua2VkLCBzdWJNYXJrZXIuZG9jKSA9PSAtMSkge1xuICAgICAgICAgIHN1Yk1hcmtlci5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgIG1hcmtlci5tYXJrZXJzLnNwbGljZShqLS0sIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVEVYVE1BUktFUiBTUEFOU1xuXG4gIGZ1bmN0aW9uIE1hcmtlZFNwYW4obWFya2VyLCBmcm9tLCB0bykge1xuICAgIHRoaXMubWFya2VyID0gbWFya2VyO1xuICAgIHRoaXMuZnJvbSA9IGZyb207IHRoaXMudG8gPSB0bztcbiAgfVxuXG4gIC8vIFNlYXJjaCBhbiBhcnJheSBvZiBzcGFucyBmb3IgYSBzcGFuIG1hdGNoaW5nIHRoZSBnaXZlbiBtYXJrZXIuXG4gIGZ1bmN0aW9uIGdldE1hcmtlZFNwYW5Gb3Ioc3BhbnMsIG1hcmtlcikge1xuICAgIGlmIChzcGFucykgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGFucy5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIHNwYW4gPSBzcGFuc1tpXTtcbiAgICAgIGlmIChzcGFuLm1hcmtlciA9PSBtYXJrZXIpIHJldHVybiBzcGFuO1xuICAgIH1cbiAgfVxuICAvLyBSZW1vdmUgYSBzcGFuIGZyb20gYW4gYXJyYXksIHJldHVybmluZyB1bmRlZmluZWQgaWYgbm8gc3BhbnMgYXJlXG4gIC8vIGxlZnQgKHdlIGRvbid0IHN0b3JlIGFycmF5cyBmb3IgbGluZXMgd2l0aG91dCBzcGFucykuXG4gIGZ1bmN0aW9uIHJlbW92ZU1hcmtlZFNwYW4oc3BhbnMsIHNwYW4pIHtcbiAgICBmb3IgKHZhciByLCBpID0gMDsgaSA8IHNwYW5zLmxlbmd0aDsgKytpKVxuICAgICAgaWYgKHNwYW5zW2ldICE9IHNwYW4pIChyIHx8IChyID0gW10pKS5wdXNoKHNwYW5zW2ldKTtcbiAgICByZXR1cm4gcjtcbiAgfVxuICAvLyBBZGQgYSBzcGFuIHRvIGEgbGluZS5cbiAgZnVuY3Rpb24gYWRkTWFya2VkU3BhbihsaW5lLCBzcGFuKSB7XG4gICAgbGluZS5tYXJrZWRTcGFucyA9IGxpbmUubWFya2VkU3BhbnMgPyBsaW5lLm1hcmtlZFNwYW5zLmNvbmNhdChbc3Bhbl0pIDogW3NwYW5dO1xuICAgIHNwYW4ubWFya2VyLmF0dGFjaExpbmUobGluZSk7XG4gIH1cblxuICAvLyBVc2VkIGZvciB0aGUgYWxnb3JpdGhtIHRoYXQgYWRqdXN0cyBtYXJrZXJzIGZvciBhIGNoYW5nZSBpbiB0aGVcbiAgLy8gZG9jdW1lbnQuIFRoZXNlIGZ1bmN0aW9ucyBjdXQgYW4gYXJyYXkgb2Ygc3BhbnMgYXQgYSBnaXZlblxuICAvLyBjaGFyYWN0ZXIgcG9zaXRpb24sIHJldHVybmluZyBhbiBhcnJheSBvZiByZW1haW5pbmcgY2h1bmtzIChvclxuICAvLyB1bmRlZmluZWQgaWYgbm90aGluZyByZW1haW5zKS5cbiAgZnVuY3Rpb24gbWFya2VkU3BhbnNCZWZvcmUob2xkLCBzdGFydENoLCBpc0luc2VydCkge1xuICAgIGlmIChvbGQpIGZvciAodmFyIGkgPSAwLCBudzsgaSA8IG9sZC5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIHNwYW4gPSBvbGRbaV0sIG1hcmtlciA9IHNwYW4ubWFya2VyO1xuICAgICAgdmFyIHN0YXJ0c0JlZm9yZSA9IHNwYW4uZnJvbSA9PSBudWxsIHx8IChtYXJrZXIuaW5jbHVzaXZlTGVmdCA/IHNwYW4uZnJvbSA8PSBzdGFydENoIDogc3Bhbi5mcm9tIDwgc3RhcnRDaCk7XG4gICAgICBpZiAoc3RhcnRzQmVmb3JlIHx8IHNwYW4uZnJvbSA9PSBzdGFydENoICYmIG1hcmtlci50eXBlID09IFwiYm9va21hcmtcIiAmJiAoIWlzSW5zZXJ0IHx8ICFzcGFuLm1hcmtlci5pbnNlcnRMZWZ0KSkge1xuICAgICAgICB2YXIgZW5kc0FmdGVyID0gc3Bhbi50byA9PSBudWxsIHx8IChtYXJrZXIuaW5jbHVzaXZlUmlnaHQgPyBzcGFuLnRvID49IHN0YXJ0Q2ggOiBzcGFuLnRvID4gc3RhcnRDaCk7XG4gICAgICAgIChudyB8fCAobncgPSBbXSkpLnB1c2gobmV3IE1hcmtlZFNwYW4obWFya2VyLCBzcGFuLmZyb20sIGVuZHNBZnRlciA/IG51bGwgOiBzcGFuLnRvKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudztcbiAgfVxuICBmdW5jdGlvbiBtYXJrZWRTcGFuc0FmdGVyKG9sZCwgZW5kQ2gsIGlzSW5zZXJ0KSB7XG4gICAgaWYgKG9sZCkgZm9yICh2YXIgaSA9IDAsIG53OyBpIDwgb2xkLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgc3BhbiA9IG9sZFtpXSwgbWFya2VyID0gc3Bhbi5tYXJrZXI7XG4gICAgICB2YXIgZW5kc0FmdGVyID0gc3Bhbi50byA9PSBudWxsIHx8IChtYXJrZXIuaW5jbHVzaXZlUmlnaHQgPyBzcGFuLnRvID49IGVuZENoIDogc3Bhbi50byA+IGVuZENoKTtcbiAgICAgIGlmIChlbmRzQWZ0ZXIgfHwgc3Bhbi5mcm9tID09IGVuZENoICYmIG1hcmtlci50eXBlID09IFwiYm9va21hcmtcIiAmJiAoIWlzSW5zZXJ0IHx8IHNwYW4ubWFya2VyLmluc2VydExlZnQpKSB7XG4gICAgICAgIHZhciBzdGFydHNCZWZvcmUgPSBzcGFuLmZyb20gPT0gbnVsbCB8fCAobWFya2VyLmluY2x1c2l2ZUxlZnQgPyBzcGFuLmZyb20gPD0gZW5kQ2ggOiBzcGFuLmZyb20gPCBlbmRDaCk7XG4gICAgICAgIChudyB8fCAobncgPSBbXSkpLnB1c2gobmV3IE1hcmtlZFNwYW4obWFya2VyLCBzdGFydHNCZWZvcmUgPyBudWxsIDogc3Bhbi5mcm9tIC0gZW5kQ2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbi50byA9PSBudWxsID8gbnVsbCA6IHNwYW4udG8gLSBlbmRDaCkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnc7XG4gIH1cblxuICAvLyBHaXZlbiBhIGNoYW5nZSBvYmplY3QsIGNvbXB1dGUgdGhlIG5ldyBzZXQgb2YgbWFya2VyIHNwYW5zIHRoYXRcbiAgLy8gY292ZXIgdGhlIGxpbmUgaW4gd2hpY2ggdGhlIGNoYW5nZSB0b29rIHBsYWNlLiBSZW1vdmVzIHNwYW5zXG4gIC8vIGVudGlyZWx5IHdpdGhpbiB0aGUgY2hhbmdlLCByZWNvbm5lY3RzIHNwYW5zIGJlbG9uZ2luZyB0byB0aGVcbiAgLy8gc2FtZSBtYXJrZXIgdGhhdCBhcHBlYXIgb24gYm90aCBzaWRlcyBvZiB0aGUgY2hhbmdlLCBhbmQgY3V0cyBvZmZcbiAgLy8gc3BhbnMgcGFydGlhbGx5IHdpdGhpbiB0aGUgY2hhbmdlLiBSZXR1cm5zIGFuIGFycmF5IG9mIHNwYW5cbiAgLy8gYXJyYXlzIHdpdGggb25lIGVsZW1lbnQgZm9yIGVhY2ggbGluZSBpbiAoYWZ0ZXIpIHRoZSBjaGFuZ2UuXG4gIGZ1bmN0aW9uIHN0cmV0Y2hTcGFuc092ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UpIHtcbiAgICBpZiAoY2hhbmdlLmZ1bGwpIHJldHVybiBudWxsO1xuICAgIHZhciBvbGRGaXJzdCA9IGlzTGluZShkb2MsIGNoYW5nZS5mcm9tLmxpbmUpICYmIGdldExpbmUoZG9jLCBjaGFuZ2UuZnJvbS5saW5lKS5tYXJrZWRTcGFucztcbiAgICB2YXIgb2xkTGFzdCA9IGlzTGluZShkb2MsIGNoYW5nZS50by5saW5lKSAmJiBnZXRMaW5lKGRvYywgY2hhbmdlLnRvLmxpbmUpLm1hcmtlZFNwYW5zO1xuICAgIGlmICghb2xkRmlyc3QgJiYgIW9sZExhc3QpIHJldHVybiBudWxsO1xuXG4gICAgdmFyIHN0YXJ0Q2ggPSBjaGFuZ2UuZnJvbS5jaCwgZW5kQ2ggPSBjaGFuZ2UudG8uY2gsIGlzSW5zZXJ0ID0gY21wKGNoYW5nZS5mcm9tLCBjaGFuZ2UudG8pID09IDA7XG4gICAgLy8gR2V0IHRoZSBzcGFucyB0aGF0ICdzdGljayBvdXQnIG9uIGJvdGggc2lkZXNcbiAgICB2YXIgZmlyc3QgPSBtYXJrZWRTcGFuc0JlZm9yZShvbGRGaXJzdCwgc3RhcnRDaCwgaXNJbnNlcnQpO1xuICAgIHZhciBsYXN0ID0gbWFya2VkU3BhbnNBZnRlcihvbGRMYXN0LCBlbmRDaCwgaXNJbnNlcnQpO1xuXG4gICAgLy8gTmV4dCwgbWVyZ2UgdGhvc2UgdHdvIGVuZHNcbiAgICB2YXIgc2FtZUxpbmUgPSBjaGFuZ2UudGV4dC5sZW5ndGggPT0gMSwgb2Zmc2V0ID0gbHN0KGNoYW5nZS50ZXh0KS5sZW5ndGggKyAoc2FtZUxpbmUgPyBzdGFydENoIDogMCk7XG4gICAgaWYgKGZpcnN0KSB7XG4gICAgICAvLyBGaXggdXAgLnRvIHByb3BlcnRpZXMgb2YgZmlyc3RcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlyc3QubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIHNwYW4gPSBmaXJzdFtpXTtcbiAgICAgICAgaWYgKHNwYW4udG8gPT0gbnVsbCkge1xuICAgICAgICAgIHZhciBmb3VuZCA9IGdldE1hcmtlZFNwYW5Gb3IobGFzdCwgc3Bhbi5tYXJrZXIpO1xuICAgICAgICAgIGlmICghZm91bmQpIHNwYW4udG8gPSBzdGFydENoO1xuICAgICAgICAgIGVsc2UgaWYgKHNhbWVMaW5lKSBzcGFuLnRvID0gZm91bmQudG8gPT0gbnVsbCA/IG51bGwgOiBmb3VuZC50byArIG9mZnNldDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAobGFzdCkge1xuICAgICAgLy8gRml4IHVwIC5mcm9tIGluIGxhc3QgKG9yIG1vdmUgdGhlbSBpbnRvIGZpcnN0IGluIGNhc2Ugb2Ygc2FtZUxpbmUpXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhc3QubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIHNwYW4gPSBsYXN0W2ldO1xuICAgICAgICBpZiAoc3Bhbi50byAhPSBudWxsKSBzcGFuLnRvICs9IG9mZnNldDtcbiAgICAgICAgaWYgKHNwYW4uZnJvbSA9PSBudWxsKSB7XG4gICAgICAgICAgdmFyIGZvdW5kID0gZ2V0TWFya2VkU3BhbkZvcihmaXJzdCwgc3Bhbi5tYXJrZXIpO1xuICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgIHNwYW4uZnJvbSA9IG9mZnNldDtcbiAgICAgICAgICAgIGlmIChzYW1lTGluZSkgKGZpcnN0IHx8IChmaXJzdCA9IFtdKSkucHVzaChzcGFuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3Bhbi5mcm9tICs9IG9mZnNldDtcbiAgICAgICAgICBpZiAoc2FtZUxpbmUpIChmaXJzdCB8fCAoZmlyc3QgPSBbXSkpLnB1c2goc3Bhbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy8gTWFrZSBzdXJlIHdlIGRpZG4ndCBjcmVhdGUgYW55IHplcm8tbGVuZ3RoIHNwYW5zXG4gICAgaWYgKGZpcnN0KSBmaXJzdCA9IGNsZWFyRW1wdHlTcGFucyhmaXJzdCk7XG4gICAgaWYgKGxhc3QgJiYgbGFzdCAhPSBmaXJzdCkgbGFzdCA9IGNsZWFyRW1wdHlTcGFucyhsYXN0KTtcblxuICAgIHZhciBuZXdNYXJrZXJzID0gW2ZpcnN0XTtcbiAgICBpZiAoIXNhbWVMaW5lKSB7XG4gICAgICAvLyBGaWxsIGdhcCB3aXRoIHdob2xlLWxpbmUtc3BhbnNcbiAgICAgIHZhciBnYXAgPSBjaGFuZ2UudGV4dC5sZW5ndGggLSAyLCBnYXBNYXJrZXJzO1xuICAgICAgaWYgKGdhcCA+IDAgJiYgZmlyc3QpXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlyc3QubGVuZ3RoOyArK2kpXG4gICAgICAgICAgaWYgKGZpcnN0W2ldLnRvID09IG51bGwpXG4gICAgICAgICAgICAoZ2FwTWFya2VycyB8fCAoZ2FwTWFya2VycyA9IFtdKSkucHVzaChuZXcgTWFya2VkU3BhbihmaXJzdFtpXS5tYXJrZXIsIG51bGwsIG51bGwpKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FwOyArK2kpXG4gICAgICAgIG5ld01hcmtlcnMucHVzaChnYXBNYXJrZXJzKTtcbiAgICAgIG5ld01hcmtlcnMucHVzaChsYXN0KTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld01hcmtlcnM7XG4gIH1cblxuICAvLyBSZW1vdmUgc3BhbnMgdGhhdCBhcmUgZW1wdHkgYW5kIGRvbid0IGhhdmUgYSBjbGVhcldoZW5FbXB0eVxuICAvLyBvcHRpb24gb2YgZmFsc2UuXG4gIGZ1bmN0aW9uIGNsZWFyRW1wdHlTcGFucyhzcGFucykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BhbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBzcGFuID0gc3BhbnNbaV07XG4gICAgICBpZiAoc3Bhbi5mcm9tICE9IG51bGwgJiYgc3Bhbi5mcm9tID09IHNwYW4udG8gJiYgc3Bhbi5tYXJrZXIuY2xlYXJXaGVuRW1wdHkgIT09IGZhbHNlKVxuICAgICAgICBzcGFucy5zcGxpY2UoaS0tLCAxKTtcbiAgICB9XG4gICAgaWYgKCFzcGFucy5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgIHJldHVybiBzcGFucztcbiAgfVxuXG4gIC8vIFVzZWQgZm9yIHVuL3JlLWRvaW5nIGNoYW5nZXMgZnJvbSB0aGUgaGlzdG9yeS4gQ29tYmluZXMgdGhlXG4gIC8vIHJlc3VsdCBvZiBjb21wdXRpbmcgdGhlIGV4aXN0aW5nIHNwYW5zIHdpdGggdGhlIHNldCBvZiBzcGFucyB0aGF0XG4gIC8vIGV4aXN0ZWQgaW4gdGhlIGhpc3RvcnkgKHNvIHRoYXQgZGVsZXRpbmcgYXJvdW5kIGEgc3BhbiBhbmQgdGhlblxuICAvLyB1bmRvaW5nIGJyaW5ncyBiYWNrIHRoZSBzcGFuKS5cbiAgZnVuY3Rpb24gbWVyZ2VPbGRTcGFucyhkb2MsIGNoYW5nZSkge1xuICAgIHZhciBvbGQgPSBnZXRPbGRTcGFucyhkb2MsIGNoYW5nZSk7XG4gICAgdmFyIHN0cmV0Y2hlZCA9IHN0cmV0Y2hTcGFuc092ZXJDaGFuZ2UoZG9jLCBjaGFuZ2UpO1xuICAgIGlmICghb2xkKSByZXR1cm4gc3RyZXRjaGVkO1xuICAgIGlmICghc3RyZXRjaGVkKSByZXR1cm4gb2xkO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvbGQubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBvbGRDdXIgPSBvbGRbaV0sIHN0cmV0Y2hDdXIgPSBzdHJldGNoZWRbaV07XG4gICAgICBpZiAob2xkQ3VyICYmIHN0cmV0Y2hDdXIpIHtcbiAgICAgICAgc3BhbnM6IGZvciAodmFyIGogPSAwOyBqIDwgc3RyZXRjaEN1ci5sZW5ndGg7ICsraikge1xuICAgICAgICAgIHZhciBzcGFuID0gc3RyZXRjaEN1cltqXTtcbiAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IG9sZEN1ci5sZW5ndGg7ICsraylcbiAgICAgICAgICAgIGlmIChvbGRDdXJba10ubWFya2VyID09IHNwYW4ubWFya2VyKSBjb250aW51ZSBzcGFucztcbiAgICAgICAgICBvbGRDdXIucHVzaChzcGFuKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzdHJldGNoQ3VyKSB7XG4gICAgICAgIG9sZFtpXSA9IHN0cmV0Y2hDdXI7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvbGQ7XG4gIH1cblxuICAvLyBVc2VkIHRvICdjbGlwJyBvdXQgcmVhZE9ubHkgcmFuZ2VzIHdoZW4gbWFraW5nIGEgY2hhbmdlLlxuICBmdW5jdGlvbiByZW1vdmVSZWFkT25seVJhbmdlcyhkb2MsIGZyb20sIHRvKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBudWxsO1xuICAgIGRvYy5pdGVyKGZyb20ubGluZSwgdG8ubGluZSArIDEsIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIGlmIChsaW5lLm1hcmtlZFNwYW5zKSBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmUubWFya2VkU3BhbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIG1hcmsgPSBsaW5lLm1hcmtlZFNwYW5zW2ldLm1hcmtlcjtcbiAgICAgICAgaWYgKG1hcmsucmVhZE9ubHkgJiYgKCFtYXJrZXJzIHx8IGluZGV4T2YobWFya2VycywgbWFyaykgPT0gLTEpKVxuICAgICAgICAgIChtYXJrZXJzIHx8IChtYXJrZXJzID0gW10pKS5wdXNoKG1hcmspO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICghbWFya2VycykgcmV0dXJuIG51bGw7XG4gICAgdmFyIHBhcnRzID0gW3tmcm9tOiBmcm9tLCB0bzogdG99XTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBtayA9IG1hcmtlcnNbaV0sIG0gPSBtay5maW5kKDApO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwYXJ0cy5sZW5ndGg7ICsraikge1xuICAgICAgICB2YXIgcCA9IHBhcnRzW2pdO1xuICAgICAgICBpZiAoY21wKHAudG8sIG0uZnJvbSkgPCAwIHx8IGNtcChwLmZyb20sIG0udG8pID4gMCkgY29udGludWU7XG4gICAgICAgIHZhciBuZXdQYXJ0cyA9IFtqLCAxXSwgZGZyb20gPSBjbXAocC5mcm9tLCBtLmZyb20pLCBkdG8gPSBjbXAocC50bywgbS50byk7XG4gICAgICAgIGlmIChkZnJvbSA8IDAgfHwgIW1rLmluY2x1c2l2ZUxlZnQgJiYgIWRmcm9tKVxuICAgICAgICAgIG5ld1BhcnRzLnB1c2goe2Zyb206IHAuZnJvbSwgdG86IG0uZnJvbX0pO1xuICAgICAgICBpZiAoZHRvID4gMCB8fCAhbWsuaW5jbHVzaXZlUmlnaHQgJiYgIWR0bylcbiAgICAgICAgICBuZXdQYXJ0cy5wdXNoKHtmcm9tOiBtLnRvLCB0bzogcC50b30pO1xuICAgICAgICBwYXJ0cy5zcGxpY2UuYXBwbHkocGFydHMsIG5ld1BhcnRzKTtcbiAgICAgICAgaiArPSBuZXdQYXJ0cy5sZW5ndGggLSAxO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcGFydHM7XG4gIH1cblxuICAvLyBDb25uZWN0IG9yIGRpc2Nvbm5lY3Qgc3BhbnMgZnJvbSBhIGxpbmUuXG4gIGZ1bmN0aW9uIGRldGFjaE1hcmtlZFNwYW5zKGxpbmUpIHtcbiAgICB2YXIgc3BhbnMgPSBsaW5lLm1hcmtlZFNwYW5zO1xuICAgIGlmICghc3BhbnMpIHJldHVybjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwYW5zLmxlbmd0aDsgKytpKVxuICAgICAgc3BhbnNbaV0ubWFya2VyLmRldGFjaExpbmUobGluZSk7XG4gICAgbGluZS5tYXJrZWRTcGFucyA9IG51bGw7XG4gIH1cbiAgZnVuY3Rpb24gYXR0YWNoTWFya2VkU3BhbnMobGluZSwgc3BhbnMpIHtcbiAgICBpZiAoIXNwYW5zKSByZXR1cm47XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGFucy5sZW5ndGg7ICsraSlcbiAgICAgIHNwYW5zW2ldLm1hcmtlci5hdHRhY2hMaW5lKGxpbmUpO1xuICAgIGxpbmUubWFya2VkU3BhbnMgPSBzcGFucztcbiAgfVxuXG4gIC8vIEhlbHBlcnMgdXNlZCB3aGVuIGNvbXB1dGluZyB3aGljaCBvdmVybGFwcGluZyBjb2xsYXBzZWQgc3BhblxuICAvLyBjb3VudHMgYXMgdGhlIGxhcmdlciBvbmUuXG4gIGZ1bmN0aW9uIGV4dHJhTGVmdChtYXJrZXIpIHsgcmV0dXJuIG1hcmtlci5pbmNsdXNpdmVMZWZ0ID8gLTEgOiAwOyB9XG4gIGZ1bmN0aW9uIGV4dHJhUmlnaHQobWFya2VyKSB7IHJldHVybiBtYXJrZXIuaW5jbHVzaXZlUmlnaHQgPyAxIDogMDsgfVxuXG4gIC8vIFJldHVybnMgYSBudW1iZXIgaW5kaWNhdGluZyB3aGljaCBvZiB0d28gb3ZlcmxhcHBpbmcgY29sbGFwc2VkXG4gIC8vIHNwYW5zIGlzIGxhcmdlciAoYW5kIHRodXMgaW5jbHVkZXMgdGhlIG90aGVyKS4gRmFsbHMgYmFjayB0b1xuICAvLyBjb21wYXJpbmcgaWRzIHdoZW4gdGhlIHNwYW5zIGNvdmVyIGV4YWN0bHkgdGhlIHNhbWUgcmFuZ2UuXG4gIGZ1bmN0aW9uIGNvbXBhcmVDb2xsYXBzZWRNYXJrZXJzKGEsIGIpIHtcbiAgICB2YXIgbGVuRGlmZiA9IGEubGluZXMubGVuZ3RoIC0gYi5saW5lcy5sZW5ndGg7XG4gICAgaWYgKGxlbkRpZmYgIT0gMCkgcmV0dXJuIGxlbkRpZmY7XG4gICAgdmFyIGFQb3MgPSBhLmZpbmQoKSwgYlBvcyA9IGIuZmluZCgpO1xuICAgIHZhciBmcm9tQ21wID0gY21wKGFQb3MuZnJvbSwgYlBvcy5mcm9tKSB8fCBleHRyYUxlZnQoYSkgLSBleHRyYUxlZnQoYik7XG4gICAgaWYgKGZyb21DbXApIHJldHVybiAtZnJvbUNtcDtcbiAgICB2YXIgdG9DbXAgPSBjbXAoYVBvcy50bywgYlBvcy50bykgfHwgZXh0cmFSaWdodChhKSAtIGV4dHJhUmlnaHQoYik7XG4gICAgaWYgKHRvQ21wKSByZXR1cm4gdG9DbXA7XG4gICAgcmV0dXJuIGIuaWQgLSBhLmlkO1xuICB9XG5cbiAgLy8gRmluZCBvdXQgd2hldGhlciBhIGxpbmUgZW5kcyBvciBzdGFydHMgaW4gYSBjb2xsYXBzZWQgc3Bhbi4gSWZcbiAgLy8gc28sIHJldHVybiB0aGUgbWFya2VyIGZvciB0aGF0IHNwYW4uXG4gIGZ1bmN0aW9uIGNvbGxhcHNlZFNwYW5BdFNpZGUobGluZSwgc3RhcnQpIHtcbiAgICB2YXIgc3BzID0gc2F3Q29sbGFwc2VkU3BhbnMgJiYgbGluZS5tYXJrZWRTcGFucywgZm91bmQ7XG4gICAgaWYgKHNwcykgZm9yICh2YXIgc3AsIGkgPSAwOyBpIDwgc3BzLmxlbmd0aDsgKytpKSB7XG4gICAgICBzcCA9IHNwc1tpXTtcbiAgICAgIGlmIChzcC5tYXJrZXIuY29sbGFwc2VkICYmIChzdGFydCA/IHNwLmZyb20gOiBzcC50bykgPT0gbnVsbCAmJlxuICAgICAgICAgICghZm91bmQgfHwgY29tcGFyZUNvbGxhcHNlZE1hcmtlcnMoZm91bmQsIHNwLm1hcmtlcikgPCAwKSlcbiAgICAgICAgZm91bmQgPSBzcC5tYXJrZXI7XG4gICAgfVxuICAgIHJldHVybiBmb3VuZDtcbiAgfVxuICBmdW5jdGlvbiBjb2xsYXBzZWRTcGFuQXRTdGFydChsaW5lKSB7IHJldHVybiBjb2xsYXBzZWRTcGFuQXRTaWRlKGxpbmUsIHRydWUpOyB9XG4gIGZ1bmN0aW9uIGNvbGxhcHNlZFNwYW5BdEVuZChsaW5lKSB7IHJldHVybiBjb2xsYXBzZWRTcGFuQXRTaWRlKGxpbmUsIGZhbHNlKTsgfVxuXG4gIC8vIFRlc3Qgd2hldGhlciB0aGVyZSBleGlzdHMgYSBjb2xsYXBzZWQgc3BhbiB0aGF0IHBhcnRpYWxseVxuICAvLyBvdmVybGFwcyAoY292ZXJzIHRoZSBzdGFydCBvciBlbmQsIGJ1dCBub3QgYm90aCkgb2YgYSBuZXcgc3Bhbi5cbiAgLy8gU3VjaCBvdmVybGFwIGlzIG5vdCBhbGxvd2VkLlxuICBmdW5jdGlvbiBjb25mbGljdGluZ0NvbGxhcHNlZFJhbmdlKGRvYywgbGluZU5vLCBmcm9tLCB0bywgbWFya2VyKSB7XG4gICAgdmFyIGxpbmUgPSBnZXRMaW5lKGRvYywgbGluZU5vKTtcbiAgICB2YXIgc3BzID0gc2F3Q29sbGFwc2VkU3BhbnMgJiYgbGluZS5tYXJrZWRTcGFucztcbiAgICBpZiAoc3BzKSBmb3IgKHZhciBpID0gMDsgaSA8IHNwcy5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIHNwID0gc3BzW2ldO1xuICAgICAgaWYgKCFzcC5tYXJrZXIuY29sbGFwc2VkKSBjb250aW51ZTtcbiAgICAgIHZhciBmb3VuZCA9IHNwLm1hcmtlci5maW5kKDApO1xuICAgICAgdmFyIGZyb21DbXAgPSBjbXAoZm91bmQuZnJvbSwgZnJvbSkgfHwgZXh0cmFMZWZ0KHNwLm1hcmtlcikgLSBleHRyYUxlZnQobWFya2VyKTtcbiAgICAgIHZhciB0b0NtcCA9IGNtcChmb3VuZC50bywgdG8pIHx8IGV4dHJhUmlnaHQoc3AubWFya2VyKSAtIGV4dHJhUmlnaHQobWFya2VyKTtcbiAgICAgIGlmIChmcm9tQ21wID49IDAgJiYgdG9DbXAgPD0gMCB8fCBmcm9tQ21wIDw9IDAgJiYgdG9DbXAgPj0gMCkgY29udGludWU7XG4gICAgICBpZiAoZnJvbUNtcCA8PSAwICYmIChjbXAoZm91bmQudG8sIGZyb20pID4gMCB8fCAoc3AubWFya2VyLmluY2x1c2l2ZVJpZ2h0ICYmIG1hcmtlci5pbmNsdXNpdmVMZWZ0KSkgfHxcbiAgICAgICAgICBmcm9tQ21wID49IDAgJiYgKGNtcChmb3VuZC5mcm9tLCB0bykgPCAwIHx8IChzcC5tYXJrZXIuaW5jbHVzaXZlTGVmdCAmJiBtYXJrZXIuaW5jbHVzaXZlUmlnaHQpKSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgLy8gQSB2aXN1YWwgbGluZSBpcyBhIGxpbmUgYXMgZHJhd24gb24gdGhlIHNjcmVlbi4gRm9sZGluZywgZm9yXG4gIC8vIGV4YW1wbGUsIGNhbiBjYXVzZSBtdWx0aXBsZSBsb2dpY2FsIGxpbmVzIHRvIGFwcGVhciBvbiB0aGUgc2FtZVxuICAvLyB2aXN1YWwgbGluZS4gVGhpcyBmaW5kcyB0aGUgc3RhcnQgb2YgdGhlIHZpc3VhbCBsaW5lIHRoYXQgdGhlXG4gIC8vIGdpdmVuIGxpbmUgaXMgcGFydCBvZiAodXN1YWxseSB0aGF0IGlzIHRoZSBsaW5lIGl0c2VsZikuXG4gIGZ1bmN0aW9uIHZpc3VhbExpbmUobGluZSkge1xuICAgIHZhciBtZXJnZWQ7XG4gICAgd2hpbGUgKG1lcmdlZCA9IGNvbGxhcHNlZFNwYW5BdFN0YXJ0KGxpbmUpKVxuICAgICAgbGluZSA9IG1lcmdlZC5maW5kKC0xLCB0cnVlKS5saW5lO1xuICAgIHJldHVybiBsaW5lO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhbiBhcnJheSBvZiBsb2dpY2FsIGxpbmVzIHRoYXQgY29udGludWUgdGhlIHZpc3VhbCBsaW5lXG4gIC8vIHN0YXJ0ZWQgYnkgdGhlIGFyZ3VtZW50LCBvciB1bmRlZmluZWQgaWYgdGhlcmUgYXJlIG5vIHN1Y2ggbGluZXMuXG4gIGZ1bmN0aW9uIHZpc3VhbExpbmVDb250aW51ZWQobGluZSkge1xuICAgIHZhciBtZXJnZWQsIGxpbmVzO1xuICAgIHdoaWxlIChtZXJnZWQgPSBjb2xsYXBzZWRTcGFuQXRFbmQobGluZSkpIHtcbiAgICAgIGxpbmUgPSBtZXJnZWQuZmluZCgxLCB0cnVlKS5saW5lO1xuICAgICAgKGxpbmVzIHx8IChsaW5lcyA9IFtdKSkucHVzaChsaW5lKTtcbiAgICB9XG4gICAgcmV0dXJuIGxpbmVzO1xuICB9XG5cbiAgLy8gR2V0IHRoZSBsaW5lIG51bWJlciBvZiB0aGUgc3RhcnQgb2YgdGhlIHZpc3VhbCBsaW5lIHRoYXQgdGhlXG4gIC8vIGdpdmVuIGxpbmUgbnVtYmVyIGlzIHBhcnQgb2YuXG4gIGZ1bmN0aW9uIHZpc3VhbExpbmVObyhkb2MsIGxpbmVOKSB7XG4gICAgdmFyIGxpbmUgPSBnZXRMaW5lKGRvYywgbGluZU4pLCB2aXMgPSB2aXN1YWxMaW5lKGxpbmUpO1xuICAgIGlmIChsaW5lID09IHZpcykgcmV0dXJuIGxpbmVOO1xuICAgIHJldHVybiBsaW5lTm8odmlzKTtcbiAgfVxuICAvLyBHZXQgdGhlIGxpbmUgbnVtYmVyIG9mIHRoZSBzdGFydCBvZiB0aGUgbmV4dCB2aXN1YWwgbGluZSBhZnRlclxuICAvLyB0aGUgZ2l2ZW4gbGluZS5cbiAgZnVuY3Rpb24gdmlzdWFsTGluZUVuZE5vKGRvYywgbGluZU4pIHtcbiAgICBpZiAobGluZU4gPiBkb2MubGFzdExpbmUoKSkgcmV0dXJuIGxpbmVOO1xuICAgIHZhciBsaW5lID0gZ2V0TGluZShkb2MsIGxpbmVOKSwgbWVyZ2VkO1xuICAgIGlmICghbGluZUlzSGlkZGVuKGRvYywgbGluZSkpIHJldHVybiBsaW5lTjtcbiAgICB3aGlsZSAobWVyZ2VkID0gY29sbGFwc2VkU3BhbkF0RW5kKGxpbmUpKVxuICAgICAgbGluZSA9IG1lcmdlZC5maW5kKDEsIHRydWUpLmxpbmU7XG4gICAgcmV0dXJuIGxpbmVObyhsaW5lKSArIDE7XG4gIH1cblxuICAvLyBDb21wdXRlIHdoZXRoZXIgYSBsaW5lIGlzIGhpZGRlbi4gTGluZXMgY291bnQgYXMgaGlkZGVuIHdoZW4gdGhleVxuICAvLyBhcmUgcGFydCBvZiBhIHZpc3VhbCBsaW5lIHRoYXQgc3RhcnRzIHdpdGggYW5vdGhlciBsaW5lLCBvciB3aGVuXG4gIC8vIHRoZXkgYXJlIGVudGlyZWx5IGNvdmVyZWQgYnkgY29sbGFwc2VkLCBub24td2lkZ2V0IHNwYW4uXG4gIGZ1bmN0aW9uIGxpbmVJc0hpZGRlbihkb2MsIGxpbmUpIHtcbiAgICB2YXIgc3BzID0gc2F3Q29sbGFwc2VkU3BhbnMgJiYgbGluZS5tYXJrZWRTcGFucztcbiAgICBpZiAoc3BzKSBmb3IgKHZhciBzcCwgaSA9IDA7IGkgPCBzcHMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHNwID0gc3BzW2ldO1xuICAgICAgaWYgKCFzcC5tYXJrZXIuY29sbGFwc2VkKSBjb250aW51ZTtcbiAgICAgIGlmIChzcC5mcm9tID09IG51bGwpIHJldHVybiB0cnVlO1xuICAgICAgaWYgKHNwLm1hcmtlci53aWRnZXROb2RlKSBjb250aW51ZTtcbiAgICAgIGlmIChzcC5mcm9tID09IDAgJiYgc3AubWFya2VyLmluY2x1c2l2ZUxlZnQgJiYgbGluZUlzSGlkZGVuSW5uZXIoZG9jLCBsaW5lLCBzcCkpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBsaW5lSXNIaWRkZW5Jbm5lcihkb2MsIGxpbmUsIHNwYW4pIHtcbiAgICBpZiAoc3Bhbi50byA9PSBudWxsKSB7XG4gICAgICB2YXIgZW5kID0gc3Bhbi5tYXJrZXIuZmluZCgxLCB0cnVlKTtcbiAgICAgIHJldHVybiBsaW5lSXNIaWRkZW5Jbm5lcihkb2MsIGVuZC5saW5lLCBnZXRNYXJrZWRTcGFuRm9yKGVuZC5saW5lLm1hcmtlZFNwYW5zLCBzcGFuLm1hcmtlcikpO1xuICAgIH1cbiAgICBpZiAoc3Bhbi5tYXJrZXIuaW5jbHVzaXZlUmlnaHQgJiYgc3Bhbi50byA9PSBsaW5lLnRleHQubGVuZ3RoKVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgZm9yICh2YXIgc3AsIGkgPSAwOyBpIDwgbGluZS5tYXJrZWRTcGFucy5sZW5ndGg7ICsraSkge1xuICAgICAgc3AgPSBsaW5lLm1hcmtlZFNwYW5zW2ldO1xuICAgICAgaWYgKHNwLm1hcmtlci5jb2xsYXBzZWQgJiYgIXNwLm1hcmtlci53aWRnZXROb2RlICYmIHNwLmZyb20gPT0gc3Bhbi50byAmJlxuICAgICAgICAgIChzcC50byA9PSBudWxsIHx8IHNwLnRvICE9IHNwYW4uZnJvbSkgJiZcbiAgICAgICAgICAoc3AubWFya2VyLmluY2x1c2l2ZUxlZnQgfHwgc3Bhbi5tYXJrZXIuaW5jbHVzaXZlUmlnaHQpICYmXG4gICAgICAgICAgbGluZUlzSGlkZGVuSW5uZXIoZG9jLCBsaW5lLCBzcCkpIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8vIExJTkUgV0lER0VUU1xuXG4gIC8vIExpbmUgd2lkZ2V0cyBhcmUgYmxvY2sgZWxlbWVudHMgZGlzcGxheWVkIGFib3ZlIG9yIGJlbG93IGEgbGluZS5cblxuICB2YXIgTGluZVdpZGdldCA9IENvZGVNaXJyb3IuTGluZVdpZGdldCA9IGZ1bmN0aW9uKGRvYywgbm9kZSwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zKSBmb3IgKHZhciBvcHQgaW4gb3B0aW9ucykgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkob3B0KSlcbiAgICAgIHRoaXNbb3B0XSA9IG9wdGlvbnNbb3B0XTtcbiAgICB0aGlzLmRvYyA9IGRvYztcbiAgICB0aGlzLm5vZGUgPSBub2RlO1xuICB9O1xuICBldmVudE1peGluKExpbmVXaWRnZXQpO1xuXG4gIGZ1bmN0aW9uIGFkanVzdFNjcm9sbFdoZW5BYm92ZVZpc2libGUoY20sIGxpbmUsIGRpZmYpIHtcbiAgICBpZiAoaGVpZ2h0QXRMaW5lKGxpbmUpIDwgKChjbS5jdXJPcCAmJiBjbS5jdXJPcC5zY3JvbGxUb3ApIHx8IGNtLmRvYy5zY3JvbGxUb3ApKVxuICAgICAgYWRkVG9TY3JvbGxQb3MoY20sIG51bGwsIGRpZmYpO1xuICB9XG5cbiAgTGluZVdpZGdldC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY20gPSB0aGlzLmRvYy5jbSwgd3MgPSB0aGlzLmxpbmUud2lkZ2V0cywgbGluZSA9IHRoaXMubGluZSwgbm8gPSBsaW5lTm8obGluZSk7XG4gICAgaWYgKG5vID09IG51bGwgfHwgIXdzKSByZXR1cm47XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3cy5sZW5ndGg7ICsraSkgaWYgKHdzW2ldID09IHRoaXMpIHdzLnNwbGljZShpLS0sIDEpO1xuICAgIGlmICghd3MubGVuZ3RoKSBsaW5lLndpZGdldHMgPSBudWxsO1xuICAgIHZhciBoZWlnaHQgPSB3aWRnZXRIZWlnaHQodGhpcyk7XG4gICAgdXBkYXRlTGluZUhlaWdodChsaW5lLCBNYXRoLm1heCgwLCBsaW5lLmhlaWdodCAtIGhlaWdodCkpO1xuICAgIGlmIChjbSkgcnVuSW5PcChjbSwgZnVuY3Rpb24oKSB7XG4gICAgICBhZGp1c3RTY3JvbGxXaGVuQWJvdmVWaXNpYmxlKGNtLCBsaW5lLCAtaGVpZ2h0KTtcbiAgICAgIHJlZ0xpbmVDaGFuZ2UoY20sIG5vLCBcIndpZGdldFwiKTtcbiAgICB9KTtcbiAgfTtcbiAgTGluZVdpZGdldC5wcm90b3R5cGUuY2hhbmdlZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBvbGRIID0gdGhpcy5oZWlnaHQsIGNtID0gdGhpcy5kb2MuY20sIGxpbmUgPSB0aGlzLmxpbmU7XG4gICAgdGhpcy5oZWlnaHQgPSBudWxsO1xuICAgIHZhciBkaWZmID0gd2lkZ2V0SGVpZ2h0KHRoaXMpIC0gb2xkSDtcbiAgICBpZiAoIWRpZmYpIHJldHVybjtcbiAgICB1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsIGxpbmUuaGVpZ2h0ICsgZGlmZik7XG4gICAgaWYgKGNtKSBydW5Jbk9wKGNtLCBmdW5jdGlvbigpIHtcbiAgICAgIGNtLmN1ck9wLmZvcmNlVXBkYXRlID0gdHJ1ZTtcbiAgICAgIGFkanVzdFNjcm9sbFdoZW5BYm92ZVZpc2libGUoY20sIGxpbmUsIGRpZmYpO1xuICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHdpZGdldEhlaWdodCh3aWRnZXQpIHtcbiAgICBpZiAod2lkZ2V0LmhlaWdodCAhPSBudWxsKSByZXR1cm4gd2lkZ2V0LmhlaWdodDtcbiAgICB2YXIgY20gPSB3aWRnZXQuZG9jLmNtO1xuICAgIGlmICghY20pIHJldHVybiAwO1xuICAgIGlmICghY29udGFpbnMoZG9jdW1lbnQuYm9keSwgd2lkZ2V0Lm5vZGUpKSB7XG4gICAgICB2YXIgcGFyZW50U3R5bGUgPSBcInBvc2l0aW9uOiByZWxhdGl2ZTtcIjtcbiAgICAgIGlmICh3aWRnZXQuY292ZXJHdXR0ZXIpXG4gICAgICAgIHBhcmVudFN0eWxlICs9IFwibWFyZ2luLWxlZnQ6IC1cIiArIGNtLmRpc3BsYXkuZ3V0dGVycy5vZmZzZXRXaWR0aCArIFwicHg7XCI7XG4gICAgICBpZiAod2lkZ2V0Lm5vSFNjcm9sbClcbiAgICAgICAgcGFyZW50U3R5bGUgKz0gXCJ3aWR0aDogXCIgKyBjbS5kaXNwbGF5LndyYXBwZXIuY2xpZW50V2lkdGggKyBcInB4O1wiO1xuICAgICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQoY20uZGlzcGxheS5tZWFzdXJlLCBlbHQoXCJkaXZcIiwgW3dpZGdldC5ub2RlXSwgbnVsbCwgcGFyZW50U3R5bGUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHdpZGdldC5oZWlnaHQgPSB3aWRnZXQubm9kZS5vZmZzZXRIZWlnaHQ7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRMaW5lV2lkZ2V0KGRvYywgaGFuZGxlLCBub2RlLCBvcHRpb25zKSB7XG4gICAgdmFyIHdpZGdldCA9IG5ldyBMaW5lV2lkZ2V0KGRvYywgbm9kZSwgb3B0aW9ucyk7XG4gICAgdmFyIGNtID0gZG9jLmNtO1xuICAgIGlmIChjbSAmJiB3aWRnZXQubm9IU2Nyb2xsKSBjbS5kaXNwbGF5LmFsaWduV2lkZ2V0cyA9IHRydWU7XG4gICAgY2hhbmdlTGluZShkb2MsIGhhbmRsZSwgXCJ3aWRnZXRcIiwgZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHdpZGdldHMgPSBsaW5lLndpZGdldHMgfHwgKGxpbmUud2lkZ2V0cyA9IFtdKTtcbiAgICAgIGlmICh3aWRnZXQuaW5zZXJ0QXQgPT0gbnVsbCkgd2lkZ2V0cy5wdXNoKHdpZGdldCk7XG4gICAgICBlbHNlIHdpZGdldHMuc3BsaWNlKE1hdGgubWluKHdpZGdldHMubGVuZ3RoIC0gMSwgTWF0aC5tYXgoMCwgd2lkZ2V0Lmluc2VydEF0KSksIDAsIHdpZGdldCk7XG4gICAgICB3aWRnZXQubGluZSA9IGxpbmU7XG4gICAgICBpZiAoY20gJiYgIWxpbmVJc0hpZGRlbihkb2MsIGxpbmUpKSB7XG4gICAgICAgIHZhciBhYm92ZVZpc2libGUgPSBoZWlnaHRBdExpbmUobGluZSkgPCBkb2Muc2Nyb2xsVG9wO1xuICAgICAgICB1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsIGxpbmUuaGVpZ2h0ICsgd2lkZ2V0SGVpZ2h0KHdpZGdldCkpO1xuICAgICAgICBpZiAoYWJvdmVWaXNpYmxlKSBhZGRUb1Njcm9sbFBvcyhjbSwgbnVsbCwgd2lkZ2V0LmhlaWdodCk7XG4gICAgICAgIGNtLmN1ck9wLmZvcmNlVXBkYXRlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiB3aWRnZXQ7XG4gIH1cblxuICAvLyBMSU5FIERBVEEgU1RSVUNUVVJFXG5cbiAgLy8gTGluZSBvYmplY3RzLiBUaGVzZSBob2xkIHN0YXRlIHJlbGF0ZWQgdG8gYSBsaW5lLCBpbmNsdWRpbmdcbiAgLy8gaGlnaGxpZ2h0aW5nIGluZm8gKHRoZSBzdHlsZXMgYXJyYXkpLlxuICB2YXIgTGluZSA9IENvZGVNaXJyb3IuTGluZSA9IGZ1bmN0aW9uKHRleHQsIG1hcmtlZFNwYW5zLCBlc3RpbWF0ZUhlaWdodCkge1xuICAgIHRoaXMudGV4dCA9IHRleHQ7XG4gICAgYXR0YWNoTWFya2VkU3BhbnModGhpcywgbWFya2VkU3BhbnMpO1xuICAgIHRoaXMuaGVpZ2h0ID0gZXN0aW1hdGVIZWlnaHQgPyBlc3RpbWF0ZUhlaWdodCh0aGlzKSA6IDE7XG4gIH07XG4gIGV2ZW50TWl4aW4oTGluZSk7XG4gIExpbmUucHJvdG90eXBlLmxpbmVObyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gbGluZU5vKHRoaXMpOyB9O1xuXG4gIC8vIENoYW5nZSB0aGUgY29udGVudCAodGV4dCwgbWFya2Vycykgb2YgYSBsaW5lLiBBdXRvbWF0aWNhbGx5XG4gIC8vIGludmFsaWRhdGVzIGNhY2hlZCBpbmZvcm1hdGlvbiBhbmQgdHJpZXMgdG8gcmUtZXN0aW1hdGUgdGhlXG4gIC8vIGxpbmUncyBoZWlnaHQuXG4gIGZ1bmN0aW9uIHVwZGF0ZUxpbmUobGluZSwgdGV4dCwgbWFya2VkU3BhbnMsIGVzdGltYXRlSGVpZ2h0KSB7XG4gICAgbGluZS50ZXh0ID0gdGV4dDtcbiAgICBpZiAobGluZS5zdGF0ZUFmdGVyKSBsaW5lLnN0YXRlQWZ0ZXIgPSBudWxsO1xuICAgIGlmIChsaW5lLnN0eWxlcykgbGluZS5zdHlsZXMgPSBudWxsO1xuICAgIGlmIChsaW5lLm9yZGVyICE9IG51bGwpIGxpbmUub3JkZXIgPSBudWxsO1xuICAgIGRldGFjaE1hcmtlZFNwYW5zKGxpbmUpO1xuICAgIGF0dGFjaE1hcmtlZFNwYW5zKGxpbmUsIG1hcmtlZFNwYW5zKTtcbiAgICB2YXIgZXN0SGVpZ2h0ID0gZXN0aW1hdGVIZWlnaHQgPyBlc3RpbWF0ZUhlaWdodChsaW5lKSA6IDE7XG4gICAgaWYgKGVzdEhlaWdodCAhPSBsaW5lLmhlaWdodCkgdXBkYXRlTGluZUhlaWdodChsaW5lLCBlc3RIZWlnaHQpO1xuICB9XG5cbiAgLy8gRGV0YWNoIGEgbGluZSBmcm9tIHRoZSBkb2N1bWVudCB0cmVlIGFuZCBpdHMgbWFya2Vycy5cbiAgZnVuY3Rpb24gY2xlYW5VcExpbmUobGluZSkge1xuICAgIGxpbmUucGFyZW50ID0gbnVsbDtcbiAgICBkZXRhY2hNYXJrZWRTcGFucyhsaW5lKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGV4dHJhY3RMaW5lQ2xhc3Nlcyh0eXBlLCBvdXRwdXQpIHtcbiAgICBpZiAodHlwZSkgZm9yICg7Oykge1xuICAgICAgdmFyIGxpbmVDbGFzcyA9IHR5cGUubWF0Y2goLyg/Ol58XFxzKylsaW5lLShiYWNrZ3JvdW5kLSk/KFxcUyspLyk7XG4gICAgICBpZiAoIWxpbmVDbGFzcykgYnJlYWs7XG4gICAgICB0eXBlID0gdHlwZS5zbGljZSgwLCBsaW5lQ2xhc3MuaW5kZXgpICsgdHlwZS5zbGljZShsaW5lQ2xhc3MuaW5kZXggKyBsaW5lQ2xhc3NbMF0ubGVuZ3RoKTtcbiAgICAgIHZhciBwcm9wID0gbGluZUNsYXNzWzFdID8gXCJiZ0NsYXNzXCIgOiBcInRleHRDbGFzc1wiO1xuICAgICAgaWYgKG91dHB1dFtwcm9wXSA9PSBudWxsKVxuICAgICAgICBvdXRwdXRbcHJvcF0gPSBsaW5lQ2xhc3NbMl07XG4gICAgICBlbHNlIGlmICghKG5ldyBSZWdFeHAoXCIoPzpefFxccylcIiArIGxpbmVDbGFzc1syXSArIFwiKD86JHxcXHMpXCIpKS50ZXN0KG91dHB1dFtwcm9wXSkpXG4gICAgICAgIG91dHB1dFtwcm9wXSArPSBcIiBcIiArIGxpbmVDbGFzc1syXTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICBmdW5jdGlvbiBjYWxsQmxhbmtMaW5lKG1vZGUsIHN0YXRlKSB7XG4gICAgaWYgKG1vZGUuYmxhbmtMaW5lKSByZXR1cm4gbW9kZS5ibGFua0xpbmUoc3RhdGUpO1xuICAgIGlmICghbW9kZS5pbm5lck1vZGUpIHJldHVybjtcbiAgICB2YXIgaW5uZXIgPSBDb2RlTWlycm9yLmlubmVyTW9kZShtb2RlLCBzdGF0ZSk7XG4gICAgaWYgKGlubmVyLm1vZGUuYmxhbmtMaW5lKSByZXR1cm4gaW5uZXIubW9kZS5ibGFua0xpbmUoaW5uZXIuc3RhdGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVhZFRva2VuKG1vZGUsIHN0cmVhbSwgc3RhdGUsIGlubmVyKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBpZiAoaW5uZXIpIGlubmVyWzBdID0gQ29kZU1pcnJvci5pbm5lck1vZGUobW9kZSwgc3RhdGUpLm1vZGU7XG4gICAgICB2YXIgc3R5bGUgPSBtb2RlLnRva2VuKHN0cmVhbSwgc3RhdGUpO1xuICAgICAgaWYgKHN0cmVhbS5wb3MgPiBzdHJlYW0uc3RhcnQpIHJldHVybiBzdHlsZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTW9kZSBcIiArIG1vZGUubmFtZSArIFwiIGZhaWxlZCB0byBhZHZhbmNlIHN0cmVhbS5cIik7XG4gIH1cblxuICAvLyBVdGlsaXR5IGZvciBnZXRUb2tlbkF0IGFuZCBnZXRMaW5lVG9rZW5zXG4gIGZ1bmN0aW9uIHRha2VUb2tlbihjbSwgcG9zLCBwcmVjaXNlLCBhc0FycmF5KSB7XG4gICAgZnVuY3Rpb24gZ2V0T2JqKGNvcHkpIHtcbiAgICAgIHJldHVybiB7c3RhcnQ6IHN0cmVhbS5zdGFydCwgZW5kOiBzdHJlYW0ucG9zLFxuICAgICAgICAgICAgICBzdHJpbmc6IHN0cmVhbS5jdXJyZW50KCksXG4gICAgICAgICAgICAgIHR5cGU6IHN0eWxlIHx8IG51bGwsXG4gICAgICAgICAgICAgIHN0YXRlOiBjb3B5ID8gY29weVN0YXRlKGRvYy5tb2RlLCBzdGF0ZSkgOiBzdGF0ZX07XG4gICAgfVxuXG4gICAgdmFyIGRvYyA9IGNtLmRvYywgbW9kZSA9IGRvYy5tb2RlLCBzdHlsZTtcbiAgICBwb3MgPSBjbGlwUG9zKGRvYywgcG9zKTtcbiAgICB2YXIgbGluZSA9IGdldExpbmUoZG9jLCBwb3MubGluZSksIHN0YXRlID0gZ2V0U3RhdGVCZWZvcmUoY20sIHBvcy5saW5lLCBwcmVjaXNlKTtcbiAgICB2YXIgc3RyZWFtID0gbmV3IFN0cmluZ1N0cmVhbShsaW5lLnRleHQsIGNtLm9wdGlvbnMudGFiU2l6ZSksIHRva2VucztcbiAgICBpZiAoYXNBcnJheSkgdG9rZW5zID0gW107XG4gICAgd2hpbGUgKChhc0FycmF5IHx8IHN0cmVhbS5wb3MgPCBwb3MuY2gpICYmICFzdHJlYW0uZW9sKCkpIHtcbiAgICAgIHN0cmVhbS5zdGFydCA9IHN0cmVhbS5wb3M7XG4gICAgICBzdHlsZSA9IHJlYWRUb2tlbihtb2RlLCBzdHJlYW0sIHN0YXRlKTtcbiAgICAgIGlmIChhc0FycmF5KSB0b2tlbnMucHVzaChnZXRPYmoodHJ1ZSkpO1xuICAgIH1cbiAgICByZXR1cm4gYXNBcnJheSA/IHRva2VucyA6IGdldE9iaigpO1xuICB9XG5cbiAgLy8gUnVuIHRoZSBnaXZlbiBtb2RlJ3MgcGFyc2VyIG92ZXIgYSBsaW5lLCBjYWxsaW5nIGYgZm9yIGVhY2ggdG9rZW4uXG4gIGZ1bmN0aW9uIHJ1bk1vZGUoY20sIHRleHQsIG1vZGUsIHN0YXRlLCBmLCBsaW5lQ2xhc3NlcywgZm9yY2VUb0VuZCkge1xuICAgIHZhciBmbGF0dGVuU3BhbnMgPSBtb2RlLmZsYXR0ZW5TcGFucztcbiAgICBpZiAoZmxhdHRlblNwYW5zID09IG51bGwpIGZsYXR0ZW5TcGFucyA9IGNtLm9wdGlvbnMuZmxhdHRlblNwYW5zO1xuICAgIHZhciBjdXJTdGFydCA9IDAsIGN1clN0eWxlID0gbnVsbDtcbiAgICB2YXIgc3RyZWFtID0gbmV3IFN0cmluZ1N0cmVhbSh0ZXh0LCBjbS5vcHRpb25zLnRhYlNpemUpLCBzdHlsZTtcbiAgICB2YXIgaW5uZXIgPSBjbS5vcHRpb25zLmFkZE1vZGVDbGFzcyAmJiBbbnVsbF07XG4gICAgaWYgKHRleHQgPT0gXCJcIikgZXh0cmFjdExpbmVDbGFzc2VzKGNhbGxCbGFua0xpbmUobW9kZSwgc3RhdGUpLCBsaW5lQ2xhc3Nlcyk7XG4gICAgd2hpbGUgKCFzdHJlYW0uZW9sKCkpIHtcbiAgICAgIGlmIChzdHJlYW0ucG9zID4gY20ub3B0aW9ucy5tYXhIaWdobGlnaHRMZW5ndGgpIHtcbiAgICAgICAgZmxhdHRlblNwYW5zID0gZmFsc2U7XG4gICAgICAgIGlmIChmb3JjZVRvRW5kKSBwcm9jZXNzTGluZShjbSwgdGV4dCwgc3RhdGUsIHN0cmVhbS5wb3MpO1xuICAgICAgICBzdHJlYW0ucG9zID0gdGV4dC5sZW5ndGg7XG4gICAgICAgIHN0eWxlID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0eWxlID0gZXh0cmFjdExpbmVDbGFzc2VzKHJlYWRUb2tlbihtb2RlLCBzdHJlYW0sIHN0YXRlLCBpbm5lciksIGxpbmVDbGFzc2VzKTtcbiAgICAgIH1cbiAgICAgIGlmIChpbm5lcikge1xuICAgICAgICB2YXIgbU5hbWUgPSBpbm5lclswXS5uYW1lO1xuICAgICAgICBpZiAobU5hbWUpIHN0eWxlID0gXCJtLVwiICsgKHN0eWxlID8gbU5hbWUgKyBcIiBcIiArIHN0eWxlIDogbU5hbWUpO1xuICAgICAgfVxuICAgICAgaWYgKCFmbGF0dGVuU3BhbnMgfHwgY3VyU3R5bGUgIT0gc3R5bGUpIHtcbiAgICAgICAgd2hpbGUgKGN1clN0YXJ0IDwgc3RyZWFtLnN0YXJ0KSB7XG4gICAgICAgICAgY3VyU3RhcnQgPSBNYXRoLm1pbihzdHJlYW0uc3RhcnQsIGN1clN0YXJ0ICsgNTAwMDApO1xuICAgICAgICAgIGYoY3VyU3RhcnQsIGN1clN0eWxlKTtcbiAgICAgICAgfVxuICAgICAgICBjdXJTdHlsZSA9IHN0eWxlO1xuICAgICAgfVxuICAgICAgc3RyZWFtLnN0YXJ0ID0gc3RyZWFtLnBvcztcbiAgICB9XG4gICAgd2hpbGUgKGN1clN0YXJ0IDwgc3RyZWFtLnBvcykge1xuICAgICAgLy8gV2Via2l0IHNlZW1zIHRvIHJlZnVzZSB0byByZW5kZXIgdGV4dCBub2RlcyBsb25nZXIgdGhhbiA1NzQ0NCBjaGFyYWN0ZXJzXG4gICAgICB2YXIgcG9zID0gTWF0aC5taW4oc3RyZWFtLnBvcywgY3VyU3RhcnQgKyA1MDAwMCk7XG4gICAgICBmKHBvcywgY3VyU3R5bGUpO1xuICAgICAgY3VyU3RhcnQgPSBwb3M7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29tcHV0ZSBhIHN0eWxlIGFycmF5IChhbiBhcnJheSBzdGFydGluZyB3aXRoIGEgbW9kZSBnZW5lcmF0aW9uXG4gIC8vIC0tIGZvciBpbnZhbGlkYXRpb24gLS0gZm9sbG93ZWQgYnkgcGFpcnMgb2YgZW5kIHBvc2l0aW9ucyBhbmRcbiAgLy8gc3R5bGUgc3RyaW5ncyksIHdoaWNoIGlzIHVzZWQgdG8gaGlnaGxpZ2h0IHRoZSB0b2tlbnMgb24gdGhlXG4gIC8vIGxpbmUuXG4gIGZ1bmN0aW9uIGhpZ2hsaWdodExpbmUoY20sIGxpbmUsIHN0YXRlLCBmb3JjZVRvRW5kKSB7XG4gICAgLy8gQSBzdHlsZXMgYXJyYXkgYWx3YXlzIHN0YXJ0cyB3aXRoIGEgbnVtYmVyIGlkZW50aWZ5aW5nIHRoZVxuICAgIC8vIG1vZGUvb3ZlcmxheXMgdGhhdCBpdCBpcyBiYXNlZCBvbiAoZm9yIGVhc3kgaW52YWxpZGF0aW9uKS5cbiAgICB2YXIgc3QgPSBbY20uc3RhdGUubW9kZUdlbl0sIGxpbmVDbGFzc2VzID0ge307XG4gICAgLy8gQ29tcHV0ZSB0aGUgYmFzZSBhcnJheSBvZiBzdHlsZXNcbiAgICBydW5Nb2RlKGNtLCBsaW5lLnRleHQsIGNtLmRvYy5tb2RlLCBzdGF0ZSwgZnVuY3Rpb24oZW5kLCBzdHlsZSkge1xuICAgICAgc3QucHVzaChlbmQsIHN0eWxlKTtcbiAgICB9LCBsaW5lQ2xhc3NlcywgZm9yY2VUb0VuZCk7XG5cbiAgICAvLyBSdW4gb3ZlcmxheXMsIGFkanVzdCBzdHlsZSBhcnJheS5cbiAgICBmb3IgKHZhciBvID0gMDsgbyA8IGNtLnN0YXRlLm92ZXJsYXlzLmxlbmd0aDsgKytvKSB7XG4gICAgICB2YXIgb3ZlcmxheSA9IGNtLnN0YXRlLm92ZXJsYXlzW29dLCBpID0gMSwgYXQgPSAwO1xuICAgICAgcnVuTW9kZShjbSwgbGluZS50ZXh0LCBvdmVybGF5Lm1vZGUsIHRydWUsIGZ1bmN0aW9uKGVuZCwgc3R5bGUpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gaTtcbiAgICAgICAgLy8gRW5zdXJlIHRoZXJlJ3MgYSB0b2tlbiBlbmQgYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24sIGFuZCB0aGF0IGkgcG9pbnRzIGF0IGl0XG4gICAgICAgIHdoaWxlIChhdCA8IGVuZCkge1xuICAgICAgICAgIHZhciBpX2VuZCA9IHN0W2ldO1xuICAgICAgICAgIGlmIChpX2VuZCA+IGVuZClcbiAgICAgICAgICAgIHN0LnNwbGljZShpLCAxLCBlbmQsIHN0W2krMV0sIGlfZW5kKTtcbiAgICAgICAgICBpICs9IDI7XG4gICAgICAgICAgYXQgPSBNYXRoLm1pbihlbmQsIGlfZW5kKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0eWxlKSByZXR1cm47XG4gICAgICAgIGlmIChvdmVybGF5Lm9wYXF1ZSkge1xuICAgICAgICAgIHN0LnNwbGljZShzdGFydCwgaSAtIHN0YXJ0LCBlbmQsIFwiY20tb3ZlcmxheSBcIiArIHN0eWxlKTtcbiAgICAgICAgICBpID0gc3RhcnQgKyAyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvciAoOyBzdGFydCA8IGk7IHN0YXJ0ICs9IDIpIHtcbiAgICAgICAgICAgIHZhciBjdXIgPSBzdFtzdGFydCsxXTtcbiAgICAgICAgICAgIHN0W3N0YXJ0KzFdID0gKGN1ciA/IGN1ciArIFwiIFwiIDogXCJcIikgKyBcImNtLW92ZXJsYXkgXCIgKyBzdHlsZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIGxpbmVDbGFzc2VzKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge3N0eWxlczogc3QsIGNsYXNzZXM6IGxpbmVDbGFzc2VzLmJnQ2xhc3MgfHwgbGluZUNsYXNzZXMudGV4dENsYXNzID8gbGluZUNsYXNzZXMgOiBudWxsfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldExpbmVTdHlsZXMoY20sIGxpbmUsIHVwZGF0ZUZyb250aWVyKSB7XG4gICAgaWYgKCFsaW5lLnN0eWxlcyB8fCBsaW5lLnN0eWxlc1swXSAhPSBjbS5zdGF0ZS5tb2RlR2VuKSB7XG4gICAgICB2YXIgc3RhdGUgPSBnZXRTdGF0ZUJlZm9yZShjbSwgbGluZU5vKGxpbmUpKTtcbiAgICAgIHZhciByZXN1bHQgPSBoaWdobGlnaHRMaW5lKGNtLCBsaW5lLCBsaW5lLnRleHQubGVuZ3RoID4gY20ub3B0aW9ucy5tYXhIaWdobGlnaHRMZW5ndGggPyBjb3B5U3RhdGUoY20uZG9jLm1vZGUsIHN0YXRlKSA6IHN0YXRlKTtcbiAgICAgIGxpbmUuc3RhdGVBZnRlciA9IHN0YXRlO1xuICAgICAgbGluZS5zdHlsZXMgPSByZXN1bHQuc3R5bGVzO1xuICAgICAgaWYgKHJlc3VsdC5jbGFzc2VzKSBsaW5lLnN0eWxlQ2xhc3NlcyA9IHJlc3VsdC5jbGFzc2VzO1xuICAgICAgZWxzZSBpZiAobGluZS5zdHlsZUNsYXNzZXMpIGxpbmUuc3R5bGVDbGFzc2VzID0gbnVsbDtcbiAgICAgIGlmICh1cGRhdGVGcm9udGllciA9PT0gY20uZG9jLmZyb250aWVyKSBjbS5kb2MuZnJvbnRpZXIrKztcbiAgICB9XG4gICAgcmV0dXJuIGxpbmUuc3R5bGVzO1xuICB9XG5cbiAgLy8gTGlnaHR3ZWlnaHQgZm9ybSBvZiBoaWdobGlnaHQgLS0gcHJvY2VlZCBvdmVyIHRoaXMgbGluZSBhbmRcbiAgLy8gdXBkYXRlIHN0YXRlLCBidXQgZG9uJ3Qgc2F2ZSBhIHN0eWxlIGFycmF5LiBVc2VkIGZvciBsaW5lcyB0aGF0XG4gIC8vIGFyZW4ndCBjdXJyZW50bHkgdmlzaWJsZS5cbiAgZnVuY3Rpb24gcHJvY2Vzc0xpbmUoY20sIHRleHQsIHN0YXRlLCBzdGFydEF0KSB7XG4gICAgdmFyIG1vZGUgPSBjbS5kb2MubW9kZTtcbiAgICB2YXIgc3RyZWFtID0gbmV3IFN0cmluZ1N0cmVhbSh0ZXh0LCBjbS5vcHRpb25zLnRhYlNpemUpO1xuICAgIHN0cmVhbS5zdGFydCA9IHN0cmVhbS5wb3MgPSBzdGFydEF0IHx8IDA7XG4gICAgaWYgKHRleHQgPT0gXCJcIikgY2FsbEJsYW5rTGluZShtb2RlLCBzdGF0ZSk7XG4gICAgd2hpbGUgKCFzdHJlYW0uZW9sKCkpIHtcbiAgICAgIHJlYWRUb2tlbihtb2RlLCBzdHJlYW0sIHN0YXRlKTtcbiAgICAgIHN0cmVhbS5zdGFydCA9IHN0cmVhbS5wb3M7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29udmVydCBhIHN0eWxlIGFzIHJldHVybmVkIGJ5IGEgbW9kZSAoZWl0aGVyIG51bGwsIG9yIGEgc3RyaW5nXG4gIC8vIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgc3R5bGVzKSB0byBhIENTUyBzdHlsZS4gVGhpcyBpcyBjYWNoZWQsXG4gIC8vIGFuZCBhbHNvIGxvb2tzIGZvciBsaW5lLXdpZGUgc3R5bGVzLlxuICB2YXIgc3R5bGVUb0NsYXNzQ2FjaGUgPSB7fSwgc3R5bGVUb0NsYXNzQ2FjaGVXaXRoTW9kZSA9IHt9O1xuICBmdW5jdGlvbiBpbnRlcnByZXRUb2tlblN0eWxlKHN0eWxlLCBvcHRpb25zKSB7XG4gICAgaWYgKCFzdHlsZSB8fCAvXlxccyokLy50ZXN0KHN0eWxlKSkgcmV0dXJuIG51bGw7XG4gICAgdmFyIGNhY2hlID0gb3B0aW9ucy5hZGRNb2RlQ2xhc3MgPyBzdHlsZVRvQ2xhc3NDYWNoZVdpdGhNb2RlIDogc3R5bGVUb0NsYXNzQ2FjaGU7XG4gICAgcmV0dXJuIGNhY2hlW3N0eWxlXSB8fFxuICAgICAgKGNhY2hlW3N0eWxlXSA9IHN0eWxlLnJlcGxhY2UoL1xcUysvZywgXCJjbS0kJlwiKSk7XG4gIH1cblxuICAvLyBSZW5kZXIgdGhlIERPTSByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGV4dCBvZiBhIGxpbmUuIEFsc28gYnVpbGRzXG4gIC8vIHVwIGEgJ2xpbmUgbWFwJywgd2hpY2ggcG9pbnRzIGF0IHRoZSBET00gbm9kZXMgdGhhdCByZXByZXNlbnRcbiAgLy8gc3BlY2lmaWMgc3RyZXRjaGVzIG9mIHRleHQsIGFuZCBpcyB1c2VkIGJ5IHRoZSBtZWFzdXJpbmcgY29kZS5cbiAgLy8gVGhlIHJldHVybmVkIG9iamVjdCBjb250YWlucyB0aGUgRE9NIG5vZGUsIHRoaXMgbWFwLCBhbmRcbiAgLy8gaW5mb3JtYXRpb24gYWJvdXQgbGluZS13aWRlIHN0eWxlcyB0aGF0IHdlcmUgc2V0IGJ5IHRoZSBtb2RlLlxuICBmdW5jdGlvbiBidWlsZExpbmVDb250ZW50KGNtLCBsaW5lVmlldykge1xuICAgIC8vIFRoZSBwYWRkaW5nLXJpZ2h0IGZvcmNlcyB0aGUgZWxlbWVudCB0byBoYXZlIGEgJ2JvcmRlcicsIHdoaWNoXG4gICAgLy8gaXMgbmVlZGVkIG9uIFdlYmtpdCB0byBiZSBhYmxlIHRvIGdldCBsaW5lLWxldmVsIGJvdW5kaW5nXG4gICAgLy8gcmVjdGFuZ2xlcyBmb3IgaXQgKGluIG1lYXN1cmVDaGFyKS5cbiAgICB2YXIgY29udGVudCA9IGVsdChcInNwYW5cIiwgbnVsbCwgbnVsbCwgd2Via2l0ID8gXCJwYWRkaW5nLXJpZ2h0OiAuMXB4XCIgOiBudWxsKTtcbiAgICB2YXIgYnVpbGRlciA9IHtwcmU6IGVsdChcInByZVwiLCBbY29udGVudF0sIFwiQ29kZU1pcnJvci1saW5lXCIpLCBjb250ZW50OiBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgIGNvbDogMCwgcG9zOiAwLCBjbTogY20sXG4gICAgICAgICAgICAgICAgICAgc3BsaXRTcGFjZXM6IChpZSB8fCB3ZWJraXQpICYmIGNtLmdldE9wdGlvbihcImxpbmVXcmFwcGluZ1wiKX07XG4gICAgbGluZVZpZXcubWVhc3VyZSA9IHt9O1xuXG4gICAgLy8gSXRlcmF0ZSBvdmVyIHRoZSBsb2dpY2FsIGxpbmVzIHRoYXQgbWFrZSB1cCB0aGlzIHZpc3VhbCBsaW5lLlxuICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IChsaW5lVmlldy5yZXN0ID8gbGluZVZpZXcucmVzdC5sZW5ndGggOiAwKTsgaSsrKSB7XG4gICAgICB2YXIgbGluZSA9IGkgPyBsaW5lVmlldy5yZXN0W2kgLSAxXSA6IGxpbmVWaWV3LmxpbmUsIG9yZGVyO1xuICAgICAgYnVpbGRlci5wb3MgPSAwO1xuICAgICAgYnVpbGRlci5hZGRUb2tlbiA9IGJ1aWxkVG9rZW47XG4gICAgICAvLyBPcHRpb25hbGx5IHdpcmUgaW4gc29tZSBoYWNrcyBpbnRvIHRoZSB0b2tlbi1yZW5kZXJpbmdcbiAgICAgIC8vIGFsZ29yaXRobSwgdG8gZGVhbCB3aXRoIGJyb3dzZXIgcXVpcmtzLlxuICAgICAgaWYgKGhhc0JhZEJpZGlSZWN0cyhjbS5kaXNwbGF5Lm1lYXN1cmUpICYmIChvcmRlciA9IGdldE9yZGVyKGxpbmUpKSlcbiAgICAgICAgYnVpbGRlci5hZGRUb2tlbiA9IGJ1aWxkVG9rZW5CYWRCaWRpKGJ1aWxkZXIuYWRkVG9rZW4sIG9yZGVyKTtcbiAgICAgIGJ1aWxkZXIubWFwID0gW107XG4gICAgICB2YXIgYWxsb3dGcm9udGllclVwZGF0ZSA9IGxpbmVWaWV3ICE9IGNtLmRpc3BsYXkuZXh0ZXJuYWxNZWFzdXJlZCAmJiBsaW5lTm8obGluZSk7XG4gICAgICBpbnNlcnRMaW5lQ29udGVudChsaW5lLCBidWlsZGVyLCBnZXRMaW5lU3R5bGVzKGNtLCBsaW5lLCBhbGxvd0Zyb250aWVyVXBkYXRlKSk7XG4gICAgICBpZiAobGluZS5zdHlsZUNsYXNzZXMpIHtcbiAgICAgICAgaWYgKGxpbmUuc3R5bGVDbGFzc2VzLmJnQ2xhc3MpXG4gICAgICAgICAgYnVpbGRlci5iZ0NsYXNzID0gam9pbkNsYXNzZXMobGluZS5zdHlsZUNsYXNzZXMuYmdDbGFzcywgYnVpbGRlci5iZ0NsYXNzIHx8IFwiXCIpO1xuICAgICAgICBpZiAobGluZS5zdHlsZUNsYXNzZXMudGV4dENsYXNzKVxuICAgICAgICAgIGJ1aWxkZXIudGV4dENsYXNzID0gam9pbkNsYXNzZXMobGluZS5zdHlsZUNsYXNzZXMudGV4dENsYXNzLCBidWlsZGVyLnRleHRDbGFzcyB8fCBcIlwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIGF0IGxlYXN0IGEgc2luZ2xlIG5vZGUgaXMgcHJlc2VudCwgZm9yIG1lYXN1cmluZy5cbiAgICAgIGlmIChidWlsZGVyLm1hcC5sZW5ndGggPT0gMClcbiAgICAgICAgYnVpbGRlci5tYXAucHVzaCgwLCAwLCBidWlsZGVyLmNvbnRlbnQuYXBwZW5kQ2hpbGQoemVyb1dpZHRoRWxlbWVudChjbS5kaXNwbGF5Lm1lYXN1cmUpKSk7XG5cbiAgICAgIC8vIFN0b3JlIHRoZSBtYXAgYW5kIGEgY2FjaGUgb2JqZWN0IGZvciB0aGUgY3VycmVudCBsb2dpY2FsIGxpbmVcbiAgICAgIGlmIChpID09IDApIHtcbiAgICAgICAgbGluZVZpZXcubWVhc3VyZS5tYXAgPSBidWlsZGVyLm1hcDtcbiAgICAgICAgbGluZVZpZXcubWVhc3VyZS5jYWNoZSA9IHt9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgKGxpbmVWaWV3Lm1lYXN1cmUubWFwcyB8fCAobGluZVZpZXcubWVhc3VyZS5tYXBzID0gW10pKS5wdXNoKGJ1aWxkZXIubWFwKTtcbiAgICAgICAgKGxpbmVWaWV3Lm1lYXN1cmUuY2FjaGVzIHx8IChsaW5lVmlldy5tZWFzdXJlLmNhY2hlcyA9IFtdKSkucHVzaCh7fSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2VlIGlzc3VlICMyOTAxXG4gICAgaWYgKHdlYmtpdCAmJiAvXFxiY20tdGFiXFxiLy50ZXN0KGJ1aWxkZXIuY29udGVudC5sYXN0Q2hpbGQuY2xhc3NOYW1lKSlcbiAgICAgIGJ1aWxkZXIuY29udGVudC5jbGFzc05hbWUgPSBcImNtLXRhYi13cmFwLWhhY2tcIjtcblxuICAgIHNpZ25hbChjbSwgXCJyZW5kZXJMaW5lXCIsIGNtLCBsaW5lVmlldy5saW5lLCBidWlsZGVyLnByZSk7XG4gICAgaWYgKGJ1aWxkZXIucHJlLmNsYXNzTmFtZSlcbiAgICAgIGJ1aWxkZXIudGV4dENsYXNzID0gam9pbkNsYXNzZXMoYnVpbGRlci5wcmUuY2xhc3NOYW1lLCBidWlsZGVyLnRleHRDbGFzcyB8fCBcIlwiKTtcblxuICAgIHJldHVybiBidWlsZGVyO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVmYXVsdFNwZWNpYWxDaGFyUGxhY2Vob2xkZXIoY2gpIHtcbiAgICB2YXIgdG9rZW4gPSBlbHQoXCJzcGFuXCIsIFwiXFx1MjAyMlwiLCBcImNtLWludmFsaWRjaGFyXCIpO1xuICAgIHRva2VuLnRpdGxlID0gXCJcXFxcdVwiICsgY2guY2hhckNvZGVBdCgwKS50b1N0cmluZygxNik7XG4gICAgdG9rZW4uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB0b2tlbi50aXRsZSk7XG4gICAgcmV0dXJuIHRva2VuO1xuICB9XG5cbiAgLy8gQnVpbGQgdXAgdGhlIERPTSByZXByZXNlbnRhdGlvbiBmb3IgYSBzaW5nbGUgdG9rZW4sIGFuZCBhZGQgaXQgdG9cbiAgLy8gdGhlIGxpbmUgbWFwLiBUYWtlcyBjYXJlIHRvIHJlbmRlciBzcGVjaWFsIGNoYXJhY3RlcnMgc2VwYXJhdGVseS5cbiAgZnVuY3Rpb24gYnVpbGRUb2tlbihidWlsZGVyLCB0ZXh0LCBzdHlsZSwgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIHRpdGxlLCBjc3MpIHtcbiAgICBpZiAoIXRleHQpIHJldHVybjtcbiAgICB2YXIgZGlzcGxheVRleHQgPSBidWlsZGVyLnNwbGl0U3BhY2VzID8gdGV4dC5yZXBsYWNlKC8gezMsfS9nLCBzcGxpdFNwYWNlcykgOiB0ZXh0O1xuICAgIHZhciBzcGVjaWFsID0gYnVpbGRlci5jbS5zdGF0ZS5zcGVjaWFsQ2hhcnMsIG11c3RXcmFwID0gZmFsc2U7XG4gICAgaWYgKCFzcGVjaWFsLnRlc3QodGV4dCkpIHtcbiAgICAgIGJ1aWxkZXIuY29sICs9IHRleHQubGVuZ3RoO1xuICAgICAgdmFyIGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkaXNwbGF5VGV4dCk7XG4gICAgICBidWlsZGVyLm1hcC5wdXNoKGJ1aWxkZXIucG9zLCBidWlsZGVyLnBvcyArIHRleHQubGVuZ3RoLCBjb250ZW50KTtcbiAgICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgOSkgbXVzdFdyYXAgPSB0cnVlO1xuICAgICAgYnVpbGRlci5wb3MgKz0gdGV4dC5sZW5ndGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLCBwb3MgPSAwO1xuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgc3BlY2lhbC5sYXN0SW5kZXggPSBwb3M7XG4gICAgICAgIHZhciBtID0gc3BlY2lhbC5leGVjKHRleHQpO1xuICAgICAgICB2YXIgc2tpcHBlZCA9IG0gPyBtLmluZGV4IC0gcG9zIDogdGV4dC5sZW5ndGggLSBwb3M7XG4gICAgICAgIGlmIChza2lwcGVkKSB7XG4gICAgICAgICAgdmFyIHR4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRpc3BsYXlUZXh0LnNsaWNlKHBvcywgcG9zICsgc2tpcHBlZCkpO1xuICAgICAgICAgIGlmIChpZSAmJiBpZV92ZXJzaW9uIDwgOSkgY29udGVudC5hcHBlbmRDaGlsZChlbHQoXCJzcGFuXCIsIFt0eHRdKSk7XG4gICAgICAgICAgZWxzZSBjb250ZW50LmFwcGVuZENoaWxkKHR4dCk7XG4gICAgICAgICAgYnVpbGRlci5tYXAucHVzaChidWlsZGVyLnBvcywgYnVpbGRlci5wb3MgKyBza2lwcGVkLCB0eHQpO1xuICAgICAgICAgIGJ1aWxkZXIuY29sICs9IHNraXBwZWQ7XG4gICAgICAgICAgYnVpbGRlci5wb3MgKz0gc2tpcHBlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW0pIGJyZWFrO1xuICAgICAgICBwb3MgKz0gc2tpcHBlZCArIDE7XG4gICAgICAgIGlmIChtWzBdID09IFwiXFx0XCIpIHtcbiAgICAgICAgICB2YXIgdGFiU2l6ZSA9IGJ1aWxkZXIuY20ub3B0aW9ucy50YWJTaXplLCB0YWJXaWR0aCA9IHRhYlNpemUgLSBidWlsZGVyLmNvbCAlIHRhYlNpemU7XG4gICAgICAgICAgdmFyIHR4dCA9IGNvbnRlbnQuYXBwZW5kQ2hpbGQoZWx0KFwic3BhblwiLCBzcGFjZVN0cih0YWJXaWR0aCksIFwiY20tdGFiXCIpKTtcbiAgICAgICAgICB0eHQuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcInByZXNlbnRhdGlvblwiKTtcbiAgICAgICAgICB0eHQuc2V0QXR0cmlidXRlKFwiY20tdGV4dFwiLCBcIlxcdFwiKTtcbiAgICAgICAgICBidWlsZGVyLmNvbCArPSB0YWJXaWR0aDtcbiAgICAgICAgfSBlbHNlIGlmIChtWzBdID09IFwiXFxyXCIgfHwgbVswXSA9PSBcIlxcblwiKSB7XG4gICAgICAgICAgdmFyIHR4dCA9IGNvbnRlbnQuYXBwZW5kQ2hpbGQoZWx0KFwic3BhblwiLCBtWzBdID09IFwiXFxyXCIgPyBcIlxcdTI0MGRcIiA6IFwiXFx1MjQyNFwiLCBcImNtLWludmFsaWRjaGFyXCIpKTtcbiAgICAgICAgICB0eHQuc2V0QXR0cmlidXRlKFwiY20tdGV4dFwiLCBtWzBdKTtcbiAgICAgICAgICBidWlsZGVyLmNvbCArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciB0eHQgPSBidWlsZGVyLmNtLm9wdGlvbnMuc3BlY2lhbENoYXJQbGFjZWhvbGRlcihtWzBdKTtcbiAgICAgICAgICB0eHQuc2V0QXR0cmlidXRlKFwiY20tdGV4dFwiLCBtWzBdKTtcbiAgICAgICAgICBpZiAoaWUgJiYgaWVfdmVyc2lvbiA8IDkpIGNvbnRlbnQuYXBwZW5kQ2hpbGQoZWx0KFwic3BhblwiLCBbdHh0XSkpO1xuICAgICAgICAgIGVsc2UgY29udGVudC5hcHBlbmRDaGlsZCh0eHQpO1xuICAgICAgICAgIGJ1aWxkZXIuY29sICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGRlci5tYXAucHVzaChidWlsZGVyLnBvcywgYnVpbGRlci5wb3MgKyAxLCB0eHQpO1xuICAgICAgICBidWlsZGVyLnBvcysrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoc3R5bGUgfHwgc3RhcnRTdHlsZSB8fCBlbmRTdHlsZSB8fCBtdXN0V3JhcCB8fCBjc3MpIHtcbiAgICAgIHZhciBmdWxsU3R5bGUgPSBzdHlsZSB8fCBcIlwiO1xuICAgICAgaWYgKHN0YXJ0U3R5bGUpIGZ1bGxTdHlsZSArPSBzdGFydFN0eWxlO1xuICAgICAgaWYgKGVuZFN0eWxlKSBmdWxsU3R5bGUgKz0gZW5kU3R5bGU7XG4gICAgICB2YXIgdG9rZW4gPSBlbHQoXCJzcGFuXCIsIFtjb250ZW50XSwgZnVsbFN0eWxlLCBjc3MpO1xuICAgICAgaWYgKHRpdGxlKSB0b2tlbi50aXRsZSA9IHRpdGxlO1xuICAgICAgcmV0dXJuIGJ1aWxkZXIuY29udGVudC5hcHBlbmRDaGlsZCh0b2tlbik7XG4gICAgfVxuICAgIGJ1aWxkZXIuY29udGVudC5hcHBlbmRDaGlsZChjb250ZW50KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNwbGl0U3BhY2VzKG9sZCkge1xuICAgIHZhciBvdXQgPSBcIiBcIjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9sZC5sZW5ndGggLSAyOyArK2kpIG91dCArPSBpICUgMiA/IFwiIFwiIDogXCJcXHUwMGEwXCI7XG4gICAgb3V0ICs9IFwiIFwiO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cblxuICAvLyBXb3JrIGFyb3VuZCBub25zZW5zZSBkaW1lbnNpb25zIGJlaW5nIHJlcG9ydGVkIGZvciBzdHJldGNoZXMgb2ZcbiAgLy8gcmlnaHQtdG8tbGVmdCB0ZXh0LlxuICBmdW5jdGlvbiBidWlsZFRva2VuQmFkQmlkaShpbm5lciwgb3JkZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oYnVpbGRlciwgdGV4dCwgc3R5bGUsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCB0aXRsZSwgY3NzKSB7XG4gICAgICBzdHlsZSA9IHN0eWxlID8gc3R5bGUgKyBcIiBjbS1mb3JjZS1ib3JkZXJcIiA6IFwiY20tZm9yY2UtYm9yZGVyXCI7XG4gICAgICB2YXIgc3RhcnQgPSBidWlsZGVyLnBvcywgZW5kID0gc3RhcnQgKyB0ZXh0Lmxlbmd0aDtcbiAgICAgIGZvciAoOzspIHtcbiAgICAgICAgLy8gRmluZCB0aGUgcGFydCB0aGF0IG92ZXJsYXBzIHdpdGggdGhlIHN0YXJ0IG9mIHRoaXMgdGV4dFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9yZGVyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIHBhcnQgPSBvcmRlcltpXTtcbiAgICAgICAgICBpZiAocGFydC50byA+IHN0YXJ0ICYmIHBhcnQuZnJvbSA8PSBzdGFydCkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnQudG8gPj0gZW5kKSByZXR1cm4gaW5uZXIoYnVpbGRlciwgdGV4dCwgc3R5bGUsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCB0aXRsZSwgY3NzKTtcbiAgICAgICAgaW5uZXIoYnVpbGRlciwgdGV4dC5zbGljZSgwLCBwYXJ0LnRvIC0gc3RhcnQpLCBzdHlsZSwgc3RhcnRTdHlsZSwgbnVsbCwgdGl0bGUsIGNzcyk7XG4gICAgICAgIHN0YXJ0U3R5bGUgPSBudWxsO1xuICAgICAgICB0ZXh0ID0gdGV4dC5zbGljZShwYXJ0LnRvIC0gc3RhcnQpO1xuICAgICAgICBzdGFydCA9IHBhcnQudG87XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkQ29sbGFwc2VkU3BhbihidWlsZGVyLCBzaXplLCBtYXJrZXIsIGlnbm9yZVdpZGdldCkge1xuICAgIHZhciB3aWRnZXQgPSAhaWdub3JlV2lkZ2V0ICYmIG1hcmtlci53aWRnZXROb2RlO1xuICAgIGlmICh3aWRnZXQpIGJ1aWxkZXIubWFwLnB1c2goYnVpbGRlci5wb3MsIGJ1aWxkZXIucG9zICsgc2l6ZSwgd2lkZ2V0KTtcbiAgICBpZiAoIWlnbm9yZVdpZGdldCAmJiBidWlsZGVyLmNtLmRpc3BsYXkuaW5wdXQubmVlZHNDb250ZW50QXR0cmlidXRlKSB7XG4gICAgICBpZiAoIXdpZGdldClcbiAgICAgICAgd2lkZ2V0ID0gYnVpbGRlci5jb250ZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpKTtcbiAgICAgIHdpZGdldC5zZXRBdHRyaWJ1dGUoXCJjbS1tYXJrZXJcIiwgbWFya2VyLmlkKTtcbiAgICB9XG4gICAgaWYgKHdpZGdldCkge1xuICAgICAgYnVpbGRlci5jbS5kaXNwbGF5LmlucHV0LnNldFVuZWRpdGFibGUod2lkZ2V0KTtcbiAgICAgIGJ1aWxkZXIuY29udGVudC5hcHBlbmRDaGlsZCh3aWRnZXQpO1xuICAgIH1cbiAgICBidWlsZGVyLnBvcyArPSBzaXplO1xuICB9XG5cbiAgLy8gT3V0cHV0cyBhIG51bWJlciBvZiBzcGFucyB0byBtYWtlIHVwIGEgbGluZSwgdGFraW5nIGhpZ2hsaWdodGluZ1xuICAvLyBhbmQgbWFya2VkIHRleHQgaW50byBhY2NvdW50LlxuICBmdW5jdGlvbiBpbnNlcnRMaW5lQ29udGVudChsaW5lLCBidWlsZGVyLCBzdHlsZXMpIHtcbiAgICB2YXIgc3BhbnMgPSBsaW5lLm1hcmtlZFNwYW5zLCBhbGxUZXh0ID0gbGluZS50ZXh0LCBhdCA9IDA7XG4gICAgaWYgKCFzcGFucykge1xuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKz0yKVxuICAgICAgICBidWlsZGVyLmFkZFRva2VuKGJ1aWxkZXIsIGFsbFRleHQuc2xpY2UoYXQsIGF0ID0gc3R5bGVzW2ldKSwgaW50ZXJwcmV0VG9rZW5TdHlsZShzdHlsZXNbaSsxXSwgYnVpbGRlci5jbS5vcHRpb25zKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGxlbiA9IGFsbFRleHQubGVuZ3RoLCBwb3MgPSAwLCBpID0gMSwgdGV4dCA9IFwiXCIsIHN0eWxlLCBjc3M7XG4gICAgdmFyIG5leHRDaGFuZ2UgPSAwLCBzcGFuU3R5bGUsIHNwYW5FbmRTdHlsZSwgc3BhblN0YXJ0U3R5bGUsIHRpdGxlLCBjb2xsYXBzZWQ7XG4gICAgZm9yICg7Oykge1xuICAgICAgaWYgKG5leHRDaGFuZ2UgPT0gcG9zKSB7IC8vIFVwZGF0ZSBjdXJyZW50IG1hcmtlciBzZXRcbiAgICAgICAgc3BhblN0eWxlID0gc3BhbkVuZFN0eWxlID0gc3BhblN0YXJ0U3R5bGUgPSB0aXRsZSA9IGNzcyA9IFwiXCI7XG4gICAgICAgIGNvbGxhcHNlZCA9IG51bGw7IG5leHRDaGFuZ2UgPSBJbmZpbml0eTtcbiAgICAgICAgdmFyIGZvdW5kQm9va21hcmtzID0gW107XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc3BhbnMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICB2YXIgc3AgPSBzcGFuc1tqXSwgbSA9IHNwLm1hcmtlcjtcbiAgICAgICAgICBpZiAobS50eXBlID09IFwiYm9va21hcmtcIiAmJiBzcC5mcm9tID09IHBvcyAmJiBtLndpZGdldE5vZGUpIHtcbiAgICAgICAgICAgIGZvdW5kQm9va21hcmtzLnB1c2gobSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChzcC5mcm9tIDw9IHBvcyAmJiAoc3AudG8gPT0gbnVsbCB8fCBzcC50byA+IHBvcyB8fCBtLmNvbGxhcHNlZCAmJiBzcC50byA9PSBwb3MgJiYgc3AuZnJvbSA9PSBwb3MpKSB7XG4gICAgICAgICAgICBpZiAoc3AudG8gIT0gbnVsbCAmJiBzcC50byAhPSBwb3MgJiYgbmV4dENoYW5nZSA+IHNwLnRvKSB7XG4gICAgICAgICAgICAgIG5leHRDaGFuZ2UgPSBzcC50bztcbiAgICAgICAgICAgICAgc3BhbkVuZFN0eWxlID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtLmNsYXNzTmFtZSkgc3BhblN0eWxlICs9IFwiIFwiICsgbS5jbGFzc05hbWU7XG4gICAgICAgICAgICBpZiAobS5jc3MpIGNzcyA9IG0uY3NzO1xuICAgICAgICAgICAgaWYgKG0uc3RhcnRTdHlsZSAmJiBzcC5mcm9tID09IHBvcykgc3BhblN0YXJ0U3R5bGUgKz0gXCIgXCIgKyBtLnN0YXJ0U3R5bGU7XG4gICAgICAgICAgICBpZiAobS5lbmRTdHlsZSAmJiBzcC50byA9PSBuZXh0Q2hhbmdlKSBzcGFuRW5kU3R5bGUgKz0gXCIgXCIgKyBtLmVuZFN0eWxlO1xuICAgICAgICAgICAgaWYgKG0udGl0bGUgJiYgIXRpdGxlKSB0aXRsZSA9IG0udGl0bGU7XG4gICAgICAgICAgICBpZiAobS5jb2xsYXBzZWQgJiYgKCFjb2xsYXBzZWQgfHwgY29tcGFyZUNvbGxhcHNlZE1hcmtlcnMoY29sbGFwc2VkLm1hcmtlciwgbSkgPCAwKSlcbiAgICAgICAgICAgICAgY29sbGFwc2VkID0gc3A7XG4gICAgICAgICAgfSBlbHNlIGlmIChzcC5mcm9tID4gcG9zICYmIG5leHRDaGFuZ2UgPiBzcC5mcm9tKSB7XG4gICAgICAgICAgICBuZXh0Q2hhbmdlID0gc3AuZnJvbTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbGxhcHNlZCAmJiAoY29sbGFwc2VkLmZyb20gfHwgMCkgPT0gcG9zKSB7XG4gICAgICAgICAgYnVpbGRDb2xsYXBzZWRTcGFuKGJ1aWxkZXIsIChjb2xsYXBzZWQudG8gPT0gbnVsbCA/IGxlbiArIDEgOiBjb2xsYXBzZWQudG8pIC0gcG9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZWQubWFya2VyLCBjb2xsYXBzZWQuZnJvbSA9PSBudWxsKTtcbiAgICAgICAgICBpZiAoY29sbGFwc2VkLnRvID09IG51bGwpIHJldHVybjtcbiAgICAgICAgICBpZiAoY29sbGFwc2VkLnRvID09IHBvcykgY29sbGFwc2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjb2xsYXBzZWQgJiYgZm91bmRCb29rbWFya3MubGVuZ3RoKSBmb3IgKHZhciBqID0gMDsgaiA8IGZvdW5kQm9va21hcmtzLmxlbmd0aDsgKytqKVxuICAgICAgICAgIGJ1aWxkQ29sbGFwc2VkU3BhbihidWlsZGVyLCAwLCBmb3VuZEJvb2ttYXJrc1tqXSk7XG4gICAgICB9XG4gICAgICBpZiAocG9zID49IGxlbikgYnJlYWs7XG5cbiAgICAgIHZhciB1cHRvID0gTWF0aC5taW4obGVuLCBuZXh0Q2hhbmdlKTtcbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIGlmICh0ZXh0KSB7XG4gICAgICAgICAgdmFyIGVuZCA9IHBvcyArIHRleHQubGVuZ3RoO1xuICAgICAgICAgIGlmICghY29sbGFwc2VkKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5UZXh0ID0gZW5kID4gdXB0byA/IHRleHQuc2xpY2UoMCwgdXB0byAtIHBvcykgOiB0ZXh0O1xuICAgICAgICAgICAgYnVpbGRlci5hZGRUb2tlbihidWlsZGVyLCB0b2tlblRleHQsIHN0eWxlID8gc3R5bGUgKyBzcGFuU3R5bGUgOiBzcGFuU3R5bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW5TdGFydFN0eWxlLCBwb3MgKyB0b2tlblRleHQubGVuZ3RoID09IG5leHRDaGFuZ2UgPyBzcGFuRW5kU3R5bGUgOiBcIlwiLCB0aXRsZSwgY3NzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGVuZCA+PSB1cHRvKSB7dGV4dCA9IHRleHQuc2xpY2UodXB0byAtIHBvcyk7IHBvcyA9IHVwdG87IGJyZWFrO31cbiAgICAgICAgICBwb3MgPSBlbmQ7XG4gICAgICAgICAgc3BhblN0YXJ0U3R5bGUgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHRleHQgPSBhbGxUZXh0LnNsaWNlKGF0LCBhdCA9IHN0eWxlc1tpKytdKTtcbiAgICAgICAgc3R5bGUgPSBpbnRlcnByZXRUb2tlblN0eWxlKHN0eWxlc1tpKytdLCBidWlsZGVyLmNtLm9wdGlvbnMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIERPQ1VNRU5UIERBVEEgU1RSVUNUVVJFXG5cbiAgLy8gQnkgZGVmYXVsdCwgdXBkYXRlcyB0aGF0IHN0YXJ0IGFuZCBlbmQgYXQgdGhlIGJlZ2lubmluZyBvZiBhIGxpbmVcbiAgLy8gYXJlIHRyZWF0ZWQgc3BlY2lhbGx5LCBpbiBvcmRlciB0byBtYWtlIHRoZSBhc3NvY2lhdGlvbiBvZiBsaW5lXG4gIC8vIHdpZGdldHMgYW5kIG1hcmtlciBlbGVtZW50cyB3aXRoIHRoZSB0ZXh0IGJlaGF2ZSBtb3JlIGludHVpdGl2ZS5cbiAgZnVuY3Rpb24gaXNXaG9sZUxpbmVVcGRhdGUoZG9jLCBjaGFuZ2UpIHtcbiAgICByZXR1cm4gY2hhbmdlLmZyb20uY2ggPT0gMCAmJiBjaGFuZ2UudG8uY2ggPT0gMCAmJiBsc3QoY2hhbmdlLnRleHQpID09IFwiXCIgJiZcbiAgICAgICghZG9jLmNtIHx8IGRvYy5jbS5vcHRpb25zLndob2xlTGluZVVwZGF0ZUJlZm9yZSk7XG4gIH1cblxuICAvLyBQZXJmb3JtIGEgY2hhbmdlIG9uIHRoZSBkb2N1bWVudCBkYXRhIHN0cnVjdHVyZS5cbiAgZnVuY3Rpb24gdXBkYXRlRG9jKGRvYywgY2hhbmdlLCBtYXJrZWRTcGFucywgZXN0aW1hdGVIZWlnaHQpIHtcbiAgICBmdW5jdGlvbiBzcGFuc0ZvcihuKSB7cmV0dXJuIG1hcmtlZFNwYW5zID8gbWFya2VkU3BhbnNbbl0gOiBudWxsO31cbiAgICBmdW5jdGlvbiB1cGRhdGUobGluZSwgdGV4dCwgc3BhbnMpIHtcbiAgICAgIHVwZGF0ZUxpbmUobGluZSwgdGV4dCwgc3BhbnMsIGVzdGltYXRlSGVpZ2h0KTtcbiAgICAgIHNpZ25hbExhdGVyKGxpbmUsIFwiY2hhbmdlXCIsIGxpbmUsIGNoYW5nZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGxpbmVzRm9yKHN0YXJ0LCBlbmQpIHtcbiAgICAgIGZvciAodmFyIGkgPSBzdGFydCwgcmVzdWx0ID0gW107IGkgPCBlbmQ7ICsraSlcbiAgICAgICAgcmVzdWx0LnB1c2gobmV3IExpbmUodGV4dFtpXSwgc3BhbnNGb3IoaSksIGVzdGltYXRlSGVpZ2h0KSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHZhciBmcm9tID0gY2hhbmdlLmZyb20sIHRvID0gY2hhbmdlLnRvLCB0ZXh0ID0gY2hhbmdlLnRleHQ7XG4gICAgdmFyIGZpcnN0TGluZSA9IGdldExpbmUoZG9jLCBmcm9tLmxpbmUpLCBsYXN0TGluZSA9IGdldExpbmUoZG9jLCB0by5saW5lKTtcbiAgICB2YXIgbGFzdFRleHQgPSBsc3QodGV4dCksIGxhc3RTcGFucyA9IHNwYW5zRm9yKHRleHQubGVuZ3RoIC0gMSksIG5saW5lcyA9IHRvLmxpbmUgLSBmcm9tLmxpbmU7XG5cbiAgICAvLyBBZGp1c3QgdGhlIGxpbmUgc3RydWN0dXJlXG4gICAgaWYgKGNoYW5nZS5mdWxsKSB7XG4gICAgICBkb2MuaW5zZXJ0KDAsIGxpbmVzRm9yKDAsIHRleHQubGVuZ3RoKSk7XG4gICAgICBkb2MucmVtb3ZlKHRleHQubGVuZ3RoLCBkb2Muc2l6ZSAtIHRleHQubGVuZ3RoKTtcbiAgICB9IGVsc2UgaWYgKGlzV2hvbGVMaW5lVXBkYXRlKGRvYywgY2hhbmdlKSkge1xuICAgICAgLy8gVGhpcyBpcyBhIHdob2xlLWxpbmUgcmVwbGFjZS4gVHJlYXRlZCBzcGVjaWFsbHkgdG8gbWFrZVxuICAgICAgLy8gc3VyZSBsaW5lIG9iamVjdHMgbW92ZSB0aGUgd2F5IHRoZXkgYXJlIHN1cHBvc2VkIHRvLlxuICAgICAgdmFyIGFkZGVkID0gbGluZXNGb3IoMCwgdGV4dC5sZW5ndGggLSAxKTtcbiAgICAgIHVwZGF0ZShsYXN0TGluZSwgbGFzdExpbmUudGV4dCwgbGFzdFNwYW5zKTtcbiAgICAgIGlmIChubGluZXMpIGRvYy5yZW1vdmUoZnJvbS5saW5lLCBubGluZXMpO1xuICAgICAgaWYgKGFkZGVkLmxlbmd0aCkgZG9jLmluc2VydChmcm9tLmxpbmUsIGFkZGVkKTtcbiAgICB9IGVsc2UgaWYgKGZpcnN0TGluZSA9PSBsYXN0TGluZSkge1xuICAgICAgaWYgKHRleHQubGVuZ3RoID09IDEpIHtcbiAgICAgICAgdXBkYXRlKGZpcnN0TGluZSwgZmlyc3RMaW5lLnRleHQuc2xpY2UoMCwgZnJvbS5jaCkgKyBsYXN0VGV4dCArIGZpcnN0TGluZS50ZXh0LnNsaWNlKHRvLmNoKSwgbGFzdFNwYW5zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBhZGRlZCA9IGxpbmVzRm9yKDEsIHRleHQubGVuZ3RoIC0gMSk7XG4gICAgICAgIGFkZGVkLnB1c2gobmV3IExpbmUobGFzdFRleHQgKyBmaXJzdExpbmUudGV4dC5zbGljZSh0by5jaCksIGxhc3RTcGFucywgZXN0aW1hdGVIZWlnaHQpKTtcbiAgICAgICAgdXBkYXRlKGZpcnN0TGluZSwgZmlyc3RMaW5lLnRleHQuc2xpY2UoMCwgZnJvbS5jaCkgKyB0ZXh0WzBdLCBzcGFuc0ZvcigwKSk7XG4gICAgICAgIGRvYy5pbnNlcnQoZnJvbS5saW5lICsgMSwgYWRkZWQpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGV4dC5sZW5ndGggPT0gMSkge1xuICAgICAgdXBkYXRlKGZpcnN0TGluZSwgZmlyc3RMaW5lLnRleHQuc2xpY2UoMCwgZnJvbS5jaCkgKyB0ZXh0WzBdICsgbGFzdExpbmUudGV4dC5zbGljZSh0by5jaCksIHNwYW5zRm9yKDApKTtcbiAgICAgIGRvYy5yZW1vdmUoZnJvbS5saW5lICsgMSwgbmxpbmVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdXBkYXRlKGZpcnN0TGluZSwgZmlyc3RMaW5lLnRleHQuc2xpY2UoMCwgZnJvbS5jaCkgKyB0ZXh0WzBdLCBzcGFuc0ZvcigwKSk7XG4gICAgICB1cGRhdGUobGFzdExpbmUsIGxhc3RUZXh0ICsgbGFzdExpbmUudGV4dC5zbGljZSh0by5jaCksIGxhc3RTcGFucyk7XG4gICAgICB2YXIgYWRkZWQgPSBsaW5lc0ZvcigxLCB0ZXh0Lmxlbmd0aCAtIDEpO1xuICAgICAgaWYgKG5saW5lcyA+IDEpIGRvYy5yZW1vdmUoZnJvbS5saW5lICsgMSwgbmxpbmVzIC0gMSk7XG4gICAgICBkb2MuaW5zZXJ0KGZyb20ubGluZSArIDEsIGFkZGVkKTtcbiAgICB9XG5cbiAgICBzaWduYWxMYXRlcihkb2MsIFwiY2hhbmdlXCIsIGRvYywgY2hhbmdlKTtcbiAgfVxuXG4gIC8vIFRoZSBkb2N1bWVudCBpcyByZXByZXNlbnRlZCBhcyBhIEJUcmVlIGNvbnNpc3Rpbmcgb2YgbGVhdmVzLCB3aXRoXG4gIC8vIGNodW5rIG9mIGxpbmVzIGluIHRoZW0sIGFuZCBicmFuY2hlcywgd2l0aCB1cCB0byB0ZW4gbGVhdmVzIG9yXG4gIC8vIG90aGVyIGJyYW5jaCBub2RlcyBiZWxvdyB0aGVtLiBUaGUgdG9wIG5vZGUgaXMgYWx3YXlzIGEgYnJhbmNoXG4gIC8vIG5vZGUsIGFuZCBpcyB0aGUgZG9jdW1lbnQgb2JqZWN0IGl0c2VsZiAobWVhbmluZyBpdCBoYXNcbiAgLy8gYWRkaXRpb25hbCBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzKS5cbiAgLy9cbiAgLy8gQWxsIG5vZGVzIGhhdmUgcGFyZW50IGxpbmtzLiBUaGUgdHJlZSBpcyB1c2VkIGJvdGggdG8gZ28gZnJvbVxuICAvLyBsaW5lIG51bWJlcnMgdG8gbGluZSBvYmplY3RzLCBhbmQgdG8gZ28gZnJvbSBvYmplY3RzIHRvIG51bWJlcnMuXG4gIC8vIEl0IGFsc28gaW5kZXhlcyBieSBoZWlnaHQsIGFuZCBpcyB1c2VkIHRvIGNvbnZlcnQgYmV0d2VlbiBoZWlnaHRcbiAgLy8gYW5kIGxpbmUgb2JqZWN0LCBhbmQgdG8gZmluZCB0aGUgdG90YWwgaGVpZ2h0IG9mIHRoZSBkb2N1bWVudC5cbiAgLy9cbiAgLy8gU2VlIGFsc28gaHR0cDovL21hcmlqbmhhdmVyYmVrZS5ubC9ibG9nL2NvZGVtaXJyb3ItbGluZS10cmVlLmh0bWxcblxuICBmdW5jdGlvbiBMZWFmQ2h1bmsobGluZXMpIHtcbiAgICB0aGlzLmxpbmVzID0gbGluZXM7XG4gICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgIGZvciAodmFyIGkgPSAwLCBoZWlnaHQgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGxpbmVzW2ldLnBhcmVudCA9IHRoaXM7XG4gICAgICBoZWlnaHQgKz0gbGluZXNbaV0uaGVpZ2h0O1xuICAgIH1cbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgfVxuXG4gIExlYWZDaHVuay5wcm90b3R5cGUgPSB7XG4gICAgY2h1bmtTaXplOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMubGluZXMubGVuZ3RoOyB9LFxuICAgIC8vIFJlbW92ZSB0aGUgbiBsaW5lcyBhdCBvZmZzZXQgJ2F0Jy5cbiAgICByZW1vdmVJbm5lcjogZnVuY3Rpb24oYXQsIG4pIHtcbiAgICAgIGZvciAodmFyIGkgPSBhdCwgZSA9IGF0ICsgbjsgaSA8IGU7ICsraSkge1xuICAgICAgICB2YXIgbGluZSA9IHRoaXMubGluZXNbaV07XG4gICAgICAgIHRoaXMuaGVpZ2h0IC09IGxpbmUuaGVpZ2h0O1xuICAgICAgICBjbGVhblVwTGluZShsaW5lKTtcbiAgICAgICAgc2lnbmFsTGF0ZXIobGluZSwgXCJkZWxldGVcIik7XG4gICAgICB9XG4gICAgICB0aGlzLmxpbmVzLnNwbGljZShhdCwgbik7XG4gICAgfSxcbiAgICAvLyBIZWxwZXIgdXNlZCB0byBjb2xsYXBzZSBhIHNtYWxsIGJyYW5jaCBpbnRvIGEgc2luZ2xlIGxlYWYuXG4gICAgY29sbGFwc2U6IGZ1bmN0aW9uKGxpbmVzKSB7XG4gICAgICBsaW5lcy5wdXNoLmFwcGx5KGxpbmVzLCB0aGlzLmxpbmVzKTtcbiAgICB9LFxuICAgIC8vIEluc2VydCB0aGUgZ2l2ZW4gYXJyYXkgb2YgbGluZXMgYXQgb2Zmc2V0ICdhdCcsIGNvdW50IHRoZW0gYXNcbiAgICAvLyBoYXZpbmcgdGhlIGdpdmVuIGhlaWdodC5cbiAgICBpbnNlcnRJbm5lcjogZnVuY3Rpb24oYXQsIGxpbmVzLCBoZWlnaHQpIHtcbiAgICAgIHRoaXMuaGVpZ2h0ICs9IGhlaWdodDtcbiAgICAgIHRoaXMubGluZXMgPSB0aGlzLmxpbmVzLnNsaWNlKDAsIGF0KS5jb25jYXQobGluZXMpLmNvbmNhdCh0aGlzLmxpbmVzLnNsaWNlKGF0KSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgKytpKSBsaW5lc1tpXS5wYXJlbnQgPSB0aGlzO1xuICAgIH0sXG4gICAgLy8gVXNlZCB0byBpdGVyYXRlIG92ZXIgYSBwYXJ0IG9mIHRoZSB0cmVlLlxuICAgIGl0ZXJOOiBmdW5jdGlvbihhdCwgbiwgb3ApIHtcbiAgICAgIGZvciAodmFyIGUgPSBhdCArIG47IGF0IDwgZTsgKythdClcbiAgICAgICAgaWYgKG9wKHRoaXMubGluZXNbYXRdKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIEJyYW5jaENodW5rKGNoaWxkcmVuKSB7XG4gICAgdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuO1xuICAgIHZhciBzaXplID0gMCwgaGVpZ2h0ID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgY2ggPSBjaGlsZHJlbltpXTtcbiAgICAgIHNpemUgKz0gY2guY2h1bmtTaXplKCk7IGhlaWdodCArPSBjaC5oZWlnaHQ7XG4gICAgICBjaC5wYXJlbnQgPSB0aGlzO1xuICAgIH1cbiAgICB0aGlzLnNpemUgPSBzaXplO1xuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIHRoaXMucGFyZW50ID0gbnVsbDtcbiAgfVxuXG4gIEJyYW5jaENodW5rLnByb3RvdHlwZSA9IHtcbiAgICBjaHVua1NpemU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5zaXplOyB9LFxuICAgIHJlbW92ZUlubmVyOiBmdW5jdGlvbihhdCwgbikge1xuICAgICAgdGhpcy5zaXplIC09IG47XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbltpXSwgc3ogPSBjaGlsZC5jaHVua1NpemUoKTtcbiAgICAgICAgaWYgKGF0IDwgc3opIHtcbiAgICAgICAgICB2YXIgcm0gPSBNYXRoLm1pbihuLCBzeiAtIGF0KSwgb2xkSGVpZ2h0ID0gY2hpbGQuaGVpZ2h0O1xuICAgICAgICAgIGNoaWxkLnJlbW92ZUlubmVyKGF0LCBybSk7XG4gICAgICAgICAgdGhpcy5oZWlnaHQgLT0gb2xkSGVpZ2h0IC0gY2hpbGQuaGVpZ2h0O1xuICAgICAgICAgIGlmIChzeiA9PSBybSkgeyB0aGlzLmNoaWxkcmVuLnNwbGljZShpLS0sIDEpOyBjaGlsZC5wYXJlbnQgPSBudWxsOyB9XG4gICAgICAgICAgaWYgKChuIC09IHJtKSA9PSAwKSBicmVhaztcbiAgICAgICAgICBhdCA9IDA7XG4gICAgICAgIH0gZWxzZSBhdCAtPSBzejtcbiAgICAgIH1cbiAgICAgIC8vIElmIHRoZSByZXN1bHQgaXMgc21hbGxlciB0aGFuIDI1IGxpbmVzLCBlbnN1cmUgdGhhdCBpdCBpcyBhXG4gICAgICAvLyBzaW5nbGUgbGVhZiBub2RlLlxuICAgICAgaWYgKHRoaXMuc2l6ZSAtIG4gPCAyNSAmJlxuICAgICAgICAgICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDEgfHwgISh0aGlzLmNoaWxkcmVuWzBdIGluc3RhbmNlb2YgTGVhZkNodW5rKSkpIHtcbiAgICAgICAgdmFyIGxpbmVzID0gW107XG4gICAgICAgIHRoaXMuY29sbGFwc2UobGluZXMpO1xuICAgICAgICB0aGlzLmNoaWxkcmVuID0gW25ldyBMZWFmQ2h1bmsobGluZXMpXTtcbiAgICAgICAgdGhpcy5jaGlsZHJlblswXS5wYXJlbnQgPSB0aGlzO1xuICAgICAgfVxuICAgIH0sXG4gICAgY29sbGFwc2U6IGZ1bmN0aW9uKGxpbmVzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHRoaXMuY2hpbGRyZW5baV0uY29sbGFwc2UobGluZXMpO1xuICAgIH0sXG4gICAgaW5zZXJ0SW5uZXI6IGZ1bmN0aW9uKGF0LCBsaW5lcywgaGVpZ2h0KSB7XG4gICAgICB0aGlzLnNpemUgKz0gbGluZXMubGVuZ3RoO1xuICAgICAgdGhpcy5oZWlnaHQgKz0gaGVpZ2h0O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IHRoaXMuY2hpbGRyZW5baV0sIHN6ID0gY2hpbGQuY2h1bmtTaXplKCk7XG4gICAgICAgIGlmIChhdCA8PSBzeikge1xuICAgICAgICAgIGNoaWxkLmluc2VydElubmVyKGF0LCBsaW5lcywgaGVpZ2h0KTtcbiAgICAgICAgICBpZiAoY2hpbGQubGluZXMgJiYgY2hpbGQubGluZXMubGVuZ3RoID4gNTApIHtcbiAgICAgICAgICAgIHdoaWxlIChjaGlsZC5saW5lcy5sZW5ndGggPiA1MCkge1xuICAgICAgICAgICAgICB2YXIgc3BpbGxlZCA9IGNoaWxkLmxpbmVzLnNwbGljZShjaGlsZC5saW5lcy5sZW5ndGggLSAyNSwgMjUpO1xuICAgICAgICAgICAgICB2YXIgbmV3bGVhZiA9IG5ldyBMZWFmQ2h1bmsoc3BpbGxlZCk7XG4gICAgICAgICAgICAgIGNoaWxkLmhlaWdodCAtPSBuZXdsZWFmLmhlaWdodDtcbiAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaSArIDEsIDAsIG5ld2xlYWYpO1xuICAgICAgICAgICAgICBuZXdsZWFmLnBhcmVudCA9IHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1heWJlU3BpbGwoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgYXQgLT0gc3o7XG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBXaGVuIGEgbm9kZSBoYXMgZ3Jvd24sIGNoZWNrIHdoZXRoZXIgaXQgc2hvdWxkIGJlIHNwbGl0LlxuICAgIG1heWJlU3BpbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoIDw9IDEwKSByZXR1cm47XG4gICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgZG8ge1xuICAgICAgICB2YXIgc3BpbGxlZCA9IG1lLmNoaWxkcmVuLnNwbGljZShtZS5jaGlsZHJlbi5sZW5ndGggLSA1LCA1KTtcbiAgICAgICAgdmFyIHNpYmxpbmcgPSBuZXcgQnJhbmNoQ2h1bmsoc3BpbGxlZCk7XG4gICAgICAgIGlmICghbWUucGFyZW50KSB7IC8vIEJlY29tZSB0aGUgcGFyZW50IG5vZGVcbiAgICAgICAgICB2YXIgY29weSA9IG5ldyBCcmFuY2hDaHVuayhtZS5jaGlsZHJlbik7XG4gICAgICAgICAgY29weS5wYXJlbnQgPSBtZTtcbiAgICAgICAgICBtZS5jaGlsZHJlbiA9IFtjb3B5LCBzaWJsaW5nXTtcbiAgICAgICAgICBtZSA9IGNvcHk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWUuc2l6ZSAtPSBzaWJsaW5nLnNpemU7XG4gICAgICAgICAgbWUuaGVpZ2h0IC09IHNpYmxpbmcuaGVpZ2h0O1xuICAgICAgICAgIHZhciBteUluZGV4ID0gaW5kZXhPZihtZS5wYXJlbnQuY2hpbGRyZW4sIG1lKTtcbiAgICAgICAgICBtZS5wYXJlbnQuY2hpbGRyZW4uc3BsaWNlKG15SW5kZXggKyAxLCAwLCBzaWJsaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG1lLnBhcmVudDtcbiAgICAgIH0gd2hpbGUgKG1lLmNoaWxkcmVuLmxlbmd0aCA+IDEwKTtcbiAgICAgIG1lLnBhcmVudC5tYXliZVNwaWxsKCk7XG4gICAgfSxcbiAgICBpdGVyTjogZnVuY3Rpb24oYXQsIG4sIG9wKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbltpXSwgc3ogPSBjaGlsZC5jaHVua1NpemUoKTtcbiAgICAgICAgaWYgKGF0IDwgc3opIHtcbiAgICAgICAgICB2YXIgdXNlZCA9IE1hdGgubWluKG4sIHN6IC0gYXQpO1xuICAgICAgICAgIGlmIChjaGlsZC5pdGVyTihhdCwgdXNlZCwgb3ApKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICBpZiAoKG4gLT0gdXNlZCkgPT0gMCkgYnJlYWs7XG4gICAgICAgICAgYXQgPSAwO1xuICAgICAgICB9IGVsc2UgYXQgLT0gc3o7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBuZXh0RG9jSWQgPSAwO1xuICB2YXIgRG9jID0gQ29kZU1pcnJvci5Eb2MgPSBmdW5jdGlvbih0ZXh0LCBtb2RlLCBmaXJzdExpbmUsIGxpbmVTZXApIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgRG9jKSkgcmV0dXJuIG5ldyBEb2ModGV4dCwgbW9kZSwgZmlyc3RMaW5lLCBsaW5lU2VwKTtcbiAgICBpZiAoZmlyc3RMaW5lID09IG51bGwpIGZpcnN0TGluZSA9IDA7XG5cbiAgICBCcmFuY2hDaHVuay5jYWxsKHRoaXMsIFtuZXcgTGVhZkNodW5rKFtuZXcgTGluZShcIlwiLCBudWxsKV0pXSk7XG4gICAgdGhpcy5maXJzdCA9IGZpcnN0TGluZTtcbiAgICB0aGlzLnNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG4gICAgdGhpcy5jYW50RWRpdCA9IGZhbHNlO1xuICAgIHRoaXMuY2xlYW5HZW5lcmF0aW9uID0gMTtcbiAgICB0aGlzLmZyb250aWVyID0gZmlyc3RMaW5lO1xuICAgIHZhciBzdGFydCA9IFBvcyhmaXJzdExpbmUsIDApO1xuICAgIHRoaXMuc2VsID0gc2ltcGxlU2VsZWN0aW9uKHN0YXJ0KTtcbiAgICB0aGlzLmhpc3RvcnkgPSBuZXcgSGlzdG9yeShudWxsKTtcbiAgICB0aGlzLmlkID0gKytuZXh0RG9jSWQ7XG4gICAgdGhpcy5tb2RlT3B0aW9uID0gbW9kZTtcbiAgICB0aGlzLmxpbmVTZXAgPSBsaW5lU2VwO1xuXG4gICAgaWYgKHR5cGVvZiB0ZXh0ID09IFwic3RyaW5nXCIpIHRleHQgPSB0aGlzLnNwbGl0TGluZXModGV4dCk7XG4gICAgdXBkYXRlRG9jKHRoaXMsIHtmcm9tOiBzdGFydCwgdG86IHN0YXJ0LCB0ZXh0OiB0ZXh0fSk7XG4gICAgc2V0U2VsZWN0aW9uKHRoaXMsIHNpbXBsZVNlbGVjdGlvbihzdGFydCksIHNlbF9kb250U2Nyb2xsKTtcbiAgfTtcblxuICBEb2MucHJvdG90eXBlID0gY3JlYXRlT2JqKEJyYW5jaENodW5rLnByb3RvdHlwZSwge1xuICAgIGNvbnN0cnVjdG9yOiBEb2MsXG4gICAgLy8gSXRlcmF0ZSBvdmVyIHRoZSBkb2N1bWVudC4gU3VwcG9ydHMgdHdvIGZvcm1zIC0tIHdpdGggb25seSBvbmVcbiAgICAvLyBhcmd1bWVudCwgaXQgY2FsbHMgdGhhdCBmb3IgZWFjaCBsaW5lIGluIHRoZSBkb2N1bWVudC4gV2l0aFxuICAgIC8vIHRocmVlLCBpdCBpdGVyYXRlcyBvdmVyIHRoZSByYW5nZSBnaXZlbiBieSB0aGUgZmlyc3QgdHdvICh3aXRoXG4gICAgLy8gdGhlIHNlY29uZCBiZWluZyBub24taW5jbHVzaXZlKS5cbiAgICBpdGVyOiBmdW5jdGlvbihmcm9tLCB0bywgb3ApIHtcbiAgICAgIGlmIChvcCkgdGhpcy5pdGVyTihmcm9tIC0gdGhpcy5maXJzdCwgdG8gLSBmcm9tLCBvcCk7XG4gICAgICBlbHNlIHRoaXMuaXRlck4odGhpcy5maXJzdCwgdGhpcy5maXJzdCArIHRoaXMuc2l6ZSwgZnJvbSk7XG4gICAgfSxcblxuICAgIC8vIE5vbi1wdWJsaWMgaW50ZXJmYWNlIGZvciBhZGRpbmcgYW5kIHJlbW92aW5nIGxpbmVzLlxuICAgIGluc2VydDogZnVuY3Rpb24oYXQsIGxpbmVzKSB7XG4gICAgICB2YXIgaGVpZ2h0ID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIGhlaWdodCArPSBsaW5lc1tpXS5oZWlnaHQ7XG4gICAgICB0aGlzLmluc2VydElubmVyKGF0IC0gdGhpcy5maXJzdCwgbGluZXMsIGhlaWdodCk7XG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uKGF0LCBuKSB7IHRoaXMucmVtb3ZlSW5uZXIoYXQgLSB0aGlzLmZpcnN0LCBuKTsgfSxcblxuICAgIC8vIEZyb20gaGVyZSwgdGhlIG1ldGhvZHMgYXJlIHBhcnQgb2YgdGhlIHB1YmxpYyBpbnRlcmZhY2UuIE1vc3RcbiAgICAvLyBhcmUgYWxzbyBhdmFpbGFibGUgZnJvbSBDb2RlTWlycm9yIChlZGl0b3IpIGluc3RhbmNlcy5cblxuICAgIGdldFZhbHVlOiBmdW5jdGlvbihsaW5lU2VwKSB7XG4gICAgICB2YXIgbGluZXMgPSBnZXRMaW5lcyh0aGlzLCB0aGlzLmZpcnN0LCB0aGlzLmZpcnN0ICsgdGhpcy5zaXplKTtcbiAgICAgIGlmIChsaW5lU2VwID09PSBmYWxzZSkgcmV0dXJuIGxpbmVzO1xuICAgICAgcmV0dXJuIGxpbmVzLmpvaW4obGluZVNlcCB8fCB0aGlzLmxpbmVTZXBhcmF0b3IoKSk7XG4gICAgfSxcbiAgICBzZXRWYWx1ZTogZG9jTWV0aG9kT3AoZnVuY3Rpb24oY29kZSkge1xuICAgICAgdmFyIHRvcCA9IFBvcyh0aGlzLmZpcnN0LCAwKSwgbGFzdCA9IHRoaXMuZmlyc3QgKyB0aGlzLnNpemUgLSAxO1xuICAgICAgbWFrZUNoYW5nZSh0aGlzLCB7ZnJvbTogdG9wLCB0bzogUG9zKGxhc3QsIGdldExpbmUodGhpcywgbGFzdCkudGV4dC5sZW5ndGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5zcGxpdExpbmVzKGNvZGUpLCBvcmlnaW46IFwic2V0VmFsdWVcIiwgZnVsbDogdHJ1ZX0sIHRydWUpO1xuICAgICAgc2V0U2VsZWN0aW9uKHRoaXMsIHNpbXBsZVNlbGVjdGlvbih0b3ApKTtcbiAgICB9KSxcbiAgICByZXBsYWNlUmFuZ2U6IGZ1bmN0aW9uKGNvZGUsIGZyb20sIHRvLCBvcmlnaW4pIHtcbiAgICAgIGZyb20gPSBjbGlwUG9zKHRoaXMsIGZyb20pO1xuICAgICAgdG8gPSB0byA/IGNsaXBQb3ModGhpcywgdG8pIDogZnJvbTtcbiAgICAgIHJlcGxhY2VSYW5nZSh0aGlzLCBjb2RlLCBmcm9tLCB0bywgb3JpZ2luKTtcbiAgICB9LFxuICAgIGdldFJhbmdlOiBmdW5jdGlvbihmcm9tLCB0bywgbGluZVNlcCkge1xuICAgICAgdmFyIGxpbmVzID0gZ2V0QmV0d2Vlbih0aGlzLCBjbGlwUG9zKHRoaXMsIGZyb20pLCBjbGlwUG9zKHRoaXMsIHRvKSk7XG4gICAgICBpZiAobGluZVNlcCA9PT0gZmFsc2UpIHJldHVybiBsaW5lcztcbiAgICAgIHJldHVybiBsaW5lcy5qb2luKGxpbmVTZXAgfHwgdGhpcy5saW5lU2VwYXJhdG9yKCkpO1xuICAgIH0sXG5cbiAgICBnZXRMaW5lOiBmdW5jdGlvbihsaW5lKSB7dmFyIGwgPSB0aGlzLmdldExpbmVIYW5kbGUobGluZSk7IHJldHVybiBsICYmIGwudGV4dDt9LFxuXG4gICAgZ2V0TGluZUhhbmRsZTogZnVuY3Rpb24obGluZSkge2lmIChpc0xpbmUodGhpcywgbGluZSkpIHJldHVybiBnZXRMaW5lKHRoaXMsIGxpbmUpO30sXG4gICAgZ2V0TGluZU51bWJlcjogZnVuY3Rpb24obGluZSkge3JldHVybiBsaW5lTm8obGluZSk7fSxcblxuICAgIGdldExpbmVIYW5kbGVWaXN1YWxTdGFydDogZnVuY3Rpb24obGluZSkge1xuICAgICAgaWYgKHR5cGVvZiBsaW5lID09IFwibnVtYmVyXCIpIGxpbmUgPSBnZXRMaW5lKHRoaXMsIGxpbmUpO1xuICAgICAgcmV0dXJuIHZpc3VhbExpbmUobGluZSk7XG4gICAgfSxcblxuICAgIGxpbmVDb3VudDogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMuc2l6ZTt9LFxuICAgIGZpcnN0TGluZTogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMuZmlyc3Q7fSxcbiAgICBsYXN0TGluZTogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMuZmlyc3QgKyB0aGlzLnNpemUgLSAxO30sXG5cbiAgICBjbGlwUG9zOiBmdW5jdGlvbihwb3MpIHtyZXR1cm4gY2xpcFBvcyh0aGlzLCBwb3MpO30sXG5cbiAgICBnZXRDdXJzb3I6IGZ1bmN0aW9uKHN0YXJ0KSB7XG4gICAgICB2YXIgcmFuZ2UgPSB0aGlzLnNlbC5wcmltYXJ5KCksIHBvcztcbiAgICAgIGlmIChzdGFydCA9PSBudWxsIHx8IHN0YXJ0ID09IFwiaGVhZFwiKSBwb3MgPSByYW5nZS5oZWFkO1xuICAgICAgZWxzZSBpZiAoc3RhcnQgPT0gXCJhbmNob3JcIikgcG9zID0gcmFuZ2UuYW5jaG9yO1xuICAgICAgZWxzZSBpZiAoc3RhcnQgPT0gXCJlbmRcIiB8fCBzdGFydCA9PSBcInRvXCIgfHwgc3RhcnQgPT09IGZhbHNlKSBwb3MgPSByYW5nZS50bygpO1xuICAgICAgZWxzZSBwb3MgPSByYW5nZS5mcm9tKCk7XG4gICAgICByZXR1cm4gcG9zO1xuICAgIH0sXG4gICAgbGlzdFNlbGVjdGlvbnM6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5zZWwucmFuZ2VzOyB9LFxuICAgIHNvbWV0aGluZ1NlbGVjdGVkOiBmdW5jdGlvbigpIHtyZXR1cm4gdGhpcy5zZWwuc29tZXRoaW5nU2VsZWN0ZWQoKTt9LFxuXG4gICAgc2V0Q3Vyc29yOiBkb2NNZXRob2RPcChmdW5jdGlvbihsaW5lLCBjaCwgb3B0aW9ucykge1xuICAgICAgc2V0U2ltcGxlU2VsZWN0aW9uKHRoaXMsIGNsaXBQb3ModGhpcywgdHlwZW9mIGxpbmUgPT0gXCJudW1iZXJcIiA/IFBvcyhsaW5lLCBjaCB8fCAwKSA6IGxpbmUpLCBudWxsLCBvcHRpb25zKTtcbiAgICB9KSxcbiAgICBzZXRTZWxlY3Rpb246IGRvY01ldGhvZE9wKGZ1bmN0aW9uKGFuY2hvciwgaGVhZCwgb3B0aW9ucykge1xuICAgICAgc2V0U2ltcGxlU2VsZWN0aW9uKHRoaXMsIGNsaXBQb3ModGhpcywgYW5jaG9yKSwgY2xpcFBvcyh0aGlzLCBoZWFkIHx8IGFuY2hvciksIG9wdGlvbnMpO1xuICAgIH0pLFxuICAgIGV4dGVuZFNlbGVjdGlvbjogZG9jTWV0aG9kT3AoZnVuY3Rpb24oaGVhZCwgb3RoZXIsIG9wdGlvbnMpIHtcbiAgICAgIGV4dGVuZFNlbGVjdGlvbih0aGlzLCBjbGlwUG9zKHRoaXMsIGhlYWQpLCBvdGhlciAmJiBjbGlwUG9zKHRoaXMsIG90aGVyKSwgb3B0aW9ucyk7XG4gICAgfSksXG4gICAgZXh0ZW5kU2VsZWN0aW9uczogZG9jTWV0aG9kT3AoZnVuY3Rpb24oaGVhZHMsIG9wdGlvbnMpIHtcbiAgICAgIGV4dGVuZFNlbGVjdGlvbnModGhpcywgY2xpcFBvc0FycmF5KHRoaXMsIGhlYWRzLCBvcHRpb25zKSk7XG4gICAgfSksXG4gICAgZXh0ZW5kU2VsZWN0aW9uc0J5OiBkb2NNZXRob2RPcChmdW5jdGlvbihmLCBvcHRpb25zKSB7XG4gICAgICBleHRlbmRTZWxlY3Rpb25zKHRoaXMsIG1hcCh0aGlzLnNlbC5yYW5nZXMsIGYpLCBvcHRpb25zKTtcbiAgICB9KSxcbiAgICBzZXRTZWxlY3Rpb25zOiBkb2NNZXRob2RPcChmdW5jdGlvbihyYW5nZXMsIHByaW1hcnksIG9wdGlvbnMpIHtcbiAgICAgIGlmICghcmFuZ2VzLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIG91dCA9IFtdOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKVxuICAgICAgICBvdXRbaV0gPSBuZXcgUmFuZ2UoY2xpcFBvcyh0aGlzLCByYW5nZXNbaV0uYW5jaG9yKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaXBQb3ModGhpcywgcmFuZ2VzW2ldLmhlYWQpKTtcbiAgICAgIGlmIChwcmltYXJ5ID09IG51bGwpIHByaW1hcnkgPSBNYXRoLm1pbihyYW5nZXMubGVuZ3RoIC0gMSwgdGhpcy5zZWwucHJpbUluZGV4KTtcbiAgICAgIHNldFNlbGVjdGlvbih0aGlzLCBub3JtYWxpemVTZWxlY3Rpb24ob3V0LCBwcmltYXJ5KSwgb3B0aW9ucyk7XG4gICAgfSksXG4gICAgYWRkU2VsZWN0aW9uOiBkb2NNZXRob2RPcChmdW5jdGlvbihhbmNob3IsIGhlYWQsIG9wdGlvbnMpIHtcbiAgICAgIHZhciByYW5nZXMgPSB0aGlzLnNlbC5yYW5nZXMuc2xpY2UoMCk7XG4gICAgICByYW5nZXMucHVzaChuZXcgUmFuZ2UoY2xpcFBvcyh0aGlzLCBhbmNob3IpLCBjbGlwUG9zKHRoaXMsIGhlYWQgfHwgYW5jaG9yKSkpO1xuICAgICAgc2V0U2VsZWN0aW9uKHRoaXMsIG5vcm1hbGl6ZVNlbGVjdGlvbihyYW5nZXMsIHJhbmdlcy5sZW5ndGggLSAxKSwgb3B0aW9ucyk7XG4gICAgfSksXG5cbiAgICBnZXRTZWxlY3Rpb246IGZ1bmN0aW9uKGxpbmVTZXApIHtcbiAgICAgIHZhciByYW5nZXMgPSB0aGlzLnNlbC5yYW5nZXMsIGxpbmVzO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHNlbCA9IGdldEJldHdlZW4odGhpcywgcmFuZ2VzW2ldLmZyb20oKSwgcmFuZ2VzW2ldLnRvKCkpO1xuICAgICAgICBsaW5lcyA9IGxpbmVzID8gbGluZXMuY29uY2F0KHNlbCkgOiBzZWw7XG4gICAgICB9XG4gICAgICBpZiAobGluZVNlcCA9PT0gZmFsc2UpIHJldHVybiBsaW5lcztcbiAgICAgIGVsc2UgcmV0dXJuIGxpbmVzLmpvaW4obGluZVNlcCB8fCB0aGlzLmxpbmVTZXBhcmF0b3IoKSk7XG4gICAgfSxcbiAgICBnZXRTZWxlY3Rpb25zOiBmdW5jdGlvbihsaW5lU2VwKSB7XG4gICAgICB2YXIgcGFydHMgPSBbXSwgcmFuZ2VzID0gdGhpcy5zZWwucmFuZ2VzO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHNlbCA9IGdldEJldHdlZW4odGhpcywgcmFuZ2VzW2ldLmZyb20oKSwgcmFuZ2VzW2ldLnRvKCkpO1xuICAgICAgICBpZiAobGluZVNlcCAhPT0gZmFsc2UpIHNlbCA9IHNlbC5qb2luKGxpbmVTZXAgfHwgdGhpcy5saW5lU2VwYXJhdG9yKCkpO1xuICAgICAgICBwYXJ0c1tpXSA9IHNlbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJ0cztcbiAgICB9LFxuICAgIHJlcGxhY2VTZWxlY3Rpb246IGZ1bmN0aW9uKGNvZGUsIGNvbGxhcHNlLCBvcmlnaW4pIHtcbiAgICAgIHZhciBkdXAgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWwucmFuZ2VzLmxlbmd0aDsgaSsrKVxuICAgICAgICBkdXBbaV0gPSBjb2RlO1xuICAgICAgdGhpcy5yZXBsYWNlU2VsZWN0aW9ucyhkdXAsIGNvbGxhcHNlLCBvcmlnaW4gfHwgXCIraW5wdXRcIik7XG4gICAgfSxcbiAgICByZXBsYWNlU2VsZWN0aW9uczogZG9jTWV0aG9kT3AoZnVuY3Rpb24oY29kZSwgY29sbGFwc2UsIG9yaWdpbikge1xuICAgICAgdmFyIGNoYW5nZXMgPSBbXSwgc2VsID0gdGhpcy5zZWw7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbC5yYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHJhbmdlID0gc2VsLnJhbmdlc1tpXTtcbiAgICAgICAgY2hhbmdlc1tpXSA9IHtmcm9tOiByYW5nZS5mcm9tKCksIHRvOiByYW5nZS50bygpLCB0ZXh0OiB0aGlzLnNwbGl0TGluZXMoY29kZVtpXSksIG9yaWdpbjogb3JpZ2lufTtcbiAgICAgIH1cbiAgICAgIHZhciBuZXdTZWwgPSBjb2xsYXBzZSAmJiBjb2xsYXBzZSAhPSBcImVuZFwiICYmIGNvbXB1dGVSZXBsYWNlZFNlbCh0aGlzLCBjaGFuZ2VzLCBjb2xsYXBzZSk7XG4gICAgICBmb3IgKHZhciBpID0gY2hhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSlcbiAgICAgICAgbWFrZUNoYW5nZSh0aGlzLCBjaGFuZ2VzW2ldKTtcbiAgICAgIGlmIChuZXdTZWwpIHNldFNlbGVjdGlvblJlcGxhY2VIaXN0b3J5KHRoaXMsIG5ld1NlbCk7XG4gICAgICBlbHNlIGlmICh0aGlzLmNtKSBlbnN1cmVDdXJzb3JWaXNpYmxlKHRoaXMuY20pO1xuICAgIH0pLFxuICAgIHVuZG86IGRvY01ldGhvZE9wKGZ1bmN0aW9uKCkge21ha2VDaGFuZ2VGcm9tSGlzdG9yeSh0aGlzLCBcInVuZG9cIik7fSksXG4gICAgcmVkbzogZG9jTWV0aG9kT3AoZnVuY3Rpb24oKSB7bWFrZUNoYW5nZUZyb21IaXN0b3J5KHRoaXMsIFwicmVkb1wiKTt9KSxcbiAgICB1bmRvU2VsZWN0aW9uOiBkb2NNZXRob2RPcChmdW5jdGlvbigpIHttYWtlQ2hhbmdlRnJvbUhpc3RvcnkodGhpcywgXCJ1bmRvXCIsIHRydWUpO30pLFxuICAgIHJlZG9TZWxlY3Rpb246IGRvY01ldGhvZE9wKGZ1bmN0aW9uKCkge21ha2VDaGFuZ2VGcm9tSGlzdG9yeSh0aGlzLCBcInJlZG9cIiwgdHJ1ZSk7fSksXG5cbiAgICBzZXRFeHRlbmRpbmc6IGZ1bmN0aW9uKHZhbCkge3RoaXMuZXh0ZW5kID0gdmFsO30sXG4gICAgZ2V0RXh0ZW5kaW5nOiBmdW5jdGlvbigpIHtyZXR1cm4gdGhpcy5leHRlbmQ7fSxcblxuICAgIGhpc3RvcnlTaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBoaXN0ID0gdGhpcy5oaXN0b3J5LCBkb25lID0gMCwgdW5kb25lID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGlzdC5kb25lLmxlbmd0aDsgaSsrKSBpZiAoIWhpc3QuZG9uZVtpXS5yYW5nZXMpICsrZG9uZTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGlzdC51bmRvbmUubGVuZ3RoOyBpKyspIGlmICghaGlzdC51bmRvbmVbaV0ucmFuZ2VzKSArK3VuZG9uZTtcbiAgICAgIHJldHVybiB7dW5kbzogZG9uZSwgcmVkbzogdW5kb25lfTtcbiAgICB9LFxuICAgIGNsZWFySGlzdG9yeTogZnVuY3Rpb24oKSB7dGhpcy5oaXN0b3J5ID0gbmV3IEhpc3RvcnkodGhpcy5oaXN0b3J5Lm1heEdlbmVyYXRpb24pO30sXG5cbiAgICBtYXJrQ2xlYW46IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5jbGVhbkdlbmVyYXRpb24gPSB0aGlzLmNoYW5nZUdlbmVyYXRpb24odHJ1ZSk7XG4gICAgfSxcbiAgICBjaGFuZ2VHZW5lcmF0aW9uOiBmdW5jdGlvbihmb3JjZVNwbGl0KSB7XG4gICAgICBpZiAoZm9yY2VTcGxpdClcbiAgICAgICAgdGhpcy5oaXN0b3J5Lmxhc3RPcCA9IHRoaXMuaGlzdG9yeS5sYXN0U2VsT3AgPSB0aGlzLmhpc3RvcnkubGFzdE9yaWdpbiA9IG51bGw7XG4gICAgICByZXR1cm4gdGhpcy5oaXN0b3J5LmdlbmVyYXRpb247XG4gICAgfSxcbiAgICBpc0NsZWFuOiBmdW5jdGlvbiAoZ2VuKSB7XG4gICAgICByZXR1cm4gdGhpcy5oaXN0b3J5LmdlbmVyYXRpb24gPT0gKGdlbiB8fCB0aGlzLmNsZWFuR2VuZXJhdGlvbik7XG4gICAgfSxcblxuICAgIGdldEhpc3Rvcnk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHtkb25lOiBjb3B5SGlzdG9yeUFycmF5KHRoaXMuaGlzdG9yeS5kb25lKSxcbiAgICAgICAgICAgICAgdW5kb25lOiBjb3B5SGlzdG9yeUFycmF5KHRoaXMuaGlzdG9yeS51bmRvbmUpfTtcbiAgICB9LFxuICAgIHNldEhpc3Rvcnk6IGZ1bmN0aW9uKGhpc3REYXRhKSB7XG4gICAgICB2YXIgaGlzdCA9IHRoaXMuaGlzdG9yeSA9IG5ldyBIaXN0b3J5KHRoaXMuaGlzdG9yeS5tYXhHZW5lcmF0aW9uKTtcbiAgICAgIGhpc3QuZG9uZSA9IGNvcHlIaXN0b3J5QXJyYXkoaGlzdERhdGEuZG9uZS5zbGljZSgwKSwgbnVsbCwgdHJ1ZSk7XG4gICAgICBoaXN0LnVuZG9uZSA9IGNvcHlIaXN0b3J5QXJyYXkoaGlzdERhdGEudW5kb25lLnNsaWNlKDApLCBudWxsLCB0cnVlKTtcbiAgICB9LFxuXG4gICAgYWRkTGluZUNsYXNzOiBkb2NNZXRob2RPcChmdW5jdGlvbihoYW5kbGUsIHdoZXJlLCBjbHMpIHtcbiAgICAgIHJldHVybiBjaGFuZ2VMaW5lKHRoaXMsIGhhbmRsZSwgd2hlcmUgPT0gXCJndXR0ZXJcIiA/IFwiZ3V0dGVyXCIgOiBcImNsYXNzXCIsIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgdmFyIHByb3AgPSB3aGVyZSA9PSBcInRleHRcIiA/IFwidGV4dENsYXNzXCJcbiAgICAgICAgICAgICAgICAgOiB3aGVyZSA9PSBcImJhY2tncm91bmRcIiA/IFwiYmdDbGFzc1wiXG4gICAgICAgICAgICAgICAgIDogd2hlcmUgPT0gXCJndXR0ZXJcIiA/IFwiZ3V0dGVyQ2xhc3NcIiA6IFwid3JhcENsYXNzXCI7XG4gICAgICAgIGlmICghbGluZVtwcm9wXSkgbGluZVtwcm9wXSA9IGNscztcbiAgICAgICAgZWxzZSBpZiAoY2xhc3NUZXN0KGNscykudGVzdChsaW5lW3Byb3BdKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBlbHNlIGxpbmVbcHJvcF0gKz0gXCIgXCIgKyBjbHM7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSk7XG4gICAgfSksXG4gICAgcmVtb3ZlTGluZUNsYXNzOiBkb2NNZXRob2RPcChmdW5jdGlvbihoYW5kbGUsIHdoZXJlLCBjbHMpIHtcbiAgICAgIHJldHVybiBjaGFuZ2VMaW5lKHRoaXMsIGhhbmRsZSwgd2hlcmUgPT0gXCJndXR0ZXJcIiA/IFwiZ3V0dGVyXCIgOiBcImNsYXNzXCIsIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgdmFyIHByb3AgPSB3aGVyZSA9PSBcInRleHRcIiA/IFwidGV4dENsYXNzXCJcbiAgICAgICAgICAgICAgICAgOiB3aGVyZSA9PSBcImJhY2tncm91bmRcIiA/IFwiYmdDbGFzc1wiXG4gICAgICAgICAgICAgICAgIDogd2hlcmUgPT0gXCJndXR0ZXJcIiA/IFwiZ3V0dGVyQ2xhc3NcIiA6IFwid3JhcENsYXNzXCI7XG4gICAgICAgIHZhciBjdXIgPSBsaW5lW3Byb3BdO1xuICAgICAgICBpZiAoIWN1cikgcmV0dXJuIGZhbHNlO1xuICAgICAgICBlbHNlIGlmIChjbHMgPT0gbnVsbCkgbGluZVtwcm9wXSA9IG51bGw7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhciBmb3VuZCA9IGN1ci5tYXRjaChjbGFzc1Rlc3QoY2xzKSk7XG4gICAgICAgICAgaWYgKCFmb3VuZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIHZhciBlbmQgPSBmb3VuZC5pbmRleCArIGZvdW5kWzBdLmxlbmd0aDtcbiAgICAgICAgICBsaW5lW3Byb3BdID0gY3VyLnNsaWNlKDAsIGZvdW5kLmluZGV4KSArICghZm91bmQuaW5kZXggfHwgZW5kID09IGN1ci5sZW5ndGggPyBcIlwiIDogXCIgXCIpICsgY3VyLnNsaWNlKGVuZCkgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgYWRkTGluZVdpZGdldDogZG9jTWV0aG9kT3AoZnVuY3Rpb24oaGFuZGxlLCBub2RlLCBvcHRpb25zKSB7XG4gICAgICByZXR1cm4gYWRkTGluZVdpZGdldCh0aGlzLCBoYW5kbGUsIG5vZGUsIG9wdGlvbnMpO1xuICAgIH0pLFxuICAgIHJlbW92ZUxpbmVXaWRnZXQ6IGZ1bmN0aW9uKHdpZGdldCkgeyB3aWRnZXQuY2xlYXIoKTsgfSxcblxuICAgIG1hcmtUZXh0OiBmdW5jdGlvbihmcm9tLCB0bywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIG1hcmtUZXh0KHRoaXMsIGNsaXBQb3ModGhpcywgZnJvbSksIGNsaXBQb3ModGhpcywgdG8pLCBvcHRpb25zLCBvcHRpb25zICYmIG9wdGlvbnMudHlwZSB8fCBcInJhbmdlXCIpO1xuICAgIH0sXG4gICAgc2V0Qm9va21hcms6IGZ1bmN0aW9uKHBvcywgb3B0aW9ucykge1xuICAgICAgdmFyIHJlYWxPcHRzID0ge3JlcGxhY2VkV2l0aDogb3B0aW9ucyAmJiAob3B0aW9ucy5ub2RlVHlwZSA9PSBudWxsID8gb3B0aW9ucy53aWRnZXQgOiBvcHRpb25zKSxcbiAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRMZWZ0OiBvcHRpb25zICYmIG9wdGlvbnMuaW5zZXJ0TGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICBjbGVhcldoZW5FbXB0eTogZmFsc2UsIHNoYXJlZDogb3B0aW9ucyAmJiBvcHRpb25zLnNoYXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVNb3VzZUV2ZW50czogb3B0aW9ucyAmJiBvcHRpb25zLmhhbmRsZU1vdXNlRXZlbnRzfTtcbiAgICAgIHBvcyA9IGNsaXBQb3ModGhpcywgcG9zKTtcbiAgICAgIHJldHVybiBtYXJrVGV4dCh0aGlzLCBwb3MsIHBvcywgcmVhbE9wdHMsIFwiYm9va21hcmtcIik7XG4gICAgfSxcbiAgICBmaW5kTWFya3NBdDogZnVuY3Rpb24ocG9zKSB7XG4gICAgICBwb3MgPSBjbGlwUG9zKHRoaXMsIHBvcyk7XG4gICAgICB2YXIgbWFya2VycyA9IFtdLCBzcGFucyA9IGdldExpbmUodGhpcywgcG9zLmxpbmUpLm1hcmtlZFNwYW5zO1xuICAgICAgaWYgKHNwYW5zKSBmb3IgKHZhciBpID0gMDsgaSA8IHNwYW5zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBzcGFuID0gc3BhbnNbaV07XG4gICAgICAgIGlmICgoc3Bhbi5mcm9tID09IG51bGwgfHwgc3Bhbi5mcm9tIDw9IHBvcy5jaCkgJiZcbiAgICAgICAgICAgIChzcGFuLnRvID09IG51bGwgfHwgc3Bhbi50byA+PSBwb3MuY2gpKVxuICAgICAgICAgIG1hcmtlcnMucHVzaChzcGFuLm1hcmtlci5wYXJlbnQgfHwgc3Bhbi5tYXJrZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hcmtlcnM7XG4gICAgfSxcbiAgICBmaW5kTWFya3M6IGZ1bmN0aW9uKGZyb20sIHRvLCBmaWx0ZXIpIHtcbiAgICAgIGZyb20gPSBjbGlwUG9zKHRoaXMsIGZyb20pOyB0byA9IGNsaXBQb3ModGhpcywgdG8pO1xuICAgICAgdmFyIGZvdW5kID0gW10sIGxpbmVObyA9IGZyb20ubGluZTtcbiAgICAgIHRoaXMuaXRlcihmcm9tLmxpbmUsIHRvLmxpbmUgKyAxLCBmdW5jdGlvbihsaW5lKSB7XG4gICAgICAgIHZhciBzcGFucyA9IGxpbmUubWFya2VkU3BhbnM7XG4gICAgICAgIGlmIChzcGFucykgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGFucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBzcGFuID0gc3BhbnNbaV07XG4gICAgICAgICAgaWYgKCEobGluZU5vID09IGZyb20ubGluZSAmJiBmcm9tLmNoID4gc3Bhbi50byB8fFxuICAgICAgICAgICAgICAgIHNwYW4uZnJvbSA9PSBudWxsICYmIGxpbmVObyAhPSBmcm9tLmxpbmV8fFxuICAgICAgICAgICAgICAgIGxpbmVObyA9PSB0by5saW5lICYmIHNwYW4uZnJvbSA+IHRvLmNoKSAmJlxuICAgICAgICAgICAgICAoIWZpbHRlciB8fCBmaWx0ZXIoc3Bhbi5tYXJrZXIpKSlcbiAgICAgICAgICAgIGZvdW5kLnB1c2goc3Bhbi5tYXJrZXIucGFyZW50IHx8IHNwYW4ubWFya2VyKTtcbiAgICAgICAgfVxuICAgICAgICArK2xpbmVObztcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG4gICAgZ2V0QWxsTWFya3M6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAgIHRoaXMuaXRlcihmdW5jdGlvbihsaW5lKSB7XG4gICAgICAgIHZhciBzcHMgPSBsaW5lLm1hcmtlZFNwYW5zO1xuICAgICAgICBpZiAoc3BzKSBmb3IgKHZhciBpID0gMDsgaSA8IHNwcy5sZW5ndGg7ICsraSlcbiAgICAgICAgICBpZiAoc3BzW2ldLmZyb20gIT0gbnVsbCkgbWFya2Vycy5wdXNoKHNwc1tpXS5tYXJrZXIpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWFya2VycztcbiAgICB9LFxuXG4gICAgcG9zRnJvbUluZGV4OiBmdW5jdGlvbihvZmYpIHtcbiAgICAgIHZhciBjaCwgbGluZU5vID0gdGhpcy5maXJzdDtcbiAgICAgIHRoaXMuaXRlcihmdW5jdGlvbihsaW5lKSB7XG4gICAgICAgIHZhciBzeiA9IGxpbmUudGV4dC5sZW5ndGggKyAxO1xuICAgICAgICBpZiAoc3ogPiBvZmYpIHsgY2ggPSBvZmY7IHJldHVybiB0cnVlOyB9XG4gICAgICAgIG9mZiAtPSBzejtcbiAgICAgICAgKytsaW5lTm87XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjbGlwUG9zKHRoaXMsIFBvcyhsaW5lTm8sIGNoKSk7XG4gICAgfSxcbiAgICBpbmRleEZyb21Qb3M6IGZ1bmN0aW9uIChjb29yZHMpIHtcbiAgICAgIGNvb3JkcyA9IGNsaXBQb3ModGhpcywgY29vcmRzKTtcbiAgICAgIHZhciBpbmRleCA9IGNvb3Jkcy5jaDtcbiAgICAgIGlmIChjb29yZHMubGluZSA8IHRoaXMuZmlyc3QgfHwgY29vcmRzLmNoIDwgMCkgcmV0dXJuIDA7XG4gICAgICB0aGlzLml0ZXIodGhpcy5maXJzdCwgY29vcmRzLmxpbmUsIGZ1bmN0aW9uIChsaW5lKSB7XG4gICAgICAgIGluZGV4ICs9IGxpbmUudGV4dC5sZW5ndGggKyAxO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gaW5kZXg7XG4gICAgfSxcblxuICAgIGNvcHk6IGZ1bmN0aW9uKGNvcHlIaXN0b3J5KSB7XG4gICAgICB2YXIgZG9jID0gbmV3IERvYyhnZXRMaW5lcyh0aGlzLCB0aGlzLmZpcnN0LCB0aGlzLmZpcnN0ICsgdGhpcy5zaXplKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZU9wdGlvbiwgdGhpcy5maXJzdCwgdGhpcy5saW5lU2VwKTtcbiAgICAgIGRvYy5zY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDsgZG9jLnNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQ7XG4gICAgICBkb2Muc2VsID0gdGhpcy5zZWw7XG4gICAgICBkb2MuZXh0ZW5kID0gZmFsc2U7XG4gICAgICBpZiAoY29weUhpc3RvcnkpIHtcbiAgICAgICAgZG9jLmhpc3RvcnkudW5kb0RlcHRoID0gdGhpcy5oaXN0b3J5LnVuZG9EZXB0aDtcbiAgICAgICAgZG9jLnNldEhpc3RvcnkodGhpcy5nZXRIaXN0b3J5KCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRvYztcbiAgICB9LFxuXG4gICAgbGlua2VkRG9jOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fTtcbiAgICAgIHZhciBmcm9tID0gdGhpcy5maXJzdCwgdG8gPSB0aGlzLmZpcnN0ICsgdGhpcy5zaXplO1xuICAgICAgaWYgKG9wdGlvbnMuZnJvbSAhPSBudWxsICYmIG9wdGlvbnMuZnJvbSA+IGZyb20pIGZyb20gPSBvcHRpb25zLmZyb207XG4gICAgICBpZiAob3B0aW9ucy50byAhPSBudWxsICYmIG9wdGlvbnMudG8gPCB0bykgdG8gPSBvcHRpb25zLnRvO1xuICAgICAgdmFyIGNvcHkgPSBuZXcgRG9jKGdldExpbmVzKHRoaXMsIGZyb20sIHRvKSwgb3B0aW9ucy5tb2RlIHx8IHRoaXMubW9kZU9wdGlvbiwgZnJvbSwgdGhpcy5saW5lU2VwKTtcbiAgICAgIGlmIChvcHRpb25zLnNoYXJlZEhpc3QpIGNvcHkuaGlzdG9yeSA9IHRoaXMuaGlzdG9yeTtcbiAgICAgICh0aGlzLmxpbmtlZCB8fCAodGhpcy5saW5rZWQgPSBbXSkpLnB1c2goe2RvYzogY29weSwgc2hhcmVkSGlzdDogb3B0aW9ucy5zaGFyZWRIaXN0fSk7XG4gICAgICBjb3B5LmxpbmtlZCA9IFt7ZG9jOiB0aGlzLCBpc1BhcmVudDogdHJ1ZSwgc2hhcmVkSGlzdDogb3B0aW9ucy5zaGFyZWRIaXN0fV07XG4gICAgICBjb3B5U2hhcmVkTWFya2Vycyhjb3B5LCBmaW5kU2hhcmVkTWFya2Vycyh0aGlzKSk7XG4gICAgICByZXR1cm4gY29weTtcbiAgICB9LFxuICAgIHVubGlua0RvYzogZnVuY3Rpb24ob3RoZXIpIHtcbiAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIENvZGVNaXJyb3IpIG90aGVyID0gb3RoZXIuZG9jO1xuICAgICAgaWYgKHRoaXMubGlua2VkKSBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGlua2VkLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBsaW5rID0gdGhpcy5saW5rZWRbaV07XG4gICAgICAgIGlmIChsaW5rLmRvYyAhPSBvdGhlcikgY29udGludWU7XG4gICAgICAgIHRoaXMubGlua2VkLnNwbGljZShpLCAxKTtcbiAgICAgICAgb3RoZXIudW5saW5rRG9jKHRoaXMpO1xuICAgICAgICBkZXRhY2hTaGFyZWRNYXJrZXJzKGZpbmRTaGFyZWRNYXJrZXJzKHRoaXMpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICAvLyBJZiB0aGUgaGlzdG9yaWVzIHdlcmUgc2hhcmVkLCBzcGxpdCB0aGVtIGFnYWluXG4gICAgICBpZiAob3RoZXIuaGlzdG9yeSA9PSB0aGlzLmhpc3RvcnkpIHtcbiAgICAgICAgdmFyIHNwbGl0SWRzID0gW290aGVyLmlkXTtcbiAgICAgICAgbGlua2VkRG9jcyhvdGhlciwgZnVuY3Rpb24oZG9jKSB7c3BsaXRJZHMucHVzaChkb2MuaWQpO30sIHRydWUpO1xuICAgICAgICBvdGhlci5oaXN0b3J5ID0gbmV3IEhpc3RvcnkobnVsbCk7XG4gICAgICAgIG90aGVyLmhpc3RvcnkuZG9uZSA9IGNvcHlIaXN0b3J5QXJyYXkodGhpcy5oaXN0b3J5LmRvbmUsIHNwbGl0SWRzKTtcbiAgICAgICAgb3RoZXIuaGlzdG9yeS51bmRvbmUgPSBjb3B5SGlzdG9yeUFycmF5KHRoaXMuaGlzdG9yeS51bmRvbmUsIHNwbGl0SWRzKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGl0ZXJMaW5rZWREb2NzOiBmdW5jdGlvbihmKSB7bGlua2VkRG9jcyh0aGlzLCBmKTt9LFxuXG4gICAgZ2V0TW9kZTogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMubW9kZTt9LFxuICAgIGdldEVkaXRvcjogZnVuY3Rpb24oKSB7cmV0dXJuIHRoaXMuY207fSxcblxuICAgIHNwbGl0TGluZXM6IGZ1bmN0aW9uKHN0cikge1xuICAgICAgaWYgKHRoaXMubGluZVNlcCkgcmV0dXJuIHN0ci5zcGxpdCh0aGlzLmxpbmVTZXApO1xuICAgICAgcmV0dXJuIHNwbGl0TGluZXNBdXRvKHN0cik7XG4gICAgfSxcbiAgICBsaW5lU2VwYXJhdG9yOiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMubGluZVNlcCB8fCBcIlxcblwiOyB9XG4gIH0pO1xuXG4gIC8vIFB1YmxpYyBhbGlhcy5cbiAgRG9jLnByb3RvdHlwZS5lYWNoTGluZSA9IERvYy5wcm90b3R5cGUuaXRlcjtcblxuICAvLyBTZXQgdXAgbWV0aG9kcyBvbiBDb2RlTWlycm9yJ3MgcHJvdG90eXBlIHRvIHJlZGlyZWN0IHRvIHRoZSBlZGl0b3IncyBkb2N1bWVudC5cbiAgdmFyIGRvbnREZWxlZ2F0ZSA9IFwiaXRlciBpbnNlcnQgcmVtb3ZlIGNvcHkgZ2V0RWRpdG9yIGNvbnN0cnVjdG9yXCIuc3BsaXQoXCIgXCIpO1xuICBmb3IgKHZhciBwcm9wIGluIERvYy5wcm90b3R5cGUpIGlmIChEb2MucHJvdG90eXBlLmhhc093blByb3BlcnR5KHByb3ApICYmIGluZGV4T2YoZG9udERlbGVnYXRlLCBwcm9wKSA8IDApXG4gICAgQ29kZU1pcnJvci5wcm90b3R5cGVbcHJvcF0gPSAoZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7cmV0dXJuIG1ldGhvZC5hcHBseSh0aGlzLmRvYywgYXJndW1lbnRzKTt9O1xuICAgIH0pKERvYy5wcm90b3R5cGVbcHJvcF0pO1xuXG4gIGV2ZW50TWl4aW4oRG9jKTtcblxuICAvLyBDYWxsIGYgZm9yIGFsbCBsaW5rZWQgZG9jdW1lbnRzLlxuICBmdW5jdGlvbiBsaW5rZWREb2NzKGRvYywgZiwgc2hhcmVkSGlzdE9ubHkpIHtcbiAgICBmdW5jdGlvbiBwcm9wYWdhdGUoZG9jLCBza2lwLCBzaGFyZWRIaXN0KSB7XG4gICAgICBpZiAoZG9jLmxpbmtlZCkgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2MubGlua2VkLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciByZWwgPSBkb2MubGlua2VkW2ldO1xuICAgICAgICBpZiAocmVsLmRvYyA9PSBza2lwKSBjb250aW51ZTtcbiAgICAgICAgdmFyIHNoYXJlZCA9IHNoYXJlZEhpc3QgJiYgcmVsLnNoYXJlZEhpc3Q7XG4gICAgICAgIGlmIChzaGFyZWRIaXN0T25seSAmJiAhc2hhcmVkKSBjb250aW51ZTtcbiAgICAgICAgZihyZWwuZG9jLCBzaGFyZWQpO1xuICAgICAgICBwcm9wYWdhdGUocmVsLmRvYywgZG9jLCBzaGFyZWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBwcm9wYWdhdGUoZG9jLCBudWxsLCB0cnVlKTtcbiAgfVxuXG4gIC8vIEF0dGFjaCBhIGRvY3VtZW50IHRvIGFuIGVkaXRvci5cbiAgZnVuY3Rpb24gYXR0YWNoRG9jKGNtLCBkb2MpIHtcbiAgICBpZiAoZG9jLmNtKSB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIGRvY3VtZW50IGlzIGFscmVhZHkgaW4gdXNlLlwiKTtcbiAgICBjbS5kb2MgPSBkb2M7XG4gICAgZG9jLmNtID0gY207XG4gICAgZXN0aW1hdGVMaW5lSGVpZ2h0cyhjbSk7XG4gICAgbG9hZE1vZGUoY20pO1xuICAgIGlmICghY20ub3B0aW9ucy5saW5lV3JhcHBpbmcpIGZpbmRNYXhMaW5lKGNtKTtcbiAgICBjbS5vcHRpb25zLm1vZGUgPSBkb2MubW9kZU9wdGlvbjtcbiAgICByZWdDaGFuZ2UoY20pO1xuICB9XG5cbiAgLy8gTElORSBVVElMSVRJRVNcblxuICAvLyBGaW5kIHRoZSBsaW5lIG9iamVjdCBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBsaW5lIG51bWJlci5cbiAgZnVuY3Rpb24gZ2V0TGluZShkb2MsIG4pIHtcbiAgICBuIC09IGRvYy5maXJzdDtcbiAgICBpZiAobiA8IDAgfHwgbiA+PSBkb2Muc2l6ZSkgdGhyb3cgbmV3IEVycm9yKFwiVGhlcmUgaXMgbm8gbGluZSBcIiArIChuICsgZG9jLmZpcnN0KSArIFwiIGluIHRoZSBkb2N1bWVudC5cIik7XG4gICAgZm9yICh2YXIgY2h1bmsgPSBkb2M7ICFjaHVuay5saW5lczspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOzsgKytpKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IGNodW5rLmNoaWxkcmVuW2ldLCBzeiA9IGNoaWxkLmNodW5rU2l6ZSgpO1xuICAgICAgICBpZiAobiA8IHN6KSB7IGNodW5rID0gY2hpbGQ7IGJyZWFrOyB9XG4gICAgICAgIG4gLT0gc3o7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjaHVuay5saW5lc1tuXTtcbiAgfVxuXG4gIC8vIEdldCB0aGUgcGFydCBvZiBhIGRvY3VtZW50IGJldHdlZW4gdHdvIHBvc2l0aW9ucywgYXMgYW4gYXJyYXkgb2ZcbiAgLy8gc3RyaW5ncy5cbiAgZnVuY3Rpb24gZ2V0QmV0d2Vlbihkb2MsIHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgb3V0ID0gW10sIG4gPSBzdGFydC5saW5lO1xuICAgIGRvYy5pdGVyKHN0YXJ0LmxpbmUsIGVuZC5saW5lICsgMSwgZnVuY3Rpb24obGluZSkge1xuICAgICAgdmFyIHRleHQgPSBsaW5lLnRleHQ7XG4gICAgICBpZiAobiA9PSBlbmQubGluZSkgdGV4dCA9IHRleHQuc2xpY2UoMCwgZW5kLmNoKTtcbiAgICAgIGlmIChuID09IHN0YXJ0LmxpbmUpIHRleHQgPSB0ZXh0LnNsaWNlKHN0YXJ0LmNoKTtcbiAgICAgIG91dC5wdXNoKHRleHQpO1xuICAgICAgKytuO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cbiAgLy8gR2V0IHRoZSBsaW5lcyBiZXR3ZWVuIGZyb20gYW5kIHRvLCBhcyBhcnJheSBvZiBzdHJpbmdzLlxuICBmdW5jdGlvbiBnZXRMaW5lcyhkb2MsIGZyb20sIHRvKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIGRvYy5pdGVyKGZyb20sIHRvLCBmdW5jdGlvbihsaW5lKSB7IG91dC5wdXNoKGxpbmUudGV4dCk7IH0pO1xuICAgIHJldHVybiBvdXQ7XG4gIH1cblxuICAvLyBVcGRhdGUgdGhlIGhlaWdodCBvZiBhIGxpbmUsIHByb3BhZ2F0aW5nIHRoZSBoZWlnaHQgY2hhbmdlXG4gIC8vIHVwd2FyZHMgdG8gcGFyZW50IG5vZGVzLlxuICBmdW5jdGlvbiB1cGRhdGVMaW5lSGVpZ2h0KGxpbmUsIGhlaWdodCkge1xuICAgIHZhciBkaWZmID0gaGVpZ2h0IC0gbGluZS5oZWlnaHQ7XG4gICAgaWYgKGRpZmYpIGZvciAodmFyIG4gPSBsaW5lOyBuOyBuID0gbi5wYXJlbnQpIG4uaGVpZ2h0ICs9IGRpZmY7XG4gIH1cblxuICAvLyBHaXZlbiBhIGxpbmUgb2JqZWN0LCBmaW5kIGl0cyBsaW5lIG51bWJlciBieSB3YWxraW5nIHVwIHRocm91Z2hcbiAgLy8gaXRzIHBhcmVudCBsaW5rcy5cbiAgZnVuY3Rpb24gbGluZU5vKGxpbmUpIHtcbiAgICBpZiAobGluZS5wYXJlbnQgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gICAgdmFyIGN1ciA9IGxpbmUucGFyZW50LCBubyA9IGluZGV4T2YoY3VyLmxpbmVzLCBsaW5lKTtcbiAgICBmb3IgKHZhciBjaHVuayA9IGN1ci5wYXJlbnQ7IGNodW5rOyBjdXIgPSBjaHVuaywgY2h1bmsgPSBjaHVuay5wYXJlbnQpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOzsgKytpKSB7XG4gICAgICAgIGlmIChjaHVuay5jaGlsZHJlbltpXSA9PSBjdXIpIGJyZWFrO1xuICAgICAgICBubyArPSBjaHVuay5jaGlsZHJlbltpXS5jaHVua1NpemUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vICsgY3VyLmZpcnN0O1xuICB9XG5cbiAgLy8gRmluZCB0aGUgbGluZSBhdCB0aGUgZ2l2ZW4gdmVydGljYWwgcG9zaXRpb24sIHVzaW5nIHRoZSBoZWlnaHRcbiAgLy8gaW5mb3JtYXRpb24gaW4gdGhlIGRvY3VtZW50IHRyZWUuXG4gIGZ1bmN0aW9uIGxpbmVBdEhlaWdodChjaHVuaywgaCkge1xuICAgIHZhciBuID0gY2h1bmsuZmlyc3Q7XG4gICAgb3V0ZXI6IGRvIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2h1bmsuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gY2h1bmsuY2hpbGRyZW5baV0sIGNoID0gY2hpbGQuaGVpZ2h0O1xuICAgICAgICBpZiAoaCA8IGNoKSB7IGNodW5rID0gY2hpbGQ7IGNvbnRpbnVlIG91dGVyOyB9XG4gICAgICAgIGggLT0gY2g7XG4gICAgICAgIG4gKz0gY2hpbGQuY2h1bmtTaXplKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbjtcbiAgICB9IHdoaWxlICghY2h1bmsubGluZXMpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2h1bmsubGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBsaW5lID0gY2h1bmsubGluZXNbaV0sIGxoID0gbGluZS5oZWlnaHQ7XG4gICAgICBpZiAoaCA8IGxoKSBicmVhaztcbiAgICAgIGggLT0gbGg7XG4gICAgfVxuICAgIHJldHVybiBuICsgaTtcbiAgfVxuXG5cbiAgLy8gRmluZCB0aGUgaGVpZ2h0IGFib3ZlIHRoZSBnaXZlbiBsaW5lLlxuICBmdW5jdGlvbiBoZWlnaHRBdExpbmUobGluZU9iaikge1xuICAgIGxpbmVPYmogPSB2aXN1YWxMaW5lKGxpbmVPYmopO1xuXG4gICAgdmFyIGggPSAwLCBjaHVuayA9IGxpbmVPYmoucGFyZW50O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2h1bmsubGluZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBsaW5lID0gY2h1bmsubGluZXNbaV07XG4gICAgICBpZiAobGluZSA9PSBsaW5lT2JqKSBicmVhaztcbiAgICAgIGVsc2UgaCArPSBsaW5lLmhlaWdodDtcbiAgICB9XG4gICAgZm9yICh2YXIgcCA9IGNodW5rLnBhcmVudDsgcDsgY2h1bmsgPSBwLCBwID0gY2h1bmsucGFyZW50KSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHAuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGN1ciA9IHAuY2hpbGRyZW5baV07XG4gICAgICAgIGlmIChjdXIgPT0gY2h1bmspIGJyZWFrO1xuICAgICAgICBlbHNlIGggKz0gY3VyLmhlaWdodDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGg7XG4gIH1cblxuICAvLyBHZXQgdGhlIGJpZGkgb3JkZXJpbmcgZm9yIHRoZSBnaXZlbiBsaW5lIChhbmQgY2FjaGUgaXQpLiBSZXR1cm5zXG4gIC8vIGZhbHNlIGZvciBsaW5lcyB0aGF0IGFyZSBmdWxseSBsZWZ0LXRvLXJpZ2h0LCBhbmQgYW4gYXJyYXkgb2ZcbiAgLy8gQmlkaVNwYW4gb2JqZWN0cyBvdGhlcndpc2UuXG4gIGZ1bmN0aW9uIGdldE9yZGVyKGxpbmUpIHtcbiAgICB2YXIgb3JkZXIgPSBsaW5lLm9yZGVyO1xuICAgIGlmIChvcmRlciA9PSBudWxsKSBvcmRlciA9IGxpbmUub3JkZXIgPSBiaWRpT3JkZXJpbmcobGluZS50ZXh0KTtcbiAgICByZXR1cm4gb3JkZXI7XG4gIH1cblxuICAvLyBISVNUT1JZXG5cbiAgZnVuY3Rpb24gSGlzdG9yeShzdGFydEdlbikge1xuICAgIC8vIEFycmF5cyBvZiBjaGFuZ2UgZXZlbnRzIGFuZCBzZWxlY3Rpb25zLiBEb2luZyBzb21ldGhpbmcgYWRkcyBhblxuICAgIC8vIGV2ZW50IHRvIGRvbmUgYW5kIGNsZWFycyB1bmRvLiBVbmRvaW5nIG1vdmVzIGV2ZW50cyBmcm9tIGRvbmVcbiAgICAvLyB0byB1bmRvbmUsIHJlZG9pbmcgbW92ZXMgdGhlbSBpbiB0aGUgb3RoZXIgZGlyZWN0aW9uLlxuICAgIHRoaXMuZG9uZSA9IFtdOyB0aGlzLnVuZG9uZSA9IFtdO1xuICAgIHRoaXMudW5kb0RlcHRoID0gSW5maW5pdHk7XG4gICAgLy8gVXNlZCB0byB0cmFjayB3aGVuIGNoYW5nZXMgY2FuIGJlIG1lcmdlZCBpbnRvIGEgc2luZ2xlIHVuZG9cbiAgICAvLyBldmVudFxuICAgIHRoaXMubGFzdE1vZFRpbWUgPSB0aGlzLmxhc3RTZWxUaW1lID0gMDtcbiAgICB0aGlzLmxhc3RPcCA9IHRoaXMubGFzdFNlbE9wID0gbnVsbDtcbiAgICB0aGlzLmxhc3RPcmlnaW4gPSB0aGlzLmxhc3RTZWxPcmlnaW4gPSBudWxsO1xuICAgIC8vIFVzZWQgYnkgdGhlIGlzQ2xlYW4oKSBtZXRob2RcbiAgICB0aGlzLmdlbmVyYXRpb24gPSB0aGlzLm1heEdlbmVyYXRpb24gPSBzdGFydEdlbiB8fCAxO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGEgaGlzdG9yeSBjaGFuZ2UgZXZlbnQgZnJvbSBhbiB1cGRhdGVEb2Mtc3R5bGUgY2hhbmdlXG4gIC8vIG9iamVjdC5cbiAgZnVuY3Rpb24gaGlzdG9yeUNoYW5nZUZyb21DaGFuZ2UoZG9jLCBjaGFuZ2UpIHtcbiAgICB2YXIgaGlzdENoYW5nZSA9IHtmcm9tOiBjb3B5UG9zKGNoYW5nZS5mcm9tKSwgdG86IGNoYW5nZUVuZChjaGFuZ2UpLCB0ZXh0OiBnZXRCZXR3ZWVuKGRvYywgY2hhbmdlLmZyb20sIGNoYW5nZS50byl9O1xuICAgIGF0dGFjaExvY2FsU3BhbnMoZG9jLCBoaXN0Q2hhbmdlLCBjaGFuZ2UuZnJvbS5saW5lLCBjaGFuZ2UudG8ubGluZSArIDEpO1xuICAgIGxpbmtlZERvY3MoZG9jLCBmdW5jdGlvbihkb2MpIHthdHRhY2hMb2NhbFNwYW5zKGRvYywgaGlzdENoYW5nZSwgY2hhbmdlLmZyb20ubGluZSwgY2hhbmdlLnRvLmxpbmUgKyAxKTt9LCB0cnVlKTtcbiAgICByZXR1cm4gaGlzdENoYW5nZTtcbiAgfVxuXG4gIC8vIFBvcCBhbGwgc2VsZWN0aW9uIGV2ZW50cyBvZmYgdGhlIGVuZCBvZiBhIGhpc3RvcnkgYXJyYXkuIFN0b3AgYXRcbiAgLy8gYSBjaGFuZ2UgZXZlbnQuXG4gIGZ1bmN0aW9uIGNsZWFyU2VsZWN0aW9uRXZlbnRzKGFycmF5KSB7XG4gICAgd2hpbGUgKGFycmF5Lmxlbmd0aCkge1xuICAgICAgdmFyIGxhc3QgPSBsc3QoYXJyYXkpO1xuICAgICAgaWYgKGxhc3QucmFuZ2VzKSBhcnJheS5wb3AoKTtcbiAgICAgIGVsc2UgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgLy8gRmluZCB0aGUgdG9wIGNoYW5nZSBldmVudCBpbiB0aGUgaGlzdG9yeS4gUG9wIG9mZiBzZWxlY3Rpb25cbiAgLy8gZXZlbnRzIHRoYXQgYXJlIGluIHRoZSB3YXkuXG4gIGZ1bmN0aW9uIGxhc3RDaGFuZ2VFdmVudChoaXN0LCBmb3JjZSkge1xuICAgIGlmIChmb3JjZSkge1xuICAgICAgY2xlYXJTZWxlY3Rpb25FdmVudHMoaGlzdC5kb25lKTtcbiAgICAgIHJldHVybiBsc3QoaGlzdC5kb25lKTtcbiAgICB9IGVsc2UgaWYgKGhpc3QuZG9uZS5sZW5ndGggJiYgIWxzdChoaXN0LmRvbmUpLnJhbmdlcykge1xuICAgICAgcmV0dXJuIGxzdChoaXN0LmRvbmUpO1xuICAgIH0gZWxzZSBpZiAoaGlzdC5kb25lLmxlbmd0aCA+IDEgJiYgIWhpc3QuZG9uZVtoaXN0LmRvbmUubGVuZ3RoIC0gMl0ucmFuZ2VzKSB7XG4gICAgICBoaXN0LmRvbmUucG9wKCk7XG4gICAgICByZXR1cm4gbHN0KGhpc3QuZG9uZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gUmVnaXN0ZXIgYSBjaGFuZ2UgaW4gdGhlIGhpc3RvcnkuIE1lcmdlcyBjaGFuZ2VzIHRoYXQgYXJlIHdpdGhpblxuICAvLyBhIHNpbmdsZSBvcGVyYXRpb24sIG9yZSBhcmUgY2xvc2UgdG9nZXRoZXIgd2l0aCBhbiBvcmlnaW4gdGhhdFxuICAvLyBhbGxvd3MgbWVyZ2luZyAoc3RhcnRpbmcgd2l0aCBcIitcIikgaW50byBhIHNpbmdsZSBldmVudC5cbiAgZnVuY3Rpb24gYWRkQ2hhbmdlVG9IaXN0b3J5KGRvYywgY2hhbmdlLCBzZWxBZnRlciwgb3BJZCkge1xuICAgIHZhciBoaXN0ID0gZG9jLmhpc3Rvcnk7XG4gICAgaGlzdC51bmRvbmUubGVuZ3RoID0gMDtcbiAgICB2YXIgdGltZSA9ICtuZXcgRGF0ZSwgY3VyO1xuXG4gICAgaWYgKChoaXN0Lmxhc3RPcCA9PSBvcElkIHx8XG4gICAgICAgICBoaXN0Lmxhc3RPcmlnaW4gPT0gY2hhbmdlLm9yaWdpbiAmJiBjaGFuZ2Uub3JpZ2luICYmXG4gICAgICAgICAoKGNoYW5nZS5vcmlnaW4uY2hhckF0KDApID09IFwiK1wiICYmIGRvYy5jbSAmJiBoaXN0Lmxhc3RNb2RUaW1lID4gdGltZSAtIGRvYy5jbS5vcHRpb25zLmhpc3RvcnlFdmVudERlbGF5KSB8fFxuICAgICAgICAgIGNoYW5nZS5vcmlnaW4uY2hhckF0KDApID09IFwiKlwiKSkgJiZcbiAgICAgICAgKGN1ciA9IGxhc3RDaGFuZ2VFdmVudChoaXN0LCBoaXN0Lmxhc3RPcCA9PSBvcElkKSkpIHtcbiAgICAgIC8vIE1lcmdlIHRoaXMgY2hhbmdlIGludG8gdGhlIGxhc3QgZXZlbnRcbiAgICAgIHZhciBsYXN0ID0gbHN0KGN1ci5jaGFuZ2VzKTtcbiAgICAgIGlmIChjbXAoY2hhbmdlLmZyb20sIGNoYW5nZS50bykgPT0gMCAmJiBjbXAoY2hhbmdlLmZyb20sIGxhc3QudG8pID09IDApIHtcbiAgICAgICAgLy8gT3B0aW1pemVkIGNhc2UgZm9yIHNpbXBsZSBpbnNlcnRpb24gLS0gZG9uJ3Qgd2FudCB0byBhZGRcbiAgICAgICAgLy8gbmV3IGNoYW5nZXNldHMgZm9yIGV2ZXJ5IGNoYXJhY3RlciB0eXBlZFxuICAgICAgICBsYXN0LnRvID0gY2hhbmdlRW5kKGNoYW5nZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBZGQgbmV3IHN1Yi1ldmVudFxuICAgICAgICBjdXIuY2hhbmdlcy5wdXNoKGhpc3RvcnlDaGFuZ2VGcm9tQ2hhbmdlKGRvYywgY2hhbmdlKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENhbiBub3QgYmUgbWVyZ2VkLCBzdGFydCBhIG5ldyBldmVudC5cbiAgICAgIHZhciBiZWZvcmUgPSBsc3QoaGlzdC5kb25lKTtcbiAgICAgIGlmICghYmVmb3JlIHx8ICFiZWZvcmUucmFuZ2VzKVxuICAgICAgICBwdXNoU2VsZWN0aW9uVG9IaXN0b3J5KGRvYy5zZWwsIGhpc3QuZG9uZSk7XG4gICAgICBjdXIgPSB7Y2hhbmdlczogW2hpc3RvcnlDaGFuZ2VGcm9tQ2hhbmdlKGRvYywgY2hhbmdlKV0sXG4gICAgICAgICAgICAgZ2VuZXJhdGlvbjogaGlzdC5nZW5lcmF0aW9ufTtcbiAgICAgIGhpc3QuZG9uZS5wdXNoKGN1cik7XG4gICAgICB3aGlsZSAoaGlzdC5kb25lLmxlbmd0aCA+IGhpc3QudW5kb0RlcHRoKSB7XG4gICAgICAgIGhpc3QuZG9uZS5zaGlmdCgpO1xuICAgICAgICBpZiAoIWhpc3QuZG9uZVswXS5yYW5nZXMpIGhpc3QuZG9uZS5zaGlmdCgpO1xuICAgICAgfVxuICAgIH1cbiAgICBoaXN0LmRvbmUucHVzaChzZWxBZnRlcik7XG4gICAgaGlzdC5nZW5lcmF0aW9uID0gKytoaXN0Lm1heEdlbmVyYXRpb247XG4gICAgaGlzdC5sYXN0TW9kVGltZSA9IGhpc3QubGFzdFNlbFRpbWUgPSB0aW1lO1xuICAgIGhpc3QubGFzdE9wID0gaGlzdC5sYXN0U2VsT3AgPSBvcElkO1xuICAgIGhpc3QubGFzdE9yaWdpbiA9IGhpc3QubGFzdFNlbE9yaWdpbiA9IGNoYW5nZS5vcmlnaW47XG5cbiAgICBpZiAoIWxhc3QpIHNpZ25hbChkb2MsIFwiaGlzdG9yeUFkZGVkXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2VsZWN0aW9uRXZlbnRDYW5CZU1lcmdlZChkb2MsIG9yaWdpbiwgcHJldiwgc2VsKSB7XG4gICAgdmFyIGNoID0gb3JpZ2luLmNoYXJBdCgwKTtcbiAgICByZXR1cm4gY2ggPT0gXCIqXCIgfHxcbiAgICAgIGNoID09IFwiK1wiICYmXG4gICAgICBwcmV2LnJhbmdlcy5sZW5ndGggPT0gc2VsLnJhbmdlcy5sZW5ndGggJiZcbiAgICAgIHByZXYuc29tZXRoaW5nU2VsZWN0ZWQoKSA9PSBzZWwuc29tZXRoaW5nU2VsZWN0ZWQoKSAmJlxuICAgICAgbmV3IERhdGUgLSBkb2MuaGlzdG9yeS5sYXN0U2VsVGltZSA8PSAoZG9jLmNtID8gZG9jLmNtLm9wdGlvbnMuaGlzdG9yeUV2ZW50RGVsYXkgOiA1MDApO1xuICB9XG5cbiAgLy8gQ2FsbGVkIHdoZW5ldmVyIHRoZSBzZWxlY3Rpb24gY2hhbmdlcywgc2V0cyB0aGUgbmV3IHNlbGVjdGlvbiBhc1xuICAvLyB0aGUgcGVuZGluZyBzZWxlY3Rpb24gaW4gdGhlIGhpc3RvcnksIGFuZCBwdXNoZXMgdGhlIG9sZCBwZW5kaW5nXG4gIC8vIHNlbGVjdGlvbiBpbnRvIHRoZSAnZG9uZScgYXJyYXkgd2hlbiBpdCB3YXMgc2lnbmlmaWNhbnRseVxuICAvLyBkaWZmZXJlbnQgKGluIG51bWJlciBvZiBzZWxlY3RlZCByYW5nZXMsIGVtcHRpbmVzcywgb3IgdGltZSkuXG4gIGZ1bmN0aW9uIGFkZFNlbGVjdGlvblRvSGlzdG9yeShkb2MsIHNlbCwgb3BJZCwgb3B0aW9ucykge1xuICAgIHZhciBoaXN0ID0gZG9jLmhpc3RvcnksIG9yaWdpbiA9IG9wdGlvbnMgJiYgb3B0aW9ucy5vcmlnaW47XG5cbiAgICAvLyBBIG5ldyBldmVudCBpcyBzdGFydGVkIHdoZW4gdGhlIHByZXZpb3VzIG9yaWdpbiBkb2VzIG5vdCBtYXRjaFxuICAgIC8vIHRoZSBjdXJyZW50LCBvciB0aGUgb3JpZ2lucyBkb24ndCBhbGxvdyBtYXRjaGluZy4gT3JpZ2luc1xuICAgIC8vIHN0YXJ0aW5nIHdpdGggKiBhcmUgYWx3YXlzIG1lcmdlZCwgdGhvc2Ugc3RhcnRpbmcgd2l0aCArIGFyZVxuICAgIC8vIG1lcmdlZCB3aGVuIHNpbWlsYXIgYW5kIGNsb3NlIHRvZ2V0aGVyIGluIHRpbWUuXG4gICAgaWYgKG9wSWQgPT0gaGlzdC5sYXN0U2VsT3AgfHxcbiAgICAgICAgKG9yaWdpbiAmJiBoaXN0Lmxhc3RTZWxPcmlnaW4gPT0gb3JpZ2luICYmXG4gICAgICAgICAoaGlzdC5sYXN0TW9kVGltZSA9PSBoaXN0Lmxhc3RTZWxUaW1lICYmIGhpc3QubGFzdE9yaWdpbiA9PSBvcmlnaW4gfHxcbiAgICAgICAgICBzZWxlY3Rpb25FdmVudENhbkJlTWVyZ2VkKGRvYywgb3JpZ2luLCBsc3QoaGlzdC5kb25lKSwgc2VsKSkpKVxuICAgICAgaGlzdC5kb25lW2hpc3QuZG9uZS5sZW5ndGggLSAxXSA9IHNlbDtcbiAgICBlbHNlXG4gICAgICBwdXNoU2VsZWN0aW9uVG9IaXN0b3J5KHNlbCwgaGlzdC5kb25lKTtcblxuICAgIGhpc3QubGFzdFNlbFRpbWUgPSArbmV3IERhdGU7XG4gICAgaGlzdC5sYXN0U2VsT3JpZ2luID0gb3JpZ2luO1xuICAgIGhpc3QubGFzdFNlbE9wID0gb3BJZDtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNsZWFyUmVkbyAhPT0gZmFsc2UpXG4gICAgICBjbGVhclNlbGVjdGlvbkV2ZW50cyhoaXN0LnVuZG9uZSk7XG4gIH1cblxuICBmdW5jdGlvbiBwdXNoU2VsZWN0aW9uVG9IaXN0b3J5KHNlbCwgZGVzdCkge1xuICAgIHZhciB0b3AgPSBsc3QoZGVzdCk7XG4gICAgaWYgKCEodG9wICYmIHRvcC5yYW5nZXMgJiYgdG9wLmVxdWFscyhzZWwpKSlcbiAgICAgIGRlc3QucHVzaChzZWwpO1xuICB9XG5cbiAgLy8gVXNlZCB0byBzdG9yZSBtYXJrZWQgc3BhbiBpbmZvcm1hdGlvbiBpbiB0aGUgaGlzdG9yeS5cbiAgZnVuY3Rpb24gYXR0YWNoTG9jYWxTcGFucyhkb2MsIGNoYW5nZSwgZnJvbSwgdG8pIHtcbiAgICB2YXIgZXhpc3RpbmcgPSBjaGFuZ2VbXCJzcGFuc19cIiArIGRvYy5pZF0sIG4gPSAwO1xuICAgIGRvYy5pdGVyKE1hdGgubWF4KGRvYy5maXJzdCwgZnJvbSksIE1hdGgubWluKGRvYy5maXJzdCArIGRvYy5zaXplLCB0byksIGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgIGlmIChsaW5lLm1hcmtlZFNwYW5zKVxuICAgICAgICAoZXhpc3RpbmcgfHwgKGV4aXN0aW5nID0gY2hhbmdlW1wic3BhbnNfXCIgKyBkb2MuaWRdID0ge30pKVtuXSA9IGxpbmUubWFya2VkU3BhbnM7XG4gICAgICArK247XG4gICAgfSk7XG4gIH1cblxuICAvLyBXaGVuIHVuL3JlLWRvaW5nIHJlc3RvcmVzIHRleHQgY29udGFpbmluZyBtYXJrZWQgc3BhbnMsIHRob3NlXG4gIC8vIHRoYXQgaGF2ZSBiZWVuIGV4cGxpY2l0bHkgY2xlYXJlZCBzaG91bGQgbm90IGJlIHJlc3RvcmVkLlxuICBmdW5jdGlvbiByZW1vdmVDbGVhcmVkU3BhbnMoc3BhbnMpIHtcbiAgICBpZiAoIXNwYW5zKSByZXR1cm4gbnVsbDtcbiAgICBmb3IgKHZhciBpID0gMCwgb3V0OyBpIDwgc3BhbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGlmIChzcGFuc1tpXS5tYXJrZXIuZXhwbGljaXRseUNsZWFyZWQpIHsgaWYgKCFvdXQpIG91dCA9IHNwYW5zLnNsaWNlKDAsIGkpOyB9XG4gICAgICBlbHNlIGlmIChvdXQpIG91dC5wdXNoKHNwYW5zW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuICFvdXQgPyBzcGFucyA6IG91dC5sZW5ndGggPyBvdXQgOiBudWxsO1xuICB9XG5cbiAgLy8gUmV0cmlldmUgYW5kIGZpbHRlciB0aGUgb2xkIG1hcmtlZCBzcGFucyBzdG9yZWQgaW4gYSBjaGFuZ2UgZXZlbnQuXG4gIGZ1bmN0aW9uIGdldE9sZFNwYW5zKGRvYywgY2hhbmdlKSB7XG4gICAgdmFyIGZvdW5kID0gY2hhbmdlW1wic3BhbnNfXCIgKyBkb2MuaWRdO1xuICAgIGlmICghZm91bmQpIHJldHVybiBudWxsO1xuICAgIGZvciAodmFyIGkgPSAwLCBudyA9IFtdOyBpIDwgY2hhbmdlLnRleHQubGVuZ3RoOyArK2kpXG4gICAgICBudy5wdXNoKHJlbW92ZUNsZWFyZWRTcGFucyhmb3VuZFtpXSkpO1xuICAgIHJldHVybiBudztcbiAgfVxuXG4gIC8vIFVzZWQgYm90aCB0byBwcm92aWRlIGEgSlNPTi1zYWZlIG9iamVjdCBpbiAuZ2V0SGlzdG9yeSwgYW5kLCB3aGVuXG4gIC8vIGRldGFjaGluZyBhIGRvY3VtZW50LCB0byBzcGxpdCB0aGUgaGlzdG9yeSBpbiB0d29cbiAgZnVuY3Rpb24gY29weUhpc3RvcnlBcnJheShldmVudHMsIG5ld0dyb3VwLCBpbnN0YW50aWF0ZVNlbCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBjb3B5ID0gW107IGkgPCBldmVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciBldmVudCA9IGV2ZW50c1tpXTtcbiAgICAgIGlmIChldmVudC5yYW5nZXMpIHtcbiAgICAgICAgY29weS5wdXNoKGluc3RhbnRpYXRlU2VsID8gU2VsZWN0aW9uLnByb3RvdHlwZS5kZWVwQ29weS5jYWxsKGV2ZW50KSA6IGV2ZW50KTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB2YXIgY2hhbmdlcyA9IGV2ZW50LmNoYW5nZXMsIG5ld0NoYW5nZXMgPSBbXTtcbiAgICAgIGNvcHkucHVzaCh7Y2hhbmdlczogbmV3Q2hhbmdlc30pO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjaGFuZ2VzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgIHZhciBjaGFuZ2UgPSBjaGFuZ2VzW2pdLCBtO1xuICAgICAgICBuZXdDaGFuZ2VzLnB1c2goe2Zyb206IGNoYW5nZS5mcm9tLCB0bzogY2hhbmdlLnRvLCB0ZXh0OiBjaGFuZ2UudGV4dH0pO1xuICAgICAgICBpZiAobmV3R3JvdXApIGZvciAodmFyIHByb3AgaW4gY2hhbmdlKSBpZiAobSA9IHByb3AubWF0Y2goL15zcGFuc18oXFxkKykkLykpIHtcbiAgICAgICAgICBpZiAoaW5kZXhPZihuZXdHcm91cCwgTnVtYmVyKG1bMV0pKSA+IC0xKSB7XG4gICAgICAgICAgICBsc3QobmV3Q2hhbmdlcylbcHJvcF0gPSBjaGFuZ2VbcHJvcF07XG4gICAgICAgICAgICBkZWxldGUgY2hhbmdlW3Byb3BdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfVxuXG4gIC8vIFJlYmFzaW5nL3Jlc2V0dGluZyBoaXN0b3J5IHRvIGRlYWwgd2l0aCBleHRlcm5hbGx5LXNvdXJjZWQgY2hhbmdlc1xuXG4gIGZ1bmN0aW9uIHJlYmFzZUhpc3RTZWxTaW5nbGUocG9zLCBmcm9tLCB0bywgZGlmZikge1xuICAgIGlmICh0byA8IHBvcy5saW5lKSB7XG4gICAgICBwb3MubGluZSArPSBkaWZmO1xuICAgIH0gZWxzZSBpZiAoZnJvbSA8IHBvcy5saW5lKSB7XG4gICAgICBwb3MubGluZSA9IGZyb207XG4gICAgICBwb3MuY2ggPSAwO1xuICAgIH1cbiAgfVxuXG4gIC8vIFRyaWVzIHRvIHJlYmFzZSBhbiBhcnJheSBvZiBoaXN0b3J5IGV2ZW50cyBnaXZlbiBhIGNoYW5nZSBpbiB0aGVcbiAgLy8gZG9jdW1lbnQuIElmIHRoZSBjaGFuZ2UgdG91Y2hlcyB0aGUgc2FtZSBsaW5lcyBhcyB0aGUgZXZlbnQsIHRoZVxuICAvLyBldmVudCwgYW5kIGV2ZXJ5dGhpbmcgJ2JlaGluZCcgaXQsIGlzIGRpc2NhcmRlZC4gSWYgdGhlIGNoYW5nZSBpc1xuICAvLyBiZWZvcmUgdGhlIGV2ZW50LCB0aGUgZXZlbnQncyBwb3NpdGlvbnMgYXJlIHVwZGF0ZWQuIFVzZXMgYVxuICAvLyBjb3B5LW9uLXdyaXRlIHNjaGVtZSBmb3IgdGhlIHBvc2l0aW9ucywgdG8gYXZvaWQgaGF2aW5nIHRvXG4gIC8vIHJlYWxsb2NhdGUgdGhlbSBhbGwgb24gZXZlcnkgcmViYXNlLCBidXQgYWxzbyBhdm9pZCBwcm9ibGVtcyB3aXRoXG4gIC8vIHNoYXJlZCBwb3NpdGlvbiBvYmplY3RzIGJlaW5nIHVuc2FmZWx5IHVwZGF0ZWQuXG4gIGZ1bmN0aW9uIHJlYmFzZUhpc3RBcnJheShhcnJheSwgZnJvbSwgdG8sIGRpZmYpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgc3ViID0gYXJyYXlbaV0sIG9rID0gdHJ1ZTtcbiAgICAgIGlmIChzdWIucmFuZ2VzKSB7XG4gICAgICAgIGlmICghc3ViLmNvcGllZCkgeyBzdWIgPSBhcnJheVtpXSA9IHN1Yi5kZWVwQ29weSgpOyBzdWIuY29waWVkID0gdHJ1ZTsgfVxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHN1Yi5yYW5nZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICByZWJhc2VIaXN0U2VsU2luZ2xlKHN1Yi5yYW5nZXNbal0uYW5jaG9yLCBmcm9tLCB0bywgZGlmZik7XG4gICAgICAgICAgcmViYXNlSGlzdFNlbFNpbmdsZShzdWIucmFuZ2VzW2pdLmhlYWQsIGZyb20sIHRvLCBkaWZmKTtcbiAgICAgICAgfVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc3ViLmNoYW5nZXMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgdmFyIGN1ciA9IHN1Yi5jaGFuZ2VzW2pdO1xuICAgICAgICBpZiAodG8gPCBjdXIuZnJvbS5saW5lKSB7XG4gICAgICAgICAgY3VyLmZyb20gPSBQb3MoY3VyLmZyb20ubGluZSArIGRpZmYsIGN1ci5mcm9tLmNoKTtcbiAgICAgICAgICBjdXIudG8gPSBQb3MoY3VyLnRvLmxpbmUgKyBkaWZmLCBjdXIudG8uY2gpO1xuICAgICAgICB9IGVsc2UgaWYgKGZyb20gPD0gY3VyLnRvLmxpbmUpIHtcbiAgICAgICAgICBvayA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIW9rKSB7XG4gICAgICAgIGFycmF5LnNwbGljZSgwLCBpICsgMSk7XG4gICAgICAgIGkgPSAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYmFzZUhpc3QoaGlzdCwgY2hhbmdlKSB7XG4gICAgdmFyIGZyb20gPSBjaGFuZ2UuZnJvbS5saW5lLCB0byA9IGNoYW5nZS50by5saW5lLCBkaWZmID0gY2hhbmdlLnRleHQubGVuZ3RoIC0gKHRvIC0gZnJvbSkgLSAxO1xuICAgIHJlYmFzZUhpc3RBcnJheShoaXN0LmRvbmUsIGZyb20sIHRvLCBkaWZmKTtcbiAgICByZWJhc2VIaXN0QXJyYXkoaGlzdC51bmRvbmUsIGZyb20sIHRvLCBkaWZmKTtcbiAgfVxuXG4gIC8vIEVWRU5UIFVUSUxJVElFU1xuXG4gIC8vIER1ZSB0byB0aGUgZmFjdCB0aGF0IHdlIHN0aWxsIHN1cHBvcnQganVyYXNzaWMgSUUgdmVyc2lvbnMsIHNvbWVcbiAgLy8gY29tcGF0aWJpbGl0eSB3cmFwcGVycyBhcmUgbmVlZGVkLlxuXG4gIHZhciBlX3ByZXZlbnREZWZhdWx0ID0gQ29kZU1pcnJvci5lX3ByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZWxzZSBlLnJldHVyblZhbHVlID0gZmFsc2U7XG4gIH07XG4gIHZhciBlX3N0b3BQcm9wYWdhdGlvbiA9IENvZGVNaXJyb3IuZV9zdG9wUHJvcGFnYXRpb24gPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKGUuc3RvcFByb3BhZ2F0aW9uKSBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGVsc2UgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICB9O1xuICBmdW5jdGlvbiBlX2RlZmF1bHRQcmV2ZW50ZWQoZSkge1xuICAgIHJldHVybiBlLmRlZmF1bHRQcmV2ZW50ZWQgIT0gbnVsbCA/IGUuZGVmYXVsdFByZXZlbnRlZCA6IGUucmV0dXJuVmFsdWUgPT0gZmFsc2U7XG4gIH1cbiAgdmFyIGVfc3RvcCA9IENvZGVNaXJyb3IuZV9zdG9wID0gZnVuY3Rpb24oZSkge2VfcHJldmVudERlZmF1bHQoZSk7IGVfc3RvcFByb3BhZ2F0aW9uKGUpO307XG5cbiAgZnVuY3Rpb24gZV90YXJnZXQoZSkge3JldHVybiBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7fVxuICBmdW5jdGlvbiBlX2J1dHRvbihlKSB7XG4gICAgdmFyIGIgPSBlLndoaWNoO1xuICAgIGlmIChiID09IG51bGwpIHtcbiAgICAgIGlmIChlLmJ1dHRvbiAmIDEpIGIgPSAxO1xuICAgICAgZWxzZSBpZiAoZS5idXR0b24gJiAyKSBiID0gMztcbiAgICAgIGVsc2UgaWYgKGUuYnV0dG9uICYgNCkgYiA9IDI7XG4gICAgfVxuICAgIGlmIChtYWMgJiYgZS5jdHJsS2V5ICYmIGIgPT0gMSkgYiA9IDM7XG4gICAgcmV0dXJuIGI7XG4gIH1cblxuICAvLyBFVkVOVCBIQU5ETElOR1xuXG4gIC8vIExpZ2h0d2VpZ2h0IGV2ZW50IGZyYW1ld29yay4gb24vb2ZmIGFsc28gd29yayBvbiBET00gbm9kZXMsXG4gIC8vIHJlZ2lzdGVyaW5nIG5hdGl2ZSBET00gaGFuZGxlcnMuXG5cbiAgdmFyIG9uID0gQ29kZU1pcnJvci5vbiA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUsIGYpIHtcbiAgICBpZiAoZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKVxuICAgICAgZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGYsIGZhbHNlKTtcbiAgICBlbHNlIGlmIChlbWl0dGVyLmF0dGFjaEV2ZW50KVxuICAgICAgZW1pdHRlci5hdHRhY2hFdmVudChcIm9uXCIgKyB0eXBlLCBmKTtcbiAgICBlbHNlIHtcbiAgICAgIHZhciBtYXAgPSBlbWl0dGVyLl9oYW5kbGVycyB8fCAoZW1pdHRlci5faGFuZGxlcnMgPSB7fSk7XG4gICAgICB2YXIgYXJyID0gbWFwW3R5cGVdIHx8IChtYXBbdHlwZV0gPSBbXSk7XG4gICAgICBhcnIucHVzaChmKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG5vSGFuZGxlcnMgPSBbXVxuICBmdW5jdGlvbiBnZXRIYW5kbGVycyhlbWl0dGVyLCB0eXBlLCBjb3B5KSB7XG4gICAgdmFyIGFyciA9IGVtaXR0ZXIuX2hhbmRsZXJzICYmIGVtaXR0ZXIuX2hhbmRsZXJzW3R5cGVdXG4gICAgaWYgKGNvcHkpIHJldHVybiBhcnIgJiYgYXJyLmxlbmd0aCA+IDAgPyBhcnIuc2xpY2UoKSA6IG5vSGFuZGxlcnNcbiAgICBlbHNlIHJldHVybiBhcnIgfHwgbm9IYW5kbGVyc1xuICB9XG5cbiAgdmFyIG9mZiA9IENvZGVNaXJyb3Iub2ZmID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSwgZikge1xuICAgIGlmIChlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIpXG4gICAgICBlbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZiwgZmFsc2UpO1xuICAgIGVsc2UgaWYgKGVtaXR0ZXIuZGV0YWNoRXZlbnQpXG4gICAgICBlbWl0dGVyLmRldGFjaEV2ZW50KFwib25cIiArIHR5cGUsIGYpO1xuICAgIGVsc2Uge1xuICAgICAgdmFyIGhhbmRsZXJzID0gZ2V0SGFuZGxlcnMoZW1pdHRlciwgdHlwZSwgZmFsc2UpXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXJzLmxlbmd0aDsgKytpKVxuICAgICAgICBpZiAoaGFuZGxlcnNbaV0gPT0gZikgeyBoYW5kbGVycy5zcGxpY2UoaSwgMSk7IGJyZWFrOyB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBzaWduYWwgPSBDb2RlTWlycm9yLnNpZ25hbCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUgLyosIHZhbHVlcy4uLiovKSB7XG4gICAgdmFyIGhhbmRsZXJzID0gZ2V0SGFuZGxlcnMoZW1pdHRlciwgdHlwZSwgdHJ1ZSlcbiAgICBpZiAoIWhhbmRsZXJzLmxlbmd0aCkgcmV0dXJuO1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXJzLmxlbmd0aDsgKytpKSBoYW5kbGVyc1tpXS5hcHBseShudWxsLCBhcmdzKTtcbiAgfTtcblxuICB2YXIgb3JwaGFuRGVsYXllZENhbGxiYWNrcyA9IG51bGw7XG5cbiAgLy8gT2Z0ZW4sIHdlIHdhbnQgdG8gc2lnbmFsIGV2ZW50cyBhdCBhIHBvaW50IHdoZXJlIHdlIGFyZSBpbiB0aGVcbiAgLy8gbWlkZGxlIG9mIHNvbWUgd29yaywgYnV0IGRvbid0IHdhbnQgdGhlIGhhbmRsZXIgdG8gc3RhcnQgY2FsbGluZ1xuICAvLyBvdGhlciBtZXRob2RzIG9uIHRoZSBlZGl0b3IsIHdoaWNoIG1pZ2h0IGJlIGluIGFuIGluY29uc2lzdGVudFxuICAvLyBzdGF0ZSBvciBzaW1wbHkgbm90IGV4cGVjdCBhbnkgb3RoZXIgZXZlbnRzIHRvIGhhcHBlbi5cbiAgLy8gc2lnbmFsTGF0ZXIgbG9va3Mgd2hldGhlciB0aGVyZSBhcmUgYW55IGhhbmRsZXJzLCBhbmQgc2NoZWR1bGVzXG4gIC8vIHRoZW0gdG8gYmUgZXhlY3V0ZWQgd2hlbiB0aGUgbGFzdCBvcGVyYXRpb24gZW5kcywgb3IsIGlmIG5vXG4gIC8vIG9wZXJhdGlvbiBpcyBhY3RpdmUsIHdoZW4gYSB0aW1lb3V0IGZpcmVzLlxuICBmdW5jdGlvbiBzaWduYWxMYXRlcihlbWl0dGVyLCB0eXBlIC8qLCB2YWx1ZXMuLi4qLykge1xuICAgIHZhciBhcnIgPSBnZXRIYW5kbGVycyhlbWl0dGVyLCB0eXBlLCBmYWxzZSlcbiAgICBpZiAoIWFyci5sZW5ndGgpIHJldHVybjtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMiksIGxpc3Q7XG4gICAgaWYgKG9wZXJhdGlvbkdyb3VwKSB7XG4gICAgICBsaXN0ID0gb3BlcmF0aW9uR3JvdXAuZGVsYXllZENhbGxiYWNrcztcbiAgICB9IGVsc2UgaWYgKG9ycGhhbkRlbGF5ZWRDYWxsYmFja3MpIHtcbiAgICAgIGxpc3QgPSBvcnBoYW5EZWxheWVkQ2FsbGJhY2tzO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaXN0ID0gb3JwaGFuRGVsYXllZENhbGxiYWNrcyA9IFtdO1xuICAgICAgc2V0VGltZW91dChmaXJlT3JwaGFuRGVsYXllZCwgMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJuZChmKSB7cmV0dXJuIGZ1bmN0aW9uKCl7Zi5hcHBseShudWxsLCBhcmdzKTt9O307XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpXG4gICAgICBsaXN0LnB1c2goYm5kKGFycltpXSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gZmlyZU9ycGhhbkRlbGF5ZWQoKSB7XG4gICAgdmFyIGRlbGF5ZWQgPSBvcnBoYW5EZWxheWVkQ2FsbGJhY2tzO1xuICAgIG9ycGhhbkRlbGF5ZWRDYWxsYmFja3MgPSBudWxsO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGVsYXllZC5sZW5ndGg7ICsraSkgZGVsYXllZFtpXSgpO1xuICB9XG5cbiAgLy8gVGhlIERPTSBldmVudHMgdGhhdCBDb2RlTWlycm9yIGhhbmRsZXMgY2FuIGJlIG92ZXJyaWRkZW4gYnlcbiAgLy8gcmVnaXN0ZXJpbmcgYSAobm9uLURPTSkgaGFuZGxlciBvbiB0aGUgZWRpdG9yIGZvciB0aGUgZXZlbnQgbmFtZSxcbiAgLy8gYW5kIHByZXZlbnREZWZhdWx0LWluZyB0aGUgZXZlbnQgaW4gdGhhdCBoYW5kbGVyLlxuICBmdW5jdGlvbiBzaWduYWxET01FdmVudChjbSwgZSwgb3ZlcnJpZGUpIHtcbiAgICBpZiAodHlwZW9mIGUgPT0gXCJzdHJpbmdcIilcbiAgICAgIGUgPSB7dHlwZTogZSwgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgeyB0aGlzLmRlZmF1bHRQcmV2ZW50ZWQgPSB0cnVlOyB9fTtcbiAgICBzaWduYWwoY20sIG92ZXJyaWRlIHx8IGUudHlwZSwgY20sIGUpO1xuICAgIHJldHVybiBlX2RlZmF1bHRQcmV2ZW50ZWQoZSkgfHwgZS5jb2RlbWlycm9ySWdub3JlO1xuICB9XG5cbiAgZnVuY3Rpb24gc2lnbmFsQ3Vyc29yQWN0aXZpdHkoY20pIHtcbiAgICB2YXIgYXJyID0gY20uX2hhbmRsZXJzICYmIGNtLl9oYW5kbGVycy5jdXJzb3JBY3Rpdml0eTtcbiAgICBpZiAoIWFycikgcmV0dXJuO1xuICAgIHZhciBzZXQgPSBjbS5jdXJPcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzIHx8IChjbS5jdXJPcC5jdXJzb3JBY3Rpdml0eUhhbmRsZXJzID0gW10pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgKytpKSBpZiAoaW5kZXhPZihzZXQsIGFycltpXSkgPT0gLTEpXG4gICAgICBzZXQucHVzaChhcnJbaV0pO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzSGFuZGxlcihlbWl0dGVyLCB0eXBlKSB7XG4gICAgcmV0dXJuIGdldEhhbmRsZXJzKGVtaXR0ZXIsIHR5cGUpLmxlbmd0aCA+IDBcbiAgfVxuXG4gIC8vIEFkZCBvbiBhbmQgb2ZmIG1ldGhvZHMgdG8gYSBjb25zdHJ1Y3RvcidzIHByb3RvdHlwZSwgdG8gbWFrZVxuICAvLyByZWdpc3RlcmluZyBldmVudHMgb24gc3VjaCBvYmplY3RzIG1vcmUgY29udmVuaWVudC5cbiAgZnVuY3Rpb24gZXZlbnRNaXhpbihjdG9yKSB7XG4gICAgY3Rvci5wcm90b3R5cGUub24gPSBmdW5jdGlvbih0eXBlLCBmKSB7b24odGhpcywgdHlwZSwgZik7fTtcbiAgICBjdG9yLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbih0eXBlLCBmKSB7b2ZmKHRoaXMsIHR5cGUsIGYpO307XG4gIH1cblxuICAvLyBNSVNDIFVUSUxJVElFU1xuXG4gIC8vIE51bWJlciBvZiBwaXhlbHMgYWRkZWQgdG8gc2Nyb2xsZXIgYW5kIHNpemVyIHRvIGhpZGUgc2Nyb2xsYmFyXG4gIHZhciBzY3JvbGxlckdhcCA9IDMwO1xuXG4gIC8vIFJldHVybmVkIG9yIHRocm93biBieSB2YXJpb3VzIHByb3RvY29scyB0byBzaWduYWwgJ0knbSBub3RcbiAgLy8gaGFuZGxpbmcgdGhpcycuXG4gIHZhciBQYXNzID0gQ29kZU1pcnJvci5QYXNzID0ge3RvU3RyaW5nOiBmdW5jdGlvbigpe3JldHVybiBcIkNvZGVNaXJyb3IuUGFzc1wiO319O1xuXG4gIC8vIFJldXNlZCBvcHRpb24gb2JqZWN0cyBmb3Igc2V0U2VsZWN0aW9uICYgZnJpZW5kc1xuICB2YXIgc2VsX2RvbnRTY3JvbGwgPSB7c2Nyb2xsOiBmYWxzZX0sIHNlbF9tb3VzZSA9IHtvcmlnaW46IFwiKm1vdXNlXCJ9LCBzZWxfbW92ZSA9IHtvcmlnaW46IFwiK21vdmVcIn07XG5cbiAgZnVuY3Rpb24gRGVsYXllZCgpIHt0aGlzLmlkID0gbnVsbDt9XG4gIERlbGF5ZWQucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKG1zLCBmKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuaWQpO1xuICAgIHRoaXMuaWQgPSBzZXRUaW1lb3V0KGYsIG1zKTtcbiAgfTtcblxuICAvLyBDb3VudHMgdGhlIGNvbHVtbiBvZmZzZXQgaW4gYSBzdHJpbmcsIHRha2luZyB0YWJzIGludG8gYWNjb3VudC5cbiAgLy8gVXNlZCBtb3N0bHkgdG8gZmluZCBpbmRlbnRhdGlvbi5cbiAgdmFyIGNvdW50Q29sdW1uID0gQ29kZU1pcnJvci5jb3VudENvbHVtbiA9IGZ1bmN0aW9uKHN0cmluZywgZW5kLCB0YWJTaXplLCBzdGFydEluZGV4LCBzdGFydFZhbHVlKSB7XG4gICAgaWYgKGVuZCA9PSBudWxsKSB7XG4gICAgICBlbmQgPSBzdHJpbmcuc2VhcmNoKC9bXlxcc1xcdTAwYTBdLyk7XG4gICAgICBpZiAoZW5kID09IC0xKSBlbmQgPSBzdHJpbmcubGVuZ3RoO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleCB8fCAwLCBuID0gc3RhcnRWYWx1ZSB8fCAwOzspIHtcbiAgICAgIHZhciBuZXh0VGFiID0gc3RyaW5nLmluZGV4T2YoXCJcXHRcIiwgaSk7XG4gICAgICBpZiAobmV4dFRhYiA8IDAgfHwgbmV4dFRhYiA+PSBlbmQpXG4gICAgICAgIHJldHVybiBuICsgKGVuZCAtIGkpO1xuICAgICAgbiArPSBuZXh0VGFiIC0gaTtcbiAgICAgIG4gKz0gdGFiU2l6ZSAtIChuICUgdGFiU2l6ZSk7XG4gICAgICBpID0gbmV4dFRhYiArIDE7XG4gICAgfVxuICB9O1xuXG4gIC8vIFRoZSBpbnZlcnNlIG9mIGNvdW50Q29sdW1uIC0tIGZpbmQgdGhlIG9mZnNldCB0aGF0IGNvcnJlc3BvbmRzIHRvXG4gIC8vIGEgcGFydGljdWxhciBjb2x1bW4uXG4gIHZhciBmaW5kQ29sdW1uID0gQ29kZU1pcnJvci5maW5kQ29sdW1uID0gZnVuY3Rpb24oc3RyaW5nLCBnb2FsLCB0YWJTaXplKSB7XG4gICAgZm9yICh2YXIgcG9zID0gMCwgY29sID0gMDs7KSB7XG4gICAgICB2YXIgbmV4dFRhYiA9IHN0cmluZy5pbmRleE9mKFwiXFx0XCIsIHBvcyk7XG4gICAgICBpZiAobmV4dFRhYiA9PSAtMSkgbmV4dFRhYiA9IHN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgc2tpcHBlZCA9IG5leHRUYWIgLSBwb3M7XG4gICAgICBpZiAobmV4dFRhYiA9PSBzdHJpbmcubGVuZ3RoIHx8IGNvbCArIHNraXBwZWQgPj0gZ29hbClcbiAgICAgICAgcmV0dXJuIHBvcyArIE1hdGgubWluKHNraXBwZWQsIGdvYWwgLSBjb2wpO1xuICAgICAgY29sICs9IG5leHRUYWIgLSBwb3M7XG4gICAgICBjb2wgKz0gdGFiU2l6ZSAtIChjb2wgJSB0YWJTaXplKTtcbiAgICAgIHBvcyA9IG5leHRUYWIgKyAxO1xuICAgICAgaWYgKGNvbCA+PSBnb2FsKSByZXR1cm4gcG9zO1xuICAgIH1cbiAgfVxuXG4gIHZhciBzcGFjZVN0cnMgPSBbXCJcIl07XG4gIGZ1bmN0aW9uIHNwYWNlU3RyKG4pIHtcbiAgICB3aGlsZSAoc3BhY2VTdHJzLmxlbmd0aCA8PSBuKVxuICAgICAgc3BhY2VTdHJzLnB1c2gobHN0KHNwYWNlU3RycykgKyBcIiBcIik7XG4gICAgcmV0dXJuIHNwYWNlU3Ryc1tuXTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxzdChhcnIpIHsgcmV0dXJuIGFyclthcnIubGVuZ3RoLTFdOyB9XG5cbiAgdmFyIHNlbGVjdElucHV0ID0gZnVuY3Rpb24obm9kZSkgeyBub2RlLnNlbGVjdCgpOyB9O1xuICBpZiAoaW9zKSAvLyBNb2JpbGUgU2FmYXJpIGFwcGFyZW50bHkgaGFzIGEgYnVnIHdoZXJlIHNlbGVjdCgpIGlzIGJyb2tlbi5cbiAgICBzZWxlY3RJbnB1dCA9IGZ1bmN0aW9uKG5vZGUpIHsgbm9kZS5zZWxlY3Rpb25TdGFydCA9IDA7IG5vZGUuc2VsZWN0aW9uRW5kID0gbm9kZS52YWx1ZS5sZW5ndGg7IH07XG4gIGVsc2UgaWYgKGllKSAvLyBTdXBwcmVzcyBteXN0ZXJpb3VzIElFMTAgZXJyb3JzXG4gICAgc2VsZWN0SW5wdXQgPSBmdW5jdGlvbihub2RlKSB7IHRyeSB7IG5vZGUuc2VsZWN0KCk7IH0gY2F0Y2goX2UpIHt9IH07XG5cbiAgZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgZWx0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7ICsraSlcbiAgICAgIGlmIChhcnJheVtpXSA9PSBlbHQpIHJldHVybiBpO1xuICAgIHJldHVybiAtMTtcbiAgfVxuICBmdW5jdGlvbiBtYXAoYXJyYXksIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgb3V0W2ldID0gZihhcnJheVtpXSwgaSk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG5vdGhpbmcoKSB7fVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZU9iaihiYXNlLCBwcm9wcykge1xuICAgIHZhciBpbnN0O1xuICAgIGlmIChPYmplY3QuY3JlYXRlKSB7XG4gICAgICBpbnN0ID0gT2JqZWN0LmNyZWF0ZShiYXNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbm90aGluZy5wcm90b3R5cGUgPSBiYXNlO1xuICAgICAgaW5zdCA9IG5ldyBub3RoaW5nKCk7XG4gICAgfVxuICAgIGlmIChwcm9wcykgY29weU9iaihwcm9wcywgaW5zdCk7XG4gICAgcmV0dXJuIGluc3Q7XG4gIH07XG5cbiAgZnVuY3Rpb24gY29weU9iaihvYmosIHRhcmdldCwgb3ZlcndyaXRlKSB7XG4gICAgaWYgKCF0YXJnZXQpIHRhcmdldCA9IHt9O1xuICAgIGZvciAodmFyIHByb3AgaW4gb2JqKVxuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiAob3ZlcndyaXRlICE9PSBmYWxzZSB8fCAhdGFyZ2V0Lmhhc093blByb3BlcnR5KHByb3ApKSlcbiAgICAgICAgdGFyZ2V0W3Byb3BdID0gb2JqW3Byb3BdO1xuICAgIHJldHVybiB0YXJnZXQ7XG4gIH1cblxuICBmdW5jdGlvbiBiaW5kKGYpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGYuYXBwbHkobnVsbCwgYXJncyk7fTtcbiAgfVxuXG4gIHZhciBub25BU0NJSVNpbmdsZUNhc2VXb3JkQ2hhciA9IC9bXFx1MDBkZlxcdTA1ODdcXHUwNTkwLVxcdTA1ZjRcXHUwNjAwLVxcdTA2ZmZcXHUzMDQwLVxcdTMwOWZcXHUzMGEwLVxcdTMwZmZcXHUzNDAwLVxcdTRkYjVcXHU0ZTAwLVxcdTlmY2NcXHVhYzAwLVxcdWQ3YWZdLztcbiAgdmFyIGlzV29yZENoYXJCYXNpYyA9IENvZGVNaXJyb3IuaXNXb3JkQ2hhciA9IGZ1bmN0aW9uKGNoKSB7XG4gICAgcmV0dXJuIC9cXHcvLnRlc3QoY2gpIHx8IGNoID4gXCJcXHg4MFwiICYmXG4gICAgICAoY2gudG9VcHBlckNhc2UoKSAhPSBjaC50b0xvd2VyQ2FzZSgpIHx8IG5vbkFTQ0lJU2luZ2xlQ2FzZVdvcmRDaGFyLnRlc3QoY2gpKTtcbiAgfTtcbiAgZnVuY3Rpb24gaXNXb3JkQ2hhcihjaCwgaGVscGVyKSB7XG4gICAgaWYgKCFoZWxwZXIpIHJldHVybiBpc1dvcmRDaGFyQmFzaWMoY2gpO1xuICAgIGlmIChoZWxwZXIuc291cmNlLmluZGV4T2YoXCJcXFxcd1wiKSA+IC0xICYmIGlzV29yZENoYXJCYXNpYyhjaCkpIHJldHVybiB0cnVlO1xuICAgIHJldHVybiBoZWxwZXIudGVzdChjaCk7XG4gIH1cblxuICBmdW5jdGlvbiBpc0VtcHR5KG9iaikge1xuICAgIGZvciAodmFyIG4gaW4gb2JqKSBpZiAob2JqLmhhc093blByb3BlcnR5KG4pICYmIG9ialtuXSkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gRXh0ZW5kaW5nIHVuaWNvZGUgY2hhcmFjdGVycy4gQSBzZXJpZXMgb2YgYSBub24tZXh0ZW5kaW5nIGNoYXIgK1xuICAvLyBhbnkgbnVtYmVyIG9mIGV4dGVuZGluZyBjaGFycyBpcyB0cmVhdGVkIGFzIGEgc2luZ2xlIHVuaXQgYXMgZmFyXG4gIC8vIGFzIGVkaXRpbmcgYW5kIG1lYXN1cmluZyBpcyBjb25jZXJuZWQuIFRoaXMgaXMgbm90IGZ1bGx5IGNvcnJlY3QsXG4gIC8vIHNpbmNlIHNvbWUgc2NyaXB0cy9mb250cy9icm93c2VycyBhbHNvIHRyZWF0IG90aGVyIGNvbmZpZ3VyYXRpb25zXG4gIC8vIG9mIGNvZGUgcG9pbnRzIGFzIGEgZ3JvdXAuXG4gIHZhciBleHRlbmRpbmdDaGFycyA9IC9bXFx1MDMwMC1cXHUwMzZmXFx1MDQ4My1cXHUwNDg5XFx1MDU5MS1cXHUwNWJkXFx1MDViZlxcdTA1YzFcXHUwNWMyXFx1MDVjNFxcdTA1YzVcXHUwNWM3XFx1MDYxMC1cXHUwNjFhXFx1MDY0Yi1cXHUwNjVlXFx1MDY3MFxcdTA2ZDYtXFx1MDZkY1xcdTA2ZGUtXFx1MDZlNFxcdTA2ZTdcXHUwNmU4XFx1MDZlYS1cXHUwNmVkXFx1MDcxMVxcdTA3MzAtXFx1MDc0YVxcdTA3YTYtXFx1MDdiMFxcdTA3ZWItXFx1MDdmM1xcdTA4MTYtXFx1MDgxOVxcdTA4MWItXFx1MDgyM1xcdTA4MjUtXFx1MDgyN1xcdTA4MjktXFx1MDgyZFxcdTA5MDAtXFx1MDkwMlxcdTA5M2NcXHUwOTQxLVxcdTA5NDhcXHUwOTRkXFx1MDk1MS1cXHUwOTU1XFx1MDk2MlxcdTA5NjNcXHUwOTgxXFx1MDliY1xcdTA5YmVcXHUwOWMxLVxcdTA5YzRcXHUwOWNkXFx1MDlkN1xcdTA5ZTJcXHUwOWUzXFx1MGEwMVxcdTBhMDJcXHUwYTNjXFx1MGE0MVxcdTBhNDJcXHUwYTQ3XFx1MGE0OFxcdTBhNGItXFx1MGE0ZFxcdTBhNTFcXHUwYTcwXFx1MGE3MVxcdTBhNzVcXHUwYTgxXFx1MGE4MlxcdTBhYmNcXHUwYWMxLVxcdTBhYzVcXHUwYWM3XFx1MGFjOFxcdTBhY2RcXHUwYWUyXFx1MGFlM1xcdTBiMDFcXHUwYjNjXFx1MGIzZVxcdTBiM2ZcXHUwYjQxLVxcdTBiNDRcXHUwYjRkXFx1MGI1NlxcdTBiNTdcXHUwYjYyXFx1MGI2M1xcdTBiODJcXHUwYmJlXFx1MGJjMFxcdTBiY2RcXHUwYmQ3XFx1MGMzZS1cXHUwYzQwXFx1MGM0Ni1cXHUwYzQ4XFx1MGM0YS1cXHUwYzRkXFx1MGM1NVxcdTBjNTZcXHUwYzYyXFx1MGM2M1xcdTBjYmNcXHUwY2JmXFx1MGNjMlxcdTBjYzZcXHUwY2NjXFx1MGNjZFxcdTBjZDVcXHUwY2Q2XFx1MGNlMlxcdTBjZTNcXHUwZDNlXFx1MGQ0MS1cXHUwZDQ0XFx1MGQ0ZFxcdTBkNTdcXHUwZDYyXFx1MGQ2M1xcdTBkY2FcXHUwZGNmXFx1MGRkMi1cXHUwZGQ0XFx1MGRkNlxcdTBkZGZcXHUwZTMxXFx1MGUzNC1cXHUwZTNhXFx1MGU0Ny1cXHUwZTRlXFx1MGViMVxcdTBlYjQtXFx1MGViOVxcdTBlYmJcXHUwZWJjXFx1MGVjOC1cXHUwZWNkXFx1MGYxOFxcdTBmMTlcXHUwZjM1XFx1MGYzN1xcdTBmMzlcXHUwZjcxLVxcdTBmN2VcXHUwZjgwLVxcdTBmODRcXHUwZjg2XFx1MGY4N1xcdTBmOTAtXFx1MGY5N1xcdTBmOTktXFx1MGZiY1xcdTBmYzZcXHUxMDJkLVxcdTEwMzBcXHUxMDMyLVxcdTEwMzdcXHUxMDM5XFx1MTAzYVxcdTEwM2RcXHUxMDNlXFx1MTA1OFxcdTEwNTlcXHUxMDVlLVxcdTEwNjBcXHUxMDcxLVxcdTEwNzRcXHUxMDgyXFx1MTA4NVxcdTEwODZcXHUxMDhkXFx1MTA5ZFxcdTEzNWZcXHUxNzEyLVxcdTE3MTRcXHUxNzMyLVxcdTE3MzRcXHUxNzUyXFx1MTc1M1xcdTE3NzJcXHUxNzczXFx1MTdiNy1cXHUxN2JkXFx1MTdjNlxcdTE3YzktXFx1MTdkM1xcdTE3ZGRcXHUxODBiLVxcdTE4MGRcXHUxOGE5XFx1MTkyMC1cXHUxOTIyXFx1MTkyN1xcdTE5MjhcXHUxOTMyXFx1MTkzOS1cXHUxOTNiXFx1MWExN1xcdTFhMThcXHUxYTU2XFx1MWE1OC1cXHUxYTVlXFx1MWE2MFxcdTFhNjJcXHUxYTY1LVxcdTFhNmNcXHUxYTczLVxcdTFhN2NcXHUxYTdmXFx1MWIwMC1cXHUxYjAzXFx1MWIzNFxcdTFiMzYtXFx1MWIzYVxcdTFiM2NcXHUxYjQyXFx1MWI2Yi1cXHUxYjczXFx1MWI4MFxcdTFiODFcXHUxYmEyLVxcdTFiYTVcXHUxYmE4XFx1MWJhOVxcdTFjMmMtXFx1MWMzM1xcdTFjMzZcXHUxYzM3XFx1MWNkMC1cXHUxY2QyXFx1MWNkNC1cXHUxY2UwXFx1MWNlMi1cXHUxY2U4XFx1MWNlZFxcdTFkYzAtXFx1MWRlNlxcdTFkZmQtXFx1MWRmZlxcdTIwMGNcXHUyMDBkXFx1MjBkMC1cXHUyMGYwXFx1MmNlZi1cXHUyY2YxXFx1MmRlMC1cXHUyZGZmXFx1MzAyYS1cXHUzMDJmXFx1MzA5OVxcdTMwOWFcXHVhNjZmLVxcdWE2NzJcXHVhNjdjXFx1YTY3ZFxcdWE2ZjBcXHVhNmYxXFx1YTgwMlxcdWE4MDZcXHVhODBiXFx1YTgyNVxcdWE4MjZcXHVhOGM0XFx1YThlMC1cXHVhOGYxXFx1YTkyNi1cXHVhOTJkXFx1YTk0Ny1cXHVhOTUxXFx1YTk4MC1cXHVhOTgyXFx1YTliM1xcdWE5YjYtXFx1YTliOVxcdWE5YmNcXHVhYTI5LVxcdWFhMmVcXHVhYTMxXFx1YWEzMlxcdWFhMzVcXHVhYTM2XFx1YWE0M1xcdWFhNGNcXHVhYWIwXFx1YWFiMi1cXHVhYWI0XFx1YWFiN1xcdWFhYjhcXHVhYWJlXFx1YWFiZlxcdWFhYzFcXHVhYmU1XFx1YWJlOFxcdWFiZWRcXHVkYzAwLVxcdWRmZmZcXHVmYjFlXFx1ZmUwMC1cXHVmZTBmXFx1ZmUyMC1cXHVmZTI2XFx1ZmY5ZVxcdWZmOWZdLztcbiAgZnVuY3Rpb24gaXNFeHRlbmRpbmdDaGFyKGNoKSB7IHJldHVybiBjaC5jaGFyQ29kZUF0KDApID49IDc2OCAmJiBleHRlbmRpbmdDaGFycy50ZXN0KGNoKTsgfVxuXG4gIC8vIERPTSBVVElMSVRJRVNcblxuICBmdW5jdGlvbiBlbHQodGFnLCBjb250ZW50LCBjbGFzc05hbWUsIHN0eWxlKSB7XG4gICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7XG4gICAgaWYgKGNsYXNzTmFtZSkgZS5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgaWYgKHN0eWxlKSBlLnN0eWxlLmNzc1RleHQgPSBzdHlsZTtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT0gXCJzdHJpbmdcIikgZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb250ZW50KSk7XG4gICAgZWxzZSBpZiAoY29udGVudCkgZm9yICh2YXIgaSA9IDA7IGkgPCBjb250ZW50Lmxlbmd0aDsgKytpKSBlLmFwcGVuZENoaWxkKGNvbnRlbnRbaV0pO1xuICAgIHJldHVybiBlO1xuICB9XG5cbiAgdmFyIHJhbmdlO1xuICBpZiAoZG9jdW1lbnQuY3JlYXRlUmFuZ2UpIHJhbmdlID0gZnVuY3Rpb24obm9kZSwgc3RhcnQsIGVuZCwgZW5kTm9kZSkge1xuICAgIHZhciByID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcbiAgICByLnNldEVuZChlbmROb2RlIHx8IG5vZGUsIGVuZCk7XG4gICAgci5zZXRTdGFydChub2RlLCBzdGFydCk7XG4gICAgcmV0dXJuIHI7XG4gIH07XG4gIGVsc2UgcmFuZ2UgPSBmdW5jdGlvbihub2RlLCBzdGFydCwgZW5kKSB7XG4gICAgdmFyIHIgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xuICAgIHRyeSB7IHIubW92ZVRvRWxlbWVudFRleHQobm9kZS5wYXJlbnROb2RlKTsgfVxuICAgIGNhdGNoKGUpIHsgcmV0dXJuIHI7IH1cbiAgICByLmNvbGxhcHNlKHRydWUpO1xuICAgIHIubW92ZUVuZChcImNoYXJhY3RlclwiLCBlbmQpO1xuICAgIHIubW92ZVN0YXJ0KFwiY2hhcmFjdGVyXCIsIHN0YXJ0KTtcbiAgICByZXR1cm4gcjtcbiAgfTtcblxuICBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbihlKSB7XG4gICAgZm9yICh2YXIgY291bnQgPSBlLmNoaWxkTm9kZXMubGVuZ3RoOyBjb3VudCA+IDA7IC0tY291bnQpXG4gICAgICBlLnJlbW92ZUNoaWxkKGUuZmlyc3RDaGlsZCk7XG4gICAgcmV0dXJuIGU7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVDaGlsZHJlbkFuZEFkZChwYXJlbnQsIGUpIHtcbiAgICByZXR1cm4gcmVtb3ZlQ2hpbGRyZW4ocGFyZW50KS5hcHBlbmRDaGlsZChlKTtcbiAgfVxuXG4gIHZhciBjb250YWlucyA9IENvZGVNaXJyb3IuY29udGFpbnMgPSBmdW5jdGlvbihwYXJlbnQsIGNoaWxkKSB7XG4gICAgaWYgKGNoaWxkLm5vZGVUeXBlID09IDMpIC8vIEFuZHJvaWQgYnJvd3NlciBhbHdheXMgcmV0dXJucyBmYWxzZSB3aGVuIGNoaWxkIGlzIGEgdGV4dG5vZGVcbiAgICAgIGNoaWxkID0gY2hpbGQucGFyZW50Tm9kZTtcbiAgICBpZiAocGFyZW50LmNvbnRhaW5zKVxuICAgICAgcmV0dXJuIHBhcmVudC5jb250YWlucyhjaGlsZCk7XG4gICAgZG8ge1xuICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09IDExKSBjaGlsZCA9IGNoaWxkLmhvc3Q7XG4gICAgICBpZiAoY2hpbGQgPT0gcGFyZW50KSByZXR1cm4gdHJ1ZTtcbiAgICB9IHdoaWxlIChjaGlsZCA9IGNoaWxkLnBhcmVudE5vZGUpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGFjdGl2ZUVsdCgpIHtcbiAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgd2hpbGUgKGFjdGl2ZUVsZW1lbnQgJiYgYWN0aXZlRWxlbWVudC5yb290ICYmIGFjdGl2ZUVsZW1lbnQucm9vdC5hY3RpdmVFbGVtZW50KVxuICAgICAgYWN0aXZlRWxlbWVudCA9IGFjdGl2ZUVsZW1lbnQucm9vdC5hY3RpdmVFbGVtZW50O1xuICAgIHJldHVybiBhY3RpdmVFbGVtZW50O1xuICB9XG4gIC8vIE9sZGVyIHZlcnNpb25zIG9mIElFIHRocm93cyB1bnNwZWNpZmllZCBlcnJvciB3aGVuIHRvdWNoaW5nXG4gIC8vIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgaW4gc29tZSBjYXNlcyAoZHVyaW5nIGxvYWRpbmcsIGluIGlmcmFtZSlcbiAgaWYgKGllICYmIGllX3ZlcnNpb24gPCAxMSkgYWN0aXZlRWx0ID0gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHsgcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7IH1cbiAgICBjYXRjaChlKSB7IHJldHVybiBkb2N1bWVudC5ib2R5OyB9XG4gIH07XG5cbiAgZnVuY3Rpb24gY2xhc3NUZXN0KGNscykgeyByZXR1cm4gbmV3IFJlZ0V4cChcIihefFxcXFxzKVwiICsgY2xzICsgXCIoPzokfFxcXFxzKVxcXFxzKlwiKTsgfVxuICB2YXIgcm1DbGFzcyA9IENvZGVNaXJyb3Iucm1DbGFzcyA9IGZ1bmN0aW9uKG5vZGUsIGNscykge1xuICAgIHZhciBjdXJyZW50ID0gbm9kZS5jbGFzc05hbWU7XG4gICAgdmFyIG1hdGNoID0gY2xhc3NUZXN0KGNscykuZXhlYyhjdXJyZW50KTtcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIHZhciBhZnRlciA9IGN1cnJlbnQuc2xpY2UobWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgbm9kZS5jbGFzc05hbWUgPSBjdXJyZW50LnNsaWNlKDAsIG1hdGNoLmluZGV4KSArIChhZnRlciA/IG1hdGNoWzFdICsgYWZ0ZXIgOiBcIlwiKTtcbiAgICB9XG4gIH07XG4gIHZhciBhZGRDbGFzcyA9IENvZGVNaXJyb3IuYWRkQ2xhc3MgPSBmdW5jdGlvbihub2RlLCBjbHMpIHtcbiAgICB2YXIgY3VycmVudCA9IG5vZGUuY2xhc3NOYW1lO1xuICAgIGlmICghY2xhc3NUZXN0KGNscykudGVzdChjdXJyZW50KSkgbm9kZS5jbGFzc05hbWUgKz0gKGN1cnJlbnQgPyBcIiBcIiA6IFwiXCIpICsgY2xzO1xuICB9O1xuICBmdW5jdGlvbiBqb2luQ2xhc3NlcyhhLCBiKSB7XG4gICAgdmFyIGFzID0gYS5zcGxpdChcIiBcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKylcbiAgICAgIGlmIChhc1tpXSAmJiAhY2xhc3NUZXN0KGFzW2ldKS50ZXN0KGIpKSBiICs9IFwiIFwiICsgYXNbaV07XG4gICAgcmV0dXJuIGI7XG4gIH1cblxuICAvLyBXSU5ET1ctV0lERSBFVkVOVFNcblxuICAvLyBUaGVzZSBtdXN0IGJlIGhhbmRsZWQgY2FyZWZ1bGx5LCBiZWNhdXNlIG5haXZlbHkgcmVnaXN0ZXJpbmcgYVxuICAvLyBoYW5kbGVyIGZvciBlYWNoIGVkaXRvciB3aWxsIGNhdXNlIHRoZSBlZGl0b3JzIHRvIG5ldmVyIGJlXG4gIC8vIGdhcmJhZ2UgY29sbGVjdGVkLlxuXG4gIGZ1bmN0aW9uIGZvckVhY2hDb2RlTWlycm9yKGYpIHtcbiAgICBpZiAoIWRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSkgcmV0dXJuO1xuICAgIHZhciBieUNsYXNzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiQ29kZU1pcnJvclwiKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5Q2xhc3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjbSA9IGJ5Q2xhc3NbaV0uQ29kZU1pcnJvcjtcbiAgICAgIGlmIChjbSkgZihjbSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGdsb2JhbHNSZWdpc3RlcmVkID0gZmFsc2U7XG4gIGZ1bmN0aW9uIGVuc3VyZUdsb2JhbEhhbmRsZXJzKCkge1xuICAgIGlmIChnbG9iYWxzUmVnaXN0ZXJlZCkgcmV0dXJuO1xuICAgIHJlZ2lzdGVyR2xvYmFsSGFuZGxlcnMoKTtcbiAgICBnbG9iYWxzUmVnaXN0ZXJlZCA9IHRydWU7XG4gIH1cbiAgZnVuY3Rpb24gcmVnaXN0ZXJHbG9iYWxIYW5kbGVycygpIHtcbiAgICAvLyBXaGVuIHRoZSB3aW5kb3cgcmVzaXplcywgd2UgbmVlZCB0byByZWZyZXNoIGFjdGl2ZSBlZGl0b3JzLlxuICAgIHZhciByZXNpemVUaW1lcjtcbiAgICBvbih3aW5kb3csIFwicmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHJlc2l6ZVRpbWVyID09IG51bGwpIHJlc2l6ZVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzaXplVGltZXIgPSBudWxsO1xuICAgICAgICBmb3JFYWNoQ29kZU1pcnJvcihvblJlc2l6ZSk7XG4gICAgICB9LCAxMDApO1xuICAgIH0pO1xuICAgIC8vIFdoZW4gdGhlIHdpbmRvdyBsb3NlcyBmb2N1cywgd2Ugd2FudCB0byBzaG93IHRoZSBlZGl0b3IgYXMgYmx1cnJlZFxuICAgIG9uKHdpbmRvdywgXCJibHVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgZm9yRWFjaENvZGVNaXJyb3Iob25CbHVyKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEZFQVRVUkUgREVURUNUSU9OXG5cbiAgLy8gRGV0ZWN0IGRyYWctYW5kLWRyb3BcbiAgdmFyIGRyYWdBbmREcm9wID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gVGhlcmUgaXMgKnNvbWUqIGtpbmQgb2YgZHJhZy1hbmQtZHJvcCBzdXBwb3J0IGluIElFNi04LCBidXQgSVxuICAgIC8vIGNvdWxkbid0IGdldCBpdCB0byB3b3JrIHlldC5cbiAgICBpZiAoaWUgJiYgaWVfdmVyc2lvbiA8IDkpIHJldHVybiBmYWxzZTtcbiAgICB2YXIgZGl2ID0gZWx0KCdkaXYnKTtcbiAgICByZXR1cm4gXCJkcmFnZ2FibGVcIiBpbiBkaXYgfHwgXCJkcmFnRHJvcFwiIGluIGRpdjtcbiAgfSgpO1xuXG4gIHZhciB6d3NwU3VwcG9ydGVkO1xuICBmdW5jdGlvbiB6ZXJvV2lkdGhFbGVtZW50KG1lYXN1cmUpIHtcbiAgICBpZiAoendzcFN1cHBvcnRlZCA9PSBudWxsKSB7XG4gICAgICB2YXIgdGVzdCA9IGVsdChcInNwYW5cIiwgXCJcXHUyMDBiXCIpO1xuICAgICAgcmVtb3ZlQ2hpbGRyZW5BbmRBZGQobWVhc3VyZSwgZWx0KFwic3BhblwiLCBbdGVzdCwgZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJ4XCIpXSkpO1xuICAgICAgaWYgKG1lYXN1cmUuZmlyc3RDaGlsZC5vZmZzZXRIZWlnaHQgIT0gMClcbiAgICAgICAgendzcFN1cHBvcnRlZCA9IHRlc3Qub2Zmc2V0V2lkdGggPD0gMSAmJiB0ZXN0Lm9mZnNldEhlaWdodCA+IDIgJiYgIShpZSAmJiBpZV92ZXJzaW9uIDwgOCk7XG4gICAgfVxuICAgIHZhciBub2RlID0gendzcFN1cHBvcnRlZCA/IGVsdChcInNwYW5cIiwgXCJcXHUyMDBiXCIpIDpcbiAgICAgIGVsdChcInNwYW5cIiwgXCJcXHUwMGEwXCIsIG51bGwsIFwiZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aWR0aDogMXB4OyBtYXJnaW4tcmlnaHQ6IC0xcHhcIik7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGUoXCJjbS10ZXh0XCIsIFwiXCIpO1xuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgLy8gRmVhdHVyZS1kZXRlY3QgSUUncyBjcnVtbXkgY2xpZW50IHJlY3QgcmVwb3J0aW5nIGZvciBiaWRpIHRleHRcbiAgdmFyIGJhZEJpZGlSZWN0cztcbiAgZnVuY3Rpb24gaGFzQmFkQmlkaVJlY3RzKG1lYXN1cmUpIHtcbiAgICBpZiAoYmFkQmlkaVJlY3RzICE9IG51bGwpIHJldHVybiBiYWRCaWRpUmVjdHM7XG4gICAgdmFyIHR4dCA9IHJlbW92ZUNoaWxkcmVuQW5kQWRkKG1lYXN1cmUsIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiQVxcdTA2MmVBXCIpKTtcbiAgICB2YXIgcjAgPSByYW5nZSh0eHQsIDAsIDEpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmICghcjAgfHwgcjAubGVmdCA9PSByMC5yaWdodCkgcmV0dXJuIGZhbHNlOyAvLyBTYWZhcmkgcmV0dXJucyBudWxsIGluIHNvbWUgY2FzZXMgKCMyNzgwKVxuICAgIHZhciByMSA9IHJhbmdlKHR4dCwgMSwgMikuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIGJhZEJpZGlSZWN0cyA9IChyMS5yaWdodCAtIHIwLnJpZ2h0IDwgMyk7XG4gIH1cblxuICAvLyBTZWUgaWYgXCJcIi5zcGxpdCBpcyB0aGUgYnJva2VuIElFIHZlcnNpb24sIGlmIHNvLCBwcm92aWRlIGFuXG4gIC8vIGFsdGVybmF0aXZlIHdheSB0byBzcGxpdCBsaW5lcy5cbiAgdmFyIHNwbGl0TGluZXNBdXRvID0gQ29kZU1pcnJvci5zcGxpdExpbmVzID0gXCJcXG5cXG5iXCIuc3BsaXQoL1xcbi8pLmxlbmd0aCAhPSAzID8gZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgdmFyIHBvcyA9IDAsIHJlc3VsdCA9IFtdLCBsID0gc3RyaW5nLmxlbmd0aDtcbiAgICB3aGlsZSAocG9zIDw9IGwpIHtcbiAgICAgIHZhciBubCA9IHN0cmluZy5pbmRleE9mKFwiXFxuXCIsIHBvcyk7XG4gICAgICBpZiAobmwgPT0gLTEpIG5sID0gc3RyaW5nLmxlbmd0aDtcbiAgICAgIHZhciBsaW5lID0gc3RyaW5nLnNsaWNlKHBvcywgc3RyaW5nLmNoYXJBdChubCAtIDEpID09IFwiXFxyXCIgPyBubCAtIDEgOiBubCk7XG4gICAgICB2YXIgcnQgPSBsaW5lLmluZGV4T2YoXCJcXHJcIik7XG4gICAgICBpZiAocnQgIT0gLTEpIHtcbiAgICAgICAgcmVzdWx0LnB1c2gobGluZS5zbGljZSgwLCBydCkpO1xuICAgICAgICBwb3MgKz0gcnQgKyAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LnB1c2gobGluZSk7XG4gICAgICAgIHBvcyA9IG5sICsgMTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSA6IGZ1bmN0aW9uKHN0cmluZyl7cmV0dXJuIHN0cmluZy5zcGxpdCgvXFxyXFxuP3xcXG4vKTt9O1xuXG4gIHZhciBoYXNTZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uID8gZnVuY3Rpb24odGUpIHtcbiAgICB0cnkgeyByZXR1cm4gdGUuc2VsZWN0aW9uU3RhcnQgIT0gdGUuc2VsZWN0aW9uRW5kOyB9XG4gICAgY2F0Y2goZSkgeyByZXR1cm4gZmFsc2U7IH1cbiAgfSA6IGZ1bmN0aW9uKHRlKSB7XG4gICAgdHJ5IHt2YXIgcmFuZ2UgPSB0ZS5vd25lckRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO31cbiAgICBjYXRjaChlKSB7fVxuICAgIGlmICghcmFuZ2UgfHwgcmFuZ2UucGFyZW50RWxlbWVudCgpICE9IHRlKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHJhbmdlLmNvbXBhcmVFbmRQb2ludHMoXCJTdGFydFRvRW5kXCIsIHJhbmdlKSAhPSAwO1xuICB9O1xuXG4gIHZhciBoYXNDb3B5RXZlbnQgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIGUgPSBlbHQoXCJkaXZcIik7XG4gICAgaWYgKFwib25jb3B5XCIgaW4gZSkgcmV0dXJuIHRydWU7XG4gICAgZS5zZXRBdHRyaWJ1dGUoXCJvbmNvcHlcIiwgXCJyZXR1cm47XCIpO1xuICAgIHJldHVybiB0eXBlb2YgZS5vbmNvcHkgPT0gXCJmdW5jdGlvblwiO1xuICB9KSgpO1xuXG4gIHZhciBiYWRab29tZWRSZWN0cyA9IG51bGw7XG4gIGZ1bmN0aW9uIGhhc0JhZFpvb21lZFJlY3RzKG1lYXN1cmUpIHtcbiAgICBpZiAoYmFkWm9vbWVkUmVjdHMgIT0gbnVsbCkgcmV0dXJuIGJhZFpvb21lZFJlY3RzO1xuICAgIHZhciBub2RlID0gcmVtb3ZlQ2hpbGRyZW5BbmRBZGQobWVhc3VyZSwgZWx0KFwic3BhblwiLCBcInhcIikpO1xuICAgIHZhciBub3JtYWwgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHZhciBmcm9tUmFuZ2UgPSByYW5nZShub2RlLCAwLCAxKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4gYmFkWm9vbWVkUmVjdHMgPSBNYXRoLmFicyhub3JtYWwubGVmdCAtIGZyb21SYW5nZS5sZWZ0KSA+IDE7XG4gIH1cblxuICAvLyBLRVkgTkFNRVNcblxuICB2YXIga2V5TmFtZXMgPSBDb2RlTWlycm9yLmtleU5hbWVzID0ge1xuICAgIDM6IFwiRW50ZXJcIiwgODogXCJCYWNrc3BhY2VcIiwgOTogXCJUYWJcIiwgMTM6IFwiRW50ZXJcIiwgMTY6IFwiU2hpZnRcIiwgMTc6IFwiQ3RybFwiLCAxODogXCJBbHRcIixcbiAgICAxOTogXCJQYXVzZVwiLCAyMDogXCJDYXBzTG9ja1wiLCAyNzogXCJFc2NcIiwgMzI6IFwiU3BhY2VcIiwgMzM6IFwiUGFnZVVwXCIsIDM0OiBcIlBhZ2VEb3duXCIsIDM1OiBcIkVuZFwiLFxuICAgIDM2OiBcIkhvbWVcIiwgMzc6IFwiTGVmdFwiLCAzODogXCJVcFwiLCAzOTogXCJSaWdodFwiLCA0MDogXCJEb3duXCIsIDQ0OiBcIlByaW50U2NyblwiLCA0NTogXCJJbnNlcnRcIixcbiAgICA0NjogXCJEZWxldGVcIiwgNTk6IFwiO1wiLCA2MTogXCI9XCIsIDkxOiBcIk1vZFwiLCA5MjogXCJNb2RcIiwgOTM6IFwiTW9kXCIsXG4gICAgMTA2OiBcIipcIiwgMTA3OiBcIj1cIiwgMTA5OiBcIi1cIiwgMTEwOiBcIi5cIiwgMTExOiBcIi9cIiwgMTI3OiBcIkRlbGV0ZVwiLFxuICAgIDE3MzogXCItXCIsIDE4NjogXCI7XCIsIDE4NzogXCI9XCIsIDE4ODogXCIsXCIsIDE4OTogXCItXCIsIDE5MDogXCIuXCIsIDE5MTogXCIvXCIsIDE5MjogXCJgXCIsIDIxOTogXCJbXCIsIDIyMDogXCJcXFxcXCIsXG4gICAgMjIxOiBcIl1cIiwgMjIyOiBcIidcIiwgNjMyMzI6IFwiVXBcIiwgNjMyMzM6IFwiRG93blwiLCA2MzIzNDogXCJMZWZ0XCIsIDYzMjM1OiBcIlJpZ2h0XCIsIDYzMjcyOiBcIkRlbGV0ZVwiLFxuICAgIDYzMjczOiBcIkhvbWVcIiwgNjMyNzU6IFwiRW5kXCIsIDYzMjc2OiBcIlBhZ2VVcFwiLCA2MzI3NzogXCJQYWdlRG93blwiLCA2MzMwMjogXCJJbnNlcnRcIlxuICB9O1xuICAoZnVuY3Rpb24oKSB7XG4gICAgLy8gTnVtYmVyIGtleXNcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIGtleU5hbWVzW2kgKyA0OF0gPSBrZXlOYW1lc1tpICsgOTZdID0gU3RyaW5nKGkpO1xuICAgIC8vIEFscGhhYmV0aWMga2V5c1xuICAgIGZvciAodmFyIGkgPSA2NTsgaSA8PSA5MDsgaSsrKSBrZXlOYW1lc1tpXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoaSk7XG4gICAgLy8gRnVuY3Rpb24ga2V5c1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDEyOyBpKyspIGtleU5hbWVzW2kgKyAxMTFdID0ga2V5TmFtZXNbaSArIDYzMjM1XSA9IFwiRlwiICsgaTtcbiAgfSkoKTtcblxuICAvLyBCSURJIEhFTFBFUlNcblxuICBmdW5jdGlvbiBpdGVyYXRlQmlkaVNlY3Rpb25zKG9yZGVyLCBmcm9tLCB0bywgZikge1xuICAgIGlmICghb3JkZXIpIHJldHVybiBmKGZyb20sIHRvLCBcImx0clwiKTtcbiAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9yZGVyLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgcGFydCA9IG9yZGVyW2ldO1xuICAgICAgaWYgKHBhcnQuZnJvbSA8IHRvICYmIHBhcnQudG8gPiBmcm9tIHx8IGZyb20gPT0gdG8gJiYgcGFydC50byA9PSBmcm9tKSB7XG4gICAgICAgIGYoTWF0aC5tYXgocGFydC5mcm9tLCBmcm9tKSwgTWF0aC5taW4ocGFydC50bywgdG8pLCBwYXJ0LmxldmVsID09IDEgPyBcInJ0bFwiIDogXCJsdHJcIik7XG4gICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFmb3VuZCkgZihmcm9tLCB0bywgXCJsdHJcIik7XG4gIH1cblxuICBmdW5jdGlvbiBiaWRpTGVmdChwYXJ0KSB7IHJldHVybiBwYXJ0LmxldmVsICUgMiA/IHBhcnQudG8gOiBwYXJ0LmZyb207IH1cbiAgZnVuY3Rpb24gYmlkaVJpZ2h0KHBhcnQpIHsgcmV0dXJuIHBhcnQubGV2ZWwgJSAyID8gcGFydC5mcm9tIDogcGFydC50bzsgfVxuXG4gIGZ1bmN0aW9uIGxpbmVMZWZ0KGxpbmUpIHsgdmFyIG9yZGVyID0gZ2V0T3JkZXIobGluZSk7IHJldHVybiBvcmRlciA/IGJpZGlMZWZ0KG9yZGVyWzBdKSA6IDA7IH1cbiAgZnVuY3Rpb24gbGluZVJpZ2h0KGxpbmUpIHtcbiAgICB2YXIgb3JkZXIgPSBnZXRPcmRlcihsaW5lKTtcbiAgICBpZiAoIW9yZGVyKSByZXR1cm4gbGluZS50ZXh0Lmxlbmd0aDtcbiAgICByZXR1cm4gYmlkaVJpZ2h0KGxzdChvcmRlcikpO1xuICB9XG5cbiAgZnVuY3Rpb24gbGluZVN0YXJ0KGNtLCBsaW5lTikge1xuICAgIHZhciBsaW5lID0gZ2V0TGluZShjbS5kb2MsIGxpbmVOKTtcbiAgICB2YXIgdmlzdWFsID0gdmlzdWFsTGluZShsaW5lKTtcbiAgICBpZiAodmlzdWFsICE9IGxpbmUpIGxpbmVOID0gbGluZU5vKHZpc3VhbCk7XG4gICAgdmFyIG9yZGVyID0gZ2V0T3JkZXIodmlzdWFsKTtcbiAgICB2YXIgY2ggPSAhb3JkZXIgPyAwIDogb3JkZXJbMF0ubGV2ZWwgJSAyID8gbGluZVJpZ2h0KHZpc3VhbCkgOiBsaW5lTGVmdCh2aXN1YWwpO1xuICAgIHJldHVybiBQb3MobGluZU4sIGNoKTtcbiAgfVxuICBmdW5jdGlvbiBsaW5lRW5kKGNtLCBsaW5lTikge1xuICAgIHZhciBtZXJnZWQsIGxpbmUgPSBnZXRMaW5lKGNtLmRvYywgbGluZU4pO1xuICAgIHdoaWxlIChtZXJnZWQgPSBjb2xsYXBzZWRTcGFuQXRFbmQobGluZSkpIHtcbiAgICAgIGxpbmUgPSBtZXJnZWQuZmluZCgxLCB0cnVlKS5saW5lO1xuICAgICAgbGluZU4gPSBudWxsO1xuICAgIH1cbiAgICB2YXIgb3JkZXIgPSBnZXRPcmRlcihsaW5lKTtcbiAgICB2YXIgY2ggPSAhb3JkZXIgPyBsaW5lLnRleHQubGVuZ3RoIDogb3JkZXJbMF0ubGV2ZWwgJSAyID8gbGluZUxlZnQobGluZSkgOiBsaW5lUmlnaHQobGluZSk7XG4gICAgcmV0dXJuIFBvcyhsaW5lTiA9PSBudWxsID8gbGluZU5vKGxpbmUpIDogbGluZU4sIGNoKTtcbiAgfVxuICBmdW5jdGlvbiBsaW5lU3RhcnRTbWFydChjbSwgcG9zKSB7XG4gICAgdmFyIHN0YXJ0ID0gbGluZVN0YXJ0KGNtLCBwb3MubGluZSk7XG4gICAgdmFyIGxpbmUgPSBnZXRMaW5lKGNtLmRvYywgc3RhcnQubGluZSk7XG4gICAgdmFyIG9yZGVyID0gZ2V0T3JkZXIobGluZSk7XG4gICAgaWYgKCFvcmRlciB8fCBvcmRlclswXS5sZXZlbCA9PSAwKSB7XG4gICAgICB2YXIgZmlyc3ROb25XUyA9IE1hdGgubWF4KDAsIGxpbmUudGV4dC5zZWFyY2goL1xcUy8pKTtcbiAgICAgIHZhciBpbldTID0gcG9zLmxpbmUgPT0gc3RhcnQubGluZSAmJiBwb3MuY2ggPD0gZmlyc3ROb25XUyAmJiBwb3MuY2g7XG4gICAgICByZXR1cm4gUG9zKHN0YXJ0LmxpbmUsIGluV1MgPyAwIDogZmlyc3ROb25XUyk7XG4gICAgfVxuICAgIHJldHVybiBzdGFydDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXBhcmVCaWRpTGV2ZWwob3JkZXIsIGEsIGIpIHtcbiAgICB2YXIgbGluZWRpciA9IG9yZGVyWzBdLmxldmVsO1xuICAgIGlmIChhID09IGxpbmVkaXIpIHJldHVybiB0cnVlO1xuICAgIGlmIChiID09IGxpbmVkaXIpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gYSA8IGI7XG4gIH1cbiAgdmFyIGJpZGlPdGhlcjtcbiAgZnVuY3Rpb24gZ2V0QmlkaVBhcnRBdChvcmRlciwgcG9zKSB7XG4gICAgYmlkaU90aGVyID0gbnVsbDtcbiAgICBmb3IgKHZhciBpID0gMCwgZm91bmQ7IGkgPCBvcmRlci5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIGN1ciA9IG9yZGVyW2ldO1xuICAgICAgaWYgKGN1ci5mcm9tIDwgcG9zICYmIGN1ci50byA+IHBvcykgcmV0dXJuIGk7XG4gICAgICBpZiAoKGN1ci5mcm9tID09IHBvcyB8fCBjdXIudG8gPT0gcG9zKSkge1xuICAgICAgICBpZiAoZm91bmQgPT0gbnVsbCkge1xuICAgICAgICAgIGZvdW5kID0gaTtcbiAgICAgICAgfSBlbHNlIGlmIChjb21wYXJlQmlkaUxldmVsKG9yZGVyLCBjdXIubGV2ZWwsIG9yZGVyW2ZvdW5kXS5sZXZlbCkpIHtcbiAgICAgICAgICBpZiAoY3VyLmZyb20gIT0gY3VyLnRvKSBiaWRpT3RoZXIgPSBmb3VuZDtcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY3VyLmZyb20gIT0gY3VyLnRvKSBiaWRpT3RoZXIgPSBpO1xuICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZm91bmQ7XG4gIH1cblxuICBmdW5jdGlvbiBtb3ZlSW5MaW5lKGxpbmUsIHBvcywgZGlyLCBieVVuaXQpIHtcbiAgICBpZiAoIWJ5VW5pdCkgcmV0dXJuIHBvcyArIGRpcjtcbiAgICBkbyBwb3MgKz0gZGlyO1xuICAgIHdoaWxlIChwb3MgPiAwICYmIGlzRXh0ZW5kaW5nQ2hhcihsaW5lLnRleHQuY2hhckF0KHBvcykpKTtcbiAgICByZXR1cm4gcG9zO1xuICB9XG5cbiAgLy8gVGhpcyBpcyBuZWVkZWQgaW4gb3JkZXIgdG8gbW92ZSAndmlzdWFsbHknIHRocm91Z2ggYmktZGlyZWN0aW9uYWxcbiAgLy8gdGV4dCAtLSBpLmUuLCBwcmVzc2luZyBsZWZ0IHNob3VsZCBtYWtlIHRoZSBjdXJzb3IgZ28gbGVmdCwgZXZlblxuICAvLyB3aGVuIGluIFJUTCB0ZXh0LiBUaGUgdHJpY2t5IHBhcnQgaXMgdGhlICdqdW1wcycsIHdoZXJlIFJUTCBhbmRcbiAgLy8gTFRSIHRleHQgdG91Y2ggZWFjaCBvdGhlci4gVGhpcyBvZnRlbiByZXF1aXJlcyB0aGUgY3Vyc29yIG9mZnNldFxuICAvLyB0byBtb3ZlIG1vcmUgdGhhbiBvbmUgdW5pdCwgaW4gb3JkZXIgdG8gdmlzdWFsbHkgbW92ZSBvbmUgdW5pdC5cbiAgZnVuY3Rpb24gbW92ZVZpc3VhbGx5KGxpbmUsIHN0YXJ0LCBkaXIsIGJ5VW5pdCkge1xuICAgIHZhciBiaWRpID0gZ2V0T3JkZXIobGluZSk7XG4gICAgaWYgKCFiaWRpKSByZXR1cm4gbW92ZUxvZ2ljYWxseShsaW5lLCBzdGFydCwgZGlyLCBieVVuaXQpO1xuICAgIHZhciBwb3MgPSBnZXRCaWRpUGFydEF0KGJpZGksIHN0YXJ0KSwgcGFydCA9IGJpZGlbcG9zXTtcbiAgICB2YXIgdGFyZ2V0ID0gbW92ZUluTGluZShsaW5lLCBzdGFydCwgcGFydC5sZXZlbCAlIDIgPyAtZGlyIDogZGlyLCBieVVuaXQpO1xuXG4gICAgZm9yICg7Oykge1xuICAgICAgaWYgKHRhcmdldCA+IHBhcnQuZnJvbSAmJiB0YXJnZXQgPCBwYXJ0LnRvKSByZXR1cm4gdGFyZ2V0O1xuICAgICAgaWYgKHRhcmdldCA9PSBwYXJ0LmZyb20gfHwgdGFyZ2V0ID09IHBhcnQudG8pIHtcbiAgICAgICAgaWYgKGdldEJpZGlQYXJ0QXQoYmlkaSwgdGFyZ2V0KSA9PSBwb3MpIHJldHVybiB0YXJnZXQ7XG4gICAgICAgIHBhcnQgPSBiaWRpW3BvcyArPSBkaXJdO1xuICAgICAgICByZXR1cm4gKGRpciA+IDApID09IHBhcnQubGV2ZWwgJSAyID8gcGFydC50byA6IHBhcnQuZnJvbTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcnQgPSBiaWRpW3BvcyArPSBkaXJdO1xuICAgICAgICBpZiAoIXBhcnQpIHJldHVybiBudWxsO1xuICAgICAgICBpZiAoKGRpciA+IDApID09IHBhcnQubGV2ZWwgJSAyKVxuICAgICAgICAgIHRhcmdldCA9IG1vdmVJbkxpbmUobGluZSwgcGFydC50bywgLTEsIGJ5VW5pdCk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICB0YXJnZXQgPSBtb3ZlSW5MaW5lKGxpbmUsIHBhcnQuZnJvbSwgMSwgYnlVbml0KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBtb3ZlTG9naWNhbGx5KGxpbmUsIHN0YXJ0LCBkaXIsIGJ5VW5pdCkge1xuICAgIHZhciB0YXJnZXQgPSBzdGFydCArIGRpcjtcbiAgICBpZiAoYnlVbml0KSB3aGlsZSAodGFyZ2V0ID4gMCAmJiBpc0V4dGVuZGluZ0NoYXIobGluZS50ZXh0LmNoYXJBdCh0YXJnZXQpKSkgdGFyZ2V0ICs9IGRpcjtcbiAgICByZXR1cm4gdGFyZ2V0IDwgMCB8fCB0YXJnZXQgPiBsaW5lLnRleHQubGVuZ3RoID8gbnVsbCA6IHRhcmdldDtcbiAgfVxuXG4gIC8vIEJpZGlyZWN0aW9uYWwgb3JkZXJpbmcgYWxnb3JpdGhtXG4gIC8vIFNlZSBodHRwOi8vdW5pY29kZS5vcmcvcmVwb3J0cy90cjkvdHI5LTEzLmh0bWwgZm9yIHRoZSBhbGdvcml0aG1cbiAgLy8gdGhhdCB0aGlzIChwYXJ0aWFsbHkpIGltcGxlbWVudHMuXG5cbiAgLy8gT25lLWNoYXIgY29kZXMgdXNlZCBmb3IgY2hhcmFjdGVyIHR5cGVzOlxuICAvLyBMIChMKTogICBMZWZ0LXRvLVJpZ2h0XG4gIC8vIFIgKFIpOiAgIFJpZ2h0LXRvLUxlZnRcbiAgLy8gciAoQUwpOiAgUmlnaHQtdG8tTGVmdCBBcmFiaWNcbiAgLy8gMSAoRU4pOiAgRXVyb3BlYW4gTnVtYmVyXG4gIC8vICsgKEVTKTogIEV1cm9wZWFuIE51bWJlciBTZXBhcmF0b3JcbiAgLy8gJSAoRVQpOiAgRXVyb3BlYW4gTnVtYmVyIFRlcm1pbmF0b3JcbiAgLy8gbiAoQU4pOiAgQXJhYmljIE51bWJlclxuICAvLyAsIChDUyk6ICBDb21tb24gTnVtYmVyIFNlcGFyYXRvclxuICAvLyBtIChOU00pOiBOb24tU3BhY2luZyBNYXJrXG4gIC8vIGIgKEJOKTogIEJvdW5kYXJ5IE5ldXRyYWxcbiAgLy8gcyAoQik6ICAgUGFyYWdyYXBoIFNlcGFyYXRvclxuICAvLyB0IChTKTogICBTZWdtZW50IFNlcGFyYXRvclxuICAvLyB3IChXUyk6ICBXaGl0ZXNwYWNlXG4gIC8vIE4gKE9OKTogIE90aGVyIE5ldXRyYWxzXG5cbiAgLy8gUmV0dXJucyBudWxsIGlmIGNoYXJhY3RlcnMgYXJlIG9yZGVyZWQgYXMgdGhleSBhcHBlYXJcbiAgLy8gKGxlZnQtdG8tcmlnaHQpLCBvciBhbiBhcnJheSBvZiBzZWN0aW9ucyAoe2Zyb20sIHRvLCBsZXZlbH1cbiAgLy8gb2JqZWN0cykgaW4gdGhlIG9yZGVyIGluIHdoaWNoIHRoZXkgb2NjdXIgdmlzdWFsbHkuXG4gIHZhciBiaWRpT3JkZXJpbmcgPSAoZnVuY3Rpb24oKSB7XG4gICAgLy8gQ2hhcmFjdGVyIHR5cGVzIGZvciBjb2RlcG9pbnRzIDAgdG8gMHhmZlxuICAgIHZhciBsb3dUeXBlcyA9IFwiYmJiYmJiYmJidHN0d3NiYmJiYmJiYmJiYmJiYnNzc3R3Tk4lJSVOTk5OTk4sTixOMTExMTExMTExMU5OTk5OTk5MTExMTExMTExMTExMTExMTExMTExMTExMTE5OTk5OTkxMTExMTExMTExMTExMTExMTExMTExMTExMTk5OTmJiYmJiYnNiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYixOJSUlJU5OTk5MTk5OTk4lJTExTkxOTk4xTE5OTk5OTExMTExMTExMTExMTExMTExMTExMTExOTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTE5cIjtcbiAgICAvLyBDaGFyYWN0ZXIgdHlwZXMgZm9yIGNvZGVwb2ludHMgMHg2MDAgdG8gMHg2ZmZcbiAgICB2YXIgYXJhYmljVHlwZXMgPSBcInJycnJycnJycnJycixyTk5tbW1tbW1ycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycm1tbW1tbW1tbW1tbW1tcnJycnJycm5ubm5ubm5ubm4lbm5ycnJtcnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJycnJtbW1tbW1tbW1tbW1tbW1tbW1tTm1tbW1cIjtcbiAgICBmdW5jdGlvbiBjaGFyVHlwZShjb2RlKSB7XG4gICAgICBpZiAoY29kZSA8PSAweGY3KSByZXR1cm4gbG93VHlwZXMuY2hhckF0KGNvZGUpO1xuICAgICAgZWxzZSBpZiAoMHg1OTAgPD0gY29kZSAmJiBjb2RlIDw9IDB4NWY0KSByZXR1cm4gXCJSXCI7XG4gICAgICBlbHNlIGlmICgweDYwMCA8PSBjb2RlICYmIGNvZGUgPD0gMHg2ZWQpIHJldHVybiBhcmFiaWNUeXBlcy5jaGFyQXQoY29kZSAtIDB4NjAwKTtcbiAgICAgIGVsc2UgaWYgKDB4NmVlIDw9IGNvZGUgJiYgY29kZSA8PSAweDhhYykgcmV0dXJuIFwiclwiO1xuICAgICAgZWxzZSBpZiAoMHgyMDAwIDw9IGNvZGUgJiYgY29kZSA8PSAweDIwMGIpIHJldHVybiBcIndcIjtcbiAgICAgIGVsc2UgaWYgKGNvZGUgPT0gMHgyMDBjKSByZXR1cm4gXCJiXCI7XG4gICAgICBlbHNlIHJldHVybiBcIkxcIjtcbiAgICB9XG5cbiAgICB2YXIgYmlkaVJFID0gL1tcXHUwNTkwLVxcdTA1ZjRcXHUwNjAwLVxcdTA2ZmZcXHUwNzAwLVxcdTA4YWNdLztcbiAgICB2YXIgaXNOZXV0cmFsID0gL1tzdHdOXS8sIGlzU3Ryb25nID0gL1tMUnJdLywgY291bnRzQXNMZWZ0ID0gL1tMYjFuXS8sIGNvdW50c0FzTnVtID0gL1sxbl0vO1xuICAgIC8vIEJyb3dzZXJzIHNlZW0gdG8gYWx3YXlzIHRyZWF0IHRoZSBib3VuZGFyaWVzIG9mIGJsb2NrIGVsZW1lbnRzIGFzIGJlaW5nIEwuXG4gICAgdmFyIG91dGVyVHlwZSA9IFwiTFwiO1xuXG4gICAgZnVuY3Rpb24gQmlkaVNwYW4obGV2ZWwsIGZyb20sIHRvKSB7XG4gICAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgICB0aGlzLmZyb20gPSBmcm9tOyB0aGlzLnRvID0gdG87XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cikge1xuICAgICAgaWYgKCFiaWRpUkUudGVzdChzdHIpKSByZXR1cm4gZmFsc2U7XG4gICAgICB2YXIgbGVuID0gc3RyLmxlbmd0aCwgdHlwZXMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCB0eXBlOyBpIDwgbGVuOyArK2kpXG4gICAgICAgIHR5cGVzLnB1c2godHlwZSA9IGNoYXJUeXBlKHN0ci5jaGFyQ29kZUF0KGkpKSk7XG5cbiAgICAgIC8vIFcxLiBFeGFtaW5lIGVhY2ggbm9uLXNwYWNpbmcgbWFyayAoTlNNKSBpbiB0aGUgbGV2ZWwgcnVuLCBhbmRcbiAgICAgIC8vIGNoYW5nZSB0aGUgdHlwZSBvZiB0aGUgTlNNIHRvIHRoZSB0eXBlIG9mIHRoZSBwcmV2aW91c1xuICAgICAgLy8gY2hhcmFjdGVyLiBJZiB0aGUgTlNNIGlzIGF0IHRoZSBzdGFydCBvZiB0aGUgbGV2ZWwgcnVuLCBpdCB3aWxsXG4gICAgICAvLyBnZXQgdGhlIHR5cGUgb2Ygc29yLlxuICAgICAgZm9yICh2YXIgaSA9IDAsIHByZXYgPSBvdXRlclR5cGU7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgdHlwZSA9IHR5cGVzW2ldO1xuICAgICAgICBpZiAodHlwZSA9PSBcIm1cIikgdHlwZXNbaV0gPSBwcmV2O1xuICAgICAgICBlbHNlIHByZXYgPSB0eXBlO1xuICAgICAgfVxuXG4gICAgICAvLyBXMi4gU2VhcmNoIGJhY2t3YXJkcyBmcm9tIGVhY2ggaW5zdGFuY2Ugb2YgYSBFdXJvcGVhbiBudW1iZXJcbiAgICAgIC8vIHVudGlsIHRoZSBmaXJzdCBzdHJvbmcgdHlwZSAoUiwgTCwgQUwsIG9yIHNvcikgaXMgZm91bmQuIElmIGFuXG4gICAgICAvLyBBTCBpcyBmb3VuZCwgY2hhbmdlIHRoZSB0eXBlIG9mIHRoZSBFdXJvcGVhbiBudW1iZXIgdG8gQXJhYmljXG4gICAgICAvLyBudW1iZXIuXG4gICAgICAvLyBXMy4gQ2hhbmdlIGFsbCBBTHMgdG8gUi5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBjdXIgPSBvdXRlclR5cGU7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgdHlwZSA9IHR5cGVzW2ldO1xuICAgICAgICBpZiAodHlwZSA9PSBcIjFcIiAmJiBjdXIgPT0gXCJyXCIpIHR5cGVzW2ldID0gXCJuXCI7XG4gICAgICAgIGVsc2UgaWYgKGlzU3Ryb25nLnRlc3QodHlwZSkpIHsgY3VyID0gdHlwZTsgaWYgKHR5cGUgPT0gXCJyXCIpIHR5cGVzW2ldID0gXCJSXCI7IH1cbiAgICAgIH1cblxuICAgICAgLy8gVzQuIEEgc2luZ2xlIEV1cm9wZWFuIHNlcGFyYXRvciBiZXR3ZWVuIHR3byBFdXJvcGVhbiBudW1iZXJzXG4gICAgICAvLyBjaGFuZ2VzIHRvIGEgRXVyb3BlYW4gbnVtYmVyLiBBIHNpbmdsZSBjb21tb24gc2VwYXJhdG9yIGJldHdlZW5cbiAgICAgIC8vIHR3byBudW1iZXJzIG9mIHRoZSBzYW1lIHR5cGUgY2hhbmdlcyB0byB0aGF0IHR5cGUuXG4gICAgICBmb3IgKHZhciBpID0gMSwgcHJldiA9IHR5cGVzWzBdOyBpIDwgbGVuIC0gMTsgKytpKSB7XG4gICAgICAgIHZhciB0eXBlID0gdHlwZXNbaV07XG4gICAgICAgIGlmICh0eXBlID09IFwiK1wiICYmIHByZXYgPT0gXCIxXCIgJiYgdHlwZXNbaSsxXSA9PSBcIjFcIikgdHlwZXNbaV0gPSBcIjFcIjtcbiAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBcIixcIiAmJiBwcmV2ID09IHR5cGVzW2krMV0gJiZcbiAgICAgICAgICAgICAgICAgKHByZXYgPT0gXCIxXCIgfHwgcHJldiA9PSBcIm5cIikpIHR5cGVzW2ldID0gcHJldjtcbiAgICAgICAgcHJldiA9IHR5cGU7XG4gICAgICB9XG5cbiAgICAgIC8vIFc1LiBBIHNlcXVlbmNlIG9mIEV1cm9wZWFuIHRlcm1pbmF0b3JzIGFkamFjZW50IHRvIEV1cm9wZWFuXG4gICAgICAvLyBudW1iZXJzIGNoYW5nZXMgdG8gYWxsIEV1cm9wZWFuIG51bWJlcnMuXG4gICAgICAvLyBXNi4gT3RoZXJ3aXNlLCBzZXBhcmF0b3JzIGFuZCB0ZXJtaW5hdG9ycyBjaGFuZ2UgdG8gT3RoZXJcbiAgICAgIC8vIE5ldXRyYWwuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciB0eXBlID0gdHlwZXNbaV07XG4gICAgICAgIGlmICh0eXBlID09IFwiLFwiKSB0eXBlc1tpXSA9IFwiTlwiO1xuICAgICAgICBlbHNlIGlmICh0eXBlID09IFwiJVwiKSB7XG4gICAgICAgICAgZm9yICh2YXIgZW5kID0gaSArIDE7IGVuZCA8IGxlbiAmJiB0eXBlc1tlbmRdID09IFwiJVwiOyArK2VuZCkge31cbiAgICAgICAgICB2YXIgcmVwbGFjZSA9IChpICYmIHR5cGVzW2ktMV0gPT0gXCIhXCIpIHx8IChlbmQgPCBsZW4gJiYgdHlwZXNbZW5kXSA9PSBcIjFcIikgPyBcIjFcIiA6IFwiTlwiO1xuICAgICAgICAgIGZvciAodmFyIGogPSBpOyBqIDwgZW5kOyArK2opIHR5cGVzW2pdID0gcmVwbGFjZTtcbiAgICAgICAgICBpID0gZW5kIC0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXNy4gU2VhcmNoIGJhY2t3YXJkcyBmcm9tIGVhY2ggaW5zdGFuY2Ugb2YgYSBFdXJvcGVhbiBudW1iZXJcbiAgICAgIC8vIHVudGlsIHRoZSBmaXJzdCBzdHJvbmcgdHlwZSAoUiwgTCwgb3Igc29yKSBpcyBmb3VuZC4gSWYgYW4gTCBpc1xuICAgICAgLy8gZm91bmQsIHRoZW4gY2hhbmdlIHRoZSB0eXBlIG9mIHRoZSBFdXJvcGVhbiBudW1iZXIgdG8gTC5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBjdXIgPSBvdXRlclR5cGU7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgdHlwZSA9IHR5cGVzW2ldO1xuICAgICAgICBpZiAoY3VyID09IFwiTFwiICYmIHR5cGUgPT0gXCIxXCIpIHR5cGVzW2ldID0gXCJMXCI7XG4gICAgICAgIGVsc2UgaWYgKGlzU3Ryb25nLnRlc3QodHlwZSkpIGN1ciA9IHR5cGU7XG4gICAgICB9XG5cbiAgICAgIC8vIE4xLiBBIHNlcXVlbmNlIG9mIG5ldXRyYWxzIHRha2VzIHRoZSBkaXJlY3Rpb24gb2YgdGhlXG4gICAgICAvLyBzdXJyb3VuZGluZyBzdHJvbmcgdGV4dCBpZiB0aGUgdGV4dCBvbiBib3RoIHNpZGVzIGhhcyB0aGUgc2FtZVxuICAgICAgLy8gZGlyZWN0aW9uLiBFdXJvcGVhbiBhbmQgQXJhYmljIG51bWJlcnMgYWN0IGFzIGlmIHRoZXkgd2VyZSBSIGluXG4gICAgICAvLyB0ZXJtcyBvZiB0aGVpciBpbmZsdWVuY2Ugb24gbmV1dHJhbHMuIFN0YXJ0LW9mLWxldmVsLXJ1biAoc29yKVxuICAgICAgLy8gYW5kIGVuZC1vZi1sZXZlbC1ydW4gKGVvcikgYXJlIHVzZWQgYXQgbGV2ZWwgcnVuIGJvdW5kYXJpZXMuXG4gICAgICAvLyBOMi4gQW55IHJlbWFpbmluZyBuZXV0cmFscyB0YWtlIHRoZSBlbWJlZGRpbmcgZGlyZWN0aW9uLlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAoaXNOZXV0cmFsLnRlc3QodHlwZXNbaV0pKSB7XG4gICAgICAgICAgZm9yICh2YXIgZW5kID0gaSArIDE7IGVuZCA8IGxlbiAmJiBpc05ldXRyYWwudGVzdCh0eXBlc1tlbmRdKTsgKytlbmQpIHt9XG4gICAgICAgICAgdmFyIGJlZm9yZSA9IChpID8gdHlwZXNbaS0xXSA6IG91dGVyVHlwZSkgPT0gXCJMXCI7XG4gICAgICAgICAgdmFyIGFmdGVyID0gKGVuZCA8IGxlbiA/IHR5cGVzW2VuZF0gOiBvdXRlclR5cGUpID09IFwiTFwiO1xuICAgICAgICAgIHZhciByZXBsYWNlID0gYmVmb3JlIHx8IGFmdGVyID8gXCJMXCIgOiBcIlJcIjtcbiAgICAgICAgICBmb3IgKHZhciBqID0gaTsgaiA8IGVuZDsgKytqKSB0eXBlc1tqXSA9IHJlcGxhY2U7XG4gICAgICAgICAgaSA9IGVuZCAtIDE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSGVyZSB3ZSBkZXBhcnQgZnJvbSB0aGUgZG9jdW1lbnRlZCBhbGdvcml0aG0sIGluIG9yZGVyIHRvIGF2b2lkXG4gICAgICAvLyBidWlsZGluZyB1cCBhbiBhY3R1YWwgbGV2ZWxzIGFycmF5LiBTaW5jZSB0aGVyZSBhcmUgb25seSB0aHJlZVxuICAgICAgLy8gbGV2ZWxzICgwLCAxLCAyKSBpbiBhbiBpbXBsZW1lbnRhdGlvbiB0aGF0IGRvZXNuJ3QgdGFrZVxuICAgICAgLy8gZXhwbGljaXQgZW1iZWRkaW5nIGludG8gYWNjb3VudCwgd2UgY2FuIGJ1aWxkIHVwIHRoZSBvcmRlciBvblxuICAgICAgLy8gdGhlIGZseSwgd2l0aG91dCBmb2xsb3dpbmcgdGhlIGxldmVsLWJhc2VkIGFsZ29yaXRobS5cbiAgICAgIHZhciBvcmRlciA9IFtdLCBtO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47KSB7XG4gICAgICAgIGlmIChjb3VudHNBc0xlZnQudGVzdCh0eXBlc1tpXSkpIHtcbiAgICAgICAgICB2YXIgc3RhcnQgPSBpO1xuICAgICAgICAgIGZvciAoKytpOyBpIDwgbGVuICYmIGNvdW50c0FzTGVmdC50ZXN0KHR5cGVzW2ldKTsgKytpKSB7fVxuICAgICAgICAgIG9yZGVyLnB1c2gobmV3IEJpZGlTcGFuKDAsIHN0YXJ0LCBpKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIHBvcyA9IGksIGF0ID0gb3JkZXIubGVuZ3RoO1xuICAgICAgICAgIGZvciAoKytpOyBpIDwgbGVuICYmIHR5cGVzW2ldICE9IFwiTFwiOyArK2kpIHt9XG4gICAgICAgICAgZm9yICh2YXIgaiA9IHBvczsgaiA8IGk7KSB7XG4gICAgICAgICAgICBpZiAoY291bnRzQXNOdW0udGVzdCh0eXBlc1tqXSkpIHtcbiAgICAgICAgICAgICAgaWYgKHBvcyA8IGopIG9yZGVyLnNwbGljZShhdCwgMCwgbmV3IEJpZGlTcGFuKDEsIHBvcywgaikpO1xuICAgICAgICAgICAgICB2YXIgbnN0YXJ0ID0gajtcbiAgICAgICAgICAgICAgZm9yICgrK2o7IGogPCBpICYmIGNvdW50c0FzTnVtLnRlc3QodHlwZXNbal0pOyArK2opIHt9XG4gICAgICAgICAgICAgIG9yZGVyLnNwbGljZShhdCwgMCwgbmV3IEJpZGlTcGFuKDIsIG5zdGFydCwgaikpO1xuICAgICAgICAgICAgICBwb3MgPSBqO1xuICAgICAgICAgICAgfSBlbHNlICsrajtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHBvcyA8IGkpIG9yZGVyLnNwbGljZShhdCwgMCwgbmV3IEJpZGlTcGFuKDEsIHBvcywgaSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAob3JkZXJbMF0ubGV2ZWwgPT0gMSAmJiAobSA9IHN0ci5tYXRjaCgvXlxccysvKSkpIHtcbiAgICAgICAgb3JkZXJbMF0uZnJvbSA9IG1bMF0ubGVuZ3RoO1xuICAgICAgICBvcmRlci51bnNoaWZ0KG5ldyBCaWRpU3BhbigwLCAwLCBtWzBdLmxlbmd0aCkpO1xuICAgICAgfVxuICAgICAgaWYgKGxzdChvcmRlcikubGV2ZWwgPT0gMSAmJiAobSA9IHN0ci5tYXRjaCgvXFxzKyQvKSkpIHtcbiAgICAgICAgbHN0KG9yZGVyKS50byAtPSBtWzBdLmxlbmd0aDtcbiAgICAgICAgb3JkZXIucHVzaChuZXcgQmlkaVNwYW4oMCwgbGVuIC0gbVswXS5sZW5ndGgsIGxlbikpO1xuICAgICAgfVxuICAgICAgaWYgKG9yZGVyWzBdLmxldmVsID09IDIpXG4gICAgICAgIG9yZGVyLnVuc2hpZnQobmV3IEJpZGlTcGFuKDEsIG9yZGVyWzBdLnRvLCBvcmRlclswXS50bykpO1xuICAgICAgaWYgKG9yZGVyWzBdLmxldmVsICE9IGxzdChvcmRlcikubGV2ZWwpXG4gICAgICAgIG9yZGVyLnB1c2gobmV3IEJpZGlTcGFuKG9yZGVyWzBdLmxldmVsLCBsZW4sIGxlbikpO1xuXG4gICAgICByZXR1cm4gb3JkZXI7XG4gICAgfTtcbiAgfSkoKTtcblxuICAvLyBUSEUgRU5EXG5cbiAgQ29kZU1pcnJvci52ZXJzaW9uID0gXCI1LjguMFwiO1xuXG4gIHJldHVybiBDb2RlTWlycm9yO1xufSk7XG4iLCIvLyBDb2RlTWlycm9yLCBjb3B5cmlnaHQgKGMpIGJ5IE1hcmlqbiBIYXZlcmJla2UgYW5kIG90aGVyc1xuLy8gRGlzdHJpYnV0ZWQgdW5kZXIgYW4gTUlUIGxpY2Vuc2U6IGh0dHA6Ly9jb2RlbWlycm9yLm5ldC9MSUNFTlNFXG5cbihmdW5jdGlvbihtb2QpIHtcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PSBcIm9iamVjdFwiKSAvLyBDb21tb25KU1xuICAgIG1vZChyZXF1aXJlKFwiLi4vLi4vbGliL2NvZGVtaXJyb3JcIikpO1xuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSAvLyBBTURcbiAgICBkZWZpbmUoW1wiLi4vLi4vbGliL2NvZGVtaXJyb3JcIl0sIG1vZCk7XG4gIGVsc2UgLy8gUGxhaW4gYnJvd3NlciBlbnZcbiAgICBtb2QoQ29kZU1pcnJvcik7XG59KShmdW5jdGlvbihDb2RlTWlycm9yKSB7XG5cInVzZSBzdHJpY3RcIjtcblxuQ29kZU1pcnJvci5kZWZpbmVNb2RlKFwiY2xpa2VcIiwgZnVuY3Rpb24oY29uZmlnLCBwYXJzZXJDb25maWcpIHtcbiAgdmFyIGluZGVudFVuaXQgPSBjb25maWcuaW5kZW50VW5pdCxcbiAgICAgIHN0YXRlbWVudEluZGVudFVuaXQgPSBwYXJzZXJDb25maWcuc3RhdGVtZW50SW5kZW50VW5pdCB8fCBpbmRlbnRVbml0LFxuICAgICAgZG9udEFsaWduQ2FsbHMgPSBwYXJzZXJDb25maWcuZG9udEFsaWduQ2FsbHMsXG4gICAgICBrZXl3b3JkcyA9IHBhcnNlckNvbmZpZy5rZXl3b3JkcyB8fCB7fSxcbiAgICAgIHR5cGVzID0gcGFyc2VyQ29uZmlnLnR5cGVzIHx8IHt9LFxuICAgICAgYnVpbHRpbiA9IHBhcnNlckNvbmZpZy5idWlsdGluIHx8IHt9LFxuICAgICAgYmxvY2tLZXl3b3JkcyA9IHBhcnNlckNvbmZpZy5ibG9ja0tleXdvcmRzIHx8IHt9LFxuICAgICAgZGVmS2V5d29yZHMgPSBwYXJzZXJDb25maWcuZGVmS2V5d29yZHMgfHwge30sXG4gICAgICBhdG9tcyA9IHBhcnNlckNvbmZpZy5hdG9tcyB8fCB7fSxcbiAgICAgIGhvb2tzID0gcGFyc2VyQ29uZmlnLmhvb2tzIHx8IHt9LFxuICAgICAgbXVsdGlMaW5lU3RyaW5ncyA9IHBhcnNlckNvbmZpZy5tdWx0aUxpbmVTdHJpbmdzLFxuICAgICAgaW5kZW50U3RhdGVtZW50cyA9IHBhcnNlckNvbmZpZy5pbmRlbnRTdGF0ZW1lbnRzICE9PSBmYWxzZSxcbiAgICAgIGluZGVudFN3aXRjaCA9IHBhcnNlckNvbmZpZy5pbmRlbnRTd2l0Y2ggIT09IGZhbHNlLFxuICAgICAgbmFtZXNwYWNlU2VwYXJhdG9yID0gcGFyc2VyQ29uZmlnLm5hbWVzcGFjZVNlcGFyYXRvcixcbiAgICAgIGlzUHVuY3R1YXRpb25DaGFyID0gcGFyc2VyQ29uZmlnLmlzUHVuY3R1YXRpb25DaGFyIHx8IC9bXFxbXFxde31cXChcXCksO1xcOlxcLl0vLFxuICAgICAgaXNOdW1iZXJDaGFyID0gcGFyc2VyQ29uZmlnLmlzTnVtYmVyQ2hhciB8fCAvXFxkLyxcbiAgICAgIGlzT3BlcmF0b3JDaGFyID0gcGFyc2VyQ29uZmlnLmlzT3BlcmF0b3JDaGFyIHx8IC9bK1xcLSomJT08PiE/fFxcL10vLFxuICAgICAgZW5kU3RhdGVtZW50ID0gcGFyc2VyQ29uZmlnLmVuZFN0YXRlbWVudCB8fCAvXls7OixdJC87XG5cbiAgdmFyIGN1clB1bmMsIGlzRGVmS2V5d29yZDtcblxuICBmdW5jdGlvbiB0b2tlbkJhc2Uoc3RyZWFtLCBzdGF0ZSkge1xuICAgIHZhciBjaCA9IHN0cmVhbS5uZXh0KCk7XG4gICAgaWYgKGhvb2tzW2NoXSkge1xuICAgICAgdmFyIHJlc3VsdCA9IGhvb2tzW2NoXShzdHJlYW0sIHN0YXRlKTtcbiAgICAgIGlmIChyZXN1bHQgIT09IGZhbHNlKSByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBpZiAoY2ggPT0gJ1wiJyB8fCBjaCA9PSBcIidcIikge1xuICAgICAgc3RhdGUudG9rZW5pemUgPSB0b2tlblN0cmluZyhjaCk7XG4gICAgICByZXR1cm4gc3RhdGUudG9rZW5pemUoc3RyZWFtLCBzdGF0ZSk7XG4gICAgfVxuICAgIGlmIChpc1B1bmN0dWF0aW9uQ2hhci50ZXN0KGNoKSkge1xuICAgICAgY3VyUHVuYyA9IGNoO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChpc051bWJlckNoYXIudGVzdChjaCkpIHtcbiAgICAgIHN0cmVhbS5lYXRXaGlsZSgvW1xcd1xcLl0vKTtcbiAgICAgIHJldHVybiBcIm51bWJlclwiO1xuICAgIH1cbiAgICBpZiAoY2ggPT0gXCIvXCIpIHtcbiAgICAgIGlmIChzdHJlYW0uZWF0KFwiKlwiKSkge1xuICAgICAgICBzdGF0ZS50b2tlbml6ZSA9IHRva2VuQ29tbWVudDtcbiAgICAgICAgcmV0dXJuIHRva2VuQ29tbWVudChzdHJlYW0sIHN0YXRlKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdHJlYW0uZWF0KFwiL1wiKSkge1xuICAgICAgICBzdHJlYW0uc2tpcFRvRW5kKCk7XG4gICAgICAgIHJldHVybiBcImNvbW1lbnRcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzT3BlcmF0b3JDaGFyLnRlc3QoY2gpKSB7XG4gICAgICBzdHJlYW0uZWF0V2hpbGUoaXNPcGVyYXRvckNoYXIpO1xuICAgICAgcmV0dXJuIFwib3BlcmF0b3JcIjtcbiAgICB9XG4gICAgc3RyZWFtLmVhdFdoaWxlKC9bXFx3XFwkX1xceGExLVxcdWZmZmZdLyk7XG4gICAgaWYgKG5hbWVzcGFjZVNlcGFyYXRvcikgd2hpbGUgKHN0cmVhbS5tYXRjaChuYW1lc3BhY2VTZXBhcmF0b3IpKVxuICAgICAgc3RyZWFtLmVhdFdoaWxlKC9bXFx3XFwkX1xceGExLVxcdWZmZmZdLyk7XG5cbiAgICB2YXIgY3VyID0gc3RyZWFtLmN1cnJlbnQoKTtcbiAgICBpZiAoY29udGFpbnMoa2V5d29yZHMsIGN1cikpIHtcbiAgICAgIGlmIChjb250YWlucyhibG9ja0tleXdvcmRzLCBjdXIpKSBjdXJQdW5jID0gXCJuZXdzdGF0ZW1lbnRcIjtcbiAgICAgIGlmIChjb250YWlucyhkZWZLZXl3b3JkcywgY3VyKSkgaXNEZWZLZXl3b3JkID0gdHJ1ZTtcbiAgICAgIHJldHVybiBcImtleXdvcmRcIjtcbiAgICB9XG4gICAgaWYgKGNvbnRhaW5zKHR5cGVzLCBjdXIpKSByZXR1cm4gXCJ2YXJpYWJsZS0zXCI7XG4gICAgaWYgKGNvbnRhaW5zKGJ1aWx0aW4sIGN1cikpIHtcbiAgICAgIGlmIChjb250YWlucyhibG9ja0tleXdvcmRzLCBjdXIpKSBjdXJQdW5jID0gXCJuZXdzdGF0ZW1lbnRcIjtcbiAgICAgIHJldHVybiBcImJ1aWx0aW5cIjtcbiAgICB9XG4gICAgaWYgKGNvbnRhaW5zKGF0b21zLCBjdXIpKSByZXR1cm4gXCJhdG9tXCI7XG4gICAgcmV0dXJuIFwidmFyaWFibGVcIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHRva2VuU3RyaW5nKHF1b3RlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmVhbSwgc3RhdGUpIHtcbiAgICAgIHZhciBlc2NhcGVkID0gZmFsc2UsIG5leHQsIGVuZCA9IGZhbHNlO1xuICAgICAgd2hpbGUgKChuZXh0ID0gc3RyZWFtLm5leHQoKSkgIT0gbnVsbCkge1xuICAgICAgICBpZiAobmV4dCA9PSBxdW90ZSAmJiAhZXNjYXBlZCkge2VuZCA9IHRydWU7IGJyZWFrO31cbiAgICAgICAgZXNjYXBlZCA9ICFlc2NhcGVkICYmIG5leHQgPT0gXCJcXFxcXCI7XG4gICAgICB9XG4gICAgICBpZiAoZW5kIHx8ICEoZXNjYXBlZCB8fCBtdWx0aUxpbmVTdHJpbmdzKSlcbiAgICAgICAgc3RhdGUudG9rZW5pemUgPSBudWxsO1xuICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHRva2VuQ29tbWVudChzdHJlYW0sIHN0YXRlKSB7XG4gICAgdmFyIG1heWJlRW5kID0gZmFsc2UsIGNoO1xuICAgIHdoaWxlIChjaCA9IHN0cmVhbS5uZXh0KCkpIHtcbiAgICAgIGlmIChjaCA9PSBcIi9cIiAmJiBtYXliZUVuZCkge1xuICAgICAgICBzdGF0ZS50b2tlbml6ZSA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgbWF5YmVFbmQgPSAoY2ggPT0gXCIqXCIpO1xuICAgIH1cbiAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KGluZGVudGVkLCBjb2x1bW4sIHR5cGUsIGFsaWduLCBwcmV2KSB7XG4gICAgdGhpcy5pbmRlbnRlZCA9IGluZGVudGVkO1xuICAgIHRoaXMuY29sdW1uID0gY29sdW1uO1xuICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgdGhpcy5hbGlnbiA9IGFsaWduO1xuICAgIHRoaXMucHJldiA9IHByZXY7XG4gIH1cbiAgZnVuY3Rpb24gaXNTdGF0ZW1lbnQodHlwZSkge1xuICAgIHJldHVybiB0eXBlID09IFwic3RhdGVtZW50XCIgfHwgdHlwZSA9PSBcInN3aXRjaHN0YXRlbWVudFwiIHx8IHR5cGUgPT0gXCJuYW1lc3BhY2VcIjtcbiAgfVxuICBmdW5jdGlvbiBwdXNoQ29udGV4dChzdGF0ZSwgY29sLCB0eXBlKSB7XG4gICAgdmFyIGluZGVudCA9IHN0YXRlLmluZGVudGVkO1xuICAgIGlmIChzdGF0ZS5jb250ZXh0ICYmIGlzU3RhdGVtZW50KHN0YXRlLmNvbnRleHQudHlwZSkgJiYgIWlzU3RhdGVtZW50KHR5cGUpKVxuICAgICAgaW5kZW50ID0gc3RhdGUuY29udGV4dC5pbmRlbnRlZDtcbiAgICByZXR1cm4gc3RhdGUuY29udGV4dCA9IG5ldyBDb250ZXh0KGluZGVudCwgY29sLCB0eXBlLCBudWxsLCBzdGF0ZS5jb250ZXh0KTtcbiAgfVxuICBmdW5jdGlvbiBwb3BDb250ZXh0KHN0YXRlKSB7XG4gICAgdmFyIHQgPSBzdGF0ZS5jb250ZXh0LnR5cGU7XG4gICAgaWYgKHQgPT0gXCIpXCIgfHwgdCA9PSBcIl1cIiB8fCB0ID09IFwifVwiKVxuICAgICAgc3RhdGUuaW5kZW50ZWQgPSBzdGF0ZS5jb250ZXh0LmluZGVudGVkO1xuICAgIHJldHVybiBzdGF0ZS5jb250ZXh0ID0gc3RhdGUuY29udGV4dC5wcmV2O1xuICB9XG5cbiAgZnVuY3Rpb24gdHlwZUJlZm9yZShzdHJlYW0sIHN0YXRlKSB7XG4gICAgaWYgKHN0YXRlLnByZXZUb2tlbiA9PSBcInZhcmlhYmxlXCIgfHwgc3RhdGUucHJldlRva2VuID09IFwidmFyaWFibGUtM1wiKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoL1xcUyg/OlteLSBdPnxbKlxcXV0pXFxzKiR8XFwqJC8udGVzdChzdHJlYW0uc3RyaW5nLnNsaWNlKDAsIHN0cmVhbS5zdGFydCkpKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVG9wU2NvcGUoY29udGV4dCkge1xuICAgIGZvciAoOzspIHtcbiAgICAgIGlmICghY29udGV4dCB8fCBjb250ZXh0LnR5cGUgPT0gXCJ0b3BcIikgcmV0dXJuIHRydWU7XG4gICAgICBpZiAoY29udGV4dC50eXBlID09IFwifVwiICYmIGNvbnRleHQucHJldi50eXBlICE9IFwibmFtZXNwYWNlXCIpIHJldHVybiBmYWxzZTtcbiAgICAgIGNvbnRleHQgPSBjb250ZXh0LnByZXY7XG4gICAgfVxuICB9XG5cbiAgLy8gSW50ZXJmYWNlXG5cbiAgcmV0dXJuIHtcbiAgICBzdGFydFN0YXRlOiBmdW5jdGlvbihiYXNlY29sdW1uKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b2tlbml6ZTogbnVsbCxcbiAgICAgICAgY29udGV4dDogbmV3IENvbnRleHQoKGJhc2Vjb2x1bW4gfHwgMCkgLSBpbmRlbnRVbml0LCAwLCBcInRvcFwiLCBmYWxzZSksXG4gICAgICAgIGluZGVudGVkOiAwLFxuICAgICAgICBzdGFydE9mTGluZTogdHJ1ZSxcbiAgICAgICAgcHJldlRva2VuOiBudWxsXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICB0b2tlbjogZnVuY3Rpb24oc3RyZWFtLCBzdGF0ZSkge1xuICAgICAgdmFyIGN0eCA9IHN0YXRlLmNvbnRleHQ7XG4gICAgICBpZiAoc3RyZWFtLnNvbCgpKSB7XG4gICAgICAgIGlmIChjdHguYWxpZ24gPT0gbnVsbCkgY3R4LmFsaWduID0gZmFsc2U7XG4gICAgICAgIHN0YXRlLmluZGVudGVkID0gc3RyZWFtLmluZGVudGF0aW9uKCk7XG4gICAgICAgIHN0YXRlLnN0YXJ0T2ZMaW5lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChzdHJlYW0uZWF0U3BhY2UoKSkgcmV0dXJuIG51bGw7XG4gICAgICBjdXJQdW5jID0gaXNEZWZLZXl3b3JkID0gbnVsbDtcbiAgICAgIHZhciBzdHlsZSA9IChzdGF0ZS50b2tlbml6ZSB8fCB0b2tlbkJhc2UpKHN0cmVhbSwgc3RhdGUpO1xuICAgICAgaWYgKHN0eWxlID09IFwiY29tbWVudFwiIHx8IHN0eWxlID09IFwibWV0YVwiKSByZXR1cm4gc3R5bGU7XG4gICAgICBpZiAoY3R4LmFsaWduID09IG51bGwpIGN0eC5hbGlnbiA9IHRydWU7XG5cbiAgICAgIGlmIChlbmRTdGF0ZW1lbnQudGVzdChjdXJQdW5jKSkgd2hpbGUgKGlzU3RhdGVtZW50KHN0YXRlLmNvbnRleHQudHlwZSkpIHBvcENvbnRleHQoc3RhdGUpO1xuICAgICAgZWxzZSBpZiAoY3VyUHVuYyA9PSBcIntcIikgcHVzaENvbnRleHQoc3RhdGUsIHN0cmVhbS5jb2x1bW4oKSwgXCJ9XCIpO1xuICAgICAgZWxzZSBpZiAoY3VyUHVuYyA9PSBcIltcIikgcHVzaENvbnRleHQoc3RhdGUsIHN0cmVhbS5jb2x1bW4oKSwgXCJdXCIpO1xuICAgICAgZWxzZSBpZiAoY3VyUHVuYyA9PSBcIihcIikgcHVzaENvbnRleHQoc3RhdGUsIHN0cmVhbS5jb2x1bW4oKSwgXCIpXCIpO1xuICAgICAgZWxzZSBpZiAoY3VyUHVuYyA9PSBcIn1cIikge1xuICAgICAgICB3aGlsZSAoaXNTdGF0ZW1lbnQoY3R4LnR5cGUpKSBjdHggPSBwb3BDb250ZXh0KHN0YXRlKTtcbiAgICAgICAgaWYgKGN0eC50eXBlID09IFwifVwiKSBjdHggPSBwb3BDb250ZXh0KHN0YXRlKTtcbiAgICAgICAgd2hpbGUgKGlzU3RhdGVtZW50KGN0eC50eXBlKSkgY3R4ID0gcG9wQ29udGV4dChzdGF0ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChjdXJQdW5jID09IGN0eC50eXBlKSBwb3BDb250ZXh0KHN0YXRlKTtcbiAgICAgIGVsc2UgaWYgKGluZGVudFN0YXRlbWVudHMgJiZcbiAgICAgICAgICAgICAgICgoKGN0eC50eXBlID09IFwifVwiIHx8IGN0eC50eXBlID09IFwidG9wXCIpICYmIGN1clB1bmMgIT0gXCI7XCIpIHx8XG4gICAgICAgICAgICAgICAgKGlzU3RhdGVtZW50KGN0eC50eXBlKSAmJiBjdXJQdW5jID09IFwibmV3c3RhdGVtZW50XCIpKSkge1xuICAgICAgICB2YXIgdHlwZSA9IFwic3RhdGVtZW50XCI7XG4gICAgICAgIGlmIChjdXJQdW5jID09IFwibmV3c3RhdGVtZW50XCIgJiYgaW5kZW50U3dpdGNoICYmIHN0cmVhbS5jdXJyZW50KCkgPT0gXCJzd2l0Y2hcIilcbiAgICAgICAgICB0eXBlID0gXCJzd2l0Y2hzdGF0ZW1lbnRcIjtcbiAgICAgICAgZWxzZSBpZiAoc3R5bGUgPT0gXCJrZXl3b3JkXCIgJiYgc3RyZWFtLmN1cnJlbnQoKSA9PSBcIm5hbWVzcGFjZVwiKVxuICAgICAgICAgIHR5cGUgPSBcIm5hbWVzcGFjZVwiO1xuICAgICAgICBwdXNoQ29udGV4dChzdGF0ZSwgc3RyZWFtLmNvbHVtbigpLCB0eXBlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0eWxlID09IFwidmFyaWFibGVcIiAmJlxuICAgICAgICAgICgoc3RhdGUucHJldlRva2VuID09IFwiZGVmXCIgfHxcbiAgICAgICAgICAgIChwYXJzZXJDb25maWcudHlwZUZpcnN0RGVmaW5pdGlvbnMgJiYgdHlwZUJlZm9yZShzdHJlYW0sIHN0YXRlKSAmJlxuICAgICAgICAgICAgIGlzVG9wU2NvcGUoc3RhdGUuY29udGV4dCkgJiYgc3RyZWFtLm1hdGNoKC9eXFxzKlxcKC8sIGZhbHNlKSkpKSlcbiAgICAgICAgc3R5bGUgPSBcImRlZlwiO1xuXG4gICAgICBpZiAoaG9va3MudG9rZW4pIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGhvb2tzLnRva2VuKHN0cmVhbSwgc3RhdGUsIHN0eWxlKTtcbiAgICAgICAgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKSBzdHlsZSA9IHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgaWYgKHN0eWxlID09IFwiZGVmXCIgJiYgcGFyc2VyQ29uZmlnLnN0eWxlRGVmcyA9PT0gZmFsc2UpIHN0eWxlID0gXCJ2YXJpYWJsZVwiO1xuXG4gICAgICBzdGF0ZS5zdGFydE9mTGluZSA9IGZhbHNlO1xuICAgICAgc3RhdGUucHJldlRva2VuID0gaXNEZWZLZXl3b3JkID8gXCJkZWZcIiA6IHN0eWxlIHx8IGN1clB1bmM7XG4gICAgICByZXR1cm4gc3R5bGU7XG4gICAgfSxcblxuICAgIGluZGVudDogZnVuY3Rpb24oc3RhdGUsIHRleHRBZnRlcikge1xuICAgICAgaWYgKHN0YXRlLnRva2VuaXplICE9IHRva2VuQmFzZSAmJiBzdGF0ZS50b2tlbml6ZSAhPSBudWxsKSByZXR1cm4gQ29kZU1pcnJvci5QYXNzO1xuICAgICAgdmFyIGN0eCA9IHN0YXRlLmNvbnRleHQsIGZpcnN0Q2hhciA9IHRleHRBZnRlciAmJiB0ZXh0QWZ0ZXIuY2hhckF0KDApO1xuICAgICAgaWYgKGlzU3RhdGVtZW50KGN0eC50eXBlKSAmJiBmaXJzdENoYXIgPT0gXCJ9XCIpIGN0eCA9IGN0eC5wcmV2O1xuICAgICAgaWYgKGhvb2tzLmluZGVudCkge1xuICAgICAgICB2YXIgaG9vayA9IGhvb2tzLmluZGVudChzdGF0ZSwgY3R4LCB0ZXh0QWZ0ZXIpO1xuICAgICAgICBpZiAodHlwZW9mIGhvb2sgPT0gXCJudW1iZXJcIikgcmV0dXJuIGhvb2tcbiAgICAgIH1cbiAgICAgIHZhciBjbG9zaW5nID0gZmlyc3RDaGFyID09IGN0eC50eXBlO1xuICAgICAgdmFyIHN3aXRjaEJsb2NrID0gY3R4LnByZXYgJiYgY3R4LnByZXYudHlwZSA9PSBcInN3aXRjaHN0YXRlbWVudFwiO1xuICAgICAgaWYgKGlzU3RhdGVtZW50KGN0eC50eXBlKSlcbiAgICAgICAgcmV0dXJuIGN0eC5pbmRlbnRlZCArIChmaXJzdENoYXIgPT0gXCJ7XCIgPyAwIDogc3RhdGVtZW50SW5kZW50VW5pdCk7XG4gICAgICBpZiAoY3R4LmFsaWduICYmICghZG9udEFsaWduQ2FsbHMgfHwgY3R4LnR5cGUgIT0gXCIpXCIpKVxuICAgICAgICByZXR1cm4gY3R4LmNvbHVtbiArIChjbG9zaW5nID8gMCA6IDEpO1xuICAgICAgaWYgKGN0eC50eXBlID09IFwiKVwiICYmICFjbG9zaW5nKVxuICAgICAgICByZXR1cm4gY3R4LmluZGVudGVkICsgc3RhdGVtZW50SW5kZW50VW5pdDtcblxuICAgICAgcmV0dXJuIGN0eC5pbmRlbnRlZCArIChjbG9zaW5nID8gMCA6IGluZGVudFVuaXQpICtcbiAgICAgICAgKCFjbG9zaW5nICYmIHN3aXRjaEJsb2NrICYmICEvXig/OmNhc2V8ZGVmYXVsdClcXGIvLnRlc3QodGV4dEFmdGVyKSA/IGluZGVudFVuaXQgOiAwKTtcbiAgICB9LFxuXG4gICAgZWxlY3RyaWNJbnB1dDogaW5kZW50U3dpdGNoID8gL15cXHMqKD86Y2FzZSAuKj86fGRlZmF1bHQ6fFxce1xcfT98XFx9KSQvIDogL15cXHMqW3t9XSQvLFxuICAgIGJsb2NrQ29tbWVudFN0YXJ0OiBcIi8qXCIsXG4gICAgYmxvY2tDb21tZW50RW5kOiBcIiovXCIsXG4gICAgbGluZUNvbW1lbnQ6IFwiLy9cIixcbiAgICBmb2xkOiBcImJyYWNlXCJcbiAgfTtcbn0pO1xuXG4gIGZ1bmN0aW9uIHdvcmRzKHN0cikge1xuICAgIHZhciBvYmogPSB7fSwgd29yZHMgPSBzdHIuc3BsaXQoXCIgXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyArK2kpIG9ialt3b3Jkc1tpXV0gPSB0cnVlO1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgZnVuY3Rpb24gY29udGFpbnMod29yZHMsIHdvcmQpIHtcbiAgICBpZiAodHlwZW9mIHdvcmRzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiB3b3Jkcyh3b3JkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHdvcmRzLnByb3BlcnR5SXNFbnVtZXJhYmxlKHdvcmQpO1xuICAgIH1cbiAgfVxuICB2YXIgY0tleXdvcmRzID0gXCJhdXRvIGlmIGJyZWFrIGNhc2UgcmVnaXN0ZXIgY29udGludWUgcmV0dXJuIGRlZmF1bHQgZG8gc2l6ZW9mIFwiICtcbiAgICBcInN0YXRpYyBlbHNlIHN0cnVjdCBzd2l0Y2ggZXh0ZXJuIHR5cGVkZWYgZmxvYXQgdW5pb24gZm9yIFwiICtcbiAgICBcImdvdG8gd2hpbGUgZW51bSBjb25zdCB2b2xhdGlsZVwiO1xuICB2YXIgY1R5cGVzID0gXCJpbnQgbG9uZyBjaGFyIHNob3J0IGRvdWJsZSBmbG9hdCB1bnNpZ25lZCBzaWduZWQgdm9pZCBzaXplX3QgcHRyZGlmZl90XCI7XG5cbiAgZnVuY3Rpb24gY3BwSG9vayhzdHJlYW0sIHN0YXRlKSB7XG4gICAgaWYgKCFzdGF0ZS5zdGFydE9mTGluZSkgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAoOzspIHtcbiAgICAgIGlmIChzdHJlYW0uc2tpcFRvKFwiXFxcXFwiKSkge1xuICAgICAgICBzdHJlYW0ubmV4dCgpO1xuICAgICAgICBpZiAoc3RyZWFtLmVvbCgpKSB7XG4gICAgICAgICAgc3RhdGUudG9rZW5pemUgPSBjcHBIb29rO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdHJlYW0uc2tpcFRvRW5kKCk7XG4gICAgICAgIHN0YXRlLnRva2VuaXplID0gbnVsbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBcIm1ldGFcIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBvaW50ZXJIb29rKF9zdHJlYW0sIHN0YXRlKSB7XG4gICAgaWYgKHN0YXRlLnByZXZUb2tlbiA9PSBcInZhcmlhYmxlLTNcIikgcmV0dXJuIFwidmFyaWFibGUtM1wiO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNwcDE0TGl0ZXJhbChzdHJlYW0pIHtcbiAgICBzdHJlYW0uZWF0V2hpbGUoL1tcXHdcXC4nXS8pO1xuICAgIHJldHVybiBcIm51bWJlclwiO1xuICB9XG5cbiAgZnVuY3Rpb24gY3BwMTFTdHJpbmdIb29rKHN0cmVhbSwgc3RhdGUpIHtcbiAgICBzdHJlYW0uYmFja1VwKDEpO1xuICAgIC8vIFJhdyBzdHJpbmdzLlxuICAgIGlmIChzdHJlYW0ubWF0Y2goLyhSfHU4Unx1UnxVUnxMUikvKSkge1xuICAgICAgdmFyIG1hdGNoID0gc3RyZWFtLm1hdGNoKC9cIihbXlxcc1xcXFwoKV17MCwxNn0pXFwoLyk7XG4gICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHN0YXRlLmNwcDExUmF3U3RyaW5nRGVsaW0gPSBtYXRjaFsxXTtcbiAgICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5SYXdTdHJpbmc7XG4gICAgICByZXR1cm4gdG9rZW5SYXdTdHJpbmcoc3RyZWFtLCBzdGF0ZSk7XG4gICAgfVxuICAgIC8vIFVuaWNvZGUgc3RyaW5ncy9jaGFycy5cbiAgICBpZiAoc3RyZWFtLm1hdGNoKC8odTh8dXxVfEwpLykpIHtcbiAgICAgIGlmIChzdHJlYW0ubWF0Y2goL1tcIiddLywgLyogZWF0ICovIGZhbHNlKSkge1xuICAgICAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gSWdub3JlIHRoaXMgaG9vay5cbiAgICBzdHJlYW0ubmV4dCgpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNwcExvb2tzTGlrZUNvbnN0cnVjdG9yKHdvcmQpIHtcbiAgICB2YXIgbGFzdFR3byA9IC8oXFx3Kyk6OihcXHcrKSQvLmV4ZWMod29yZCk7XG4gICAgcmV0dXJuIGxhc3RUd28gJiYgbGFzdFR3b1sxXSA9PSBsYXN0VHdvWzJdO1xuICB9XG5cbiAgLy8gQyMtc3R5bGUgc3RyaW5ncyB3aGVyZSBcIlwiIGVzY2FwZXMgYSBxdW90ZS5cbiAgZnVuY3Rpb24gdG9rZW5BdFN0cmluZyhzdHJlYW0sIHN0YXRlKSB7XG4gICAgdmFyIG5leHQ7XG4gICAgd2hpbGUgKChuZXh0ID0gc3RyZWFtLm5leHQoKSkgIT0gbnVsbCkge1xuICAgICAgaWYgKG5leHQgPT0gJ1wiJyAmJiAhc3RyZWFtLmVhdCgnXCInKSkge1xuICAgICAgICBzdGF0ZS50b2tlbml6ZSA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgfVxuXG4gIC8vIEMrKzExIHJhdyBzdHJpbmcgbGl0ZXJhbCBpcyA8cHJlZml4PlwiPGRlbGltPiggYW55dGhpbmcgKTxkZWxpbT5cIiwgd2hlcmVcbiAgLy8gPGRlbGltPiBjYW4gYmUgYSBzdHJpbmcgdXAgdG8gMTYgY2hhcmFjdGVycyBsb25nLlxuICBmdW5jdGlvbiB0b2tlblJhd1N0cmluZyhzdHJlYW0sIHN0YXRlKSB7XG4gICAgLy8gRXNjYXBlIGNoYXJhY3RlcnMgdGhhdCBoYXZlIHNwZWNpYWwgcmVnZXggbWVhbmluZ3MuXG4gICAgdmFyIGRlbGltID0gc3RhdGUuY3BwMTFSYXdTdHJpbmdEZWxpbS5yZXBsYWNlKC9bXlxcd1xcc10vZywgJ1xcXFwkJicpO1xuICAgIHZhciBtYXRjaCA9IHN0cmVhbS5tYXRjaChuZXcgUmVnRXhwKFwiLio/XFxcXClcIiArIGRlbGltICsgJ1wiJykpO1xuICAgIGlmIChtYXRjaClcbiAgICAgIHN0YXRlLnRva2VuaXplID0gbnVsbDtcbiAgICBlbHNlXG4gICAgICBzdHJlYW0uc2tpcFRvRW5kKCk7XG4gICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gIH1cblxuICBmdW5jdGlvbiBkZWYobWltZXMsIG1vZGUpIHtcbiAgICBpZiAodHlwZW9mIG1pbWVzID09IFwic3RyaW5nXCIpIG1pbWVzID0gW21pbWVzXTtcbiAgICB2YXIgd29yZHMgPSBbXTtcbiAgICBmdW5jdGlvbiBhZGQob2JqKSB7XG4gICAgICBpZiAob2JqKSBmb3IgKHZhciBwcm9wIGluIG9iaikgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSlcbiAgICAgICAgd29yZHMucHVzaChwcm9wKTtcbiAgICB9XG4gICAgYWRkKG1vZGUua2V5d29yZHMpO1xuICAgIGFkZChtb2RlLnR5cGVzKTtcbiAgICBhZGQobW9kZS5idWlsdGluKTtcbiAgICBhZGQobW9kZS5hdG9tcyk7XG4gICAgaWYgKHdvcmRzLmxlbmd0aCkge1xuICAgICAgbW9kZS5oZWxwZXJUeXBlID0gbWltZXNbMF07XG4gICAgICBDb2RlTWlycm9yLnJlZ2lzdGVySGVscGVyKFwiaGludFdvcmRzXCIsIG1pbWVzWzBdLCB3b3Jkcyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtaW1lcy5sZW5ndGg7ICsraSlcbiAgICAgIENvZGVNaXJyb3IuZGVmaW5lTUlNRShtaW1lc1tpXSwgbW9kZSk7XG4gIH1cblxuICBkZWYoW1widGV4dC94LWNzcmNcIiwgXCJ0ZXh0L3gtY1wiLCBcInRleHQveC1jaGRyXCJdLCB7XG4gICAgbmFtZTogXCJjbGlrZVwiLFxuICAgIGtleXdvcmRzOiB3b3JkcyhjS2V5d29yZHMpLFxuICAgIHR5cGVzOiB3b3JkcyhjVHlwZXMgKyBcIiBib29sIF9Db21wbGV4IF9Cb29sIGZsb2F0X3QgZG91YmxlX3QgaW50cHRyX3QgaW50bWF4X3QgXCIgK1xuICAgICAgICAgICAgICAgICBcImludDhfdCBpbnQxNl90IGludDMyX3QgaW50NjRfdCB1aW50cHRyX3QgdWludG1heF90IHVpbnQ4X3QgdWludDE2X3QgXCIgK1xuICAgICAgICAgICAgICAgICBcInVpbnQzMl90IHVpbnQ2NF90XCIpLFxuICAgIGJsb2NrS2V5d29yZHM6IHdvcmRzKFwiY2FzZSBkbyBlbHNlIGZvciBpZiBzd2l0Y2ggd2hpbGUgc3RydWN0XCIpLFxuICAgIGRlZktleXdvcmRzOiB3b3JkcyhcInN0cnVjdFwiKSxcbiAgICB0eXBlRmlyc3REZWZpbml0aW9uczogdHJ1ZSxcbiAgICBhdG9tczogd29yZHMoXCJudWxsIHRydWUgZmFsc2VcIiksXG4gICAgaG9va3M6IHtcIiNcIjogY3BwSG9vaywgXCIqXCI6IHBvaW50ZXJIb29rfSxcbiAgICBtb2RlUHJvcHM6IHtmb2xkOiBbXCJicmFjZVwiLCBcImluY2x1ZGVcIl19XG4gIH0pO1xuXG4gIGRlZihbXCJ0ZXh0L3gtYysrc3JjXCIsIFwidGV4dC94LWMrK2hkclwiXSwge1xuICAgIG5hbWU6IFwiY2xpa2VcIixcbiAgICBrZXl3b3Jkczogd29yZHMoY0tleXdvcmRzICsgXCIgYXNtIGR5bmFtaWNfY2FzdCBuYW1lc3BhY2UgcmVpbnRlcnByZXRfY2FzdCB0cnkgZXhwbGljaXQgbmV3IFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJzdGF0aWNfY2FzdCB0eXBlaWQgY2F0Y2ggb3BlcmF0b3IgdGVtcGxhdGUgdHlwZW5hbWUgY2xhc3MgZnJpZW5kIHByaXZhdGUgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInRoaXMgdXNpbmcgY29uc3RfY2FzdCBpbmxpbmUgcHVibGljIHRocm93IHZpcnR1YWwgZGVsZXRlIG11dGFibGUgcHJvdGVjdGVkIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJhbGlnbmFzIGFsaWdub2YgY29uc3RleHByIGRlY2x0eXBlIG51bGxwdHIgbm9leGNlcHQgdGhyZWFkX2xvY2FsIGZpbmFsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJzdGF0aWNfYXNzZXJ0IG92ZXJyaWRlXCIpLFxuICAgIHR5cGVzOiB3b3JkcyhjVHlwZXMgKyBcIiBib29sIHdjaGFyX3RcIiksXG4gICAgYmxvY2tLZXl3b3Jkczogd29yZHMoXCJjYXRjaCBjbGFzcyBkbyBlbHNlIGZpbmFsbHkgZm9yIGlmIHN0cnVjdCBzd2l0Y2ggdHJ5IHdoaWxlXCIpLFxuICAgIGRlZktleXdvcmRzOiB3b3JkcyhcImNsYXNzIG5hbWVzcGFjZSBzdHJ1Y3QgZW51bSB1bmlvblwiKSxcbiAgICB0eXBlRmlyc3REZWZpbml0aW9uczogdHJ1ZSxcbiAgICBhdG9tczogd29yZHMoXCJ0cnVlIGZhbHNlIG51bGxcIiksXG4gICAgaG9va3M6IHtcbiAgICAgIFwiI1wiOiBjcHBIb29rLFxuICAgICAgXCIqXCI6IHBvaW50ZXJIb29rLFxuICAgICAgXCJ1XCI6IGNwcDExU3RyaW5nSG9vayxcbiAgICAgIFwiVVwiOiBjcHAxMVN0cmluZ0hvb2ssXG4gICAgICBcIkxcIjogY3BwMTFTdHJpbmdIb29rLFxuICAgICAgXCJSXCI6IGNwcDExU3RyaW5nSG9vayxcbiAgICAgIFwiMFwiOiBjcHAxNExpdGVyYWwsXG4gICAgICBcIjFcIjogY3BwMTRMaXRlcmFsLFxuICAgICAgXCIyXCI6IGNwcDE0TGl0ZXJhbCxcbiAgICAgIFwiM1wiOiBjcHAxNExpdGVyYWwsXG4gICAgICBcIjRcIjogY3BwMTRMaXRlcmFsLFxuICAgICAgXCI1XCI6IGNwcDE0TGl0ZXJhbCxcbiAgICAgIFwiNlwiOiBjcHAxNExpdGVyYWwsXG4gICAgICBcIjdcIjogY3BwMTRMaXRlcmFsLFxuICAgICAgXCI4XCI6IGNwcDE0TGl0ZXJhbCxcbiAgICAgIFwiOVwiOiBjcHAxNExpdGVyYWwsXG4gICAgICB0b2tlbjogZnVuY3Rpb24oc3RyZWFtLCBzdGF0ZSwgc3R5bGUpIHtcbiAgICAgICAgaWYgKHN0eWxlID09IFwidmFyaWFibGVcIiAmJiBzdHJlYW0ucGVlaygpID09IFwiKFwiICYmXG4gICAgICAgICAgICAoc3RhdGUucHJldlRva2VuID09IFwiO1wiIHx8IHN0YXRlLnByZXZUb2tlbiA9PSBudWxsIHx8XG4gICAgICAgICAgICAgc3RhdGUucHJldlRva2VuID09IFwifVwiKSAmJlxuICAgICAgICAgICAgY3BwTG9va3NMaWtlQ29uc3RydWN0b3Ioc3RyZWFtLmN1cnJlbnQoKSkpXG4gICAgICAgICAgcmV0dXJuIFwiZGVmXCI7XG4gICAgICB9XG4gICAgfSxcbiAgICBuYW1lc3BhY2VTZXBhcmF0b3I6IFwiOjpcIixcbiAgICBtb2RlUHJvcHM6IHtmb2xkOiBbXCJicmFjZVwiLCBcImluY2x1ZGVcIl19XG4gIH0pO1xuXG4gIGRlZihcInRleHQveC1qYXZhXCIsIHtcbiAgICBuYW1lOiBcImNsaWtlXCIsXG4gICAga2V5d29yZHM6IHdvcmRzKFwiYWJzdHJhY3QgYXNzZXJ0IGJyZWFrIGNhc2UgY2F0Y2ggY2xhc3MgY29uc3QgY29udGludWUgZGVmYXVsdCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiZG8gZWxzZSBlbnVtIGV4dGVuZHMgZmluYWwgZmluYWxseSBmbG9hdCBmb3IgZ290byBpZiBpbXBsZW1lbnRzIGltcG9ydCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiaW5zdGFuY2VvZiBpbnRlcmZhY2UgbmF0aXZlIG5ldyBwYWNrYWdlIHByaXZhdGUgcHJvdGVjdGVkIHB1YmxpYyBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwicmV0dXJuIHN0YXRpYyBzdHJpY3RmcCBzdXBlciBzd2l0Y2ggc3luY2hyb25pemVkIHRoaXMgdGhyb3cgdGhyb3dzIHRyYW5zaWVudCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwidHJ5IHZvbGF0aWxlIHdoaWxlXCIpLFxuICAgIHR5cGVzOiB3b3JkcyhcImJ5dGUgc2hvcnQgaW50IGxvbmcgZmxvYXQgZG91YmxlIGJvb2xlYW4gY2hhciB2b2lkIEJvb2xlYW4gQnl0ZSBDaGFyYWN0ZXIgRG91YmxlIEZsb2F0IFwiICtcbiAgICAgICAgICAgICAgICAgXCJJbnRlZ2VyIExvbmcgTnVtYmVyIE9iamVjdCBTaG9ydCBTdHJpbmcgU3RyaW5nQnVmZmVyIFN0cmluZ0J1aWxkZXIgVm9pZFwiKSxcbiAgICBibG9ja0tleXdvcmRzOiB3b3JkcyhcImNhdGNoIGNsYXNzIGRvIGVsc2UgZmluYWxseSBmb3IgaWYgc3dpdGNoIHRyeSB3aGlsZVwiKSxcbiAgICBkZWZLZXl3b3Jkczogd29yZHMoXCJjbGFzcyBpbnRlcmZhY2UgcGFja2FnZSBlbnVtXCIpLFxuICAgIHR5cGVGaXJzdERlZmluaXRpb25zOiB0cnVlLFxuICAgIGF0b21zOiB3b3JkcyhcInRydWUgZmFsc2UgbnVsbFwiKSxcbiAgICBlbmRTdGF0ZW1lbnQ6IC9eWzs6XSQvLFxuICAgIGhvb2tzOiB7XG4gICAgICBcIkBcIjogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvW1xcd1xcJF9dLyk7XG4gICAgICAgIHJldHVybiBcIm1ldGFcIjtcbiAgICAgIH1cbiAgICB9LFxuICAgIG1vZGVQcm9wczoge2ZvbGQ6IFtcImJyYWNlXCIsIFwiaW1wb3J0XCJdfVxuICB9KTtcblxuICBkZWYoXCJ0ZXh0L3gtY3NoYXJwXCIsIHtcbiAgICBuYW1lOiBcImNsaWtlXCIsXG4gICAga2V5d29yZHM6IHdvcmRzKFwiYWJzdHJhY3QgYXMgYXN5bmMgYXdhaXQgYmFzZSBicmVhayBjYXNlIGNhdGNoIGNoZWNrZWQgY2xhc3MgY29uc3QgY29udGludWVcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIGRlZmF1bHQgZGVsZWdhdGUgZG8gZWxzZSBlbnVtIGV2ZW50IGV4cGxpY2l0IGV4dGVybiBmaW5hbGx5IGZpeGVkIGZvclwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIgZm9yZWFjaCBnb3RvIGlmIGltcGxpY2l0IGluIGludGVyZmFjZSBpbnRlcm5hbCBpcyBsb2NrIG5hbWVzcGFjZSBuZXdcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiIG9wZXJhdG9yIG91dCBvdmVycmlkZSBwYXJhbXMgcHJpdmF0ZSBwcm90ZWN0ZWQgcHVibGljIHJlYWRvbmx5IHJlZiByZXR1cm4gc2VhbGVkXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBzaXplb2Ygc3RhY2thbGxvYyBzdGF0aWMgc3RydWN0IHN3aXRjaCB0aGlzIHRocm93IHRyeSB0eXBlb2YgdW5jaGVja2VkXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiB1bnNhZmUgdXNpbmcgdmlydHVhbCB2b2lkIHZvbGF0aWxlIHdoaWxlIGFkZCBhbGlhcyBhc2NlbmRpbmcgZGVzY2VuZGluZyBkeW5hbWljIGZyb20gZ2V0XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBnbG9iYWwgZ3JvdXAgaW50byBqb2luIGxldCBvcmRlcmJ5IHBhcnRpYWwgcmVtb3ZlIHNlbGVjdCBzZXQgdmFsdWUgdmFyIHlpZWxkXCIpLFxuICAgIHR5cGVzOiB3b3JkcyhcIkFjdGlvbiBCb29sZWFuIEJ5dGUgQ2hhciBEYXRlVGltZSBEYXRlVGltZU9mZnNldCBEZWNpbWFsIERvdWJsZSBGdW5jXCIgK1xuICAgICAgICAgICAgICAgICBcIiBHdWlkIEludDE2IEludDMyIEludDY0IE9iamVjdCBTQnl0ZSBTaW5nbGUgU3RyaW5nIFRhc2sgVGltZVNwYW4gVUludDE2IFVJbnQzMlwiICtcbiAgICAgICAgICAgICAgICAgXCIgVUludDY0IGJvb2wgYnl0ZSBjaGFyIGRlY2ltYWwgZG91YmxlIHNob3J0IGludCBsb25nIG9iamVjdFwiICArXG4gICAgICAgICAgICAgICAgIFwiIHNieXRlIGZsb2F0IHN0cmluZyB1c2hvcnQgdWludCB1bG9uZ1wiKSxcbiAgICBibG9ja0tleXdvcmRzOiB3b3JkcyhcImNhdGNoIGNsYXNzIGRvIGVsc2UgZmluYWxseSBmb3IgZm9yZWFjaCBpZiBzdHJ1Y3Qgc3dpdGNoIHRyeSB3aGlsZVwiKSxcbiAgICBkZWZLZXl3b3Jkczogd29yZHMoXCJjbGFzcyBpbnRlcmZhY2UgbmFtZXNwYWNlIHN0cnVjdCB2YXJcIiksXG4gICAgdHlwZUZpcnN0RGVmaW5pdGlvbnM6IHRydWUsXG4gICAgYXRvbXM6IHdvcmRzKFwidHJ1ZSBmYWxzZSBudWxsXCIpLFxuICAgIGhvb2tzOiB7XG4gICAgICBcIkBcIjogZnVuY3Rpb24oc3RyZWFtLCBzdGF0ZSkge1xuICAgICAgICBpZiAoc3RyZWFtLmVhdCgnXCInKSkge1xuICAgICAgICAgIHN0YXRlLnRva2VuaXplID0gdG9rZW5BdFN0cmluZztcbiAgICAgICAgICByZXR1cm4gdG9rZW5BdFN0cmluZyhzdHJlYW0sIHN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICBzdHJlYW0uZWF0V2hpbGUoL1tcXHdcXCRfXS8pO1xuICAgICAgICByZXR1cm4gXCJtZXRhXCI7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBmdW5jdGlvbiB0b2tlblRyaXBsZVN0cmluZyhzdHJlYW0sIHN0YXRlKSB7XG4gICAgdmFyIGVzY2FwZWQgPSBmYWxzZTtcbiAgICB3aGlsZSAoIXN0cmVhbS5lb2woKSkge1xuICAgICAgaWYgKCFlc2NhcGVkICYmIHN0cmVhbS5tYXRjaCgnXCJcIlwiJykpIHtcbiAgICAgICAgc3RhdGUudG9rZW5pemUgPSBudWxsO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGVzY2FwZWQgPSBzdHJlYW0ubmV4dCgpID09IFwiXFxcXFwiICYmICFlc2NhcGVkO1xuICAgIH1cbiAgICByZXR1cm4gXCJzdHJpbmdcIjtcbiAgfVxuXG4gIGRlZihcInRleHQveC1zY2FsYVwiLCB7XG4gICAgbmFtZTogXCJjbGlrZVwiLFxuICAgIGtleXdvcmRzOiB3b3JkcyhcblxuICAgICAgLyogc2NhbGEgKi9cbiAgICAgIFwiYWJzdHJhY3QgY2FzZSBjYXRjaCBjbGFzcyBkZWYgZG8gZWxzZSBleHRlbmRzIGZpbmFsIGZpbmFsbHkgZm9yIGZvclNvbWUgaWYgXCIgK1xuICAgICAgXCJpbXBsaWNpdCBpbXBvcnQgbGF6eSBtYXRjaCBuZXcgbnVsbCBvYmplY3Qgb3ZlcnJpZGUgcGFja2FnZSBwcml2YXRlIHByb3RlY3RlZCByZXR1cm4gXCIgK1xuICAgICAgXCJzZWFsZWQgc3VwZXIgdGhpcyB0aHJvdyB0cmFpdCB0cnkgdHlwZSB2YWwgdmFyIHdoaWxlIHdpdGggeWllbGQgXyA6ID0gPT4gPC0gPDogXCIgK1xuICAgICAgXCI8JSA+OiAjIEAgXCIgK1xuXG4gICAgICAvKiBwYWNrYWdlIHNjYWxhICovXG4gICAgICBcImFzc2VydCBhc3N1bWUgcmVxdWlyZSBwcmludCBwcmludGxuIHByaW50ZiByZWFkTGluZSByZWFkQm9vbGVhbiByZWFkQnl0ZSByZWFkU2hvcnQgXCIgK1xuICAgICAgXCJyZWFkQ2hhciByZWFkSW50IHJlYWRMb25nIHJlYWRGbG9hdCByZWFkRG91YmxlIFwiICtcblxuICAgICAgXCI6OiAjOjogXCJcbiAgICApLFxuICAgIHR5cGVzOiB3b3JkcyhcbiAgICAgIFwiQW55VmFsIEFwcCBBcHBsaWNhdGlvbiBBcnJheSBCdWZmZXJlZEl0ZXJhdG9yIEJpZ0RlY2ltYWwgQmlnSW50IENoYXIgQ29uc29sZSBFaXRoZXIgXCIgK1xuICAgICAgXCJFbnVtZXJhdGlvbiBFcXVpdiBFcnJvciBFeGNlcHRpb24gRnJhY3Rpb25hbCBGdW5jdGlvbiBJbmRleGVkU2VxIEludGVncmFsIEl0ZXJhYmxlIFwiICtcbiAgICAgIFwiSXRlcmF0b3IgTGlzdCBNYXAgTnVtZXJpYyBOaWwgTm90TnVsbCBPcHRpb24gT3JkZXJlZCBPcmRlcmluZyBQYXJ0aWFsRnVuY3Rpb24gUGFydGlhbE9yZGVyaW5nIFwiICtcbiAgICAgIFwiUHJvZHVjdCBQcm94eSBSYW5nZSBSZXNwb25kZXIgU2VxIFNlcmlhbGl6YWJsZSBTZXQgU3BlY2lhbGl6YWJsZSBTdHJlYW0gU3RyaW5nQnVpbGRlciBcIiArXG4gICAgICBcIlN0cmluZ0NvbnRleHQgU3ltYm9sIFRocm93YWJsZSBUcmF2ZXJzYWJsZSBUcmF2ZXJzYWJsZU9uY2UgVHVwbGUgVW5pdCBWZWN0b3IgXCIgK1xuXG4gICAgICAvKiBwYWNrYWdlIGphdmEubGFuZyAqL1xuICAgICAgXCJCb29sZWFuIEJ5dGUgQ2hhcmFjdGVyIENoYXJTZXF1ZW5jZSBDbGFzcyBDbGFzc0xvYWRlciBDbG9uZWFibGUgQ29tcGFyYWJsZSBcIiArXG4gICAgICBcIkNvbXBpbGVyIERvdWJsZSBFeGNlcHRpb24gRmxvYXQgSW50ZWdlciBMb25nIE1hdGggTnVtYmVyIE9iamVjdCBQYWNrYWdlIFBhaXIgUHJvY2VzcyBcIiArXG4gICAgICBcIlJ1bnRpbWUgUnVubmFibGUgU2VjdXJpdHlNYW5hZ2VyIFNob3J0IFN0YWNrVHJhY2VFbGVtZW50IFN0cmljdE1hdGggU3RyaW5nIFwiICtcbiAgICAgIFwiU3RyaW5nQnVmZmVyIFN5c3RlbSBUaHJlYWQgVGhyZWFkR3JvdXAgVGhyZWFkTG9jYWwgVGhyb3dhYmxlIFRyaXBsZSBWb2lkXCJcbiAgICApLFxuICAgIG11bHRpTGluZVN0cmluZ3M6IHRydWUsXG4gICAgYmxvY2tLZXl3b3Jkczogd29yZHMoXCJjYXRjaCBjbGFzcyBkbyBlbHNlIGZpbmFsbHkgZm9yIGZvclNvbWUgaWYgbWF0Y2ggc3dpdGNoIHRyeSB3aGlsZVwiKSxcbiAgICBkZWZLZXl3b3Jkczogd29yZHMoXCJjbGFzcyBkZWYgb2JqZWN0IHBhY2thZ2UgdHJhaXQgdHlwZSB2YWwgdmFyXCIpLFxuICAgIGF0b21zOiB3b3JkcyhcInRydWUgZmFsc2UgbnVsbFwiKSxcbiAgICBpbmRlbnRTdGF0ZW1lbnRzOiBmYWxzZSxcbiAgICBpbmRlbnRTd2l0Y2g6IGZhbHNlLFxuICAgIGhvb2tzOiB7XG4gICAgICBcIkBcIjogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvW1xcd1xcJF9dLyk7XG4gICAgICAgIHJldHVybiBcIm1ldGFcIjtcbiAgICAgIH0sXG4gICAgICAnXCInOiBmdW5jdGlvbihzdHJlYW0sIHN0YXRlKSB7XG4gICAgICAgIGlmICghc3RyZWFtLm1hdGNoKCdcIlwiJykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgc3RhdGUudG9rZW5pemUgPSB0b2tlblRyaXBsZVN0cmluZztcbiAgICAgICAgcmV0dXJuIHN0YXRlLnRva2VuaXplKHN0cmVhbSwgc3RhdGUpO1xuICAgICAgfSxcbiAgICAgIFwiJ1wiOiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgc3RyZWFtLmVhdFdoaWxlKC9bXFx3XFwkX1xceGExLVxcdWZmZmZdLyk7XG4gICAgICAgIHJldHVybiBcImF0b21cIjtcbiAgICAgIH1cbiAgICB9LFxuICAgIG1vZGVQcm9wczoge2Nsb3NlQnJhY2tldHM6IHt0cmlwbGVzOiAnXCInfX1cbiAgfSk7XG5cbiAgZGVmKFwidGV4dC94LWtvdGxpblwiLCB7XG4gICAgbmFtZTogXCJjbGlrZVwiLFxuICAgIGtleXdvcmRzOiB3b3JkcyhcbiAgICAgIC8qa2V5d29yZHMqL1xuICAgICAgXCJwYWNrYWdlIGFzIHR5cGVhbGlhcyBjbGFzcyBpbnRlcmZhY2UgdGhpcyBzdXBlciB2YWwgXCIgK1xuICAgICAgXCJ2YXIgZnVuIGZvciBpcyBpbiBUaGlzIHRocm93IHJldHVybiBcIiArXG4gICAgICBcImJyZWFrIGNvbnRpbnVlIG9iamVjdCBpZiBlbHNlIHdoaWxlIGRvIHRyeSB3aGVuICFpbiAhaXMgYXM/XCIgK1xuXG4gICAgICAvKnNvZnQga2V5d29yZHMqL1xuICAgICAgXCJmaWxlIGltcG9ydCB3aGVyZSBieSBnZXQgc2V0IGFic3RyYWN0IGVudW0gb3BlbiBpbm5lciBvdmVycmlkZSBwcml2YXRlIHB1YmxpYyBpbnRlcm5hbCBcIiArXG4gICAgICBcInByb3RlY3RlZCBjYXRjaCBmaW5hbGx5IG91dCBmaW5hbCB2YXJhcmcgcmVpZmllZCBkeW5hbWljIGNvbXBhbmlvbiBjb25zdHJ1Y3RvciBpbml0IFwiICtcbiAgICAgIFwic2VhbGVkIGZpZWxkIHByb3BlcnR5IHJlY2VpdmVyIHBhcmFtIHNwYXJhbSBsYXRlaW5pdCBkYXRhIGlubGluZSBub2lubGluZSB0YWlscmVjIFwiICtcbiAgICAgIFwiZXh0ZXJuYWwgYW5ub3RhdGlvbiBjcm9zc2lubGluZVwiXG4gICAgKSxcbiAgICB0eXBlczogd29yZHMoXG4gICAgICAvKiBwYWNrYWdlIGphdmEubGFuZyAqL1xuICAgICAgXCJCb29sZWFuIEJ5dGUgQ2hhcmFjdGVyIENoYXJTZXF1ZW5jZSBDbGFzcyBDbGFzc0xvYWRlciBDbG9uZWFibGUgQ29tcGFyYWJsZSBcIiArXG4gICAgICBcIkNvbXBpbGVyIERvdWJsZSBFeGNlcHRpb24gRmxvYXQgSW50ZWdlciBMb25nIE1hdGggTnVtYmVyIE9iamVjdCBQYWNrYWdlIFBhaXIgUHJvY2VzcyBcIiArXG4gICAgICBcIlJ1bnRpbWUgUnVubmFibGUgU2VjdXJpdHlNYW5hZ2VyIFNob3J0IFN0YWNrVHJhY2VFbGVtZW50IFN0cmljdE1hdGggU3RyaW5nIFwiICtcbiAgICAgIFwiU3RyaW5nQnVmZmVyIFN5c3RlbSBUaHJlYWQgVGhyZWFkR3JvdXAgVGhyZWFkTG9jYWwgVGhyb3dhYmxlIFRyaXBsZSBWb2lkXCJcbiAgICApLFxuICAgIG11bHRpTGluZVN0cmluZ3M6IHRydWUsXG4gICAgYmxvY2tLZXl3b3Jkczogd29yZHMoXCJjYXRjaCBjbGFzcyBkbyBlbHNlIGZpbmFsbHkgZm9yIGlmIHdoZXJlIHRyeSB3aGlsZSBlbnVtXCIpLFxuICAgIGRlZktleXdvcmRzOiB3b3JkcyhcImNsYXNzIHZhbCB2YXIgb2JqZWN0IHBhY2thZ2UgaW50ZXJmYWNlIGZ1blwiKSxcbiAgICBhdG9tczogd29yZHMoXCJ0cnVlIGZhbHNlIG51bGwgdGhpc1wiKSxcbiAgICBtb2RlUHJvcHM6IHtjbG9zZUJyYWNrZXRzOiB7dHJpcGxlczogJ1wiJ319XG4gIH0pO1xuXG4gIGRlZihbXCJ4LXNoYWRlci94LXZlcnRleFwiLCBcIngtc2hhZGVyL3gtZnJhZ21lbnRcIl0sIHtcbiAgICBuYW1lOiBcImNsaWtlXCIsXG4gICAga2V5d29yZHM6IHdvcmRzKFwic2FtcGxlcjFEIHNhbXBsZXIyRCBzYW1wbGVyM0Qgc2FtcGxlckN1YmUgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInNhbXBsZXIxRFNoYWRvdyBzYW1wbGVyMkRTaGFkb3cgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImNvbnN0IGF0dHJpYnV0ZSB1bmlmb3JtIHZhcnlpbmcgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImJyZWFrIGNvbnRpbnVlIGRpc2NhcmQgcmV0dXJuIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJmb3Igd2hpbGUgZG8gaWYgZWxzZSBzdHJ1Y3QgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImluIG91dCBpbm91dFwiKSxcbiAgICB0eXBlczogd29yZHMoXCJmbG9hdCBpbnQgYm9vbCB2b2lkIFwiICtcbiAgICAgICAgICAgICAgICAgXCJ2ZWMyIHZlYzMgdmVjNCBpdmVjMiBpdmVjMyBpdmVjNCBidmVjMiBidmVjMyBidmVjNCBcIiArXG4gICAgICAgICAgICAgICAgIFwibWF0MiBtYXQzIG1hdDRcIiksXG4gICAgYmxvY2tLZXl3b3Jkczogd29yZHMoXCJmb3Igd2hpbGUgZG8gaWYgZWxzZSBzdHJ1Y3RcIiksXG4gICAgYnVpbHRpbjogd29yZHMoXCJyYWRpYW5zIGRlZ3JlZXMgc2luIGNvcyB0YW4gYXNpbiBhY29zIGF0YW4gXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInBvdyBleHAgbG9nIGV4cDIgc3FydCBpbnZlcnNlc3FydCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiYWJzIHNpZ24gZmxvb3IgY2VpbCBmcmFjdCBtb2QgbWluIG1heCBjbGFtcCBtaXggc3RlcCBzbW9vdGhzdGVwIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJsZW5ndGggZGlzdGFuY2UgZG90IGNyb3NzIG5vcm1hbGl6ZSBmdHJhbnNmb3JtIGZhY2Vmb3J3YXJkIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJyZWZsZWN0IHJlZnJhY3QgbWF0cml4Q29tcE11bHQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImxlc3NUaGFuIGxlc3NUaGFuRXF1YWwgZ3JlYXRlclRoYW4gZ3JlYXRlclRoYW5FcXVhbCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiZXF1YWwgbm90RXF1YWwgYW55IGFsbCBub3QgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInRleHR1cmUxRCB0ZXh0dXJlMURQcm9qIHRleHR1cmUxRExvZCB0ZXh0dXJlMURQcm9qTG9kIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ0ZXh0dXJlMkQgdGV4dHVyZTJEUHJvaiB0ZXh0dXJlMkRMb2QgdGV4dHVyZTJEUHJvakxvZCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwidGV4dHVyZTNEIHRleHR1cmUzRFByb2ogdGV4dHVyZTNETG9kIHRleHR1cmUzRFByb2pMb2QgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcInRleHR1cmVDdWJlIHRleHR1cmVDdWJlTG9kIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJzaGFkb3cxRCBzaGFkb3cyRCBzaGFkb3cxRFByb2ogc2hhZG93MkRQcm9qIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJzaGFkb3cxRExvZCBzaGFkb3cyRExvZCBzaGFkb3cxRFByb2pMb2Qgc2hhZG93MkRQcm9qTG9kIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJkRmR4IGRGZHkgZndpZHRoIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJub2lzZTEgbm9pc2UyIG5vaXNlMyBub2lzZTRcIiksXG4gICAgYXRvbXM6IHdvcmRzKFwidHJ1ZSBmYWxzZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9GcmFnQ29sb3IgZ2xfU2Vjb25kYXJ5Q29sb3IgZ2xfTm9ybWFsIGdsX1ZlcnRleCBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9NdWx0aVRleENvb3JkMCBnbF9NdWx0aVRleENvb3JkMSBnbF9NdWx0aVRleENvb3JkMiBnbF9NdWx0aVRleENvb3JkMyBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9NdWx0aVRleENvb3JkNCBnbF9NdWx0aVRleENvb3JkNSBnbF9NdWx0aVRleENvb3JkNiBnbF9NdWx0aVRleENvb3JkNyBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Gb2dDb29yZCBnbF9Qb2ludENvb3JkIFwiICtcbiAgICAgICAgICAgICAgICBcImdsX1Bvc2l0aW9uIGdsX1BvaW50U2l6ZSBnbF9DbGlwVmVydGV4IFwiICtcbiAgICAgICAgICAgICAgICBcImdsX0Zyb250Q29sb3IgZ2xfQmFja0NvbG9yIGdsX0Zyb250U2Vjb25kYXJ5Q29sb3IgZ2xfQmFja1NlY29uZGFyeUNvbG9yIFwiICtcbiAgICAgICAgICAgICAgICBcImdsX1RleENvb3JkIGdsX0ZvZ0ZyYWdDb29yZCBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9GcmFnQ29vcmQgZ2xfRnJvbnRGYWNpbmcgXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfRnJhZ0RhdGEgZ2xfRnJhZ0RlcHRoIFwiICtcbiAgICAgICAgICAgICAgICBcImdsX01vZGVsVmlld01hdHJpeCBnbF9Qcm9qZWN0aW9uTWF0cml4IGdsX01vZGVsVmlld1Byb2plY3Rpb25NYXRyaXggXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfVGV4dHVyZU1hdHJpeCBnbF9Ob3JtYWxNYXRyaXggZ2xfTW9kZWxWaWV3TWF0cml4SW52ZXJzZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Qcm9qZWN0aW9uTWF0cml4SW52ZXJzZSBnbF9Nb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4SW52ZXJzZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9UZXh1cmVNYXRyaXhUcmFuc3Bvc2UgZ2xfTW9kZWxWaWV3TWF0cml4SW52ZXJzZVRyYW5zcG9zZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Qcm9qZWN0aW9uTWF0cml4SW52ZXJzZVRyYW5zcG9zZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Nb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4SW52ZXJzZVRyYW5zcG9zZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9UZXh0dXJlTWF0cml4SW52ZXJzZVRyYW5zcG9zZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Ob3JtYWxTY2FsZSBnbF9EZXB0aFJhbmdlIGdsX0NsaXBQbGFuZSBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9Qb2ludCBnbF9Gcm9udE1hdGVyaWFsIGdsX0JhY2tNYXRlcmlhbCBnbF9MaWdodFNvdXJjZSBnbF9MaWdodE1vZGVsIFwiICtcbiAgICAgICAgICAgICAgICBcImdsX0Zyb250TGlnaHRNb2RlbFByb2R1Y3QgZ2xfQmFja0xpZ2h0TW9kZWxQcm9kdWN0IFwiICtcbiAgICAgICAgICAgICAgICBcImdsX1RleHR1cmVDb2xvciBnbF9FeWVQbGFuZVMgZ2xfRXllUGxhbmVUIGdsX0V5ZVBsYW5lUiBnbF9FeWVQbGFuZVEgXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfRm9nUGFyYW1ldGVycyBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9NYXhMaWdodHMgZ2xfTWF4Q2xpcFBsYW5lcyBnbF9NYXhUZXh0dXJlVW5pdHMgZ2xfTWF4VGV4dHVyZUNvb3JkcyBcIiArXG4gICAgICAgICAgICAgICAgXCJnbF9NYXhWZXJ0ZXhBdHRyaWJzIGdsX01heFZlcnRleFVuaWZvcm1Db21wb25lbnRzIGdsX01heFZhcnlpbmdGbG9hdHMgXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfTWF4VmVydGV4VGV4dHVyZUltYWdlVW5pdHMgZ2xfTWF4VGV4dHVyZUltYWdlVW5pdHMgXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfTWF4RnJhZ21lbnRVbmlmb3JtQ29tcG9uZW50cyBnbF9NYXhDb21iaW5lVGV4dHVyZUltYWdlVW5pdHMgXCIgK1xuICAgICAgICAgICAgICAgIFwiZ2xfTWF4RHJhd0J1ZmZlcnNcIiksXG4gICAgaW5kZW50U3dpdGNoOiBmYWxzZSxcbiAgICBob29rczoge1wiI1wiOiBjcHBIb29rfSxcbiAgICBtb2RlUHJvcHM6IHtmb2xkOiBbXCJicmFjZVwiLCBcImluY2x1ZGVcIl19XG4gIH0pO1xuXG4gIGRlZihcInRleHQveC1uZXNjXCIsIHtcbiAgICBuYW1lOiBcImNsaWtlXCIsXG4gICAga2V5d29yZHM6IHdvcmRzKGNLZXl3b3JkcyArIFwiYXMgYXRvbWljIGFzeW5jIGNhbGwgY29tbWFuZCBjb21wb25lbnQgY29tcG9uZW50cyBjb25maWd1cmF0aW9uIGV2ZW50IGdlbmVyaWMgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcImltcGxlbWVudGF0aW9uIGluY2x1ZGVzIGludGVyZmFjZSBtb2R1bGUgbmV3IG5vcmFjZSBueF9zdHJ1Y3QgbnhfdW5pb24gcG9zdCBwcm92aWRlcyBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwic2lnbmFsIHRhc2sgdXNlcyBhYnN0cmFjdCBleHRlbmRzXCIpLFxuICAgIHR5cGVzOiB3b3JkcyhjVHlwZXMpLFxuICAgIGJsb2NrS2V5d29yZHM6IHdvcmRzKFwiY2FzZSBkbyBlbHNlIGZvciBpZiBzd2l0Y2ggd2hpbGUgc3RydWN0XCIpLFxuICAgIGF0b21zOiB3b3JkcyhcIm51bGwgdHJ1ZSBmYWxzZVwiKSxcbiAgICBob29rczoge1wiI1wiOiBjcHBIb29rfSxcbiAgICBtb2RlUHJvcHM6IHtmb2xkOiBbXCJicmFjZVwiLCBcImluY2x1ZGVcIl19XG4gIH0pO1xuXG4gIGRlZihcInRleHQveC1vYmplY3RpdmVjXCIsIHtcbiAgICBuYW1lOiBcImNsaWtlXCIsXG4gICAga2V5d29yZHM6IHdvcmRzKGNLZXl3b3JkcyArIFwiaW5saW5lIHJlc3RyaWN0IF9Cb29sIF9Db21wbGV4IF9JbWFnaW5lcnkgQk9PTCBDbGFzcyBieWNvcHkgYnlyZWYgaWQgSU1QIGluIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJpbm91dCBuaWwgb25ld2F5IG91dCBQcm90b2NvbCBTRUwgc2VsZiBzdXBlciBhdG9taWMgbm9uYXRvbWljIHJldGFpbiBjb3B5IHJlYWR3cml0ZSByZWFkb25seVwiKSxcbiAgICB0eXBlczogd29yZHMoY1R5cGVzKSxcbiAgICBhdG9tczogd29yZHMoXCJZRVMgTk8gTlVMTCBOSUxMIE9OIE9GRiB0cnVlIGZhbHNlXCIpLFxuICAgIGhvb2tzOiB7XG4gICAgICBcIkBcIjogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvW1xcd1xcJF0vKTtcbiAgICAgICAgcmV0dXJuIFwia2V5d29yZFwiO1xuICAgICAgfSxcbiAgICAgIFwiI1wiOiBjcHBIb29rLFxuICAgICAgaW5kZW50OiBmdW5jdGlvbihfc3RhdGUsIGN0eCwgdGV4dEFmdGVyKSB7XG4gICAgICAgIGlmIChjdHgudHlwZSA9PSBcInN0YXRlbWVudFwiICYmIC9eQFxcdy8udGVzdCh0ZXh0QWZ0ZXIpKSByZXR1cm4gY3R4LmluZGVudGVkXG4gICAgICB9XG4gICAgfSxcbiAgICBtb2RlUHJvcHM6IHtmb2xkOiBcImJyYWNlXCJ9XG4gIH0pO1xuXG4gIGRlZihcInRleHQveC1zcXVpcnJlbFwiLCB7XG4gICAgbmFtZTogXCJjbGlrZVwiLFxuICAgIGtleXdvcmRzOiB3b3JkcyhcImJhc2UgYnJlYWsgY2xvbmUgY29udGludWUgY29uc3QgZGVmYXVsdCBkZWxldGUgZW51bSBleHRlbmRzIGZ1bmN0aW9uIGluIGNsYXNzXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBmb3JlYWNoIGxvY2FsIHJlc3VtZSByZXR1cm4gdGhpcyB0aHJvdyB0eXBlb2YgeWllbGQgY29uc3RydWN0b3IgaW5zdGFuY2VvZiBzdGF0aWNcIiksXG4gICAgdHlwZXM6IHdvcmRzKGNUeXBlcyksXG4gICAgYmxvY2tLZXl3b3Jkczogd29yZHMoXCJjYXNlIGNhdGNoIGNsYXNzIGVsc2UgZm9yIGZvcmVhY2ggaWYgc3dpdGNoIHRyeSB3aGlsZVwiKSxcbiAgICBkZWZLZXl3b3Jkczogd29yZHMoXCJmdW5jdGlvbiBsb2NhbCBjbGFzc1wiKSxcbiAgICB0eXBlRmlyc3REZWZpbml0aW9uczogdHJ1ZSxcbiAgICBhdG9tczogd29yZHMoXCJ0cnVlIGZhbHNlIG51bGxcIiksXG4gICAgaG9va3M6IHtcIiNcIjogY3BwSG9va30sXG4gICAgbW9kZVByb3BzOiB7Zm9sZDogW1wiYnJhY2VcIiwgXCJpbmNsdWRlXCJdfVxuICB9KTtcblxuICAvLyBDZXlsb24gU3RyaW5ncyBuZWVkIHRvIGRlYWwgd2l0aCBpbnRlcnBvbGF0aW9uXG4gIHZhciBzdHJpbmdUb2tlbml6ZXIgPSBudWxsO1xuICBmdW5jdGlvbiB0b2tlbkNleWxvblN0cmluZyh0eXBlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmVhbSwgc3RhdGUpIHtcbiAgICAgIHZhciBlc2NhcGVkID0gZmFsc2UsIG5leHQsIGVuZCA9IGZhbHNlO1xuICAgICAgd2hpbGUgKCFzdHJlYW0uZW9sKCkpIHtcbiAgICAgICAgaWYgKCFlc2NhcGVkICYmIHN0cmVhbS5tYXRjaCgnXCInKSAmJlxuICAgICAgICAgICAgICAodHlwZSA9PSBcInNpbmdsZVwiIHx8IHN0cmVhbS5tYXRjaCgnXCJcIicpKSkge1xuICAgICAgICAgIGVuZCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFlc2NhcGVkICYmIHN0cmVhbS5tYXRjaCgnYGAnKSkge1xuICAgICAgICAgIHN0cmluZ1Rva2VuaXplciA9IHRva2VuQ2V5bG9uU3RyaW5nKHR5cGUpO1xuICAgICAgICAgIGVuZCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dCA9IHN0cmVhbS5uZXh0KCk7XG4gICAgICAgIGVzY2FwZWQgPSB0eXBlID09IFwic2luZ2xlXCIgJiYgIWVzY2FwZWQgJiYgbmV4dCA9PSBcIlxcXFxcIjtcbiAgICAgIH1cbiAgICAgIGlmIChlbmQpXG4gICAgICAgICAgc3RhdGUudG9rZW5pemUgPSBudWxsO1xuICAgICAgcmV0dXJuIFwic3RyaW5nXCI7XG4gICAgfVxuICB9XG5cbiAgZGVmKFwidGV4dC94LWNleWxvblwiLCB7XG4gICAgbmFtZTogXCJjbGlrZVwiLFxuICAgIGtleXdvcmRzOiB3b3JkcyhcImFic3RyYWN0cyBhbGlhcyBhc3NlbWJseSBhc3NlcnQgYXNzaWduIGJyZWFrIGNhc2UgY2F0Y2ggY2xhc3MgY29udGludWUgZHluYW1pYyBlbHNlXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBleGlzdHMgZXh0ZW5kcyBmaW5hbGx5IGZvciBmdW5jdGlvbiBnaXZlbiBpZiBpbXBvcnQgaW4gaW50ZXJmYWNlIGlzIGxldCBtb2R1bGUgbmV3XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiBub25lbXB0eSBvYmplY3Qgb2Ygb3V0IG91dGVyIHBhY2thZ2UgcmV0dXJuIHNhdGlzZmllcyBzdXBlciBzd2l0Y2ggdGhlbiB0aGlzIHRocm93XCIgK1xuICAgICAgICAgICAgICAgICAgICBcIiB0cnkgdmFsdWUgdm9pZCB3aGlsZVwiKSxcbiAgICB0eXBlczogZnVuY3Rpb24od29yZCkge1xuICAgICAgICAvLyBJbiBDZXlsb24gYWxsIGlkZW50aWZpZXJzIHRoYXQgc3RhcnQgd2l0aCBhbiB1cHBlcmNhc2UgYXJlIHR5cGVzXG4gICAgICAgIHZhciBmaXJzdCA9IHdvcmQuY2hhckF0KDApO1xuICAgICAgICByZXR1cm4gKGZpcnN0ID09PSBmaXJzdC50b1VwcGVyQ2FzZSgpICYmIGZpcnN0ICE9PSBmaXJzdC50b0xvd2VyQ2FzZSgpKTtcbiAgICB9LFxuICAgIGJsb2NrS2V5d29yZHM6IHdvcmRzKFwiY2FzZSBjYXRjaCBjbGFzcyBkeW5hbWljIGVsc2UgZmluYWxseSBmb3IgZnVuY3Rpb24gaWYgaW50ZXJmYWNlIG1vZHVsZSBuZXcgb2JqZWN0IHN3aXRjaCB0cnkgd2hpbGVcIiksXG4gICAgZGVmS2V5d29yZHM6IHdvcmRzKFwiY2xhc3MgZHluYW1pYyBmdW5jdGlvbiBpbnRlcmZhY2UgbW9kdWxlIG9iamVjdCBwYWNrYWdlIHZhbHVlXCIpLFxuICAgIGJ1aWx0aW46IHdvcmRzKFwiYWJzdHJhY3QgYWN0dWFsIGFsaWFzZWQgYW5ub3RhdGlvbiBieSBkZWZhdWx0IGRlcHJlY2F0ZWQgZG9jIGZpbmFsIGZvcm1hbCBsYXRlIGxpY2Vuc2VcIiArXG4gICAgICAgICAgICAgICAgICAgXCIgbmF0aXZlIG9wdGlvbmFsIHNlYWxlZCBzZWUgc2VyaWFsaXphYmxlIHNoYXJlZCBzdXBwcmVzc1dhcm5pbmdzIHRhZ2dlZCB0aHJvd3MgdmFyaWFibGVcIiksXG4gICAgaXNQdW5jdHVhdGlvbkNoYXI6IC9bXFxbXFxde31cXChcXCksO1xcOlxcLmBdLyxcbiAgICBpc09wZXJhdG9yQ2hhcjogL1srXFwtKiYlPTw+IT98Xn46XFwvXS8sXG4gICAgaXNOdW1iZXJDaGFyOiAvW1xcZCMkXS8sXG4gICAgbXVsdGlMaW5lU3RyaW5nczogdHJ1ZSxcbiAgICB0eXBlRmlyc3REZWZpbml0aW9uczogdHJ1ZSxcbiAgICBhdG9tczogd29yZHMoXCJ0cnVlIGZhbHNlIG51bGwgbGFyZ2VyIHNtYWxsZXIgZXF1YWwgZW1wdHkgZmluaXNoZWRcIiksXG4gICAgaW5kZW50U3dpdGNoOiBmYWxzZSxcbiAgICBzdHlsZURlZnM6IGZhbHNlLFxuICAgIGhvb2tzOiB7XG4gICAgICBcIkBcIjogZnVuY3Rpb24oc3RyZWFtKSB7XG4gICAgICAgIHN0cmVhbS5lYXRXaGlsZSgvW1xcd1xcJF9dLyk7XG4gICAgICAgIHJldHVybiBcIm1ldGFcIjtcbiAgICAgIH0sXG4gICAgICAnXCInOiBmdW5jdGlvbihzdHJlYW0sIHN0YXRlKSB7XG4gICAgICAgICAgc3RhdGUudG9rZW5pemUgPSB0b2tlbkNleWxvblN0cmluZyhzdHJlYW0ubWF0Y2goJ1wiXCInKSA/IFwidHJpcGxlXCIgOiBcInNpbmdsZVwiKTtcbiAgICAgICAgICByZXR1cm4gc3RhdGUudG9rZW5pemUoc3RyZWFtLCBzdGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAnYCc6IGZ1bmN0aW9uKHN0cmVhbSwgc3RhdGUpIHtcbiAgICAgICAgICBpZiAoIXN0cmluZ1Rva2VuaXplciB8fCAhc3RyZWFtLm1hdGNoKCdgJykpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICBzdGF0ZS50b2tlbml6ZSA9IHN0cmluZ1Rva2VuaXplcjtcbiAgICAgICAgICBzdHJpbmdUb2tlbml6ZXIgPSBudWxsO1xuICAgICAgICAgIHJldHVybiBzdGF0ZS50b2tlbml6ZShzdHJlYW0sIHN0YXRlKTtcbiAgICAgICAgfSxcbiAgICAgIFwiJ1wiOiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgc3RyZWFtLmVhdFdoaWxlKC9bXFx3XFwkX1xceGExLVxcdWZmZmZdLyk7XG4gICAgICAgIHJldHVybiBcImF0b21cIjtcbiAgICAgIH0sXG4gICAgICB0b2tlbjogZnVuY3Rpb24oX3N0cmVhbSwgc3RhdGUsIHN0eWxlKSB7XG4gICAgICAgICAgaWYgKChzdHlsZSA9PSBcInZhcmlhYmxlXCIgfHwgc3R5bGUgPT0gXCJ2YXJpYWJsZS0zXCIpICYmXG4gICAgICAgICAgICAgIHN0YXRlLnByZXZUb2tlbiA9PSBcIi5cIikge1xuICAgICAgICAgICAgcmV0dXJuIFwidmFyaWFibGUtMlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgbW9kZVByb3BzOiB7XG4gICAgICAgIGZvbGQ6IFtcImJyYWNlXCIsIFwiaW1wb3J0XCJdLFxuICAgICAgICBjbG9zZUJyYWNrZXRzOiB7dHJpcGxlczogJ1wiJ31cbiAgICB9XG4gIH0pO1xuXG59KTtcbiIsInJlcXVpcmUoJy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uL21vZHVsZXMvY29yZS5nZXQtaXRlcmF0b3InKTsiLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuYXNzaWduJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvJC5jb3JlJykuT2JqZWN0LmFzc2lnbjsiLCJ2YXIgJCA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvJCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGUoUCwgRCl7XG4gIHJldHVybiAkLmNyZWF0ZShQLCBEKTtcbn07IiwidmFyICQgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzLyQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7XG4gIHJldHVybiAkLnNldERlc2MoaXQsIGtleSwgZGVzYyk7XG59OyIsInZhciAkID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy8kJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihpdCwga2V5KXtcbiAgcmV0dXJuICQuZ2V0RGVzYyhpdCwga2V5KTtcbn07IiwicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMnKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vLi4vbW9kdWxlcy8kLmNvcmUnKS5PYmplY3Qua2V5czsiLCJyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Quc2V0LXByb3RvdHlwZS1vZicpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzLyQuY29yZScpLk9iamVjdC5zZXRQcm90b3R5cGVPZjsiLCJyZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5vYmplY3QudG8tc3RyaW5nJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3InKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYucHJvbWlzZScpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi9tb2R1bGVzLyQuY29yZScpLlByb21pc2U7IiwicmVxdWlyZSgnLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZycpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yJyk7XG5yZXF1aXJlKCcuLi9tb2R1bGVzL3dlYi5kb20uaXRlcmFibGUnKTtcbnJlcXVpcmUoJy4uL21vZHVsZXMvZXM2LnNldCcpO1xucmVxdWlyZSgnLi4vbW9kdWxlcy9lczcuc2V0LnRvLWpzb24nKTtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi4vbW9kdWxlcy8kLmNvcmUnKS5TZXQ7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7XG4gIHJldHVybiBpdDtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9OyIsInZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vJC5pcy1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTtcbiAgcmV0dXJuIGl0O1xufTsiLCIvLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKVxudmFyIGNvZiA9IHJlcXVpcmUoJy4vJC5jb2YnKVxuICAsIFRBRyA9IHJlcXVpcmUoJy4vJC53a3MnKSgndG9TdHJpbmdUYWcnKVxuICAvLyBFUzMgd3JvbmcgaGVyZVxuICAsIEFSRyA9IGNvZihmdW5jdGlvbigpeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgdmFyIE8sIFQsIEI7XG4gIHJldHVybiBpdCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBpdCA9PT0gbnVsbCA/ICdOdWxsJ1xuICAgIC8vIEBAdG9TdHJpbmdUYWcgY2FzZVxuICAgIDogdHlwZW9mIChUID0gKE8gPSBPYmplY3QoaXQpKVtUQUddKSA9PSAnc3RyaW5nJyA/IFRcbiAgICAvLyBidWlsdGluVGFnIGNhc2VcbiAgICA6IEFSRyA/IGNvZihPKVxuICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2tcbiAgICA6IChCID0gY29mKE8pKSA9PSAnT2JqZWN0JyAmJiB0eXBlb2YgTy5jYWxsZWUgPT0gJ2Z1bmN0aW9uJyA/ICdBcmd1bWVudHMnIDogQjtcbn07IiwidmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpO1xufTsiLCIndXNlIHN0cmljdCc7XG52YXIgJCAgICAgICAgICAgID0gcmVxdWlyZSgnLi8kJylcbiAgLCBoaWRlICAgICAgICAgPSByZXF1aXJlKCcuLyQuaGlkZScpXG4gICwgcmVkZWZpbmVBbGwgID0gcmVxdWlyZSgnLi8kLnJlZGVmaW5lLWFsbCcpXG4gICwgY3R4ICAgICAgICAgID0gcmVxdWlyZSgnLi8kLmN0eCcpXG4gICwgc3RyaWN0TmV3ICAgID0gcmVxdWlyZSgnLi8kLnN0cmljdC1uZXcnKVxuICAsIGRlZmluZWQgICAgICA9IHJlcXVpcmUoJy4vJC5kZWZpbmVkJylcbiAgLCBmb3JPZiAgICAgICAgPSByZXF1aXJlKCcuLyQuZm9yLW9mJylcbiAgLCAkaXRlckRlZmluZSAgPSByZXF1aXJlKCcuLyQuaXRlci1kZWZpbmUnKVxuICAsIHN0ZXAgICAgICAgICA9IHJlcXVpcmUoJy4vJC5pdGVyLXN0ZXAnKVxuICAsIElEICAgICAgICAgICA9IHJlcXVpcmUoJy4vJC51aWQnKSgnaWQnKVxuICAsICRoYXMgICAgICAgICA9IHJlcXVpcmUoJy4vJC5oYXMnKVxuICAsIGlzT2JqZWN0ICAgICA9IHJlcXVpcmUoJy4vJC5pcy1vYmplY3QnKVxuICAsIHNldFNwZWNpZXMgICA9IHJlcXVpcmUoJy4vJC5zZXQtc3BlY2llcycpXG4gICwgREVTQ1JJUFRPUlMgID0gcmVxdWlyZSgnLi8kLmRlc2NyaXB0b3JzJylcbiAgLCBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGlzT2JqZWN0XG4gICwgU0laRSAgICAgICAgID0gREVTQ1JJUFRPUlMgPyAnX3MnIDogJ3NpemUnXG4gICwgaWQgICAgICAgICAgID0gMDtcblxudmFyIGZhc3RLZXkgPSBmdW5jdGlvbihpdCwgY3JlYXRlKXtcbiAgLy8gcmV0dXJuIHByaW1pdGl2ZSB3aXRoIHByZWZpeFxuICBpZighaXNPYmplY3QoaXQpKXJldHVybiB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6ICh0eXBlb2YgaXQgPT0gJ3N0cmluZycgPyAnUycgOiAnUCcpICsgaXQ7XG4gIGlmKCEkaGFzKGl0LCBJRCkpe1xuICAgIC8vIGNhbid0IHNldCBpZCB0byBmcm96ZW4gb2JqZWN0XG4gICAgaWYoIWlzRXh0ZW5zaWJsZShpdCkpcmV0dXJuICdGJztcbiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBpZFxuICAgIGlmKCFjcmVhdGUpcmV0dXJuICdFJztcbiAgICAvLyBhZGQgbWlzc2luZyBvYmplY3QgaWRcbiAgICBoaWRlKGl0LCBJRCwgKytpZCk7XG4gIC8vIHJldHVybiBvYmplY3QgaWQgd2l0aCBwcmVmaXhcbiAgfSByZXR1cm4gJ08nICsgaXRbSURdO1xufTtcblxudmFyIGdldEVudHJ5ID0gZnVuY3Rpb24odGhhdCwga2V5KXtcbiAgLy8gZmFzdCBjYXNlXG4gIHZhciBpbmRleCA9IGZhc3RLZXkoa2V5KSwgZW50cnk7XG4gIGlmKGluZGV4ICE9PSAnRicpcmV0dXJuIHRoYXQuX2lbaW5kZXhdO1xuICAvLyBmcm96ZW4gb2JqZWN0IGNhc2VcbiAgZm9yKGVudHJ5ID0gdGhhdC5fZjsgZW50cnk7IGVudHJ5ID0gZW50cnkubil7XG4gICAgaWYoZW50cnkuayA9PSBrZXkpcmV0dXJuIGVudHJ5O1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0Q29uc3RydWN0b3I6IGZ1bmN0aW9uKHdyYXBwZXIsIE5BTUUsIElTX01BUCwgQURERVIpe1xuICAgIHZhciBDID0gd3JhcHBlcihmdW5jdGlvbih0aGF0LCBpdGVyYWJsZSl7XG4gICAgICBzdHJpY3ROZXcodGhhdCwgQywgTkFNRSk7XG4gICAgICB0aGF0Ll9pID0gJC5jcmVhdGUobnVsbCk7IC8vIGluZGV4XG4gICAgICB0aGF0Ll9mID0gdW5kZWZpbmVkOyAgICAgIC8vIGZpcnN0IGVudHJ5XG4gICAgICB0aGF0Ll9sID0gdW5kZWZpbmVkOyAgICAgIC8vIGxhc3QgZW50cnlcbiAgICAgIHRoYXRbU0laRV0gPSAwOyAgICAgICAgICAgLy8gc2l6ZVxuICAgICAgaWYoaXRlcmFibGUgIT0gdW5kZWZpbmVkKWZvck9mKGl0ZXJhYmxlLCBJU19NQVAsIHRoYXRbQURERVJdLCB0aGF0KTtcbiAgICB9KTtcbiAgICByZWRlZmluZUFsbChDLnByb3RvdHlwZSwge1xuICAgICAgLy8gMjMuMS4zLjEgTWFwLnByb3RvdHlwZS5jbGVhcigpXG4gICAgICAvLyAyMy4yLjMuMiBTZXQucHJvdG90eXBlLmNsZWFyKClcbiAgICAgIGNsZWFyOiBmdW5jdGlvbiBjbGVhcigpe1xuICAgICAgICBmb3IodmFyIHRoYXQgPSB0aGlzLCBkYXRhID0gdGhhdC5faSwgZW50cnkgPSB0aGF0Ll9mOyBlbnRyeTsgZW50cnkgPSBlbnRyeS5uKXtcbiAgICAgICAgICBlbnRyeS5yID0gdHJ1ZTtcbiAgICAgICAgICBpZihlbnRyeS5wKWVudHJ5LnAgPSBlbnRyeS5wLm4gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgZGVsZXRlIGRhdGFbZW50cnkuaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhhdC5fZiA9IHRoYXQuX2wgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoYXRbU0laRV0gPSAwO1xuICAgICAgfSxcbiAgICAgIC8vIDIzLjEuMy4zIE1hcC5wcm90b3R5cGUuZGVsZXRlKGtleSlcbiAgICAgIC8vIDIzLjIuMy40IFNldC5wcm90b3R5cGUuZGVsZXRlKHZhbHVlKVxuICAgICAgJ2RlbGV0ZSc6IGZ1bmN0aW9uKGtleSl7XG4gICAgICAgIHZhciB0aGF0ICA9IHRoaXNcbiAgICAgICAgICAsIGVudHJ5ID0gZ2V0RW50cnkodGhhdCwga2V5KTtcbiAgICAgICAgaWYoZW50cnkpe1xuICAgICAgICAgIHZhciBuZXh0ID0gZW50cnkublxuICAgICAgICAgICAgLCBwcmV2ID0gZW50cnkucDtcbiAgICAgICAgICBkZWxldGUgdGhhdC5faVtlbnRyeS5pXTtcbiAgICAgICAgICBlbnRyeS5yID0gdHJ1ZTtcbiAgICAgICAgICBpZihwcmV2KXByZXYubiA9IG5leHQ7XG4gICAgICAgICAgaWYobmV4dCluZXh0LnAgPSBwcmV2O1xuICAgICAgICAgIGlmKHRoYXQuX2YgPT0gZW50cnkpdGhhdC5fZiA9IG5leHQ7XG4gICAgICAgICAgaWYodGhhdC5fbCA9PSBlbnRyeSl0aGF0Ll9sID0gcHJldjtcbiAgICAgICAgICB0aGF0W1NJWkVdLS07XG4gICAgICAgIH0gcmV0dXJuICEhZW50cnk7XG4gICAgICB9LFxuICAgICAgLy8gMjMuMi4zLjYgU2V0LnByb3RvdHlwZS5mb3JFYWNoKGNhbGxiYWNrZm4sIHRoaXNBcmcgPSB1bmRlZmluZWQpXG4gICAgICAvLyAyMy4xLjMuNSBNYXAucHJvdG90eXBlLmZvckVhY2goY2FsbGJhY2tmbiwgdGhpc0FyZyA9IHVuZGVmaW5lZClcbiAgICAgIGZvckVhY2g6IGZ1bmN0aW9uIGZvckVhY2goY2FsbGJhY2tmbiAvKiwgdGhhdCA9IHVuZGVmaW5lZCAqLyl7XG4gICAgICAgIHZhciBmID0gY3R4KGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCAzKVxuICAgICAgICAgICwgZW50cnk7XG4gICAgICAgIHdoaWxlKGVudHJ5ID0gZW50cnkgPyBlbnRyeS5uIDogdGhpcy5fZil7XG4gICAgICAgICAgZihlbnRyeS52LCBlbnRyeS5rLCB0aGlzKTtcbiAgICAgICAgICAvLyByZXZlcnQgdG8gdGhlIGxhc3QgZXhpc3RpbmcgZW50cnlcbiAgICAgICAgICB3aGlsZShlbnRyeSAmJiBlbnRyeS5yKWVudHJ5ID0gZW50cnkucDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIDIzLjEuMy43IE1hcC5wcm90b3R5cGUuaGFzKGtleSlcbiAgICAgIC8vIDIzLjIuMy43IFNldC5wcm90b3R5cGUuaGFzKHZhbHVlKVxuICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KXtcbiAgICAgICAgcmV0dXJuICEhZ2V0RW50cnkodGhpcywga2V5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZihERVNDUklQVE9SUykkLnNldERlc2MoQy5wcm90b3R5cGUsICdzaXplJywge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gZGVmaW5lZCh0aGlzW1NJWkVdKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gQztcbiAgfSxcbiAgZGVmOiBmdW5jdGlvbih0aGF0LCBrZXksIHZhbHVlKXtcbiAgICB2YXIgZW50cnkgPSBnZXRFbnRyeSh0aGF0LCBrZXkpXG4gICAgICAsIHByZXYsIGluZGV4O1xuICAgIC8vIGNoYW5nZSBleGlzdGluZyBlbnRyeVxuICAgIGlmKGVudHJ5KXtcbiAgICAgIGVudHJ5LnYgPSB2YWx1ZTtcbiAgICAvLyBjcmVhdGUgbmV3IGVudHJ5XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoYXQuX2wgPSBlbnRyeSA9IHtcbiAgICAgICAgaTogaW5kZXggPSBmYXN0S2V5KGtleSwgdHJ1ZSksIC8vIDwtIGluZGV4XG4gICAgICAgIGs6IGtleSwgICAgICAgICAgICAgICAgICAgICAgICAvLyA8LSBrZXlcbiAgICAgICAgdjogdmFsdWUsICAgICAgICAgICAgICAgICAgICAgIC8vIDwtIHZhbHVlXG4gICAgICAgIHA6IHByZXYgPSB0aGF0Ll9sLCAgICAgICAgICAgICAvLyA8LSBwcmV2aW91cyBlbnRyeVxuICAgICAgICBuOiB1bmRlZmluZWQsICAgICAgICAgICAgICAgICAgLy8gPC0gbmV4dCBlbnRyeVxuICAgICAgICByOiBmYWxzZSAgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gcmVtb3ZlZFxuICAgICAgfTtcbiAgICAgIGlmKCF0aGF0Ll9mKXRoYXQuX2YgPSBlbnRyeTtcbiAgICAgIGlmKHByZXYpcHJldi5uID0gZW50cnk7XG4gICAgICB0aGF0W1NJWkVdKys7XG4gICAgICAvLyBhZGQgdG8gaW5kZXhcbiAgICAgIGlmKGluZGV4ICE9PSAnRicpdGhhdC5faVtpbmRleF0gPSBlbnRyeTtcbiAgICB9IHJldHVybiB0aGF0O1xuICB9LFxuICBnZXRFbnRyeTogZ2V0RW50cnksXG4gIHNldFN0cm9uZzogZnVuY3Rpb24oQywgTkFNRSwgSVNfTUFQKXtcbiAgICAvLyBhZGQgLmtleXMsIC52YWx1ZXMsIC5lbnRyaWVzLCBbQEBpdGVyYXRvcl1cbiAgICAvLyAyMy4xLjMuNCwgMjMuMS4zLjgsIDIzLjEuMy4xMSwgMjMuMS4zLjEyLCAyMy4yLjMuNSwgMjMuMi4zLjgsIDIzLjIuMy4xMCwgMjMuMi4zLjExXG4gICAgJGl0ZXJEZWZpbmUoQywgTkFNRSwgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpe1xuICAgICAgdGhpcy5fdCA9IGl0ZXJhdGVkOyAgLy8gdGFyZ2V0XG4gICAgICB0aGlzLl9rID0ga2luZDsgICAgICAvLyBraW5kXG4gICAgICB0aGlzLl9sID0gdW5kZWZpbmVkOyAvLyBwcmV2aW91c1xuICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgdGhhdCAgPSB0aGlzXG4gICAgICAgICwga2luZCAgPSB0aGF0Ll9rXG4gICAgICAgICwgZW50cnkgPSB0aGF0Ll9sO1xuICAgICAgLy8gcmV2ZXJ0IHRvIHRoZSBsYXN0IGV4aXN0aW5nIGVudHJ5XG4gICAgICB3aGlsZShlbnRyeSAmJiBlbnRyeS5yKWVudHJ5ID0gZW50cnkucDtcbiAgICAgIC8vIGdldCBuZXh0IGVudHJ5XG4gICAgICBpZighdGhhdC5fdCB8fCAhKHRoYXQuX2wgPSBlbnRyeSA9IGVudHJ5ID8gZW50cnkubiA6IHRoYXQuX3QuX2YpKXtcbiAgICAgICAgLy8gb3IgZmluaXNoIHRoZSBpdGVyYXRpb25cbiAgICAgICAgdGhhdC5fdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHN0ZXAoMSk7XG4gICAgICB9XG4gICAgICAvLyByZXR1cm4gc3RlcCBieSBraW5kXG4gICAgICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGVudHJ5LmspO1xuICAgICAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBlbnRyeS52KTtcbiAgICAgIHJldHVybiBzdGVwKDAsIFtlbnRyeS5rLCBlbnRyeS52XSk7XG4gICAgfSwgSVNfTUFQID8gJ2VudHJpZXMnIDogJ3ZhbHVlcycgLCAhSVNfTUFQLCB0cnVlKTtcblxuICAgIC8vIGFkZCBbQEBzcGVjaWVzXSwgMjMuMS4yLjIsIDIzLjIuMi4yXG4gICAgc2V0U3BlY2llcyhOQU1FKTtcbiAgfVxufTsiLCIvLyBodHRwczovL2dpdGh1Yi5jb20vRGF2aWRCcnVhbnQvTWFwLVNldC5wcm90b3R5cGUudG9KU09OXG52YXIgZm9yT2YgICA9IHJlcXVpcmUoJy4vJC5mb3Itb2YnKVxuICAsIGNsYXNzb2YgPSByZXF1aXJlKCcuLyQuY2xhc3NvZicpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihOQU1FKXtcbiAgcmV0dXJuIGZ1bmN0aW9uIHRvSlNPTigpe1xuICAgIGlmKGNsYXNzb2YodGhpcykgIT0gTkFNRSl0aHJvdyBUeXBlRXJyb3IoTkFNRSArIFwiI3RvSlNPTiBpc24ndCBnZW5lcmljXCIpO1xuICAgIHZhciBhcnIgPSBbXTtcbiAgICBmb3JPZih0aGlzLCBmYWxzZSwgYXJyLnB1c2gsIGFycik7XG4gICAgcmV0dXJuIGFycjtcbiAgfTtcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyICQgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi8kJylcbiAgLCBnbG9iYWwgICAgICAgICA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKVxuICAsICRleHBvcnQgICAgICAgID0gcmVxdWlyZSgnLi8kLmV4cG9ydCcpXG4gICwgZmFpbHMgICAgICAgICAgPSByZXF1aXJlKCcuLyQuZmFpbHMnKVxuICAsIGhpZGUgICAgICAgICAgID0gcmVxdWlyZSgnLi8kLmhpZGUnKVxuICAsIHJlZGVmaW5lQWxsICAgID0gcmVxdWlyZSgnLi8kLnJlZGVmaW5lLWFsbCcpXG4gICwgZm9yT2YgICAgICAgICAgPSByZXF1aXJlKCcuLyQuZm9yLW9mJylcbiAgLCBzdHJpY3ROZXcgICAgICA9IHJlcXVpcmUoJy4vJC5zdHJpY3QtbmV3JylcbiAgLCBpc09iamVjdCAgICAgICA9IHJlcXVpcmUoJy4vJC5pcy1vYmplY3QnKVxuICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi8kLnNldC10by1zdHJpbmctdGFnJylcbiAgLCBERVNDUklQVE9SUyAgICA9IHJlcXVpcmUoJy4vJC5kZXNjcmlwdG9ycycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5BTUUsIHdyYXBwZXIsIG1ldGhvZHMsIGNvbW1vbiwgSVNfTUFQLCBJU19XRUFLKXtcbiAgdmFyIEJhc2UgID0gZ2xvYmFsW05BTUVdXG4gICAgLCBDICAgICA9IEJhc2VcbiAgICAsIEFEREVSID0gSVNfTUFQID8gJ3NldCcgOiAnYWRkJ1xuICAgICwgcHJvdG8gPSBDICYmIEMucHJvdG90eXBlXG4gICAgLCBPICAgICA9IHt9O1xuICBpZighREVTQ1JJUFRPUlMgfHwgdHlwZW9mIEMgIT0gJ2Z1bmN0aW9uJyB8fCAhKElTX1dFQUsgfHwgcHJvdG8uZm9yRWFjaCAmJiAhZmFpbHMoZnVuY3Rpb24oKXtcbiAgICBuZXcgQygpLmVudHJpZXMoKS5uZXh0KCk7XG4gIH0pKSl7XG4gICAgLy8gY3JlYXRlIGNvbGxlY3Rpb24gY29uc3RydWN0b3JcbiAgICBDID0gY29tbW9uLmdldENvbnN0cnVjdG9yKHdyYXBwZXIsIE5BTUUsIElTX01BUCwgQURERVIpO1xuICAgIHJlZGVmaW5lQWxsKEMucHJvdG90eXBlLCBtZXRob2RzKTtcbiAgfSBlbHNlIHtcbiAgICBDID0gd3JhcHBlcihmdW5jdGlvbih0YXJnZXQsIGl0ZXJhYmxlKXtcbiAgICAgIHN0cmljdE5ldyh0YXJnZXQsIEMsIE5BTUUpO1xuICAgICAgdGFyZ2V0Ll9jID0gbmV3IEJhc2U7XG4gICAgICBpZihpdGVyYWJsZSAhPSB1bmRlZmluZWQpZm9yT2YoaXRlcmFibGUsIElTX01BUCwgdGFyZ2V0W0FEREVSXSwgdGFyZ2V0KTtcbiAgICB9KTtcbiAgICAkLmVhY2guY2FsbCgnYWRkLGNsZWFyLGRlbGV0ZSxmb3JFYWNoLGdldCxoYXMsc2V0LGtleXMsdmFsdWVzLGVudHJpZXMnLnNwbGl0KCcsJyksZnVuY3Rpb24oS0VZKXtcbiAgICAgIHZhciBJU19BRERFUiA9IEtFWSA9PSAnYWRkJyB8fCBLRVkgPT0gJ3NldCc7XG4gICAgICBpZihLRVkgaW4gcHJvdG8gJiYgIShJU19XRUFLICYmIEtFWSA9PSAnY2xlYXInKSloaWRlKEMucHJvdG90eXBlLCBLRVksIGZ1bmN0aW9uKGEsIGIpe1xuICAgICAgICBpZighSVNfQURERVIgJiYgSVNfV0VBSyAmJiAhaXNPYmplY3QoYSkpcmV0dXJuIEtFWSA9PSAnZ2V0JyA/IHVuZGVmaW5lZCA6IGZhbHNlO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fY1tLRVldKGEgPT09IDAgPyAwIDogYSwgYik7XG4gICAgICAgIHJldHVybiBJU19BRERFUiA/IHRoaXMgOiByZXN1bHQ7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpZignc2l6ZScgaW4gcHJvdG8pJC5zZXREZXNjKEMucHJvdG90eXBlLCAnc2l6ZScsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Muc2l6ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHNldFRvU3RyaW5nVGFnKEMsIE5BTUUpO1xuXG4gIE9bTkFNRV0gPSBDO1xuICAkZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiwgTyk7XG5cbiAgaWYoIUlTX1dFQUspY29tbW9uLnNldFN0cm9uZyhDLCBOQU1FLCBJU19NQVApO1xuXG4gIHJldHVybiBDO1xufTsiLCJ2YXIgY29yZSA9IG1vZHVsZS5leHBvcnRzID0ge3ZlcnNpb246ICcxLjIuNid9O1xuaWYodHlwZW9mIF9fZSA9PSAnbnVtYmVyJylfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmIiwiLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nXG52YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi8kLmEtZnVuY3Rpb24nKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4sIHRoYXQsIGxlbmd0aCl7XG4gIGFGdW5jdGlvbihmbik7XG4gIGlmKHRoYXQgPT09IHVuZGVmaW5lZClyZXR1cm4gZm47XG4gIHN3aXRjaChsZW5ndGgpe1xuICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKGEpe1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7XG4gICAgfTtcbiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbihhLCBiKXtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpO1xuICAgIH07XG4gICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24oYSwgYiwgYyl7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgfTtcbn07IiwiLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudClcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKFwiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIFwiICsgaXQpO1xuICByZXR1cm4gaXQ7XG59OyIsIi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHlcbm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vJC5mYWlscycpKGZ1bmN0aW9uKCl7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIDc7IH19KS5hICE9IDc7XG59KTsiLCJ2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuLyQuaXMtb2JqZWN0JylcbiAgLCBkb2N1bWVudCA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKS5kb2N1bWVudFxuICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCdcbiAgLCBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpe1xuICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9O1xufTsiLCJ2YXIgZ2xvYmFsICAgID0gcmVxdWlyZSgnLi8kLmdsb2JhbCcpXG4gICwgY29yZSAgICAgID0gcmVxdWlyZSgnLi8kLmNvcmUnKVxuICAsIGN0eCAgICAgICA9IHJlcXVpcmUoJy4vJC5jdHgnKVxuICAsIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uKHR5cGUsIG5hbWUsIHNvdXJjZSl7XG4gIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GXG4gICAgLCBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HXG4gICAgLCBJU19TVEFUSUMgPSB0eXBlICYgJGV4cG9ydC5TXG4gICAgLCBJU19QUk9UTyAgPSB0eXBlICYgJGV4cG9ydC5QXG4gICAgLCBJU19CSU5EICAgPSB0eXBlICYgJGV4cG9ydC5CXG4gICAgLCBJU19XUkFQICAgPSB0eXBlICYgJGV4cG9ydC5XXG4gICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KVxuICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIDogKGdsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXVxuICAgICwga2V5LCBvd24sIG91dDtcbiAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7XG4gIGZvcihrZXkgaW4gc291cmNlKXtcbiAgICAvLyBjb250YWlucyBpbiBuYXRpdmVcbiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiBrZXkgaW4gdGFyZ2V0O1xuICAgIGlmKG93biAmJiBrZXkgaW4gZXhwb3J0cyljb250aW51ZTtcbiAgICAvLyBleHBvcnQgbmF0aXZlIG9yIHBhc3NlZFxuICAgIG91dCA9IG93biA/IHRhcmdldFtrZXldIDogc291cmNlW2tleV07XG4gICAgLy8gcHJldmVudCBnbG9iYWwgcG9sbHV0aW9uIGZvciBuYW1lc3BhY2VzXG4gICAgZXhwb3J0c1trZXldID0gSVNfR0xPQkFMICYmIHR5cGVvZiB0YXJnZXRba2V5XSAhPSAnZnVuY3Rpb24nID8gc291cmNlW2tleV1cbiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dFxuICAgIDogSVNfQklORCAmJiBvd24gPyBjdHgob3V0LCBnbG9iYWwpXG4gICAgLy8gd3JhcCBnbG9iYWwgY29uc3RydWN0b3JzIGZvciBwcmV2ZW50IGNoYW5nZSB0aGVtIGluIGxpYnJhcnlcbiAgICA6IElTX1dSQVAgJiYgdGFyZ2V0W2tleV0gPT0gb3V0ID8gKGZ1bmN0aW9uKEMpe1xuICAgICAgdmFyIEYgPSBmdW5jdGlvbihwYXJhbSl7XG4gICAgICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgQyA/IG5ldyBDKHBhcmFtKSA6IEMocGFyYW0pO1xuICAgICAgfTtcbiAgICAgIEZbUFJPVE9UWVBFXSA9IENbUFJPVE9UWVBFXTtcbiAgICAgIHJldHVybiBGO1xuICAgIC8vIG1ha2Ugc3RhdGljIHZlcnNpb25zIGZvciBwcm90b3R5cGUgbWV0aG9kc1xuICAgIH0pKG91dCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBjdHgoRnVuY3Rpb24uY2FsbCwgb3V0KSA6IG91dDtcbiAgICBpZihJU19QUk9UTykoZXhwb3J0c1tQUk9UT1RZUEVdIHx8IChleHBvcnRzW1BST1RPVFlQRV0gPSB7fSkpW2tleV0gPSBvdXQ7XG4gIH1cbn07XG4vLyB0eXBlIGJpdG1hcFxuJGV4cG9ydC5GID0gMTsgIC8vIGZvcmNlZFxuJGV4cG9ydC5HID0gMjsgIC8vIGdsb2JhbFxuJGV4cG9ydC5TID0gNDsgIC8vIHN0YXRpY1xuJGV4cG9ydC5QID0gODsgIC8vIHByb3RvXG4kZXhwb3J0LkIgPSAxNjsgLy8gYmluZFxuJGV4cG9ydC5XID0gMzI7IC8vIHdyYXBcbm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMpe1xuICB0cnkge1xuICAgIHJldHVybiAhIWV4ZWMoKTtcbiAgfSBjYXRjaChlKXtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTsiLCJ2YXIgY3R4ICAgICAgICAgPSByZXF1aXJlKCcuLyQuY3R4JylcbiAgLCBjYWxsICAgICAgICA9IHJlcXVpcmUoJy4vJC5pdGVyLWNhbGwnKVxuICAsIGlzQXJyYXlJdGVyID0gcmVxdWlyZSgnLi8kLmlzLWFycmF5LWl0ZXInKVxuICAsIGFuT2JqZWN0ICAgID0gcmVxdWlyZSgnLi8kLmFuLW9iamVjdCcpXG4gICwgdG9MZW5ndGggICAgPSByZXF1aXJlKCcuLyQudG8tbGVuZ3RoJylcbiAgLCBnZXRJdGVyRm4gICA9IHJlcXVpcmUoJy4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCl7XG4gIHZhciBpdGVyRm4gPSBnZXRJdGVyRm4oaXRlcmFibGUpXG4gICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSlcbiAgICAsIGluZGV4ICA9IDBcbiAgICAsIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3I7XG4gIGlmKHR5cGVvZiBpdGVyRm4gIT0gJ2Z1bmN0aW9uJyl0aHJvdyBUeXBlRXJyb3IoaXRlcmFibGUgKyAnIGlzIG5vdCBpdGVyYWJsZSEnKTtcbiAgLy8gZmFzdCBjYXNlIGZvciBhcnJheXMgd2l0aCBkZWZhdWx0IGl0ZXJhdG9yXG4gIGlmKGlzQXJyYXlJdGVyKGl0ZXJGbikpZm9yKGxlbmd0aCA9IHRvTGVuZ3RoKGl0ZXJhYmxlLmxlbmd0aCk7IGxlbmd0aCA+IGluZGV4OyBpbmRleCsrKXtcbiAgICBlbnRyaWVzID8gZihhbk9iamVjdChzdGVwID0gaXRlcmFibGVbaW5kZXhdKVswXSwgc3RlcFsxXSkgOiBmKGl0ZXJhYmxlW2luZGV4XSk7XG4gIH0gZWxzZSBmb3IoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgKXtcbiAgICBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTtcbiAgfVxufTsiLCIvLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxudmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoXG4gID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmIiwidmFyIGhhc093blByb3BlcnR5ID0ge30uaGFzT3duUHJvcGVydHk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBrZXkpe1xuICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTtcbn07IiwidmFyICQgICAgICAgICAgPSByZXF1aXJlKCcuLyQnKVxuICAsIGNyZWF0ZURlc2MgPSByZXF1aXJlKCcuLyQucHJvcGVydHktZGVzYycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLyQuZGVzY3JpcHRvcnMnKSA/IGZ1bmN0aW9uKG9iamVjdCwga2V5LCB2YWx1ZSl7XG4gIHJldHVybiAkLnNldERlc2Mob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTtcbn0gOiBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpe1xuICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICByZXR1cm4gb2JqZWN0O1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7IiwiLy8gZmFzdCBhcHBseSwgaHR0cDovL2pzcGVyZi5sbmtpdC5jb20vZmFzdC1hcHBseS81XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXtcbiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkO1xuICBzd2l0Y2goYXJncy5sZW5ndGgpe1xuICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTtcbiAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pO1xuICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSlcbiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKVxuICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pXG4gICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pO1xuICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7XG59OyIsIi8vIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgYW5kIG5vbi1lbnVtZXJhYmxlIG9sZCBWOCBzdHJpbmdzXG52YXIgY29mID0gcmVxdWlyZSgnLi8kLmNvZicpO1xubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGNvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpO1xufTsiLCIvLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yXG52YXIgSXRlcmF0b3JzICA9IHJlcXVpcmUoJy4vJC5pdGVyYXRvcnMnKVxuICAsIElURVJBVE9SICAgPSByZXF1aXJlKCcuLyQud2tzJykoJ2l0ZXJhdG9yJylcbiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiB0eXBlb2YgaXQgPT09ICdvYmplY3QnID8gaXQgIT09IG51bGwgOiB0eXBlb2YgaXQgPT09ICdmdW5jdGlvbic7XG59OyIsIi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3JcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vJC5hbi1vYmplY3QnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcyl7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTtcbiAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbilcbiAgfSBjYXRjaChlKXtcbiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddO1xuICAgIGlmKHJldCAhPT0gdW5kZWZpbmVkKWFuT2JqZWN0KHJldC5jYWxsKGl0ZXJhdG9yKSk7XG4gICAgdGhyb3cgZTtcbiAgfVxufTsiLCIndXNlIHN0cmljdCc7XG52YXIgJCAgICAgICAgICAgICAgPSByZXF1aXJlKCcuLyQnKVxuICAsIGRlc2NyaXB0b3IgICAgID0gcmVxdWlyZSgnLi8kLnByb3BlcnR5LWRlc2MnKVxuICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi8kLnNldC10by1zdHJpbmctdGFnJylcbiAgLCBJdGVyYXRvclByb3RvdHlwZSA9IHt9O1xuXG4vLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKVxucmVxdWlyZSgnLi8kLmhpZGUnKShJdGVyYXRvclByb3RvdHlwZSwgcmVxdWlyZSgnLi8kLndrcycpKCdpdGVyYXRvcicpLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpe1xuICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSAkLmNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwge25leHQ6IGRlc2NyaXB0b3IoMSwgbmV4dCl9KTtcbiAgc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7XG59OyIsIid1c2Ugc3RyaWN0JztcbnZhciBMSUJSQVJZICAgICAgICA9IHJlcXVpcmUoJy4vJC5saWJyYXJ5JylcbiAgLCAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vJC5leHBvcnQnKVxuICAsIHJlZGVmaW5lICAgICAgID0gcmVxdWlyZSgnLi8kLnJlZGVmaW5lJylcbiAgLCBoaWRlICAgICAgICAgICA9IHJlcXVpcmUoJy4vJC5oaWRlJylcbiAgLCBoYXMgICAgICAgICAgICA9IHJlcXVpcmUoJy4vJC5oYXMnKVxuICAsIEl0ZXJhdG9ycyAgICAgID0gcmVxdWlyZSgnLi8kLml0ZXJhdG9ycycpXG4gICwgJGl0ZXJDcmVhdGUgICAgPSByZXF1aXJlKCcuLyQuaXRlci1jcmVhdGUnKVxuICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi8kLnNldC10by1zdHJpbmctdGFnJylcbiAgLCBnZXRQcm90byAgICAgICA9IHJlcXVpcmUoJy4vJCcpLmdldFByb3RvXG4gICwgSVRFUkFUT1IgICAgICAgPSByZXF1aXJlKCcuLyQud2tzJykoJ2l0ZXJhdG9yJylcbiAgLCBCVUdHWSAgICAgICAgICA9ICEoW10ua2V5cyAmJiAnbmV4dCcgaW4gW10ua2V5cygpKSAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgXG4gICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcidcbiAgLCBLRVlTICAgICAgICAgICA9ICdrZXlzJ1xuICAsIFZBTFVFUyAgICAgICAgID0gJ3ZhbHVlcyc7XG5cbnZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXtcbiAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpO1xuICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24oa2luZCl7XG4gICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdO1xuICAgIHN3aXRjaChraW5kKXtcbiAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICB9O1xuICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJ1xuICAgICwgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTXG4gICAgLCBWQUxVRVNfQlVHID0gZmFsc2VcbiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZVxuICAgICwgJG5hdGl2ZSAgICA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXVxuICAgICwgJGRlZmF1bHQgICA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpXG4gICAgLCBtZXRob2RzLCBrZXk7XG4gIC8vIEZpeCBuYXRpdmVcbiAgaWYoJG5hdGl2ZSl7XG4gICAgdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG8oJGRlZmF1bHQuY2FsbChuZXcgQmFzZSkpO1xuICAgIC8vIFNldCBAQHRvU3RyaW5nVGFnIHRvIG5hdGl2ZSBpdGVyYXRvcnNcbiAgICBzZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTtcbiAgICAvLyBGRiBmaXhcbiAgICBpZighTElCUkFSWSAmJiBoYXMocHJvdG8sIEZGX0lURVJBVE9SKSloaWRlKEl0ZXJhdG9yUHJvdG90eXBlLCBJVEVSQVRPUiwgcmV0dXJuVGhpcyk7XG4gICAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRlxuICAgIGlmKERFRl9WQUxVRVMgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpe1xuICAgICAgVkFMVUVTX0JVRyA9IHRydWU7XG4gICAgICAkZGVmYXVsdCA9IGZ1bmN0aW9uIHZhbHVlcygpeyByZXR1cm4gJG5hdGl2ZS5jYWxsKHRoaXMpOyB9O1xuICAgIH1cbiAgfVxuICAvLyBEZWZpbmUgaXRlcmF0b3JcbiAgaWYoKCFMSUJSQVJZIHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpe1xuICAgIGhpZGUocHJvdG8sIElURVJBVE9SLCAkZGVmYXVsdCk7XG4gIH1cbiAgLy8gUGx1ZyBmb3IgbGlicmFyeVxuICBJdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDtcbiAgSXRlcmF0b3JzW1RBR10gID0gcmV0dXJuVGhpcztcbiAgaWYoREVGQVVMVCl7XG4gICAgbWV0aG9kcyA9IHtcbiAgICAgIHZhbHVlczogIERFRl9WQUxVRVMgID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSxcbiAgICAgIGtleXM6ICAgIElTX1NFVCAgICAgID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoS0VZUyksXG4gICAgICBlbnRyaWVzOiAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJylcbiAgICB9O1xuICAgIGlmKEZPUkNFRClmb3Ioa2V5IGluIG1ldGhvZHMpe1xuICAgICAgaWYoIShrZXkgaW4gcHJvdG8pKXJlZGVmaW5lKHByb3RvLCBrZXksIG1ldGhvZHNba2V5XSk7XG4gICAgfSBlbHNlICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKEJVR0dZIHx8IFZBTFVFU19CVUcpLCBOQU1FLCBtZXRob2RzKTtcbiAgfVxuICByZXR1cm4gbWV0aG9kcztcbn07IiwidmFyIElURVJBVE9SICAgICA9IHJlcXVpcmUoJy4vJC53a3MnKSgnaXRlcmF0b3InKVxuICAsIFNBRkVfQ0xPU0lORyA9IGZhbHNlO1xuXG50cnkge1xuICB2YXIgcml0ZXIgPSBbN11bSVRFUkFUT1JdKCk7XG4gIHJpdGVyWydyZXR1cm4nXSA9IGZ1bmN0aW9uKCl7IFNBRkVfQ0xPU0lORyA9IHRydWU7IH07XG4gIEFycmF5LmZyb20ocml0ZXIsIGZ1bmN0aW9uKCl7IHRocm93IDI7IH0pO1xufSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV4ZWMsIHNraXBDbG9zaW5nKXtcbiAgaWYoIXNraXBDbG9zaW5nICYmICFTQUZFX0NMT1NJTkcpcmV0dXJuIGZhbHNlO1xuICB2YXIgc2FmZSA9IGZhbHNlO1xuICB0cnkge1xuICAgIHZhciBhcnIgID0gWzddXG4gICAgICAsIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7XG4gICAgaXRlci5uZXh0ID0gZnVuY3Rpb24oKXsgcmV0dXJuIHtkb25lOiBzYWZlID0gdHJ1ZX07IH07XG4gICAgYXJyW0lURVJBVE9SXSA9IGZ1bmN0aW9uKCl7IHJldHVybiBpdGVyOyB9O1xuICAgIGV4ZWMoYXJyKTtcbiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfVxuICByZXR1cm4gc2FmZTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihkb25lLCB2YWx1ZSl7XG4gIHJldHVybiB7dmFsdWU6IHZhbHVlLCBkb25lOiAhIWRvbmV9O1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IHt9OyIsInZhciAkT2JqZWN0ID0gT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNyZWF0ZTogICAgICRPYmplY3QuY3JlYXRlLFxuICBnZXRQcm90bzogICAkT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICBpc0VudW06ICAgICB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgZ2V0RGVzYzogICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gIHNldERlc2M6ICAgICRPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gIHNldERlc2NzOiAgICRPYmplY3QuZGVmaW5lUHJvcGVydGllcyxcbiAgZ2V0S2V5czogICAgJE9iamVjdC5rZXlzLFxuICBnZXROYW1lczogICAkT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gIGdldFN5bWJvbHM6ICRPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzLFxuICBlYWNoOiAgICAgICBbXS5mb3JFYWNoXG59OyIsIm1vZHVsZS5leHBvcnRzID0gdHJ1ZTsiLCJ2YXIgZ2xvYmFsICAgID0gcmVxdWlyZSgnLi8kLmdsb2JhbCcpXG4gICwgbWFjcm90YXNrID0gcmVxdWlyZSgnLi8kLnRhc2snKS5zZXRcbiAgLCBPYnNlcnZlciAgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlclxuICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzXG4gICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2VcbiAgLCBpc05vZGUgICAgPSByZXF1aXJlKCcuLyQuY29mJykocHJvY2VzcykgPT0gJ3Byb2Nlc3MnXG4gICwgaGVhZCwgbGFzdCwgbm90aWZ5O1xuXG52YXIgZmx1c2ggPSBmdW5jdGlvbigpe1xuICB2YXIgcGFyZW50LCBkb21haW4sIGZuO1xuICBpZihpc05vZGUgJiYgKHBhcmVudCA9IHByb2Nlc3MuZG9tYWluKSl7XG4gICAgcHJvY2Vzcy5kb21haW4gPSBudWxsO1xuICAgIHBhcmVudC5leGl0KCk7XG4gIH1cbiAgd2hpbGUoaGVhZCl7XG4gICAgZG9tYWluID0gaGVhZC5kb21haW47XG4gICAgZm4gICAgID0gaGVhZC5mbjtcbiAgICBpZihkb21haW4pZG9tYWluLmVudGVyKCk7XG4gICAgZm4oKTsgLy8gPC0gY3VycmVudGx5IHdlIHVzZSBpdCBvbmx5IGZvciBQcm9taXNlIC0gdHJ5IC8gY2F0Y2ggbm90IHJlcXVpcmVkXG4gICAgaWYoZG9tYWluKWRvbWFpbi5leGl0KCk7XG4gICAgaGVhZCA9IGhlYWQubmV4dDtcbiAgfSBsYXN0ID0gdW5kZWZpbmVkO1xuICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7XG59O1xuXG4vLyBOb2RlLmpzXG5pZihpc05vZGUpe1xuICBub3RpZnkgPSBmdW5jdGlvbigpe1xuICAgIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpO1xuICB9O1xuLy8gYnJvd3NlcnMgd2l0aCBNdXRhdGlvbk9ic2VydmVyXG59IGVsc2UgaWYoT2JzZXJ2ZXIpe1xuICB2YXIgdG9nZ2xlID0gMVxuICAgICwgbm9kZSAgID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xuICBuZXcgT2JzZXJ2ZXIoZmx1c2gpLm9ic2VydmUobm9kZSwge2NoYXJhY3RlckRhdGE6IHRydWV9KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXdcbiAgbm90aWZ5ID0gZnVuY3Rpb24oKXtcbiAgICBub2RlLmRhdGEgPSB0b2dnbGUgPSAtdG9nZ2xlO1xuICB9O1xuLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2Vcbn0gZWxzZSBpZihQcm9taXNlICYmIFByb21pc2UucmVzb2x2ZSl7XG4gIG5vdGlmeSA9IGZ1bmN0aW9uKCl7XG4gICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmbHVzaCk7XG4gIH07XG4vLyBmb3Igb3RoZXIgZW52aXJvbm1lbnRzIC0gbWFjcm90YXNrIGJhc2VkIG9uOlxuLy8gLSBzZXRJbW1lZGlhdGVcbi8vIC0gTWVzc2FnZUNoYW5uZWxcbi8vIC0gd2luZG93LnBvc3RNZXNzYWdcbi8vIC0gb25yZWFkeXN0YXRlY2hhbmdlXG4vLyAtIHNldFRpbWVvdXRcbn0gZWxzZSB7XG4gIG5vdGlmeSA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKVxuICAgIG1hY3JvdGFzay5jYWxsKGdsb2JhbCwgZmx1c2gpO1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGFzYXAoZm4pe1xuICB2YXIgdGFzayA9IHtmbjogZm4sIG5leHQ6IHVuZGVmaW5lZCwgZG9tYWluOiBpc05vZGUgJiYgcHJvY2Vzcy5kb21haW59O1xuICBpZihsYXN0KWxhc3QubmV4dCA9IHRhc2s7XG4gIGlmKCFoZWFkKXtcbiAgICBoZWFkID0gdGFzaztcbiAgICBub3RpZnkoKTtcbiAgfSBsYXN0ID0gdGFzaztcbn07IiwiLy8gMTkuMS4yLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSwgLi4uKVxudmFyICQgICAgICAgID0gcmVxdWlyZSgnLi8kJylcbiAgLCB0b09iamVjdCA9IHJlcXVpcmUoJy4vJC50by1vYmplY3QnKVxuICAsIElPYmplY3QgID0gcmVxdWlyZSgnLi8kLmlvYmplY3QnKTtcblxuLy8gc2hvdWxkIHdvcmsgd2l0aCBzeW1ib2xzIGFuZCBzaG91bGQgaGF2ZSBkZXRlcm1pbmlzdGljIHByb3BlcnR5IG9yZGVyIChWOCBidWcpXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vJC5mYWlscycpKGZ1bmN0aW9uKCl7XG4gIHZhciBhID0gT2JqZWN0LmFzc2lnblxuICAgICwgQSA9IHt9XG4gICAgLCBCID0ge31cbiAgICAsIFMgPSBTeW1ib2woKVxuICAgICwgSyA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdCc7XG4gIEFbU10gPSA3O1xuICBLLnNwbGl0KCcnKS5mb3JFYWNoKGZ1bmN0aW9uKGspeyBCW2tdID0gazsgfSk7XG4gIHJldHVybiBhKHt9LCBBKVtTXSAhPSA3IHx8IE9iamVjdC5rZXlzKGEoe30sIEIpKS5qb2luKCcnKSAhPSBLO1xufSkgPyBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCBzb3VyY2UpeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXG4gIHZhciBUICAgICA9IHRvT2JqZWN0KHRhcmdldClcbiAgICAsICQkICAgID0gYXJndW1lbnRzXG4gICAgLCAkJGxlbiA9ICQkLmxlbmd0aFxuICAgICwgaW5kZXggPSAxXG4gICAgLCBnZXRLZXlzICAgID0gJC5nZXRLZXlzXG4gICAgLCBnZXRTeW1ib2xzID0gJC5nZXRTeW1ib2xzXG4gICAgLCBpc0VudW0gICAgID0gJC5pc0VudW07XG4gIHdoaWxlKCQkbGVuID4gaW5kZXgpe1xuICAgIHZhciBTICAgICAgPSBJT2JqZWN0KCQkW2luZGV4KytdKVxuICAgICAgLCBrZXlzICAgPSBnZXRTeW1ib2xzID8gZ2V0S2V5cyhTKS5jb25jYXQoZ2V0U3ltYm9scyhTKSkgOiBnZXRLZXlzKFMpXG4gICAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoXG4gICAgICAsIGogICAgICA9IDBcbiAgICAgICwga2V5O1xuICAgIHdoaWxlKGxlbmd0aCA+IGopaWYoaXNFbnVtLmNhbGwoUywga2V5ID0ga2V5c1tqKytdKSlUW2tleV0gPSBTW2tleV07XG4gIH1cbiAgcmV0dXJuIFQ7XG59IDogT2JqZWN0LmFzc2lnbjsiLCIvLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXNcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi8kLmV4cG9ydCcpXG4gICwgY29yZSAgICA9IHJlcXVpcmUoJy4vJC5jb3JlJylcbiAgLCBmYWlscyAgID0gcmVxdWlyZSgnLi8kLmZhaWxzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEtFWSwgZXhlYyl7XG4gIHZhciBmbiAgPSAoY29yZS5PYmplY3QgfHwge30pW0tFWV0gfHwgT2JqZWN0W0tFWV1cbiAgICAsIGV4cCA9IHt9O1xuICBleHBbS0VZXSA9IGV4ZWMoZm4pO1xuICAkZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIGZhaWxzKGZ1bmN0aW9uKCl7IGZuKDEpOyB9KSwgJ09iamVjdCcsIGV4cCk7XG59OyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7XG4gIHJldHVybiB7XG4gICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLFxuICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSxcbiAgICB3cml0YWJsZSAgICA6ICEoYml0bWFwICYgNCksXG4gICAgdmFsdWUgICAgICAgOiB2YWx1ZVxuICB9O1xufTsiLCJ2YXIgcmVkZWZpbmUgPSByZXF1aXJlKCcuLyQucmVkZWZpbmUnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGFyZ2V0LCBzcmMpe1xuICBmb3IodmFyIGtleSBpbiBzcmMpcmVkZWZpbmUodGFyZ2V0LCBrZXksIHNyY1trZXldKTtcbiAgcmV0dXJuIHRhcmdldDtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLyQuaGlkZScpOyIsIi8vIDcuMi45IFNhbWVWYWx1ZSh4LCB5KVxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuaXMgfHwgZnVuY3Rpb24gaXMoeCwgeSl7XG4gIHJldHVybiB4ID09PSB5ID8geCAhPT0gMCB8fCAxIC8geCA9PT0gMSAvIHkgOiB4ICE9IHggJiYgeSAhPSB5O1xufTsiLCIvLyBXb3JrcyB3aXRoIF9fcHJvdG9fXyBvbmx5LiBPbGQgdjggY2FuJ3Qgd29yayB3aXRoIG51bGwgcHJvdG8gb2JqZWN0cy5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG52YXIgZ2V0RGVzYyAgPSByZXF1aXJlKCcuLyQnKS5nZXREZXNjXG4gICwgaXNPYmplY3QgPSByZXF1aXJlKCcuLyQuaXMtb2JqZWN0JylcbiAgLCBhbk9iamVjdCA9IHJlcXVpcmUoJy4vJC5hbi1vYmplY3QnKTtcbnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXtcbiAgYW5PYmplY3QoTyk7XG4gIGlmKCFpc09iamVjdChwcm90bykgJiYgcHJvdG8gIT09IG51bGwpdGhyb3cgVHlwZUVycm9yKHByb3RvICsgXCI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhXCIpO1xufTtcbm1vZHVsZS5leHBvcnRzID0ge1xuICBzZXQ6IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCAoJ19fcHJvdG9fXycgaW4ge30gPyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgZnVuY3Rpb24odGVzdCwgYnVnZ3ksIHNldCl7XG4gICAgICB0cnkge1xuICAgICAgICBzZXQgPSByZXF1aXJlKCcuLyQuY3R4JykoRnVuY3Rpb24uY2FsbCwgZ2V0RGVzYyhPYmplY3QucHJvdG90eXBlLCAnX19wcm90b19fJykuc2V0LCAyKTtcbiAgICAgICAgc2V0KHRlc3QsIFtdKTtcbiAgICAgICAgYnVnZ3kgPSAhKHRlc3QgaW5zdGFuY2VvZiBBcnJheSk7XG4gICAgICB9IGNhdGNoKGUpeyBidWdneSA9IHRydWU7IH1cbiAgICAgIHJldHVybiBmdW5jdGlvbiBzZXRQcm90b3R5cGVPZihPLCBwcm90byl7XG4gICAgICAgIGNoZWNrKE8sIHByb3RvKTtcbiAgICAgICAgaWYoYnVnZ3kpTy5fX3Byb3RvX18gPSBwcm90bztcbiAgICAgICAgZWxzZSBzZXQoTywgcHJvdG8pO1xuICAgICAgICByZXR1cm4gTztcbiAgICAgIH07XG4gICAgfSh7fSwgZmFsc2UpIDogdW5kZWZpbmVkKSxcbiAgY2hlY2s6IGNoZWNrXG59OyIsIid1c2Ugc3RyaWN0JztcbnZhciBjb3JlICAgICAgICA9IHJlcXVpcmUoJy4vJC5jb3JlJylcbiAgLCAkICAgICAgICAgICA9IHJlcXVpcmUoJy4vJCcpXG4gICwgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuLyQuZGVzY3JpcHRvcnMnKVxuICAsIFNQRUNJRVMgICAgID0gcmVxdWlyZSgnLi8kLndrcycpKCdzcGVjaWVzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXtcbiAgdmFyIEMgPSBjb3JlW0tFWV07XG4gIGlmKERFU0NSSVBUT1JTICYmIEMgJiYgIUNbU1BFQ0lFU10pJC5zZXREZXNjKEMsIFNQRUNJRVMsIHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfVxuICB9KTtcbn07IiwidmFyIGRlZiA9IHJlcXVpcmUoJy4vJCcpLnNldERlc2NcbiAgLCBoYXMgPSByZXF1aXJlKCcuLyQuaGFzJylcbiAgLCBUQUcgPSByZXF1aXJlKCcuLyQud2tzJykoJ3RvU3RyaW5nVGFnJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIHRhZywgc3RhdCl7XG4gIGlmKGl0ICYmICFoYXMoaXQgPSBzdGF0ID8gaXQgOiBpdC5wcm90b3R5cGUsIFRBRykpZGVmKGl0LCBUQUcsIHtjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWd9KTtcbn07IiwidmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKVxuICAsIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nXG4gICwgc3RvcmUgID0gZ2xvYmFsW1NIQVJFRF0gfHwgKGdsb2JhbFtTSEFSRURdID0ge30pO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpe1xuICByZXR1cm4gc3RvcmVba2V5XSB8fCAoc3RvcmVba2V5XSA9IHt9KTtcbn07IiwiLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpXG52YXIgYW5PYmplY3QgID0gcmVxdWlyZSgnLi8kLmFuLW9iamVjdCcpXG4gICwgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi8kLmEtZnVuY3Rpb24nKVxuICAsIFNQRUNJRVMgICA9IHJlcXVpcmUoJy4vJC53a3MnKSgnc3BlY2llcycpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihPLCBEKXtcbiAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUztcbiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSl7XG4gIGlmKCEoaXQgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpdGhyb3cgVHlwZUVycm9yKG5hbWUgKyBcIjogdXNlIHRoZSAnbmV3JyBvcGVyYXRvciFcIik7XG4gIHJldHVybiBpdDtcbn07IiwidmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vJC50by1pbnRlZ2VyJylcbiAgLCBkZWZpbmVkICAgPSByZXF1aXJlKCcuLyQuZGVmaW5lZCcpO1xuLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0XG4vLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXRcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVE9fU1RSSU5HKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRoYXQsIHBvcyl7XG4gICAgdmFyIHMgPSBTdHJpbmcoZGVmaW5lZCh0aGF0KSlcbiAgICAgICwgaSA9IHRvSW50ZWdlcihwb3MpXG4gICAgICAsIGwgPSBzLmxlbmd0aFxuICAgICAgLCBhLCBiO1xuICAgIGlmKGkgPCAwIHx8IGkgPj0gbClyZXR1cm4gVE9fU1RSSU5HID8gJycgOiB1bmRlZmluZWQ7XG4gICAgYSA9IHMuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gYSA8IDB4ZDgwMCB8fCBhID4gMHhkYmZmIHx8IGkgKyAxID09PSBsIHx8IChiID0gcy5jaGFyQ29kZUF0KGkgKyAxKSkgPCAweGRjMDAgfHwgYiA+IDB4ZGZmZlxuICAgICAgPyBUT19TVFJJTkcgPyBzLmNoYXJBdChpKSA6IGFcbiAgICAgIDogVE9fU1RSSU5HID8gcy5zbGljZShpLCBpICsgMikgOiAoYSAtIDB4ZDgwMCA8PCAxMCkgKyAoYiAtIDB4ZGMwMCkgKyAweDEwMDAwO1xuICB9O1xufTsiLCJ2YXIgY3R4ICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi8kLmN0eCcpXG4gICwgaW52b2tlICAgICAgICAgICAgID0gcmVxdWlyZSgnLi8kLmludm9rZScpXG4gICwgaHRtbCAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi8kLmh0bWwnKVxuICAsIGNlbCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vJC5kb20tY3JlYXRlJylcbiAgLCBnbG9iYWwgICAgICAgICAgICAgPSByZXF1aXJlKCcuLyQuZ2xvYmFsJylcbiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2Vzc1xuICAsIHNldFRhc2sgICAgICAgICAgICA9IGdsb2JhbC5zZXRJbW1lZGlhdGVcbiAgLCBjbGVhclRhc2sgICAgICAgICAgPSBnbG9iYWwuY2xlYXJJbW1lZGlhdGVcbiAgLCBNZXNzYWdlQ2hhbm5lbCAgICAgPSBnbG9iYWwuTWVzc2FnZUNoYW5uZWxcbiAgLCBjb3VudGVyICAgICAgICAgICAgPSAwXG4gICwgcXVldWUgICAgICAgICAgICAgID0ge31cbiAgLCBPTlJFQURZU1RBVEVDSEFOR0UgPSAnb25yZWFkeXN0YXRlY2hhbmdlJ1xuICAsIGRlZmVyLCBjaGFubmVsLCBwb3J0O1xudmFyIHJ1biA9IGZ1bmN0aW9uKCl7XG4gIHZhciBpZCA9ICt0aGlzO1xuICBpZihxdWV1ZS5oYXNPd25Qcm9wZXJ0eShpZCkpe1xuICAgIHZhciBmbiA9IHF1ZXVlW2lkXTtcbiAgICBkZWxldGUgcXVldWVbaWRdO1xuICAgIGZuKCk7XG4gIH1cbn07XG52YXIgbGlzdG5lciA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgcnVuLmNhbGwoZXZlbnQuZGF0YSk7XG59O1xuLy8gTm9kZS5qcyAwLjkrICYgSUUxMCsgaGFzIHNldEltbWVkaWF0ZSwgb3RoZXJ3aXNlOlxuaWYoIXNldFRhc2sgfHwgIWNsZWFyVGFzayl7XG4gIHNldFRhc2sgPSBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoZm4pe1xuICAgIHZhciBhcmdzID0gW10sIGkgPSAxO1xuICAgIHdoaWxlKGFyZ3VtZW50cy5sZW5ndGggPiBpKWFyZ3MucHVzaChhcmd1bWVudHNbaSsrXSk7XG4gICAgcXVldWVbKytjb3VudGVyXSA9IGZ1bmN0aW9uKCl7XG4gICAgICBpbnZva2UodHlwZW9mIGZuID09ICdmdW5jdGlvbicgPyBmbiA6IEZ1bmN0aW9uKGZuKSwgYXJncyk7XG4gICAgfTtcbiAgICBkZWZlcihjb3VudGVyKTtcbiAgICByZXR1cm4gY291bnRlcjtcbiAgfTtcbiAgY2xlYXJUYXNrID0gZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaWQpe1xuICAgIGRlbGV0ZSBxdWV1ZVtpZF07XG4gIH07XG4gIC8vIE5vZGUuanMgMC44LVxuICBpZihyZXF1aXJlKCcuLyQuY29mJykocHJvY2VzcykgPT0gJ3Byb2Nlc3MnKXtcbiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgIHByb2Nlc3MubmV4dFRpY2soY3R4KHJ1biwgaWQsIDEpKTtcbiAgICB9O1xuICAvLyBCcm93c2VycyB3aXRoIE1lc3NhZ2VDaGFubmVsLCBpbmNsdWRlcyBXZWJXb3JrZXJzXG4gIH0gZWxzZSBpZihNZXNzYWdlQ2hhbm5lbCl7XG4gICAgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbDtcbiAgICBwb3J0ICAgID0gY2hhbm5lbC5wb3J0MjtcbiAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGxpc3RuZXI7XG4gICAgZGVmZXIgPSBjdHgocG9ydC5wb3N0TWVzc2FnZSwgcG9ydCwgMSk7XG4gIC8vIEJyb3dzZXJzIHdpdGggcG9zdE1lc3NhZ2UsIHNraXAgV2ViV29ya2Vyc1xuICAvLyBJRTggaGFzIHBvc3RNZXNzYWdlLCBidXQgaXQncyBzeW5jICYgdHlwZW9mIGl0cyBwb3N0TWVzc2FnZSBpcyAnb2JqZWN0J1xuICB9IGVsc2UgaWYoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIgJiYgdHlwZW9mIHBvc3RNZXNzYWdlID09ICdmdW5jdGlvbicgJiYgIWdsb2JhbC5pbXBvcnRTY3JpcHRzKXtcbiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShpZCArICcnLCAnKicpO1xuICAgIH07XG4gICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0bmVyLCBmYWxzZSk7XG4gIC8vIElFOC1cbiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXtcbiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgICAgIHJ1bi5jYWxsKGlkKTtcbiAgICAgIH07XG4gICAgfTtcbiAgLy8gUmVzdCBvbGQgYnJvd3NlcnNcbiAgfSBlbHNlIHtcbiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTtcbiAgICB9O1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2V0OiAgIHNldFRhc2ssXG4gIGNsZWFyOiBjbGVhclRhc2tcbn07IiwiLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCAgPSBNYXRoLmNlaWxcbiAgLCBmbG9vciA9IE1hdGguZmxvb3I7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGlzTmFOKGl0ID0gK2l0KSA/IDAgOiAoaXQgPiAwID8gZmxvb3IgOiBjZWlsKShpdCk7XG59OyIsIi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5nc1xudmFyIElPYmplY3QgPSByZXF1aXJlKCcuLyQuaW9iamVjdCcpXG4gICwgZGVmaW5lZCA9IHJlcXVpcmUoJy4vJC5kZWZpbmVkJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIElPYmplY3QoZGVmaW5lZChpdCkpO1xufTsiLCIvLyA3LjEuMTUgVG9MZW5ndGhcbnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuLyQudG8taW50ZWdlcicpXG4gICwgbWluICAgICAgID0gTWF0aC5taW47XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXtcbiAgcmV0dXJuIGl0ID4gMCA/IG1pbih0b0ludGVnZXIoaXQpLCAweDFmZmZmZmZmZmZmZmZmKSA6IDA7IC8vIHBvdygyLCA1MykgLSAxID09IDkwMDcxOTkyNTQ3NDA5OTFcbn07IiwiLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KVxudmFyIGRlZmluZWQgPSByZXF1aXJlKCcuLyQuZGVmaW5lZCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7XG4gIHJldHVybiBPYmplY3QoZGVmaW5lZChpdCkpO1xufTsiLCJ2YXIgaWQgPSAwXG4gICwgcHggPSBNYXRoLnJhbmRvbSgpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpe1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTsiLCJ2YXIgc3RvcmUgID0gcmVxdWlyZSgnLi8kLnNoYXJlZCcpKCd3a3MnKVxuICAsIHVpZCAgICA9IHJlcXVpcmUoJy4vJC51aWQnKVxuICAsIFN5bWJvbCA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKS5TeW1ib2w7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpe1xuICByZXR1cm4gc3RvcmVbbmFtZV0gfHwgKHN0b3JlW25hbWVdID1cbiAgICBTeW1ib2wgJiYgU3ltYm9sW25hbWVdIHx8IChTeW1ib2wgfHwgdWlkKSgnU3ltYm9sLicgKyBuYW1lKSk7XG59OyIsInZhciBjbGFzc29mICAgPSByZXF1aXJlKCcuLyQuY2xhc3NvZicpXG4gICwgSVRFUkFUT1IgID0gcmVxdWlyZSgnLi8kLndrcycpKCdpdGVyYXRvcicpXG4gICwgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi8kLml0ZXJhdG9ycycpO1xubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLyQuY29yZScpLmdldEl0ZXJhdG9yTWV0aG9kID0gZnVuY3Rpb24oaXQpe1xuICBpZihpdCAhPSB1bmRlZmluZWQpcmV0dXJuIGl0W0lURVJBVE9SXVxuICAgIHx8IGl0WydAQGl0ZXJhdG9yJ11cbiAgICB8fCBJdGVyYXRvcnNbY2xhc3NvZihpdCldO1xufTsiLCJ2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuLyQuYW4tb2JqZWN0JylcbiAgLCBnZXQgICAgICA9IHJlcXVpcmUoJy4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vJC5jb3JlJykuZ2V0SXRlcmF0b3IgPSBmdW5jdGlvbihpdCl7XG4gIHZhciBpdGVyRm4gPSBnZXQoaXQpO1xuICBpZih0eXBlb2YgaXRlckZuICE9ICdmdW5jdGlvbicpdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgaXRlcmFibGUhJyk7XG4gIHJldHVybiBhbk9iamVjdChpdGVyRm4uY2FsbChpdCkpO1xufTsiLCIndXNlIHN0cmljdCc7XG52YXIgYWRkVG9VbnNjb3BhYmxlcyA9IHJlcXVpcmUoJy4vJC5hZGQtdG8tdW5zY29wYWJsZXMnKVxuICAsIHN0ZXAgICAgICAgICAgICAgPSByZXF1aXJlKCcuLyQuaXRlci1zdGVwJylcbiAgLCBJdGVyYXRvcnMgICAgICAgID0gcmVxdWlyZSgnLi8kLml0ZXJhdG9ycycpXG4gICwgdG9JT2JqZWN0ICAgICAgICA9IHJlcXVpcmUoJy4vJC50by1pb2JqZWN0Jyk7XG5cbi8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKClcbi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpXG4vLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpXG4vLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKClcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi8kLml0ZXItZGVmaW5lJykoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKXtcbiAgdGhpcy5fdCA9IHRvSU9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZFxuLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbigpe1xuICB2YXIgTyAgICAgPSB0aGlzLl90XG4gICAgLCBraW5kICA9IHRoaXMuX2tcbiAgICAsIGluZGV4ID0gdGhpcy5faSsrO1xuICBpZighTyB8fCBpbmRleCA+PSBPLmxlbmd0aCl7XG4gICAgdGhpcy5fdCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gc3RlcCgxKTtcbiAgfVxuICBpZihraW5kID09ICdrZXlzJyAgKXJldHVybiBzdGVwKDAsIGluZGV4KTtcbiAgaWYoa2luZCA9PSAndmFsdWVzJylyZXR1cm4gc3RlcCgwLCBPW2luZGV4XSk7XG4gIHJldHVybiBzdGVwKDAsIFtpbmRleCwgT1tpbmRleF1dKTtcbn0sICd2YWx1ZXMnKTtcblxuLy8gYXJndW1lbnRzTGlzdFtAQGl0ZXJhdG9yXSBpcyAlQXJyYXlQcm90b192YWx1ZXMlICg5LjQuNC42LCA5LjQuNC43KVxuSXRlcmF0b3JzLkFyZ3VtZW50cyA9IEl0ZXJhdG9ycy5BcnJheTtcblxuYWRkVG9VbnNjb3BhYmxlcygna2V5cycpO1xuYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7XG5hZGRUb1Vuc2NvcGFibGVzKCdlbnRyaWVzJyk7IiwiLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSlcbnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi8kLmV4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHthc3NpZ246IHJlcXVpcmUoJy4vJC5vYmplY3QtYXNzaWduJyl9KTsiLCIvLyAxOS4xLjIuNiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIFApXG52YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi8kLnRvLWlvYmplY3QnKTtcblxucmVxdWlyZSgnLi8kLm9iamVjdC1zYXAnKSgnZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJywgZnVuY3Rpb24oJGdldE93blByb3BlcnR5RGVzY3JpcHRvcil7XG4gIHJldHVybiBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7XG4gICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodG9JT2JqZWN0KGl0KSwga2V5KTtcbiAgfTtcbn0pOyIsIi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKVxudmFyIHRvT2JqZWN0ID0gcmVxdWlyZSgnLi8kLnRvLW9iamVjdCcpO1xuXG5yZXF1aXJlKCcuLyQub2JqZWN0LXNhcCcpKCdrZXlzJywgZnVuY3Rpb24oJGtleXMpe1xuICByZXR1cm4gZnVuY3Rpb24ga2V5cyhpdCl7XG4gICAgcmV0dXJuICRrZXlzKHRvT2JqZWN0KGl0KSk7XG4gIH07XG59KTsiLCIvLyAxOS4xLjMuMTkgT2JqZWN0LnNldFByb3RvdHlwZU9mKE8sIHByb3RvKVxudmFyICRleHBvcnQgPSByZXF1aXJlKCcuLyQuZXhwb3J0Jyk7XG4kZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogcmVxdWlyZSgnLi8kLnNldC1wcm90bycpLnNldH0pOyIsbnVsbCwiJ3VzZSBzdHJpY3QnO1xudmFyICQgICAgICAgICAgPSByZXF1aXJlKCcuLyQnKVxuICAsIExJQlJBUlkgICAgPSByZXF1aXJlKCcuLyQubGlicmFyeScpXG4gICwgZ2xvYmFsICAgICA9IHJlcXVpcmUoJy4vJC5nbG9iYWwnKVxuICAsIGN0eCAgICAgICAgPSByZXF1aXJlKCcuLyQuY3R4JylcbiAgLCBjbGFzc29mICAgID0gcmVxdWlyZSgnLi8kLmNsYXNzb2YnKVxuICAsICRleHBvcnQgICAgPSByZXF1aXJlKCcuLyQuZXhwb3J0JylcbiAgLCBpc09iamVjdCAgID0gcmVxdWlyZSgnLi8kLmlzLW9iamVjdCcpXG4gICwgYW5PYmplY3QgICA9IHJlcXVpcmUoJy4vJC5hbi1vYmplY3QnKVxuICAsIGFGdW5jdGlvbiAgPSByZXF1aXJlKCcuLyQuYS1mdW5jdGlvbicpXG4gICwgc3RyaWN0TmV3ICA9IHJlcXVpcmUoJy4vJC5zdHJpY3QtbmV3JylcbiAgLCBmb3JPZiAgICAgID0gcmVxdWlyZSgnLi8kLmZvci1vZicpXG4gICwgc2V0UHJvdG8gICA9IHJlcXVpcmUoJy4vJC5zZXQtcHJvdG8nKS5zZXRcbiAgLCBzYW1lICAgICAgID0gcmVxdWlyZSgnLi8kLnNhbWUtdmFsdWUnKVxuICAsIFNQRUNJRVMgICAgPSByZXF1aXJlKCcuLyQud2tzJykoJ3NwZWNpZXMnKVxuICAsIHNwZWNpZXNDb25zdHJ1Y3RvciA9IHJlcXVpcmUoJy4vJC5zcGVjaWVzLWNvbnN0cnVjdG9yJylcbiAgLCBhc2FwICAgICAgID0gcmVxdWlyZSgnLi8kLm1pY3JvdGFzaycpXG4gICwgUFJPTUlTRSAgICA9ICdQcm9taXNlJ1xuICAsIHByb2Nlc3MgICAgPSBnbG9iYWwucHJvY2Vzc1xuICAsIGlzTm9kZSAgICAgPSBjbGFzc29mKHByb2Nlc3MpID09ICdwcm9jZXNzJ1xuICAsIFAgICAgICAgICAgPSBnbG9iYWxbUFJPTUlTRV1cbiAgLCBlbXB0eSAgICAgID0gZnVuY3Rpb24oKXsgLyogZW1wdHkgKi8gfVxuICAsIFdyYXBwZXI7XG5cbnZhciB0ZXN0UmVzb2x2ZSA9IGZ1bmN0aW9uKHN1Yil7XG4gIHZhciB0ZXN0ID0gbmV3IFAoZW1wdHkpLCBwcm9taXNlO1xuICBpZihzdWIpdGVzdC5jb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGV4ZWMpe1xuICAgIGV4ZWMoZW1wdHksIGVtcHR5KTtcbiAgfTtcbiAgKHByb21pc2UgPSBQLnJlc29sdmUodGVzdCkpWydjYXRjaCddKGVtcHR5KTtcbiAgcmV0dXJuIHByb21pc2UgPT09IHRlc3Q7XG59O1xuXG52YXIgVVNFX05BVElWRSA9IGZ1bmN0aW9uKCl7XG4gIHZhciB3b3JrcyA9IGZhbHNlO1xuICBmdW5jdGlvbiBQMih4KXtcbiAgICB2YXIgc2VsZiA9IG5ldyBQKHgpO1xuICAgIHNldFByb3RvKHNlbGYsIFAyLnByb3RvdHlwZSk7XG4gICAgcmV0dXJuIHNlbGY7XG4gIH1cbiAgdHJ5IHtcbiAgICB3b3JrcyA9IFAgJiYgUC5yZXNvbHZlICYmIHRlc3RSZXNvbHZlKCk7XG4gICAgc2V0UHJvdG8oUDIsIFApO1xuICAgIFAyLnByb3RvdHlwZSA9ICQuY3JlYXRlKFAucHJvdG90eXBlLCB7Y29uc3RydWN0b3I6IHt2YWx1ZTogUDJ9fSk7XG4gICAgLy8gYWN0dWFsIEZpcmVmb3ggaGFzIGJyb2tlbiBzdWJjbGFzcyBzdXBwb3J0LCB0ZXN0IHRoYXRcbiAgICBpZighKFAyLnJlc29sdmUoNSkudGhlbihmdW5jdGlvbigpe30pIGluc3RhbmNlb2YgUDIpKXtcbiAgICAgIHdvcmtzID0gZmFsc2U7XG4gICAgfVxuICAgIC8vIGFjdHVhbCBWOCBidWcsIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD00MTYyXG4gICAgaWYod29ya3MgJiYgcmVxdWlyZSgnLi8kLmRlc2NyaXB0b3JzJykpe1xuICAgICAgdmFyIHRoZW5hYmxlVGhlbkdvdHRlbiA9IGZhbHNlO1xuICAgICAgUC5yZXNvbHZlKCQuc2V0RGVzYyh7fSwgJ3RoZW4nLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKXsgdGhlbmFibGVUaGVuR290dGVuID0gdHJ1ZTsgfVxuICAgICAgfSkpO1xuICAgICAgd29ya3MgPSB0aGVuYWJsZVRoZW5Hb3R0ZW47XG4gICAgfVxuICB9IGNhdGNoKGUpeyB3b3JrcyA9IGZhbHNlOyB9XG4gIHJldHVybiB3b3Jrcztcbn0oKTtcblxuLy8gaGVscGVyc1xudmFyIHNhbWVDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGEsIGIpe1xuICAvLyBsaWJyYXJ5IHdyYXBwZXIgc3BlY2lhbCBjYXNlXG4gIGlmKExJQlJBUlkgJiYgYSA9PT0gUCAmJiBiID09PSBXcmFwcGVyKXJldHVybiB0cnVlO1xuICByZXR1cm4gc2FtZShhLCBiKTtcbn07XG52YXIgZ2V0Q29uc3RydWN0b3IgPSBmdW5jdGlvbihDKXtcbiAgdmFyIFMgPSBhbk9iamVjdChDKVtTUEVDSUVTXTtcbiAgcmV0dXJuIFMgIT0gdW5kZWZpbmVkID8gUyA6IEM7XG59O1xudmFyIGlzVGhlbmFibGUgPSBmdW5jdGlvbihpdCl7XG4gIHZhciB0aGVuO1xuICByZXR1cm4gaXNPYmplY3QoaXQpICYmIHR5cGVvZiAodGhlbiA9IGl0LnRoZW4pID09ICdmdW5jdGlvbicgPyB0aGVuIDogZmFsc2U7XG59O1xudmFyIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oQyl7XG4gIHZhciByZXNvbHZlLCByZWplY3Q7XG4gIHRoaXMucHJvbWlzZSA9IG5ldyBDKGZ1bmN0aW9uKCQkcmVzb2x2ZSwgJCRyZWplY3Qpe1xuICAgIGlmKHJlc29sdmUgIT09IHVuZGVmaW5lZCB8fCByZWplY3QgIT09IHVuZGVmaW5lZCl0aHJvdyBUeXBlRXJyb3IoJ0JhZCBQcm9taXNlIGNvbnN0cnVjdG9yJyk7XG4gICAgcmVzb2x2ZSA9ICQkcmVzb2x2ZTtcbiAgICByZWplY3QgID0gJCRyZWplY3Q7XG4gIH0pO1xuICB0aGlzLnJlc29sdmUgPSBhRnVuY3Rpb24ocmVzb2x2ZSksXG4gIHRoaXMucmVqZWN0ICA9IGFGdW5jdGlvbihyZWplY3QpXG59O1xudmFyIHBlcmZvcm0gPSBmdW5jdGlvbihleGVjKXtcbiAgdHJ5IHtcbiAgICBleGVjKCk7XG4gIH0gY2F0Y2goZSl7XG4gICAgcmV0dXJuIHtlcnJvcjogZX07XG4gIH1cbn07XG52YXIgbm90aWZ5ID0gZnVuY3Rpb24ocmVjb3JkLCBpc1JlamVjdCl7XG4gIGlmKHJlY29yZC5uKXJldHVybjtcbiAgcmVjb3JkLm4gPSB0cnVlO1xuICB2YXIgY2hhaW4gPSByZWNvcmQuYztcbiAgYXNhcChmdW5jdGlvbigpe1xuICAgIHZhciB2YWx1ZSA9IHJlY29yZC52XG4gICAgICAsIG9rICAgID0gcmVjb3JkLnMgPT0gMVxuICAgICAgLCBpICAgICA9IDA7XG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uKHJlYWN0aW9uKXtcbiAgICAgIHZhciBoYW5kbGVyID0gb2sgPyByZWFjdGlvbi5vayA6IHJlYWN0aW9uLmZhaWxcbiAgICAgICAgLCByZXNvbHZlID0gcmVhY3Rpb24ucmVzb2x2ZVxuICAgICAgICAsIHJlamVjdCAgPSByZWFjdGlvbi5yZWplY3RcbiAgICAgICAgLCByZXN1bHQsIHRoZW47XG4gICAgICB0cnkge1xuICAgICAgICBpZihoYW5kbGVyKXtcbiAgICAgICAgICBpZighb2spcmVjb3JkLmggPSB0cnVlO1xuICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIgPT09IHRydWUgPyB2YWx1ZSA6IGhhbmRsZXIodmFsdWUpO1xuICAgICAgICAgIGlmKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSl7XG4gICAgICAgICAgICByZWplY3QoVHlwZUVycm9yKCdQcm9taXNlLWNoYWluIGN5Y2xlJykpO1xuICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXtcbiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7XG4gICAgICB9IGNhdGNoKGUpe1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2hcbiAgICBjaGFpbi5sZW5ndGggPSAwO1xuICAgIHJlY29yZC5uID0gZmFsc2U7XG4gICAgaWYoaXNSZWplY3Qpc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgdmFyIHByb21pc2UgPSByZWNvcmQucFxuICAgICAgICAsIGhhbmRsZXIsIGNvbnNvbGU7XG4gICAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7XG4gICAgICAgIGlmKGlzTm9kZSl7XG4gICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKXtcbiAgICAgICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlfSk7XG4gICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gcmVjb3JkLmEgPSB1bmRlZmluZWQ7XG4gICAgfSwgMSk7XG4gIH0pO1xufTtcbnZhciBpc1VuaGFuZGxlZCA9IGZ1bmN0aW9uKHByb21pc2Upe1xuICB2YXIgcmVjb3JkID0gcHJvbWlzZS5fZFxuICAgICwgY2hhaW4gID0gcmVjb3JkLmEgfHwgcmVjb3JkLmNcbiAgICAsIGkgICAgICA9IDBcbiAgICAsIHJlYWN0aW9uO1xuICBpZihyZWNvcmQuaClyZXR1cm4gZmFsc2U7XG4gIHdoaWxlKGNoYWluLmxlbmd0aCA+IGkpe1xuICAgIHJlYWN0aW9uID0gY2hhaW5baSsrXTtcbiAgICBpZihyZWFjdGlvbi5mYWlsIHx8ICFpc1VuaGFuZGxlZChyZWFjdGlvbi5wcm9taXNlKSlyZXR1cm4gZmFsc2U7XG4gIH0gcmV0dXJuIHRydWU7XG59O1xudmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7XG4gIHZhciByZWNvcmQgPSB0aGlzO1xuICBpZihyZWNvcmQuZClyZXR1cm47XG4gIHJlY29yZC5kID0gdHJ1ZTtcbiAgcmVjb3JkID0gcmVjb3JkLnIgfHwgcmVjb3JkOyAvLyB1bndyYXBcbiAgcmVjb3JkLnYgPSB2YWx1ZTtcbiAgcmVjb3JkLnMgPSAyO1xuICByZWNvcmQuYSA9IHJlY29yZC5jLnNsaWNlKCk7XG4gIG5vdGlmeShyZWNvcmQsIHRydWUpO1xufTtcbnZhciAkcmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgdmFyIHJlY29yZCA9IHRoaXNcbiAgICAsIHRoZW47XG4gIGlmKHJlY29yZC5kKXJldHVybjtcbiAgcmVjb3JkLmQgPSB0cnVlO1xuICByZWNvcmQgPSByZWNvcmQuciB8fCByZWNvcmQ7IC8vIHVud3JhcFxuICB0cnkge1xuICAgIGlmKHJlY29yZC5wID09PSB2YWx1ZSl0aHJvdyBUeXBlRXJyb3IoXCJQcm9taXNlIGNhbid0IGJlIHJlc29sdmVkIGl0c2VsZlwiKTtcbiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpe1xuICAgICAgYXNhcChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgd3JhcHBlciA9IHtyOiByZWNvcmQsIGQ6IGZhbHNlfTsgLy8gd3JhcFxuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoZW4uY2FsbCh2YWx1ZSwgY3R4KCRyZXNvbHZlLCB3cmFwcGVyLCAxKSwgY3R4KCRyZWplY3QsIHdyYXBwZXIsIDEpKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAkcmVqZWN0LmNhbGwod3JhcHBlciwgZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZWNvcmQudiA9IHZhbHVlO1xuICAgICAgcmVjb3JkLnMgPSAxO1xuICAgICAgbm90aWZ5KHJlY29yZCwgZmFsc2UpO1xuICAgIH1cbiAgfSBjYXRjaChlKXtcbiAgICAkcmVqZWN0LmNhbGwoe3I6IHJlY29yZCwgZDogZmFsc2V9LCBlKTsgLy8gd3JhcFxuICB9XG59O1xuXG4vLyBjb25zdHJ1Y3RvciBwb2x5ZmlsbFxuaWYoIVVTRV9OQVRJVkUpe1xuICAvLyAyNS40LjMuMSBQcm9taXNlKGV4ZWN1dG9yKVxuICBQID0gZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcil7XG4gICAgYUZ1bmN0aW9uKGV4ZWN1dG9yKTtcbiAgICB2YXIgcmVjb3JkID0gdGhpcy5fZCA9IHtcbiAgICAgIHA6IHN0cmljdE5ldyh0aGlzLCBQLCBQUk9NSVNFKSwgICAgICAgICAvLyA8LSBwcm9taXNlXG4gICAgICBjOiBbXSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zXG4gICAgICBhOiB1bmRlZmluZWQsICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gY2hlY2tlZCBpbiBpc1VuaGFuZGxlZCByZWFjdGlvbnNcbiAgICAgIHM6IDAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA8LSBzdGF0ZVxuICAgICAgZDogZmFsc2UsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDwtIGRvbmVcbiAgICAgIHY6IHVuZGVmaW5lZCwgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA8LSB2YWx1ZVxuICAgICAgaDogZmFsc2UsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDwtIGhhbmRsZWQgcmVqZWN0aW9uXG4gICAgICBuOiBmYWxzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gbm90aWZ5XG4gICAgfTtcbiAgICB0cnkge1xuICAgICAgZXhlY3V0b3IoY3R4KCRyZXNvbHZlLCByZWNvcmQsIDEpLCBjdHgoJHJlamVjdCwgcmVjb3JkLCAxKSk7XG4gICAgfSBjYXRjaChlcnIpe1xuICAgICAgJHJlamVjdC5jYWxsKHJlY29yZCwgZXJyKTtcbiAgICB9XG4gIH07XG4gIHJlcXVpcmUoJy4vJC5yZWRlZmluZS1hbGwnKShQLnByb3RvdHlwZSwge1xuICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpXG4gICAgdGhlbjogZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCl7XG4gICAgICB2YXIgcmVhY3Rpb24gPSBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoc3BlY2llc0NvbnN0cnVjdG9yKHRoaXMsIFApKVxuICAgICAgICAsIHByb21pc2UgID0gcmVhY3Rpb24ucHJvbWlzZVxuICAgICAgICAsIHJlY29yZCAgID0gdGhpcy5fZDtcbiAgICAgIHJlYWN0aW9uLm9rICAgPSB0eXBlb2Ygb25GdWxmaWxsZWQgPT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogdHJ1ZTtcbiAgICAgIHJlYWN0aW9uLmZhaWwgPSB0eXBlb2Ygb25SZWplY3RlZCA9PSAnZnVuY3Rpb24nICYmIG9uUmVqZWN0ZWQ7XG4gICAgICByZWNvcmQuYy5wdXNoKHJlYWN0aW9uKTtcbiAgICAgIGlmKHJlY29yZC5hKXJlY29yZC5hLnB1c2gocmVhY3Rpb24pO1xuICAgICAgaWYocmVjb3JkLnMpbm90aWZ5KHJlY29yZCwgZmFsc2UpO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfSxcbiAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKVxuICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpe1xuICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpO1xuICAgIH1cbiAgfSk7XG59XG5cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIHtQcm9taXNlOiBQfSk7XG5yZXF1aXJlKCcuLyQuc2V0LXRvLXN0cmluZy10YWcnKShQLCBQUk9NSVNFKTtcbnJlcXVpcmUoJy4vJC5zZXQtc3BlY2llcycpKFBST01JU0UpO1xuV3JhcHBlciA9IHJlcXVpcmUoJy4vJC5jb3JlJylbUFJPTUlTRV07XG5cbi8vIHN0YXRpY3NcbiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsIFBST01JU0UsIHtcbiAgLy8gMjUuNC40LjUgUHJvbWlzZS5yZWplY3QocilcbiAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3Qocil7XG4gICAgdmFyIGNhcGFiaWxpdHkgPSBuZXcgUHJvbWlzZUNhcGFiaWxpdHkodGhpcylcbiAgICAgICwgJCRyZWplY3QgICA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgICQkcmVqZWN0KHIpO1xuICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7XG4gIH1cbn0pO1xuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgdGVzdFJlc29sdmUodHJ1ZSkpLCBQUk9NSVNFLCB7XG4gIC8vIDI1LjQuNC42IFByb21pc2UucmVzb2x2ZSh4KVxuICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlKHgpe1xuICAgIC8vIGluc3RhbmNlb2YgaW5zdGVhZCBvZiBpbnRlcm5hbCBzbG90IGNoZWNrIGJlY2F1c2Ugd2Ugc2hvdWxkIGZpeCBpdCB3aXRob3V0IHJlcGxhY2VtZW50IG5hdGl2ZSBQcm9taXNlIGNvcmVcbiAgICBpZih4IGluc3RhbmNlb2YgUCAmJiBzYW1lQ29uc3RydWN0b3IoeC5jb25zdHJ1Y3RvciwgdGhpcykpcmV0dXJuIHg7XG4gICAgdmFyIGNhcGFiaWxpdHkgPSBuZXcgUHJvbWlzZUNhcGFiaWxpdHkodGhpcylcbiAgICAgICwgJCRyZXNvbHZlICA9IGNhcGFiaWxpdHkucmVzb2x2ZTtcbiAgICAkJHJlc29sdmUoeCk7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfVxufSk7XG4kZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoVVNFX05BVElWRSAmJiByZXF1aXJlKCcuLyQuaXRlci1kZXRlY3QnKShmdW5jdGlvbihpdGVyKXtcbiAgUC5hbGwoaXRlcilbJ2NhdGNoJ10oZnVuY3Rpb24oKXt9KTtcbn0pKSwgUFJPTUlTRSwge1xuICAvLyAyNS40LjQuMSBQcm9taXNlLmFsbChpdGVyYWJsZSlcbiAgYWxsOiBmdW5jdGlvbiBhbGwoaXRlcmFibGUpe1xuICAgIHZhciBDICAgICAgICAgID0gZ2V0Q29uc3RydWN0b3IodGhpcylcbiAgICAgICwgY2FwYWJpbGl0eSA9IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKVxuICAgICAgLCByZXNvbHZlICAgID0gY2FwYWJpbGl0eS5yZXNvbHZlXG4gICAgICAsIHJlamVjdCAgICAgPSBjYXBhYmlsaXR5LnJlamVjdFxuICAgICAgLCB2YWx1ZXMgICAgID0gW107XG4gICAgdmFyIGFicnVwdCA9IHBlcmZvcm0oZnVuY3Rpb24oKXtcbiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgdmFsdWVzLnB1c2gsIHZhbHVlcyk7XG4gICAgICB2YXIgcmVtYWluaW5nID0gdmFsdWVzLmxlbmd0aFxuICAgICAgICAsIHJlc3VsdHMgICA9IEFycmF5KHJlbWFpbmluZyk7XG4gICAgICBpZihyZW1haW5pbmcpJC5lYWNoLmNhbGwodmFsdWVzLCBmdW5jdGlvbihwcm9taXNlLCBpbmRleCl7XG4gICAgICAgIHZhciBhbHJlYWR5Q2FsbGVkID0gZmFsc2U7XG4gICAgICAgIEMucmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgICBpZihhbHJlYWR5Q2FsbGVkKXJldHVybjtcbiAgICAgICAgICBhbHJlYWR5Q2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICByZXN1bHRzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgIH0sIHJlamVjdCk7XG4gICAgICB9KTtcbiAgICAgIGVsc2UgcmVzb2x2ZShyZXN1bHRzKTtcbiAgICB9KTtcbiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfSxcbiAgLy8gMjUuNC40LjQgUHJvbWlzZS5yYWNlKGl0ZXJhYmxlKVxuICByYWNlOiBmdW5jdGlvbiByYWNlKGl0ZXJhYmxlKXtcbiAgICB2YXIgQyAgICAgICAgICA9IGdldENvbnN0cnVjdG9yKHRoaXMpXG4gICAgICAsIGNhcGFiaWxpdHkgPSBuZXcgUHJvbWlzZUNhcGFiaWxpdHkoQylcbiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0O1xuICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7XG4gICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2Upe1xuICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7XG4gICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTtcbiAgfVxufSk7IiwiJ3VzZSBzdHJpY3QnO1xudmFyIHN0cm9uZyA9IHJlcXVpcmUoJy4vJC5jb2xsZWN0aW9uLXN0cm9uZycpO1xuXG4vLyAyMy4yIFNldCBPYmplY3RzXG5yZXF1aXJlKCcuLyQuY29sbGVjdGlvbicpKCdTZXQnLCBmdW5jdGlvbihnZXQpe1xuICByZXR1cm4gZnVuY3Rpb24gU2V0KCl7IHJldHVybiBnZXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOyB9O1xufSwge1xuICAvLyAyMy4yLjMuMSBTZXQucHJvdG90eXBlLmFkZCh2YWx1ZSlcbiAgYWRkOiBmdW5jdGlvbiBhZGQodmFsdWUpe1xuICAgIHJldHVybiBzdHJvbmcuZGVmKHRoaXMsIHZhbHVlID0gdmFsdWUgPT09IDAgPyAwIDogdmFsdWUsIHZhbHVlKTtcbiAgfVxufSwgc3Ryb25nKTsiLCIndXNlIHN0cmljdCc7XG52YXIgJGF0ICA9IHJlcXVpcmUoJy4vJC5zdHJpbmctYXQnKSh0cnVlKTtcblxuLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGVbQEBpdGVyYXRvcl0oKVxucmVxdWlyZSgnLi8kLml0ZXItZGVmaW5lJykoU3RyaW5nLCAnU3RyaW5nJywgZnVuY3Rpb24oaXRlcmF0ZWQpe1xuICB0aGlzLl90ID0gU3RyaW5nKGl0ZXJhdGVkKTsgLy8gdGFyZ2V0XG4gIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4XG4vLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbigpe1xuICB2YXIgTyAgICAgPSB0aGlzLl90XG4gICAgLCBpbmRleCA9IHRoaXMuX2lcbiAgICAsIHBvaW50O1xuICBpZihpbmRleCA+PSBPLmxlbmd0aClyZXR1cm4ge3ZhbHVlOiB1bmRlZmluZWQsIGRvbmU6IHRydWV9O1xuICBwb2ludCA9ICRhdChPLCBpbmRleCk7XG4gIHRoaXMuX2kgKz0gcG9pbnQubGVuZ3RoO1xuICByZXR1cm4ge3ZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2V9O1xufSk7IiwiLy8gaHR0cHM6Ly9naXRodWIuY29tL0RhdmlkQnJ1YW50L01hcC1TZXQucHJvdG90eXBlLnRvSlNPTlxudmFyICRleHBvcnQgID0gcmVxdWlyZSgnLi8kLmV4cG9ydCcpO1xuXG4kZXhwb3J0KCRleHBvcnQuUCwgJ1NldCcsIHt0b0pTT046IHJlcXVpcmUoJy4vJC5jb2xsZWN0aW9uLXRvLWpzb24nKSgnU2V0Jyl9KTsiLCJyZXF1aXJlKCcuL2VzNi5hcnJheS5pdGVyYXRvcicpO1xudmFyIEl0ZXJhdG9ycyA9IHJlcXVpcmUoJy4vJC5pdGVyYXRvcnMnKTtcbkl0ZXJhdG9ycy5Ob2RlTGlzdCA9IEl0ZXJhdG9ycy5IVE1MQ29sbGVjdGlvbiA9IEl0ZXJhdG9ycy5BcnJheTsiLCI7KGZ1bmN0aW9uKHJvb3QpIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdHMgYSBuZXcgY3Jvc3Mgc3RvcmFnZSBjbGllbnQgZ2l2ZW4gdGhlIHVybCB0byBhIGh1Yi4gQnkgZGVmYXVsdCxcbiAgICogYW4gaWZyYW1lIGlzIGNyZWF0ZWQgd2l0aGluIHRoZSBkb2N1bWVudCBib2R5IHRoYXQgcG9pbnRzIHRvIHRoZSB1cmwuIEl0XG4gICAqIGFsc28gYWNjZXB0cyBhbiBvcHRpb25zIG9iamVjdCwgd2hpY2ggbWF5IGluY2x1ZGUgYSB0aW1lb3V0LCBmcmFtZUlkLCBhbmRcbiAgICogcHJvbWlzZS4gVGhlIHRpbWVvdXQsIGluIG1pbGxpc2Vjb25kcywgaXMgYXBwbGllZCB0byBlYWNoIHJlcXVlc3QgYW5kXG4gICAqIGRlZmF1bHRzIHRvIDUwMDBtcy4gVGhlIG9wdGlvbnMgb2JqZWN0IG1heSBhbHNvIGluY2x1ZGUgYSBmcmFtZUlkLFxuICAgKiBpZGVudGlmeWluZyBhbiBleGlzdGluZyBmcmFtZSBvbiB3aGljaCB0byBpbnN0YWxsIGl0cyBsaXN0ZW5lcnMuIElmIHRoZVxuICAgKiBwcm9taXNlIGtleSBpcyBzdXBwbGllZCB0aGUgY29uc3RydWN0b3IgZm9yIGEgUHJvbWlzZSwgdGhhdCBQcm9taXNlIGxpYnJhcnlcbiAgICogd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIGRlZmF1bHQgd2luZG93LlByb21pc2UuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBzdG9yYWdlID0gbmV3IENyb3NzU3RvcmFnZUNsaWVudCgnaHR0cHM6Ly9zdG9yZS5leGFtcGxlLmNvbS9odWIuaHRtbCcpO1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgc3RvcmFnZSA9IG5ldyBDcm9zc1N0b3JhZ2VDbGllbnQoJ2h0dHBzOi8vc3RvcmUuZXhhbXBsZS5jb20vaHViLmh0bWwnLCB7XG4gICAqICAgdGltZW91dDogNTAwMCxcbiAgICogICBmcmFtZUlkOiAnc3RvcmFnZUZyYW1lJ1xuICAgKiB9KTtcbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgICAgVGhlIHVybCB0byBhIGNyb3NzIHN0b3JhZ2UgaHViXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0c10gQW4gb3B0aW9uYWwgb2JqZWN0IGNvbnRhaW5pbmcgYWRkaXRpb25hbCBvcHRpb25zLFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGluZyB0aW1lb3V0LCBmcmFtZUlkLCBhbmQgcHJvbWlzZVxuICAgKlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gICBfaWQgICAgICAgIEEgVVVJRCB2NCBpZFxuICAgKiBAcHJvcGVydHkge2Z1bmN0aW9ufSBfcHJvbWlzZSAgIFRoZSBQcm9taXNlIG9iamVjdCB0byB1c2VcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9ICAgX2ZyYW1lSWQgICBUaGUgaWQgb2YgdGhlIGlGcmFtZSBwb2ludGluZyB0byB0aGUgaHViIHVybFxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gICBfb3JpZ2luICAgIFRoZSBodWIncyBvcmlnaW5cbiAgICogQHByb3BlcnR5IHtvYmplY3R9ICAgX3JlcXVlc3RzICBNYXBwaW5nIG9mIHJlcXVlc3QgaWRzIHRvIGNhbGxiYWNrc1xuICAgKiBAcHJvcGVydHkge2Jvb2x9ICAgICBfY29ubmVjdGVkIFdoZXRoZXIgb3Igbm90IGl0IGhhcyBjb25uZWN0ZWRcbiAgICogQHByb3BlcnR5IHtib29sfSAgICAgX2Nsb3NlZCAgICBXaGV0aGVyIG9yIG5vdCB0aGUgY2xpZW50IGhhcyBjbG9zZWRcbiAgICogQHByb3BlcnR5IHtpbnR9ICAgICAgX2NvdW50ICAgICBOdW1iZXIgb2YgcmVxdWVzdHMgc2VudFxuICAgKiBAcHJvcGVydHkge2Z1bmN0aW9ufSBfbGlzdGVuZXIgIFRoZSBsaXN0ZW5lciBhZGRlZCB0byB0aGUgd2luZG93XG4gICAqIEBwcm9wZXJ0eSB7V2luZG93fSAgIF9odWIgICAgICAgVGhlIGh1YiB3aW5kb3dcbiAgICovXG4gIGZ1bmN0aW9uIENyb3NzU3RvcmFnZUNsaWVudCh1cmwsIG9wdHMpIHtcbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcblxuICAgIHRoaXMuX2lkICAgICAgICA9IENyb3NzU3RvcmFnZUNsaWVudC5fZ2VuZXJhdGVVVUlEKCk7XG4gICAgdGhpcy5fcHJvbWlzZSAgID0gb3B0cy5wcm9taXNlIHx8IFByb21pc2U7XG4gICAgdGhpcy5fZnJhbWVJZCAgID0gb3B0cy5mcmFtZUlkIHx8ICdDcm9zc1N0b3JhZ2VDbGllbnQtJyArIHRoaXMuX2lkO1xuICAgIHRoaXMuX29yaWdpbiAgICA9IENyb3NzU3RvcmFnZUNsaWVudC5fZ2V0T3JpZ2luKHVybCk7XG4gICAgdGhpcy5fcmVxdWVzdHMgID0ge307XG4gICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XG4gICAgdGhpcy5fY2xvc2VkICAgID0gZmFsc2U7XG4gICAgdGhpcy5fY291bnQgICAgID0gMDtcbiAgICB0aGlzLl90aW1lb3V0ICAgPSBvcHRzLnRpbWVvdXQgfHwgNTAwMDtcbiAgICB0aGlzLl9saXN0ZW5lciAgPSBudWxsO1xuXG4gICAgdGhpcy5faW5zdGFsbExpc3RlbmVyKCk7XG5cbiAgICB2YXIgZnJhbWU7XG4gICAgaWYgKG9wdHMuZnJhbWVJZCkge1xuICAgICAgZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvcHRzLmZyYW1lSWQpO1xuICAgIH1cblxuICAgIC8vIElmIHVzaW5nIGEgcGFzc2VkIGlmcmFtZSwgcG9sbCB0aGUgaHViIGZvciBhIHJlYWR5IG1lc3NhZ2VcbiAgICBpZiAoZnJhbWUpIHtcbiAgICAgIHRoaXMuX3BvbGwoKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdGhlIGZyYW1lIGlmIG5vdCBmb3VuZCBvciBzcGVjaWZpZWRcbiAgICBmcmFtZSA9IGZyYW1lIHx8IHRoaXMuX2NyZWF0ZUZyYW1lKHVybCk7XG4gICAgdGhpcy5faHViID0gZnJhbWUuY29udGVudFdpbmRvdztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgc3R5bGVzIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGdlbmVyYXRlZCBpRnJhbWUuIERlZmluZXMgYSBzZXQgb2YgcHJvcGVydGllc1xuICAgKiB0aGF0IGhpZGUgdGhlIGVsZW1lbnQgYnkgcG9zaXRpb25pbmcgaXQgb3V0c2lkZSBvZiB0aGUgdmlzaWJsZSBhcmVhLCBhbmRcbiAgICogYnkgbW9kaWZ5aW5nIGl0cyBkaXNwbGF5LlxuICAgKlxuICAgKiBAbWVtYmVyIHtPYmplY3R9XG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQuZnJhbWVTdHlsZSA9IHtcbiAgICBkaXNwbGF5OiAgJ25vbmUnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHRvcDogICAgICAnLTk5OXB4JyxcbiAgICBsZWZ0OiAgICAgJy05OTlweCdcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgb3JpZ2luIG9mIGFuIHVybCwgd2l0aCBjcm9zcyBicm93c2VyIHN1cHBvcnQuIEFjY29tbW9kYXRlc1xuICAgKiB0aGUgbGFjayBvZiBsb2NhdGlvbi5vcmlnaW4gaW4gSUUsIGFzIHdlbGwgYXMgdGhlIGRpc2NyZXBhbmNpZXMgaW4gdGhlXG4gICAqIGluY2x1c2lvbiBvZiB0aGUgcG9ydCB3aGVuIHVzaW5nIHRoZSBkZWZhdWx0IHBvcnQgZm9yIGEgcHJvdG9jb2wsIGUuZy5cbiAgICogNDQzIG92ZXIgaHR0cHMuIERlZmF1bHRzIHRvIHRoZSBvcmlnaW4gb2Ygd2luZG93LmxvY2F0aW9uIGlmIHBhc3NlZCBhXG4gICAqIHJlbGF0aXZlIHBhdGguXG4gICAqXG4gICAqIEBwYXJhbSAgIHtzdHJpbmd9IHVybCBUaGUgdXJsIHRvIGEgY3Jvc3Mgc3RvcmFnZSBodWJcbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIG9yaWdpbiBvZiB0aGUgdXJsXG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQuX2dldE9yaWdpbiA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHZhciB1cmksIHByb3RvY29sLCBvcmlnaW47XG5cbiAgICB1cmkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgdXJpLmhyZWYgPSB1cmw7XG5cbiAgICBpZiAoIXVyaS5ob3N0KSB7XG4gICAgICB1cmkgPSB3aW5kb3cubG9jYXRpb247XG4gICAgfVxuXG4gICAgaWYgKCF1cmkucHJvdG9jb2wgfHwgdXJpLnByb3RvY29sID09PSAnOicpIHtcbiAgICAgIHByb3RvY29sID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm90b2NvbCA9IHVyaS5wcm90b2NvbDtcbiAgICB9XG5cbiAgICBvcmlnaW4gPSBwcm90b2NvbCArICcvLycgKyB1cmkuaG9zdDtcbiAgICBvcmlnaW4gPSBvcmlnaW4ucmVwbGFjZSgvOjgwJHw6NDQzJC8sICcnKTtcblxuICAgIHJldHVybiBvcmlnaW47XG4gIH07XG5cbiAgLyoqXG4gICAqIFVVSUQgdjQgZ2VuZXJhdGlvbiwgdGFrZW4gZnJvbTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy9cbiAgICogMTA1MDM0L2hvdy10by1jcmVhdGUtYS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdC8yMTE3NTIzIzIxMTc1MjNcbiAgICpcbiAgICogQHJldHVybnMge3N0cmluZ30gQSBVVUlEIHY0IHN0cmluZ1xuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlQ2xpZW50Ll9nZW5lcmF0ZVVVSUQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7XG4gICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNnwwLCB2ID0gYyA9PSAneCcgPyByIDogKHImMHgzfDB4OCk7XG5cbiAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgd2hlbiBhIGNvbm5lY3Rpb24gaGFzIGJlZW4gZXN0YWJsaXNoZWRcbiAgICogd2l0aCB0aGUgY3Jvc3Mgc3RvcmFnZSBodWIuIEl0cyB1c2UgaXMgcmVxdWlyZWQgdG8gYXZvaWQgc2VuZGluZyBhbnlcbiAgICogcmVxdWVzdHMgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb24gYmVpbmcgY29tcGxldGUuXG4gICAqXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCBvbiBjb25uZWN0XG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQucHJvdG90eXBlLm9uQ29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjbGllbnQgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMuX2Nvbm5lY3RlZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2UucmVzb2x2ZSgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5fY2xvc2VkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdDcm9zc1N0b3JhZ2VDbGllbnQgaGFzIGNsb3NlZCcpKTtcbiAgICB9XG5cbiAgICAvLyBRdWV1ZSBjb25uZWN0IHJlcXVlc3RzIGZvciBjbGllbnQgcmUtdXNlXG4gICAgaWYgKCF0aGlzLl9yZXF1ZXN0cy5jb25uZWN0KSB7XG4gICAgICB0aGlzLl9yZXF1ZXN0cy5jb25uZWN0ID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyB0aGlzLl9wcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKCdDcm9zc1N0b3JhZ2VDbGllbnQgY291bGQgbm90IGNvbm5lY3QnKSk7XG4gICAgICB9LCBjbGllbnQuX3RpbWVvdXQpO1xuXG4gICAgICBjbGllbnQuX3JlcXVlc3RzLmNvbm5lY3QucHVzaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVqZWN0KGVycik7XG5cbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHMgYSBrZXkgdG8gdGhlIHNwZWNpZmllZCB2YWx1ZS4gUmV0dXJucyBhIHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgb25cbiAgICogc3VjY2Vzcywgb3IgcmVqZWN0ZWQgaWYgYW55IGVycm9ycyBzZXR0aW5nIHRoZSBrZXkgb2NjdXJyZWQsIG9yIHRoZSByZXF1ZXN0XG4gICAqIHRpbWVkIG91dC5cbiAgICpcbiAgICogQHBhcmFtICAge3N0cmluZ30gIGtleSAgIFRoZSBrZXkgdG8gc2V0XG4gICAqIEBwYXJhbSAgIHsqfSAgICAgICB2YWx1ZSBUaGUgdmFsdWUgdG8gYXNzaWduXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyBzZXR0bGVkIG9uIGh1YiByZXNwb25zZSBvciB0aW1lb3V0XG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCgnc2V0Jywge1xuICAgICAga2V5OiAgIGtleSxcbiAgICAgIHZhbHVlOiB2YWx1ZVxuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBY2NlcHRzIG9uZSBvciBtb3JlIGtleXMgZm9yIHdoaWNoIHRvIHJldHJpZXZlIHRoZWlyIHZhbHVlcy4gUmV0dXJucyBhXG4gICAqIHByb21pc2UgdGhhdCBpcyBzZXR0bGVkIG9uIGh1YiByZXNwb25zZSBvciB0aW1lb3V0LiBPbiBzdWNjZXNzLCBpdCBpc1xuICAgKiBmdWxmaWxsZWQgd2l0aCB0aGUgdmFsdWUgb2YgdGhlIGtleSBpZiBvbmx5IHBhc3NlZCBhIHNpbmdsZSBhcmd1bWVudC5cbiAgICogT3RoZXJ3aXNlIGl0J3MgcmVzb2x2ZWQgd2l0aCBhbiBhcnJheSBvZiB2YWx1ZXMuIE9uIGZhaWx1cmUsIGl0IGlzIHJlamVjdGVkXG4gICAqIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgZXJyb3IgbWVzc2FnZS5cbiAgICpcbiAgICogQHBhcmFtICAgey4uLnN0cmluZ30ga2V5IFRoZSBrZXkgdG8gcmV0cmlldmVcbiAgICogQHJldHVybnMge1Byb21pc2V9ICAgQSBwcm9taXNlIHRoYXQgaXMgc2V0dGxlZCBvbiBodWIgcmVzcG9uc2Ugb3IgdGltZW91dFxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlQ2xpZW50LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihrZXkpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCgnZ2V0Jywge2tleXM6IGFyZ3N9KTtcbiAgfTtcblxuICAvKipcbiAgICogQWNjZXB0cyBvbmUgb3IgbW9yZSBrZXlzIGZvciBkZWxldGlvbi4gUmV0dXJucyBhIHByb21pc2UgdGhhdCBpcyBzZXR0bGVkIG9uXG4gICAqIGh1YiByZXNwb25zZSBvciB0aW1lb3V0LlxuICAgKlxuICAgKiBAcGFyYW0gICB7Li4uc3RyaW5nfSBrZXkgVGhlIGtleSB0byBkZWxldGVcbiAgICogQHJldHVybnMge1Byb21pc2V9ICAgQSBwcm9taXNlIHRoYXQgaXMgc2V0dGxlZCBvbiBodWIgcmVzcG9uc2Ugb3IgdGltZW91dFxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlQ2xpZW50LnByb3RvdHlwZS5kZWwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdCgnZGVsJywge2tleXM6IGFyZ3N9KTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCwgd2hlbiByZXNvbHZlZCwgaW5kaWNhdGVzIHRoYXQgYWxsIGxvY2FsU3RvcmFnZVxuICAgKiBkYXRhIGhhcyBiZWVuIGNsZWFyZWQuXG4gICAqXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyBzZXR0bGVkIG9uIGh1YiByZXNwb25zZSBvciB0aW1lb3V0XG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoJ2NsZWFyJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQsIHdoZW4gcmVzb2x2ZWQsIHBhc3NlcyBhbiBhcnJheSBvZiBhbGwga2V5c1xuICAgKiBjdXJyZW50bHkgaW4gc3RvcmFnZS5cbiAgICpcbiAgICogQHJldHVybnMge1Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGlzIHNldHRsZWQgb24gaHViIHJlc3BvbnNlIG9yIHRpbWVvdXRcbiAgICovXG4gIENyb3NzU3RvcmFnZUNsaWVudC5wcm90b3R5cGUuZ2V0S2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KCdnZXRLZXlzJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERlbGV0ZXMgdGhlIGlmcmFtZSBhbmQgc2V0cyB0aGUgY29ubmVjdGVkIHN0YXRlIHRvIGZhbHNlLiBUaGUgY2xpZW50IGNhblxuICAgKiBubyBsb25nZXIgYmUgdXNlZCBhZnRlciBiZWluZyBpbnZva2VkLlxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlQ2xpZW50LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuX2ZyYW1lSWQpO1xuICAgIGlmIChmcmFtZSkge1xuICAgICAgZnJhbWUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmcmFtZSk7XG4gICAgfVxuXG4gICAgLy8gU3VwcG9ydCBJRTggd2l0aCBkZXRhY2hFdmVudFxuICAgIGlmICh3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcikge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLl9saXN0ZW5lciwgZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cuZGV0YWNoRXZlbnQoJ29ubWVzc2FnZScsIHRoaXMuX2xpc3RlbmVyKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9jbG9zZWQgPSB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbnN0YWxscyB0aGUgbmVjZXNzYXJ5IGxpc3RlbmVyIGZvciB0aGUgd2luZG93IG1lc3NhZ2UgZXZlbnQuIFdoZW4gYSBtZXNzYWdlXG4gICAqIGlzIHJlY2VpdmVkLCB0aGUgY2xpZW50J3MgX2Nvbm5lY3RlZCBzdGF0dXMgaXMgY2hhbmdlZCB0byB0cnVlLCBhbmQgdGhlXG4gICAqIG9uQ29ubmVjdCBwcm9taXNlIGlzIGZ1bGZpbGxlZC4gR2l2ZW4gYSByZXNwb25zZSBtZXNzYWdlLCB0aGUgY2FsbGJhY2tcbiAgICogY29ycmVzcG9uZGluZyB0byBpdHMgcmVxdWVzdCBpcyBpbnZva2VkLiBJZiByZXNwb25zZS5lcnJvciBob2xkcyBhIHRydXRoeVxuICAgKiB2YWx1ZSwgdGhlIHByb21pc2UgYXNzb2NpYXRlZCB3aXRoIHRoZSBvcmlnaW5hbCByZXF1ZXN0IGlzIHJlamVjdGVkIHdpdGhcbiAgICogdGhlIGVycm9yLiBPdGhlcndpc2UgdGhlIHByb21pc2UgaXMgZnVsZmlsbGVkIGFuZCBwYXNzZWQgcmVzcG9uc2UucmVzdWx0LlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlQ2xpZW50LnByb3RvdHlwZS5faW5zdGFsbExpc3RlbmVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNsaWVudCA9IHRoaXM7XG5cbiAgICB0aGlzLl9saXN0ZW5lciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgIHZhciBpLCBvcmlnaW4sIGVycm9yLCByZXNwb25zZTtcblxuICAgICAgLy8gSWdub3JlIGludmFsaWQgbWVzc2FnZXMgb3IgdGhvc2UgYWZ0ZXIgdGhlIGNsaWVudCBoYXMgY2xvc2VkXG4gICAgICBpZiAoY2xpZW50Ll9jbG9zZWQgfHwgIW1lc3NhZ2UuZGF0YSB8fCB0eXBlb2YgbWVzc2FnZS5kYXRhICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIHBvc3RNZXNzYWdlIHJldHVybnMgdGhlIHN0cmluZyBcIm51bGxcIiBhcyB0aGUgb3JpZ2luIGZvciBcImZpbGU6Ly9cIlxuICAgICAgb3JpZ2luID0gKG1lc3NhZ2Uub3JpZ2luID09PSAnbnVsbCcpID8gJ2ZpbGU6Ly8nIDogbWVzc2FnZS5vcmlnaW47XG5cbiAgICAgIC8vIElnbm9yZSBtZXNzYWdlcyBub3QgZnJvbSB0aGUgY29ycmVjdCBvcmlnaW5cbiAgICAgIGlmIChvcmlnaW4gIT09IGNsaWVudC5fb3JpZ2luKSByZXR1cm47XG5cbiAgICAgIC8vIExvY2FsU3RvcmFnZSBpc24ndCBhdmFpbGFibGUgaW4gdGhlIGh1YlxuICAgICAgaWYgKG1lc3NhZ2UuZGF0YSA9PT0gJ2Nyb3NzLXN0b3JhZ2U6dW5hdmFpbGFibGUnKSB7XG4gICAgICAgIGlmICghY2xpZW50Ll9jbG9zZWQpIGNsaWVudC5jbG9zZSgpO1xuICAgICAgICBpZiAoIWNsaWVudC5fcmVxdWVzdHMuY29ubmVjdCkgcmV0dXJuO1xuXG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdDbG9zaW5nIGNsaWVudC4gQ291bGQgbm90IGFjY2VzcyBsb2NhbFN0b3JhZ2UgaW4gaHViLicpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2xpZW50Ll9yZXF1ZXN0cy5jb25uZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY2xpZW50Ll9yZXF1ZXN0cy5jb25uZWN0W2ldKGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gSGFuZGxlIGluaXRpYWwgY29ubmVjdGlvblxuICAgICAgaWYgKG1lc3NhZ2UuZGF0YS5pbmRleE9mKCdjcm9zcy1zdG9yYWdlOicpICE9PSAtMSAmJiAhY2xpZW50Ll9jb25uZWN0ZWQpIHtcbiAgICAgICAgY2xpZW50Ll9jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAoIWNsaWVudC5fcmVxdWVzdHMuY29ubmVjdCkgcmV0dXJuO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjbGllbnQuX3JlcXVlc3RzLmNvbm5lY3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjbGllbnQuX3JlcXVlc3RzLmNvbm5lY3RbaV0oZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBjbGllbnQuX3JlcXVlc3RzLmNvbm5lY3Q7XG4gICAgICB9XG5cbiAgICAgIGlmIChtZXNzYWdlLmRhdGEgPT09ICdjcm9zcy1zdG9yYWdlOnJlYWR5JykgcmV0dXJuO1xuXG4gICAgICAvLyBBbGwgb3RoZXIgbWVzc2FnZXNcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlc3BvbnNlID0gSlNPTi5wYXJzZShtZXNzYWdlLmRhdGEpO1xuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXNwb25zZS5pZCkgcmV0dXJuO1xuXG4gICAgICBpZiAoY2xpZW50Ll9yZXF1ZXN0c1tyZXNwb25zZS5pZF0pIHtcbiAgICAgICAgY2xpZW50Ll9yZXF1ZXN0c1tyZXNwb25zZS5pZF0ocmVzcG9uc2UuZXJyb3IsIHJlc3BvbnNlLnJlc3VsdCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIFN1cHBvcnQgSUU4IHdpdGggYXR0YWNoRXZlbnRcbiAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5fbGlzdGVuZXIsIGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LmF0dGFjaEV2ZW50KCdvbm1lc3NhZ2UnLCB0aGlzLl9saXN0ZW5lcik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBJbnZva2VkIHdoZW4gYSBmcmFtZSBpZCB3YXMgcGFzc2VkIHRvIHRoZSBjbGllbnQsIHJhdGhlciB0aGFuIGFsbG93aW5nXG4gICAqIHRoZSBjbGllbnQgdG8gY3JlYXRlIGl0cyBvd24gaWZyYW1lLiBQb2xscyB0aGUgaHViIGZvciBhIHJlYWR5IGV2ZW50IHRvXG4gICAqIGVzdGFibGlzaCBhIGNvbm5lY3RlZCBzdGF0ZS5cbiAgICovXG4gIENyb3NzU3RvcmFnZUNsaWVudC5wcm90b3R5cGUuX3BvbGwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2xpZW50LCBpbnRlcnZhbCwgdGFyZ2V0T3JpZ2luO1xuXG4gICAgY2xpZW50ID0gdGhpcztcblxuICAgIC8vIHBvc3RNZXNzYWdlIHJlcXVpcmVzIHRoYXQgdGhlIHRhcmdldCBvcmlnaW4gYmUgc2V0IHRvIFwiKlwiIGZvciBcImZpbGU6Ly9cIlxuICAgIHRhcmdldE9yaWdpbiA9IChjbGllbnQuX29yaWdpbiA9PT0gJ2ZpbGU6Ly8nKSA/ICcqJyA6IGNsaWVudC5fb3JpZ2luO1xuXG4gICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgIGlmIChjbGllbnQuX2Nvbm5lY3RlZCkgcmV0dXJuIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgaWYgKCFjbGllbnQuX2h1YikgcmV0dXJuO1xuXG4gICAgICBjbGllbnQuX2h1Yi5wb3N0TWVzc2FnZSgnY3Jvc3Mtc3RvcmFnZTpwb2xsJywgdGFyZ2V0T3JpZ2luKTtcbiAgICB9LCAxMDAwKTtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBpRnJhbWUgY29udGFpbmluZyB0aGUgaHViLiBBcHBsaWVzIHRoZSBuZWNlc3Nhcnkgc3R5bGVzIHRvXG4gICAqIGhpZGUgdGhlIGVsZW1lbnQgZnJvbSB2aWV3LCBwcmlvciB0byBhZGRpbmcgaXQgdG8gdGhlIGRvY3VtZW50IGJvZHkuXG4gICAqIFJldHVybnMgdGhlIGNyZWF0ZWQgZWxlbWVudC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICpcbiAgICogQHBhcmFtICB7c3RyaW5nfSAgICAgICAgICAgIHVybCBUaGUgdXJsIHRvIHRoZSBodWJcbiAgICogcmV0dXJucyB7SFRNTElGcmFtZUVsZW1lbnR9IFRoZSBpRnJhbWUgZWxlbWVudCBpdHNlbGZcbiAgICovXG4gIENyb3NzU3RvcmFnZUNsaWVudC5wcm90b3R5cGUuX2NyZWF0ZUZyYW1lID0gZnVuY3Rpb24odXJsKSB7XG4gICAgdmFyIGZyYW1lLCBrZXk7XG5cbiAgICBmcmFtZSA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICBmcmFtZS5pZCA9IHRoaXMuX2ZyYW1lSWQ7XG5cbiAgICAvLyBTdHlsZSB0aGUgaWZyYW1lXG4gICAgZm9yIChrZXkgaW4gQ3Jvc3NTdG9yYWdlQ2xpZW50LmZyYW1lU3R5bGUpIHtcbiAgICAgIGlmIChDcm9zc1N0b3JhZ2VDbGllbnQuZnJhbWVTdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGZyYW1lLnN0eWxlW2tleV0gPSBDcm9zc1N0b3JhZ2VDbGllbnQuZnJhbWVTdHlsZVtrZXldO1xuICAgICAgfVxuICAgIH1cblxuICAgIHdpbmRvdy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZyYW1lKTtcbiAgICBmcmFtZS5zcmMgPSB1cmw7XG5cbiAgICByZXR1cm4gZnJhbWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNlbmRzIGEgbWVzc2FnZSBjb250YWluaW5nIHRoZSBnaXZlbiBtZXRob2QgYW5kIHBhcmFtcyB0byB0aGUgaHViLiBTdG9yZXNcbiAgICogYSBjYWxsYmFjayBpbiB0aGUgX3JlcXVlc3RzIG9iamVjdCBmb3IgbGF0ZXIgaW52b2NhdGlvbiBvbiBtZXNzYWdlLCBvclxuICAgKiBkZWxldGlvbiBvbiB0aW1lb3V0LiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGlzIHNldHRsZWQgaW4gZWl0aGVyIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKlxuICAgKiBAcGFyYW0gICB7c3RyaW5nfSAgbWV0aG9kIFRoZSBtZXRob2QgdG8gaW52b2tlXG4gICAqIEBwYXJhbSAgIHsqfSAgICAgICBwYXJhbXMgVGhlIGFyZ3VtZW50cyB0byBwYXNzXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyBzZXR0bGVkIG9uIGh1YiByZXNwb25zZSBvciB0aW1lb3V0XG4gICAqL1xuICBDcm9zc1N0b3JhZ2VDbGllbnQucHJvdG90eXBlLl9yZXF1ZXN0ID0gZnVuY3Rpb24obWV0aG9kLCBwYXJhbXMpIHtcbiAgICB2YXIgcmVxLCBjbGllbnQ7XG5cbiAgICBpZiAodGhpcy5fY2xvc2VkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdDcm9zc1N0b3JhZ2VDbGllbnQgaGFzIGNsb3NlZCcpKTtcbiAgICB9XG5cbiAgICBjbGllbnQgPSB0aGlzO1xuICAgIGNsaWVudC5fY291bnQrKztcblxuICAgIHJlcSA9IHtcbiAgICAgIGlkOiAgICAgdGhpcy5faWQgKyAnOicgKyBjbGllbnQuX2NvdW50LFxuICAgICAgbWV0aG9kOiAnY3Jvc3Mtc3RvcmFnZTonICsgbWV0aG9kLFxuICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyB0aGlzLl9wcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHRpbWVvdXQsIG9yaWdpbmFsVG9KU09OLCB0YXJnZXRPcmlnaW47XG5cbiAgICAgIC8vIFRpbWVvdXQgaWYgYSByZXNwb25zZSBpc24ndCByZWNlaXZlZCBhZnRlciA0c1xuICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghY2xpZW50Ll9yZXF1ZXN0c1tyZXEuaWRdKSByZXR1cm47XG5cbiAgICAgICAgZGVsZXRlIGNsaWVudC5fcmVxdWVzdHNbcmVxLmlkXTtcbiAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignVGltZW91dDogY291bGQgbm90IHBlcmZvcm0gJyArIHJlcS5tZXRob2QpKTtcbiAgICAgIH0sIGNsaWVudC5fdGltZW91dCk7XG5cbiAgICAgIC8vIEFkZCByZXF1ZXN0IGNhbGxiYWNrXG4gICAgICBjbGllbnQuX3JlcXVlc3RzW3JlcS5pZF0gPSBmdW5jdGlvbihlcnIsIHJlc3VsdCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgIGRlbGV0ZSBjbGllbnQuX3JlcXVlc3RzW3JlcS5pZF07XG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZWplY3QobmV3IEVycm9yKGVycikpO1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9O1xuXG4gICAgICAvLyBJbiBjYXNlIHdlIGhhdmUgYSBicm9rZW4gQXJyYXkucHJvdG90eXBlLnRvSlNPTiwgZS5nLiBiZWNhdXNlIG9mXG4gICAgICAvLyBvbGQgdmVyc2lvbnMgb2YgcHJvdG90eXBlXG4gICAgICBpZiAoQXJyYXkucHJvdG90eXBlLnRvSlNPTikge1xuICAgICAgICBvcmlnaW5hbFRvSlNPTiA9IEFycmF5LnByb3RvdHlwZS50b0pTT047XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS50b0pTT04gPSBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyBwb3N0TWVzc2FnZSByZXF1aXJlcyB0aGF0IHRoZSB0YXJnZXQgb3JpZ2luIGJlIHNldCB0byBcIipcIiBmb3IgXCJmaWxlOi8vXCJcbiAgICAgIHRhcmdldE9yaWdpbiA9IChjbGllbnQuX29yaWdpbiA9PT0gJ2ZpbGU6Ly8nKSA/ICcqJyA6IGNsaWVudC5fb3JpZ2luO1xuXG4gICAgICAvLyBTZW5kIHNlcmlhbGl6ZWQgbWVzc2FnZVxuICAgICAgY2xpZW50Ll9odWIucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkocmVxKSwgdGFyZ2V0T3JpZ2luKTtcblxuICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCB0b0pTT05cbiAgICAgIGlmIChvcmlnaW5hbFRvSlNPTikge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUudG9KU09OID0gb3JpZ2luYWxUb0pTT047XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEV4cG9ydCBmb3IgdmFyaW91cyBlbnZpcm9ubWVudHMuXG4gICAqL1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IENyb3NzU3RvcmFnZUNsaWVudDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBleHBvcnRzLkNyb3NzU3RvcmFnZUNsaWVudCA9IENyb3NzU3RvcmFnZUNsaWVudDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENyb3NzU3RvcmFnZUNsaWVudDtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByb290LkNyb3NzU3RvcmFnZUNsaWVudCA9IENyb3NzU3RvcmFnZUNsaWVudDtcbiAgfVxufSh0aGlzKSk7XG4iLCI7KGZ1bmN0aW9uKHJvb3QpIHtcbiAgdmFyIENyb3NzU3RvcmFnZUh1YiA9IHt9O1xuXG4gIC8qKlxuICAgKiBBY2NlcHRzIGFuIGFycmF5IG9mIG9iamVjdHMgd2l0aCB0d28ga2V5czogb3JpZ2luIGFuZCBhbGxvdy4gVGhlIHZhbHVlXG4gICAqIG9mIG9yaWdpbiBpcyBleHBlY3RlZCB0byBiZSBhIFJlZ0V4cCwgYW5kIGFsbG93LCBhbiBhcnJheSBvZiBzdHJpbmdzLlxuICAgKiBUaGUgY3Jvc3Mgc3RvcmFnZSBodWIgaXMgdGhlbiBpbml0aWFsaXplZCB0byBhY2NlcHQgcmVxdWVzdHMgZnJvbSBhbnkgb2ZcbiAgICogdGhlIG1hdGNoaW5nIG9yaWdpbnMsIGFsbG93aW5nIGFjY2VzcyB0byB0aGUgYXNzb2NpYXRlZCBsaXN0cyBvZiBtZXRob2RzLlxuICAgKiBNZXRob2RzIG1heSBpbmNsdWRlIGFueSBvZjogZ2V0LCBzZXQsIGRlbCwgZ2V0S2V5cyBhbmQgY2xlYXIuIEEgJ3JlYWR5J1xuICAgKiBtZXNzYWdlIGlzIHNlbnQgdG8gdGhlIHBhcmVudCB3aW5kb3cgb25jZSBjb21wbGV0ZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogLy8gU3ViZG9tYWluIGNhbiBnZXQsIGJ1dCBvbmx5IHJvb3QgZG9tYWluIGNhbiBzZXQgYW5kIGRlbFxuICAgKiBDcm9zc1N0b3JhZ2VIdWIuaW5pdChbXG4gICAqICAge29yaWdpbjogL1xcLmV4YW1wbGUuY29tJC8sICAgICAgICBhbGxvdzogWydnZXQnXX0sXG4gICAqICAge29yaWdpbjogLzood3d3XFwuKT9leGFtcGxlLmNvbSQvLCBhbGxvdzogWydnZXQnLCAnc2V0JywgJ2RlbCddfVxuICAgKiBdKTtcbiAgICpcbiAgICogQHBhcmFtIHthcnJheX0gcGVybWlzc2lvbnMgQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIG9yaWdpbiBhbmQgYWxsb3dcbiAgICovXG4gIENyb3NzU3RvcmFnZUh1Yi5pbml0ID0gZnVuY3Rpb24ocGVybWlzc2lvbnMpIHtcbiAgICB2YXIgYXZhaWxhYmxlID0gdHJ1ZTtcblxuICAgIC8vIFJldHVybiBpZiBsb2NhbFN0b3JhZ2UgaXMgdW5hdmFpbGFibGUsIG9yIHRoaXJkIHBhcnR5XG4gICAgLy8gYWNjZXNzIGlzIGRpc2FibGVkXG4gICAgdHJ5IHtcbiAgICAgIGlmICghd2luZG93LmxvY2FsU3RvcmFnZSkgYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgYXZhaWxhYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKCFhdmFpbGFibGUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKCdjcm9zcy1zdG9yYWdlOnVuYXZhaWxhYmxlJywgJyonKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIENyb3NzU3RvcmFnZUh1Yi5fcGVybWlzc2lvbnMgPSBwZXJtaXNzaW9ucyB8fCBbXTtcbiAgICBDcm9zc1N0b3JhZ2VIdWIuX2luc3RhbGxMaXN0ZW5lcigpO1xuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoJ2Nyb3NzLXN0b3JhZ2U6cmVhZHknLCAnKicpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbnN0YWxscyB0aGUgbmVjZXNzYXJ5IGxpc3RlbmVyIGZvciB0aGUgd2luZG93IG1lc3NhZ2UgZXZlbnQuIEFjY29tbW9kYXRlc1xuICAgKiBJRTggYW5kIHVwLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlSHViLl9pbnN0YWxsTGlzdGVuZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGlzdGVuZXIgPSBDcm9zc1N0b3JhZ2VIdWIuX2xpc3RlbmVyO1xuICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBsaXN0ZW5lciwgZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cuYXR0YWNoRXZlbnQoJ29ubWVzc2FnZScsIGxpc3RlbmVyKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFRoZSBtZXNzYWdlIGhhbmRsZXIgZm9yIGFsbCByZXF1ZXN0cyBwb3N0ZWQgdG8gdGhlIHdpbmRvdy4gSXQgaWdub3JlcyBhbnlcbiAgICogbWVzc2FnZXMgaGF2aW5nIGFuIG9yaWdpbiB0aGF0IGRvZXMgbm90IG1hdGNoIHRoZSBvcmlnaW5hbGx5IHN1cHBsaWVkXG4gICAqIHBhdHRlcm4uIEdpdmVuIGEgSlNPTiBvYmplY3Qgd2l0aCBvbmUgb2YgZ2V0LCBzZXQsIGRlbCBvciBnZXRLZXlzIGFzIHRoZVxuICAgKiBtZXRob2QsIHRoZSBmdW5jdGlvbiBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGFjdGlvbiBhbmQgcmV0dXJucyBpdHMgcmVzdWx0LlxuICAgKlxuICAgKiBAcGFyYW0ge01lc3NhZ2VFdmVudH0gbWVzc2FnZSBBIG1lc3NhZ2UgdG8gYmUgcHJvY2Vzc2VkXG4gICAqL1xuICBDcm9zc1N0b3JhZ2VIdWIuX2xpc3RlbmVyID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgIHZhciBvcmlnaW4sIHRhcmdldE9yaWdpbiwgcmVxdWVzdCwgbWV0aG9kLCBlcnJvciwgcmVzdWx0LCByZXNwb25zZTtcblxuICAgIC8vIHBvc3RNZXNzYWdlIHJldHVybnMgdGhlIHN0cmluZyBcIm51bGxcIiBhcyB0aGUgb3JpZ2luIGZvciBcImZpbGU6Ly9cIlxuICAgIG9yaWdpbiA9IChtZXNzYWdlLm9yaWdpbiA9PT0gJ251bGwnKSA/ICdmaWxlOi8vJyA6IG1lc3NhZ2Uub3JpZ2luO1xuXG4gICAgLy8gSGFuZGxlIHBvbGxpbmcgZm9yIGEgcmVhZHkgbWVzc2FnZVxuICAgIGlmIChtZXNzYWdlLmRhdGEgPT09ICdjcm9zcy1zdG9yYWdlOnBvbGwnKSB7XG4gICAgICByZXR1cm4gd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSgnY3Jvc3Mtc3RvcmFnZTpyZWFkeScsIG1lc3NhZ2Uub3JpZ2luKTtcbiAgICB9XG5cbiAgICAvLyBJZ25vcmUgdGhlIHJlYWR5IG1lc3NhZ2Ugd2hlbiB2aWV3aW5nIHRoZSBodWIgZGlyZWN0bHlcbiAgICBpZiAobWVzc2FnZS5kYXRhID09PSAnY3Jvc3Mtc3RvcmFnZTpyZWFkeScpIHJldHVybjtcblxuICAgIC8vIENoZWNrIHdoZXRoZXIgbWVzc2FnZS5kYXRhIGlzIGEgdmFsaWQganNvblxuICAgIHRyeSB7XG4gICAgICByZXF1ZXN0ID0gSlNPTi5wYXJzZShtZXNzYWdlLmRhdGEpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHdoZXRoZXIgcmVxdWVzdC5tZXRob2QgaXMgYSBzdHJpbmdcbiAgICBpZiAoIXJlcXVlc3QgfHwgdHlwZW9mIHJlcXVlc3QubWV0aG9kICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIG1ldGhvZCA9IHJlcXVlc3QubWV0aG9kLnNwbGl0KCdjcm9zcy1zdG9yYWdlOicpWzFdO1xuXG4gICAgaWYgKCFtZXRob2QpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKCFDcm9zc1N0b3JhZ2VIdWIuX3Blcm1pdHRlZChvcmlnaW4sIG1ldGhvZCkpIHtcbiAgICAgIGVycm9yID0gJ0ludmFsaWQgcGVybWlzc2lvbnMgZm9yICcgKyBtZXRob2Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlc3VsdCA9IENyb3NzU3RvcmFnZUh1YlsnXycgKyBtZXRob2RdKHJlcXVlc3QucGFyYW1zKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBlcnJvciA9IGVyci5tZXNzYWdlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlc3BvbnNlID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgaWQ6IHJlcXVlc3QuaWQsXG4gICAgICBlcnJvcjogZXJyb3IsXG4gICAgICByZXN1bHQ6IHJlc3VsdFxuICAgIH0pO1xuXG4gICAgLy8gcG9zdE1lc3NhZ2UgcmVxdWlyZXMgdGhhdCB0aGUgdGFyZ2V0IG9yaWdpbiBiZSBzZXQgdG8gXCIqXCIgZm9yIFwiZmlsZTovL1wiXG4gICAgdGFyZ2V0T3JpZ2luID0gKG9yaWdpbiA9PT0gJ2ZpbGU6Ly8nKSA/ICcqJyA6IG9yaWdpbjtcblxuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UocmVzcG9uc2UsIHRhcmdldE9yaWdpbik7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciBvciBub3QgdGhlIHJlcXVlc3RlZCBtZXRob2QgaXNcbiAgICogcGVybWl0dGVkIGZvciB0aGUgZ2l2ZW4gb3JpZ2luLiBUaGUgYXJndW1lbnQgcGFzc2VkIHRvIG1ldGhvZCBpcyBleHBlY3RlZFxuICAgKiB0byBiZSBvbmUgb2YgJ2dldCcsICdzZXQnLCAnZGVsJyBvciAnZ2V0S2V5cycuXG4gICAqXG4gICAqIEBwYXJhbSAgIHtzdHJpbmd9IG9yaWdpbiBUaGUgb3JpZ2luIGZvciB3aGljaCB0byBkZXRlcm1pbmUgcGVybWlzc2lvbnNcbiAgICogQHBhcmFtICAge3N0cmluZ30gbWV0aG9kIFJlcXVlc3RlZCBhY3Rpb25cbiAgICogQHJldHVybnMge2Jvb2x9ICAgV2hldGhlciBvciBub3QgdGhlIHJlcXVlc3QgaXMgcGVybWl0dGVkXG4gICAqL1xuICBDcm9zc1N0b3JhZ2VIdWIuX3Blcm1pdHRlZCA9IGZ1bmN0aW9uKG9yaWdpbiwgbWV0aG9kKSB7XG4gICAgdmFyIGF2YWlsYWJsZSwgaSwgZW50cnksIG1hdGNoO1xuXG4gICAgYXZhaWxhYmxlID0gWydnZXQnLCAnc2V0JywgJ2RlbCcsICdjbGVhcicsICdnZXRLZXlzJ107XG4gICAgaWYgKCFDcm9zc1N0b3JhZ2VIdWIuX2luQXJyYXkobWV0aG9kLCBhdmFpbGFibGUpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMDsgaSA8IENyb3NzU3RvcmFnZUh1Yi5fcGVybWlzc2lvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGVudHJ5ID0gQ3Jvc3NTdG9yYWdlSHViLl9wZXJtaXNzaW9uc1tpXTtcbiAgICAgIGlmICghKGVudHJ5Lm9yaWdpbiBpbnN0YW5jZW9mIFJlZ0V4cCkgfHwgIShlbnRyeS5hbGxvdyBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgbWF0Y2ggPSBlbnRyeS5vcmlnaW4udGVzdChvcmlnaW4pO1xuICAgICAgaWYgKG1hdGNoICYmIENyb3NzU3RvcmFnZUh1Yi5faW5BcnJheShtZXRob2QsIGVudHJ5LmFsbG93KSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHMgYSBrZXkgdG8gdGhlIHNwZWNpZmllZCB2YWx1ZS5cbiAgICpcbiAgICogQHBhcmFtIHtvYmplY3R9IHBhcmFtcyBBbiBvYmplY3Qgd2l0aCBrZXkgYW5kIHZhbHVlXG4gICAqL1xuICBDcm9zc1N0b3JhZ2VIdWIuX3NldCA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShwYXJhbXMua2V5LCBwYXJhbXMudmFsdWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBY2NlcHRzIGFuIG9iamVjdCB3aXRoIGFuIGFycmF5IG9mIGtleXMgZm9yIHdoaWNoIHRvIHJldHJpZXZlIHRoZWlyIHZhbHVlcy5cbiAgICogUmV0dXJucyBhIHNpbmdsZSB2YWx1ZSBpZiBvbmx5IG9uZSBrZXkgd2FzIHN1cHBsaWVkLCBvdGhlcndpc2UgaXQgcmV0dXJuc1xuICAgKiBhbiBhcnJheS4gQW55IGtleXMgbm90IHNldCByZXN1bHQgaW4gYSBudWxsIGVsZW1lbnQgaW4gdGhlIHJlc3VsdGluZyBhcnJheS5cbiAgICpcbiAgICogQHBhcmFtICAge29iamVjdH0gcGFyYW1zIEFuIG9iamVjdCB3aXRoIGFuIGFycmF5IG9mIGtleXNcbiAgICogQHJldHVybnMgeyp8KltdfSAgRWl0aGVyIGEgc2luZ2xlIHZhbHVlLCBvciBhbiBhcnJheVxuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlSHViLl9nZXQgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICB2YXIgc3RvcmFnZSwgcmVzdWx0LCBpLCB2YWx1ZTtcblxuICAgIHN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IHBhcmFtcy5rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICB2YWx1ZSA9IHN0b3JhZ2UuZ2V0SXRlbShwYXJhbXMua2V5c1tpXSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHZhbHVlID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgIH1cblxuICAgIHJldHVybiAocmVzdWx0Lmxlbmd0aCA+IDEpID8gcmVzdWx0IDogcmVzdWx0WzBdO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWxldGVzIGFsbCBrZXlzIHNwZWNpZmllZCBpbiB0aGUgYXJyYXkgZm91bmQgYXQgcGFyYW1zLmtleXMuXG4gICAqXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBwYXJhbXMgQW4gb2JqZWN0IHdpdGggYW4gYXJyYXkgb2Yga2V5c1xuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlSHViLl9kZWwgPSBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtcy5rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0ocGFyYW1zLmtleXNbaV0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2xlYXJzIGxvY2FsU3RvcmFnZS5cbiAgICovXG4gIENyb3NzU3RvcmFnZUh1Yi5fY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gYXJyYXkgb2YgYWxsIGtleXMgc3RvcmVkIGluIGxvY2FsU3RvcmFnZS5cbiAgICpcbiAgICogQHJldHVybnMge3N0cmluZ1tdfSBUaGUgYXJyYXkgb2Yga2V5c1xuICAgKi9cbiAgQ3Jvc3NTdG9yYWdlSHViLl9nZXRLZXlzID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgdmFyIGksIGxlbmd0aCwga2V5cztcblxuICAgIGtleXMgPSBbXTtcbiAgICBsZW5ndGggPSB3aW5kb3cubG9jYWxTdG9yYWdlLmxlbmd0aDtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5cy5wdXNoKHdpbmRvdy5sb2NhbFN0b3JhZ2Uua2V5KGkpKTtcbiAgICB9XG5cbiAgICByZXR1cm4ga2V5cztcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBhIHZhbHVlIGlzIHByZXNlbnQgaW4gdGhlIGFycmF5LiBDb25zaXN0cyBvZiBhblxuICAgKiBhbHRlcm5hdGl2ZSB0byBleHRlbmRpbmcgdGhlIGFycmF5IHByb3RvdHlwZSBmb3IgaW5kZXhPZiwgc2luY2UgaXQnc1xuICAgKiB1bmF2YWlsYWJsZSBmb3IgSUU4LlxuICAgKlxuICAgKiBAcGFyYW0gICB7Kn0gICAgdmFsdWUgVGhlIHZhbHVlIHRvIGZpbmRcbiAgICogQHBhcm1hICAge1tdKn0gIGFycmF5IFRoZSBhcnJheSBpbiB3aGljaCB0byBzZWFyY2hcbiAgICogQHJldHVybnMge2Jvb2x9IFdoZXRoZXIgb3Igbm90IHRoZSB2YWx1ZSB3YXMgZm91bmRcbiAgICovXG4gIENyb3NzU3RvcmFnZUh1Yi5faW5BcnJheSA9IGZ1bmN0aW9uKHZhbHVlLCBhcnJheSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh2YWx1ZSA9PT0gYXJyYXlbaV0pIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvKipcbiAgICogQSBjcm9zcy1icm93c2VyIHZlcnNpb24gb2YgRGF0ZS5ub3cgY29tcGF0aWJsZSB3aXRoIElFOCB0aGF0IGF2b2lkc1xuICAgKiBtb2RpZnlpbmcgdGhlIERhdGUgb2JqZWN0LlxuICAgKlxuICAgKiBAcmV0dXJuIHtpbnR9IFRoZSBjdXJyZW50IHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHNcbiAgICovXG4gIENyb3NzU3RvcmFnZUh1Yi5fbm93ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHR5cGVvZiBEYXRlLm5vdyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIERhdGUubm93KCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFeHBvcnQgZm9yIHZhcmlvdXMgZW52aXJvbm1lbnRzLlxuICAgKi9cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBDcm9zc1N0b3JhZ2VIdWI7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgZXhwb3J0cy5Dcm9zc1N0b3JhZ2VIdWIgPSBDcm9zc1N0b3JhZ2VIdWI7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFtdLCBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBDcm9zc1N0b3JhZ2VIdWI7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcm9vdC5Dcm9zc1N0b3JhZ2VIdWIgPSBDcm9zc1N0b3JhZ2VIdWI7XG4gIH1cbn0odGhpcykpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIENyb3NzU3RvcmFnZUNsaWVudDogcmVxdWlyZSgnLi9jbGllbnQuanMnKSxcbiAgQ3Jvc3NTdG9yYWdlSHViOiAgICByZXF1aXJlKCcuL2h1Yi5qcycpXG59O1xuIiwiLyohIChDKSBBbmRyZWEgR2lhbW1hcmNoaSAtIEBXZWJSZWZsZWN0aW9uIC0gSVNDIFN0eWxlIExpY2Vuc2UgKi9cbihmdW5jdGlvbih3aW5kb3cscG9seWZpbGwpe1widXNlIHN0cmljdFwiO3ZhciBkb2N1bWVudD13aW5kb3cuZG9jdW1lbnQsT2JqZWN0PXdpbmRvdy5PYmplY3Q7dmFyIGh0bWxDbGFzcz1mdW5jdGlvbihpbmZvKXt2YXIgY2F0Y2hDbGFzcz0vXltBLVpdK1thLXpdLyxmaWx0ZXJCeT1mdW5jdGlvbihyZSl7dmFyIGFycj1bXSx0YWc7Zm9yKHRhZyBpbiByZWdpc3Rlcil7aWYocmUudGVzdCh0YWcpKWFyci5wdXNoKHRhZyl9cmV0dXJuIGFycn0sYWRkPWZ1bmN0aW9uKENsYXNzLHRhZyl7dGFnPXRhZy50b0xvd2VyQ2FzZSgpO2lmKCEodGFnIGluIHJlZ2lzdGVyKSl7cmVnaXN0ZXJbQ2xhc3NdPShyZWdpc3RlcltDbGFzc118fFtdKS5jb25jYXQodGFnKTtyZWdpc3Rlclt0YWddPXJlZ2lzdGVyW3RhZy50b1VwcGVyQ2FzZSgpXT1DbGFzc319LHJlZ2lzdGVyPShPYmplY3QuY3JlYXRlfHxPYmplY3QpKG51bGwpLGh0bWxDbGFzcz17fSxpLHNlY3Rpb24sdGFncyxDbGFzcztmb3Ioc2VjdGlvbiBpbiBpbmZvKXtmb3IoQ2xhc3MgaW4gaW5mb1tzZWN0aW9uXSl7dGFncz1pbmZvW3NlY3Rpb25dW0NsYXNzXTtyZWdpc3RlcltDbGFzc109dGFncztmb3IoaT0wO2k8dGFncy5sZW5ndGg7aSsrKXtyZWdpc3Rlclt0YWdzW2ldLnRvTG93ZXJDYXNlKCldPXJlZ2lzdGVyW3RhZ3NbaV0udG9VcHBlckNhc2UoKV09Q2xhc3N9fX1odG1sQ2xhc3MuZ2V0PWZ1bmN0aW9uIGdldCh0YWdPckNsYXNzKXtyZXR1cm4gdHlwZW9mIHRhZ09yQ2xhc3M9PT1cInN0cmluZ1wiP3JlZ2lzdGVyW3RhZ09yQ2xhc3NdfHwoY2F0Y2hDbGFzcy50ZXN0KHRhZ09yQ2xhc3MpP1tdOlwiXCIpOmZpbHRlckJ5KHRhZ09yQ2xhc3MpfTtodG1sQ2xhc3Muc2V0PWZ1bmN0aW9uIHNldCh0YWcsQ2xhc3Mpe3JldHVybiBjYXRjaENsYXNzLnRlc3QodGFnKT9hZGQodGFnLENsYXNzKTphZGQoQ2xhc3MsdGFnKSxodG1sQ2xhc3N9O3JldHVybiBodG1sQ2xhc3N9KHtjb2xsZWN0aW9uczp7SFRNTEFsbENvbGxlY3Rpb246W1wiYWxsXCJdLEhUTUxDb2xsZWN0aW9uOltcImZvcm1zXCJdLEhUTUxGb3JtQ29udHJvbHNDb2xsZWN0aW9uOltcImVsZW1lbnRzXCJdLEhUTUxPcHRpb25zQ29sbGVjdGlvbjpbXCJvcHRpb25zXCJdfSxlbGVtZW50czp7RWxlbWVudDpbXCJlbGVtZW50XCJdLEhUTUxBbmNob3JFbGVtZW50OltcImFcIl0sSFRNTEFwcGxldEVsZW1lbnQ6W1wiYXBwbGV0XCJdLEhUTUxBcmVhRWxlbWVudDpbXCJhcmVhXCJdLEhUTUxBdHRhY2htZW50RWxlbWVudDpbXCJhdHRhY2htZW50XCJdLEhUTUxBdWRpb0VsZW1lbnQ6W1wiYXVkaW9cIl0sSFRNTEJSRWxlbWVudDpbXCJiclwiXSxIVE1MQmFzZUVsZW1lbnQ6W1wiYmFzZVwiXSxIVE1MQm9keUVsZW1lbnQ6W1wiYm9keVwiXSxIVE1MQnV0dG9uRWxlbWVudDpbXCJidXR0b25cIl0sSFRNTENhbnZhc0VsZW1lbnQ6W1wiY2FudmFzXCJdLEhUTUxDb250ZW50RWxlbWVudDpbXCJjb250ZW50XCJdLEhUTUxETGlzdEVsZW1lbnQ6W1wiZGxcIl0sSFRNTERhdGFFbGVtZW50OltcImRhdGFcIl0sSFRNTERhdGFMaXN0RWxlbWVudDpbXCJkYXRhbGlzdFwiXSxIVE1MRGV0YWlsc0VsZW1lbnQ6W1wiZGV0YWlsc1wiXSxIVE1MRGlhbG9nRWxlbWVudDpbXCJkaWFsb2dcIl0sSFRNTERpcmVjdG9yeUVsZW1lbnQ6W1wiZGlyXCJdLEhUTUxEaXZFbGVtZW50OltcImRpdlwiXSxIVE1MRG9jdW1lbnQ6W1wiZG9jdW1lbnRcIl0sSFRNTEVsZW1lbnQ6W1wiZWxlbWVudFwiLFwiYWJiclwiLFwiYWRkcmVzc1wiLFwiYXJ0aWNsZVwiLFwiYXNpZGVcIixcImJcIixcImJkaVwiLFwiYmRvXCIsXCJjaXRlXCIsXCJjb2RlXCIsXCJjb21tYW5kXCIsXCJkZFwiLFwiZGZuXCIsXCJkdFwiLFwiZW1cIixcImZpZ2NhcHRpb25cIixcImZpZ3VyZVwiLFwiZm9vdGVyXCIsXCJoZWFkZXJcIixcImlcIixcImtiZFwiLFwibWFya1wiLFwibmF2XCIsXCJub3NjcmlwdFwiLFwicnBcIixcInJ0XCIsXCJydWJ5XCIsXCJzXCIsXCJzYW1wXCIsXCJzZWN0aW9uXCIsXCJzbWFsbFwiLFwic3Ryb25nXCIsXCJzdWJcIixcInN1bW1hcnlcIixcInN1cFwiLFwidVwiLFwidmFyXCIsXCJ3YnJcIl0sSFRNTEVtYmVkRWxlbWVudDpbXCJlbWJlZFwiXSxIVE1MRmllbGRTZXRFbGVtZW50OltcImZpZWxkc2V0XCJdLEhUTUxGb250RWxlbWVudDpbXCJmb250XCJdLEhUTUxGb3JtRWxlbWVudDpbXCJmb3JtXCJdLEhUTUxGcmFtZUVsZW1lbnQ6W1wiZnJhbWVcIl0sSFRNTEZyYW1lU2V0RWxlbWVudDpbXCJmcmFtZXNldFwiXSxIVE1MSFJFbGVtZW50OltcImhyXCJdLEhUTUxIZWFkRWxlbWVudDpbXCJoZWFkXCJdLEhUTUxIZWFkaW5nRWxlbWVudDpbXCJoMVwiLFwiaDJcIixcImgzXCIsXCJoNFwiLFwiaDVcIixcImg2XCJdLEhUTUxIdG1sRWxlbWVudDpbXCJodG1sXCJdLEhUTUxJRnJhbWVFbGVtZW50OltcImlmcmFtZVwiXSxIVE1MSW1hZ2VFbGVtZW50OltcImltZ1wiXSxIVE1MSW5wdXRFbGVtZW50OltcImlucHV0XCJdLEhUTUxLZXlnZW5FbGVtZW50OltcImtleWdlblwiXSxIVE1MTElFbGVtZW50OltcImxpXCJdLEhUTUxMYWJlbEVsZW1lbnQ6W1wibGFiZWxcIl0sSFRNTExlZ2VuZEVsZW1lbnQ6W1wibGVnZW5kXCJdLEhUTUxMaW5rRWxlbWVudDpbXCJsaW5rXCJdLEhUTUxNYXBFbGVtZW50OltcIm1hcFwiXSxIVE1MTWFycXVlZUVsZW1lbnQ6W1wibWFycXVlZVwiXSxIVE1MTWVkaWFFbGVtZW50OltcIm1lZGlhXCJdLEhUTUxNZW51RWxlbWVudDpbXCJtZW51XCJdLEhUTUxNZW51SXRlbUVsZW1lbnQ6W1wibWVudWl0ZW1cIl0sSFRNTE1ldGFFbGVtZW50OltcIm1ldGFcIl0sSFRNTE1ldGVyRWxlbWVudDpbXCJtZXRlclwiXSxIVE1MTW9kRWxlbWVudDpbXCJkZWxcIixcImluc1wiXSxIVE1MT0xpc3RFbGVtZW50OltcIm9sXCJdLEhUTUxPYmplY3RFbGVtZW50OltcIm9iamVjdFwiXSxIVE1MT3B0R3JvdXBFbGVtZW50OltcIm9wdGdyb3VwXCJdLEhUTUxPcHRpb25FbGVtZW50OltcIm9wdGlvblwiXSxIVE1MT3V0cHV0RWxlbWVudDpbXCJvdXRwdXRcIl0sSFRNTFBhcmFncmFwaEVsZW1lbnQ6W1wicFwiXSxIVE1MUGFyYW1FbGVtZW50OltcInBhcmFtXCJdLEhUTUxQaWN0dXJlRWxlbWVudDpbXCJwaWN0dXJlXCJdLEhUTUxQcmVFbGVtZW50OltcInByZVwiXSxIVE1MUHJvZ3Jlc3NFbGVtZW50OltcInByb2dyZXNzXCJdLEhUTUxRdW90ZUVsZW1lbnQ6W1wiYmxvY2txdW90ZVwiLFwicVwiLFwicXVvdGVcIl0sSFRNTFNjcmlwdEVsZW1lbnQ6W1wic2NyaXB0XCJdLEhUTUxTZWxlY3RFbGVtZW50OltcInNlbGVjdFwiXSxIVE1MU2hhZG93RWxlbWVudDpbXCJzaGFkb3dcIl0sSFRNTFNsb3RFbGVtZW50OltcInNsb3RcIl0sSFRNTFNvdXJjZUVsZW1lbnQ6W1wic291cmNlXCJdLEhUTUxTcGFuRWxlbWVudDpbXCJzcGFuXCJdLEhUTUxTdHlsZUVsZW1lbnQ6W1wic3R5bGVcIl0sSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnQ6W1wiY2FwdGlvblwiXSxIVE1MVGFibGVDZWxsRWxlbWVudDpbXCJ0ZFwiLFwidGhcIl0sSFRNTFRhYmxlQ29sRWxlbWVudDpbXCJjb2xcIixcImNvbGdyb3VwXCJdLEhUTUxUYWJsZUVsZW1lbnQ6W1widGFibGVcIl0sSFRNTFRhYmxlUm93RWxlbWVudDpbXCJ0clwiXSxIVE1MVGFibGVTZWN0aW9uRWxlbWVudDpbXCJ0aGVhZFwiLFwidGJvZHlcIixcInRmb290XCJdLEhUTUxUZW1wbGF0ZUVsZW1lbnQ6W1widGVtcGxhdGVcIl0sSFRNTFRleHRBcmVhRWxlbWVudDpbXCJ0ZXh0YXJlYVwiXSxIVE1MVGltZUVsZW1lbnQ6W1widGltZVwiXSxIVE1MVGl0bGVFbGVtZW50OltcInRpdGxlXCJdLEhUTUxUcmFja0VsZW1lbnQ6W1widHJhY2tcIl0sSFRNTFVMaXN0RWxlbWVudDpbXCJ1bFwiXSxIVE1MVW5rbm93bkVsZW1lbnQ6W1widW5rbm93blwiLFwidmhncm91cHZcIixcInZrZXlnZW5cIl0sSFRNTFZpZGVvRWxlbWVudDpbXCJ2aWRlb1wiXX0sbm9kZXM6e0F0dHI6W1wibm9kZVwiXSxBdWRpbzpbXCJhdWRpb1wiXSxDREFUQVNlY3Rpb246W1wibm9kZVwiXSxDaGFyYWN0ZXJEYXRhOltcIm5vZGVcIl0sQ29tbWVudDpbXCIjY29tbWVudFwiXSxEb2N1bWVudDpbXCIjZG9jdW1lbnRcIl0sRG9jdW1lbnRGcmFnbWVudDpbXCIjZG9jdW1lbnQtZnJhZ21lbnRcIl0sRG9jdW1lbnRUeXBlOltcIm5vZGVcIl0sSFRNTERvY3VtZW50OltcIiNkb2N1bWVudFwiXSxJbWFnZTpbXCJpbWdcIl0sT3B0aW9uOltcIm9wdGlvblwiXSxQcm9jZXNzaW5nSW5zdHJ1Y3Rpb246W1wibm9kZVwiXSxTaGFkb3dSb290OltcIiNzaGFkb3ctcm9vdFwiXSxUZXh0OltcIiN0ZXh0XCJdLFhNTERvY3VtZW50OltcInhtbFwiXX19KTtpZih0eXBlb2YgcG9seWZpbGwhPT1cIm9iamVjdFwiKXBvbHlmaWxsPXt0eXBlOnBvbHlmaWxsfHxcImF1dG9cIn07dmFyIFJFR0lTVEVSX0VMRU1FTlQ9XCJyZWdpc3RlckVsZW1lbnRcIixFWFBBTkRPX1VJRD1cIl9fXCIrUkVHSVNURVJfRUxFTUVOVCsod2luZG93Lk1hdGgucmFuZG9tKCkqMWU1Pj4wKSxBRERfRVZFTlRfTElTVEVORVI9XCJhZGRFdmVudExpc3RlbmVyXCIsQVRUQUNIRUQ9XCJhdHRhY2hlZFwiLENBTExCQUNLPVwiQ2FsbGJhY2tcIixERVRBQ0hFRD1cImRldGFjaGVkXCIsRVhURU5EUz1cImV4dGVuZHNcIixBVFRSSUJVVEVfQ0hBTkdFRF9DQUxMQkFDSz1cImF0dHJpYnV0ZUNoYW5nZWRcIitDQUxMQkFDSyxBVFRBQ0hFRF9DQUxMQkFDSz1BVFRBQ0hFRCtDQUxMQkFDSyxDT05ORUNURURfQ0FMTEJBQ0s9XCJjb25uZWN0ZWRcIitDQUxMQkFDSyxESVNDT05ORUNURURfQ0FMTEJBQ0s9XCJkaXNjb25uZWN0ZWRcIitDQUxMQkFDSyxDUkVBVEVEX0NBTExCQUNLPVwiY3JlYXRlZFwiK0NBTExCQUNLLERFVEFDSEVEX0NBTExCQUNLPURFVEFDSEVEK0NBTExCQUNLLEFERElUSU9OPVwiQURESVRJT05cIixNT0RJRklDQVRJT049XCJNT0RJRklDQVRJT05cIixSRU1PVkFMPVwiUkVNT1ZBTFwiLERPTV9BVFRSX01PRElGSUVEPVwiRE9NQXR0ck1vZGlmaWVkXCIsRE9NX0NPTlRFTlRfTE9BREVEPVwiRE9NQ29udGVudExvYWRlZFwiLERPTV9TVUJUUkVFX01PRElGSUVEPVwiRE9NU3VidHJlZU1vZGlmaWVkXCIsUFJFRklYX1RBRz1cIjxcIixQUkVGSVhfSVM9XCI9XCIsdmFsaWROYW1lPS9eW0EtWl1bQS1aMC05XSooPzotW0EtWjAtOV0rKSskLyxpbnZhbGlkTmFtZXM9W1wiQU5OT1RBVElPTi1YTUxcIixcIkNPTE9SLVBST0ZJTEVcIixcIkZPTlQtRkFDRVwiLFwiRk9OVC1GQUNFLVNSQ1wiLFwiRk9OVC1GQUNFLVVSSVwiLFwiRk9OVC1GQUNFLUZPUk1BVFwiLFwiRk9OVC1GQUNFLU5BTUVcIixcIk1JU1NJTkctR0xZUEhcIl0sdHlwZXM9W10scHJvdG9zPVtdLHF1ZXJ5PVwiXCIsZG9jdW1lbnRFbGVtZW50PWRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxpbmRleE9mPXR5cGVzLmluZGV4T2Z8fGZ1bmN0aW9uKHYpe2Zvcih2YXIgaT10aGlzLmxlbmd0aDtpLS0mJnRoaXNbaV0hPT12Oyl7fXJldHVybiBpfSxPUD1PYmplY3QucHJvdG90eXBlLGhPUD1PUC5oYXNPd25Qcm9wZXJ0eSxpUE89T1AuaXNQcm90b3R5cGVPZixkZWZpbmVQcm9wZXJ0eT1PYmplY3QuZGVmaW5lUHJvcGVydHksZW1wdHk9W10sZ09QRD1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLGdPUE49T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsZ1BPPU9iamVjdC5nZXRQcm90b3R5cGVPZixzUE89T2JqZWN0LnNldFByb3RvdHlwZU9mLGhhc1Byb3RvPSEhT2JqZWN0Ll9fcHJvdG9fXyxmaXhHZXRDbGFzcz1mYWxzZSxEUkVDRVYxPVwiX19kcmVDRXYxXCIsY3VzdG9tRWxlbWVudHM9d2luZG93LmN1c3RvbUVsZW1lbnRzLHVzYWJsZUN1c3RvbUVsZW1lbnRzPSEvXmZvcmNlLy50ZXN0KHBvbHlmaWxsLnR5cGUpJiYhIShjdXN0b21FbGVtZW50cyYmY3VzdG9tRWxlbWVudHMuZGVmaW5lJiZjdXN0b21FbGVtZW50cy5nZXQmJmN1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKSxEaWN0PU9iamVjdC5jcmVhdGV8fE9iamVjdCxNYXA9d2luZG93Lk1hcHx8ZnVuY3Rpb24gTWFwKCl7dmFyIEs9W10sVj1bXSxpO3JldHVybntnZXQ6ZnVuY3Rpb24oayl7cmV0dXJuIFZbaW5kZXhPZi5jYWxsKEssayldfSxzZXQ6ZnVuY3Rpb24oayx2KXtpPWluZGV4T2YuY2FsbChLLGspO2lmKGk8MClWW0sucHVzaChrKS0xXT12O2Vsc2UgVltpXT12fX19LFByb21pc2U9d2luZG93LlByb21pc2V8fGZ1bmN0aW9uKGZuKXt2YXIgbm90aWZ5PVtdLGRvbmU9ZmFsc2UscD17Y2F0Y2g6ZnVuY3Rpb24oKXtyZXR1cm4gcH0sdGhlbjpmdW5jdGlvbihjYil7bm90aWZ5LnB1c2goY2IpO2lmKGRvbmUpc2V0VGltZW91dChyZXNvbHZlLDEpO3JldHVybiBwfX07ZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSl7ZG9uZT10cnVlO3doaWxlKG5vdGlmeS5sZW5ndGgpbm90aWZ5LnNoaWZ0KCkodmFsdWUpfWZuKHJlc29sdmUpO3JldHVybiBwfSxqdXN0Q3JlYXRlZD1mYWxzZSxjb25zdHJ1Y3RvcnM9RGljdChudWxsKSx3YWl0aW5nTGlzdD1EaWN0KG51bGwpLG5vZGVOYW1lcz1uZXcgTWFwLHNlY29uZEFyZ3VtZW50PWZ1bmN0aW9uKGlzKXtyZXR1cm4gaXMudG9Mb3dlckNhc2UoKX0sY3JlYXRlPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uIEJyaWRnZShwcm90byl7cmV0dXJuIHByb3RvPyhCcmlkZ2UucHJvdG90eXBlPXByb3RvLG5ldyBCcmlkZ2UpOnRoaXN9LHNldFByb3RvdHlwZT1zUE98fChoYXNQcm90bz9mdW5jdGlvbihvLHApe28uX19wcm90b19fPXA7cmV0dXJuIG99OmdPUE4mJmdPUEQ/ZnVuY3Rpb24oKXtmdW5jdGlvbiBzZXRQcm9wZXJ0aWVzKG8scCl7Zm9yKHZhciBrZXksbmFtZXM9Z09QTihwKSxpPTAsbGVuZ3RoPW5hbWVzLmxlbmd0aDtpPGxlbmd0aDtpKyspe2tleT1uYW1lc1tpXTtpZighaE9QLmNhbGwobyxrZXkpKXtkZWZpbmVQcm9wZXJ0eShvLGtleSxnT1BEKHAsa2V5KSl9fX1yZXR1cm4gZnVuY3Rpb24obyxwKXtkb3tzZXRQcm9wZXJ0aWVzKG8scCl9d2hpbGUoKHA9Z1BPKHApKSYmIWlQTy5jYWxsKHAsbykpO3JldHVybiBvfX0oKTpmdW5jdGlvbihvLHApe2Zvcih2YXIga2V5IGluIHApe29ba2V5XT1wW2tleV19cmV0dXJuIG99KSxNdXRhdGlvbk9ic2VydmVyPXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcixIVE1MRWxlbWVudFByb3RvdHlwZT0od2luZG93LkhUTUxFbGVtZW50fHx3aW5kb3cuRWxlbWVudHx8d2luZG93Lk5vZGUpLnByb3RvdHlwZSxJRTg9IWlQTy5jYWxsKEhUTUxFbGVtZW50UHJvdG90eXBlLGRvY3VtZW50RWxlbWVudCksc2FmZVByb3BlcnR5PUlFOD9mdW5jdGlvbihvLGssZCl7b1trXT1kLnZhbHVlO3JldHVybiBvfTpkZWZpbmVQcm9wZXJ0eSxpc1ZhbGlkTm9kZT1JRTg/ZnVuY3Rpb24obm9kZSl7cmV0dXJuIG5vZGUubm9kZVR5cGU9PT0xfTpmdW5jdGlvbihub2RlKXtyZXR1cm4gaVBPLmNhbGwoSFRNTEVsZW1lbnRQcm90b3R5cGUsbm9kZSl9LHRhcmdldHM9SUU4JiZbXSxhdHRhY2hTaGFkb3c9SFRNTEVsZW1lbnRQcm90b3R5cGUuYXR0YWNoU2hhZG93LGNsb25lTm9kZT1IVE1MRWxlbWVudFByb3RvdHlwZS5jbG9uZU5vZGUsZGlzcGF0Y2hFdmVudD1IVE1MRWxlbWVudFByb3RvdHlwZS5kaXNwYXRjaEV2ZW50LGdldEF0dHJpYnV0ZT1IVE1MRWxlbWVudFByb3RvdHlwZS5nZXRBdHRyaWJ1dGUsaGFzQXR0cmlidXRlPUhUTUxFbGVtZW50UHJvdG90eXBlLmhhc0F0dHJpYnV0ZSxyZW1vdmVBdHRyaWJ1dGU9SFRNTEVsZW1lbnRQcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlLHNldEF0dHJpYnV0ZT1IVE1MRWxlbWVudFByb3RvdHlwZS5zZXRBdHRyaWJ1dGUsY3JlYXRlRWxlbWVudD1kb2N1bWVudC5jcmVhdGVFbGVtZW50LHBhdGNoZWRDcmVhdGVFbGVtZW50PWNyZWF0ZUVsZW1lbnQsYXR0cmlidXRlc09ic2VydmVyPU11dGF0aW9uT2JzZXJ2ZXImJnthdHRyaWJ1dGVzOnRydWUsY2hhcmFjdGVyRGF0YTp0cnVlLGF0dHJpYnV0ZU9sZFZhbHVlOnRydWV9LERPTUF0dHJNb2RpZmllZD1NdXRhdGlvbk9ic2VydmVyfHxmdW5jdGlvbihlKXtkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZD1mYWxzZTtkb2N1bWVudEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihET01fQVRUUl9NT0RJRklFRCxET01BdHRyTW9kaWZpZWQpfSxhc2FwUXVldWUsYXNhcFRpbWVyPTAsVjA9UkVHSVNURVJfRUxFTUVOVCBpbiBkb2N1bWVudCYmIS9eZm9yY2UtYWxsLy50ZXN0KHBvbHlmaWxsLnR5cGUpLHNldExpc3RlbmVyPXRydWUsanVzdFNldHVwPWZhbHNlLGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkPXRydWUsZHJvcERvbUNvbnRlbnRMb2FkZWQ9dHJ1ZSxub3RGcm9tSW5uZXJIVE1MSGVscGVyPXRydWUsb25TdWJ0cmVlTW9kaWZpZWQsY2FsbERPTUF0dHJNb2RpZmllZCxnZXRBdHRyaWJ1dGVzTWlycm9yLG9ic2VydmVyLG9ic2VydmUscGF0Y2hJZk5vdEFscmVhZHkscGF0Y2gsdG1wO2lmKE11dGF0aW9uT2JzZXJ2ZXIpe3RtcD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RtcC5pbm5lckhUTUw9XCI8ZGl2PjxkaXY+PC9kaXY+PC9kaXY+XCI7bmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zLG9ic2VydmVyKXtpZihtdXRhdGlvbnNbMF0mJm11dGF0aW9uc1swXS50eXBlPT1cImNoaWxkTGlzdFwiJiYhbXV0YXRpb25zWzBdLnJlbW92ZWROb2Rlc1swXS5jaGlsZE5vZGVzLmxlbmd0aCl7dG1wPWdPUEQoSFRNTEVsZW1lbnRQcm90b3R5cGUsXCJpbm5lckhUTUxcIik7dmFyIHNldD10bXAmJnRtcC5zZXQ7aWYoc2V0KWRlZmluZVByb3BlcnR5KEhUTUxFbGVtZW50UHJvdG90eXBlLFwiaW5uZXJIVE1MXCIse3NldDpmdW5jdGlvbih2YWx1ZSl7d2hpbGUodGhpcy5sYXN0Q2hpbGQpdGhpcy5yZW1vdmVDaGlsZCh0aGlzLmxhc3RDaGlsZCk7c2V0LmNhbGwodGhpcyx2YWx1ZSl9fSl9b2JzZXJ2ZXIuZGlzY29ubmVjdCgpO3RtcD1udWxsfSkub2JzZXJ2ZSh0bXAse2NoaWxkTGlzdDp0cnVlLHN1YnRyZWU6dHJ1ZX0pO3RtcC5pbm5lckhUTUw9XCJcIn1pZighVjApe2lmKHNQT3x8aGFzUHJvdG8pe3BhdGNoSWZOb3RBbHJlYWR5PWZ1bmN0aW9uKG5vZGUscHJvdG8pe2lmKCFpUE8uY2FsbChwcm90byxub2RlKSl7c2V0dXBOb2RlKG5vZGUscHJvdG8pfX07cGF0Y2g9c2V0dXBOb2RlfWVsc2V7cGF0Y2hJZk5vdEFscmVhZHk9ZnVuY3Rpb24obm9kZSxwcm90byl7aWYoIW5vZGVbRVhQQU5ET19VSURdKXtub2RlW0VYUEFORE9fVUlEXT1PYmplY3QodHJ1ZSk7c2V0dXBOb2RlKG5vZGUscHJvdG8pfX07cGF0Y2g9cGF0Y2hJZk5vdEFscmVhZHl9aWYoSUU4KXtkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZD1mYWxzZTsoZnVuY3Rpb24oKXt2YXIgZGVzY3JpcHRvcj1nT1BEKEhUTUxFbGVtZW50UHJvdG90eXBlLEFERF9FVkVOVF9MSVNURU5FUiksYWRkRXZlbnRMaXN0ZW5lcj1kZXNjcmlwdG9yLnZhbHVlLHBhdGNoZWRSZW1vdmVBdHRyaWJ1dGU9ZnVuY3Rpb24obmFtZSl7dmFyIGU9bmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELHtidWJibGVzOnRydWV9KTtlLmF0dHJOYW1lPW5hbWU7ZS5wcmV2VmFsdWU9Z2V0QXR0cmlidXRlLmNhbGwodGhpcyxuYW1lKTtlLm5ld1ZhbHVlPW51bGw7ZVtSRU1PVkFMXT1lLmF0dHJDaGFuZ2U9MjtyZW1vdmVBdHRyaWJ1dGUuY2FsbCh0aGlzLG5hbWUpO2Rpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLGUpfSxwYXRjaGVkU2V0QXR0cmlidXRlPWZ1bmN0aW9uKG5hbWUsdmFsdWUpe3ZhciBoYWQ9aGFzQXR0cmlidXRlLmNhbGwodGhpcyxuYW1lKSxvbGQ9aGFkJiZnZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLG5hbWUpLGU9bmV3IEN1c3RvbUV2ZW50KERPTV9BVFRSX01PRElGSUVELHtidWJibGVzOnRydWV9KTtzZXRBdHRyaWJ1dGUuY2FsbCh0aGlzLG5hbWUsdmFsdWUpO2UuYXR0ck5hbWU9bmFtZTtlLnByZXZWYWx1ZT1oYWQ/b2xkOm51bGw7ZS5uZXdWYWx1ZT12YWx1ZTtpZihoYWQpe2VbTU9ESUZJQ0FUSU9OXT1lLmF0dHJDaGFuZ2U9MX1lbHNle2VbQURESVRJT05dPWUuYXR0ckNoYW5nZT0wfWRpc3BhdGNoRXZlbnQuY2FsbCh0aGlzLGUpfSxvblByb3BlcnR5Q2hhbmdlPWZ1bmN0aW9uKGUpe3ZhciBub2RlPWUuY3VycmVudFRhcmdldCxzdXBlclNlY3JldD1ub2RlW0VYUEFORE9fVUlEXSxwcm9wZXJ0eU5hbWU9ZS5wcm9wZXJ0eU5hbWUsZXZlbnQ7aWYoc3VwZXJTZWNyZXQuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSl7c3VwZXJTZWNyZXQ9c3VwZXJTZWNyZXRbcHJvcGVydHlOYW1lXTtldmVudD1uZXcgQ3VzdG9tRXZlbnQoRE9NX0FUVFJfTU9ESUZJRUQse2J1YmJsZXM6dHJ1ZX0pO2V2ZW50LmF0dHJOYW1lPXN1cGVyU2VjcmV0Lm5hbWU7ZXZlbnQucHJldlZhbHVlPXN1cGVyU2VjcmV0LnZhbHVlfHxudWxsO2V2ZW50Lm5ld1ZhbHVlPXN1cGVyU2VjcmV0LnZhbHVlPW5vZGVbcHJvcGVydHlOYW1lXXx8bnVsbDtpZihldmVudC5wcmV2VmFsdWU9PW51bGwpe2V2ZW50W0FERElUSU9OXT1ldmVudC5hdHRyQ2hhbmdlPTB9ZWxzZXtldmVudFtNT0RJRklDQVRJT05dPWV2ZW50LmF0dHJDaGFuZ2U9MX1kaXNwYXRjaEV2ZW50LmNhbGwobm9kZSxldmVudCl9fTtkZXNjcmlwdG9yLnZhbHVlPWZ1bmN0aW9uKHR5cGUsaGFuZGxlcixjYXB0dXJlKXtpZih0eXBlPT09RE9NX0FUVFJfTU9ESUZJRUQmJnRoaXNbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdJiZ0aGlzLnNldEF0dHJpYnV0ZSE9PXBhdGNoZWRTZXRBdHRyaWJ1dGUpe3RoaXNbRVhQQU5ET19VSURdPXtjbGFzc05hbWU6e25hbWU6XCJjbGFzc1wiLHZhbHVlOnRoaXMuY2xhc3NOYW1lfX07dGhpcy5zZXRBdHRyaWJ1dGU9cGF0Y2hlZFNldEF0dHJpYnV0ZTt0aGlzLnJlbW92ZUF0dHJpYnV0ZT1wYXRjaGVkUmVtb3ZlQXR0cmlidXRlO2FkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLFwicHJvcGVydHljaGFuZ2VcIixvblByb3BlcnR5Q2hhbmdlKX1hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcyx0eXBlLGhhbmRsZXIsY2FwdHVyZSl9O2RlZmluZVByb3BlcnR5KEhUTUxFbGVtZW50UHJvdG90eXBlLEFERF9FVkVOVF9MSVNURU5FUixkZXNjcmlwdG9yKX0pKCl9ZWxzZSBpZighTXV0YXRpb25PYnNlcnZlcil7ZG9jdW1lbnRFbGVtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oRE9NX0FUVFJfTU9ESUZJRUQsRE9NQXR0ck1vZGlmaWVkKTtkb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKEVYUEFORE9fVUlELDEpO2RvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoRVhQQU5ET19VSUQpO2lmKGRvZXNOb3RTdXBwb3J0RE9NQXR0ck1vZGlmaWVkKXtvblN1YnRyZWVNb2RpZmllZD1mdW5jdGlvbihlKXt2YXIgbm9kZT10aGlzLG9sZEF0dHJpYnV0ZXMsbmV3QXR0cmlidXRlcyxrZXk7aWYobm9kZT09PWUudGFyZ2V0KXtvbGRBdHRyaWJ1dGVzPW5vZGVbRVhQQU5ET19VSURdO25vZGVbRVhQQU5ET19VSURdPW5ld0F0dHJpYnV0ZXM9Z2V0QXR0cmlidXRlc01pcnJvcihub2RlKTtmb3Ioa2V5IGluIG5ld0F0dHJpYnV0ZXMpe2lmKCEoa2V5IGluIG9sZEF0dHJpYnV0ZXMpKXtyZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZCgwLG5vZGUsa2V5LG9sZEF0dHJpYnV0ZXNba2V5XSxuZXdBdHRyaWJ1dGVzW2tleV0sQURESVRJT04pfWVsc2UgaWYobmV3QXR0cmlidXRlc1trZXldIT09b2xkQXR0cmlidXRlc1trZXldKXtyZXR1cm4gY2FsbERPTUF0dHJNb2RpZmllZCgxLG5vZGUsa2V5LG9sZEF0dHJpYnV0ZXNba2V5XSxuZXdBdHRyaWJ1dGVzW2tleV0sTU9ESUZJQ0FUSU9OKX19Zm9yKGtleSBpbiBvbGRBdHRyaWJ1dGVzKXtpZighKGtleSBpbiBuZXdBdHRyaWJ1dGVzKSl7cmV0dXJuIGNhbGxET01BdHRyTW9kaWZpZWQoMixub2RlLGtleSxvbGRBdHRyaWJ1dGVzW2tleV0sbmV3QXR0cmlidXRlc1trZXldLFJFTU9WQUwpfX19fTtjYWxsRE9NQXR0ck1vZGlmaWVkPWZ1bmN0aW9uKGF0dHJDaGFuZ2UsY3VycmVudFRhcmdldCxhdHRyTmFtZSxwcmV2VmFsdWUsbmV3VmFsdWUsYWN0aW9uKXt2YXIgZT17YXR0ckNoYW5nZTphdHRyQ2hhbmdlLGN1cnJlbnRUYXJnZXQ6Y3VycmVudFRhcmdldCxhdHRyTmFtZTphdHRyTmFtZSxwcmV2VmFsdWU6cHJldlZhbHVlLG5ld1ZhbHVlOm5ld1ZhbHVlfTtlW2FjdGlvbl09YXR0ckNoYW5nZTtvbkRPTUF0dHJNb2RpZmllZChlKX07Z2V0QXR0cmlidXRlc01pcnJvcj1mdW5jdGlvbihub2RlKXtmb3IodmFyIGF0dHIsbmFtZSxyZXN1bHQ9e30sYXR0cmlidXRlcz1ub2RlLmF0dHJpYnV0ZXMsaT0wLGxlbmd0aD1hdHRyaWJ1dGVzLmxlbmd0aDtpPGxlbmd0aDtpKyspe2F0dHI9YXR0cmlidXRlc1tpXTtuYW1lPWF0dHIubmFtZTtpZihuYW1lIT09XCJzZXRBdHRyaWJ1dGVcIil7cmVzdWx0W25hbWVdPWF0dHIudmFsdWV9fXJldHVybiByZXN1bHR9fX1kb2N1bWVudFtSRUdJU1RFUl9FTEVNRU5UXT1mdW5jdGlvbiByZWdpc3RlckVsZW1lbnQodHlwZSxvcHRpb25zKXt1cHBlclR5cGU9dHlwZS50b1VwcGVyQ2FzZSgpO2lmKHNldExpc3RlbmVyKXtzZXRMaXN0ZW5lcj1mYWxzZTtpZihNdXRhdGlvbk9ic2VydmVyKXtvYnNlcnZlcj1mdW5jdGlvbihhdHRhY2hlZCxkZXRhY2hlZCl7ZnVuY3Rpb24gY2hlY2tFbUFsbChsaXN0LGNhbGxiYWNrKXtmb3IodmFyIGk9MCxsZW5ndGg9bGlzdC5sZW5ndGg7aTxsZW5ndGg7Y2FsbGJhY2sobGlzdFtpKytdKSl7fX1yZXR1cm4gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24ocmVjb3Jkcyl7Zm9yKHZhciBjdXJyZW50LG5vZGUsbmV3VmFsdWUsaT0wLGxlbmd0aD1yZWNvcmRzLmxlbmd0aDtpPGxlbmd0aDtpKyspe2N1cnJlbnQ9cmVjb3Jkc1tpXTtpZihjdXJyZW50LnR5cGU9PT1cImNoaWxkTGlzdFwiKXtjaGVja0VtQWxsKGN1cnJlbnQuYWRkZWROb2RlcyxhdHRhY2hlZCk7Y2hlY2tFbUFsbChjdXJyZW50LnJlbW92ZWROb2RlcyxkZXRhY2hlZCl9ZWxzZXtub2RlPWN1cnJlbnQudGFyZ2V0O2lmKG5vdEZyb21Jbm5lckhUTUxIZWxwZXImJm5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdJiZjdXJyZW50LmF0dHJpYnV0ZU5hbWUhPT1cInN0eWxlXCIpe25ld1ZhbHVlPWdldEF0dHJpYnV0ZS5jYWxsKG5vZGUsY3VycmVudC5hdHRyaWJ1dGVOYW1lKTtpZihuZXdWYWx1ZSE9PWN1cnJlbnQub2xkVmFsdWUpe25vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdKGN1cnJlbnQuYXR0cmlidXRlTmFtZSxjdXJyZW50Lm9sZFZhbHVlLG5ld1ZhbHVlKX19fX19KX0oZXhlY3V0ZUFjdGlvbihBVFRBQ0hFRCksZXhlY3V0ZUFjdGlvbihERVRBQ0hFRCkpO29ic2VydmU9ZnVuY3Rpb24obm9kZSl7b2JzZXJ2ZXIub2JzZXJ2ZShub2RlLHtjaGlsZExpc3Q6dHJ1ZSxzdWJ0cmVlOnRydWV9KTtyZXR1cm4gbm9kZX07b2JzZXJ2ZShkb2N1bWVudCk7aWYoYXR0YWNoU2hhZG93KXtIVE1MRWxlbWVudFByb3RvdHlwZS5hdHRhY2hTaGFkb3c9ZnVuY3Rpb24oKXtyZXR1cm4gb2JzZXJ2ZShhdHRhY2hTaGFkb3cuYXBwbHkodGhpcyxhcmd1bWVudHMpKX19fWVsc2V7YXNhcFF1ZXVlPVtdO2RvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oXCJET01Ob2RlSW5zZXJ0ZWRcIixvbkRPTU5vZGUoQVRUQUNIRUQpKTtkb2N1bWVudFtBRERfRVZFTlRfTElTVEVORVJdKFwiRE9NTm9kZVJlbW92ZWRcIixvbkRPTU5vZGUoREVUQUNIRUQpKX1kb2N1bWVudFtBRERfRVZFTlRfTElTVEVORVJdKERPTV9DT05URU5UX0xPQURFRCxvblJlYWR5U3RhdGVDaGFuZ2UpO2RvY3VtZW50W0FERF9FVkVOVF9MSVNURU5FUl0oXCJyZWFkeXN0YXRlY2hhbmdlXCIsb25SZWFkeVN0YXRlQ2hhbmdlKTtIVE1MRWxlbWVudFByb3RvdHlwZS5jbG9uZU5vZGU9ZnVuY3Rpb24oZGVlcCl7dmFyIG5vZGU9Y2xvbmVOb2RlLmNhbGwodGhpcywhIWRlZXApLGk9Z2V0VHlwZUluZGV4KG5vZGUpO2lmKC0xPGkpcGF0Y2gobm9kZSxwcm90b3NbaV0pO2lmKGRlZXAmJnF1ZXJ5Lmxlbmd0aClsb29wQW5kU2V0dXAobm9kZS5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSk7cmV0dXJuIG5vZGV9fWlmKGp1c3RTZXR1cClyZXR1cm4ganVzdFNldHVwPWZhbHNlO2lmKC0yPGluZGV4T2YuY2FsbCh0eXBlcyxQUkVGSVhfSVMrdXBwZXJUeXBlKStpbmRleE9mLmNhbGwodHlwZXMsUFJFRklYX1RBRyt1cHBlclR5cGUpKXt0aHJvd1R5cGVFcnJvcih0eXBlKX1pZighdmFsaWROYW1lLnRlc3QodXBwZXJUeXBlKXx8LTE8aW5kZXhPZi5jYWxsKGludmFsaWROYW1lcyx1cHBlclR5cGUpKXt0aHJvdyBuZXcgRXJyb3IoXCJUaGUgdHlwZSBcIit0eXBlK1wiIGlzIGludmFsaWRcIil9dmFyIGNvbnN0cnVjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIGV4dGVuZGluZz9kb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lLHVwcGVyVHlwZSk6ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSl9LG9wdD1vcHRpb25zfHxPUCxleHRlbmRpbmc9aE9QLmNhbGwob3B0LEVYVEVORFMpLG5vZGVOYW1lPWV4dGVuZGluZz9vcHRpb25zW0VYVEVORFNdLnRvVXBwZXJDYXNlKCk6dXBwZXJUeXBlLHVwcGVyVHlwZSxpO2lmKGV4dGVuZGluZyYmLTE8aW5kZXhPZi5jYWxsKHR5cGVzLFBSRUZJWF9UQUcrbm9kZU5hbWUpKXt0aHJvd1R5cGVFcnJvcihub2RlTmFtZSl9aT10eXBlcy5wdXNoKChleHRlbmRpbmc/UFJFRklYX0lTOlBSRUZJWF9UQUcpK3VwcGVyVHlwZSktMTtxdWVyeT1xdWVyeS5jb25jYXQocXVlcnkubGVuZ3RoP1wiLFwiOlwiXCIsZXh0ZW5kaW5nP25vZGVOYW1lKydbaXM9XCInK3R5cGUudG9Mb3dlckNhc2UoKSsnXCJdJzpub2RlTmFtZSk7Y29uc3RydWN0b3IucHJvdG90eXBlPXByb3Rvc1tpXT1oT1AuY2FsbChvcHQsXCJwcm90b3R5cGVcIik/b3B0LnByb3RvdHlwZTpjcmVhdGUoSFRNTEVsZW1lbnRQcm90b3R5cGUpO2lmKHF1ZXJ5Lmxlbmd0aClsb29wQW5kVmVyaWZ5KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpLEFUVEFDSEVEKTtyZXR1cm4gY29uc3RydWN0b3J9O2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQ9cGF0Y2hlZENyZWF0ZUVsZW1lbnQ9ZnVuY3Rpb24obG9jYWxOYW1lLHR5cGVFeHRlbnNpb24pe3ZhciBpcz1nZXRJcyh0eXBlRXh0ZW5zaW9uKSxub2RlPWlzP2NyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCxsb2NhbE5hbWUsc2Vjb25kQXJndW1lbnQoaXMpKTpjcmVhdGVFbGVtZW50LmNhbGwoZG9jdW1lbnQsbG9jYWxOYW1lKSxuYW1lPVwiXCIrbG9jYWxOYW1lLGk9aW5kZXhPZi5jYWxsKHR5cGVzLChpcz9QUkVGSVhfSVM6UFJFRklYX1RBRykrKGlzfHxuYW1lKS50b1VwcGVyQ2FzZSgpKSxzZXR1cD0tMTxpO2lmKGlzKXtub2RlLnNldEF0dHJpYnV0ZShcImlzXCIsaXM9aXMudG9Mb3dlckNhc2UoKSk7aWYoc2V0dXApe3NldHVwPWlzSW5RU0EobmFtZS50b1VwcGVyQ2FzZSgpLGlzKX19bm90RnJvbUlubmVySFRNTEhlbHBlcj0hZG9jdW1lbnQuY3JlYXRlRWxlbWVudC5pbm5lckhUTUxIZWxwZXI7aWYoc2V0dXApcGF0Y2gobm9kZSxwcm90b3NbaV0pO3JldHVybiBub2RlfX1mdW5jdGlvbiBBU0FQKCl7dmFyIHF1ZXVlPWFzYXBRdWV1ZS5zcGxpY2UoMCxhc2FwUXVldWUubGVuZ3RoKTthc2FwVGltZXI9MDt3aGlsZShxdWV1ZS5sZW5ndGgpe3F1ZXVlLnNoaWZ0KCkuY2FsbChudWxsLHF1ZXVlLnNoaWZ0KCkpfX1mdW5jdGlvbiBsb29wQW5kVmVyaWZ5KGxpc3QsYWN0aW9uKXtmb3IodmFyIGk9MCxsZW5ndGg9bGlzdC5sZW5ndGg7aTxsZW5ndGg7aSsrKXt2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihsaXN0W2ldLGFjdGlvbil9fWZ1bmN0aW9uIGxvb3BBbmRTZXR1cChsaXN0KXtmb3IodmFyIGk9MCxsZW5ndGg9bGlzdC5sZW5ndGgsbm9kZTtpPGxlbmd0aDtpKyspe25vZGU9bGlzdFtpXTtwYXRjaChub2RlLHByb3Rvc1tnZXRUeXBlSW5kZXgobm9kZSldKX19ZnVuY3Rpb24gZXhlY3V0ZUFjdGlvbihhY3Rpb24pe3JldHVybiBmdW5jdGlvbihub2RlKXtpZihpc1ZhbGlkTm9kZShub2RlKSl7dmVyaWZ5QW5kU2V0dXBBbmRBY3Rpb24obm9kZSxhY3Rpb24pO2lmKHF1ZXJ5Lmxlbmd0aClsb29wQW5kVmVyaWZ5KG5vZGUucXVlcnlTZWxlY3RvckFsbChxdWVyeSksYWN0aW9uKX19fWZ1bmN0aW9uIGdldFR5cGVJbmRleCh0YXJnZXQpe3ZhciBpcz1nZXRBdHRyaWJ1dGUuY2FsbCh0YXJnZXQsXCJpc1wiKSxub2RlTmFtZT10YXJnZXQubm9kZU5hbWUudG9VcHBlckNhc2UoKSxpPWluZGV4T2YuY2FsbCh0eXBlcyxpcz9QUkVGSVhfSVMraXMudG9VcHBlckNhc2UoKTpQUkVGSVhfVEFHK25vZGVOYW1lKTtyZXR1cm4gaXMmJi0xPGkmJiFpc0luUVNBKG5vZGVOYW1lLGlzKT8tMTppfWZ1bmN0aW9uIGlzSW5RU0EobmFtZSx0eXBlKXtyZXR1cm4tMTxxdWVyeS5pbmRleE9mKG5hbWUrJ1tpcz1cIicrdHlwZSsnXCJdJyl9ZnVuY3Rpb24gb25ET01BdHRyTW9kaWZpZWQoZSl7dmFyIG5vZGU9ZS5jdXJyZW50VGFyZ2V0LGF0dHJDaGFuZ2U9ZS5hdHRyQ2hhbmdlLGF0dHJOYW1lPWUuYXR0ck5hbWUsdGFyZ2V0PWUudGFyZ2V0LGFkZGl0aW9uPWVbQURESVRJT05dfHwyLHJlbW92YWw9ZVtSRU1PVkFMXXx8MztpZihub3RGcm9tSW5uZXJIVE1MSGVscGVyJiYoIXRhcmdldHx8dGFyZ2V0PT09bm9kZSkmJm5vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdJiZhdHRyTmFtZSE9PVwic3R5bGVcIiYmKGUucHJldlZhbHVlIT09ZS5uZXdWYWx1ZXx8ZS5uZXdWYWx1ZT09PVwiXCImJihhdHRyQ2hhbmdlPT09YWRkaXRpb258fGF0dHJDaGFuZ2U9PT1yZW1vdmFsKSkpe25vZGVbQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdKGF0dHJOYW1lLGF0dHJDaGFuZ2U9PT1hZGRpdGlvbj9udWxsOmUucHJldlZhbHVlLGF0dHJDaGFuZ2U9PT1yZW1vdmFsP251bGw6ZS5uZXdWYWx1ZSl9fWZ1bmN0aW9uIG9uRE9NTm9kZShhY3Rpb24pe3ZhciBleGVjdXRvcj1leGVjdXRlQWN0aW9uKGFjdGlvbik7cmV0dXJuIGZ1bmN0aW9uKGUpe2FzYXBRdWV1ZS5wdXNoKGV4ZWN1dG9yLGUudGFyZ2V0KTtpZihhc2FwVGltZXIpY2xlYXJUaW1lb3V0KGFzYXBUaW1lcik7YXNhcFRpbWVyPXNldFRpbWVvdXQoQVNBUCwxKX19ZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKGUpe2lmKGRyb3BEb21Db250ZW50TG9hZGVkKXtkcm9wRG9tQ29udGVudExvYWRlZD1mYWxzZTtlLmN1cnJlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihET01fQ09OVEVOVF9MT0FERUQsb25SZWFkeVN0YXRlQ2hhbmdlKX1pZihxdWVyeS5sZW5ndGgpbG9vcEFuZFZlcmlmeSgoZS50YXJnZXR8fGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSxlLmRldGFpbD09PURFVEFDSEVEP0RFVEFDSEVEOkFUVEFDSEVEKTtpZihJRTgpcHVyZ2UoKX1mdW5jdGlvbiBwYXRjaGVkU2V0QXR0cmlidXRlKG5hbWUsdmFsdWUpe3ZhciBzZWxmPXRoaXM7c2V0QXR0cmlidXRlLmNhbGwoc2VsZixuYW1lLHZhbHVlKTtvblN1YnRyZWVNb2RpZmllZC5jYWxsKHNlbGYse3RhcmdldDpzZWxmfSl9ZnVuY3Rpb24gc2V0dXBOb2RlKG5vZGUscHJvdG8pe3NldFByb3RvdHlwZShub2RlLHByb3RvKTtpZihvYnNlcnZlcil7b2JzZXJ2ZXIub2JzZXJ2ZShub2RlLGF0dHJpYnV0ZXNPYnNlcnZlcil9ZWxzZXtpZihkb2VzTm90U3VwcG9ydERPTUF0dHJNb2RpZmllZCl7bm9kZS5zZXRBdHRyaWJ1dGU9cGF0Y2hlZFNldEF0dHJpYnV0ZTtub2RlW0VYUEFORE9fVUlEXT1nZXRBdHRyaWJ1dGVzTWlycm9yKG5vZGUpO25vZGVbQUREX0VWRU5UX0xJU1RFTkVSXShET01fU1VCVFJFRV9NT0RJRklFRCxvblN1YnRyZWVNb2RpZmllZCl9bm9kZVtBRERfRVZFTlRfTElTVEVORVJdKERPTV9BVFRSX01PRElGSUVELG9uRE9NQXR0ck1vZGlmaWVkKX1pZihub2RlW0NSRUFURURfQ0FMTEJBQ0tdJiZub3RGcm9tSW5uZXJIVE1MSGVscGVyKXtub2RlLmNyZWF0ZWQ9dHJ1ZTtub2RlW0NSRUFURURfQ0FMTEJBQ0tdKCk7bm9kZS5jcmVhdGVkPWZhbHNlfX1mdW5jdGlvbiBwdXJnZSgpe2Zvcih2YXIgbm9kZSxpPTAsbGVuZ3RoPXRhcmdldHMubGVuZ3RoO2k8bGVuZ3RoO2krKyl7bm9kZT10YXJnZXRzW2ldO2lmKCFkb2N1bWVudEVsZW1lbnQuY29udGFpbnMobm9kZSkpe2xlbmd0aC0tO3RhcmdldHMuc3BsaWNlKGktLSwxKTt2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLERFVEFDSEVEKX19fWZ1bmN0aW9uIHRocm93VHlwZUVycm9yKHR5cGUpe3Rocm93IG5ldyBFcnJvcihcIkEgXCIrdHlwZStcIiB0eXBlIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFwiKX1mdW5jdGlvbiB2ZXJpZnlBbmRTZXR1cEFuZEFjdGlvbihub2RlLGFjdGlvbil7dmFyIGZuLGk9Z2V0VHlwZUluZGV4KG5vZGUpLGNvdW50ZXJBY3Rpb247aWYoLTE8aSl7cGF0Y2hJZk5vdEFscmVhZHkobm9kZSxwcm90b3NbaV0pO2k9MDtpZihhY3Rpb249PT1BVFRBQ0hFRCYmIW5vZGVbQVRUQUNIRURdKXtub2RlW0RFVEFDSEVEXT1mYWxzZTtub2RlW0FUVEFDSEVEXT10cnVlO2NvdW50ZXJBY3Rpb249XCJjb25uZWN0ZWRcIjtpPTE7aWYoSUU4JiZpbmRleE9mLmNhbGwodGFyZ2V0cyxub2RlKTwwKXt0YXJnZXRzLnB1c2gobm9kZSl9fWVsc2UgaWYoYWN0aW9uPT09REVUQUNIRUQmJiFub2RlW0RFVEFDSEVEXSl7bm9kZVtBVFRBQ0hFRF09ZmFsc2U7bm9kZVtERVRBQ0hFRF09dHJ1ZTtjb3VudGVyQWN0aW9uPVwiZGlzY29ubmVjdGVkXCI7aT0xfWlmKGkmJihmbj1ub2RlW2FjdGlvbitDQUxMQkFDS118fG5vZGVbY291bnRlckFjdGlvbitDQUxMQkFDS10pKWZuLmNhbGwobm9kZSl9fWZ1bmN0aW9uIEN1c3RvbUVsZW1lbnRSZWdpc3RyeSgpe31DdXN0b21FbGVtZW50UmVnaXN0cnkucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpDdXN0b21FbGVtZW50UmVnaXN0cnksZGVmaW5lOnVzYWJsZUN1c3RvbUVsZW1lbnRzP2Z1bmN0aW9uKG5hbWUsQ2xhc3Msb3B0aW9ucyl7aWYob3B0aW9ucyl7Q0VSRGVmaW5lKG5hbWUsQ2xhc3Msb3B0aW9ucyl9ZWxzZXt2YXIgTkFNRT1uYW1lLnRvVXBwZXJDYXNlKCk7Y29uc3RydWN0b3JzW05BTUVdPXtjb25zdHJ1Y3RvcjpDbGFzcyxjcmVhdGU6W05BTUVdfTtub2RlTmFtZXMuc2V0KENsYXNzLE5BTUUpO2N1c3RvbUVsZW1lbnRzLmRlZmluZShuYW1lLENsYXNzKX19OkNFUkRlZmluZSxnZXQ6dXNhYmxlQ3VzdG9tRWxlbWVudHM/ZnVuY3Rpb24obmFtZSl7cmV0dXJuIGN1c3RvbUVsZW1lbnRzLmdldChuYW1lKXx8Z2V0KG5hbWUpfTpnZXQsd2hlbkRlZmluZWQ6dXNhYmxlQ3VzdG9tRWxlbWVudHM/ZnVuY3Rpb24obmFtZSl7cmV0dXJuIFByb21pc2UucmFjZShbY3VzdG9tRWxlbWVudHMud2hlbkRlZmluZWQobmFtZSksd2hlbkRlZmluZWQobmFtZSldKX06d2hlbkRlZmluZWR9O2Z1bmN0aW9uIENFUkRlZmluZShuYW1lLENsYXNzLG9wdGlvbnMpe3ZhciBpcz1vcHRpb25zJiZvcHRpb25zW0VYVEVORFNdfHxcIlwiLENQcm90bz1DbGFzcy5wcm90b3R5cGUscHJvdG89Y3JlYXRlKENQcm90byksYXR0cmlidXRlcz1DbGFzcy5vYnNlcnZlZEF0dHJpYnV0ZXN8fGVtcHR5LGRlZmluaXRpb249e3Byb3RvdHlwZTpwcm90b307c2FmZVByb3BlcnR5KHByb3RvLENSRUFURURfQ0FMTEJBQ0sse3ZhbHVlOmZ1bmN0aW9uKCl7aWYoanVzdENyZWF0ZWQpanVzdENyZWF0ZWQ9ZmFsc2U7ZWxzZSBpZighdGhpc1tEUkVDRVYxXSl7dGhpc1tEUkVDRVYxXT10cnVlO25ldyBDbGFzcyh0aGlzKTtpZihDUHJvdG9bQ1JFQVRFRF9DQUxMQkFDS10pQ1Byb3RvW0NSRUFURURfQ0FMTEJBQ0tdLmNhbGwodGhpcyk7dmFyIGluZm89Y29uc3RydWN0b3JzW25vZGVOYW1lcy5nZXQoQ2xhc3MpXTtpZighdXNhYmxlQ3VzdG9tRWxlbWVudHN8fGluZm8uY3JlYXRlLmxlbmd0aD4xKXtub3RpZnlBdHRyaWJ1dGVzKHRoaXMpfX19fSk7c2FmZVByb3BlcnR5KHByb3RvLEFUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLLHt2YWx1ZTpmdW5jdGlvbihuYW1lKXtpZigtMTxpbmRleE9mLmNhbGwoYXR0cmlidXRlcyxuYW1lKSlDUHJvdG9bQVRUUklCVVRFX0NIQU5HRURfQ0FMTEJBQ0tdLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KTtpZihDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXSl7c2FmZVByb3BlcnR5KHByb3RvLEFUVEFDSEVEX0NBTExCQUNLLHt2YWx1ZTpDUHJvdG9bQ09OTkVDVEVEX0NBTExCQUNLXX0pfWlmKENQcm90b1tESVNDT05ORUNURURfQ0FMTEJBQ0tdKXtzYWZlUHJvcGVydHkocHJvdG8sREVUQUNIRURfQ0FMTEJBQ0sse3ZhbHVlOkNQcm90b1tESVNDT05ORUNURURfQ0FMTEJBQ0tdfSl9aWYoaXMpZGVmaW5pdGlvbltFWFRFTkRTXT1pcztuYW1lPW5hbWUudG9VcHBlckNhc2UoKTtjb25zdHJ1Y3RvcnNbbmFtZV09e2NvbnN0cnVjdG9yOkNsYXNzLGNyZWF0ZTppcz9baXMsc2Vjb25kQXJndW1lbnQobmFtZSldOltuYW1lXX07bm9kZU5hbWVzLnNldChDbGFzcyxuYW1lKTtkb2N1bWVudFtSRUdJU1RFUl9FTEVNRU5UXShuYW1lLnRvTG93ZXJDYXNlKCksZGVmaW5pdGlvbik7d2hlbkRlZmluZWQobmFtZSk7d2FpdGluZ0xpc3RbbmFtZV0ucigpfWZ1bmN0aW9uIGdldChuYW1lKXt2YXIgaW5mbz1jb25zdHJ1Y3RvcnNbbmFtZS50b1VwcGVyQ2FzZSgpXTtyZXR1cm4gaW5mbyYmaW5mby5jb25zdHJ1Y3Rvcn1mdW5jdGlvbiBnZXRJcyhvcHRpb25zKXtyZXR1cm4gdHlwZW9mIG9wdGlvbnM9PT1cInN0cmluZ1wiP29wdGlvbnM6b3B0aW9ucyYmb3B0aW9ucy5pc3x8XCJcIn1mdW5jdGlvbiBub3RpZnlBdHRyaWJ1dGVzKHNlbGYpe3ZhciBjYWxsYmFjaz1zZWxmW0FUVFJJQlVURV9DSEFOR0VEX0NBTExCQUNLXSxhdHRyaWJ1dGVzPWNhbGxiYWNrP3NlbGYuYXR0cmlidXRlczplbXB0eSxpPWF0dHJpYnV0ZXMubGVuZ3RoLGF0dHJpYnV0ZTt3aGlsZShpLS0pe2F0dHJpYnV0ZT1hdHRyaWJ1dGVzW2ldO2NhbGxiYWNrLmNhbGwoc2VsZixhdHRyaWJ1dGUubmFtZXx8YXR0cmlidXRlLm5vZGVOYW1lLG51bGwsYXR0cmlidXRlLnZhbHVlfHxhdHRyaWJ1dGUubm9kZVZhbHVlKX19ZnVuY3Rpb24gd2hlbkRlZmluZWQobmFtZSl7bmFtZT1uYW1lLnRvVXBwZXJDYXNlKCk7aWYoIShuYW1lIGluIHdhaXRpbmdMaXN0KSl7d2FpdGluZ0xpc3RbbmFtZV09e307d2FpdGluZ0xpc3RbbmFtZV0ucD1uZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKXt3YWl0aW5nTGlzdFtuYW1lXS5yPXJlc29sdmV9KX1yZXR1cm4gd2FpdGluZ0xpc3RbbmFtZV0ucH1mdW5jdGlvbiBwb2x5ZmlsbFYxKCl7aWYoY3VzdG9tRWxlbWVudHMpZGVsZXRlIHdpbmRvdy5jdXN0b21FbGVtZW50cztkZWZpbmVQcm9wZXJ0eSh3aW5kb3csXCJjdXN0b21FbGVtZW50c1wiLHtjb25maWd1cmFibGU6dHJ1ZSx2YWx1ZTpuZXcgQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5fSk7ZGVmaW5lUHJvcGVydHkod2luZG93LFwiQ3VzdG9tRWxlbWVudFJlZ2lzdHJ5XCIse2NvbmZpZ3VyYWJsZTp0cnVlLHZhbHVlOkN1c3RvbUVsZW1lbnRSZWdpc3RyeX0pO2Zvcih2YXIgcGF0Y2hDbGFzcz1mdW5jdGlvbihuYW1lKXt2YXIgQ2xhc3M9d2luZG93W25hbWVdO2lmKENsYXNzKXt3aW5kb3dbbmFtZV09ZnVuY3Rpb24gQ3VzdG9tRWxlbWVudHNWMShzZWxmKXt2YXIgaW5mbyxpc05hdGl2ZTtpZighc2VsZilzZWxmPXRoaXM7aWYoIXNlbGZbRFJFQ0VWMV0pe2p1c3RDcmVhdGVkPXRydWU7aW5mbz1jb25zdHJ1Y3RvcnNbbm9kZU5hbWVzLmdldChzZWxmLmNvbnN0cnVjdG9yKV07aXNOYXRpdmU9dXNhYmxlQ3VzdG9tRWxlbWVudHMmJmluZm8uY3JlYXRlLmxlbmd0aD09PTE7c2VsZj1pc05hdGl2ZT9SZWZsZWN0LmNvbnN0cnVjdChDbGFzcyxlbXB0eSxpbmZvLmNvbnN0cnVjdG9yKTpkb2N1bWVudC5jcmVhdGVFbGVtZW50LmFwcGx5KGRvY3VtZW50LGluZm8uY3JlYXRlKTtzZWxmW0RSRUNFVjFdPXRydWU7anVzdENyZWF0ZWQ9ZmFsc2U7aWYoIWlzTmF0aXZlKW5vdGlmeUF0dHJpYnV0ZXMoc2VsZil9cmV0dXJuIHNlbGZ9O3dpbmRvd1tuYW1lXS5wcm90b3R5cGU9Q2xhc3MucHJvdG90eXBlO3RyeXtDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3I9d2luZG93W25hbWVdfWNhdGNoKFdlYktpdCl7Zml4R2V0Q2xhc3M9dHJ1ZTtkZWZpbmVQcm9wZXJ0eShDbGFzcyxEUkVDRVYxLHt2YWx1ZTp3aW5kb3dbbmFtZV19KX19fSxDbGFzc2VzPWh0bWxDbGFzcy5nZXQoL15IVE1MW0EtWl0qW2Etel0vKSxpPUNsYXNzZXMubGVuZ3RoO2ktLTtwYXRjaENsYXNzKENsYXNzZXNbaV0pKXt9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudD1mdW5jdGlvbihuYW1lLG9wdGlvbnMpe3ZhciBpcz1nZXRJcyhvcHRpb25zKTtyZXR1cm4gaXM/cGF0Y2hlZENyZWF0ZUVsZW1lbnQuY2FsbCh0aGlzLG5hbWUsc2Vjb25kQXJndW1lbnQoaXMpKTpwYXRjaGVkQ3JlYXRlRWxlbWVudC5jYWxsKHRoaXMsbmFtZSl9O2lmKCFWMCl7anVzdFNldHVwPXRydWU7ZG9jdW1lbnRbUkVHSVNURVJfRUxFTUVOVF0oXCJcIil9fWlmKCFjdXN0b21FbGVtZW50c3x8L15mb3JjZS8udGVzdChwb2x5ZmlsbC50eXBlKSlwb2x5ZmlsbFYxKCk7ZWxzZSBpZighcG9seWZpbGwubm9CdWlsdEluKXt0cnl7KGZ1bmN0aW9uKERSRSxvcHRpb25zLG5hbWUpe3ZhciByZT1uZXcgUmVnRXhwKFwiXjxhXFxcXHMraXM9KCd8XFxcIilcIituYW1lK1wiXFxcXDE+PC9hPiRcIik7b3B0aW9uc1tFWFRFTkRTXT1cImFcIjtEUkUucHJvdG90eXBlPWNyZWF0ZShIVE1MQW5jaG9yRWxlbWVudC5wcm90b3R5cGUpO0RSRS5wcm90b3R5cGUuY29uc3RydWN0b3I9RFJFO3dpbmRvdy5jdXN0b21FbGVtZW50cy5kZWZpbmUobmFtZSxEUkUsb3B0aW9ucyk7aWYoIXJlLnRlc3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIix7aXM6bmFtZX0pLm91dGVySFRNTCl8fCFyZS50ZXN0KChuZXcgRFJFKS5vdXRlckhUTUwpKXt0aHJvdyBvcHRpb25zfX0pKGZ1bmN0aW9uIERSRSgpe3JldHVybiBSZWZsZWN0LmNvbnN0cnVjdChIVE1MQW5jaG9yRWxlbWVudCxbXSxEUkUpfSx7fSxcImRvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQtYVwiKX1jYXRjaChvX08pe3BvbHlmaWxsVjEoKX19aWYoIXBvbHlmaWxsLm5vQnVpbHRJbil7dHJ5e2NyZWF0ZUVsZW1lbnQuY2FsbChkb2N1bWVudCxcImFcIixcImFcIil9Y2F0Y2goRmlyZUZveCl7c2Vjb25kQXJndW1lbnQ9ZnVuY3Rpb24oaXMpe3JldHVybntpczppcy50b0xvd2VyQ2FzZSgpfX19fX0pKHdpbmRvdyk7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBpc0NhbGxhYmxlID0gcmVxdWlyZSgnaXMtY2FsbGFibGUnKTtcblxudmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbnZhciBmb3JFYWNoQXJyYXkgPSBmdW5jdGlvbiBmb3JFYWNoQXJyYXkoYXJyYXksIGl0ZXJhdG9yLCByZWNlaXZlcikge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChhcnJheSwgaSkpIHtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3IoYXJyYXlbaV0sIGksIGFycmF5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3IuY2FsbChyZWNlaXZlciwgYXJyYXlbaV0sIGksIGFycmF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBmb3JFYWNoU3RyaW5nID0gZnVuY3Rpb24gZm9yRWFjaFN0cmluZyhzdHJpbmcsIGl0ZXJhdG9yLCByZWNlaXZlcikge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzdHJpbmcubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgLy8gbm8gc3VjaCB0aGluZyBhcyBhIHNwYXJzZSBzdHJpbmcuXG4gICAgICAgIGlmIChyZWNlaXZlciA9PSBudWxsKSB7XG4gICAgICAgICAgICBpdGVyYXRvcihzdHJpbmcuY2hhckF0KGkpLCBpLCBzdHJpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2FsbChyZWNlaXZlciwgc3RyaW5nLmNoYXJBdChpKSwgaSwgc3RyaW5nKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBmb3JFYWNoT2JqZWN0ID0gZnVuY3Rpb24gZm9yRWFjaE9iamVjdChvYmplY3QsIGl0ZXJhdG9yLCByZWNlaXZlcikge1xuICAgIGZvciAodmFyIGsgaW4gb2JqZWN0KSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgaykpIHtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaXRlcmF0b3Iob2JqZWN0W2tdLCBrLCBvYmplY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRvci5jYWxsKHJlY2VpdmVyLCBvYmplY3Rba10sIGssIG9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG52YXIgZm9yRWFjaCA9IGZ1bmN0aW9uIGZvckVhY2gobGlzdCwgaXRlcmF0b3IsIHRoaXNBcmcpIHtcbiAgICBpZiAoIWlzQ2FsbGFibGUoaXRlcmF0b3IpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2l0ZXJhdG9yIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cblxuICAgIHZhciByZWNlaXZlcjtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAzKSB7XG4gICAgICAgIHJlY2VpdmVyID0gdGhpc0FyZztcbiAgICB9XG5cbiAgICBpZiAodG9TdHIuY2FsbChsaXN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICBmb3JFYWNoQXJyYXkobGlzdCwgaXRlcmF0b3IsIHJlY2VpdmVyKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBsaXN0ID09PSAnc3RyaW5nJykge1xuICAgICAgICBmb3JFYWNoU3RyaW5nKGxpc3QsIGl0ZXJhdG9yLCByZWNlaXZlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yRWFjaE9iamVjdChsaXN0LCBpdGVyYXRvciwgcmVjZWl2ZXIpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZm9yRWFjaDtcbiIsInZhciB3aW47XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgd2luID0gd2luZG93O1xufSBlbHNlIGlmICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgd2luID0gZ2xvYmFsO1xufSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgd2luID0gc2VsZjtcbn0gZWxzZSB7XG4gICAgd2luID0ge307XG59XG5cbm1vZHVsZS5leHBvcnRzID0gd2luO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG5cblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZuLCBtb2R1bGUpIHtcblx0cmV0dXJuIG1vZHVsZSA9IHsgZXhwb3J0czoge30gfSwgZm4obW9kdWxlLCBtb2R1bGUuZXhwb3J0cyksIG1vZHVsZS5leHBvcnRzO1xufVxuXG52YXIgd2luO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHdpbiA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGNvbW1vbmpzR2xvYmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgd2luID0gY29tbW9uanNHbG9iYWw7XG59IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKXtcbiAgICB3aW4gPSBzZWxmO1xufSBlbHNlIHtcbiAgICB3aW4gPSB7fTtcbn1cblxudmFyIHdpbmRvd18xID0gd2luO1xuXG52YXIgaXNGdW5jdGlvbl8xID0gaXNGdW5jdGlvbjtcblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuZnVuY3Rpb24gaXNGdW5jdGlvbiAoZm4pIHtcbiAgdmFyIHN0cmluZyA9IHRvU3RyaW5nLmNhbGwoZm4pO1xuICByZXR1cm4gc3RyaW5nID09PSAnW29iamVjdCBGdW5jdGlvbl0nIHx8XG4gICAgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiBzdHJpbmcgIT09ICdbb2JqZWN0IFJlZ0V4cF0nKSB8fFxuICAgICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAvLyBJRTggYW5kIGJlbG93XG4gICAgIChmbiA9PT0gd2luZG93LnNldFRpbWVvdXQgfHxcbiAgICAgIGZuID09PSB3aW5kb3cuYWxlcnQgfHxcbiAgICAgIGZuID09PSB3aW5kb3cuY29uZmlybSB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5wcm9tcHQpKVxufVxuXG52YXIgdHJpbV8xID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gdHJpbTtcblxuZnVuY3Rpb24gdHJpbShzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqfFxccyokL2csICcnKTtcbn1cblxuZXhwb3J0cy5sZWZ0ID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKi8sICcnKTtcbn07XG5cbmV4cG9ydHMucmlnaHQgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL1xccyokLywgJycpO1xufTtcbn0pO1xuXG52YXIgZm9yRWFjaF8xID0gZm9yRWFjaDtcblxudmFyIHRvU3RyaW5nJDEgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuZnVuY3Rpb24gZm9yRWFjaChsaXN0LCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmICghaXNGdW5jdGlvbl8xKGl0ZXJhdG9yKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpdGVyYXRvciBtdXN0IGJlIGEgZnVuY3Rpb24nKVxuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykge1xuICAgICAgICBjb250ZXh0ID0gdGhpcztcbiAgICB9XG4gICAgXG4gICAgaWYgKHRvU3RyaW5nJDEuY2FsbChsaXN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJylcbiAgICAgICAgZm9yRWFjaEFycmF5JDEobGlzdCwgaXRlcmF0b3IsIGNvbnRleHQpO1xuICAgIGVsc2UgaWYgKHR5cGVvZiBsaXN0ID09PSAnc3RyaW5nJylcbiAgICAgICAgZm9yRWFjaFN0cmluZyhsaXN0LCBpdGVyYXRvciwgY29udGV4dCk7XG4gICAgZWxzZVxuICAgICAgICBmb3JFYWNoT2JqZWN0KGxpc3QsIGl0ZXJhdG9yLCBjb250ZXh0KTtcbn1cblxuZnVuY3Rpb24gZm9yRWFjaEFycmF5JDEoYXJyYXksIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGFycmF5LCBpKSkge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBhcnJheVtpXSwgaSwgYXJyYXkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmb3JFYWNoU3RyaW5nKHN0cmluZywgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3RyaW5nLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIC8vIG5vIHN1Y2ggdGhpbmcgYXMgYSBzcGFyc2Ugc3RyaW5nLlxuICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHN0cmluZy5jaGFyQXQoaSksIGksIHN0cmluZyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmb3JFYWNoT2JqZWN0KG9iamVjdCwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBmb3IgKHZhciBrIGluIG9iamVjdCkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGspKSB7XG4gICAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9iamVjdFtrXSwgaywgb2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxudmFyIGlzQXJyYXkgPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgICB9O1xuXG52YXIgcGFyc2VIZWFkZXJzID0gZnVuY3Rpb24gKGhlYWRlcnMpIHtcbiAgaWYgKCFoZWFkZXJzKVxuICAgIHJldHVybiB7fVxuXG4gIHZhciByZXN1bHQgPSB7fTtcblxuICBmb3JFYWNoXzEoXG4gICAgICB0cmltXzEoaGVhZGVycykuc3BsaXQoJ1xcbicpXG4gICAgLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgIHZhciBpbmRleCA9IHJvdy5pbmRleE9mKCc6JylcbiAgICAgICAgICAsIGtleSA9IHRyaW1fMShyb3cuc2xpY2UoMCwgaW5kZXgpKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgLCB2YWx1ZSA9IHRyaW1fMShyb3cuc2xpY2UoaW5kZXggKyAxKSk7XG5cbiAgICAgICAgaWYgKHR5cGVvZihyZXN1bHRba2V5XSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHJlc3VsdFtrZXldKSkge1xuICAgICAgICAgIHJlc3VsdFtrZXldLnB1c2godmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdFtrZXldID0gWyByZXN1bHRba2V5XSwgdmFsdWUgXTtcbiAgICAgICAgfVxuICAgICAgfVxuICApO1xuXG4gIHJldHVybiByZXN1bHRcbn07XG5cbnZhciBpbW11dGFibGUgPSBleHRlbmQ7XG5cbnZhciBoYXNPd25Qcm9wZXJ0eSQxID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuZnVuY3Rpb24gZXh0ZW5kKCkge1xuICAgIHZhciB0YXJnZXQgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5JDEuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldFxufVxuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5cblxuXG52YXIgeGhyID0gY3JlYXRlWEhSO1xuLy8gQWxsb3cgdXNlIG9mIGRlZmF1bHQgaW1wb3J0IHN5bnRheCBpbiBUeXBlU2NyaXB0XG52YXIgZGVmYXVsdF8xID0gY3JlYXRlWEhSO1xuY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0ID0gd2luZG93XzEuWE1MSHR0cFJlcXVlc3QgfHwgbm9vcDtcbmNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCA9IFwid2l0aENyZWRlbnRpYWxzXCIgaW4gKG5ldyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QoKSkgPyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QgOiB3aW5kb3dfMS5YRG9tYWluUmVxdWVzdDtcblxuZm9yRWFjaEFycmF5KFtcImdldFwiLCBcInB1dFwiLCBcInBvc3RcIiwgXCJwYXRjaFwiLCBcImhlYWRcIiwgXCJkZWxldGVcIl0sIGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgIGNyZWF0ZVhIUlttZXRob2QgPT09IFwiZGVsZXRlXCIgPyBcImRlbFwiIDogbWV0aG9kXSA9IGZ1bmN0aW9uKHVyaSwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgICAgb3B0aW9ucyA9IGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjayk7XG4gICAgICAgIG9wdGlvbnMubWV0aG9kID0gbWV0aG9kLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiBfY3JlYXRlWEhSKG9wdGlvbnMpXG4gICAgfTtcbn0pO1xuXG5mdW5jdGlvbiBmb3JFYWNoQXJyYXkoYXJyYXksIGl0ZXJhdG9yKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpdGVyYXRvcihhcnJheVtpXSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpc0VtcHR5KG9iail7XG4gICAgZm9yKHZhciBpIGluIG9iail7XG4gICAgICAgIGlmKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG59XG5cbmZ1bmN0aW9uIGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciBwYXJhbXMgPSB1cmk7XG5cbiAgICBpZiAoaXNGdW5jdGlvbl8xKG9wdGlvbnMpKSB7XG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICAgICAgaWYgKHR5cGVvZiB1cmkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHBhcmFtcyA9IHt1cmk6dXJpfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtcyA9IGltbXV0YWJsZShvcHRpb25zLCB7dXJpOiB1cml9KTtcbiAgICB9XG5cbiAgICBwYXJhbXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICByZXR1cm4gcGFyYW1zXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVhIUih1cmksIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgb3B0aW9ucyA9IGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjayk7XG4gICAgcmV0dXJuIF9jcmVhdGVYSFIob3B0aW9ucylcbn1cblxuZnVuY3Rpb24gX2NyZWF0ZVhIUihvcHRpb25zKSB7XG4gICAgaWYodHlwZW9mIG9wdGlvbnMuY2FsbGJhY2sgPT09IFwidW5kZWZpbmVkXCIpe1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYWxsYmFjayBhcmd1bWVudCBtaXNzaW5nXCIpXG4gICAgfVxuXG4gICAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIGNiT25jZShlcnIsIHJlc3BvbnNlLCBib2R5KXtcbiAgICAgICAgaWYoIWNhbGxlZCl7XG4gICAgICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICAgICAgb3B0aW9ucy5jYWxsYmFjayhlcnIsIHJlc3BvbnNlLCBib2R5KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiByZWFkeXN0YXRlY2hhbmdlKCkge1xuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQobG9hZEZ1bmMsIDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Qm9keSgpIHtcbiAgICAgICAgLy8gQ2hyb21lIHdpdGggcmVxdWVzdFR5cGU9YmxvYiB0aHJvd3MgZXJyb3JzIGFycm91bmQgd2hlbiBldmVuIHRlc3RpbmcgYWNjZXNzIHRvIHJlc3BvbnNlVGV4dFxuICAgICAgICB2YXIgYm9keSA9IHVuZGVmaW5lZDtcblxuICAgICAgICBpZiAoeGhyLnJlc3BvbnNlKSB7XG4gICAgICAgICAgICBib2R5ID0geGhyLnJlc3BvbnNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYm9keSA9IHhoci5yZXNwb25zZVRleHQgfHwgZ2V0WG1sKHhocik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNKc29uKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnBhcnNlKGJvZHkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBib2R5XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3JGdW5jKGV2dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKTtcbiAgICAgICAgaWYoIShldnQgaW5zdGFuY2VvZiBFcnJvcikpe1xuICAgICAgICAgICAgZXZ0ID0gbmV3IEVycm9yKFwiXCIgKyAoZXZ0IHx8IFwiVW5rbm93biBYTUxIdHRwUmVxdWVzdCBFcnJvclwiKSApO1xuICAgICAgICB9XG4gICAgICAgIGV2dC5zdGF0dXNDb2RlID0gMDtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGV2dCwgZmFpbHVyZVJlc3BvbnNlKVxuICAgIH1cblxuICAgIC8vIHdpbGwgbG9hZCB0aGUgZGF0YSAmIHByb2Nlc3MgdGhlIHJlc3BvbnNlIGluIGEgc3BlY2lhbCByZXNwb25zZSBvYmplY3RcbiAgICBmdW5jdGlvbiBsb2FkRnVuYygpIHtcbiAgICAgICAgaWYgKGFib3J0ZWQpIHJldHVyblxuICAgICAgICB2YXIgc3RhdHVzO1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKTtcbiAgICAgICAgaWYob3B0aW9ucy51c2VYRFIgJiYgeGhyLnN0YXR1cz09PXVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy9JRTggQ09SUyBHRVQgc3VjY2Vzc2Z1bCByZXNwb25zZSBkb2Vzbid0IGhhdmUgYSBzdGF0dXMgZmllbGQsIGJ1dCBib2R5IGlzIGZpbmVcbiAgICAgICAgICAgIHN0YXR1cyA9IDIwMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzID8gMjA0IDogeGhyLnN0YXR1cyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3BvbnNlID0gZmFpbHVyZVJlc3BvbnNlO1xuICAgICAgICB2YXIgZXJyID0gbnVsbDtcblxuICAgICAgICBpZiAoc3RhdHVzICE9PSAwKXtcbiAgICAgICAgICAgIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIGJvZHk6IGdldEJvZHkoKSxcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXMsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgICAgICAgICAgdXJsOiB1cmksXG4gICAgICAgICAgICAgICAgcmF3UmVxdWVzdDogeGhyXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycyl7IC8vcmVtZW1iZXIgeGhyIGNhbiBpbiBmYWN0IGJlIFhEUiBmb3IgQ09SUyBpbiBJRVxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmhlYWRlcnMgPSBwYXJzZUhlYWRlcnMoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVyciA9IG5ldyBFcnJvcihcIkludGVybmFsIFhNTEh0dHBSZXF1ZXN0IEVycm9yXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIsIHJlc3BvbnNlLCByZXNwb25zZS5ib2R5KVxuICAgIH1cblxuICAgIHZhciB4aHIgPSBvcHRpb25zLnhociB8fCBudWxsO1xuXG4gICAgaWYgKCF4aHIpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuY29ycyB8fCBvcHRpb25zLnVzZVhEUikge1xuICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCgpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHhociA9IG5ldyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBrZXk7XG4gICAgdmFyIGFib3J0ZWQ7XG4gICAgdmFyIHVyaSA9IHhoci51cmwgPSBvcHRpb25zLnVyaSB8fCBvcHRpb25zLnVybDtcbiAgICB2YXIgbWV0aG9kID0geGhyLm1ldGhvZCA9IG9wdGlvbnMubWV0aG9kIHx8IFwiR0VUXCI7XG4gICAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHkgfHwgb3B0aW9ucy5kYXRhO1xuICAgIHZhciBoZWFkZXJzID0geGhyLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgfHwge307XG4gICAgdmFyIHN5bmMgPSAhIW9wdGlvbnMuc3luYztcbiAgICB2YXIgaXNKc29uID0gZmFsc2U7XG4gICAgdmFyIHRpbWVvdXRUaW1lcjtcbiAgICB2YXIgZmFpbHVyZVJlc3BvbnNlID0ge1xuICAgICAgICBib2R5OiB1bmRlZmluZWQsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgICBzdGF0dXNDb2RlOiAwLFxuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgdXJsOiB1cmksXG4gICAgICAgIHJhd1JlcXVlc3Q6IHhoclxuICAgIH07XG5cbiAgICBpZiAoXCJqc29uXCIgaW4gb3B0aW9ucyAmJiBvcHRpb25zLmpzb24gIT09IGZhbHNlKSB7XG4gICAgICAgIGlzSnNvbiA9IHRydWU7XG4gICAgICAgIGhlYWRlcnNbXCJhY2NlcHRcIl0gfHwgaGVhZGVyc1tcIkFjY2VwdFwiXSB8fCAoaGVhZGVyc1tcIkFjY2VwdFwiXSA9IFwiYXBwbGljYXRpb24vanNvblwiKTsgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXJcbiAgICAgICAgaWYgKG1ldGhvZCAhPT0gXCJHRVRcIiAmJiBtZXRob2QgIT09IFwiSEVBRFwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiY29udGVudC10eXBlXCJdIHx8IGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gfHwgKGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gPSBcImFwcGxpY2F0aW9uL2pzb25cIik7IC8vRG9uJ3Qgb3ZlcnJpZGUgZXhpc3RpbmcgYWNjZXB0IGhlYWRlciBkZWNsYXJlZCBieSB1c2VyXG4gICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5qc29uID09PSB0cnVlID8gYm9keSA6IG9wdGlvbnMuanNvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gcmVhZHlzdGF0ZWNoYW5nZTtcbiAgICB4aHIub25sb2FkID0gbG9hZEZ1bmM7XG4gICAgeGhyLm9uZXJyb3IgPSBlcnJvckZ1bmM7XG4gICAgLy8gSUU5IG11c3QgaGF2ZSBvbnByb2dyZXNzIGJlIHNldCB0byBhIHVuaXF1ZSBmdW5jdGlvbi5cbiAgICB4aHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSUUgbXVzdCBkaWVcbiAgICB9O1xuICAgIHhoci5vbmFib3J0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYWJvcnRlZCA9IHRydWU7XG4gICAgfTtcbiAgICB4aHIub250aW1lb3V0ID0gZXJyb3JGdW5jO1xuICAgIHhoci5vcGVuKG1ldGhvZCwgdXJpLCAhc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZCk7XG4gICAgLy9oYXMgdG8gYmUgYWZ0ZXIgb3BlblxuICAgIGlmKCFzeW5jKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSAhIW9wdGlvbnMud2l0aENyZWRlbnRpYWxzO1xuICAgIH1cbiAgICAvLyBDYW5ub3Qgc2V0IHRpbWVvdXQgd2l0aCBzeW5jIHJlcXVlc3RcbiAgICAvLyBub3Qgc2V0dGluZyB0aW1lb3V0IG9uIHRoZSB4aHIgb2JqZWN0LCBiZWNhdXNlIG9mIG9sZCB3ZWJraXRzIGV0Yy4gbm90IGhhbmRsaW5nIHRoYXQgY29ycmVjdGx5XG4gICAgLy8gYm90aCBucG0ncyByZXF1ZXN0IGFuZCBqcXVlcnkgMS54IHVzZSB0aGlzIGtpbmQgb2YgdGltZW91dCwgc28gdGhpcyBpcyBiZWluZyBjb25zaXN0ZW50XG4gICAgaWYgKCFzeW5jICYmIG9wdGlvbnMudGltZW91dCA+IDAgKSB7XG4gICAgICAgIHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmIChhYm9ydGVkKSByZXR1cm5cbiAgICAgICAgICAgIGFib3J0ZWQgPSB0cnVlOy8vSUU5IG1heSBzdGlsbCBjYWxsIHJlYWR5c3RhdGVjaGFuZ2VcbiAgICAgICAgICAgIHhoci5hYm9ydChcInRpbWVvdXRcIik7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBFcnJvcihcIlhNTEh0dHBSZXF1ZXN0IHRpbWVvdXRcIik7XG4gICAgICAgICAgICBlLmNvZGUgPSBcIkVUSU1FRE9VVFwiO1xuICAgICAgICAgICAgZXJyb3JGdW5jKGUpO1xuICAgICAgICB9LCBvcHRpb25zLnRpbWVvdXQgKTtcbiAgICB9XG5cbiAgICBpZiAoeGhyLnNldFJlcXVlc3RIZWFkZXIpIHtcbiAgICAgICAgZm9yKGtleSBpbiBoZWFkZXJzKXtcbiAgICAgICAgICAgIGlmKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSl7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmhlYWRlcnMgJiYgIWlzRW1wdHkob3B0aW9ucy5oZWFkZXJzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIZWFkZXJzIGNhbm5vdCBiZSBzZXQgb24gYW4gWERvbWFpblJlcXVlc3Qgb2JqZWN0XCIpXG4gICAgfVxuXG4gICAgaWYgKFwicmVzcG9uc2VUeXBlXCIgaW4gb3B0aW9ucykge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gb3B0aW9ucy5yZXNwb25zZVR5cGU7XG4gICAgfVxuXG4gICAgaWYgKFwiYmVmb3JlU2VuZFwiIGluIG9wdGlvbnMgJiZcbiAgICAgICAgdHlwZW9mIG9wdGlvbnMuYmVmb3JlU2VuZCA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIG9wdGlvbnMuYmVmb3JlU2VuZCh4aHIpO1xuICAgIH1cblxuICAgIC8vIE1pY3Jvc29mdCBFZGdlIGJyb3dzZXIgc2VuZHMgXCJ1bmRlZmluZWRcIiB3aGVuIHNlbmQgaXMgY2FsbGVkIHdpdGggdW5kZWZpbmVkIHZhbHVlLlxuICAgIC8vIFhNTEh0dHBSZXF1ZXN0IHNwZWMgc2F5cyB0byBwYXNzIG51bGwgYXMgYm9keSB0byBpbmRpY2F0ZSBubyBib2R5XG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uYXVndHVyL3hoci9pc3N1ZXMvMTAwLlxuICAgIHhoci5zZW5kKGJvZHkgfHwgbnVsbCk7XG5cbiAgICByZXR1cm4geGhyXG5cblxufVxuXG5mdW5jdGlvbiBnZXRYbWwoeGhyKSB7XG4gICAgLy8geGhyLnJlc3BvbnNlWE1MIHdpbGwgdGhyb3cgRXhjZXB0aW9uIFwiSW52YWxpZFN0YXRlRXJyb3JcIiBvciBcIkRPTUV4Y2VwdGlvblwiXG4gICAgLy8gU2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9YTUxIdHRwUmVxdWVzdC9yZXNwb25zZVhNTC5cbiAgICB0cnkge1xuICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVHlwZSA9PT0gXCJkb2N1bWVudFwiKSB7XG4gICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlWE1MXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcmVmb3hCdWdUYWtlbkVmZmVjdCA9IHhoci5yZXNwb25zZVhNTCAmJiB4aHIucmVzcG9uc2VYTUwuZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lID09PSBcInBhcnNlcmVycm9yXCI7XG4gICAgICAgIGlmICh4aHIucmVzcG9uc2VUeXBlID09PSBcIlwiICYmICFmaXJlZm94QnVnVGFrZW5FZmZlY3QpIHtcbiAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VYTUxcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICByZXR1cm4gbnVsbFxufVxuXG5mdW5jdGlvbiBub29wKCkge31cblxueGhyLmRlZmF1bHQgPSBkZWZhdWx0XzE7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiB0eXBlb2Ygb2JqO1xufSA6IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG59O1xuXG5cblxuXG5cbnZhciBhc3luY0dlbmVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXdhaXRWYWx1ZSh2YWx1ZSkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEFzeW5jR2VuZXJhdG9yKGdlbikge1xuICAgIHZhciBmcm9udCwgYmFjaztcblxuICAgIGZ1bmN0aW9uIHNlbmQoa2V5LCBhcmcpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgIGFyZzogYXJnLFxuICAgICAgICAgIHJlc29sdmU6IHJlc29sdmUsXG4gICAgICAgICAgcmVqZWN0OiByZWplY3QsXG4gICAgICAgICAgbmV4dDogbnVsbFxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChiYWNrKSB7XG4gICAgICAgICAgYmFjayA9IGJhY2submV4dCA9IHJlcXVlc3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZnJvbnQgPSBiYWNrID0gcmVxdWVzdDtcbiAgICAgICAgICByZXN1bWUoa2V5LCBhcmcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXN1bWUoa2V5LCBhcmcpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBnZW5ba2V5XShhcmcpO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXdhaXRWYWx1ZSkge1xuICAgICAgICAgIFByb21pc2UucmVzb2x2ZSh2YWx1ZS52YWx1ZSkudGhlbihmdW5jdGlvbiAoYXJnKSB7XG4gICAgICAgICAgICByZXN1bWUoXCJuZXh0XCIsIGFyZyk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgcmVzdW1lKFwidGhyb3dcIiwgYXJnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXR0bGUocmVzdWx0LmRvbmUgPyBcInJldHVyblwiIDogXCJub3JtYWxcIiwgcmVzdWx0LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHNldHRsZShcInRocm93XCIsIGVycik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0dGxlKHR5cGUsIHZhbHVlKSB7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcInJldHVyblwiOlxuICAgICAgICAgIGZyb250LnJlc29sdmUoe1xuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgZG9uZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJ0aHJvd1wiOlxuICAgICAgICAgIGZyb250LnJlamVjdCh2YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBmcm9udC5yZXNvbHZlKHtcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIGRvbmU6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGZyb250ID0gZnJvbnQubmV4dDtcblxuICAgICAgaWYgKGZyb250KSB7XG4gICAgICAgIHJlc3VtZShmcm9udC5rZXksIGZyb250LmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiYWNrID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLl9pbnZva2UgPSBzZW5kO1xuXG4gICAgaWYgKHR5cGVvZiBnZW4ucmV0dXJuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMucmV0dXJuID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHtcbiAgICBBc3luY0dlbmVyYXRvci5wcm90b3R5cGVbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgfVxuXG4gIEFzeW5jR2VuZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB0aGlzLl9pbnZva2UoXCJuZXh0XCIsIGFyZyk7XG4gIH07XG5cbiAgQXN5bmNHZW5lcmF0b3IucHJvdG90eXBlLnRocm93ID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB0aGlzLl9pbnZva2UoXCJ0aHJvd1wiLCBhcmcpO1xuICB9O1xuXG4gIEFzeW5jR2VuZXJhdG9yLnByb3RvdHlwZS5yZXR1cm4gPSBmdW5jdGlvbiAoYXJnKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ludm9rZShcInJldHVyblwiLCBhcmcpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgd3JhcDogZnVuY3Rpb24gKGZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IEFzeW5jR2VuZXJhdG9yKGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGF3YWl0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBuZXcgQXdhaXRWYWx1ZSh2YWx1ZSk7XG4gICAgfVxuICB9O1xufSgpO1xuXG5cblxuXG5cbnZhciBjbGFzc0NhbGxDaGVjayA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59O1xuXG52YXIgY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KCk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHRvQ29uc3VtYWJsZUFycmF5ID0gZnVuY3Rpb24gKGFycikge1xuICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgYXJyMltpXSA9IGFycltpXTtcblxuICAgIHJldHVybiBhcnIyO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGFycik7XG4gIH1cbn07XG5cbnZhciBsYXN0RXJyb3IgPSAnJztcblxuLyoqXG4gKiBDcmVhdGVzIHRoZSBIVExNIGZvciBhIGZhaWx1cmUgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd9IGNhbnZhc0NvbnRhaW5lcklkIGlkIG9mIGNvbnRhaW5lciBvZiB0aFxuICogICAgICAgIGNhbnZhcy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGh0bWwuXG4gKi9cbmZ1bmN0aW9uIG1ha2VGYWlsSFRNTChtc2cpIHtcbiAgICByZXR1cm4gJ1xcbjx0YWJsZSBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICM4Q0U7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7XCI+PHRyPlxcbjx0ZCBhbGlnbj1cImNlbnRlclwiPlxcbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiB0YWJsZS1jZWxsOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1wiPlxcbjxkaXYgc3R5bGU9XCJcIj4nICsgbXNnICsgJzwvZGl2PlxcbjwvZGl2PlxcbjwvdGQ+PC90cj48L3RhYmxlPlxcbic7XG59XG5cbi8qKlxuICogTWVzc2FnZSBmb3IgZ2V0dGluZyBhIHdlYmdsIGJyb3dzZXJcbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbnZhciBHRVRfQV9XRUJHTF9CUk9XU0VSID0gJ1xcblxcdFRoaXMgcGFnZSByZXF1aXJlcyBhIGJyb3dzZXIgdGhhdCBzdXBwb3J0cyBXZWJHTC48YnIvPlxcblxcdDxhIGhyZWY9XCJodHRwOi8vZ2V0LndlYmdsLm9yZ1wiPkNsaWNrIGhlcmUgdG8gdXBncmFkZSB5b3VyIGJyb3dzZXIuPC9hPlxcbic7XG5cbi8qKlxuICogTWVzc2FnZSBmb3IgbmVlZCBiZXR0ZXIgaGFyZHdhcmVcbiAqIEB0eXBlIHtzdHJpbmd9XG4gKi9cbnZhciBPVEhFUl9QUk9CTEVNID0gJ1xcblxcdEl0IGRvZXMgbm90IGFwcGVhciB5b3VyIGNvbXB1dGVyIGNhbiBzdXBwb3J0IFdlYkdMLjxici8+XFxuXFx0PGEgaHJlZj1cImh0dHA6Ly9nZXQud2ViZ2wub3JnL3Ryb3VibGVzaG9vdGluZy9cIj5DbGljayBoZXJlIGZvciBtb3JlIGluZm9ybWF0aW9uLjwvYT5cXG4nO1xuXG4vKipcbiAqIENvZGUgdG8gcmV0dXJuIGluIGBvbkVycm9yYCBjYWxsYmFjayB3aGVuIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCB3ZWJnbFxuICogQHR5cGUge251bWJlcn1cbiAqL1xudmFyIEVSUk9SX0JST1dTRVJfU1VQUE9SVCA9IDE7XG5cbi8qKlxuICogQ29kZSB0byByZXR1cm4gaW4gYG9uRXJyb3JgIGNhbGxiYWNrIHRoZXJlJ3MgYW55IG90aGVyIHByb2JsZW0gcmVsYXRlZCB0byB3ZWJnbFxuICogQHR5cGUge251bWJlcn1cbiAqL1xudmFyIEVSUk9SX09USEVSID0gMjtcblxuLyoqXG4gKiBDcmVhdGVzIGEgd2ViZ2wgY29udGV4dC4gSWYgY3JlYXRpb24gZmFpbHMgaXQgd2lsbFxuICogY2hhbmdlIHRoZSBjb250ZW50cyBvZiB0aGUgY29udGFpbmVyIG9mIHRoZSA8Y2FudmFzPlxuICogdGFnIHRvIGFuIGVycm9yIG1lc3NhZ2Ugd2l0aCB0aGUgY29ycmVjdCBsaW5rcyBmb3IgV2ViR0wsXG4gKiB1bmxlc3MgYG9uRXJyb3JgIG9wdGlvbiBpcyBkZWZpbmVkIHRvIGEgY2FsbGJhY2ssXG4gKiB3aGljaCBhbGxvd3MgZm9yIGN1c3RvbSBlcnJvciBoYW5kbGluZy4uXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGNhbnZhcy4gVGhlIGNhbnZhcyBlbGVtZW50IHRvIGNyZWF0ZSBhXG4gKiAgICAgY29udGV4dCBmcm9tLlxuICogQHBhcmFtIHtXZWJHTENvbnRleHRDcmVhdGlvbkF0dHJpYnV0ZXN9IG9wdEF0dHJpYnMgQW55XG4gKiAgICAgY3JlYXRpb24gYXR0cmlidXRlcyB5b3Ugd2FudCB0byBwYXNzIGluLlxuICogQHJldHVybiB7V2ViR0xSZW5kZXJpbmdDb250ZXh0fSBUaGUgY3JlYXRlZCBjb250ZXh0LlxuICovXG5mdW5jdGlvbiBzZXR1cFdlYkdMKGNhbnZhcywgb3B0QXR0cmlicywgb25FcnJvcikge1xuICAgIGZ1bmN0aW9uIHNob3dMaW5rKHN0cikge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gY2FudmFzLnBhcmVudE5vZGU7XG4gICAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBtYWtlRmFpbEhUTUwoc3RyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yQ29kZSwgbXNnKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygb25FcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgb25FcnJvcihlcnJvckNvZGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2hvd0xpbmsobXNnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICghd2luZG93LldlYkdMUmVuZGVyaW5nQ29udGV4dCkge1xuICAgICAgICBoYW5kbGVFcnJvcihFUlJPUl9CUk9XU0VSX1NVUFBPUlQsIEdFVF9BX1dFQkdMX0JST1dTRVIpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgY29udGV4dCA9IGNyZWF0ZTNEQ29udGV4dChjYW52YXMsIG9wdEF0dHJpYnMpO1xuICAgIGlmICghY29udGV4dCkge1xuICAgICAgICBoYW5kbGVFcnJvcihFUlJPUl9PVEhFUiwgT1RIRVJfUFJPQkxFTSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29udGV4dC5nZXRFeHRlbnNpb24oJ09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcycpO1xuICAgIH1cbiAgICByZXR1cm4gY29udGV4dDtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgd2ViZ2wgY29udGV4dC5cbiAqIEBwYXJhbSB7IUNhbnZhc30gY2FudmFzIFRoZSBjYW52YXMgdGFnIHRvIGdldCBjb250ZXh0XG4gKiAgICAgZnJvbS4gSWYgb25lIGlzIG5vdCBwYXNzZWQgaW4gb25lIHdpbGwgYmUgY3JlYXRlZC5cbiAqIEByZXR1cm4geyFXZWJHTENvbnRleHR9IFRoZSBjcmVhdGVkIGNvbnRleHQuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZTNEQ29udGV4dChjYW52YXMsIG9wdEF0dHJpYnMpIHtcbiAgICB2YXIgbmFtZXMgPSBbJ3dlYmdsJywgJ2V4cGVyaW1lbnRhbC13ZWJnbCddO1xuICAgIHZhciBjb250ZXh0ID0gbnVsbDtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgbmFtZXMubGVuZ3RoOyArK2lpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQobmFtZXNbaWldLCBvcHRBdHRyaWJzKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29udGV4dDtcbn1cblxuLypcbiAqXHRDcmVhdGUgYSBWZXJ0ZXggb2YgYSBzcGVjaWZpYyB0eXBlIChnbC5WRVJURVhfU0hBREVSLylcbiAqL1xuZnVuY3Rpb24gY3JlYXRlU2hhZGVyKG1haW4sIHNvdXJjZSwgdHlwZSwgb2Zmc2V0KSB7XG4gICAgdmFyIGdsID0gbWFpbi5nbDtcblxuICAgIHZhciBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XG4gICAgZ2wuc2hhZGVyU291cmNlKHNoYWRlciwgc291cmNlKTtcbiAgICBnbC5jb21waWxlU2hhZGVyKHNoYWRlcik7XG5cbiAgICB2YXIgY29tcGlsZWQgPSBnbC5nZXRTaGFkZXJQYXJhbWV0ZXIoc2hhZGVyLCBnbC5DT01QSUxFX1NUQVRVUyk7XG5cbiAgICBpZiAoIWNvbXBpbGVkKSB7XG4gICAgICAgIC8vIFNvbWV0aGluZyB3ZW50IHdyb25nIGR1cmluZyBjb21waWxhdGlvbjsgZ2V0IHRoZSBlcnJvclxuICAgICAgICBsYXN0RXJyb3IgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJyoqKiBFcnJvciBjb21waWxpbmcgc2hhZGVyICcgKyBzaGFkZXIgKyAnOicgKyBsYXN0RXJyb3IpO1xuICAgICAgICBtYWluLnRyaWdnZXIoJ2Vycm9yJywge1xuICAgICAgICAgICAgc2hhZGVyOiBzaGFkZXIsXG4gICAgICAgICAgICBzb3VyY2U6IHNvdXJjZSxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICBlcnJvcjogbGFzdEVycm9yLFxuICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXQgfHwgMFxuICAgICAgICB9KTtcbiAgICAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBzaGFkZXI7XG59XG5cbi8qKlxuICogTG9hZHMgYSBzaGFkZXIuXG4gKiBAcGFyYW0geyFXZWJHTENvbnRleHR9IGdsIFRoZSBXZWJHTENvbnRleHQgdG8gdXNlLlxuICogQHBhcmFtIHtzdHJpbmd9IHNoYWRlclNvdXJjZSBUaGUgc2hhZGVyIHNvdXJjZS5cbiAqIEBwYXJhbSB7bnVtYmVyfSBzaGFkZXJUeXBlIFRoZSB0eXBlIG9mIHNoYWRlci5cbiAqIEBwYXJhbSB7ZnVuY3Rpb24oc3RyaW5nKTogdm9pZCkgb3B0X2Vycm9yQ2FsbGJhY2sgY2FsbGJhY2sgZm9yIGVycm9ycy5cbiAqIEByZXR1cm4geyFXZWJHTFNoYWRlcn0gVGhlIGNyZWF0ZWQgc2hhZGVyLlxuICovXG5mdW5jdGlvbiBjcmVhdGVQcm9ncmFtKG1haW4sIHNoYWRlcnMsIG9wdEF0dHJpYnMsIG9wdExvY2F0aW9ucykge1xuICAgIHZhciBnbCA9IG1haW4uZ2w7XG5cbiAgICB2YXIgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgc2hhZGVycy5sZW5ndGg7ICsraWkpIHtcbiAgICAgICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHNoYWRlcnNbaWldKTtcbiAgICB9XG4gICAgaWYgKG9wdEF0dHJpYnMpIHtcbiAgICAgICAgZm9yICh2YXIgX2lpID0gMDsgX2lpIDwgb3B0QXR0cmlicy5sZW5ndGg7ICsrX2lpKSB7XG4gICAgICAgICAgICBnbC5iaW5kQXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgb3B0TG9jYXRpb25zID8gb3B0TG9jYXRpb25zW19paV0gOiBfaWksIG9wdEF0dHJpYnNbX2lpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7XG5cbiAgICAvLyBDaGVjayB0aGUgbGluayBzdGF0dXNcbiAgICB2YXIgbGlua2VkID0gZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5MSU5LX1NUQVRVUyk7XG4gICAgaWYgKCFsaW5rZWQpIHtcbiAgICAgICAgLy8gc29tZXRoaW5nIHdlbnQgd3Jvbmcgd2l0aCB0aGUgbGlua1xuICAgICAgICBsYXN0RXJyb3IgPSBnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGluIHByb2dyYW0gbGlua2luZzonICsgbGFzdEVycm9yKTtcbiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShwcm9ncmFtKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBwcm9ncmFtO1xufVxuXG4vLyBCeSBCcmV0dCBDYW1iZXIgb25cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YW5ncmFtcy90YW5ncmFtL2Jsb2IvbWFzdGVyL3NyYy9nbC9nbHNsLmpzXG5mdW5jdGlvbiBwYXJzZVVuaWZvcm1zKHVuaWZvcm1zKSB7XG4gICAgdmFyIHByZWZpeCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDtcblxuICAgIHZhciBwYXJzZWQgPSBbXTtcblxuICAgIGZvciAodmFyIG5hbWUgaW4gdW5pZm9ybXMpIHtcbiAgICAgICAgdmFyIHVuaWZvcm0gPSB1bmlmb3Jtc1tuYW1lXTtcbiAgICAgICAgdmFyIHUgPSB2b2lkIDA7XG5cbiAgICAgICAgaWYgKHByZWZpeCkge1xuICAgICAgICAgICAgbmFtZSA9IHByZWZpeCArICcuJyArIG5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaW5nbGUgZmxvYXRcbiAgICAgICAgaWYgKHR5cGVvZiB1bmlmb3JtID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgcGFyc2VkLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdmbG9hdCcsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnMWYnLFxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuaWZvcm1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFycmF5OiB2ZWN0b3IsIGFycmF5IG9mIGZsb2F0cywgYXJyYXkgb2YgdGV4dHVyZXMsIG9yIGFycmF5IG9mIHN0cnVjdHNcbiAgICAgICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh1bmlmb3JtKSkge1xuICAgICAgICAgICAgICAgIC8vIE51bWVyaWMgdmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB1bmlmb3JtWzBdID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBmbG9hdCB2ZWN0b3JzICh2ZWMyLCB2ZWMzLCB2ZWM0KVxuICAgICAgICAgICAgICAgICAgICBpZiAodW5pZm9ybS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZmxvYXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJzFmJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB1bmlmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBmbG9hdCB2ZWN0b3JzICh2ZWMyLCB2ZWMzLCB2ZWM0KVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh1bmlmb3JtLmxlbmd0aCA+PSAyICYmIHVuaWZvcm0ubGVuZ3RoIDw9IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd2ZWMnICsgdW5pZm9ybS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogdW5pZm9ybS5sZW5ndGggKyAnZnYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdW5pZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmxvYXQgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHVuaWZvcm0ubGVuZ3RoID4gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZmxvYXRbXScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICcxZnYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSArICdbMF0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHVuaWZvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBhc3N1bWUgbWF0cml4IGZvciAodHlwZW9mID09IEZsb2F0MzJBcnJheSAmJiBsZW5ndGggPT0gMTYpP1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBBcnJheSBvZiB0ZXh0dXJlc1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1bmlmb3JtWzBdID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzYW1wbGVyMkQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJzFpJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB1bmlmb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBBcnJheSBvZiBhcnJheXMgLSBidXQgb25seSBhcnJheXMgb2YgdmVjdG9ycyBhcmUgYWxsb3dlZCBpbiB0aGlzIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh1bmlmb3JtWzBdKSAmJiB0eXBlb2YgdW5pZm9ybVswXVswXSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmbG9hdCB2ZWN0b3JzICh2ZWMyLCB2ZWMzLCB2ZWM0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmlmb3JtWzBdLmxlbmd0aCA+PSAyICYmIHVuaWZvcm1bMF0ubGVuZ3RoIDw9IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IGVhY2ggdmVjdG9yIGluIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHUgPSAwOyB1IDwgdW5pZm9ybS5sZW5ndGg7IHUrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd2ZWMnICsgdW5pZm9ybVswXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiB1bmlmb3JtW3VdLmxlbmd0aCArICdmdicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSArICdbJyArIHUgKyAnXScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHVuaWZvcm1bdV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2UgZXJyb3I/XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcnJheSBvZiBzdHJ1Y3R1cmVzXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChfdHlwZW9mKHVuaWZvcm1bMF0pID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHUgPSAwOyB1IDwgdW5pZm9ybS5sZW5ndGg7IHUrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IGVhY2ggc3RydWN0IGluIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkLnB1c2guYXBwbHkocGFyc2VkLCB0b0NvbnN1bWFibGVBcnJheShwYXJzZVVuaWZvcm1zKHVuaWZvcm1bdV0sIG5hbWUgKyAnWycgKyB1ICsgJ10nKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQm9vbGVhblxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHVuaWZvcm0gPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYm9vbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICcxaScsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHVuaWZvcm1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRleHR1cmVcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdW5pZm9ybSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2FtcGxlcjJEJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICcxaScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdW5pZm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gU3RydWN0dXJlXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCh0eXBlb2YgdW5pZm9ybSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodW5pZm9ybSkpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBlYWNoIGZpZWxkIGluIHRoZSBzdHJ1Y3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWQucHVzaC5hcHBseShwYXJzZWQsIHRvQ29uc3VtYWJsZUFycmF5KHBhcnNlVW5pZm9ybXModW5pZm9ybSwgbmFtZSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgLy8gVE9ETzogc3VwcG9ydCBvdGhlciBub24tZmxvYXQgdHlwZXM/IChpbnQsIGV0Yy4pXG4gICAgfVxuICAgIHJldHVybiBwYXJzZWQ7XG59XG5cbmZ1bmN0aW9uIGlzQ2FudmFzVmlzaWJsZShjYW52YXMpIHtcbiAgICByZXR1cm4gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArIGNhbnZhcy5oZWlnaHQgPiAwICYmIGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgPCAod2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpO1xufVxuXG5mdW5jdGlvbiBpc1Bvd2VyT2YyKHZhbHVlKSB7XG4gICAgcmV0dXJuICh2YWx1ZSAmIHZhbHVlIC0gMSkgPT09IDA7XG59XG5cbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xuICAgIHJldHVybiAoL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KVxuICAgICk7XG59XG5cblxuXG5cblxuXG5cbmZ1bmN0aW9uIGlzRGlmZihhLCBiKSB7XG4gICAgaWYgKGEgJiYgYikge1xuICAgICAgICByZXR1cm4gYS50b1N0cmluZygpICE9PSBiLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlTWl4aW4kMSh0YXJnZXQpIHtcbiAgICB2YXIgbGlzdGVuZXJzID0gbmV3IFNldCgpO1xuXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7XG4gICAgICAgIG9uOiBmdW5jdGlvbiBvbih0eXBlLCBmKSB7XG4gICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSB7fTtcbiAgICAgICAgICAgIGxpc3RlbmVyW3R5cGVdID0gZjtcbiAgICAgICAgICAgIGxpc3RlbmVycy5hZGQobGlzdGVuZXIpO1xuICAgICAgICB9LFxuICAgICAgICBvZmY6IGZ1bmN0aW9uIG9mZih0eXBlLCBmKSB7XG4gICAgICAgICAgICBpZiAoZikge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IHt9O1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyW3R5cGVdID0gZjtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGxpc3RlbmVyc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gX3N0ZXAudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gT2JqZWN0LmtleXMoaXRlbSlbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IF9zdGVwMi52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSB0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcnMuZGVsZXRlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbGlzdFN1YnNjcmlwdGlvbnM6IGZ1bmN0aW9uIGxpc3RTdWJzY3JpcHRpb25zKCkge1xuICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjMgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjMgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IGxpc3RlbmVyc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwMy52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMy5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc3Vic2NyaWJlOiBmdW5jdGlvbiBzdWJzY3JpYmUobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGxpc3RlbmVycy5hZGQobGlzdGVuZXIpO1xuICAgICAgICB9LFxuICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gdW5zdWJzY3JpYmUobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xuICAgICAgICB9LFxuICAgICAgICB1bnN1YnNjcmliZUFsbDogZnVuY3Rpb24gdW5zdWJzY3JpYmVBbGwoKSB7XG4gICAgICAgICAgICBsaXN0ZW5lcnMuY2xlYXIoKTtcbiAgICAgICAgfSxcbiAgICAgICAgdHJpZ2dlcjogZnVuY3Rpb24gdHJpZ2dlcihldmVudCkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGRhdGEgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3I0ID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3I0ID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjQgPSBsaXN0ZW5lcnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDQ7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSAoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX3N0ZXA0LnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXJbZXZlbnRdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcltldmVudF0uYXBwbHkobGlzdGVuZXIsIHRvQ29uc3VtYWJsZUFycmF5KGRhdGEpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yNCA9IHRydWU7XG4gICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3I0ID0gZXJyO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ICYmIF9pdGVyYXRvcjQucmV0dXJuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3I0LnJldHVybigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8vIFRleHR1cmUgbWFuYWdlbWVudFxudmFyIFRleHR1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVGV4dHVyZShnbCwgbmFtZSkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307XG4gICAgICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIFRleHR1cmUpO1xuXG4gICAgICAgIHN1YnNjcmliZU1peGluJDEodGhpcyk7XG5cbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgICAgICB0aGlzLnRleHR1cmUgPSBnbC5jcmVhdGVUZXh0dXJlKCk7XG4gICAgICAgIGlmICh0aGlzLnRleHR1cmUpIHtcbiAgICAgICAgICAgIHRoaXMudmFsaWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYmluZCgpO1xuXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuc291cmNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5zb3VyY2VUeXBlID0gbnVsbDtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gbnVsbDsgLy8gYSBQcm9taXNlIG9iamVjdCB0byB0cmFjayB0aGUgbG9hZGluZyBzdGF0ZSBvZiB0aGlzIHRleHR1cmVcblxuICAgICAgICAvLyBEZWZhdWx0IHRvIGEgMS1waXhlbCBibGFjayB0ZXh0dXJlIHNvIHdlIGNhbiBzYWZlbHkgcmVuZGVyIHdoaWxlIHdlIHdhaXQgZm9yIGFuIGltYWdlIHRvIGxvYWRcbiAgICAgICAgLy8gU2VlOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE5NzIyMjQ3L3dlYmdsLXdhaXQtZm9yLXRleHR1cmUtdG8tbG9hZFxuICAgICAgICB0aGlzLnNldERhdGEoMSwgMSwgbmV3IFVpbnQ4QXJyYXkoWzAsIDAsIDAsIDI1NV0pLCB7IGZpbHRlcmluZzogJ2xpbmVhcicgfSk7XG4gICAgICAgIHRoaXMuc2V0RmlsdGVyaW5nKG9wdGlvbnMuZmlsdGVyaW5nKTtcblxuICAgICAgICB0aGlzLmxvYWQob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLy8gRGVzdHJveSBhIHNpbmdsZSB0ZXh0dXJlIGluc3RhbmNlXG5cblxuICAgIGNyZWF0ZUNsYXNzKFRleHR1cmUsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2wuZGVsZXRlVGV4dHVyZSh0aGlzLnRleHR1cmUpO1xuICAgICAgICAgICAgdGhpcy50ZXh0dXJlID0gbnVsbDtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRhdGE7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy52YWxpZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdiaW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmQodW5pdCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiB1bml0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIGlmIChUZXh0dXJlLmFjdGl2ZVVuaXQgIT09IHVuaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nbC5hY3RpdmVUZXh0dXJlKHRoaXMuZ2wuVEVYVFVSRTAgKyB1bml0KTtcbiAgICAgICAgICAgICAgICAgICAgVGV4dHVyZS5hY3RpdmVVbml0ID0gdW5pdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoVGV4dHVyZS5hY3RpdmVUZXh0dXJlICE9PSB0aGlzLnRleHR1cmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdsLmJpbmRUZXh0dXJlKHRoaXMuZ2wuVEVYVFVSRV8yRCwgdGhpcy50ZXh0dXJlKTtcbiAgICAgICAgICAgICAgICBUZXh0dXJlLmFjdGl2ZVRleHR1cmUgPSB0aGlzLnRleHR1cmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnVybCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy51cmwgPT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLnVybCAhPT0gdGhpcy51cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRVcmwob3B0aW9ucy51cmwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5lbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRFbGVtZW50KG9wdGlvbnMuZWxlbWVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLndpZHRoICYmIG9wdGlvbnMuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXREYXRhKG9wdGlvbnMud2lkdGgsIG9wdGlvbnMuaGVpZ2h0LCBvcHRpb25zLmRhdGEsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0cyB0ZXh0dXJlIGZyb20gYW4gdXJsXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldFVybCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRVcmwodXJsKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgICAgICAgIGlmICghdGhpcy52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy51cmwgPSB1cmw7IC8vIHNhdmUgVVJMIHJlZmVyZW5jZSAod2lsbCBiZSBvdmVyd3JpdHRlbiB3aGVuIGVsZW1lbnQgaXMgbG9hZGVkIGJlbG93KVxuICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLnVybDtcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9ICd1cmwnO1xuXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4dCA9IHVybC5zcGxpdCgnLicpLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGlzVmlkZW8gPSBleHQgPT09ICdvZ3YnIHx8IGV4dCA9PT0gJ3dlYm0nIHx8IGV4dCA9PT0gJ21wNCc7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAoaXNWaWRlbykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdXRvcGxheSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZmlsdGVyaW5nID0gJ25lYXJlc3QnO1xuICAgICAgICAgICAgICAgICAgICAvLyBlbGVtZW50LnByZWxvYWQgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRFbGVtZW50KGVsZW1lbnQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVGV4dHVyZSBcXCcnICsgX3RoaXMubmFtZSArICdcXCc6IGZhaWxlZCB0byBsb2FkIHVybDogXFwnJyArIF90aGlzLnNvdXJjZSArICdcXCcnLCBlLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVsZW1lbnQub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdhcm4gYW5kIHJlc29sdmUgb24gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1RleHR1cmUgXFwnJyArIF90aGlzLm5hbWUgKyAnXFwnOiBmYWlsZWQgdG8gbG9hZCB1cmw6IFxcJycgKyBfdGhpcy5zb3VyY2UgKyAnXFwnJywgZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBTYWZhcmkgaGFzIGEgYnVnIGxvYWRpbmcgZGF0YS1VUkwgZWxlbWVudHMgd2l0aCBDT1JTIGVuYWJsZWQsIHNvIGl0IG11c3QgYmUgZGlzYWJsZWQgaW4gdGhhdCBjYXNlXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEyMzk3OFxuICAgICAgICAgICAgICAgIGlmICghKGlzU2FmYXJpKCkgJiYgX3RoaXMuc291cmNlLnNsaWNlKDAsIDUpID09PSAnZGF0YTonKSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNyb3NzT3JpZ2luID0gJ2Fub255bW91cyc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZWxlbWVudC5zcmMgPSBfdGhpcy5zb3VyY2U7XG4gICAgICAgICAgICAgICAgaWYgKGlzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0RWxlbWVudChlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvYWRpbmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXRzIHRleHR1cmUgdG8gYSByYXcgaW1hZ2UgYnVmZmVyXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldERhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGF0YSh3aWR0aCwgaGVpZ2h0LCBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307XG5cbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IGRhdGE7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZVR5cGUgPSAnZGF0YSc7XG5cbiAgICAgICAgICAgIHRoaXMudXBkYXRlKG9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5zZXRGaWx0ZXJpbmcob3B0aW9ucyk7XG5cbiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IFByb21pc2UucmVzb2x2ZSh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvYWRpbmc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXRzIHRoZSB0ZXh0dXJlIHRvIHRyYWNrIGEgZWxlbWVudCAoY2FudmFzL2ltYWdlKVxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZXRFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEVsZW1lbnQoZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBlbCA9IGVsZW1lbnQ7XG5cbiAgICAgICAgICAgIC8vIGEgc3RyaW5nIGVsZW1lbnQgaXMgaW50ZXJwZXRlZCBhcyBhIENTUyBzZWxlY3RvclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxDYW52YXNFbGVtZW50IHx8IGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50IHx8IGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSBlbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9ICdlbGVtZW50JztcblxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmludGVydmFsSUQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnVwZGF0ZShvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDE1KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZShvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGaWx0ZXJpbmcob3B0aW9ucyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBtc2cgPSAndGhlIFxcJ2VsZW1lbnRcXCcgcGFyYW1ldGVyIChgZWxlbWVudDogJyArIEpTT04uc3RyaW5naWZ5KGVsKSArICdgKSBtdXN0IGJlIGEgQ1NTICc7XG4gICAgICAgICAgICAgICAgbXNnICs9ICdzZWxlY3RvciBzdHJpbmcsIG9yIGEgPGNhbnZhcz4sIDxpbWFnZT4gb3IgPHZpZGVvPiBvYmplY3QnO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUZXh0dXJlIFxcJycgKyB0aGlzLm5hbWUgKyAnXFwnOiAnICsgbXNnLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gUHJvbWlzZS5yZXNvbHZlKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVwbG9hZHMgY3VycmVudCBpbWFnZSBvciBidWZmZXIgdG8gdGhlIEdQVSAoY2FuIGJlIHVzZWQgdG8gdXBkYXRlIGFuaW1hdGVkIHRleHR1cmVzIG9uIHRoZSBmbHkpXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VwZGF0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG5cbiAgICAgICAgICAgIGlmICghdGhpcy52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5iaW5kKCk7XG4gICAgICAgICAgICB0aGlzLmdsLnBpeGVsU3RvcmVpKHRoaXMuZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgb3B0aW9ucy5VTlBBQ0tfRkxJUF9ZX1dFQkdMID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmdsLnBpeGVsU3RvcmVpKHRoaXMuZ2wuVU5QQUNLX1BSRU1VTFRJUExZX0FMUEhBX1dFQkdMLCBvcHRpb25zLlVOUEFDS19QUkVNVUxUSVBMWV9BTFBIQV9XRUJHTCB8fCBmYWxzZSk7XG5cbiAgICAgICAgICAgIC8vIEltYWdlIG9yIENhbnZhcyBlbGVtZW50XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VUeXBlID09PSAnZWxlbWVudCcgJiYgKHRoaXMuc291cmNlIGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQgfHwgdGhpcy5zb3VyY2UgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50IHx8IHRoaXMuc291cmNlIGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCAmJiB0aGlzLnNvdXJjZS5jb21wbGV0ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zb3VyY2UgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNvdXJjZS52aWRlb1dpZHRoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuc291cmNlLnZpZGVvSGVpZ2h0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLnNvdXJjZS53aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLnNvdXJjZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZ2wudGV4SW1hZ2UyRCh0aGlzLmdsLlRFWFRVUkVfMkQsIDAsIHRoaXMuZ2wuUkdCQSwgdGhpcy5nbC5SR0JBLCB0aGlzLmdsLlVOU0lHTkVEX0JZVEUsIHRoaXMuc291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJhdyBpbWFnZSBidWZmZXJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc291cmNlVHlwZSA9PT0gJ2RhdGEnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2wudGV4SW1hZ2UyRCh0aGlzLmdsLlRFWFRVUkVfMkQsIDAsIHRoaXMuZ2wuUkdCQSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIDAsIHRoaXMuZ2wuUkdCQSwgdGhpcy5nbC5VTlNJR05FRF9CWVRFLCB0aGlzLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdsb2FkZWQnLCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZXMgYXBwcm9wcmlhdGUgZmlsdGVyaW5nIG1vZGVcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2V0RmlsdGVyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZpbHRlcmluZygpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnBvd2VyT2YyID0gaXNQb3dlck9mMih0aGlzLndpZHRoKSAmJiBpc1Bvd2VyT2YyKHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgICAgIHZhciBkZWZ1YWx0RmlsdGVyID0gdGhpcy5wb3dlck9mMiA/ICdtaXBtYXAnIDogJ2xpbmVhcic7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcmluZyA9IG9wdGlvbnMuZmlsdGVyaW5nIHx8IGRlZnVhbHRGaWx0ZXI7XG5cbiAgICAgICAgICAgIHZhciBnbCA9IHRoaXMuZ2w7XG4gICAgICAgICAgICB0aGlzLmJpbmQoKTtcblxuICAgICAgICAgICAgLy8gRm9yIHBvd2VyLW9mLTIgdGV4dHVyZXMsIHRoZSBmb2xsb3dpbmcgcHJlc2V0cyBhcmUgYXZhaWxhYmxlOlxuICAgICAgICAgICAgLy8gbWlwbWFwOiBsaW5lYXIgYmxlbmQgZnJvbSBuZWFyZXN0IG1pcFxuICAgICAgICAgICAgLy8gbGluZWFyOiBsaW5lYXIgYmxlbmQgZnJvbSBvcmlnaW5hbCBpbWFnZSAobm8gbWlwcylcbiAgICAgICAgICAgIC8vIG5lYXJlc3Q6IG5lYXJlc3QgcGl4ZWwgZnJvbSBvcmlnaW5hbCBpbWFnZSAobm8gbWlwcywgJ2Jsb2NreScgbG9vaylcbiAgICAgICAgICAgIGlmICh0aGlzLnBvd2VyT2YyKSB7XG4gICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfUywgb3B0aW9ucy5URVhUVVJFX1dSQVBfUyB8fCBvcHRpb25zLnJlcGVhdCAmJiBnbC5SRVBFQVQgfHwgZ2wuQ0xBTVBfVE9fRURHRSk7XG4gICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfVCwgb3B0aW9ucy5URVhUVVJFX1dSQVBfVCB8fCBvcHRpb25zLnJlcGVhdCAmJiBnbC5SRVBFQVQgfHwgZ2wuQ0xBTVBfVE9fRURHRSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJpbmcgPT09ICdtaXBtYXAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5MSU5FQVJfTUlQTUFQX0xJTkVBUik7IC8vIFRPRE86IHVzZSB0cmlsaW5lYXIgZmlsdGVyaW5nIGJ5IGRlZnVhbHQgaW5zdGVhZD9cbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLkxJTkVBUik7XG4gICAgICAgICAgICAgICAgICAgIGdsLmdlbmVyYXRlTWlwbWFwKGdsLlRFWFRVUkVfMkQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWx0ZXJpbmcgPT09ICdsaW5lYXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5MSU5FQVIpO1xuICAgICAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUFHX0ZJTFRFUiwgZ2wuTElORUFSKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmlsdGVyaW5nID09PSAnbmVhcmVzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01JTl9GSUxURVIsIGdsLk5FQVJFU1QpO1xuICAgICAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUFHX0ZJTFRFUiwgZ2wuTkVBUkVTVCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBXZWJHTCBoYXMgc3RyaWN0IHJlcXVpcmVtZW50cyBvbiBub24tcG93ZXItb2YtMiB0ZXh0dXJlczpcbiAgICAgICAgICAgICAgICAvLyBObyBtaXBtYXBzIGFuZCBtdXN0IGNsYW1wIHRvIGVkZ2VcbiAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9TLCBnbC5DTEFNUF9UT19FREdFKTtcbiAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9ULCBnbC5DTEFNUF9UT19FREdFKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlcmluZyA9PT0gJ21pcG1hcCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJpbmcgPSAnbGluZWFyJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWx0ZXJpbmcgPT09ICduZWFyZXN0Jykge1xuICAgICAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgZ2wuTkVBUkVTVCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5ORUFSRVNUKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBkZWZhdWx0IHRvIGxpbmVhciBmb3Igbm9uLXBvd2VyLW9mLTIgdGV4dHVyZXNcbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01JTl9GSUxURVIsIGdsLkxJTkVBUik7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5MSU5FQVIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcbiAgICByZXR1cm4gVGV4dHVyZTtcbn0oKTtcblxuLy8gUmVwb3J0IG1heCB0ZXh0dXJlIHNpemUgZm9yIGEgR0wgY29udGV4dFxuXG5cblRleHR1cmUuZ2V0TWF4VGV4dHVyZVNpemUgPSBmdW5jdGlvbiAoZ2wpIHtcbiAgICByZXR1cm4gZ2wuZ2V0UGFyYW1ldGVyKGdsLk1BWF9URVhUVVJFX1NJWkUpO1xufTtcblxuLy8gR2xvYmFsIHNldCBvZiB0ZXh0dXJlcywgYnkgbmFtZVxuVGV4dHVyZS5hY3RpdmVVbml0ID0gLTE7XG5cbi8qXG5UaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuQ29weXJpZ2h0IChjKSAyMDE1IFBhdHJpY2lvIEdvbnphbGV6IFZpdm8gKCBodHRwOi8vd3d3LnBhdHJpY2lvZ29uemFsZXp2aXZvLmNvbSApXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcbnRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICdTb2Z0d2FyZScpLCB0byBkZWFsIGluXG50aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXG51c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZlxudGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLFxuc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxuY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbklNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTXG5GT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1JcbkNPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUlxuSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU5cbkNPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG4qL1xuXG52YXIgR2xzbENhbnZhcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBHbHNsQ2FudmFzKGNhbnZhcywgY29udGV4dE9wdGlvbnMsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBHbHNsQ2FudmFzKTtcblxuICAgICAgICBzdWJzY3JpYmVNaXhpbiQxKHRoaXMpO1xuXG4gICAgICAgIGNvbnRleHRPcHRpb25zID0gY29udGV4dE9wdGlvbnMgfHwge307XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgIHRoaXMud2lkdGggPSBjYW52YXMuY2xpZW50V2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gY2FudmFzLmNsaWVudEhlaWdodDtcblxuICAgICAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICAgICAgdGhpcy5nbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcm9ncmFtID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnRleHR1cmVzID0ge307XG4gICAgICAgIHRoaXMuYnVmZmVycyA9IHt9O1xuICAgICAgICB0aGlzLnVuaWZvcm1zID0ge307XG4gICAgICAgIHRoaXMudmJvID0ge307XG4gICAgICAgIHRoaXMuaXNWYWxpZCA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuQlVGRkVSX0NPVU5UID0gMDtcbiAgICAgICAgdGhpcy5URVhUVVJFX0NPVU5UID0gMDtcblxuICAgICAgICB0aGlzLnZlcnRleFN0cmluZyA9IGNvbnRleHRPcHRpb25zLnZlcnRleFN0cmluZyB8fCAnXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxuYXR0cmlidXRlIHZlYzIgYV9wb3NpdGlvbjtcXG5hdHRyaWJ1dGUgdmVjMiBhX3RleGNvb3JkO1xcblxcbnZhcnlpbmcgdmVjMiB2X3RleGNvb3JkO1xcblxcbnZvaWQgbWFpbigpIHtcXG4gICAgZ2xfUG9zaXRpb24gPSB2ZWM0KGFfcG9zaXRpb24sIDAuMCwgMS4wKTtcXG4gICAgdl90ZXhjb29yZCA9IGFfdGV4Y29vcmQ7XFxufVxcbic7XG4gICAgICAgIHRoaXMuZnJhZ21lbnRTdHJpbmcgPSBjb250ZXh0T3B0aW9ucy5mcmFnbWVudFN0cmluZyB8fCAnXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudmFyeWluZyB2ZWMyIHZfdGV4Y29vcmQ7XFxuXFxudm9pZCBtYWluKCl7XFxuICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoMC4wKTtcXG59XFxuJztcblxuICAgICAgICAvLyBHTCBDb250ZXh0XG4gICAgICAgIHZhciBnbCA9IHNldHVwV2ViR0woY2FudmFzLCBjb250ZXh0T3B0aW9ucywgb3B0aW9ucy5vbkVycm9yKTtcbiAgICAgICAgaWYgKCFnbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy50aW1lTG9hZCA9IHRoaXMudGltZVByZXYgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgdGhpcy50aW1lRGVsdGEgPSAwLjA7XG4gICAgICAgIHRoaXMuZm9yY2VSZW5kZXIgPSB0cnVlO1xuICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlYWxUb0NTU1BpeGVscyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG5cbiAgICAgICAgLy8gQWxsb3cgYWxwaGFcbiAgICAgICAgY2FudmFzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbnRleHRPcHRpb25zLmJhY2tncm91bmRDb2xvciB8fCAncmdiYSgxLDEsMSwwKSc7XG5cbiAgICAgICAgLy8gTG9hZCBzaGFkZXJcbiAgICAgICAgaWYgKGNhbnZhcy5oYXNBdHRyaWJ1dGUoJ2RhdGEtZnJhZ21lbnQnKSkge1xuICAgICAgICAgICAgdGhpcy5mcmFnbWVudFN0cmluZyA9IGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtZnJhZ21lbnQnKTtcbiAgICAgICAgfSBlbHNlIGlmIChjYW52YXMuaGFzQXR0cmlidXRlKCdkYXRhLWZyYWdtZW50LXVybCcpKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gY2FudmFzLmdldEF0dHJpYnV0ZSgnZGF0YS1mcmFnbWVudC11cmwnKTtcbiAgICAgICAgICAgIHhoci5nZXQoc291cmNlLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMubG9hZChib2R5LCBfdGhpcy52ZXJ0ZXhTdHJpbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMb2FkIHNoYWRlclxuICAgICAgICBpZiAoY2FudmFzLmhhc0F0dHJpYnV0ZSgnZGF0YS12ZXJ0ZXgnKSkge1xuICAgICAgICAgICAgdGhpcy52ZXJ0ZXhTdHJpbmcgPSBjYW52YXMuZ2V0QXR0cmlidXRlKCdkYXRhLXZlcnRleCcpO1xuICAgICAgICB9IGVsc2UgaWYgKGNhbnZhcy5oYXNBdHRyaWJ1dGUoJ2RhdGEtdmVydGV4LXVybCcpKSB7XG4gICAgICAgICAgICB2YXIgX3NvdXJjZSA9IGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmVydGV4LXVybCcpO1xuICAgICAgICAgICAgeGhyLmdldChfc291cmNlLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMubG9hZChfdGhpcy5mcmFnbWVudFN0cmluZywgYm9keSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubG9hZCgpO1xuXG4gICAgICAgIGlmICghdGhpcy5wcm9ncmFtKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgVmVydGV4IGJ1ZmZlclxuICAgICAgICB2YXIgdGV4Q29vcmRzTG9jID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24odGhpcy5wcm9ncmFtLCAnYV90ZXhjb29yZCcpO1xuICAgICAgICB0aGlzLnZiby50ZXhDb29yZHMgPSBnbC5jcmVhdGVCdWZmZXIoKTtcbiAgICAgICAgdGhpcy5nbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdGhpcy52Ym8udGV4Q29vcmRzKTtcbiAgICAgICAgdGhpcy5nbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgbmV3IEZsb2F0MzJBcnJheShbMC4wLCAwLjAsIDEuMCwgMC4wLCAwLjAsIDEuMCwgMC4wLCAxLjAsIDEuMCwgMC4wLCAxLjAsIDEuMF0pLCBnbC5TVEFUSUNfRFJBVyk7XG4gICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkodGV4Q29vcmRzTG9jKTtcbiAgICAgICAgdGhpcy5nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKHRleENvb3Jkc0xvYywgMiwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcblxuICAgICAgICB2YXIgdmVydGljZXNMb2MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbih0aGlzLnByb2dyYW0sICdhX3Bvc2l0aW9uJyk7XG4gICAgICAgIHRoaXMudmJvLnZlcnRpY2VzID0gZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgIHRoaXMuZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHRoaXMudmJvLnZlcnRpY2VzKTtcbiAgICAgICAgdGhpcy5nbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgbmV3IEZsb2F0MzJBcnJheShbLTEuMCwgLTEuMCwgMS4wLCAtMS4wLCAtMS4wLCAxLjAsIC0xLjAsIDEuMCwgMS4wLCAtMS4wLCAxLjAsIDEuMF0pLCBnbC5TVEFUSUNfRFJBVyk7XG4gICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkodmVydGljZXNMb2MpO1xuICAgICAgICB0aGlzLmdsLnZlcnRleEF0dHJpYlBvaW50ZXIodmVydGljZXNMb2MsIDIsIGdsLkZMT0FULCBmYWxzZSwgMCwgMCk7XG5cbiAgICAgICAgLy8gbG9hZCBURVhUVVJFU1xuICAgICAgICBpZiAoY2FudmFzLmhhc0F0dHJpYnV0ZSgnZGF0YS10ZXh0dXJlcycpKSB7XG4gICAgICAgICAgICB2YXIgaW1nTGlzdCA9IGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGV4dHVyZXMnKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgZm9yICh2YXIgbkltZyBpbiBpbWdMaXN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVbmlmb3JtKCd1X3RleCcgKyBuSW1nLCBpbWdMaXN0W25JbWddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09IEVWRU5UU1xuICAgICAgICB2YXIgbW91c2UgPSB7XG4gICAgICAgICAgICB4OiAwLFxuICAgICAgICAgICAgeTogMFxuICAgICAgICB9O1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgbW91c2UueCA9IGUuY2xpZW50WCB8fCBlLnBhZ2VYO1xuICAgICAgICAgICAgbW91c2UueSA9IGUuY2xpZW50WSB8fCBlLnBhZ2VZO1xuICAgICAgICB9LCBmYWxzZSk7XG5cbiAgICAgICAgdmFyIHNhbmRib3ggPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBSZW5kZXJMb29wKCkge1xuICAgICAgICAgICAgaWYgKHNhbmRib3gubk1vdXNlID4gMSkge1xuICAgICAgICAgICAgICAgIHNhbmRib3guc2V0TW91c2UobW91c2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2FuZGJveC5mb3JjZVJlbmRlciA9IHNhbmRib3gucmVzaXplKCk7XG4gICAgICAgICAgICBzYW5kYm94LnJlbmRlcigpO1xuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShSZW5kZXJMb29wKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0YXJ0XG4gICAgICAgIHRoaXMuc2V0TW91c2UoeyB4OiAwLCB5OiAwIH0pO1xuICAgICAgICBSZW5kZXJMb29wKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNyZWF0ZUNsYXNzKEdsc2xDYW52YXMsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgdGV4IGluIHRoaXMudGV4dHVyZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGV4LmRlc3Ryb3kpIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRleHR1cmVzID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBhdHQgaW4gdGhpcy5hdHRyaWJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nbC5kZWxldGVCdWZmZXIodGhpcy5hdHRyaWJzW2F0dF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKG51bGwpO1xuICAgICAgICAgICAgdGhpcy5nbC5kZWxldGVQcm9ncmFtKHRoaXMucHJvZ3JhbSk7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5idWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyc1trZXldO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2wuZGVsZXRlUHJvZ3JhbShidWZmZXIucHJvZ3JhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5nbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZChmcmFnU3RyaW5nLCB2ZXJ0U3RyaW5nKSB7XG5cbiAgICAgICAgICAgIC8vIExvYWQgdmVydGV4IHNoYWRlciBpZiB0aGVyZSBpcyBvbmVcbiAgICAgICAgICAgIGlmICh2ZXJ0U3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52ZXJ0ZXhTdHJpbmcgPSB2ZXJ0U3RyaW5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMb2FkIGZyYWdtZW50IHNoYWRlciBpZiB0aGVyZSBpcyBvbmVcbiAgICAgICAgICAgIGlmIChmcmFnU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mcmFnbWVudFN0cmluZyA9IGZyYWdTdHJpbmc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMubkRlbHRhID0gKHRoaXMuZnJhZ21lbnRTdHJpbmcubWF0Y2goL3VfZGVsdGEvZykgfHwgW10pLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMublRpbWUgPSAodGhpcy5mcmFnbWVudFN0cmluZy5tYXRjaCgvdV90aW1lL2cpIHx8IFtdKS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLm5EYXRlID0gKHRoaXMuZnJhZ21lbnRTdHJpbmcubWF0Y2goL3VfZGF0ZS9nKSB8fCBbXSkubGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5uTW91c2UgPSAodGhpcy5mcmFnbWVudFN0cmluZy5tYXRjaCgvdV9tb3VzZS9nKSB8fCBbXSkubGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRlZCA9IHRoaXMubkRhdGUgPiAxIHx8IHRoaXMublRpbWUgPiAxIHx8IHRoaXMubk1vdXNlID4gMTtcblxuICAgICAgICAgICAgdmFyIG5UZXh0dXJlcyA9IHRoaXMuZnJhZ21lbnRTdHJpbmcuc2VhcmNoKC9zYW1wbGVyMkQvZyk7XG4gICAgICAgICAgICBpZiAoblRleHR1cmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmVzID0gdGhpcy5mcmFnbWVudFN0cmluZy5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSBsaW5lc1tpXS5tYXRjaCgvdW5pZm9ybVxccypzYW1wbGVyMkRcXHMqKFtcXHddKik7XFxzKlxcL1xcL1xccyooW1xcd3xcXDpcXC9cXC98XFwufFxcLXxcXF9dKikvaSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4dCA9IG1hdGNoWzJdLnNwbGl0KCcuJykucG9wKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaFsxXSAmJiBtYXRjaFsyXSAmJiAoZXh0ID09PSAnanBnJyB8fCBleHQgPT09ICdqcGVnJyB8fCBleHQgPT09ICdwbmcnIHx8IGV4dCA9PT0gJ29ndicgfHwgZXh0ID09PSAnd2VibScgfHwgZXh0ID09PSAnbXA0JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFVuaWZvcm0obWF0Y2hbMV0sIG1hdGNoWzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFpbiA9IGxpbmVzW2ldLm1hdGNoKC9cXHMqdm9pZFxccyptYWluXFxzKi9nKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1haW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmVydGV4U2hhZGVyID0gY3JlYXRlU2hhZGVyKHRoaXMsIHRoaXMudmVydGV4U3RyaW5nLCB0aGlzLmdsLlZFUlRFWF9TSEFERVIpO1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50U2hhZGVyID0gY3JlYXRlU2hhZGVyKHRoaXMsIHRoaXMuZnJhZ21lbnRTdHJpbmcsIHRoaXMuZ2wuRlJBR01FTlRfU0hBREVSKTtcblxuICAgICAgICAgICAgLy8gSWYgRnJhZ21lbnQgc2hhZGVyIGZhaWxzIGxvYWQgYSBlbXB0eSBvbmUgdG8gc2lnbiB0aGUgZXJyb3JcbiAgICAgICAgICAgIGlmICghZnJhZ21lbnRTaGFkZXIpIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudFNoYWRlciA9IGNyZWF0ZVNoYWRlcih0aGlzLCAndm9pZCBtYWluKCl7XFxuXFx0Z2xfRnJhZ0NvbG9yID0gdmVjNCgxLjApO1xcbn0nLCB0aGlzLmdsLkZSQUdNRU5UX1NIQURFUik7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNWYWxpZCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbmQgdXNlIHByb2dyYW1cbiAgICAgICAgICAgIHZhciBwcm9ncmFtID0gY3JlYXRlUHJvZ3JhbSh0aGlzLCBbdmVydGV4U2hhZGVyLCBmcmFnbWVudFNoYWRlcl0pOyAvLywgWzAsMV0sWydhX3RleGNvb3JkJywnYV9wb3NpdGlvbiddKTtcbiAgICAgICAgICAgIHRoaXMuZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcblxuICAgICAgICAgICAgLy8gRGVsZXRlIHNoYWRlcnNcbiAgICAgICAgICAgIC8vIHRoaXMuZ2wuZGV0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRleFNoYWRlcik7XG4gICAgICAgICAgICAvLyB0aGlzLmdsLmRldGFjaFNoYWRlcihwcm9ncmFtLCBmcmFnbWVudFNoYWRlcik7XG4gICAgICAgICAgICB0aGlzLmdsLmRlbGV0ZVNoYWRlcih2ZXJ0ZXhTaGFkZXIpO1xuICAgICAgICAgICAgdGhpcy5nbC5kZWxldGVTaGFkZXIoZnJhZ21lbnRTaGFkZXIpO1xuXG4gICAgICAgICAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2UgPSB0cnVlO1xuXG4gICAgICAgICAgICB0aGlzLkJVRkZFUl9DT1VOVCA9IDA7XG4gICAgICAgICAgICB2YXIgYnVmZmVycyA9IHRoaXMuZ2V0QnVmZmVycyh0aGlzLmZyYWdtZW50U3RyaW5nKTtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhidWZmZXJzKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRQcm9ncmFtcyhidWZmZXJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYnVmZmVycyA9IGJ1ZmZlcnM7XG5cbiAgICAgICAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignbG9hZCcsIHt9KTtcblxuICAgICAgICAgICAgdGhpcy5mb3JjZVJlbmRlciA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Rlc3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdGVzdChjYWxsYmFjaywgZnJhZ1N0cmluZywgdmVydFN0cmluZykge1xuICAgICAgICAgICAgLy8gVGhhbmtzIHRvIEB0aGVzcGl0ZSBmb3IgdGhlIGhlbHAgaGVyZVxuICAgICAgICAgICAgLy8gaHR0cHM6Ly93d3cua2hyb25vcy5vcmcvcmVnaXN0cnkvd2ViZ2wvZXh0ZW5zaW9ucy9FWFRfZGlzam9pbnRfdGltZXJfcXVlcnkvXG4gICAgICAgICAgICB2YXIgcHJlX3Rlc3RfdmVydCA9IHRoaXMudmVydGV4U3RyaW5nO1xuICAgICAgICAgICAgdmFyIHByZV90ZXN0X2ZyYWcgPSB0aGlzLmZyYWdtZW50U3RyaW5nO1xuICAgICAgICAgICAgdmFyIHByZV90ZXN0X3BhdXNlZCA9IHRoaXMucGF1c2VkO1xuXG4gICAgICAgICAgICB2YXIgZXh0ID0gdGhpcy5nbC5nZXRFeHRlbnNpb24oJ0VYVF9kaXNqb2ludF90aW1lcl9xdWVyeScpO1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gZXh0LmNyZWF0ZVF1ZXJ5RVhUKCk7XG4gICAgICAgICAgICB2YXIgd2FzVmFsaWQgPSB0aGlzLmlzVmFsaWQ7XG5cbiAgICAgICAgICAgIGlmIChmcmFnU3RyaW5nIHx8IHZlcnRTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQoZnJhZ1N0cmluZywgdmVydFN0cmluZyk7XG4gICAgICAgICAgICAgICAgd2FzVmFsaWQgPSB0aGlzLmlzVmFsaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JjZVJlbmRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgZXh0LmJlZ2luUXVlcnlFWFQoZXh0LlRJTUVfRUxBUFNFRF9FWFQsIHF1ZXJ5KTtcbiAgICAgICAgICAgIHRoaXMuZm9yY2VSZW5kZXIgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIGV4dC5lbmRRdWVyeUVYVChleHQuVElNRV9FTEFQU0VEX0VYVCk7XG5cbiAgICAgICAgICAgIHZhciBzYW5kYm94ID0gdGhpcztcbiAgICAgICAgICAgIGZ1bmN0aW9uIGZpbmlzaFRlc3QoKSB7XG4gICAgICAgICAgICAgICAgLy8gUmV2ZXJ0IGNoYW5nZXMuLi4gZ28gYmFjayB0byBub3JtYWxcbiAgICAgICAgICAgICAgICBzYW5kYm94LnBhdXNlZCA9IHByZV90ZXN0X3BhdXNlZDtcbiAgICAgICAgICAgICAgICBpZiAoZnJhZ1N0cmluZyB8fCB2ZXJ0U3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNhbmRib3gubG9hZChwcmVfdGVzdF9mcmFnLCBwcmVfdGVzdF92ZXJ0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiB3YWl0Rm9yVGVzdCgpIHtcbiAgICAgICAgICAgICAgICBzYW5kYm94LmZvcmNlUmVuZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzYW5kYm94LnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIHZhciBhdmFpbGFibGUgPSBleHQuZ2V0UXVlcnlPYmplY3RFWFQocXVlcnksIGV4dC5RVUVSWV9SRVNVTFRfQVZBSUxBQkxFX0VYVCk7XG4gICAgICAgICAgICAgICAgdmFyIGRpc2pvaW50ID0gc2FuZGJveC5nbC5nZXRQYXJhbWV0ZXIoZXh0LkdQVV9ESVNKT0lOVF9FWFQpO1xuICAgICAgICAgICAgICAgIGlmIChhdmFpbGFibGUgJiYgIWRpc2pvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXNWYWxpZDogd2FzVmFsaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFnOiBmcmFnU3RyaW5nIHx8IHNhbmRib3guZnJhZ21lbnRTdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0OiB2ZXJ0U3RyaW5nIHx8IHNhbmRib3gudmVydGV4U3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZUVsYXBzZWRNczogZXh0LmdldFF1ZXJ5T2JqZWN0RVhUKHF1ZXJ5LCBleHQuUVVFUllfUkVTVUxUX0VYVCkgLyAxMDAwMDAwLjBcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgZmluaXNoVGVzdCgpO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUod2FpdEZvclRlc3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdhaXRGb3JUZXN0KCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWRUZXh0dXJlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRUZXh0dXJlKG5hbWUsIHVybEVsZW1lbnRPckRhdGEsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0ge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsRWxlbWVudE9yRGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnVybCA9IHVybEVsZW1lbnRPckRhdGE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCh0eXBlb2YgdXJsRWxlbWVudE9yRGF0YSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodXJsRWxlbWVudE9yRGF0YSkpID09PSAnb2JqZWN0JyAmJiB1cmxFbGVtZW50T3JEYXRhLmRhdGEgJiYgdXJsRWxlbWVudE9yRGF0YS53aWR0aCAmJiB1cmxFbGVtZW50T3JEYXRhLmhlaWdodCkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuZGF0YSA9IHVybEVsZW1lbnRPckRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICBvcHRpb25zLndpZHRoID0gdXJsRWxlbWVudE9yRGF0YS53aWR0aDtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmhlaWdodCA9IHVybEVsZW1lbnRPckRhdGEuaGVpZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIGlmICgodHlwZW9mIHVybEVsZW1lbnRPckRhdGEgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHVybEVsZW1lbnRPckRhdGEpKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmVsZW1lbnQgPSB1cmxFbGVtZW50T3JEYXRhO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0dXJlc1tuYW1lXSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHR1cmVzW25hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dHVyZXNbbmFtZV0ubG9hZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0dXJlc1tuYW1lXS5vbignbG9hZGVkJywgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5mb3JjZVJlbmRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0dXJlc1tuYW1lXSA9IG5ldyBUZXh0dXJlKHRoaXMuZ2wsIG5hbWUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHRoaXMudGV4dHVyZXNbbmFtZV0ub24oJ2xvYWRlZCcsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5mb3JjZVJlbmRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlZnJlc2hVbmlmb3JtcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWZyZXNoVW5pZm9ybXMoKSB7XG4gICAgICAgICAgICB0aGlzLnVuaWZvcm1zID0ge307XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldFVuaWZvcm0nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VW5pZm9ybShuYW1lKSB7XG4gICAgICAgICAgICB2YXIgdSA9IHt9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgdmFsdWUgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB1W25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnNldFVuaWZvcm1zKHUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZXRVbmlmb3JtcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRVbmlmb3Jtcyh1bmlmb3Jtcykge1xuICAgICAgICAgICAgdmFyIHBhcnNlZCA9IHBhcnNlVW5pZm9ybXModW5pZm9ybXMpO1xuICAgICAgICAgICAgLy8gU2V0IGVhY2ggdW5pZm9ybVxuICAgICAgICAgICAgZm9yICh2YXIgdSBpbiBwYXJzZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkW3VdLnR5cGUgPT09ICdzYW1wbGVyMkQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciB0ZXh0dXJlcywgd2UgbmVlZCB0byB0cmFjayB0ZXh0dXJlIHVuaXRzLCBzbyB3ZSBoYXZlIGEgc3BlY2lhbCBzZXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy51bmlmb3JtVGV4dHVyZShwYXJzZWRbdV0ubmFtZSwgcGFyc2VkW3VdLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkVGV4dHVyZShwYXJzZWRbdV0ubmFtZSwgcGFyc2VkW3VdLnZhbHVlWzBdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVuaWZvcm0ocGFyc2VkW3VdLm1ldGhvZCwgcGFyc2VkW3VdLnR5cGUsIHBhcnNlZFt1XS5uYW1lLCBwYXJzZWRbdV0udmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcmNlUmVuZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldE1vdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1vdXNlKG1vdXNlKSB7XG4gICAgICAgICAgICAvLyBzZXQgdGhlIG1vdXNlIHVuaWZvcm1cbiAgICAgICAgICAgIHZhciByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBpZiAobW91c2UgJiYgbW91c2UueCAmJiBtb3VzZS54ID49IHJlY3QubGVmdCAmJiBtb3VzZS54IDw9IHJlY3QucmlnaHQgJiYgbW91c2UueSAmJiBtb3VzZS55ID49IHJlY3QudG9wICYmIG1vdXNlLnkgPD0gcmVjdC5ib3R0b20pIHtcblxuICAgICAgICAgICAgICAgIHZhciBtb3VzZV94ID0gKG1vdXNlLnggLSByZWN0LmxlZnQpICogdGhpcy5yZWFsVG9DU1NQaXhlbHM7XG4gICAgICAgICAgICAgICAgdmFyIG1vdXNlX3kgPSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAobW91c2UueSAtIHJlY3QudG9wKSAqIHRoaXMucmVhbFRvQ1NTUGl4ZWxzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuYnVmZmVycykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXJzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2wudXNlUHJvZ3JhbShidWZmZXIucHJvZ3JhbSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2wudW5pZm9ybTJmKHRoaXMuZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKGJ1ZmZlci5wcm9ncmFtLCAndV9tb3VzZScpLCBtb3VzZV94LCBtb3VzZV95KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKHRoaXMucHJvZ3JhbSk7XG4gICAgICAgICAgICAgICAgdGhpcy5nbC51bmlmb3JtMmYodGhpcy5nbC5nZXRVbmlmb3JtTG9jYXRpb24odGhpcy5wcm9ncmFtLCAndV9tb3VzZScpLCBtb3VzZV94LCBtb3VzZV95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGV4OiBwcm9ncmFtLnVuaWZvcm0oJzNmJywgJ3Bvc2l0aW9uJywgeCwgeSwgeik7XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VuaWZvcm0nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pZm9ybShtZXRob2QsIHR5cGUsIG5hbWUpIHtcbiAgICAgICAgICAgIC8vICd2YWx1ZScgaXMgYSBtZXRob2QtYXBwcm9wcmlhdGUgYXJndW1lbnRzIGxpc3RcbiAgICAgICAgICAgIHRoaXMudW5pZm9ybXNbbmFtZV0gPSB0aGlzLnVuaWZvcm1zW25hbWVdIHx8IHt9O1xuICAgICAgICAgICAgdmFyIHVuaWZvcm0gPSB0aGlzLnVuaWZvcm1zW25hbWVdO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIHZhbHVlID0gQXJyYXkoX2xlbjIgPiAzID8gX2xlbjIgLSAzIDogMCksIF9rZXkyID0gMzsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgICAgICAgICAgIHZhbHVlW19rZXkyIC0gM10gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY2hhbmdlID0gaXNEaWZmKHVuaWZvcm0udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2UgfHwgdGhpcy5jaGFuZ2UgfHwgdW5pZm9ybS5sb2NhdGlvbiA9PT0gdW5kZWZpbmVkIHx8IHVuaWZvcm0udmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHVuaWZvcm0ubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgdW5pZm9ybS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHVuaWZvcm0udHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgdW5pZm9ybS5tZXRob2QgPSAndW5pZm9ybScgKyBtZXRob2Q7XG4gICAgICAgICAgICAgICAgdW5pZm9ybS5sb2NhdGlvbiA9IHRoaXMuZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHRoaXMucHJvZ3JhbSwgbmFtZSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmdsW3VuaWZvcm0ubWV0aG9kXS5hcHBseSh0aGlzLmdsLCBbdW5pZm9ybS5sb2NhdGlvbl0uY29uY2F0KHVuaWZvcm0udmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5pZm9ybVRleHR1cmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5pZm9ybVRleHR1cmUobmFtZSwgdGV4dHVyZSwgb3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKHRoaXMudGV4dHVyZXNbbmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZFRleHR1cmUobmFtZSwgdGV4dHVyZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXNpemUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMud2lkdGggIT09IHRoaXMuY2FudmFzLmNsaWVudFdpZHRoIHx8IHRoaXMuaGVpZ2h0ICE9PSB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlYWxUb0NTU1BpeGVscyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG5cbiAgICAgICAgICAgICAgICAvLyBMb29rdXAgdGhlIHNpemUgdGhlIGJyb3dzZXIgaXMgZGlzcGxheWluZyB0aGUgY2FudmFzIGluIENTUyBwaXhlbHNcbiAgICAgICAgICAgICAgICAvLyBhbmQgY29tcHV0ZSBhIHNpemUgbmVlZGVkIHRvIG1ha2Ugb3VyIGRyYXdpbmdidWZmZXIgbWF0Y2ggaXQgaW5cbiAgICAgICAgICAgICAgICAvLyBkZXZpY2UgcGl4ZWxzLlxuICAgICAgICAgICAgICAgIHZhciBkaXNwbGF5V2lkdGggPSBNYXRoLmZsb29yKHRoaXMuZ2wuY2FudmFzLmNsaWVudFdpZHRoICogdGhpcy5yZWFsVG9DU1NQaXhlbHMpO1xuICAgICAgICAgICAgICAgIHZhciBkaXNwbGF5SGVpZ2h0ID0gTWF0aC5mbG9vcih0aGlzLmdsLmNhbnZhcy5jbGllbnRIZWlnaHQgKiB0aGlzLnJlYWxUb0NTU1BpeGVscyk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY2FudmFzIGlzIG5vdCB0aGUgc2FtZSBzaXplLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdsLmNhbnZhcy53aWR0aCAhPT0gZGlzcGxheVdpZHRoIHx8IHRoaXMuZ2wuY2FudmFzLmhlaWdodCAhPT0gZGlzcGxheUhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIHRoZSBjYW52YXMgdGhlIHNhbWUgc2l6ZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdsLmNhbnZhcy53aWR0aCA9IGRpc3BsYXlXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nbC5jYW52YXMuaGVpZ2h0ID0gZGlzcGxheUhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSB2aWV3cG9ydCB0byBtYXRjaFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdsLnZpZXdwb3J0KDAsIDAsIHRoaXMuZ2wuY2FudmFzLndpZHRoLCB0aGlzLmdsLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmdsLnZpZXdwb3J0KDAsIDAsIHRoaXMuZ2wuZHJhd2luZ0J1ZmZlcldpZHRoLCB0aGlzLmdsLmRyYXdpbmdCdWZmZXJIZWlnaHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5jYW52YXMuY2xpZW50V2lkdGg7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemVTd2FwcGFibGVCdWZmZXJzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9IGlzQ2FudmFzVmlzaWJsZSh0aGlzLmNhbnZhcyk7XG4gICAgICAgICAgICBpZiAodGhpcy5mb3JjZVJlbmRlciB8fCB0aGlzLmFuaW1hdGVkICYmIHRoaXMudmlzaWJsZSAmJiAhdGhpcy5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb2dyYW1zKCk7XG4gICAgICAgICAgICAgICAgLy8gVHJpZ2dlciBldmVudFxuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigncmVuZGVyJywge30pO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JjZVJlbmRlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGxheScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwbGF5KCkge1xuICAgICAgICAgICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndmVyc2lvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2ZXJzaW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICcwLjAuMjcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVuZGVyIG1haW4gYW5kIGJ1ZmZlcnMgcHJvZ3JhbXNcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyUHJvZ3JhbXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyUHJvZ3JhbXMoKSB7XG4gICAgICAgICAgICB2YXIgZ2wgPSB0aGlzLmdsLFxuICAgICAgICAgICAgICAgIFcgPSBnbC5jYW52YXMud2lkdGgsXG4gICAgICAgICAgICAgICAgSCA9IGdsLmNhbnZhcy5oZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVZhcmlhYmxlcygpO1xuICAgICAgICAgICAgZ2wudmlld3BvcnQoMCwgMCwgVywgSCk7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5idWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyc1trZXldO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVW5pZm9ybXMoYnVmZmVyLnByb2dyYW0sIGtleSk7XG4gICAgICAgICAgICAgICAgYnVmZmVyLmJ1bmRsZS5yZW5kZXIoVywgSCwgYnVmZmVyLnByb2dyYW0sIGJ1ZmZlci5uYW1lKTtcbiAgICAgICAgICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVVbmlmb3Jtcyh0aGlzLnByb2dyYW0sICdtYWluJyk7XG4gICAgICAgICAgICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgNik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1cGRhdGUgZ2xzbENhbnZhcyB2YXJpYWJsZXNcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndXBkYXRlVmFyaWFibGVzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVZhcmlhYmxlcygpIHtcbiAgICAgICAgICAgIHZhciBnbHNsID0gdGhpcztcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgICAgIHZhciB2YXJpYWJsZXMgPSB0aGlzLnZhcmlhYmxlcyB8fCB7fTtcbiAgICAgICAgICAgIHZhcmlhYmxlcy5wcmV2ID0gdmFyaWFibGVzLnByZXYgfHwgbm93O1xuICAgICAgICAgICAgdmFyaWFibGVzLmRlbHRhID0gKG5vdyAtIHZhcmlhYmxlcy5wcmV2KSAvIDEwMDAuMDtcbiAgICAgICAgICAgIHZhcmlhYmxlcy5wcmV2ID0gbm93O1xuICAgICAgICAgICAgdmFyaWFibGVzLmxvYWQgPSBnbHNsLnRpbWVMb2FkO1xuICAgICAgICAgICAgdmFyaWFibGVzLnRpbWUgPSAobm93IC0gZ2xzbC50aW1lTG9hZCkgLyAxMDAwLjA7XG4gICAgICAgICAgICB2YXJpYWJsZXMueWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHZhcmlhYmxlcy5tb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIHZhcmlhYmxlcy5kYXRlID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgICAgICAgICB2YXJpYWJsZXMuZGF5dGltZSA9IGRhdGUuZ2V0SG91cnMoKSAqIDM2MDAgKyBkYXRlLmdldE1pbnV0ZXMoKSAqIDYwICsgZGF0ZS5nZXRTZWNvbmRzKCkgKyBkYXRlLmdldE1pbGxpc2Vjb25kcygpICogMC4wMDE7XG4gICAgICAgICAgICB0aGlzLnZhcmlhYmxlcyA9IHZhcmlhYmxlcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVwZGF0ZSB1bmlmb3JtcyBwZXIgcHJvZ3JhbVxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd1cGRhdGVVbmlmb3JtcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVVbmlmb3Jtcyhwcm9ncmFtLCBrZXkpIHtcbiAgICAgICAgICAgIHZhciBnbCA9IHRoaXMuZ2wsXG4gICAgICAgICAgICAgICAgdmFyaWFibGVzID0gdGhpcy52YXJpYWJsZXM7XG4gICAgICAgICAgICBnbC51c2VQcm9ncmFtKHByb2dyYW0pO1xuICAgICAgICAgICAgaWYgKHRoaXMubkRlbHRhID4gMSkge1xuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgZGVsdGEgdGltZSB1bmlmb3JtXG4gICAgICAgICAgICAgICAgZ2wudW5pZm9ybTFmKGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV9kZWx0YScpLCB2YXJpYWJsZXMuZGVsdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMublRpbWUgPiAxKSB7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBlbGFwc2VkIHRpbWUgdW5pZm9ybVxuICAgICAgICAgICAgICAgIGdsLnVuaWZvcm0xZihnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgJ3VfdGltZScpLCB2YXJpYWJsZXMudGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5uRGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vIFNldCBkYXRlIHVuaWZvcm06IHllYXIvbW9udGgvZGF5L3RpbWVfaW5fc2VjXG4gICAgICAgICAgICAgICAgZ2wudW5pZm9ybTRmKGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV9kYXRlJyksIHZhcmlhYmxlcy55ZWFyLCB2YXJpYWJsZXMubW9udGgsIHZhcmlhYmxlcy5kYXRlLCB2YXJpYWJsZXMuZGF5dGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBzZXQgdGhlIHJlc29sdXRpb24gdW5pZm9ybVxuICAgICAgICAgICAgZ2wudW5pZm9ybTJmKGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV9yZXNvbHV0aW9uJyksIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICAgICAgLy8gdGhpcy51bmlmb3JtKCcyZicsICd2ZWMyJywgJ3VfcmVzb2x1dGlvbicsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2tleTMgaW4gdGhpcy5idWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyc1tfa2V5M107XG4gICAgICAgICAgICAgICAgZ2wudW5pZm9ybTFpKGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCBidWZmZXIubmFtZSksIGJ1ZmZlci5idW5kbGUuaW5wdXQuaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5URVhUVVJFX0NPVU5UID0gdGhpcy5CVUZGRVJfQ09VTlQ7XG4gICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMudGV4dHVyZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy51bmlmb3JtVGV4dHVyZShuYW1lLCBudWxsLCB7XG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcmluZzogJ21pcG1hcCcsXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0dXJlID0gdGhpcy50ZXh0dXJlc1tuYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCArIHRoaXMuVEVYVFVSRV9DT1VOVCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmUudGV4dHVyZSk7XG4gICAgICAgICAgICAgICAgICAgIGdsLnVuaWZvcm0xaShnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgbmFtZSksIHRoaXMuVEVYVFVSRV9DT1VOVCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLnVuaWZvcm0yZihnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgbmFtZSArICdSZXNvbHV0aW9uJyksIHRleHR1cmUud2lkdGgsIHRleHR1cmUuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5URVhUVVJFX0NPVU5UKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcGFyc2UgaW5wdXQgc3RyaW5nc1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRCdWZmZXJzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEJ1ZmZlcnMoZnJhZ1N0cmluZykge1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcnMgPSB7fTtcbiAgICAgICAgICAgIGlmIChmcmFnU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgZnJhZ1N0cmluZy5yZXBsYWNlKC8oPzpeXFxzKikoKD86I2lmfCNlbGlmKSg/OlxccyopKGRlZmluZWRcXHMqXFwoXFxzKkJVRkZFUl8pKFxcZCspKD86XFxzKlxcKSl8KD86I2lmZGVmKSg/OlxccypCVUZGRVJfKShcXGQrKSg/OlxccyopKS9nbSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGFyZ3VtZW50c1szXSB8fCBhcmd1bWVudHNbNF07XG4gICAgICAgICAgICAgICAgICAgIGJ1ZmZlcnNbJ3VfYnVmZmVyJyArIGldID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQ6ICcjZGVmaW5lIEJVRkZFUl8nICsgaSArICdcXG4nICsgZnJhZ1N0cmluZ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcnM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBsb2FkIGJ1ZmZlcnMgcHJvZ3JhbXNcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbG9hZFByb2dyYW1zJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRQcm9ncmFtcyhidWZmZXJzKSB7XG4gICAgICAgICAgICB2YXIgZ2xzbCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZ2wgPSB0aGlzLmdsO1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgdmFyIHZlcnRleCA9IGNyZWF0ZVNoYWRlcihnbHNsLCBnbHNsLnZlcnRleFN0cmluZywgZ2wuVkVSVEVYX1NIQURFUik7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYnVmZmVycykge1xuICAgICAgICAgICAgICAgIHZhciBidWZmZXIgPSBidWZmZXJzW2tleV07XG4gICAgICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gY3JlYXRlU2hhZGVyKGdsc2wsIGJ1ZmZlci5mcmFnbWVudCwgZ2wuRlJBR01FTlRfU0hBREVSLCAxKTtcbiAgICAgICAgICAgICAgICBpZiAoIWZyYWdtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50ID0gY3JlYXRlU2hhZGVyKGdsc2wsICd2b2lkIG1haW4oKXtcXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KDEuMCk7XFxufScsIGdsLkZSQUdNRU5UX1NIQURFUik7XG4gICAgICAgICAgICAgICAgICAgIGdsc2wuaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdsc2wuaXNWYWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBwcm9ncmFtID0gY3JlYXRlUHJvZ3JhbShnbHNsLCBbdmVydGV4LCBmcmFnbWVudF0pO1xuICAgICAgICAgICAgICAgIGJ1ZmZlci5uYW1lID0gJ3VfYnVmZmVyJyArIGk7XG4gICAgICAgICAgICAgICAgYnVmZmVyLnByb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICAgICAgICAgIGJ1ZmZlci5idW5kbGUgPSBnbHNsLmNyZWF0ZVN3YXBwYWJsZUJ1ZmZlcihnbHNsLmNhbnZhcy53aWR0aCwgZ2xzbC5jYW52YXMuaGVpZ2h0LCBwcm9ncmFtKTtcbiAgICAgICAgICAgICAgICBnbC5kZWxldGVTaGFkZXIoZnJhZ21lbnQpO1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdsLmRlbGV0ZVNoYWRlcih2ZXJ0ZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3JlYXRlIGFuIGlucHV0IC8gb3V0cHV0IHN3YXBwYWJsZSBidWZmZXJcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3JlYXRlU3dhcHBhYmxlQnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVN3YXBwYWJsZUJ1ZmZlcihXLCBILCBwcm9ncmFtKSB7XG4gICAgICAgICAgICB2YXIgaW5wdXQgPSB0aGlzLmNyZWF0ZUJ1ZmZlcihXLCBILCBwcm9ncmFtKTtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0aGlzLmNyZWF0ZUJ1ZmZlcihXLCBILCBwcm9ncmFtKTtcbiAgICAgICAgICAgIHZhciBnbCA9IHRoaXMuZ2w7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlucHV0OiBpbnB1dCxcbiAgICAgICAgICAgICAgICBvdXRwdXQ6IG91dHB1dCxcbiAgICAgICAgICAgICAgICBzd2FwOiBmdW5jdGlvbiBzd2FwKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGlucHV0O1xuICAgICAgICAgICAgICAgICAgICBpbnB1dCA9IG91dHB1dDtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dCA9IGlucHV0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm91dHB1dCA9IG91dHB1dDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKFcsIEgsIHByb2dyYW0sIG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTtcbiAgICAgICAgICAgICAgICAgICAgZ2wudmlld3BvcnQoMCwgMCwgVywgSCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgdGhpcy5pbnB1dC5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICBnbC5mcmFtZWJ1ZmZlclRleHR1cmUyRChnbC5GUkFNRUJVRkZFUiwgZ2wuQ09MT1JfQVRUQUNITUVOVDAsIGdsLlRFWFRVUkVfMkQsIHRoaXMub3V0cHV0LnRleHR1cmUsIDApO1xuICAgICAgICAgICAgICAgICAgICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgNik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3dhcCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiByZXNpemUoVywgSCwgcHJvZ3JhbSwgbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBnbC51c2VQcm9ncmFtKHByb2dyYW0pO1xuICAgICAgICAgICAgICAgICAgICBnbC52aWV3cG9ydCgwLCAwLCBXLCBIKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dC5yZXNpemUoVywgSCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0LnJlc2l6ZShXLCBIKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3JlYXRlIGEgYnVmZmVyc1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjcmVhdGVCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnVmZmVyKFcsIEgsIHByb2dyYW0pIHtcbiAgICAgICAgICAgIHZhciBnbCA9IHRoaXMuZ2w7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLkJVRkZFUl9DT1VOVDtcbiAgICAgICAgICAgIHRoaXMuQlVGRkVSX0NPVU5UICs9IDI7XG4gICAgICAgICAgICBnbC5nZXRFeHRlbnNpb24oJ09FU190ZXh0dXJlX2Zsb2F0Jyk7XG4gICAgICAgICAgICB2YXIgdGV4dHVyZSA9IGdsLmNyZWF0ZVRleHR1cmUoKTtcbiAgICAgICAgICAgIGdsLmFjdGl2ZVRleHR1cmUoZ2wuVEVYVFVSRTAgKyBpbmRleCk7XG4gICAgICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCB0ZXh0dXJlKTtcbiAgICAgICAgICAgIGdsLnRleEltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgZ2wuUkdCQSwgVywgSCwgMCwgZ2wuUkdCQSwgZ2wuRkxPQVQsIG51bGwpO1xuICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01JTl9GSUxURVIsIGdsLk5FQVJFU1QpO1xuICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLk5FQVJFU1QpO1xuICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfUywgZ2wuQ0xBTVBfVE9fRURHRSk7XG4gICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9ULCBnbC5DTEFNUF9UT19FREdFKTtcbiAgICAgICAgICAgIHZhciBidWZmZXIgPSBnbC5jcmVhdGVGcmFtZWJ1ZmZlcigpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgICAgdGV4dHVyZTogdGV4dHVyZSxcbiAgICAgICAgICAgICAgICBidWZmZXI6IGJ1ZmZlcixcbiAgICAgICAgICAgICAgICBXOiBXLFxuICAgICAgICAgICAgICAgIEg6IEgsXG4gICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiByZXNpemUoVywgSCkge1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIGJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaW5XID0gTWF0aC5taW4oVywgdGhpcy5XKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbkggPSBNYXRoLm1pbihILCB0aGlzLkgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGl4ZWxzID0gbmV3IEZsb2F0MzJBcnJheShtaW5XICogbWluSCAqIDQpO1xuICAgICAgICAgICAgICAgICAgICBnbC5yZWFkUGl4ZWxzKDAsIDAsIG1pblcsIG1pbkgsIGdsLlJHQkEsIGdsLkZMT0FULCBwaXhlbHMpO1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SW5kZXggPSBpbmRleCArIDE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdUZXh0dXJlID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xuICAgICAgICAgICAgICAgICAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwICsgbmV3SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBuZXdUZXh0dXJlKTtcbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4SW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCBnbC5SR0JBLCBXLCBILCAwLCBnbC5SR0JBLCBnbC5GTE9BVCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5ORUFSRVNUKTtcbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLk5FQVJFU1QpO1xuICAgICAgICAgICAgICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9TLCBnbC5DTEFNUF9UT19FREdFKTtcbiAgICAgICAgICAgICAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX1dSQVBfVCwgZ2wuQ0xBTVBfVE9fRURHRSk7XG4gICAgICAgICAgICAgICAgICAgIGdsLnRleFN1YkltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgMCwgMCwgbWluVywgbWluSCwgZ2wuUkdCQSwgZ2wuRkxPQVQsIHBpeGVscyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdCdWZmZXIgPSBnbC5jcmVhdGVGcmFtZWJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICBnbC5kZWxldGVUZXh0dXJlKHRleHR1cmUpO1xuICAgICAgICAgICAgICAgICAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwICsgaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBuZXdUZXh0dXJlKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIHRleHR1cmUgPSB0aGlzLnRleHR1cmUgPSBuZXdUZXh0dXJlO1xuICAgICAgICAgICAgICAgICAgICBidWZmZXIgPSB0aGlzLmJ1ZmZlciA9IG5ld0J1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5XID0gVztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5IID0gSDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVzaXplIGJ1ZmZlcnMgb24gY2FudmFzIHJlc2l6ZVxuICAgICAgICAvLyBjb25zaWRlciBhcHBseWluZyBhIHRocm90dGxlIG9mIDUwIG1zIG9uIGNhbnZhcyByZXNpemVcbiAgICAgICAgLy8gdG8gYXZvaWQgcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGFuZCBHbCB2aW9sYXRpb25zXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Jlc2l6ZVN3YXBwYWJsZUJ1ZmZlcnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzaXplU3dhcHBhYmxlQnVmZmVycygpIHtcbiAgICAgICAgICAgIHZhciBnbCA9IHRoaXMuZ2w7XG4gICAgICAgICAgICB2YXIgVyA9IGdsLmNhbnZhcy53aWR0aCxcbiAgICAgICAgICAgICAgICBIID0gZ2wuY2FudmFzLmhlaWdodDtcbiAgICAgICAgICAgIGdsLnZpZXdwb3J0KDAsIDAsIFcsIEgpO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuYnVmZmVycykge1xuICAgICAgICAgICAgICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1ZmZlcnNba2V5XTtcbiAgICAgICAgICAgICAgICBidWZmZXIuYnVuZGxlLnJlc2l6ZShXLCBILCBidWZmZXIucHJvZ3JhbSwgYnVmZmVyLm5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2wudXNlUHJvZ3JhbSh0aGlzLnByb2dyYW0pO1xuICAgICAgICB9XG4gICAgfV0pO1xuICAgIHJldHVybiBHbHNsQ2FudmFzO1xufSgpO1xuXG5mdW5jdGlvbiBsb2FkQWxsR2xzbENhbnZhcygpIHtcbiAgICB2YXIgbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dsc2xDYW52YXMnKTtcbiAgICBpZiAobGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHdpbmRvdy5nbHNsQ2FudmFzZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2FuZGJveCA9IG5ldyBHbHNsQ2FudmFzKGxpc3RbaV0pO1xuICAgICAgICAgICAgaWYgKHNhbmRib3guaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nbHNsQ2FudmFzZXMucHVzaChzYW5kYm94KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgbG9hZEFsbEdsc2xDYW52YXMoKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdsc2xDYW52YXM7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBmblRvU3RyID0gRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nO1xuXG52YXIgY29uc3RydWN0b3JSZWdleCA9IC9eXFxzKmNsYXNzIC87XG52YXIgaXNFUzZDbGFzc0ZuID0gZnVuY3Rpb24gaXNFUzZDbGFzc0ZuKHZhbHVlKSB7XG5cdHRyeSB7XG5cdFx0dmFyIGZuU3RyID0gZm5Ub1N0ci5jYWxsKHZhbHVlKTtcblx0XHR2YXIgc2luZ2xlU3RyaXBwZWQgPSBmblN0ci5yZXBsYWNlKC9cXC9cXC8uKlxcbi9nLCAnJyk7XG5cdFx0dmFyIG11bHRpU3RyaXBwZWQgPSBzaW5nbGVTdHJpcHBlZC5yZXBsYWNlKC9cXC9cXCpbLlxcc1xcU10qXFwqXFwvL2csICcnKTtcblx0XHR2YXIgc3BhY2VTdHJpcHBlZCA9IG11bHRpU3RyaXBwZWQucmVwbGFjZSgvXFxuL21nLCAnICcpLnJlcGxhY2UoLyB7Mn0vZywgJyAnKTtcblx0XHRyZXR1cm4gY29uc3RydWN0b3JSZWdleC50ZXN0KHNwYWNlU3RyaXBwZWQpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlOyAvLyBub3QgYSBmdW5jdGlvblxuXHR9XG59O1xuXG52YXIgdHJ5RnVuY3Rpb25PYmplY3QgPSBmdW5jdGlvbiB0cnlGdW5jdGlvbk9iamVjdCh2YWx1ZSkge1xuXHR0cnkge1xuXHRcdGlmIChpc0VTNkNsYXNzRm4odmFsdWUpKSB7IHJldHVybiBmYWxzZTsgfVxuXHRcdGZuVG9TdHIuY2FsbCh2YWx1ZSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIGZuQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nO1xudmFyIGdlbkNsYXNzID0gJ1tvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dJztcbnZhciBoYXNUb1N0cmluZ1RhZyA9IHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJvbC50b1N0cmluZ1RhZyA9PT0gJ3N5bWJvbCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNDYWxsYWJsZSh2YWx1ZSkge1xuXHRpZiAoIXZhbHVlKSB7IHJldHVybiBmYWxzZTsgfVxuXHRpZiAodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ29iamVjdCcpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGlmIChoYXNUb1N0cmluZ1RhZykgeyByZXR1cm4gdHJ5RnVuY3Rpb25PYmplY3QodmFsdWUpOyB9XG5cdGlmIChpc0VTNkNsYXNzRm4odmFsdWUpKSB7IHJldHVybiBmYWxzZTsgfVxuXHR2YXIgc3RyQ2xhc3MgPSB0b1N0ci5jYWxsKHZhbHVlKTtcblx0cmV0dXJuIHN0ckNsYXNzID09PSBmbkNsYXNzIHx8IHN0ckNsYXNzID09PSBnZW5DbGFzcztcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGlzRnVuY3Rpb25cblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZ1xuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uIChmbikge1xuICB2YXIgc3RyaW5nID0gdG9TdHJpbmcuY2FsbChmbilcbiAgcmV0dXJuIHN0cmluZyA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJyB8fFxuICAgICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgJiYgc3RyaW5nICE9PSAnW29iamVjdCBSZWdFeHBdJykgfHxcbiAgICAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgLy8gSUU4IGFuZCBiZWxvd1xuICAgICAoZm4gPT09IHdpbmRvdy5zZXRUaW1lb3V0IHx8XG4gICAgICBmbiA9PT0gd2luZG93LmFsZXJ0IHx8XG4gICAgICBmbiA9PT0gd2luZG93LmNvbmZpcm0gfHxcbiAgICAgIGZuID09PSB3aW5kb3cucHJvbXB0KSlcbn07XG4iLCJ2YXIgdHJpbSA9IHJlcXVpcmUoJ3RyaW0nKVxuICAsIGZvckVhY2ggPSByZXF1aXJlKCdmb3ItZWFjaCcpXG4gICwgaXNBcnJheSA9IGZ1bmN0aW9uKGFyZykge1xuICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmcpID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIH1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaGVhZGVycykge1xuICBpZiAoIWhlYWRlcnMpXG4gICAgcmV0dXJuIHt9XG5cbiAgdmFyIHJlc3VsdCA9IHt9XG5cbiAgZm9yRWFjaChcbiAgICAgIHRyaW0oaGVhZGVycykuc3BsaXQoJ1xcbicpXG4gICAgLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICAgIHZhciBpbmRleCA9IHJvdy5pbmRleE9mKCc6JylcbiAgICAgICAgICAsIGtleSA9IHRyaW0ocm93LnNsaWNlKDAsIGluZGV4KSkudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICwgdmFsdWUgPSB0cmltKHJvdy5zbGljZShpbmRleCArIDEpKVxuXG4gICAgICAgIGlmICh0eXBlb2YocmVzdWx0W2tleV0pID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWVcbiAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHJlc3VsdFtrZXldKSkge1xuICAgICAgICAgIHJlc3VsdFtrZXldLnB1c2godmFsdWUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0gPSBbIHJlc3VsdFtrZXldLCB2YWx1ZSBdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgKVxuXG4gIHJldHVybiByZXN1bHRcbn0iLCJcbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHRyaW07XG5cbmZ1bmN0aW9uIHRyaW0oc3RyKXtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKnxcXHMqJC9nLCAnJyk7XG59XG5cbmV4cG9ydHMubGVmdCA9IGZ1bmN0aW9uKHN0cil7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyovLCAnJyk7XG59O1xuXG5leHBvcnRzLnJpZ2h0ID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXHMqJC8sICcnKTtcbn07XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciB3aW5kb3cgPSByZXF1aXJlKFwiZ2xvYmFsL3dpbmRvd1wiKVxudmFyIGlzRnVuY3Rpb24gPSByZXF1aXJlKFwiaXMtZnVuY3Rpb25cIilcbnZhciBwYXJzZUhlYWRlcnMgPSByZXF1aXJlKFwicGFyc2UtaGVhZGVyc1wiKVxudmFyIHh0ZW5kID0gcmVxdWlyZShcInh0ZW5kXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlWEhSXG4vLyBBbGxvdyB1c2Ugb2YgZGVmYXVsdCBpbXBvcnQgc3ludGF4IGluIFR5cGVTY3JpcHRcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBjcmVhdGVYSFI7XG5jcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QgPSB3aW5kb3cuWE1MSHR0cFJlcXVlc3QgfHwgbm9vcFxuY3JlYXRlWEhSLlhEb21haW5SZXF1ZXN0ID0gXCJ3aXRoQ3JlZGVudGlhbHNcIiBpbiAobmV3IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCgpKSA/IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCA6IHdpbmRvdy5YRG9tYWluUmVxdWVzdFxuXG5mb3JFYWNoQXJyYXkoW1wiZ2V0XCIsIFwicHV0XCIsIFwicG9zdFwiLCBcInBhdGNoXCIsIFwiaGVhZFwiLCBcImRlbGV0ZVwiXSwgZnVuY3Rpb24obWV0aG9kKSB7XG4gICAgY3JlYXRlWEhSW21ldGhvZCA9PT0gXCJkZWxldGVcIiA/IFwiZGVsXCIgOiBtZXRob2RdID0gZnVuY3Rpb24odXJpLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgICBvcHRpb25zID0gaW5pdFBhcmFtcyh1cmksIG9wdGlvbnMsIGNhbGxiYWNrKVxuICAgICAgICBvcHRpb25zLm1ldGhvZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIHJldHVybiBfY3JlYXRlWEhSKG9wdGlvbnMpXG4gICAgfVxufSlcblxuZnVuY3Rpb24gZm9yRWFjaEFycmF5KGFycmF5LCBpdGVyYXRvcikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaXRlcmF0b3IoYXJyYXlbaV0pXG4gICAgfVxufVxuXG5mdW5jdGlvbiBpc0VtcHR5KG9iail7XG4gICAgZm9yKHZhciBpIGluIG9iail7XG4gICAgICAgIGlmKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG59XG5cbmZ1bmN0aW9uIGluaXRQYXJhbXModXJpLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciBwYXJhbXMgPSB1cmlcblxuICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMpKSB7XG4gICAgICAgIGNhbGxiYWNrID0gb3B0aW9uc1xuICAgICAgICBpZiAodHlwZW9mIHVyaSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcGFyYW1zID0ge3VyaTp1cml9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXJhbXMgPSB4dGVuZChvcHRpb25zLCB7dXJpOiB1cml9KVxuICAgIH1cblxuICAgIHBhcmFtcy5jYWxsYmFjayA9IGNhbGxiYWNrXG4gICAgcmV0dXJuIHBhcmFtc1xufVxuXG5mdW5jdGlvbiBjcmVhdGVYSFIodXJpLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIG9wdGlvbnMgPSBpbml0UGFyYW1zKHVyaSwgb3B0aW9ucywgY2FsbGJhY2spXG4gICAgcmV0dXJuIF9jcmVhdGVYSFIob3B0aW9ucylcbn1cblxuZnVuY3Rpb24gX2NyZWF0ZVhIUihvcHRpb25zKSB7XG4gICAgaWYodHlwZW9mIG9wdGlvbnMuY2FsbGJhY2sgPT09IFwidW5kZWZpbmVkXCIpe1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYWxsYmFjayBhcmd1bWVudCBtaXNzaW5nXCIpXG4gICAgfVxuXG4gICAgdmFyIGNhbGxlZCA9IGZhbHNlXG4gICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gY2JPbmNlKGVyciwgcmVzcG9uc2UsIGJvZHkpe1xuICAgICAgICBpZighY2FsbGVkKXtcbiAgICAgICAgICAgIGNhbGxlZCA9IHRydWVcbiAgICAgICAgICAgIG9wdGlvbnMuY2FsbGJhY2soZXJyLCByZXNwb25zZSwgYm9keSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWR5c3RhdGVjaGFuZ2UoKSB7XG4gICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgc2V0VGltZW91dChsb2FkRnVuYywgMClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEJvZHkoKSB7XG4gICAgICAgIC8vIENocm9tZSB3aXRoIHJlcXVlc3RUeXBlPWJsb2IgdGhyb3dzIGVycm9ycyBhcnJvdW5kIHdoZW4gZXZlbiB0ZXN0aW5nIGFjY2VzcyB0byByZXNwb25zZVRleHRcbiAgICAgICAgdmFyIGJvZHkgPSB1bmRlZmluZWRcblxuICAgICAgICBpZiAoeGhyLnJlc3BvbnNlKSB7XG4gICAgICAgICAgICBib2R5ID0geGhyLnJlc3BvbnNlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBib2R5ID0geGhyLnJlc3BvbnNlVGV4dCB8fCBnZXRYbWwoeGhyKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzSnNvbikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5wYXJzZShib2R5KVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBib2R5XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3JGdW5jKGV2dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKVxuICAgICAgICBpZighKGV2dCBpbnN0YW5jZW9mIEVycm9yKSl7XG4gICAgICAgICAgICBldnQgPSBuZXcgRXJyb3IoXCJcIiArIChldnQgfHwgXCJVbmtub3duIFhNTEh0dHBSZXF1ZXN0IEVycm9yXCIpIClcbiAgICAgICAgfVxuICAgICAgICBldnQuc3RhdHVzQ29kZSA9IDBcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGV2dCwgZmFpbHVyZVJlc3BvbnNlKVxuICAgIH1cblxuICAgIC8vIHdpbGwgbG9hZCB0aGUgZGF0YSAmIHByb2Nlc3MgdGhlIHJlc3BvbnNlIGluIGEgc3BlY2lhbCByZXNwb25zZSBvYmplY3RcbiAgICBmdW5jdGlvbiBsb2FkRnVuYygpIHtcbiAgICAgICAgaWYgKGFib3J0ZWQpIHJldHVyblxuICAgICAgICB2YXIgc3RhdHVzXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpXG4gICAgICAgIGlmKG9wdGlvbnMudXNlWERSICYmIHhoci5zdGF0dXM9PT11bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vSUU4IENPUlMgR0VUIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgZG9lc24ndCBoYXZlIGEgc3RhdHVzIGZpZWxkLCBidXQgYm9keSBpcyBmaW5lXG4gICAgICAgICAgICBzdGF0dXMgPSAyMDBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzID8gMjA0IDogeGhyLnN0YXR1cylcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzcG9uc2UgPSBmYWlsdXJlUmVzcG9uc2VcbiAgICAgICAgdmFyIGVyciA9IG51bGxcblxuICAgICAgICBpZiAoc3RhdHVzICE9PSAwKXtcbiAgICAgICAgICAgIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIGJvZHk6IGdldEJvZHkoKSxcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXMsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgICAgICAgICAgdXJsOiB1cmksXG4gICAgICAgICAgICAgICAgcmF3UmVxdWVzdDogeGhyXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKXsgLy9yZW1lbWJlciB4aHIgY2FuIGluIGZhY3QgYmUgWERSIGZvciBDT1JTIGluIElFXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuaGVhZGVycyA9IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnIgPSBuZXcgRXJyb3IoXCJJbnRlcm5hbCBYTUxIdHRwUmVxdWVzdCBFcnJvclwiKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIsIHJlc3BvbnNlLCByZXNwb25zZS5ib2R5KVxuICAgIH1cblxuICAgIHZhciB4aHIgPSBvcHRpb25zLnhociB8fCBudWxsXG5cbiAgICBpZiAoIXhocikge1xuICAgICAgICBpZiAob3B0aW9ucy5jb3JzIHx8IG9wdGlvbnMudXNlWERSKSB7XG4gICAgICAgICAgICB4aHIgPSBuZXcgY3JlYXRlWEhSLlhEb21haW5SZXF1ZXN0KClcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB4aHIgPSBuZXcgY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0KClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBrZXlcbiAgICB2YXIgYWJvcnRlZFxuICAgIHZhciB1cmkgPSB4aHIudXJsID0gb3B0aW9ucy51cmkgfHwgb3B0aW9ucy51cmxcbiAgICB2YXIgbWV0aG9kID0geGhyLm1ldGhvZCA9IG9wdGlvbnMubWV0aG9kIHx8IFwiR0VUXCJcbiAgICB2YXIgYm9keSA9IG9wdGlvbnMuYm9keSB8fCBvcHRpb25zLmRhdGFcbiAgICB2YXIgaGVhZGVycyA9IHhoci5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9XG4gICAgdmFyIHN5bmMgPSAhIW9wdGlvbnMuc3luY1xuICAgIHZhciBpc0pzb24gPSBmYWxzZVxuICAgIHZhciB0aW1lb3V0VGltZXJcbiAgICB2YXIgZmFpbHVyZVJlc3BvbnNlID0ge1xuICAgICAgICBib2R5OiB1bmRlZmluZWQsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgICBzdGF0dXNDb2RlOiAwLFxuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgdXJsOiB1cmksXG4gICAgICAgIHJhd1JlcXVlc3Q6IHhoclxuICAgIH1cblxuICAgIGlmIChcImpzb25cIiBpbiBvcHRpb25zICYmIG9wdGlvbnMuanNvbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgaXNKc29uID0gdHJ1ZVxuICAgICAgICBoZWFkZXJzW1wiYWNjZXB0XCJdIHx8IGhlYWRlcnNbXCJBY2NlcHRcIl0gfHwgKGhlYWRlcnNbXCJBY2NlcHRcIl0gPSBcImFwcGxpY2F0aW9uL2pzb25cIikgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXJcbiAgICAgICAgaWYgKG1ldGhvZCAhPT0gXCJHRVRcIiAmJiBtZXRob2QgIT09IFwiSEVBRFwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiY29udGVudC10eXBlXCJdIHx8IGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gfHwgKGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gPSBcImFwcGxpY2F0aW9uL2pzb25cIikgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXJcbiAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLmpzb24gPT09IHRydWUgPyBib2R5IDogb3B0aW9ucy5qc29uKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHJlYWR5c3RhdGVjaGFuZ2VcbiAgICB4aHIub25sb2FkID0gbG9hZEZ1bmNcbiAgICB4aHIub25lcnJvciA9IGVycm9yRnVuY1xuICAgIC8vIElFOSBtdXN0IGhhdmUgb25wcm9ncmVzcyBiZSBzZXQgdG8gYSB1bmlxdWUgZnVuY3Rpb24uXG4gICAgeGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIElFIG11c3QgZGllXG4gICAgfVxuICAgIHhoci5vbmFib3J0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYWJvcnRlZCA9IHRydWU7XG4gICAgfVxuICAgIHhoci5vbnRpbWVvdXQgPSBlcnJvckZ1bmNcbiAgICB4aHIub3BlbihtZXRob2QsIHVyaSwgIXN5bmMsIG9wdGlvbnMudXNlcm5hbWUsIG9wdGlvbnMucGFzc3dvcmQpXG4gICAgLy9oYXMgdG8gYmUgYWZ0ZXIgb3BlblxuICAgIGlmKCFzeW5jKSB7XG4gICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSAhIW9wdGlvbnMud2l0aENyZWRlbnRpYWxzXG4gICAgfVxuICAgIC8vIENhbm5vdCBzZXQgdGltZW91dCB3aXRoIHN5bmMgcmVxdWVzdFxuICAgIC8vIG5vdCBzZXR0aW5nIHRpbWVvdXQgb24gdGhlIHhociBvYmplY3QsIGJlY2F1c2Ugb2Ygb2xkIHdlYmtpdHMgZXRjLiBub3QgaGFuZGxpbmcgdGhhdCBjb3JyZWN0bHlcbiAgICAvLyBib3RoIG5wbSdzIHJlcXVlc3QgYW5kIGpxdWVyeSAxLnggdXNlIHRoaXMga2luZCBvZiB0aW1lb3V0LCBzbyB0aGlzIGlzIGJlaW5nIGNvbnNpc3RlbnRcbiAgICBpZiAoIXN5bmMgJiYgb3B0aW9ucy50aW1lb3V0ID4gMCApIHtcbiAgICAgICAgdGltZW91dFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYgKGFib3J0ZWQpIHJldHVyblxuICAgICAgICAgICAgYWJvcnRlZCA9IHRydWUvL0lFOSBtYXkgc3RpbGwgY2FsbCByZWFkeXN0YXRlY2hhbmdlXG4gICAgICAgICAgICB4aHIuYWJvcnQoXCJ0aW1lb3V0XCIpXG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBFcnJvcihcIlhNTEh0dHBSZXF1ZXN0IHRpbWVvdXRcIilcbiAgICAgICAgICAgIGUuY29kZSA9IFwiRVRJTUVET1VUXCJcbiAgICAgICAgICAgIGVycm9yRnVuYyhlKVxuICAgICAgICB9LCBvcHRpb25zLnRpbWVvdXQgKVxuICAgIH1cblxuICAgIGlmICh4aHIuc2V0UmVxdWVzdEhlYWRlcikge1xuICAgICAgICBmb3Ioa2V5IGluIGhlYWRlcnMpe1xuICAgICAgICAgICAgaWYoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5oZWFkZXJzICYmICFpc0VtcHR5KG9wdGlvbnMuaGVhZGVycykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSGVhZGVycyBjYW5ub3QgYmUgc2V0IG9uIGFuIFhEb21haW5SZXF1ZXN0IG9iamVjdFwiKVxuICAgIH1cblxuICAgIGlmIChcInJlc3BvbnNlVHlwZVwiIGluIG9wdGlvbnMpIHtcbiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IG9wdGlvbnMucmVzcG9uc2VUeXBlXG4gICAgfVxuXG4gICAgaWYgKFwiYmVmb3JlU2VuZFwiIGluIG9wdGlvbnMgJiZcbiAgICAgICAgdHlwZW9mIG9wdGlvbnMuYmVmb3JlU2VuZCA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIG9wdGlvbnMuYmVmb3JlU2VuZCh4aHIpXG4gICAgfVxuXG4gICAgLy8gTWljcm9zb2Z0IEVkZ2UgYnJvd3NlciBzZW5kcyBcInVuZGVmaW5lZFwiIHdoZW4gc2VuZCBpcyBjYWxsZWQgd2l0aCB1bmRlZmluZWQgdmFsdWUuXG4gICAgLy8gWE1MSHR0cFJlcXVlc3Qgc3BlYyBzYXlzIHRvIHBhc3MgbnVsbCBhcyBib2R5IHRvIGluZGljYXRlIG5vIGJvZHlcbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL25hdWd0dXIveGhyL2lzc3Vlcy8xMDAuXG4gICAgeGhyLnNlbmQoYm9keSB8fCBudWxsKVxuXG4gICAgcmV0dXJuIHhoclxuXG5cbn1cblxuZnVuY3Rpb24gZ2V0WG1sKHhocikge1xuICAgIC8vIHhoci5yZXNwb25zZVhNTCB3aWxsIHRocm93IEV4Y2VwdGlvbiBcIkludmFsaWRTdGF0ZUVycm9yXCIgb3IgXCJET01FeGNlcHRpb25cIlxuICAgIC8vIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3QvcmVzcG9uc2VYTUwuXG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHhoci5yZXNwb25zZVR5cGUgPT09IFwiZG9jdW1lbnRcIikge1xuICAgICAgICAgICAgcmV0dXJuIHhoci5yZXNwb25zZVhNTFxuICAgICAgICB9XG4gICAgICAgIHZhciBmaXJlZm94QnVnVGFrZW5FZmZlY3QgPSB4aHIucmVzcG9uc2VYTUwgJiYgeGhyLnJlc3BvbnNlWE1MLmRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gXCJwYXJzZXJlcnJvclwiXG4gICAgICAgIGlmICh4aHIucmVzcG9uc2VUeXBlID09PSBcIlwiICYmICFmaXJlZm94QnVnVGFrZW5FZmZlY3QpIHtcbiAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VYTUxcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHt9XG5cbiAgICByZXR1cm4gbnVsbFxufVxuXG5mdW5jdGlvbiBub29wKCkge31cbiIsIm1vZHVsZS5leHBvcnRzID0gZXh0ZW5kXG5cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbmZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgICB2YXIgdGFyZ2V0ID0ge31cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV1cblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0XG59XG4iLCJpbXBvcnQgJ2RvY3VtZW50LXJlZ2lzdGVyLWVsZW1lbnQnO1xuaW1wb3J0IFNoYWRlciBmcm9tICcuL2NvcmUvU2hhZGVyJztcbmltcG9ydCB7IGluaXRFZGl0b3IsIGZvY3VzQWxsIH0gZnJvbSAnLi9jb3JlL0VkaXRvcic7XG5cbmltcG9ydCBNZW51IGZyb20gJy4vdWkvTWVudSc7XG5pbXBvcnQgSGVscGVycyBmcm9tICcuL3VpL0hlbHBlcnMnO1xuaW1wb3J0IEVycm9yc0Rpc3BsYXkgZnJvbSAnLi91aS9FcnJvcnNEaXNwbGF5JztcbmltcG9ydCBWaXN1YWxEZWJ1Z2dlciBmcm9tICcuL3VpL1Zpc3VhbERlYnVnZ2VyJztcbmltcG9ydCBFeHBvcnRJY29uIGZyb20gJy4vdWkvRXhwb3J0SWNvbic7XG5cbmltcG9ydCBGaWxlRHJvcCBmcm9tICcuL2lvL0ZpbGVEcm9wJztcbmltcG9ydCBIYXNoV2F0Y2ggZnJvbSAnLi9pby9IYXNoV2F0Y2gnO1xuaW1wb3J0IEJ1ZmZlck1hbmFnZXIgZnJvbSAnLi9pby9CdWZmZXJNYW5hZ2VyJztcbmltcG9ydCBMb2NhbFN0b3JhZ2UgZnJvbSAnLi9pby9Mb2NhbFN0b3JhZ2UnO1xuY29uc3QgU1RPUkFHRV9MQVNUX0VESVRPUl9DT05URU5UID0gJ2xhc3QtY29udGVudCc7XG5cbi8vIEltcG9ydCBVdGlsc1xuaW1wb3J0IHhociBmcm9tICd4aHInO1xuaW1wb3J0IHsgc3Vic2NyaWJlTWl4aW4gfSBmcm9tICcuL3Rvb2xzL21peGluJztcblxuLy8gM2VyIFBhcnRpZXNcbmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJy4vdmVuZG9yL0ZpbGVTYXZlci5taW4uanMnO1xuXG4vLyBDcm9zcyBzdG9yYWdlIGZvciBPcGVuZnJhbWUgLS0gYWxsb3dzIHJlc3RyaWN0ZWQgYWNjZXNzIHRvIGNlcnRhaW4gbG9jYWxTdG9yYWdlIG9wZXJhdGlvbnNcbi8vIG9uIHRoZSBvcGVuZnJhbWUgZG9tYWluXG5pbXBvcnQgeyBDcm9zc1N0b3JhZ2VDbGllbnQgfSBmcm9tICdjcm9zcy1zdG9yYWdlJztcblxuY29uc3QgRU1QVFlfRlJBR19TSEFERVIgPSBgLy8gQXV0aG9yOlxuLy8gVGl0bGU6XG5cbiNpZmRlZiBHTF9FU1xucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XG4jZW5kaWZcblxudW5pZm9ybSB2ZWMyIHVfcmVzb2x1dGlvbjtcbnVuaWZvcm0gdmVjMiB1X21vdXNlO1xudW5pZm9ybSBmbG9hdCB1X3RpbWU7XG5cbnZvaWQgbWFpbigpIHtcbiAgICB2ZWMyIHN0ID0gZ2xfRnJhZ0Nvb3JkLnh5L3VfcmVzb2x1dGlvbi54eTtcbiAgICBzdC54ICo9IHVfcmVzb2x1dGlvbi54L3VfcmVzb2x1dGlvbi55O1xuXG4gICAgdmVjMyBjb2xvciA9IHZlYzMoMC4pO1xuICAgIGNvbG9yID0gdmVjMyhzdC54LHN0LnksYWJzKHNpbih1X3RpbWUpKSk7XG5cbiAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KGNvbG9yLDEuMCk7XG59YDtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2xzbEVkaXRvciB7XG4gICAgY29uc3RydWN0b3IgKHNlbGVjdG9yLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlRm9udExpbmsoKTtcbiAgICAgICAgc3Vic2NyaWJlTWl4aW4odGhpcyk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ29iamVjdCcgJiYgc2VsZWN0b3Iubm9kZVR5cGUgJiYgc2VsZWN0b3Iubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gc2VsZWN0b3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGVsZW1lbnQgJHtzZWxlY3Rvcn0gbm90IHByZXNlbnRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciwgdHlwZSAnICsgdHlwZW9mIHNlbGVjdG9yICsgJyBvZiAnICsgc2VsZWN0b3IgKyAnIGlzIHVua25vd24nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHt9O1xuICAgICAgICB0aGlzLmNoYW5nZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmF1dG91cGRhdGUgPSB0cnVlO1xuXG4gICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pbWdzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuaW1ncyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNwbGF5X21lbnUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLmRpc3BsYXlfbWVudSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5jb250YWluZXIuaGFzQXR0cmlidXRlKCdkYXRhLXRleHR1cmVzJykpIHtcbiAgICAgICAgICAgIGxldCBpbWdMaXN0ID0gdGhpcy5jb250YWluZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXRleHR1cmVzJykuc3BsaXQoJywnKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gaW1nTGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pbWdzLnB1c2goaW1nTGlzdFtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IFRoZW1lXG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLnRoZW1lKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudGhlbWUgPSAnZGVmYXVsdCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IENvbnRleHRcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZnJhZykge1xuICAgICAgICAgICAgdmFyIGlubmVySFRNTCA9IHRoaXMuY29udGFpbmVyLmlubmVySFRNTC5yZXBsYWNlKC8mbHQ7YnImZ3Q7L2csJycpO1xuICAgICAgICAgICAgaW5uZXJIVE1MID0gaW5uZXJIVE1MLnJlcGxhY2UoLzxicj4vZywnJyk7XG4gICAgICAgICAgICBpbm5lckhUTUwgPSBpbm5lckhUTUwucmVwbGFjZSgvJm5ic3A7L2csJycpO1xuICAgICAgICAgICAgaW5uZXJIVE1MID0gaW5uZXJIVE1MLnJlcGxhY2UoLyZsdDsvZywnPCcpO1xuICAgICAgICAgICAgaW5uZXJIVE1MID0gaW5uZXJIVE1MLnJlcGxhY2UoLyZndDsvZywnPicpO1xuICAgICAgICAgICAgaW5uZXJIVE1MID0gaW5uZXJIVE1MLnJlcGxhY2UoLyZhbXA7L2csJyYnKTtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mcmFnID0gaW5uZXJIVE1MIHx8IEVNUFRZX0ZSQUdfU0hBREVSO1xuXG4gICAgICAgICAgICBpZiAoaW5uZXJIVE1MKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZhdWx0IGludmlzaWJsZSBGcmFnbWVudCBoZWFkZXJcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZnJhZ19oZWFkZXIpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5mcmFnX2hlYWRlciA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmYXVsdCBpbnZpc2libGUgRnJhZ21lbnQgZm9vdGVyXG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmZyYWdfZm9vdGVyKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuZnJhZ19mb290ZXIgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExpc3RlbiB0byBoYXNoIGNoYW5nZXNcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy53YXRjaEhhc2gpIHtcbiAgICAgICAgICAgIG5ldyBIYXNoV2F0Y2godGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMb2FkIFVJXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubWVudSkge1xuICAgICAgICAgICAgdGhpcy5tZW51ID0gbmV3IE1lbnUodGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdXBwb3J0IGZvciBtdWx0aXBsZSBidWZmZXJzXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGVCdWZmZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlck1hbmFnZXIgPSBuZXcgQnVmZmVyTWFuYWdlcih0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExpc3RlbiB0byBmaWxlIGRyb3BzXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZmlsZURyb3BzKSB7XG4gICAgICAgICAgICBuZXcgRmlsZURyb3AodGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDT1JFIGVsZW1lbnRzXG4gICAgICAgIHRoaXMuc2hhZGVyID0gbmV3IFNoYWRlcih0aGlzKTtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBpbml0RWRpdG9yKHRoaXMpO1xuXG4gICAgICAgIHRoaXMuaGVscGVycyA9IG5ldyBIZWxwZXJzKHRoaXMpO1xuICAgICAgICB0aGlzLmVycm9yc0Rpc3BsYXkgPSBuZXcgRXJyb3JzRGlzcGxheSh0aGlzKTtcbiAgICAgICAgdGhpcy52aXN1YWxEZWJ1Z2dlciA9IG5ldyBWaXN1YWxEZWJ1Z2dlcih0aGlzKTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cG9ydEljb24pIHtcbiAgICAgICAgICAgIHRoaXMuZXhwb3J0ID0gbmV3IEV4cG9ydEljb24odGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFVkVOVFNcbiAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmF1dG91cGRhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNhbnZhc19mb2xsb3cpIHtcbiAgICAgICAgICAgIHRoaXMuc2hhZGVyLmVsLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FudmFzX2Zsb2F0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkZXIuZWwuc3R5bGUuZmxvYXQgPSB0aGlzLm9wdGlvbnMuY2FudmFzX2Zsb2F0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2N1cnNvckFjdGl2aXR5JywgKGNtKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGhlaWdodCA9IGNtLmhlaWdodEF0TGluZShjbS5nZXRDdXJzb3IoKS5saW5lICsgMSwgJ2xvY2FsJykgLSB0aGlzLnNoYWRlci5lbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgaWYgKGhlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gMC4wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRlci5lbC5zdHlsZS50b3AgPSBoZWlnaHQudG9TdHJpbmcoKSArICdweCc7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZSB1c2VyIGJhaWxzIGZvciB3aGF0ZXZlciByZWFzb24sIGhhc3RpbHkgc2hvdmUgdGhlIGNvbnRlbnRzIG9mXG4gICAgICAgIC8vIHRoZSBlZGl0b3IgaW50byBzb21lIGtpbmQgb2Ygc3RvcmFnZS4gVGhpcyBvdmVyd3JpdGVzIHdoYXRldmVyIHdhc1xuICAgICAgICAvLyB0aGVyZSBiZWZvcmUuIE5vdGUgdGhhdCB0aGVyZSBpcyBub3QgcmVhbGx5IGEgd2F5IG9mIGhhbmRsaW5nIHVubG9hZFxuICAgICAgICAvLyB3aXRoIG91ciBvd24gVUkgYW5kIGxvZ2ljLCBzaW5jZSB0aGlzIGFsbG93cyBmb3Igd2lkZXNwcmVhZCBhYnVzZVxuICAgICAgICAvLyBvZiBub3JtYWwgYnJvd3NlciBmdW5jdGlvbmFsaXR5LlxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBsZXQgY29udGVudCA9IHt9O1xuICAgICAgICAgICAgaWYgKHRoaXMuYnVmZmVyTWFuYWdlciAmJiBPYmplY3Qua2V5cyh0aGlzLmJ1ZmZlck1hbmFnZXIuYnVmZmVycykubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuYnVmZmVyTWFuYWdlci5idWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRba2V5XSA9IHRoaXMuYnVmZmVyTWFuYWdlci5idWZmZXJzW2tleV0uZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250ZW50WyhuZXcgRGF0ZSgpLmdldFRpbWUoKSkudG9TdHJpbmcoKV0gPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLm1lbnUpIHtcbiAgICAgICAgICAgICAgICBMb2NhbFN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0xBU1RfRURJVE9SX0NPTlRFTlQsIEpTT04uc3RyaW5naWZ5KGNvbnRlbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5tZW51KSB7XG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBwcmV2aXVzIGNvbnRlbnQgbG9hZCBpdC5cbiAgICAgICAgICAgIGxldCBvbGRDb250ZW50ID0gSlNPTi5wYXJzZShMb2NhbFN0b3JhZ2UuZ2V0SXRlbShTVE9SQUdFX0xBU1RfRURJVE9SX0NPTlRFTlQpKTtcbiAgICAgICAgICAgIGlmIChvbGRDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9sZENvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuKG9sZENvbnRlbnRba2V5XSwga2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5ldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uZXcoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMubWVudSB8fCB0aGlzLm9wdGlvbnMuZXhwb3J0SWNvbikge1xuICAgICAgICAgICAgLy8gc2V0dXAgQ3Jvc3NTdG9yYWdlIGNsaWVudFxuICAgICAgICAgICAgdGhpcy5zdG9yYWdlID0gbmV3IENyb3NzU3RvcmFnZUNsaWVudCgnaHR0cHM6Ly9vcGVuZnJhbWUuaW8vaHViLmh0bWwnKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5vbkNvbm5lY3QoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIE9wZW5GcmFtZSBbb10nKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gfSkuYmluZCh0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIG5ldyAoKSB7XG4gICAgICAgIHRoaXMuc2V0Q29udGVudCh0aGlzLm9wdGlvbnMuZnJhZyB8fCBFTVBUWV9GUkFHX1NIQURFUiwgKG5ldyBEYXRlKCkuZ2V0VGltZSgpKS50b1N0cmluZygpKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCduZXdfY29udGVudCcsIHt9KTtcbiAgICAgICAgdGhpcy5vcHRpb25zLmZyYWcgPSBudWxsO1xuICAgIH1cblxuICAgIHNldENvbnRlbnQoc2hhZGVyLCB0YWJOYW1lKSB7XG4gICAgICAgIC8vIElmIHRoZSBzdHJpbmcgaXMgQ09ERVxuICAgICAgICBpZiAodGhpcy5zaGFkZXIgJiYgdGhpcy5zaGFkZXIuY2FudmFzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kZWJ1Z2dpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlYnVnZ2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvY3VzQWxsKHRoaXMuZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2hhZGVyLmNhbnZhcy5sb2FkKHRoaXMub3B0aW9ucy5mcmFnX2hlYWRlciArIHNoYWRlciArIHRoaXMub3B0aW9ucy5mcmFnX2Zvb3Rlcik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5lZGl0b3IpIHtcbiAgICAgICAgICAgIGlmICh0YWJOYW1lICE9PSB1bmRlZmluZWQgJiYgdGhpcy5idWZmZXJNYW5hZ2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1ZmZlck1hbmFnZXIub3Blbih0YWJOYW1lLCBzaGFkZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyTWFuYWdlci5zZWxlY3QodGFiTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5zZXRWYWx1ZShzaGFkZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldFNpemUobnVsbCwgdGhpcy5lZGl0b3IuZ2V0RG9jKCkuaGVpZ2h0ICsgJ3B4Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2V0U2l6ZShudWxsLCAnYXV0bycpO1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZW5hbWUgPSB0YWJOYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hhbmdlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBvcGVuIChzaGFkZXIsIHRhYk5hbWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzaGFkZXIgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgbGV0IGdlID0gdGhpcztcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGdlLnNldENvbnRlbnQoZS50YXJnZXQucmVzdWx0LCBzaGFkZXIubmFtZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoc2hhZGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2Ygc2hhZGVyID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaWYgKC9cXC5mcmFnJC8udGVzdChzaGFkZXIpIHx8IC9cXC5mcyQvLnRlc3Qoc2hhZGVyKSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBzdHJpbmcgaXMgYW4gVVJMXG4gICAgICAgICAgICAgICAgeGhyLmdldChzaGFkZXIsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgZG93bmxvYWRpbmcgJywgc2hhZGVyLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb250ZW50KGJvZHksIHRhYk5hbWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDb250ZW50KHNoYWRlciwgdGFiTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRDb250ZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB9XG5cbiAgICBnZXRBdXRob3IoKSB7XG4gICAgICAgIGxldCBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50KCk7XG4gICAgICAgIGxldCByZXN1bHQgPSBjb250ZW50Lm1hdGNoKC9cXC9cXC9cXHMqW0F8YV11dGhvclxccypbXFw6XT9cXHMqKFtcXHd8XFxzfFxcQHxcXCh8XFwpfFxcLXxcXF9dKikvaSk7XG4gICAgICAgIGlmIChyZXN1bHQgJiYgIShyZXN1bHRbMV0gPT09ICcgJyB8fCByZXN1bHRbMV0gPT09ICcnKSkge1xuICAgICAgICAgICAgbGV0IGF1dGhvciA9IHJlc3VsdFsxXS5yZXBsYWNlKC8oXFxyXFxufFxcbnxcXHIpL2dtLCAnJyk7XG4gICAgICAgICAgICByZXR1cm4gYXV0aG9yO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFRpdGxlKCkge1xuICAgICAgICBsZXQgY29udGVudCA9IHRoaXMuZ2V0Q29udGVudCgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gY29udGVudC5tYXRjaCgvXFwvXFwvXFxzKltUfHRdaXRsZVxccyo6XFxzKihbXFx3fFxcc3xcXEB8XFwofFxcKXxcXC18XFxfXSopL2kpO1xuICAgICAgICBpZiAocmVzdWx0ICYmICEocmVzdWx0WzFdID09PSAnICcgfHwgcmVzdWx0WzFdID09PSAnJykpIHtcbiAgICAgICAgICAgIGxldCB0aXRsZSA9IHJlc3VsdFsxXS5yZXBsYWNlKC8oXFxyXFxufFxcbnxcXHIpL2dtLCAnJyk7XG4gICAgICAgICAgICByZXR1cm4gdGl0bGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5idWZmZXJNYW5hZ2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlck1hbmFnZXIuY3VycmVudDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAndW5rbm93bic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm5zIFByb21pc2VcbiAgICBnZXRPZlRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldCgnYWNjZXNzVG9rZW4nKTtcbiAgICB9XG5cbiAgICBkb3dubG9hZCAoKSB7XG4gICAgICAgIGxldCBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50KCk7XG4gICAgICAgIGxldCBuYW1lID0gdGhpcy5nZXRUaXRsZSgpO1xuICAgICAgICBpZiAobmFtZSAhPT0gJycpIHtcbiAgICAgICAgICAgIG5hbWUgKz0gJy0nO1xuICAgICAgICB9XG4gICAgICAgIG5hbWUgKz0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cbiAgICAgICAgLy8gRG93bmxvYWQgY29kZVxuICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTtcbiAgICAgICAgc2F2ZUFzKGJsb2IsIG5hbWUgKyAnLmZyYWcnKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuZG9jLm1hcmtDbGVhbigpO1xuICAgICAgICB0aGlzLmNoYW5nZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHVwZGF0ZSAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlYnVnZ2luZykge1xuICAgICAgICAgICAgdGhpcy5kZWJ1Z2dpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvY3VzQWxsKHRoaXMuZWRpdG9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnZpc3VhbERlYnVnZ2VyLnRlc3RpbmdSZXN1bHRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy52aXN1YWxEZWJ1Z2dlci5jbGVhbigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2hhZGVyLmNhbnZhcy5sb2FkKHRoaXMub3B0aW9ucy5mcmFnX2hlYWRlciArIHRoaXMuZWRpdG9yLmdldFZhbHVlKCkgKyB0aGlzLm9wdGlvbnMuZnJhZ19mb290ZXIpO1xuICAgIH1cblxuICAgIGNyZWF0ZUZvbnRMaW5rKCkge1xuICAgICAgICB2YXIgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpO1xuICAgICAgICBsaW5rLmhyZWYgPSAnaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9pY29uP2ZhbWlseT1NYXRlcmlhbCtJY29ucyc7XG4gICAgICAgIGxpbmsudHlwZSA9ICd0ZXh0L2Nzcyc7XG4gICAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnO1xuICAgICAgICBsaW5rLm1lZGlhID0gJ3NjcmVlbixwcmludCc7XG4gICAgICAgIGhlYWQuYXBwZW5kQ2hpbGQobGluayk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQobGluayk7XG4gICAgfVxuXG4gICAgdG9nZ2xlUHJlc2VudGF0aW9uV2luZG93KGZsYWcpIHtcbiAgICAgICAgdGhpcy5wV2luZG93T3BlbiA9IGZsYWc7XG4gICAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRlci5vcGVuV2luZG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRlci5jbG9zZVdpbmRvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DbG9zZVByZXNlbnRhdGlvbldpbmRvdygpIHtcbiAgICAgICAgdGhpcy5wV2luZG93T3BlbiA9IGZhbHNlO1xuICAgIH1cbn1cblxud2luZG93Lkdsc2xFZGl0b3IgPSBHbHNsRWRpdG9yO1xuXG52YXIgR2xzbFdlYkNvbXBvbmVudCA9IGZ1bmN0aW9uKCkge307XG5HbHNsV2ViQ29tcG9uZW50LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSFRNTEVsZW1lbnQucHJvdG90eXBlKTtcbkdsc2xXZWJDb21wb25lbnQucHJvdG90eXBlLmNyZWF0ZWRDYWxsYmFjayA9IGZ1bmN0aW9uIGNyZWF0ZWRDYWxsYmFjaygpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgY2FudmFzX3NpemU6IDE1MCxcbiAgICAgICAgY2FudmFzX2ZvbGxvdzogdHJ1ZSxcbiAgICAgICAgdG9vbHRpcHM6IHRydWVcbiAgICB9O1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHRoaXMuYXR0cmlidXRlc1tpXTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZS5zcGVjaWZpZWQpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZS52YWx1ZTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAndHJ1ZScpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA9PT0gJ2ZhbHNlJykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJzZUludCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3B0aW9uc1thdHRyaWJ1dGUubmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2xzbEVkaXRvciA9IG5ldyBHbHNsRWRpdG9yKHRoaXMsIG9wdGlvbnMpO1xufTtcblxuZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KCdnbHNsLWVkaXRvcicsIEdsc2xXZWJDb21wb25lbnQpO1xuIiwiLy8gSW1wb3J0IENvZGVNaXJyb3JcbmltcG9ydCBDb2RlTWlycm9yIGZyb20gJ2NvZGVtaXJyb3InO1xuXG4vLyBJbXBvcnQgQ29kZU1pcnJvciBhZGRvbnMgYW5kIG1vZHVsZXNcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9zZWFyY2gvc2VhcmNoJztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9zZWFyY2gvc2VhcmNoY3Vyc29yJztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9jb21tZW50L2NvbW1lbnQnO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2RpYWxvZy9kaWFsb2cnO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2VkaXQvbWF0Y2hicmFja2V0cyc7XG5pbXBvcnQgJ2NvZGVtaXJyb3IvYWRkb24vZWRpdC9jbG9zZWJyYWNrZXRzJztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi93cmFwL2hhcmR3cmFwJztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9mb2xkL2ZvbGRjb2RlJztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9mb2xkL2ZvbGRndXR0ZXInO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2ZvbGQvaW5kZW50LWZvbGQnO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2hpbnQvc2hvdy1oaW50JztcbmltcG9ydCAnY29kZW1pcnJvci9hZGRvbi9oaW50L2phdmFzY3JpcHQtaGludCc7XG5pbXBvcnQgJ2NvZGVtaXJyb3IvYWRkb24vZGlzcGxheS9ydWxlcnMnO1xuaW1wb3J0ICdjb2RlbWlycm9yL2FkZG9uL2Rpc3BsYXkvcGFuZWwnO1xuaW1wb3J0ICdjb2RlbWlycm9yL21vZGUvY2xpa2UvY2xpa2UuanMnO1xuXG4vLyBLZXltYXBcbmltcG9ydCAnY29kZW1pcnJvci9rZXltYXAvc3VibGltZSc7XG5cbmNvbnN0IFVORk9DVVNfQ0xBU1MgPSAnZ2VfZWRpdG9yLXVuZm9jdXMnO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdEVkaXRvciAobWFpbikge1xuICAgIGlmIChtYWluLm9wdGlvbnMubGluZU51bWJlcnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBtYWluLm9wdGlvbnMubGluZU51bWJlcnMgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIENSRUFURSBBTkQgU1RBUlQgQ09ERU1JUlJPUlxuICAgIGxldCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZ2VfZWRpdG9yJyk7XG5cbiAgICAvLyBJZiB0aGVyZSBpcyBhIG1lbnUgb2Zmc2V0IHRoZSBlZGl0b3IgdG8gY29tZSBhZnRlciBpdFxuICAgIGlmIChtYWluLm1lbnUpIHtcbiAgICAgICAgZWwuc3R5bGUucGFkZGluZ1RvcCA9IChtYWluLm1lbnUuZWwuY2xpZW50SGVpZ2h0IHx8IG1haW4ubWVudS5lbC5vZmZzZXRIZWlnaHQgfHwgbWFpbi5tZW51LmVsLnNjcm9sbEhlaWdodCkgKyAncHgnO1xuICAgIH1cblxuICAgIG1haW4uY29udGFpbmVyLmFwcGVuZENoaWxkKGVsKTtcblxuICAgIGxldCBjbSA9IENvZGVNaXJyb3IoZWwsIHtcbiAgICAgICAgdmFsdWU6IG1haW4ub3B0aW9ucy5mcmFnLFxuICAgICAgICB2aWV3cG9ydE1hcmdpbjogSW5maW5pdHksXG4gICAgICAgIGxpbmVOdW1iZXJzOiBtYWluLm9wdGlvbnMubGluZU51bWJlcnMsXG4gICAgICAgIG1hdGNoQnJhY2tldHM6IHRydWUsXG4gICAgICAgIG1vZGU6ICd4LXNoYWRlci94LWZyYWdtZW50JyxcbiAgICAgICAga2V5TWFwOiAnc3VibGltZScsXG4gICAgICAgIGF1dG9DbG9zZUJyYWNrZXRzOiB0cnVlLFxuICAgICAgICBleHRyYUtleXM6IHsgJ0N0cmwtU3BhY2UnOiAnYXV0b2NvbXBsZXRlJyB9LFxuICAgICAgICBzaG93Q3Vyc29yV2hlblNlbGVjdGluZzogdHJ1ZSxcbiAgICAgICAgdGhlbWU6IG1haW4ub3B0aW9ucy50aGVtZSxcbiAgICAgICAgZHJhZ0Ryb3A6IGZhbHNlLFxuICAgICAgICBpbmRlbnRVbml0OiA0LFxuICAgICAgICBndXR0ZXJzOiBtYWluLm9wdGlvbnMubGluZU51bWJlcnMgPyBbJ0NvZGVNaXJyb3ItbGluZW51bWJlcnMnLCAnYnJlYWtwb2ludHMnXSA6IGZhbHNlLFxuICAgICAgICBsaW5lV3JhcHBpbmc6IHRydWUsXG4gICAgICAgIGF1dG9mb2N1czogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBjbTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuZm9jdXNMaW5lKGNtLCBsaW5lKSB7XG4gICAgaWYgKGxpbmUgPT09IG51bGwpIHtyZXR1cm47fVxuICAgIGNtLmdldERvYygpLmFkZExpbmVDbGFzcyhsaW5lLCAnZ3V0dGVyJywgVU5GT0NVU19DTEFTUyk7XG4gICAgY20uZ2V0RG9jKCkuYWRkTGluZUNsYXNzKGxpbmUsICd0ZXh0JywgVU5GT0NVU19DTEFTUyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmZvY3VzQWxsKGNtKSB7XG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSBjbS5nZXREb2MoKS5saW5lQ291bnQoKTsgaSA8PSBqOyBpKyspIHtcbiAgICAgICAgdW5mb2N1c0xpbmUoY20sIGkpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvY3VzTGluZShjbSwgbGluZSkge1xuICAgIGlmIChsaW5lID09PSBudWxsKSB7cmV0dXJuO31cbiAgICBjbS5nZXREb2MoKS5yZW1vdmVMaW5lQ2xhc3MobGluZSwgJ2d1dHRlcicsIFVORk9DVVNfQ0xBU1MpO1xuICAgIGNtLmdldERvYygpLnJlbW92ZUxpbmVDbGFzcyhsaW5lLCAndGV4dCcsIFVORk9DVVNfQ0xBU1MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9jdXNBbGwoY20pIHtcbiAgICBmb3IgKGxldCBpID0gMCwgaiA9IGNtLmdldERvYygpLmxpbmVDb3VudCgpOyBpIDw9IGo7IGkrKykge1xuICAgICAgICBmb2N1c0xpbmUoY20sIGkpO1xuICAgIH1cbn1cbiIsImltcG9ydCBHbHNsQ2FudmFzIGZyb20gJ2dsc2xDYW52YXMnO1xuaW1wb3J0IHsgc3Vic2NyaWJlSW50ZXJhY3RpdmVEb20gfSBmcm9tICcuLi90b29scy9pbnRlcmFjdGl2ZURvbSc7XG5pbXBvcnQgTWVkaWFDYXB0dXJlIGZyb20gJy4uL3Rvb2xzL21lZGlhQ2FwdHVyZSc7XG5pbXBvcnQgTWVudUl0ZW0gZnJvbSAnLi4vdWkvTWVudUl0ZW0nO1xuLy8gM2VyIFBhcnRpZXNcbmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJy4uL3ZlbmRvci9GaWxlU2F2ZXIubWluLmpzJztcblxudmFyIENPTlRST0xTX0NMQVNTTkFNRSA9ICdnZV9jb250cm9sJztcbnZhciBDT05UUk9MU19QQU5FTF9DTEFTU05BTUUgPSAnZ2VfY29udHJvbF9wYW5lbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNoYWRlciB7XG4gICAgY29uc3RydWN0b3IgKG1haW4pIHtcbiAgICAgICAgdGhpcy5tYWluID0gbWFpbjtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gbWFpbi5vcHRpb25zO1xuICAgICAgICB0aGlzLmZyYWcgPSAnJztcblxuICAgICAgICAvLyBET00gQ09OVEFJTkVSXG4gICAgICAgIHRoaXMuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2dlX2NhbnZhc19jb250YWluZXInKTtcbiAgICAgICAgLy8gQ1JFQVRFIEFORCBTVEFSVCBHTFNMQ0FOVkFTXG4gICAgICAgIHRoaXMuZWxDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgdGhpcy5lbENhbnZhcy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2dlX2NhbnZhcycpO1xuICAgICAgICB0aGlzLmVsQ2FudmFzLnNldEF0dHJpYnV0ZSgnZGF0YS1mcmFnbWVudCcsIHRoaXMub3B0aW9ucy5mcmFnX2hlYWRlciArIHRoaXMub3B0aW9ucy5mcmFnICsgdGhpcy5vcHRpb25zLmZyYWdfZm9vdGVyKTtcbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmVsQ2FudmFzKTtcbiAgICAgICAgbGV0IGdsc2xjYW52YXMgPSBuZXcgR2xzbENhbnZhcyh0aGlzLmVsQ2FudmFzLCB7IHByZW11bHRpcGxpZWRBbHBoYTogZmFsc2UsIHByZXNlcnZlRHJhd2luZ0J1ZmZlcjogdHJ1ZSwgYmFja2dyb3VuZENvbG9yOiAncmdiYSgxLDEsMSwxKScgfSk7XG5cbiAgICAgICAgbGV0IHdpZHRoID0gKHRoaXMub3B0aW9ucy5jYW52YXNfd2lkdGggfHwgdGhpcy5vcHRpb25zLmNhbnZhc19zaXplIHx8ICcyNTAnKTtcbiAgICAgICAgbGV0IGhlaWdodCA9ICAodGhpcy5vcHRpb25zLmNhbnZhc19oZWlnaHQgfHwgdGhpcy5vcHRpb25zLmNhbnZhc19zaXplIHx8ICcyNTAnKTtcbiAgICAgICAgZ2xzbGNhbnZhcy5jYW52YXMuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICAgIGdsc2xjYW52YXMuY2FudmFzLnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG4gICAgICAgIGdsc2xjYW52YXMucmVzaXplKCk7XG5cbiAgICAgICAgdGhpcy5jYW52YXMgPSBnbHNsY2FudmFzO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW1ncyAmJiB0aGlzLm9wdGlvbnMuaW1ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMub3B0aW9ucy5pbWdzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuc2V0VW5pZm9ybSgndV90ZXgnICsgaSwgdGhpcy5vcHRpb25zLmltZ3NbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWVkaWEgQ2FwdHVyZVxuICAgICAgICB0aGlzLm1lZGlhQ2FwdHVyZSA9IG5ldyBNZWRpYUNhcHR1cmUoKTtcbiAgICAgICAgdGhpcy5tZWRpYUNhcHR1cmUuc2V0Q2FudmFzKHRoaXMuZWxDYW52YXMpO1xuICAgICAgICB0aGlzLmNhbnZhcy5vbigncmVuZGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5tZWRpYUNhcHR1cmUuY29tcGxldGVTY3JlZW5zaG90KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChtYWluLm9wdGlvbnMuZGlzcGxheU1lbnUpIHtcbiAgICAgICAgICAgIC8vIENPTlRST0xTXG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xzQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbHNDb250YWluZXIuY2xhc3NOYW1lID0gQ09OVFJPTFNfQ0xBU1NOQU1FO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sUGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sUGFuZWwuY2xhc3NOYW1lID0gQ09OVFJPTFNfUEFORUxfQ0xBU1NOQU1FO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmNvbnRyb2xQYW5lbCk7XG4gICAgICAgICAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuY29udHJvbHNDb250YWluZXIpO1xuICAgICAgICAgICAgdGhpcy5jb250cm9scyA9IHt9O1xuICAgICAgICAgICAgLy8gcGxheS9zdG9wXG4gICAgICAgICAgICAvLyB0aGlzLmNvbnRyb2xzLnBsYXlQYXVzZSA9IG5ldyBNZW51SXRlbSh0aGlzLmNvbnRyb2xQYW5lbCwgJ2dlX2NvbnRyb2xfZWxlbWVudCcsICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+cGF1c2U8L2k+JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xzLnBsYXlQYXVzZSA9IG5ldyBNZW51SXRlbSh0aGlzLmNvbnRyb2xQYW5lbCwgJ2dlX2NvbnRyb2xfZWxlbWVudCcsICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+cGF1c2U8L2k+JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2xzbGNhbnZhcy5wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2xzbGNhbnZhcy5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuY29udHJvbHMucGxheVBhdXNlLm5hbWUgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPnBhdXNlPC9pPic7Ly8nUGF1c2UnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xzLnBsYXlQYXVzZS5uYW1lID0gJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5wYXVzZTwvaT4nOy8vJ1BhdXNlJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdsc2xjYW52YXMucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250cm9scy5wbGF5UGF1c2UubmFtZSA9ICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+cGxheV9hcnJvdzwvaT4nOy8vJ1BsYXknO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gcmVjXG4gICAgICAgICAgICB0aGlzLmlzQ2FwdHVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBsZXQgcmVjID0gbmV3IE1lbnVJdGVtKHRoaXMuY29udHJvbFBhbmVsLCAnZ2VfY29udHJvbF9lbGVtZW50JywgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5maWJlcl9tYW51YWxfcmVjb3JkPC9pPicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgbGV0IHJlYyA9IG5ldyBNZW51SXRlbSh0aGlzLmNvbnRyb2xQYW5lbCwgJ2dlX2NvbnRyb2xfZWxlbWVudCcsICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+JiN4RTA2MTs8L2k+JywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NhcHR1cmluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BWaWRlb0NhcHR1cmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRWaWRlb0NhcHR1cmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbHMucmVjID0gcmVjO1xuICAgICAgICAgICAgdGhpcy5jb250cm9scy5yZWMuYnV0dG9uLnN0eWxlLmNvbG9yID0gJ3JlZCc7XG5cbiAgICAgICAgICAgIC8vIHByZXNlbnQgbW9kZSAob25seSBpZiB0aGVyZSBpcyBhIHByZXNlbnRhdGlvbi5odG1sIGZpbGUgdG8gcG9pbnQgdG8pXG4gICAgICAgICAgICAvLyB0aGlzLmNvbnRyb2xzLnByZXNlbnRhdGlvbk1vZGUgPSBuZXcgTWVudUl0ZW0odGhpcy5jb250cm9sUGFuZWwsICdnZV9jb250cm9sX2VsZW1lbnQnLCAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPm9wZW5faW5fbmV3PC9pPicsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jb250cm9scy5wcmVzZW50YXRpb25Nb2RlID0gbmV3IE1lbnVJdGVtKHRoaXMuY29udHJvbFBhbmVsLCAnZ2VfY29udHJvbF9lbGVtZW50JywgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5vcGVuX2luX25ldzwvaT4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmIChtYWluLnBXaW5kb3dPcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW4udG9nZ2xlUHJlc2VudGF0aW9uV2luZG93KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW4udG9nZ2xlUHJlc2VudGF0aW9uV2luZG93KHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmVsQ29udHJvbCA9IHRoaXMuZWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShDT05UUk9MU19DTEFTU05BTUUpWzBdO1xuICAgICAgICAgICAgdGhpcy5lbENvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIChldmVudCkgPT4geyB0aGlzLnNob3dDb250cm9scygpOyB9KTtcbiAgICAgICAgICAgIHRoaXMuZWxDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoZXZlbnQpID0+IHsgdGhpcy5oaWRlQ29udHJvbHMoKTsgfSk7XG4gICAgICAgICAgICB0aGlzLmVsQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5vZmZzZXRZID4gdGhpcy5lbENhbnZhcy5jbGllbnRIZWlnaHQgKiAuNjYpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93Q29udHJvbHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZUNvbnRyb2xzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmhpZGVDb250cm9scygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gPT09PT09PT09PSBFVkVOVFNcbiAgICAgICAgLy8gRHJhZ2dhYmxlL3Jlc2l6YWJsZS9zbmFwcGFibGVcbiAgICAgICAgaWYgKG1haW4ub3B0aW9ucy5jYW52YXNfZHJhZ2dhYmxlIHx8IG1haW4ub3B0aW9ucy5jYW52YXNfcmVzaXphYmxlIHx8IG1haW4ub3B0aW9ucy5jYW52YXNfc25hcGFibGUpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZUludGVyYWN0aXZlRG9tKHRoaXMuZWwsIHtcbiAgICAgICAgICAgICAgICBtb3ZlOiBtYWluLm9wdGlvbnMuY2FudmFzX2RyYWdnYWJsZSxcbiAgICAgICAgICAgICAgICByZXNpemU6IG1haW4ub3B0aW9ucy5jYW52YXNfcmVzaXphYmxlLFxuICAgICAgICAgICAgICAgIHNuYXA6IG1haW4ub3B0aW9ucy5jYW52YXNfc25hcGFibGVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAobWFpbi5vcHRpb25zLmNhbnZhc19zaXplID09PSAnaGFsZnNjcmVlbicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsLnNuYXBSaWdodCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmVsLm9uKCdtb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQuZWwuc3R5bGUud2lkdGggPSBldmVudC5lbC5jbGllbnRXaWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgZXZlbnQuZWwuc3R5bGUuaGVpZ2h0ID0gZXZlbnQuZWwuY2xpZW50SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5lbC5vbigncmVzaXplJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZ2xzbGNhbnZhcy5jYW52YXMuc3R5bGUud2lkdGggPSBldmVudC5lbC5jbGllbnRXaWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgZ2xzbGNhbnZhcy5jYW52YXMuc3R5bGUuaGVpZ2h0ID0gZXZlbnQuZWwuY2xpZW50SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICBnbHNsY2FudmFzLnJlc2l6ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIG1lbnUgb2Zmc2V0IHRoZSBlZGl0b3IgdG8gY29tZSBhZnRlciBpdFxuICAgICAgICBpZiAobWFpbi5tZW51KSB7XG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IChtYWluLm1lbnUuZWwuY2xpZW50SGVpZ2h0IHx8IG1haW4ubWVudS5lbC5vZmZzZXRIZWlnaHQgfHwgbWFpbi5tZW51LmVsLnNjcm9sbEhlaWdodCkgKyAncHgnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGFsbCB0aGlzIHRvIHRoZSBtYWluIGNvbnRhaW5lclxuICAgICAgICBtYWluLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcbiAgICAgICAgZ2xzbGNhbnZhcy5yZXNpemUoKTtcbiAgICB9XG5cbiAgICBoaWRlQ29udHJvbHMgKCkge1xuICAgICAgICBpZiAodGhpcy5lbENvbnRyb2wgJiYgdGhpcy5lbENvbnRyb2wuY2xhc3NOYW1lID09PSBDT05UUk9MU19DTEFTU05BTUUpIHtcbiAgICAgICAgICAgIHRoaXMuZWxDb250cm9sLmNsYXNzTmFtZSA9IENPTlRST0xTX0NMQVNTTkFNRSArICcgJyArIENPTlRST0xTX0NMQVNTTkFNRSArICdfaGlkZGVuJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3dDb250cm9scyAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsQ29udHJvbCAmJiB0aGlzLmVsQ29udHJvbC5jbGFzc05hbWUgPT09IENPTlRST0xTX0NMQVNTTkFNRSArICcgJyArIENPTlRST0xTX0NMQVNTTkFNRSArICdfaGlkZGVuJykge1xuICAgICAgICAgICAgdGhpcy5lbENvbnRyb2wuY2xhc3NOYW1lID0gQ09OVFJPTFNfQ0xBU1NOQU1FO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVxdWVzdFJlZHJhdygpIHtcbiAgICAgICAgdGhpcy5jYW52YXMuZm9yY2VSZW5kZXIgPSB0cnVlO1xuICAgICAgICB0aGlzLmNhbnZhcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICBzY3JlZW5zaG90ICgpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0UmVkcmF3KCk7XG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhQ2FwdHVyZS5zY3JlZW5zaG90KCk7XG4gICAgfVxuXG4gICAgc3RhcnRWaWRlb0NhcHR1cmUgKCkge1xuICAgICAgICB0aGlzLnJlcXVlc3RSZWRyYXcoKTtcbiAgICAgICAgaWYgKHRoaXMubWVkaWFDYXB0dXJlLnN0YXJ0VmlkZW9DYXB0dXJlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNDYXB0dXJpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jb250cm9scy5yZWMuYnV0dG9uLnN0eWxlLmNvbG9yID0gJ3doaXRlJztcbiAgICAgICAgICAgIC8vIHRoaXMuY29udHJvbHMucmVjLm5hbWUgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPnN0b3A8L2k+JztcbiAgICAgICAgICAgIHRoaXMuY29udHJvbHMucmVjLm5hbWUgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPiYjeEUwNjE7PC9pPic7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdG9wVmlkZW9DYXB0dXJlICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNDYXB0dXJpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuaXNDYXB0dXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbHMucmVjLmJ1dHRvbi5zdHlsZS5jb2xvciA9ICdyZWQnO1xuICAgICAgICAgICAgLy8gdGhpcy5jb250cm9scy5yZWMubmFtZSA9ICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+ZmliZXJfbWFudWFsX3JlY29yZDwvaT4nO1xuICAgICAgICAgICAgdGhpcy5jb250cm9scy5yZWMubmFtZSA9ICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+c3RvcDwvaT4nO1xuICAgICAgICAgICAgdGhpcy5tZWRpYUNhcHR1cmUuc3RvcFZpZGVvQ2FwdHVyZSgpLnRoZW4oKHZpZGVvKSA9PiB7XG4gICAgICAgICAgICAgICAgc2F2ZUFzKHZpZGVvLmJsb2IsIGAke051bWJlcihuZXcgRGF0ZSgpKX0ud2VibWApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvcGVuV2luZG93KCkge1xuICAgICAgICB0aGlzLm9yaWdpbmFsU2l6ZSA9IHt3aWR0aDogdGhpcy5jYW52YXMuY2FudmFzLmNsaWVudFdpZHRoLCBoZWlnaHQ6IHRoaXMuY2FudmFzLmNhbnZhcy5jbGllbnRIZWlnaHR9O1xuICAgICAgICB0aGlzLnByZXNlbnRhdGlvbldpbmRvdyA9IHdpbmRvdy5vcGVuKCcnLCAnX2JsYW5rJywgJ3ByZXNlbnRhdGlvbldpbmRvdycpO1xuICAgICAgICB0aGlzLnNldFVwUHJlc2VudGF0aW9uV2luZG93KCk7XG4gICAgfVxuXG4gICAgY2xvc2VXaW5kb3coKSB7XG4gICAgICAgIGlmICh0aGlzLnByZXNlbnRhdGlvbldpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5wcmVzZW50YXRpb25XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldENhbnZhc1NpemUodywgaCkge1xuICAgICAgICB0aGlzLmNhbnZhcy5jYW52YXMuc3R5bGUud2lkdGggPSB3ICsgJ3B4JztcbiAgICAgICAgdGhpcy5jYW52YXMuY2FudmFzLnN0eWxlLmhlaWdodCA9IGggKyAncHgnO1xuICAgIH1cblxuICAgIHNldFVwUHJlc2VudGF0aW9uV2luZG93KCkge1xuICAgICAgICB0aGlzLnByZXNlbnRhdGlvbldpbmRvdy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzLmNhbnZhcyk7XG4gICAgICAgIHZhciBkID0gdGhpcy5wcmVzZW50YXRpb25XaW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgIHZhciBkaXYgPSBkLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoZC5jcmVhdGVUZXh0Tm9kZSgnUHJvamVjdG9yIG1vZGUnKSk7XG4gICAgICAgIHZhciBzcGFuID0gdGhpcy5wcmVzZW50YXRpb25XaW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgIHNwYW4uYXBwZW5kQ2hpbGQoZC5jcmVhdGVUZXh0Tm9kZShcIiAtIElmIHRoZSBjYW52YXMgZG9lc24ndCB1cGRhdGUsIGRyYWcgdGhpcyB3aW5kb3cgYW5kIHJldmVhbCB0aGUgZWRpdG9yXCIpKTtcbiAgICAgICAgZC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XG5cbiAgICAgICAgZC50aXRsZSA9ICdHTFNMIEVkaXRvcic7XG4gICAgICAgIGQuYm9keS5zdHlsZS5wYWRkaW5nID0gJzAnO1xuICAgICAgICBkLmJvZHkuc3R5bGUubWFyZ2luID0gJzAnO1xuICAgICAgICBkLmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9ICcjMTcxZTIyJztcbiAgICAgICAgZC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgICAgICAgZGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgZGl2LnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICdyZ2JhKDAsIDAsIDAsIDAuNSknO1xuICAgICAgICBkaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBkaXYuc3R5bGUudG9wID0gJzAnO1xuICAgICAgICBkaXYuc3R5bGUubGVmdCA9ICcwJztcbiAgICAgICAgZGl2LnN0eWxlLnJpZ2h0ID0gJzAnO1xuICAgICAgICBkaXYuc3R5bGUucGFkZGluZyA9ICcxNnB4JztcbiAgICAgICAgZGl2LnN0eWxlLmNvbG9yID0gJyNmZmZmZmYnO1xuICAgICAgICBkaXYuc3R5bGUuZm9udFNpemUgPSAnMTRweCc7XG4gICAgICAgIGRpdi5zdHlsZS5mb250RmFtaWx5ID0gJ0hlbHZldGljYSwgR2VuZXZhLCBzYW5zLXNlcmlmJztcbiAgICAgICAgZGl2LnN0eWxlLmZvbnRXZWlnaHQgPSAnNDAwJztcbiAgICAgICAgZGl2LnN0eWxlLmxldHRlclNwYWNpbmcgPSAnMC4xZW0nO1xuICAgICAgICBkaXYuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICAgIGRpdi5zdHlsZS5vcGFjaXR5ID0gJzEnO1xuICAgICAgICBkaXYuc3R5bGUuekluZGV4ID0gJzk5OTknO1xuICAgICAgICBkaXYuc3R5bGUuc2V0UHJvcGVydHkoJy13ZWJraXQtdHJhbnNpdGlvbicsICdvcGFjaXR5IDEuNXMnKTtcbiAgICAgICAgZGl2LnN0eWxlLnNldFByb3BlcnR5KCctbW96LXRyYW5zaXRpb24nLCAnb3BhY2l0eSAxLjVzJyk7XG4gICAgICAgIGRpdi5zdHlsZS5zZXRQcm9wZXJ0eSgndHJhbnNpdGlvbicsICdvcGFjaXR5IDEuNXMnKTtcblxuICAgICAgICBzcGFuLnN0eWxlLmNvbG9yID0gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC41KSc7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgZGl2LnN0eWxlLm9wYWNpdHkgPSAwO1xuICAgICAgICB9LCA0MDAwKTtcblxuICAgICAgICB0aGlzLnNldENhbnZhc1NpemUodGhpcy5wcmVzZW50YXRpb25XaW5kb3cuaW5uZXJXaWR0aCwgdGhpcy5wcmVzZW50YXRpb25XaW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgICB0aGlzLnByZXNlbnRhdGlvbldpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLm9uUHJlc2VudGF0aW9uV2luZG93UmVzaXplLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnByZXNlbnRhdGlvbldpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCB0aGlzLm9uUHJlc2VudGF0aW9uV2luZG93Q2xvc2UuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgb25QcmVzZW50YXRpb25XaW5kb3dDbG9zZSgpIHtcbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmNhbnZhcy5jYW52YXMpO1xuICAgICAgICB0aGlzLnNldENhbnZhc1NpemUodGhpcy5vcmlnaW5hbFNpemUud2lkdGgsIHRoaXMub3JpZ2luYWxTaXplLmhlaWdodCk7XG4gICAgICAgIHRoaXMuY2FudmFzLnJlc2l6ZSgpO1xuXG4gICAgICAgIHRoaXMubWFpbi5vbkNsb3NlUHJlc2VudGF0aW9uV2luZG93KCk7XG4gICAgICAgIHRoaXMubWFpbi5tZW51Lm9uQ2xvc2VQcmVzZW50YXRpb25XaW5kb3coKTtcbiAgICAgICAgdGhpcy5wcmVzZW50YXRpb25XaW5kb3cgPSBudWxsO1xuICAgIH1cblxuICAgIG9uUHJlc2VudGF0aW9uV2luZG93UmVzaXplKCkge1xuICAgICAgICBpZiAodGhpcy5wcmVzZW50YXRpb25XaW5kb3cpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q2FudmFzU2l6ZSh0aGlzLnByZXNlbnRhdGlvbldpbmRvdy5pbm5lcldpZHRoLCB0aGlzLnByZXNlbnRhdGlvbldpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5yZXNpemUoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8vIEltcG9ydCBDb2RlTWlycm9yXG5pbXBvcnQgQ29kZU1pcnJvciBmcm9tICdjb2RlbWlycm9yJztcbmltcG9ydCAnY29kZW1pcnJvci9tb2RlL2NsaWtlL2NsaWtlLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQnVmZmVyTWFuYWdlciB7XG4gICAgY29uc3RydWN0b3IgKG1haW4pIHtcbiAgICAgICAgdGhpcy5tYWluID0gbWFpbjtcbiAgICAgICAgdGhpcy5idWZmZXJzID0ge307XG4gICAgICAgIHRoaXMudGFicyA9IHt9O1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSAndW50aXRsZWQnO1xuICAgIH1cblxuICAgIG9wZW4gKG5hbWUsIGNvbnRlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVsKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgRE9NIGVsZW1lbnRcbiAgICAgICAgICAgIHRoaXMuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xuICAgICAgICAgICAgdGhpcy5lbC5jbGFzc05hbWUgPSAnZ2VfcGFuZWwnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubWFpbi5jaGFuZ2UgJiYgdGhpcy5jdXJyZW50ID09PSAndW50aXRsZWQnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnT3BlbiBDdXJyZW50IGluIGEgZGlmZmVyZW50IHRhYicpO1xuICAgICAgICAgICAgdGhpcy5vcGVuKHRoaXMuY3VycmVudCwgdGhpcy5tYWluLmdldENvbnRlbnQoKSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmJ1ZmZlcnNbbmFtZV0gPSBDb2RlTWlycm9yLkRvYyhjb250ZW50LCAneC1zaGFkZXIveC1mcmFnbWVudCcpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyB0YWJcbiAgICAgICAgbGV0IHRhYiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIHRhYi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2dlX3BhbmVsX3RhYicpO1xuICAgICAgICB0YWIudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICBDb2RlTWlycm9yLm9uKHRhYiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3QobmFtZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBjbG9zZSA9IHRhYi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykpO1xuICAgICAgICBjbG9zZS50ZXh0Q29udGVudCA9ICd4JztcbiAgICAgICAgY2xvc2Uuc2V0QXR0cmlidXRlKCdjbGFzcycsICdnZV9wYW5lbF90YWJfY2xvc2UnKTtcbiAgICAgICAgQ29kZU1pcnJvci5vbihjbG9zZSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZShuYW1lKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0YWIpO1xuICAgICAgICB0aGlzLnRhYnNbbmFtZV0gPSB0YWI7XG5cbiAgICAgICAgaWYgKHRoaXMuZWwgJiYgIXRoaXMucGFuZWwgJiYgdGhpcy5nZXRMZW5ndGgoKSA+IDEpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBQYW5lbCBDTSBlbGVtZW50XG4gICAgICAgICAgICB0aGlzLnBhbmVsID0gdGhpcy5tYWluLmVkaXRvci5hZGRQYW5lbCh0aGlzLmVsLCB7IHBvc2l0aW9uOiAndG9wJyB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNlbGVjdCAobmFtZSkge1xuICAgICAgICBsZXQgYnVmID0gdGhpcy5idWZmZXJzW25hbWVdO1xuXG4gICAgICAgIGlmIChidWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGJ1Zi5nZXRFZGl0b3IoKSkge1xuICAgICAgICAgICAgYnVmID0gYnVmLmxpbmtlZERvYyh7IHNoYXJlZEhpc3Q6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG9sZCA9IHRoaXMubWFpbi5lZGl0b3Iuc3dhcERvYyhidWYpO1xuICAgICAgICBsZXQgbGlua2VkID0gb2xkLml0ZXJMaW5rZWREb2NzKGZ1bmN0aW9uKGRvYykge1xuICAgICAgICAgICAgbGlua2VkID0gZG9jO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxpbmtlZCkge1xuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBkb2N1bWVudCBpbiBidWZmZXJzIGlzIHRoZSBvbmUgdGhlIG90aGVyIHZpZXcgaXMgbG9va2luZyBhdFxuICAgICAgICAgICAgZm9yIChsZXQgYnVmZmVyTmFtZSBpbiB0aGlzLmJ1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5idWZmZXJzW2J1ZmZlck5hbWVdID09PSBvbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idWZmZXJzW2J1ZmZlck5hbWVdID0gbGlua2VkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9sZC51bmxpbmtEb2MobGlua2VkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1haW4uZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgIHRoaXMubWFpbi5zZXRDb250ZW50KHRoaXMubWFpbi5nZXRDb250ZW50KCkpO1xuXG4gICAgICAgIGlmICh0aGlzLnRhYnNbdGhpcy5jdXJyZW50XSkge1xuICAgICAgICAgICAgdGhpcy50YWJzW3RoaXMuY3VycmVudF0uc2V0QXR0cmlidXRlKCdjbGFzcycsICdnZV9wYW5lbF90YWInKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRhYnNbbmFtZV0uc2V0QXR0cmlidXRlKCdjbGFzcycsICdnZV9wYW5lbF90YWJfYWN0aXZlJyk7XG4gICAgICAgIHRoaXMuY3VycmVudCA9IG5hbWU7XG5cbiAgICAgICAgdGhpcy5tYWluLmVkaXRvci5zZXRTaXplKG51bGwsICdhdXRvJyk7XG4gICAgICAgIHRoaXMubWFpbi5lZGl0b3IuZ2V0V3JhcHBlckVsZW1lbnQoKS5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG5cbiAgICAgICAgdGhpcy5tYWluLnRyaWdnZXIoJ25ld19jb250ZW50Jywge30pO1xuICAgIH1cblxuICAgIGNsb3NlIChuYW1lKSB7XG4gICAgICAgIGxldCBuZWVkQ2hhbmdlID0gbmFtZSA9PT0gdGhpcy5nZXRDdXJyZW50KCk7XG5cbiAgICAgICAgdGhpcy5lbC5yZW1vdmVDaGlsZCh0aGlzLnRhYnNbbmFtZV0pO1xuICAgICAgICBkZWxldGUgdGhpcy50YWJzW25hbWVdO1xuICAgICAgICBkZWxldGUgdGhpcy5idWZmZXJzW25hbWVdO1xuXG4gICAgICAgIGlmICh0aGlzLmdldExlbmd0aCgpID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLnBhbmVsLmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLnBhbmVsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5lbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZWVkQ2hhbmdlKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBwcm9wIGluIHRoaXMudGFicykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0KHByb3ApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudCAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnQ7XG4gICAgfVxuXG4gICAgZ2V0TGVuZ3RoICgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuYnVmZmVycykubGVuZ3RoO1xuICAgIH1cbn1cbiIsIi8qXG5PcmlnaW5hbDogaHR0cHM6Ly9naXRodWIuY29tL3RhbmdyYW1zL3RhbmdyYW0tcGxheS9ibG9iL2doLXBhZ2VzL3NyYy9qcy9hZGRvbnMvdWkvRmlsZURyb3AuanNcbkF1dGhvcjogTG91IEh1YW5nIChAc2Fpa29maXNoKVxuKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZURyb3Age1xuICAgIGNvbnN0cnVjdG9yIChtYWluKSB7XG4gICAgICAgIC8vIFNldCB1cCBkcmFnL2Ryb3AgZmlsZSBsaXN0ZW5lcnNcbiAgICAgICAgbWFpbi5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayB0byBtYWtlIHN1cmUgdGhhdCBkcm9wcGVkIGl0ZW1zIGFyZSBmaWxlcy5cbiAgICAgICAgICAgIC8vIFRoaXMgcHJldmVudHMgb3RoZXIgZHJhZ3MgKGUuZy4gdGV4dCBpbiBlZGl0b3IpXG4gICAgICAgICAgICAvLyBmcm9tIHR1cm5pbmcgb24gdGhlIGZpbGUgZHJvcCBhcmVhLlxuICAgICAgICAgICAgLy8gU2VlIGhlcmU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNjg0ODA0My9ob3ctZG8taS1kZXRlY3QtYS1maWxlLWlzLWJlaW5nLWRyYWdnZWQtcmF0aGVyLXRoYW4tYS1kcmFnZ2FibGUtZWxlbWVudC1vbi1teS1wYVxuICAgICAgICAgICAgLy8gVGVzdGVkIGluIENocm9tZSwgRmlyZWZveCwgU2FmYXJpIDhcbiAgICAgICAgICAgIHZhciB0eXBlcyA9IGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlcztcbiAgICAgICAgICAgIGlmICh0eXBlcyAhPT0gbnVsbCAmJiAoKHR5cGVzLmluZGV4T2YpID8gKHR5cGVzLmluZGV4T2YoJ0ZpbGVzJykgIT09IC0xKSA6IHR5cGVzLmNvbnRhaW5zKCdhcHBsaWNhdGlvbi94LW1vei1maWxlJykpKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgbWFpbi5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIFJlcXVpcmVkIHRvIHByZXZlbnQgYnJvd3NlciBmcm9tIG5hdmlnYXRpbmcgdG8gYSBmaWxlXG4gICAgICAgICAgICAvLyBpbnN0ZWFkIG9mIHJlY2VpdmluZyBhIGRhdGEgdHJhbnNmZXJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICBtYWluLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIG1haW4uY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gZXZlbnQuZGF0YVRyYW5zZmVyLmZpbGVzWzBdO1xuICAgICAgICAgICAgICAgIG1haW4ub3BlbihmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZmFsc2UpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEhhc2hXYXRjaCB7XG4gICAgY29uc3RydWN0b3IgKG1haW4pIHtcbiAgICAgICAgdGhpcy5tYWluID0gbWFpbjtcbiAgICAgICAgdGhpcy5jaGVjaygpO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jaGVjaygpO1xuICAgICAgICB9LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgY2hlY2soKSB7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaCAhPT0gJycpIHtcbiAgICAgICAgICAgIHRoaXMubWFpbi5vcHRpb25zLmltZ3MgPSBbXTtcblxuICAgICAgICAgICAgbGV0IGhhc2hlcyA9IGxvY2F0aW9uLmhhc2guc3BsaXQoJyYnKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gaGFzaGVzKSB7XG4gICAgICAgICAgICAgICAgbGV0IGV4dCA9IGhhc2hlc1tpXS5zdWJzdHIoaGFzaGVzW2ldLmxhc3RJbmRleE9mKCcuJykgKyAxKTtcbiAgICAgICAgICAgICAgICBsZXQgcGF0aCA9IGhhc2hlc1tpXTtcblxuICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgaGFzaCBpZiBpcyBwcmVzZW50XG4gICAgICAgICAgICAgICAgaWYgKHBhdGguc2VhcmNoKCcjJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aCA9IHBhdGguc3Vic3RyKDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IHBhdGguc3BsaXQoJy8nKS5wb3AoKTtcblxuICAgICAgICAgICAgICAgIGlmIChleHQgPT09ICdmcmFnJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1haW4ub3BlbihwYXRoLCBmaWxlbmFtZS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXh0ID09PSAncG5nJyB8fCBleHQgPT09ICdqcGcnIHx8IGV4dCA9PT0gJ1BORycgfHwgZXh0ID09PSAnSlBHJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1haW4ub3B0aW9ucy5pbWdzLnB1c2gocGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHF1ZXJ5ID0gcGFyc2VRdWVyeSh3aW5kb3cubG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpKTtcbiAgICAgICAgaWYgKHF1ZXJ5KSB7XG4gICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gcXVlcnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAnbG9nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tYWluLmJ1ZmZlck1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2dzID0gcXVlcnkubG9nLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIGxvZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1haW4ub3BlbignaHR0cHM6Ly90aGVib29rb2ZzaGFkZXJzLmNvbS9sb2cvJyArIGxvZ3NbaV0gKyAnLmZyYWcnLCBsb2dzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFpbi5vcGVuKCdodHRwczovL3RoZWJvb2tvZnNoYWRlcnMuY29tL2xvZy8nICsgcXVlcnkubG9nICsgJy5mcmFnJywgcXVlcnkubG9nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gcXVlcnlba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAndHJ1ZScgfHwgdmFsdWUgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gKHZhbHVlID09ICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyc2VGbG9hdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYWluLm9wdGlvbnNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VRdWVyeSAocXN0cikge1xuICAgIGxldCBxdWVyeSA9IHt9O1xuICAgIGxldCBhID0gcXN0ci5zcGxpdCgnJicpO1xuICAgIGZvciAobGV0IGkgaW4gYSkge1xuICAgICAgICBsZXQgYiA9IGFbaV0uc3BsaXQoJz0nKTtcbiAgICAgICAgcXVlcnlbZGVjb2RlVVJJQ29tcG9uZW50KGJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChiWzFdKTtcbiAgICB9XG4gICAgcmV0dXJuIHF1ZXJ5O1xufVxuIiwiLypcbk9yaWdpbmFsOiBodHRwczovL2dpdGh1Yi5jb20vdGFuZ3JhbXMvdGFuZ3JhbS1wbGF5L2Jsb2IvZ2gtcGFnZXMvc3JjL2pzL2FkZG9ucy9Mb2NhbFN0b3JhZ2UuanNcbkF1dGhvcjogTG91IEh1YW5nIChAc2Fpa29maXNoKVxuKi9cblxuLyoqXG4gKiAgTG9jYWwgc3RvcmFnZVxuICpcbiAqICBQcm92aWRlcyBhIGNvbW1vbiBpbnRlcmZhY2UgZm9yIHRoZSBhcHBsaWNhdGlvbiB3aGVyZSBtb2R1bGVzIGNhblxuICogIHJlcXVlc3Qgc3RvcmFnZSBvZiB2YWx1ZXMgYWNyb3NzIG11bHRpcGxlIHVzZXIgc2Vzc2lvbnMgdmlhIHRoZVxuICogIGJyb3dzZXIncyBMb2NhbFN0b3JhZ2UgQVBJLlxuICpcbiAqICBCcm93c2VyIHN1cHBvcnQgaXMgZ29vZCwgc28gbm8gZmFsbGJhY2tzIGFyZSBpbXBsZW1lbnRlZC5cbiAqICBUaGlzIG1vZHVsZSBtYW5hZ2VzIG5hbWVzcGFjaW5nIGZvciBUYW5ncmFtIFBsYXkgdG8gcHJldmVudCBuYW1lXG4gKiAgY29sbGlzaW9ucyB3aXRoIG90aGVyIGxpYnJhcmllcywgYnJvd3NlciBleHRlbnNpb25zLCBldGMuXG4gKi9cbmNvbnN0IExPQ0FMX1NUT1JBR0VfUFJFRklYID0gJ2dsc2xFZGl0b3ItJztcblxuY29uc3QgTG9jYWxTdG9yYWdlID0ge1xuICAgIC8qKlxuICAgICAqICBzZXRJdGVtKClcbiAgICAgKiAgTmFtZXNwYWNlcyBrZXkgbmFtZSB0byBUYW5ncmFtIFBsYXkgYXBwbGljYXRpb24gYW5kIGFkZHNcbiAgICAgKiAgdGhlIHZhbHVlIHRvIExvY2FsU3RvcmFnZS5cbiAgICAgKi9cbiAgICBzZXRJdGVtIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9QUkVGSVggKyBrZXksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiAgcHVzaEl0ZW0oKVxuICAgICAqICBTdG9yZSB2YWx1ZXMgYXMgYW4gYXJyYXkuIElmIHRoZSBrZXkgZG9lc24ndCBleGlzdCBhcyBhbiBvYmplY3QsIGNyZWF0ZSBpdC5cbiAgICAgKiAgTm90ZSB0aGF0IHRoaXMgb3ZlcndyaXRlcyBhbiBvbGQgdmFsdWUgaWYgaXQgaXMgcHJlc2VudCBhbmQgbm90IGEgSlNPTiBvYmplY3QhXG4gICAgICogIElmIGl0IGV4aXN0cywgcmV0cmVpdmUgaXQsIHNlcmlhbGl6ZSBpdCBpbnRvIEpTT04sIHB1c2ggdGhlIG5ldyB2YWx1ZSxcbiAgICAgKiAgcmUtZW5jb2RlIHRvIGEgc3RyaW5nIGFuZCB0aGVuIHNldCBpdCBiYWNrIGluIGxvY2FsU3RvcmFnZS5cbiAgICAgKiAgTm8gb3RoZXIgYXJyYXkgbWV0aG9kcyBhcmUgaW1wbGVtZW50ZWQuIElmIHlvdSBuZWVkIHRvIGRlbGV0ZSBpdGVtcywgZXRjXG4gICAgICogIHRoZW4gcmV0cmlldmUgdGhlIHN0cmluZyBhcyBub3JtYWwsIGRvIHRoZSB3b3JrIGluIHlvdXIgc2NyaXB0LCBhbmQgdGhlblxuICAgICAqICBzZXQgaXQgdG8gdGhlIG5ldyBzdHJpbmdpZmllZCBhcnJheSBpbnN0ZWFkIG9mIHB1c2hpbmcgaXQuXG4gICAgICovXG4gICAgcHVzaEl0ZW0gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgbGV0IHN0b3JlZDtcbiAgICAgICAgc3RvcmVkID0gdGhpcy5nZXRJdGVtKGtleSk7XG4gICAgICAgIC8vIEluIGNhc2UgdGhlcmUgaXMgYSBwcmV2aW91c2x5IHN0b3JlZCBpdGVtIGhlcmUgdGhhdCBpcyBub3RcbiAgICAgICAgLy8gcGFyc2VhYmxlIEpTT04sIGRvbid0IGZhaWxcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHN0b3JlZCA9IEpTT04ucGFyc2Uoc3RvcmVkKTtcbiAgICAgICAgICAgIHN0b3JlZC5hcnIgPSBzdG9yZWQuYXJyIHx8IFtdO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBzdG9yZWQgPSB7IGFycjogW10gfTtcbiAgICAgICAgfVxuICAgICAgICBzdG9yZWQuYXJyLnB1c2godmFsdWUpO1xuICAgICAgICB0aGlzLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShzdG9yZWQpKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogIGdldEl0ZW0oKVxuICAgICAqICBSZXRyaWV2ZXMgdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXkgbmFtZSBhbmQgYXBwbGljYXRpb24gbmFtZXNwYWNlLlxuICAgICAqL1xuICAgIGdldEl0ZW0gKGtleSkge1xuICAgICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX1BSRUZJWCArIGtleSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogIHJlbW92ZUl0ZW0oKVxuICAgICAqICBSZW1vdmVzIGtleS12YWx1ZSBwYWlyIHVuZGVyIHRoZSBhcHBsaWNhdGlvbiBuYW1lc3BhY2UuXG4gICAgICovXG4gICAgcmVtb3ZlSXRlbSAoa2V5KSB7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYWxTdG9yYWdlKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTE9DQUxfU1RPUkFHRV9QUkVGSVggKyBrZXkpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqICBjbGVhcigpXG4gICAgICogIExvb3BzIHRocm91Z2ggYWxsIHZhbHVlcyBpbiBsb2NhbFN0b3JhZ2UgdW5kZXIgdGhlIGFwcGxpY2F0aW9uXG4gICAgICogIG5hbWVzcGFjZSBhbmQgcmVtb3ZlcyB0aGVtLCBwcmVzZXJ2aW5nIG90aGVyIGtleS12YWx1ZSBwYWlycyBpblxuICAgICAqICBsb2NhbFN0b3JhZ2UuXG4gICAgICovXG4gICAgY2xlYXIgKCkge1xuICAgICAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5LmluZGV4T2YoTE9DQUxfU1RPUkFHRV9QUkVGSVgpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMT0NBTF9TVE9SQUdFX1BSRUZJWCArIGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IExvY2FsU3RvcmFnZTtcbiIsInZhciBsYXN0UmVwbGF5O1xuXG5leHBvcnQgZnVuY3Rpb24gc2F2ZU9uU2VydmVyIChnZSwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWdlLmNoYW5nZSAmJiBsYXN0UmVwbGF5KSB7XG4gICAgICAgIGNhbGxiYWNrKGxhc3RSZXBsYXkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGNvbnRlbnQgPSBnZS5nZXRDb250ZW50KCk7XG4gICAgbGV0IG5hbWUgPSBnZS5nZXRBdXRob3IoKTtcbiAgICBsZXQgdGl0bGUgPSBnZS5nZXRUaXRsZSgpO1xuXG4gICAgaWYgKG5hbWUgIT09ICcnICYmIHRpdGxlICE9PSAnJykge1xuICAgICAgICBuYW1lICs9ICctJyArIHRpdGxlO1xuICAgIH1cblxuICAgIC8vIFNUT1JFIEEgQ09QWSBvbiBTRVJWRVJcbiAgICBsZXQgdXJsID0gJ2h0dHBzOi8vdGhlYm9va29mc2hhZGVycy5jb206ODA4MC8nO1xuICAgIC8vIGxldCB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDgwLyc7XG4gICAgbGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICBkYXRhLmFwcGVuZCgnY29kZScsIGNvbnRlbnQpO1xuXG4gICAgbGV0IGRhdGFVUkwgPSBnZS5zaGFkZXIuZWxfY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7XG4gICAgbGV0IGJsb2JCaW4gPSBhdG9iKGRhdGFVUkwuc3BsaXQoJywnKVsxXSk7XG4gICAgbGV0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBibG9iQmluLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGFycmF5LnB1c2goYmxvYkJpbi5jaGFyQ29kZUF0KGkpKTtcbiAgICB9XG4gICAgbGV0IGZpbGUgPSBuZXcgQmxvYihbbmV3IFVpbnQ4QXJyYXkoYXJyYXkpXSwgeyB0eXBlOiAnaW1hZ2UvcG5nJyB9KTtcbiAgICBkYXRhLmFwcGVuZCgnaW1hZ2UnLCBmaWxlKTtcblxuICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB4aHIub3BlbignUE9TVCcsIHVybCArICdzYXZlJywgdHJ1ZSk7XG4gICAgeGhyLm9ubG9hZCA9IChldmVudCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBsZXQgbmFtZSA9IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICBsZXQgcmVwbGF5ID0ge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlcGxheSk7XG4gICAgICAgICAgICBsYXN0UmVwbGF5ID0gcmVwbGF5O1xuICAgICAgICB9XG4gICAgfTtcbiAgICB4aHIuc2VuZChkYXRhKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9wZW5GcmFtZUFydHdvcmsoZ2xzbEVkaXRvciwgbmFtZSwgdXJsLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IE9GX0JBU0VfQVBJX1VSTCA9ICdodHRwczovL2FwaS5vcGVuZnJhbWUuaW8vdjAnO1xuICAgIGNvbnN0IE9GX0JBU0VfQVBQX1VSTCA9ICdodHRwczovL29wZW5mcmFtZS5pbyc7XG4gICAgLy8gY29uc3QgT0ZfQkFTRV9BUElfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODg4OC9hcGknOyAvLyBmb3IgbG9jYWwgdGVzdGluZ1xuICAgIC8vIGNvbnN0IE9GX0JBU0VfQVBQX1VSTCA9ICdodHRwOi8vbG9jYWxob3N0OjgwMDAnOyAvLyBmb3IgbG9jYWwgdGVzdGluZ1xuICAgIGxldCB0aXRsZSA9IGdsc2xFZGl0b3IuZ2V0VGl0bGUoKTtcbiAgICBsZXQgYXV0aG9yID0gZ2xzbEVkaXRvci5nZXRBdXRob3IoKTtcbiAgICBnbHNsRWRpdG9yLmdldE9mVG9rZW4oKS50aGVuKGluaXRpYXRlT2ZSZXF1ZXN0KTtcblxuICAgIGZ1bmN0aW9uIGluaXRpYXRlT2ZSZXF1ZXN0KG9mVG9rZW4pIHtcbiAgICAgICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSAoKSA9PiB7fTtcbiAgICAgICAgfVxuICAgICAgICAvLyBhbnl3aGVyZSBpbiB0aGUgQVBJIHRoYXQgdXNlciB7aWR9IGlzIG5lZWRlZCwgdGhlIGFsaWFzICdjdXJyZW50JyBjYW4gYmUgdXNlZCBmb3IgdGhlIGxvZ2dlZC1pbiB1c2VyXG4gICAgICAgIHhoci5vcGVuKCdQT1NUJywgYCR7T0ZfQkFTRV9BUElfVVJMfS91c2Vycy9jdXJyZW50L2NyZWF0ZWRfYXJ0d29ya2ApO1xuICAgICAgICAvLyBzZXQgY29udGVudCB0eXBlIHRvIEpTT04uLi5cbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCBvZlRva2VuKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ2FjY2Vzc190b2tlbicsIG9mVG9rZW4pO1xuXG4gICAgICAgIC8vIFRoaXMgaXMgZXNzZW50aWFsIGluIG9yZGVyIHRvIGluY2x1ZGUgYXV0aCBjb29raWVzOlxuICAgICAgICB4aHIub25sb2FkID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnb25sb2FkJywgZXZlbnQpO1xuICAgICAgICAgICAgaWYgKGV2ZW50LmN1cnJlbnRUYXJnZXQuc3RhdHVzID49IDQwMCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGAke09GX0JBU0VfQVBQX1VSTH0vbG9naW5gLCAnbG9naW4nLCAnd2lkdGg9NTAwLGhlaWdodD02MDAnKTtcbiAgICAgICAgICAgICAgICBsZXQgc3VjY2Vzc0xpc3RlbmVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5kYXRhID09PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZU9wZW5GcmFtZUFydHdvcmsoZ2xzbEVkaXRvciwgbmFtZSwgdXJsLCBjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBzdWNjZXNzTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBzdWNjZXNzTGlzdGVuZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmN1cnJlbnRUYXJnZXQuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgeGhyLm9uZXJyb3IgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdGF0dXM6JyxldmVudC5jdXJyZW50VGFyZ2V0LnN0YXR1cyk7XG4gICAgICAgIH07XG4gICAgICAgIC8qIFJlbW90ZSBleHBlY3RzIHVuZGVyc2NvcmUga2V5cyAqL1xuICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbiAgICAgICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgYXV0aG9yX25hbWU6IGF1dGhvcixcbiAgICAgICAgICAgIGlzX3B1YmxpYzogZmFsc2UsXG4gICAgICAgICAgICBmb3JtYXQ6ICdvcGVuZnJhbWUtZ2xzbHZpZXdlcicsXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL3RoZWJvb2tvZnNoYWRlcnMuY29tL2xvZy8nICsgbmFtZSArICcuZnJhZycsXG4gICAgICAgICAgICB0aHVtYl91cmw6ICdodHRwczovL3RoZWJvb2tvZnNoYWRlcnMuY29tL2xvZy8nICsgbmFtZSArICcucG5nJ1xuICAgICAgICAvKiBlc2xpbnQtZW5hYmxlIGNhbWVsY2FzZSAqL1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGdldERvbU9yaWdpbiAoZWwpIHtcbiAgICBjb25zdCBib3ggPSAoZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSA/IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogeyB0b3A6IDAsIGxlZnQ6IDAgfTtcbiAgICBjb25zdCBkb2MgPSBlbCAmJiBlbC5vd25lckRvY3VtZW50O1xuICAgIGNvbnN0IGJvZHkgPSBkb2MuYm9keTtcbiAgICBjb25zdCB3aW4gPSBkb2MuZGVmYXVsdFZpZXcgfHwgZG9jLnBhcmVudFdpbmRvdyB8fCB3aW5kb3c7XG4gICAgY29uc3QgZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQgfHwgYm9keS5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGNsaWVudFRvcCA9IGRvY0VsZW0uY2xpZW50VG9wIHx8IGJvZHkuY2xpZW50VG9wIHx8IDA7IC8vIGJvcmRlciBvbiBodG1sIG9yIGJvZHkgb3IgYm90aFxuICAgIGNvbnN0IGNsaWVudExlZnQgPSBkb2NFbGVtLmNsaWVudExlZnQgfHwgYm9keS5jbGllbnRMZWZ0IHx8IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBsZWZ0OiBib3gubGVmdCArICh3aW4ucGFnZVhPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxMZWZ0KSAtIGNsaWVudExlZnQsXG4gICAgICAgIHRvcDogYm94LnRvcCArICh3aW4ucGFnZVlPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxUb3ApIC0gY2xpZW50VG9wXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERldmljZVBpeGVsUmF0aW8gKGN0eCkge1xuICAgIGxldCBkZXZpY2VQaXhlbFJhdGlvID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgICBsZXQgYmFja2luZ1N0b3JlUmF0aW8gPSBjdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4Lm1zQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG4gICAgcmV0dXJuIGRldmljZVBpeGVsUmF0aW8gLyBiYWNraW5nU3RvcmVSYXRpbztcbn1cbiIsIlxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tbWVudGVkKGNtLCBuTGluZSwgbWF0Y2gpIHtcbiAgICBsZXQgdG9rZW4gPSBjbS5nZXRUb2tlbkF0KHsgbGluZTogbkxpbmUsIGNoOiBtYXRjaC5pbmRleCB9KTtcbiAgICBpZiAodG9rZW4gJiYgdG9rZW4udHlwZSkge1xuICAgICAgICByZXR1cm4gdG9rZW4udHlwZSA9PT0gJ2NvbW1lbnQnO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xpbmVBZnRlck1haW4oY20sIG5MaW5lKSB7XG4gICAgbGV0IHRvdGFsTGluZXMgPSBjbS5nZXREb2MoKS5zaXplO1xuICAgIGxldCB2b2lkUkUgPSBuZXcgUmVnRXhwKCd2b2lkIG1haW5cXFxccypcXFxcKFxcXFxzKlt2b2lkXSpcXFxcKScsICdpJyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuTGluZSAmJiBpIDwgdG90YWxMaW5lczsgaSsrKSB7XG4gICAgICAgIC8vIERvIG5vdCBzdGFydCB1bnRpbCBiZWluZyBpbnNpZGUgdGhlIG1haW4gZnVuY3Rpb25cbiAgICAgICAgbGV0IHZvaWRNYXRjaCA9IHZvaWRSRS5leGVjKGNtLmdldExpbmUoaSkpO1xuICAgICAgICBpZiAodm9pZE1hdGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYXJpYWJsZVR5cGUoY20sIHNWYXJpYWJsZSkge1xuICAgIGxldCBuTGluZXMgPSBjbS5nZXREb2MoKS5zaXplO1xuXG4gICAgLy8gU2hvdyBsaW5lIHdoZXJlIHRoZSB2YWx1ZSBvZiB0aGUgdmFyaWFibGUgaXMgYmVlbiBhc2lnbmVkXG4gICAgbGV0IHVuaWZvcm1SRSA9IG5ldyBSZWdFeHAoJ1xcXFxzKnVuaWZvcm1cXFxccysoZmxvYXR8dmVjMnx2ZWMzfHZlYzQpXFxcXHMrJyArIHNWYXJpYWJsZSArICdcXFxccyo7Jyk7XG4gICAgbGV0IHZvaWRSRSA9IG5ldyBSZWdFeHAoJ3ZvaWQgbWFpblxcXFxzKlxcXFwoXFxcXHMqW3ZvaWRdKlxcXFwpJywgJ2knKTtcbiAgICBsZXQgdm9pZElOID0gZmFsc2U7XG4gICAgbGV0IGNvbnN0cnVjdFJFID0gbmV3IFJlZ0V4cCgnKGZsb2F0fHZlY1xcXFxkKVxcXFxzKygnICsgc1ZhcmlhYmxlICsgJylcXFxccypbO10/JywgJ2knKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5MaW5lczsgaSsrKSB7XG4gICAgICAgIGlmICghdm9pZElOKSB7XG4gICAgICAgICAgICAvLyBEbyBub3Qgc3RhcnQgdW50aWwgYmVpbmcgaW5zaWRlIHRoZSBtYWluIGZ1bmN0aW9uXG4gICAgICAgICAgICBsZXQgdm9pZE1hdGNoID0gdm9pZFJFLmV4ZWMoY20uZ2V0TGluZShpKSk7XG4gICAgICAgICAgICBpZiAodm9pZE1hdGNoKSB7XG4gICAgICAgICAgICAgICAgdm9pZElOID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCB1bmlmb3JtTWF0Y2ggPSB1bmlmb3JtUkUuZXhlYyhjbS5nZXRMaW5lKGkpKTtcbiAgICAgICAgICAgICAgICBpZiAodW5pZm9ybU1hdGNoICYmICFpc0NvbW1lbnRlZChjbSwgaSwgdW5pZm9ybU1hdGNoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5pZm9ybU1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjb25zdHJ1Y3RNYXRjaCA9IGNvbnN0cnVjdFJFLmV4ZWMoY20uZ2V0TGluZShpKSk7XG4gICAgICAgICAgICBpZiAoY29uc3RydWN0TWF0Y2ggJiYgY29uc3RydWN0TWF0Y2hbMV0gJiYgIWlzQ29tbWVudGVkKGNtLCBpLCBjb25zdHJ1Y3RNYXRjaCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RydWN0TWF0Y2hbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuICdub25lJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNoYWRlckZvclR5cGVWYXJJbkxpbmUoY20sIHNUeXBlLCBzVmFyaWFibGUsIG5MaW5lKSB7XG4gICAgbGV0IGZyYWcgPSAnJztcbiAgICBsZXQgb2Zmc2V0ID0gMTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5MaW5lICsgMSAmJiBpIDwgY20uZ2V0RG9jKCkuc2l6ZTsgaSsrKSB7XG4gICAgICAgIGlmIChjbS5nZXRMaW5lKGkpKSB7XG4gICAgICAgICAgICBmcmFnICs9IGNtLmdldExpbmUoaSkgKyAnXFxuJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZyYWcgKz0gJ1xcdGdsX0ZyYWdDb2xvciA9ICc7XG4gICAgaWYgKHNUeXBlID09PSAnZmxvYXQnKSB7XG4gICAgICAgIGZyYWcgKz0gJ3ZlYzQodmVjMygnICsgc1ZhcmlhYmxlICsgJyksMS4pJztcbiAgICB9XG4gICAgZWxzZSBpZiAoc1R5cGUgPT09ICd2ZWMyJykge1xuICAgICAgICBmcmFnICs9ICd2ZWM0KHZlYzMoJyArIHNWYXJpYWJsZSArICcsMC4pLDEuKSc7XG4gICAgfVxuICAgIGVsc2UgaWYgKHNUeXBlID09PSAndmVjMycpIHtcbiAgICAgICAgZnJhZyArPSAndmVjNCgnICsgc1ZhcmlhYmxlICsgJywxLiknO1xuICAgIH1cbiAgICBlbHNlIGlmIChzVHlwZSA9PT0gJ3ZlYzQnKSB7XG4gICAgICAgIGZyYWcgKz0gc1ZhcmlhYmxlO1xuICAgIH1cbiAgICBmcmFnICs9ICc7XFxufVxcbic7XG5cbiAgICByZXR1cm4gZnJhZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlc3VsdFJhbmdlKHRlc3RSZXN1bHRzKSB7XG4gICAgbGV0IG1pbk1TID0gJzEwMDAwMDAwLjAnO1xuICAgIGxldCBtaW5MaW5lID0gMDtcbiAgICBsZXQgbWF4TVMgPSAnMC4wJztcbiAgICBsZXQgbWF4TGluZSA9IDA7XG4gICAgZm9yIChsZXQgaSBpbiB0ZXN0UmVzdWx0cykge1xuICAgICAgICBpZiAodGVzdFJlc3VsdHNbaV0ubXMgPCBtaW5NUykge1xuICAgICAgICAgICAgbWluTVMgPSB0ZXN0UmVzdWx0c1tpXS5tcztcbiAgICAgICAgICAgIG1pbkxpbmUgPSB0ZXN0UmVzdWx0c1tpXS5saW5lO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZXN0UmVzdWx0c1tpXS5tcyA+IG1heE1TKSB7XG4gICAgICAgICAgICBtYXhNUyA9IHRlc3RSZXN1bHRzW2ldLm1zO1xuICAgICAgICAgICAgbWF4TGluZSA9IHRlc3RSZXN1bHRzW2ldLmxpbmU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHsgbWluOntsaW5lOiBtaW5MaW5lLCBtczogbWluTVN9LCBtYXg6e2xpbmU6IG1heExpbmUsIG1zOiBtYXhNU30gfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1lZGlhbih2YWx1ZXMpIHtcbiAgICB2YWx1ZXMuc29ydChmdW5jdGlvbihhLGIpIHtyZXR1cm4gYSAtIGI7fSk7XG5cbiAgICB2YXIgaGFsZiA9IE1hdGguZmxvb3IodmFsdWVzLmxlbmd0aCAvIDIpO1xuXG4gICAgaWYodmFsdWVzLmxlbmd0aCAlIDIpIHtyZXR1cm4gdmFsdWVzW2hhbGZdO31cbiAgICBlbHNlIHtyZXR1cm4gKHZhbHVlc1toYWxmIC0gMV0gKyB2YWx1ZXNbaGFsZl0pIC8gMi4wO31cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERlbHRhU3VtKHRlc3RSZXN1bHRzKSB7XG4gICAgbGV0IHRvdGFsID0gMC4wO1xuICAgIGZvciAobGV0IGkgaW4gdGVzdFJlc3VsdHMpIHtcbiAgICAgICAgaWYgKHRlc3RSZXN1bHRzW2ldLmRlbHRhID4gMCkge1xuICAgICAgICAgICAgdG90YWwgKz0gdGVzdFJlc3VsdHNbaV0uZGVsdGE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvdGFsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SGl0cyh0ZXN0UmVzdWx0cykge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgZm9yIChsZXQgaSBpbiB0ZXN0UmVzdWx0cykge1xuICAgICAgICBpZiAodGVzdFJlc3VsdHNbaV0uZGVsdGEgPiAwKSB7XG4gICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0b3RhbDtcbn1cbiIsIi8qXG4gKiBPcmlnaW5hbCBjb2RlIGZyb206IGh0dHBzOi8vdHdpdHRlci5jb20vYmx1cnNwbGluZSAvIGh0dHBzOi8vZ2l0aHViLmNvbS96ejg1XG4gKiBTZWUgcG9zdCBAIGh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2cvMjAxNC8xMS8xNS9yZXNpemluZy1tb3Zpbmctc25hcHBpbmctd2luZG93cy13aXRoLWpzLWNzcy9cbiAqL1xuXG5pbXBvcnQgeyBzdWJzY3JpYmVNaXhpbiB9IGZyb20gJy4vbWl4aW4nO1xuXG4vLyBUaHJlc2hvbGRzXG52YXIgRlVMTFNDUkVFTl9NQVJHSU5TID0gLTMwO1xudmFyIE1BUkdJTlMgPSAxMDtcblxuZnVuY3Rpb24gc2V0Qm91bmRzKGVsZW1lbnQsIHgsIHksIHcsIGgpIHtcbiAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4ICsgJ3B4JztcbiAgICBlbGVtZW50LnN0eWxlLnRvcCA9IHkgKyAncHgnO1xuICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSB3ICsgJ3B4JztcbiAgICBlbGVtZW50LnN0eWxlLmhlaWdodCA9IGggKyAncHgnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3Vic2NyaWJlSW50ZXJhY3RpdmVEb20gKGRvbSwgb3B0aW9ucykge1xuICAgIHN1YnNjcmliZU1peGluKGRvbSk7XG5cbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBvcHRpb25zLnJlc2l6ZSA9IG9wdGlvbnMucmVzaXplICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnJlc2l6ZSA6IGZhbHNlO1xuICAgIG9wdGlvbnMubW92ZSA9IG9wdGlvbnMubW92ZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tb3ZlIDogZmFsc2U7XG4gICAgb3B0aW9ucy5zbmFwID0gb3B0aW9ucy5zbmFwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnNuYXAgOiBmYWxzZTtcblxuICAgIC8vIE1pbmltdW0gcmVzaXphYmxlIGFyZWFcbiAgICB2YXIgbWluV2lkdGggPSAxMDA7XG4gICAgdmFyIG1pbkhlaWdodCA9IDEwMDtcblxuICAgIC8vIEVuZCBvZiB3aGF0J3MgY29uZmlndXJhYmxlLlxuICAgIHZhciBjbGlja2VkID0gbnVsbDtcbiAgICB2YXIgb25SaWdodEVkZ2UsIG9uQm90dG9tRWRnZSwgb25MZWZ0RWRnZSwgb25Ub3BFZGdlO1xuXG4gICAgdmFyIHJpZ2h0U2NyZWVuRWRnZSwgYm90dG9tU2NyZWVuRWRnZTtcblxuICAgIHZhciBwcmVTbmFwcGVkO1xuXG4gICAgdmFyIGIsIHgsIHk7XG5cbiAgICB2YXIgcmVkcmF3ID0gZmFsc2U7XG5cbiAgICB2YXIgZ2hvc3Rkb20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBnaG9zdGRvbS5jbGFzc05hbWUgPSAnZ2hvc3Rkb20nO1xuXG4gICAgaWYgKG9wdGlvbnMuc25hcCkge1xuICAgICAgICBkb20ucGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChnaG9zdGRvbSk7XG4gICAgfVxuXG4gICAgLy8gTW91c2UgZXZlbnRzXG4gICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbk1vdmUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvblVwKTtcblxuICAgIC8vIFRvdWNoIGV2ZW50c1xuICAgIGRvbS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Ub3VjaERvd24pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hFbmQpO1xuXG4gICAgZnVuY3Rpb24gaGludEhpZGUoKSB7XG4gICAgICAgIHNldEJvdW5kcyhnaG9zdGRvbSwgYi5sZWZ0LCBiLnRvcCwgYi53aWR0aCwgYi5oZWlnaHQpO1xuICAgICAgICBnaG9zdGRvbS5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblRvdWNoRG93biAoZXZlbnQpIHtcbiAgICAgICAgb25Eb3duKGV2ZW50LnRvdWNoZXNbMF0pO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Ub3VjaE1vdmUgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBvbk1vdmUoZXZlbnQudG91Y2hlc1swXSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Ub3VjaEVuZCAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRvdWNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBvblVwKGUuY2hhbmdlZFRvdWNoZXNbMF0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Nb3VzZURvd24gKGV2ZW50KSB7XG4gICAgICAgIG9uRG93bihldmVudCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkRvd24gKGV2ZW50KSB7XG4gICAgICAgIGNhbGMoZXZlbnQpO1xuICAgICAgICB2YXIgaXNSZXNpemluZyA9IG9wdGlvbnMucmVzaXplICYmIChvblJpZ2h0RWRnZSB8fCBvbkJvdHRvbUVkZ2UgfHwgb25Ub3BFZGdlIHx8IG9uTGVmdEVkZ2UpO1xuICAgICAgICBjbGlja2VkID0ge1xuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHksXG4gICAgICAgICAgICBjeDogZXZlbnQuY2xpZW50WCxcbiAgICAgICAgICAgIGN5OiBldmVudC5jbGllbnRZLFxuICAgICAgICAgICAgdzogYi53aWR0aCxcbiAgICAgICAgICAgIGg6IGIuaGVpZ2h0LFxuICAgICAgICAgICAgaXNSZXNpemluZzogaXNSZXNpemluZyxcbiAgICAgICAgICAgIGlzTW92aW5nOiAhaXNSZXNpemluZyAmJiBjYW5Nb3ZlKCksXG4gICAgICAgICAgICBvblRvcEVkZ2U6IG9uVG9wRWRnZSxcbiAgICAgICAgICAgIG9uTGVmdEVkZ2U6IG9uTGVmdEVkZ2UsXG4gICAgICAgICAgICBvblJpZ2h0RWRnZTogb25SaWdodEVkZ2UsXG4gICAgICAgICAgICBvbkJvdHRvbUVkZ2U6IG9uQm90dG9tRWRnZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbk1vdmUoKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLm1vdmUgJiYgKHggPiAwICYmIHggPCBiLndpZHRoICYmIHkgPiAwICYmIHkgPCBiLmhlaWdodCk7Ly8gJiYgeSA8IDMwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGMgKGV2ZW50KSB7XG4gICAgICAgIGIgPSBkb20uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHggPSBldmVudC5jbGllbnRYIC0gYi5sZWZ0O1xuICAgICAgICB5ID0gZXZlbnQuY2xpZW50WSAtIGIudG9wO1xuXG4gICAgICAgIG9uVG9wRWRnZSA9IHkgPCBNQVJHSU5TO1xuICAgICAgICBvbkxlZnRFZGdlID0geCA8IE1BUkdJTlM7XG4gICAgICAgIG9uUmlnaHRFZGdlID0geCA+PSBiLndpZHRoIC0gTUFSR0lOUztcbiAgICAgICAgb25Cb3R0b21FZGdlID0geSA+PSBiLmhlaWdodCAtIE1BUkdJTlM7XG5cbiAgICAgICAgcmlnaHRTY3JlZW5FZGdlID0gd2luZG93LmlubmVyV2lkdGggLSBNQVJHSU5TO1xuICAgICAgICBib3R0b21TY3JlZW5FZGdlID0gd2luZG93LmlubmVySGVpZ2h0IC0gTUFSR0lOUztcbiAgICB9XG5cbiAgICB2YXIgZTtcblxuICAgIGZ1bmN0aW9uIG9uTW92ZShldmVudCkge1xuICAgICAgICBjYWxjKGV2ZW50KTtcbiAgICAgICAgZSA9IGV2ZW50O1xuICAgICAgICByZWRyYXcgPSB0cnVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFuaW1hdGUoKSB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcblxuICAgICAgICBpZiAoIXJlZHJhdykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJlZHJhdyA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChjbGlja2VkICYmIGNsaWNrZWQuaXNSZXNpemluZykge1xuICAgICAgICAgICAgaWYgKGNsaWNrZWQub25SaWdodEVkZ2UpIHtcbiAgICAgICAgICAgICAgICBkb20uc3R5bGUud2lkdGggPSBNYXRoLm1heCh4LCBtaW5XaWR0aCkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNsaWNrZWQub25Cb3R0b21FZGdlKSB7XG4gICAgICAgICAgICAgICAgZG9tLnN0eWxlLmhlaWdodCA9IE1hdGgubWF4KHksIG1pbkhlaWdodCkgKyAncHgnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2xpY2tlZC5vbkxlZnRFZGdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRXaWR0aCA9IE1hdGgubWF4KGNsaWNrZWQuY3ggLSBlLmNsaWVudFggKyBjbGlja2VkLncsIG1pbldpZHRoKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFdpZHRoID4gbWluV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tLnN0eWxlLndpZHRoID0gY3VycmVudFdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgZG9tLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdyaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICBkb20uc3R5bGUubGVmdCA9IGUuY2xpZW50WCArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2xpY2tlZC5vblRvcEVkZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudEhlaWdodCA9IE1hdGgubWF4KGNsaWNrZWQuY3kgLSBlLmNsaWVudFkgKyBjbGlja2VkLmgsIG1pbkhlaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRIZWlnaHQgPiBtaW5IZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9tLnN0eWxlLmhlaWdodCA9IGN1cnJlbnRIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICBkb20uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2JvdHRvbScpO1xuICAgICAgICAgICAgICAgICAgICBkb20uc3R5bGUudG9wID0gZS5jbGllbnRZICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhpbnRIaWRlKCk7XG4gICAgICAgICAgICBkb20udHJpZ2dlcigncmVzaXplJywgeyBmaW5pc2g6IGZhbHNlLCBlbDogZG9tIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNsaWNrZWQgJiYgY2xpY2tlZC5pc01vdmluZykge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc25hcCkge1xuICAgICAgICAgICAgICAgIGlmIChiLnRvcCA8IEZVTExTQ1JFRU5fTUFSR0lOUyB8fCBiLmxlZnQgPCBGVUxMU0NSRUVOX01BUkdJTlMgfHwgYi5yaWdodCA+IHdpbmRvdy5pbm5lcldpZHRoIC0gRlVMTFNDUkVFTl9NQVJHSU5TIHx8IGIuYm90dG9tID4gd2luZG93LmlubmVySGVpZ2h0IC0gRlVMTFNDUkVFTl9NQVJHSU5TKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldEJvdW5kcyhnaG9zdGRvbSwgMCwgMCwgd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGdob3N0ZG9tLnN0eWxlLm9wYWNpdHkgPSAwLjI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGIudG9wIDwgTUFSR0lOUykge1xuICAgICAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZ2hvc3Rkb20sIDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyKTtcbiAgICAgICAgICAgICAgICAgICAgZ2hvc3Rkb20uc3R5bGUub3BhY2l0eSA9IDAuMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYi5sZWZ0IDwgTUFSR0lOUykge1xuICAgICAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZ2hvc3Rkb20sIDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoIC8gMiwgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgZ2hvc3Rkb20uc3R5bGUub3BhY2l0eSA9IDAuMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYi5yaWdodCA+IHJpZ2h0U2NyZWVuRWRnZSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZ2hvc3Rkb20sIHdpbmRvdy5pbm5lcldpZHRoIC8gMiwgMCwgd2luZG93LmlubmVyV2lkdGggLyAyLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBnaG9zdGRvbS5zdHlsZS5vcGFjaXR5ID0gMC4yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChiLmJvdHRvbSA+IGJvdHRvbVNjcmVlbkVkZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0Qm91bmRzKGdob3N0ZG9tLCAwLCB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyLCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVyV2lkdGggLyAyKTtcbiAgICAgICAgICAgICAgICAgICAgZ2hvc3Rkb20uc3R5bGUub3BhY2l0eSA9IDAuMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhpbnRIaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHByZVNuYXBwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0Qm91bmRzKGRvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuY2xpZW50WCAtIHByZVNuYXBwZWQud2lkdGggLyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZS5jbGllbnRZIC0gTWF0aC5taW4oY2xpY2tlZC55LCBwcmVTbmFwcGVkLmhlaWdodCksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVTbmFwcGVkLndpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlU25hcHBlZC5oZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gbW92aW5nXG4gICAgICAgICAgICAgICAgZG9tLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdyaWdodCcpO1xuICAgICAgICAgICAgICAgIGRvbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnYm90dG9tJyk7XG4gICAgICAgICAgICAgICAgZG9tLnN0eWxlLnRvcCA9IChlLmNsaWVudFkgLSBjbGlja2VkLnkpICsgJ3B4JztcbiAgICAgICAgICAgICAgICBkb20uc3R5bGUubGVmdCA9IChlLmNsaWVudFggLSBjbGlja2VkLngpICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCB4ID0gKGUuY2xpZW50WCAtIGNsaWNrZWQueCk7XG4gICAgICAgICAgICAgICAgbGV0IHkgPSAoZS5jbGllbnRZIC0gY2xpY2tlZC55KTtcblxuICAgICAgICAgICAgICAgIGlmICh4IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoeSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgeSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHggKyBkb20ub2Zmc2V0V2lkdGggPiB3aW5kb3cuaW5uZXJXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICB4ID0gd2luZG93LmlubmVyV2lkdGggLSBkb20ub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHkgKyBkb20ub2Zmc2V0SGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHkgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBkb20ub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRvbS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgncmlnaHQnKTtcbiAgICAgICAgICAgICAgICBkb20uc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2JvdHRvbScpO1xuICAgICAgICAgICAgICAgIGRvbS5zdHlsZS5sZWZ0ID0geCArICdweCc7XG4gICAgICAgICAgICAgICAgZG9tLnN0eWxlLnRvcCA9IHkgKyAncHgnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkb20udHJpZ2dlcignbW92ZScsIHsgZmluaXNoOiBmYWxzZSwgZWw6IGRvbSB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGlzIGNvZGUgZXhlY3V0ZXMgd2hlbiBtb3VzZSBtb3ZlcyB3aXRob3V0IGNsaWNraW5nXG5cbiAgICAgICAgLy8gc3R5bGUgY3Vyc29yXG4gICAgICAgIGlmIChvcHRpb25zLnJlc2l6ZSAmJiAob25SaWdodEVkZ2UgJiYgb25Cb3R0b21FZGdlIHx8IG9uTGVmdEVkZ2UgJiYgb25Ub3BFZGdlKSkge1xuICAgICAgICAgICAgZG9tLnN0eWxlLmN1cnNvciA9ICdud3NlLXJlc2l6ZSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5yZXNpemUgJiYgKG9uUmlnaHRFZGdlICYmIG9uVG9wRWRnZSB8fCBvbkJvdHRvbUVkZ2UgJiYgb25MZWZ0RWRnZSkpIHtcbiAgICAgICAgICAgIGRvbS5zdHlsZS5jdXJzb3IgPSAnbmVzdy1yZXNpemUnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9wdGlvbnMucmVzaXplICYmIChvblJpZ2h0RWRnZSB8fCBvbkxlZnRFZGdlKSkge1xuICAgICAgICAgICAgZG9tLnN0eWxlLmN1cnNvciA9ICdldy1yZXNpemUnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9wdGlvbnMucmVzaXplICYmIChvbkJvdHRvbUVkZ2UgfHwgb25Ub3BFZGdlKSkge1xuICAgICAgICAgICAgZG9tLnN0eWxlLmN1cnNvciA9ICducy1yZXNpemUnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNhbk1vdmUoKSkge1xuICAgICAgICAgICAgZG9tLnN0eWxlLmN1cnNvciA9ICdtb3ZlJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRvbS5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYW5pbWF0ZSgpO1xuXG4gICAgZnVuY3Rpb24gb25VcChlKSB7XG4gICAgICAgIGNhbGMoZSk7XG5cbiAgICAgICAgaWYgKGNsaWNrZWQgJiYgY2xpY2tlZC5pc1Jlc2l6aW5nKSB7XG4gICAgICAgICAgICBkb20udHJpZ2dlcigncmVzaXplJywgeyBmaW5pc2g6IHRydWUsIGVsOiBkb20gfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5zbmFwICYmIGNsaWNrZWQgJiYgY2xpY2tlZC5pc01vdmluZykge1xuICAgICAgICAgICAgLy8gU25hcFxuICAgICAgICAgICAgdmFyIHNuYXBwZWQgPSB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IGIud2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBiLmhlaWdodFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKGIudG9wIDwgRlVMTFNDUkVFTl9NQVJHSU5TIHx8IGIubGVmdCA8IEZVTExTQ1JFRU5fTUFSR0lOUyB8fCBiLnJpZ2h0ID4gd2luZG93LmlubmVyV2lkdGggLSBGVUxMU0NSRUVOX01BUkdJTlMgfHwgYi5ib3R0b20gPiB3aW5kb3cuaW5uZXJIZWlnaHQgLSBGVUxMU0NSRUVOX01BUkdJTlMpIHtcbiAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZG9tLCAwLCAwLCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBwcmVTbmFwcGVkID0gc25hcHBlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGIudG9wIDwgTUFSR0lOUykge1xuICAgICAgICAgICAgICAgIHNldEJvdW5kcyhkb20sIDAsIDAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyKTtcbiAgICAgICAgICAgICAgICBwcmVTbmFwcGVkID0gc25hcHBlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGIubGVmdCA8IE1BUkdJTlMpIHtcbiAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZG9tLCAwLCAwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgcHJlU25hcHBlZCA9IHNuYXBwZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChiLnJpZ2h0ID4gcmlnaHRTY3JlZW5FZGdlKSB7XG4gICAgICAgICAgICAgICAgc2V0Qm91bmRzKGRvbSwgd2luZG93LmlubmVyV2lkdGggLyAyLCAwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgcHJlU25hcHBlZCA9IHNuYXBwZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChiLmJvdHRvbSA+IGJvdHRvbVNjcmVlbkVkZ2UpIHtcbiAgICAgICAgICAgICAgICBzZXRCb3VuZHMoZG9tLCAwLCB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyLCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVyV2lkdGggLyAyKTtcbiAgICAgICAgICAgICAgICBwcmVTbmFwcGVkID0gc25hcHBlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZVNuYXBwZWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGludEhpZGUoKTtcbiAgICAgICAgICAgIGRvbS50cmlnZ2VyKCdtb3ZlJywgeyBmaW5pc2g6IHRydWUsIGVsOiBkb20gfSk7XG4gICAgICAgICAgICBkb20udHJpZ2dlcigncmVzaXplJywgeyBmaW5pc2g6IHRydWUsIGVsOiBkb20gfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2xpY2tlZCA9IG51bGw7XG4gICAgfVxuXG4gICAgZG9tLnNuYXBSaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNuYXBwZWQgPSB7XG4gICAgICAgICAgICB3aWR0aDogZG9tLndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBkb20uaGVpZ2h0XG4gICAgICAgIH07XG5cbiAgICAgICAgc2V0Qm91bmRzKGRvbSwgd2luZG93LmlubmVyV2lkdGggLyAyLCAwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgIHByZVNuYXBwZWQgPSBzbmFwcGVkO1xuICAgICAgICAvLyBoaW50SGlkZSgpO1xuICAgICAgICBkb20udHJpZ2dlcignbW92ZScsIHsgZmluaXNoOiB0cnVlLCBlbDogZG9tIH0pO1xuICAgICAgICBkb20udHJpZ2dlcigncmVzaXplJywgeyBmaW5pc2g6IHRydWUsIGVsOiBkb20gfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBkb207XG59XG4iLCIvKiBnbG9iYWwgTWVkaWFSZWNvcmRlclxuQXV0aG9yOiBCcmV0dCBDYW1wZXIgKEBwcm9mZXNzb3JsZW1lemEpXG5VUkw6IGh0dHBzOi8vZ2l0aHViLmNvbS90YW5ncmFtcy90YW5ncmFtL2Jsb2IvbWFzdGVyL3NyYy91dGlscy9tZWRpYV9jYXB0dXJlLmpzXG4qL1xuaW1wb3J0IHtjcmVhdGVPYmplY3RVUkx9IGZyb20gJy4vdXJscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lZGlhQ2FwdHVyZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucXVldWVTY3JlZW5zaG90ID0gbnVsbDtcbiAgICAgICAgdGhpcy52aWRlb0NhcHR1cmUgPSBudWxsO1xuICAgIH1cblxuICAgIHNldENhbnZhcyAoY2FudmFzKSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgIH1cblxuICAgIC8vIFRha2UgYSBzY3JlZW5zaG90LCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHNjcmVlbnNob3QgZGF0YSB3aGVuIGF2YWlsYWJsZVxuICAgIHNjcmVlbnNob3QgKCkge1xuICAgICAgICBpZiAodGhpcy5xdWV1ZVNjcmVlbnNob3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVldWVTY3JlZW5zaG90LnByb21pc2U7IC8vIG9ubHkgY2FwdHVyZSBvbmUgc2NyZWVuc2hvdCBhdCBhIHRpbWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdpbGwgcmVzb2x2ZSBvbmNlIHJlbmRlcmluZyBpcyBjb21wbGV0ZSBhbmQgcmVuZGVyIGJ1ZmZlciBpcyBjYXB0dXJlZFxuICAgICAgICB0aGlzLnF1ZXVlU2NyZWVuc2hvdCA9IHt9O1xuICAgICAgICB0aGlzLnF1ZXVlU2NyZWVuc2hvdC5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5xdWV1ZVNjcmVlbnNob3QucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlU2NyZWVuc2hvdC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZVNjcmVlbnNob3QucHJvbWlzZTtcbiAgICB9XG5cbiAgICAvLyBDYWxsZWQgYWZ0ZXIgcmVuZGVyaW5nLCBjYXB0dXJlcyByZW5kZXIgYnVmZmVyIGFuZCByZXNvbHZlcyBwcm9taXNlIHdpdGggdGhlIGltYWdlIGRhdGFcbiAgICBjb21wbGV0ZVNjcmVlbnNob3QgKCkge1xuICAgICAgICBpZiAodGhpcy5xdWV1ZVNjcmVlbnNob3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gR2V0IGRhdGEgVVJMLCBjb252ZXJ0IHRvIGJsb2JcbiAgICAgICAgICAgIC8vIFN0cmlwIGhvc3QvbWltZXR5cGUvZXRjLiwgY29udmVydCBiYXNlNjQgdG8gYmluYXJ5IHdpdGhvdXQgVVRGLTggbWFuZ2xpbmdcbiAgICAgICAgICAgIC8vIEFkYXB0ZWQgZnJvbTogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vdW5jb25lZC80MzcwODIyXG4gICAgICAgICAgICBjb25zdCB1cmwgPSB0aGlzLmNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3BuZycpO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF0b2IodXJsLnNsaWNlKDIyKSk7XG4gICAgICAgICAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJbaV0gPSBkYXRhLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2J1ZmZlcl0sIHsgdHlwZTogJ2ltYWdlL3BuZycgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlc29sdmUgd2l0aCBzY3JlZW5zaG90IGRhdGFcbiAgICAgICAgICAgIHRoaXMucXVldWVTY3JlZW5zaG90LnJlc29sdmUoeyB1cmwsIGJsb2IsIHR5cGU6ICdwbmcnIH0pO1xuICAgICAgICAgICAgdGhpcy5xdWV1ZVNjcmVlbnNob3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3RhcnRzIGNhcHR1cmluZyBhIHZpZGVvIHN0cmVhbSBmcm9tIHRoZSBjYW52YXNcbiAgICBzdGFydFZpZGVvQ2FwdHVyZSAoKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93Lk1lZGlhUmVjb3JkZXIgIT09ICdmdW5jdGlvbicgfHwgIXRoaXMuY2FudmFzIHx8IHR5cGVvZiB0aGlzLmNhbnZhcy5jYXB0dXJlU3RyZWFtICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnd2FybjogVmlkZW8gY2FwdHVyZSAoQ2FudmFzLmNhcHR1cmVTdHJlYW0gYW5kL29yIE1lZGlhUmVjb3JkZXIgQVBJcykgbm90IHN1cHBvcnRlZCBieSBicm93c2VyJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy52aWRlb0NhcHR1cmUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3YXJuOiBWaWRlbyBjYXB0dXJlIGFscmVhZHkgaW4gcHJvZ3Jlc3MsIGNhbGwgU2NlbmUuc3RvcFZpZGVvQ2FwdHVyZSgpIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdGFydCBhIG5ldyBjYXB0dXJlXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgY2FwID0gdGhpcy52aWRlb0NhcHR1cmUgPSB7fTtcbiAgICAgICAgICAgIGNhcC5jaHVua3MgPSBbXTtcbiAgICAgICAgICAgIGNhcC5zdHJlYW0gPSB0aGlzLmNhbnZhcy5jYXB0dXJlU3RyZWFtKCk7XG4gICAgICAgICAgICBjYXAub3B0aW9ucyA9IHsgbWltZVR5cGU6ICd2aWRlby93ZWJtJyB9OyAvLyBUT0RPOiBzdXBwb3J0IG90aGVyIGZvcm1hdCBvcHRpb25zXG4gICAgICAgICAgICBjYXAubWVkaWFSZWNvcmRlciA9IG5ldyBNZWRpYVJlY29yZGVyKGNhcC5zdHJlYW0sIGNhcC5vcHRpb25zKTtcbiAgICAgICAgICAgIGNhcC5tZWRpYVJlY29yZGVyLm9uZGF0YWF2YWlsYWJsZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5kYXRhLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhcC5jaHVua3MucHVzaChldmVudC5kYXRhKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTdG9wcGVkIHJlY29yZGluZz8gQ3JlYXRlIHRoZSBmaW5hbCBjYXB0dXJlIGZpbGUgYmxvYlxuICAgICAgICAgICAgICAgIGlmIChjYXAucmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYmxvYiA9IG5ldyBCbG9iKGNhcC5jaHVua3MsIHsgdHlwZTogY2FwLm9wdGlvbnMubWltZVR5cGUgfSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBjcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRXhwbGljaXRseSByZW1vdmUgYWxsIHN0cmVhbSB0cmFja3MsIGFuZCBzZXQgb2JqZWN0cyB0byBudWxsXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYXAuc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdHJhY2tzID0gY2FwLnN0cmVhbS5nZXRUcmFja3MoKSB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrcy5mb3JFYWNoKHRyYWNrID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FwLnN0cmVhbS5yZW1vdmVUcmFjayh0cmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXAuc3RyZWFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgY2FwLm1lZGlhUmVjb3JkZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZGVvQ2FwdHVyZSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FwLnJlc29sdmUoeyB1cmwsIGJsb2IsIHR5cGU6ICd3ZWJtJyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FwLm1lZGlhUmVjb3JkZXIuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy52aWRlb0NhcHR1cmUgPSBudWxsO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yOiBTY2VuZSB2aWRlbyBjYXB0dXJlIGZhaWxlZCcsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIFN0b3BzIGNhcHR1cmluZyBhIHZpZGVvIHN0cmVhbSBmcm9tIHRoZSBjYW52YXMsIHJldHVybnMgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgdmlkZW8gd2hlbiBhdmFpbGFibGVcbiAgICBzdG9wVmlkZW9DYXB0dXJlICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnZpZGVvQ2FwdHVyZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3dhcm46IE5vIHNjZW5lIHZpZGVvIGNhcHR1cmUgaW4gcHJvZ3Jlc3MsIGNhbGwgU2NlbmUuc3RhcnRWaWRlb0NhcHR1cmUoKSBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7fSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIHdoZW4gZmluYWwgc3RyZWFtIGlzIGF2YWlsYWJsZVxuICAgICAgICB0aGlzLnZpZGVvQ2FwdHVyZS5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52aWRlb0NhcHR1cmUucmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICB0aGlzLnZpZGVvQ2FwdHVyZS5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFN0b3AgcmVjb3JkaW5nXG4gICAgICAgIHRoaXMudmlkZW9DYXB0dXJlLm1lZGlhUmVjb3JkZXIuc3RvcCgpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnZpZGVvQ2FwdHVyZS5wcm9taXNlO1xuICAgIH1cbn1cbiIsIi8qXG5BZGQgZXZlbnRzIHRvIGEgY2xhc3Mgb3Igb2JqZWN0OlxuICAgIGNsYXNzIE15Q2xhc3Mge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZU1peGluKHRoaXMpOyAvLyBBZGQgdGhlIG1peGluZyBmdW5jdGlvbnMgdG8gdGhlIGNsYXNzXG4gICAgICAgICAgICAuLi5cbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignc29tZXRoaW5nJywgeyBvd25lcjogdGhpcywgY29udGVudDogJ3RoYXQnfSk7IC8vIHRyaWdnZXIgYW4gZXZlbnQgcGFzc2luZyBzb21lIGFyZ3VtZW50c1xuXG5TdWJzY3JpYmUgdG8gZXZlbnRzIGJ5IGRvaW5nOlxuICAgIG15Q2xhc3Mub24oJ3NvbWV0aGluZycsIChhcmdzKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3MpO1xuICAgIH0pO1xuXG5VbnN1YnNjcmliZSB0byBldmVudHMgYnkgZG9pbmc6XG4gICAgbXlDbGFzcy5vZmYoJ3NvbWV0aGluZycpO1xuXG5vciBtb3JlIHByZXNpY2VsbHk6XG4gICAgbXlDbGFzcy5vZmYoJ3NvbWV0aGluZycsIChhcmdzKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGFyZ3MpO1xuICAgIH0pO1xuXG5VbnN1YnNjcmliZSB0byBhbGwgZXZlbnRzIGJ5OlxuICAgIG15Q2xhc3Mub2ZmQWxsKCk7XG4qL1xuXG5leHBvcnQgZnVuY3Rpb24gc3Vic2NyaWJlTWl4aW4gKHRhcmdldCkge1xuICAgIHZhciBsaXN0ZW5lcnMgPSBuZXcgU2V0KCk7XG5cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih0YXJnZXQsIHtcblxuICAgICAgICBvbiAodHlwZSwgZikge1xuICAgICAgICAgICAgbGV0IGxpc3RlbmVyID0ge307XG4gICAgICAgICAgICBsaXN0ZW5lclt0eXBlXSA9IGY7XG4gICAgICAgICAgICBsaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcbiAgICAgICAgfSxcblxuICAgICAgICBvZmYgKHR5cGUsIGYpIHtcbiAgICAgICAgICAgIGlmIChmKSB7XG4gICAgICAgICAgICAgICAgbGV0IGxpc3RlbmVyID0ge307XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJbdHlwZV0gPSBmO1xuICAgICAgICAgICAgICAgIGxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBsaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSB0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzLmRlbGV0ZShpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgb2ZmQWxsICgpIHtcbiAgICAgICAgICAgIGxpc3RlbmVycy5jbGVhcigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRyaWdnZXIgKGV2ZW50LCAuLi5kYXRhKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBsaXN0ZW5lciBvZiBsaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyW2V2ZW50XSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcltldmVudF0oLi4uZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGxpc3RTdWJzY3JpcHRpb25zICgpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gb2YgbGlzdGVuZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsImxldCBfY3JlYXRlT2JqZWN0VVJMO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU9iamVjdFVSTCAodXJsKSB7XG4gICAgaWYgKF9jcmVhdGVPYmplY3RVUkwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBfY3JlYXRlT2JqZWN0VVJMID0gKHdpbmRvdy5VUkwgJiYgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwpIHx8ICh3aW5kb3cud2Via2l0VVJMICYmIHdpbmRvdy53ZWJraXRVUkwuY3JlYXRlT2JqZWN0VVJMKTtcbiAgICAgICAgaWYgKHR5cGVvZiBfY3JlYXRlT2JqZWN0VVJMICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBfY3JlYXRlT2JqZWN0VVJMID0gbnVsbDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTCAob3IgdmVuZG9yIHByZWZpeCkgbm90IGZvdW5kLCB1bmFibGUgdG8gY3JlYXRlIGxvY2FsIGJsb2IgVVJMcycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKF9jcmVhdGVPYmplY3RVUkwpIHtcbiAgICAgICAgcmV0dXJuIF9jcmVhdGVPYmplY3RVUkwodXJsKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB1cmw7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXJyb3JzRGlzcGxheSB7XG4gICAgY29uc3RydWN0b3IobWFpbikge1xuICAgICAgICB0aGlzLm1haW4gPSBtYWluO1xuXG4gICAgICAgIC8vICBwcml2YXRlIHZhcmlhYmxlc1xuICAgICAgICB0aGlzLndpZGdldHMgPSBbXTtcblxuICAgICAgICAvLyBFVkVOVFNcbiAgICAgICAgdGhpcy5tYWluLnNoYWRlci5jYW52YXMub24oJ2Vycm9yJywgKGFyZykgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlciAmJiB0aGlzLm1haW4udmlzdWFsRGVidWdnZXIudGVzdGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYW4oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEVycm9yKGFyZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubWFpbi5lZGl0b3Iub24oJ2NoYW5nZXMnLCAoY20sIGNoYW5nZXNPYmpzKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5tYWluLnNoYWRlci5jYW52YXMuaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2xlYW4oKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53aWRnZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLm1haW4uZWRpdG9yLnJlbW92ZUxpbmVXaWRnZXQodGhpcy53aWRnZXRzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndpZGdldHMubGVuZ3RoID0gMDtcbiAgICB9XG5cbiAgICBhZGRFcnJvcihhcmdzKSB7XG4gICAgICAgIGxldCByZSA9IC9FUlJPUjpcXHMrXFxkKzooXFxkKyk6XFxzKygnLiopL2c7XG4gICAgICAgIGxldCBtYXRjaGVzID0gcmUuZXhlYyhhcmdzLmVycm9yKTtcbiAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgIGxldCBsaW5lID0gcGFyc2VJbnQobWF0Y2hlc1sxXSkgLSAxO1xuICAgICAgICAgICAgbGV0IGVyID0gbWF0Y2hlc1syXTtcbiAgICAgICAgICAgIGxldCBtc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICAgICAgbGV0IGljb24gPSBtc2cuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpKTtcbiAgICAgICAgICAgIGljb24uY2xhc3NOYW1lID0gJ2dlLWVycm9yLWljb24nO1xuICAgICAgICAgICAgaWNvbi5pbm5lckhUTUwgPSAneCc7XG4gICAgICAgICAgICBtc2cuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZXIpKTtcbiAgICAgICAgICAgIG1zZy5jbGFzc05hbWUgPSAnZ2UtZXJyb3InO1xuICAgICAgICAgICAgdGhpcy53aWRnZXRzLnB1c2godGhpcy5tYWluLmVkaXRvci5hZGRMaW5lV2lkZ2V0KGxpbmUsIG1zZykpOy8vLCB7IGNvdmVyR3V0dGVyOiBmYWxzZSwgbm9IU2Nyb2xsOiB0cnVlIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBFeHBvcnRNb2RhbCBmcm9tICcuL21vZGFscy9FeHBvcnRNb2RhbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV4cG9ydEljb24ge1xuICAgIGNvbnN0cnVjdG9yIChtYWluKSB7XG4gICAgICAgIHRoaXMubWFpbiA9IG1haW47XG5cbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnZ2VfZXhwb3J0X2ljb24nKTtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSAn4pazJztcbiAgICAgICAgLy8gdGhpcy5lbC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPm1vcmVfdmVydDwvaT4nO1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAobWFpbi5jaGFuZ2UgfHwgIXRoaXMubW9kYWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsID0gbmV3IEV4cG9ydE1vZGFsKCdnZV9leHBvcnQnLCB7IG1haW46IG1haW4gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1vZGFsLnByZXNlbnRNb2RhbChldmVudC50YXJnZXQub2Zmc2V0TGVmdCwgZXZlbnQudGFyZ2V0Lm9mZnNldFRvcCk7XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIHRoaXMubWFpbi5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IENvbG9yUGlja2VyIGZyb20gJy4vcGlja2Vycy9Db2xvclBpY2tlcic7XG5pbXBvcnQgVmVjM1BpY2tlciBmcm9tICcuL3BpY2tlcnMvVmVjM1BpY2tlcic7XG5pbXBvcnQgVmVjMlBpY2tlciBmcm9tICcuL3BpY2tlcnMvVmVjMlBpY2tlcic7XG5pbXBvcnQgRmxvYXRQaWNrZXIgZnJvbSAnLi9waWNrZXJzL0Zsb2F0UGlja2VyJztcblxuaW1wb3J0IENvbG9yIGZyb20gJy4vcGlja2Vycy90eXBlcy9Db2xvcic7XG5cbmltcG9ydCBNb2RhbCBmcm9tICcuL21vZGFscy9Nb2RhbCc7XG5cbi8vIFJldHVybiBhbGwgcGF0dGVybiBtYXRjaGVzIHdpdGggY2FwdHVyZWQgZ3JvdXBzXG5SZWdFeHAucHJvdG90eXBlLmV4ZWNBbGwgPSBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICBsZXQgbWF0Y2ggPSBudWxsO1xuICAgIGxldCBtYXRjaGVzID0gW107XG4gICAgd2hpbGUgKG1hdGNoID0gdGhpcy5leGVjKHN0cmluZykpIHtcbiAgICAgICAgbGV0IG1hdGNoQXJyYXkgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSBpbiBtYXRjaCkge1xuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGkpID09IGkpIHtcbiAgICAgICAgICAgICAgICBtYXRjaEFycmF5LnB1c2gobWF0Y2hbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG1hdGNoQXJyYXkuaW5kZXggPSBtYXRjaC5pbmRleDtcbiAgICAgICAgbWF0Y2hlcy5wdXNoKG1hdGNoQXJyYXkpO1xuICAgIH1cbiAgICByZXR1cm4gbWF0Y2hlcztcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhlbHBlcnMge1xuICAgIGNvbnN0cnVjdG9yIChtYWluKSB7XG4gICAgICAgIHRoaXMubWFpbiA9IG1haW47XG4gICAgICAgIHRoaXMubWFpbi5kZWJ1Z2dpbmcgPSBmYWxzZTtcblxuICAgICAgICBsZXQgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShtYWluLmVkaXRvci5nZXRXcmFwcGVyRWxlbWVudCgpLCBudWxsKTtcbiAgICAgICAgbGV0IGJnQ29sb3IgPSBuZXcgQ29sb3Ioc3R5bGUuYmFja2dyb3VuZCAhPT0gJycgPyBzdHlsZS5iYWNrZ3JvdW5kIDogc3R5bGUuYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgbGV0IGZnQ29sb3IgPSBuZXcgQ29sb3Ioc3R5bGUuY29sb3IpO1xuXG4gICAgICAgIHRoaXMucHJvcGVydGllcyA9IHtcbiAgICAgICAgICAgIGJnQ29sb3I6IGJnQ29sb3IuZ2V0U3RyaW5nKCdyZ2InKSxcbiAgICAgICAgICAgIGZuQ29sb3I6IGZnQ29sb3IuZ2V0U3RyaW5nKCdyZ2InKSxcbiAgICAgICAgICAgIGRpbUNvbG9yOiAncmdiKDEyNywgMTI3LCAxMjcpJyxcbiAgICAgICAgICAgIHNlbENvbG9yOiAncmdiKDQwLCAxNjgsIDEwNyknLFxuICAgICAgICAgICAgbGlua0J1dHRvbjogdHJ1ZVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEVWRU5UU1xuICAgICAgICBsZXQgd3JhcHBlciA9IHRoaXMubWFpbi5lZGl0b3IuZ2V0V3JhcHBlckVsZW1lbnQoKTtcbiAgICAgICAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgbGV0IGN1cnNvciA9IHRoaXMubWFpbi5lZGl0b3IuZ2V0Q3Vyc29yKHRydWUpO1xuICAgICAgICAgICAgbGV0IHRva2VuID0gdGhpcy5tYWluLmVkaXRvci5nZXRUb2tlbkF0KGN1cnNvcik7XG4gICAgICAgICAgICBpZiAodG9rZW4udHlwZSA9PT0gJ3ZhcmlhYmxlJykge1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlci5kZWJ1Zyh0b2tlbi5zdHJpbmcsIGN1cnNvci5saW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbi51cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAvLyBiYWlsIG91dCBpZiB3ZSB3ZXJlIGRvaW5nIGEgc2VsZWN0aW9uIGFuZCBub3QgYSBjbGlja1xuICAgICAgICAgICAgaWYgKHRoaXMubWFpbi5lZGl0b3Iuc29tZXRoaW5nU2VsZWN0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGN1cnNvciA9IHRoaXMubWFpbi5lZGl0b3IuZ2V0Q3Vyc29yKHRydWUpO1xuXG4gICAgICAgICAgICAvLyBzZWUgaWYgdGhlcmUgaXMgYSBtYXRjaCBvbiB0aGUgY3Vyc29yIGNsaWNrXG4gICAgICAgICAgICBsZXQgbWF0Y2ggPSB0aGlzLmdldE1hdGNoKGN1cnNvcik7XG4gICAgICAgICAgICBsZXQgdG9rZW4gPSB0aGlzLm1haW4uZWRpdG9yLmdldFRva2VuQXQoY3Vyc29yKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlci5jbGVhbihldmVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWluLnVwZGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gVG9nZ2xlcyB0aGUgdHJhY2twYWQgdG8gYmUgb2ZmIGlmIGl0J3MgYWxyZWFkeSBwcmVzZW50LlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZU1vZGFsICYmIHRoaXMuYWN0aXZlTW9kYWwuaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwucmVtb3ZlTW9kYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChtYXRjaC50eXBlID09PSAnY29sb3InKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwgPSBuZXcgQ29sb3JQaWNrZXIobWF0Y2guc3RyaW5nLCB0aGlzLnByb3BlcnRpZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsLnNob3dBdCh0aGlzLm1haW4uZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbC5vbignY2hhbmdlZCcsIChjb2xvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld0NvbG9yID0gY29sb3IuZ2V0U3RyaW5nKCd2ZWMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydCA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBtYXRjaC5zdGFydCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZCA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBtYXRjaC5lbmQgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoLmVuZCA9IG1hdGNoLnN0YXJ0ICsgbmV3Q29sb3IubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYWluLmVkaXRvci5yZXBsYWNlUmFuZ2UobmV3Q29sb3IsIHN0YXJ0LCBlbmQsIGArJHttYXRjaC50eXBlfWApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsLm9uKCdsaW5rQnV0dG9uJywgKGNvbG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsID0gbmV3IFZlYzNQaWNrZXIoY29sb3IuZ2V0U3RyaW5nKCd2ZWMnKSwgdGhpcy5wcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwuc2hvd0F0KHRoaXMubWFpbi5lZGl0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbC5vbignY2hhbmdlZCcsIChkaXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3RGlyID0gZGlyLmdldFN0cmluZygndmVjMycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydCA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBtYXRjaC5zdGFydCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmQgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbWF0Y2guZW5kIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2guZW5kID0gbWF0Y2guc3RhcnQgKyBuZXdEaXIubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFpbi5lZGl0b3IucmVwbGFjZVJhbmdlKG5ld0Rpciwgc3RhcnQsIGVuZCwgYCske21hdGNoLnR5cGV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtYXRjaC50eXBlID09PSAndmVjMycpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbCA9IG5ldyBWZWMzUGlja2VyKG1hdGNoLnN0cmluZywgdGhpcy5wcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbC5zaG93QXQodGhpcy5tYWluLmVkaXRvcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwub24oJ2NoYW5nZWQnLCAoZGlyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3RGlyID0gZGlyLmdldFN0cmluZygndmVjMycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0ID0geyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IG1hdGNoLnN0YXJ0IH07XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kID0geyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IG1hdGNoLmVuZCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2guZW5kID0gbWF0Y2guc3RhcnQgKyBuZXdEaXIubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYWluLmVkaXRvci5yZXBsYWNlUmFuZ2UobmV3RGlyLCBzdGFydCwgZW5kLCBgKyR7bWF0Y2gudHlwZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1hdGNoLnR5cGUgPT09ICd2ZWMyJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsID0gbmV3IFZlYzJQaWNrZXIobWF0Y2guc3RyaW5nLCB0aGlzLnByb3BlcnRpZXMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsLnNob3dBdCh0aGlzLm1haW4uZWRpdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbC5vbignY2hhbmdlZCcsIChwb3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXdwb3MgPSBwb3MuZ2V0U3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnQgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbWF0Y2guc3RhcnQgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmQgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbWF0Y2guZW5kIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaC5lbmQgPSBtYXRjaC5zdGFydCArIG5ld3Bvcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1haW4uZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdwb3MsIHN0YXJ0LCBlbmQsIGArJHttYXRjaC50eXBlfWApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobWF0Y2gudHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVNb2RhbCA9IG5ldyBGbG9hdFBpY2tlcihtYXRjaC5zdHJpbmcsIHRoaXMucHJvcGVydGllcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwuc2hvd0F0KHRoaXMubWFpbi5lZGl0b3IpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsLm9uKCdjaGFuZ2VkJywgKG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld051bWJlciA9IG51bWJlci5nZXRTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydCA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBtYXRjaC5zdGFydCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZCA9IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBtYXRjaC5lbmQgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoLmVuZCA9IG1hdGNoLnN0YXJ0ICsgbmV3TnVtYmVyLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFpbi5lZGl0b3IucmVwbGFjZVJhbmdlKG5ld051bWJlciwgc3RhcnQsIGVuZCwgYCske21hdGNoLnR5cGV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubWFpbi5vcHRpb25zLnRvb2x0aXBzICYmICh0b2tlbi50eXBlID09PSAnYnVpbHRpbicgfHwgdG9rZW4udHlwZSA9PT0gJ3ZhcmlhYmxlLTMnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlci5jbGVhbihldmVudCk7XG4gICAgICAgICAgICAgICAgbGV0IGh0bWwgPSAnPHA+TGVhcm4gbW9yZSBhYm91dDogPGEgaHJlZj1cImh0dHBzOi8vdGhlYm9va29mc2hhZGVycy5jb20vZ2xvc3NhcnkvP3NlYXJjaD0nICsgdG9rZW4uc3RyaW5nICsgJ1wiIHRhcmdldD1cIl9ibGFua1wiPicgKyB0b2tlbi5zdHJpbmcgKyAnPC9hPjwvcD4nO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlTW9kYWwgPSBuZXcgTW9kYWwoJ2dlX3Rvb2x0aXAnLCB7IGlubmVySFRNTDogaHRtbCB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU1vZGFsLnNob3dBdCh0aGlzLm1haW4uZWRpdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRva2VuLnR5cGUgPT09ICd2YXJpYWJsZScpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYWluLnZpc3VhbERlYnVnZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlci5jbGVhbihldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFpbi52aXN1YWxEZWJ1Z2dlci5pbHVtaW5hdGUodG9rZW4uc3RyaW5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldE1hdGNoIChjdXJzb3IpIHtcbiAgICAgICAgbGV0IHR5cGVzID0gWydjb2xvcicsICd2ZWMzJyAsJ3ZlYzInLCAnbnVtYmVyJ107XG4gICAgICAgIGxldCBydGE7XG4gICAgICAgIGZvciAobGV0IGkgaW4gdHlwZXMpIHtcbiAgICAgICAgICAgIHJ0YSA9IHRoaXMuZ2V0VHlwZU1hdGNoKGN1cnNvciwgdHlwZXNbaV0pO1xuICAgICAgICAgICAgaWYgKHJ0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBydGE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGdldFR5cGVNYXRjaCAoY3Vyc29yLCB0eXBlKSB7XG4gICAgICAgIGlmICghdHlwZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZTtcbiAgICAgICAgc3dpdGNoKHR5cGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSAnY29sb3InOlxuICAgICAgICAgICAgICAgIHJlID0gL3ZlY1szfDRdXFwoW1xcZHwufCxcXHNdKlxcKS9nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndmVjMyc6XG4gICAgICAgICAgICAgICAgcmUgPSAvdmVjM1xcKFstfFxcZHwufCxcXHNdKlxcKS9nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndmVjMic6XG4gICAgICAgICAgICAgICAgcmUgPSAvdmVjMlxcKFstfFxcZHwufCxcXHNdKlxcKS9nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgICAgICByZSA9IC9bLV0/XFxkK1xcLlxcZCt8XFxkK1xcLnxcXC5cXGQrL2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ludmFsaWQgbWF0Y2ggc2VsZWN0aW9uJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBsaW5lID0gdGhpcy5tYWluLmVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcbiAgICAgICAgbGV0IG1hdGNoZXMgPSByZS5leGVjQWxsKGxpbmUpO1xuXG4gICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0gbWF0Y2hlc1tpXVswXTtcbiAgICAgICAgICAgICAgICBsZXQgbGVuID0gdmFsLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgc3RhcnQgPSBtYXRjaGVzW2ldLmluZGV4O1xuICAgICAgICAgICAgICAgIGxldCBlbmQgPSBtYXRjaGVzW2ldLmluZGV4ICsgbGVuO1xuICAgICAgICAgICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nOiB2YWxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbn1cbiIsImltcG9ydCBNZW51SXRlbSBmcm9tICcuL01lbnVJdGVtJztcbmltcG9ydCBFeHBvcnRNb2RhbCBmcm9tICcuL21vZGFscy9FeHBvcnRNb2RhbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbnUge1xuICAgIGNvbnN0cnVjdG9yIChtYWluKSB7XG4gICAgICAgIHRoaXMubWFpbiA9IG1haW47XG4gICAgICAgIHRoaXMubWVudXMgPSB7fTtcblxuICAgICAgICAvLyBDUkVBVEUgTUVOVSBDb250YWluZXJcbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICdnZV9tZW51X2JhcicpO1xuXG4gICAgICAgIC8vIE5FV1xuICAgICAgICB0aGlzLm1lbnVzLm5ldyA9IG5ldyBNZW51SXRlbSh0aGlzLmVsLCAnZ2VfbWVudScsICc8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+YWRkPC9pPiBOZXcnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIG1haW4ubmV3KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIE9QRU5cbiAgICAgICAgdGhpcy5maWxlSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICB0aGlzLmZpbGVJbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZmlsZScpO1xuICAgICAgICB0aGlzLmZpbGVJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FjY2VwdCcsICd0ZXh0L3gteWFtbCcpO1xuICAgICAgICB0aGlzLmZpbGVJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLmZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIG1haW4ub3BlbihldmVudC50YXJnZXQuZmlsZXNbMF0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5tZW51cy5vcGVuID0gbmV3IE1lbnVJdGVtKHRoaXMuZWwsICdnZV9tZW51JywgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5mb2xkZXJfb3BlbjwvaT4gIE9wZW4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmlsZUlucHV0LmNsaWNrKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHRoaXMubWVudXMuYXV0b3VwZGF0ZS5idXR0b24uc3R5bGUuY29sb3IgPSBtYWluLmF1dG91cGRhdGUgPyAnd2hpdGUnIDogJ2dyYXknO1xuXG4gICAgICAgIC8vIFRFU1RcbiAgICAgICAgdGhpcy5tZW51cy50ZXN0ID0gbmV3IE1lbnVJdGVtKHRoaXMuZWwsICdnZV9tZW51JywgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj50aW1lbGluZTwvaT4gVGVzdCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgbWFpbi52aXN1YWxEZWJ1Z2dlci5jaGVjaygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTSEFSRVxuICAgICAgICB0aGlzLm1lbnVzLnNoYXJlID0gbmV3IE1lbnVJdGVtKHRoaXMuZWwsICdnZV9tZW51JywgJzxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5hcnJvd191cHdhcmQ8L2k+IEV4cG9ydCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKG1haW4uY2hhbmdlIHx8ICF0aGlzLmV4cG9ydE1vZGFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leHBvcnRNb2RhbCA9IG5ldyBFeHBvcnRNb2RhbCgnZ2VfZXhwb3J0JywgeyBtYWluOiBtYWluLCBwb3NpdGlvbjogJ2ZpeGVkJyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGJib3ggPSB0aGlzLm1lbnVzLnNoYXJlLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5leHBvcnRNb2RhbC5wcmVzZW50TW9kYWwoYmJveC5sZWZ0IC0gNSwgYmJveC50b3AgKyBiYm94LmhlaWdodCArIDUpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgIC8vIEFVVE9VUERBVEVcbiAgICAgICAgdGhpcy5tZW51cy5hdXRvdXBkYXRlID0gbmV3IE1lbnVJdGVtKHRoaXMuZWwsICdnZV9tZW51JywgJyA8aSBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+YXV0b3JlbmV3PC9pPiBVcGRhdGU6IE9OJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAobWFpbi5hdXRvdXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgbWFpbi5hdXRvdXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51cy5hdXRvdXBkYXRlLm5hbWUgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmF1dG9yZW5ldzwvaT4gVXBkYXRlOiBPRkYnO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMubWVudXMuYXV0b3VwZGF0ZS5idXR0b24uc3R5bGUuY29sb3IgPSAnZ3JheSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYWluLmF1dG91cGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG1haW4udXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51cy5hdXRvdXBkYXRlLm5hbWUgPSAnPGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmF1dG9yZW5ldzwvaT4gVXBkYXRlOiBPTic7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5tZW51cy5hdXRvdXBkYXRlLmJ1dHRvbi5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1haW4uY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWwpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbnVJdGVtIHtcbiAgICBjb25zdHJ1Y3RvciAoY29udGFpbmVyLCBjbGFzc05hbWUsIG5hbWUsIG9uQ2xpY2spIHtcbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTmFtZSA9IGNsYXNzTmFtZSArICdfYnV0dG9uJztcbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmJ1dHRvbik7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsIGNsYXNzTmFtZSk7XG4gICAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IG5hbWU7XG4gICAgICAgIHRoaXMuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICAgICAgICB0aGlzLmhpZGRlbkNsYXNzID0gY2xhc3NOYW1lICsgJy0taGlkZGVuJztcblxuICAgICAgICAvLyBBdHRhY2ggbGlzdGVuZXJzLCBpbmNsdWRpbmcgdGhvc2UgZm9yIHRvb2x0aXAgYmVoYXZpb3JcbiAgICAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsaWNrLCB0cnVlKTtcblxuICAgICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXQgbmFtZSAobmFtZSkge1xuICAgICAgICB0aGlzLmJ1dHRvbi5pbm5lckhUTUwgPSBuYW1lO1xuICAgIH1cblxuICAgIGhpZGUgKCkge1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLmNsYXNzTmFtZSArICcgJyArIHRoaXMuaGlkZGVuQ2xhc3MpO1xuICAgIH1cblxuICAgIHNob3cgKCkge1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLmNsYXNzTmFtZSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgaXNDb21tZW50ZWQsIGlzTGluZUFmdGVyTWFpbiwgZ2V0VmFyaWFibGVUeXBlLCBnZXRTaGFkZXJGb3JUeXBlVmFySW5MaW5lLCBnZXRSZXN1bHRSYW5nZSwgZ2V0RGVsdGFTdW0sIGdldEhpdHMsIGdldE1lZGlhbiB9IGZyb20gJy4uL3Rvb2xzL2RlYnVnZ2luZyc7XG5pbXBvcnQgeyB1bmZvY3VzTGluZSwgZm9jdXNMaW5lLCB1bmZvY3VzQWxsLCBmb2N1c0FsbCB9IGZyb20gJy4uL2NvcmUvRWRpdG9yLmpzJztcblxudmFyIG1haW5HRSA9IHt9O1xudmFyIE5fU0FNUExFUyA9IDMwO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaXN1YWxEZWJ1Z2dlciB7XG4gICAgY29uc3RydWN0b3IgKG1haW4pIHtcbiAgICAgICAgdGhpcy5tYWluID0gbWFpbjtcbiAgICAgICAgdGhpcy5icmVha3BvaW50ID0gbnVsbDtcbiAgICAgICAgbWFpbkdFID0gbWFpbjtcblxuICAgICAgICB0aGlzLnRlc3RpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXN0aW5nRnJhZyA9ICcnO1xuICAgICAgICB0aGlzLnRlc3RpbmdMaW5lID0gMDtcbiAgICAgICAgdGhpcy50ZXN0aW5nUmVzdWx0cyA9IFtdO1xuICAgICAgICB0aGlzLnRlc3RpbmdTYW1wbGVzID0gW107XG5cbiAgICAgICAgdGhpcy5tYWluLmVkaXRvci5vbignZ3V0dGVyQ2xpY2snLCAoY20sIG4pID0+IHtcbiAgICAgICAgICAgIGxldCBpbmZvID0gY20ubGluZUluZm8obik7XG4gICAgICAgICAgICBpZiAoaW5mbyAmJiBpbmZvLmd1dHRlck1hcmtlcnMgJiYgaW5mby5ndXR0ZXJNYXJrZXJzLmJyZWFrcG9pbnRzKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGFuIGFjdGl2ZSB2YXJpYWJsZSAoYSB2YXJpYWJsZSB0aGF0IGhhdmUgYmVlbiBkZWNsYXJlIG9yIG1vZGlmeSBpbiB0aGlzIGxpbmUpXG4gICAgICAgICAgICAgICAgbGV0IHZhcmlhYmxlUkUgPSBuZXcgUmVnRXhwKCdcXFxccypbZmxvYXR8dmVjMnx2ZWMzfHZlYzRdP1xcXFxzKyhbXFxcXHd8XFxcXF9dKilbXFxcXC5cXFxcd10qP1xcXFxzK1tcXFxcK3xcXFxcLXxcXFxcXFxcXHxcXFxcKl0/XFxcXD0nLCAnaScpO1xuICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IHZhcmlhYmxlUkUuZXhlYyhpbmZvLnRleHQpO1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlYnVnKG1hdGNoWzFdLCBpbmZvLmxpbmUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyZWFrcG9pbnQgPSBpbmZvLmxpbmU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjaGVjaygpIHtcbiAgICAgICAgLy8gQ2xlYW4gcHJldml1cyByZWNvcmRzXG4gICAgICAgIHRoaXMudGVzdGluZ1Jlc3VsdHMgPSBbXTtcblxuICAgICAgICBsZXQgY20gPSB0aGlzLm1haW4uZWRpdG9yO1xuICAgICAgICBsZXQgbkxpbmVzID0gY20uZ2V0RG9jKCkuc2l6ZTtcblxuICAgICAgICBsZXQgbWFpblN0YXJ0c0F0ID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuTGluZXM7IGkrKykge1xuICAgICAgICAgICAgaWYgKGlzTGluZUFmdGVyTWFpbihjbSwgaSkpIHtcbiAgICAgICAgICAgICAgICBtYWluU3RhcnRzQXQgPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudGVzdExpbmUobWFpblN0YXJ0c0F0KTtcbiAgICB9XG5cbiAgICB0ZXN0TGluZShuTGluZSkge1xuICAgICAgICBsZXQgY20gPSBtYWluR0UuZWRpdG9yO1xuICAgICAgICBsZXQgdmlzdWFsRGVidWdnZXIgPSBtYWluR0UudmlzdWFsRGVidWdnZXI7XG5cbiAgICAgICAgLy8gSWYgaXMgZG9uZSB0ZXN0aW5nLi4uXG4gICAgICAgIGlmIChuTGluZSA+PSBjbS5nZXREb2MoKS5zaXplKSB7XG4gICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nTGluZSA9IDA7XG4gICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxldCByZXN1bHRzID0gdmlzdWFsRGVidWdnZXIudGVzdGluZ1Jlc3VsdHM7XG4gICAgICAgICAgICBsZXQgcmFuZ2UgPSBnZXRSZXN1bHRSYW5nZShyZXN1bHRzKTtcbiAgICAgICAgICAgIGxldCBzdW0gPSBnZXREZWx0YVN1bShyZXN1bHRzKTtcbiAgICAgICAgICAgIGxldCBoaXRzID0gZ2V0SGl0cyhyZXN1bHRzKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1Rlc3Q6ICcscmFuZ2UubWF4Lm1zICsgJ21zJywgcmVzdWx0cyk7XG4gICAgICAgICAgICBjbS5jbGVhckd1dHRlcignYnJlYWtwb2ludHMnKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gcmVzdWx0cykge1xuICAgICAgICAgICAgICAgIGxldCBwY3QgPSAocmVzdWx0c1tpXS5kZWx0YSAvIHN1bSkgKiAxMDA7XG4gICAgICAgICAgICAgICAgbGV0IHNpemUgPSAocmVzdWx0c1tpXS5kZWx0YSAvIHN1bSkgKiAzMDtcbiAgICAgICAgICAgICAgICBsZXQgbWFya2VySFRNTCA9ICc8ZGl2PicgKyByZXN1bHRzW2ldLm1zLnRvRml4ZWQoMik7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNbaV0uZGVsdGEgPiAwLikge1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJIVE1MICs9ICc8c3BhbiBjbGFzcz1cImdlX2Fzc2luZ19tYXJrZXJfcGN0ICc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwY3QgPiAoMTAwLjAgLyBoaXRzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VySFRNTCArPSAnZ2VfYXNzaW5nX21hcmtlcl9zbG93ZXInO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlckhUTUwgKz0gJ1wiIHN0eWxlPVwid2lkdGg6ICcgKyBzaXplLnRvRml4ZWQoMCkgKyAncHg7XCIgZGF0YT1cIicgKyBwY3QudG9GaXhlZCgwKSArICclXCI+PC9zcGFuPic7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY20uc2V0R3V0dGVyTWFya2VyKHJlc3VsdHNbaV0ubGluZSwgJ2JyZWFrcG9pbnRzJywgbWFrZU1hcmtlcihtYXJrZXJIVE1MICsgJzwvZGl2PicpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0xpbmVBZnRlck1haW4oY20sIG5MaW5lKSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGxpbmUgaXMgaW5zaWRlIHRoZSBtYWluIGZ1bmN0aW9uXG4gICAgICAgICAgICBsZXQgc2hhZGVyID0gbWFpbkdFLnNoYWRlci5jYW52YXM7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBhbiBhY3RpdmUgdmFyaWFibGUgKGEgdmFyaWFibGUgdGhhdCBoYXZlIGJlZW4gZGVjbGFyZSBvciBtb2RpZnkgaW4gdGhpcyBsaW5lKVxuICAgICAgICAgICAgbGV0IHZhcmlhYmxlUkUgPSBuZXcgUmVnRXhwKCdcXFxccypbZmxvYXR8dmVjMnx2ZWMzfHZlYzRdP1xcXFxzKyhbXFxcXHd8XFxcXF9dKilbXFxcXC5cXFxcd10qP1xcXFxzK1tcXFxcK3xcXFxcLXxcXFxcXFxcXHxcXFxcKl0/XFxcXD0nLCAnaScpO1xuICAgICAgICAgICAgbGV0IG1hdGNoID0gdmFyaWFibGVSRS5leGVjKGNtLmdldExpbmUobkxpbmUpKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGFjdGl2ZSB2YXJpYWJsZSwgZ2V0IHdoYXQgdHlwZSBpc1xuICAgICAgICAgICAgICAgIGxldCB2YXJpYWJsZSA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIGxldCB0eXBlID0gZ2V0VmFyaWFibGVUeXBlKGNtLCB2YXJpYWJsZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdub25lJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCBmYWlscyBvbiBmaW5kaW5nIHRoZSB0eXBlIGtlZXAgZ29pbmcgd2l0aCB0aGUgdGVzdCBvbiBhbm90aGVyIGxpbmVcbiAgICAgICAgICAgICAgICAgICAgdmlzdWFsRGVidWdnZXIudGVzdExpbmUobkxpbmUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFByZXBhcmVcbiAgICAgICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nTGluZSA9IG5MaW5lO1xuICAgICAgICAgICAgICAgIHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdGcmFnID0gZ2V0U2hhZGVyRm9yVHlwZVZhckluTGluZShjbSwgdHlwZSwgdmFyaWFibGUsIG5MaW5lKTtcbiAgICAgICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nU2FtcGxlcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgdW5mb2N1c0FsbChjbSk7XG4gICAgICAgICAgICAgICAgZm9jdXNMaW5lKGNtLCBuTGluZSk7XG4gICAgICAgICAgICAgICAgbWFpbkdFLmRlYnVnZ2luZyA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBzaGFkZXIudGVzdCh0aGlzLm9uVGVzdCwgdmlzdWFsRGVidWdnZXIudGVzdGluZ0ZyYWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlzdWFsRGVidWdnZXIudGVzdExpbmUobkxpbmUgKyAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIHRoZSBsaW5lIGlzIG5vdCBpbnNpZGUgbWFpbiBmdW5jdGlvbiwgdGVzdCB0aGUgbmV4dCBvbmUuLi5cbiAgICAgICAgICAgIHZpc3VhbERlYnVnZ2VyLnRlc3RMaW5lKG5MaW5lICsgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblRlc3QgKHRhcmdldCkge1xuICAgICAgICBsZXQgY20gPSBtYWluR0UuZWRpdG9yO1xuICAgICAgICBsZXQgc2hhZGVyID0gbWFpbkdFLnNoYWRlci5jYW52YXM7XG4gICAgICAgIGxldCB2aXN1YWxEZWJ1Z2dlciA9IG1haW5HRS52aXN1YWxEZWJ1Z2dlcjtcblxuICAgICAgICAvLyBJZiB0aGUgdGVzdCBzaGFkZXIgY29tcGlsZWQuLi5cbiAgICAgICAgaWYgKHRhcmdldC53YXNWYWxpZCkge1xuICAgICAgICAgICAgLy8gZ2V0IGRhdGEsIHByb2Nlc3MgYW5kIHN0b3JlLlxuICAgICAgICAgICAgbGV0IGVsYXBzZWRNcyA9IHRhcmdldC50aW1lRWxhcHNlZE1zO1xuXG4gICAgICAgICAgICBpZiAodmlzdWFsRGVidWdnZXIudGVzdGluZ1NhbXBsZXMubGVuZ3RoIDwgTl9TQU1QTEVTIC0gMSkge1xuICAgICAgICAgICAgICAgIHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdTYW1wbGVzLnB1c2goZWxhcHNlZE1zKTtcbiAgICAgICAgICAgICAgICBzaGFkZXIudGVzdCh2aXN1YWxEZWJ1Z2dlci5vblRlc3QsIHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdGcmFnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvY3VzQWxsKGNtKTtcbiAgICAgICAgICAgICAgICBtYWluR0UuZGVidWdnaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmlzdWFsRGVidWdnZXIudGVzdGluZ1NhbXBsZXMucHVzaChlbGFwc2VkTXMpO1xuICAgICAgICAgICAgICAgIGVsYXBzZWRNcyA9IGdldE1lZGlhbih2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nU2FtcGxlcyk7XG5cbiAgICAgICAgICAgICAgICBsZXQgcmFuZ2UgPSBnZXRSZXN1bHRSYW5nZSh2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nUmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgbGV0IGRlbHRhID0gZWxhcHNlZE1zIC0gcmFuZ2UubWF4Lm1zO1xuICAgICAgICAgICAgICAgIGlmICh2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nUmVzdWx0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsdGEgPSAwLjA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdSZXN1bHRzLnB1c2goe2xpbmU6dmlzdWFsRGVidWdnZXIudGVzdGluZ0xpbmUsIG1zOnRhcmdldC50aW1lRWxhcHNlZE1zLCBkZWx0YTpkZWx0YX0pO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdUZXN0aW5nIGxpbmU6JywgdmlzdWFsRGVidWdnZXIudGVzdGluZ0xpbmUsIGVsYXBzZWRNcywgZGVsdGEsIHJhbmdlKTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBndXR0ZXIgbWFya2VyXG4gICAgICAgICAgICAgICAgY20uc2V0R3V0dGVyTWFya2VyKHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdMaW5lLFxuICAgICAgICAgICAgICAgICAgICAnYnJlYWtwb2ludHMnLFxuICAgICAgICAgICAgICAgICAgICBtYWtlTWFya2VyKGVsYXBzZWRNcy50b0ZpeGVkKDIpKSk7XG5cbiAgICAgICAgICAgICAgICAvLyBUZXN0IG5leHQgbGluZVxuICAgICAgICAgICAgICAgIHZpc3VhbERlYnVnZ2VyLnRlc3RMaW5lKHZpc3VhbERlYnVnZ2VyLnRlc3RpbmdMaW5lICsgMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2codGFyZ2V0KTtcbiAgICAgICAgICAgIC8vIFRlc3QgbmV4dCBsaW5lXG4gICAgICAgICAgICB2aXN1YWxEZWJ1Z2dlci50ZXN0TGluZSh2aXN1YWxEZWJ1Z2dlci50ZXN0aW5nTGluZSArIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVidWcgKHZhcmlhYmxlLCBuTGluZSkge1xuICAgICAgICBmb2N1c0FsbCh0aGlzLm1haW4uZWRpdG9yKTtcbiAgICAgICAgdGhpcy5tYWluLmRlYnVnZ2luZyA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChpc0xpbmVBZnRlck1haW4odGhpcy5tYWluLmVkaXRvciwgbkxpbmUpKSB7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IGdldFZhcmlhYmxlVHlwZSh0aGlzLm1haW4uZWRpdG9yLCB2YXJpYWJsZSk7XG4gICAgICAgICAgICBpZiAodHlwZSAhPT0gJ25vbmUnKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1haW4uc2hhZGVyLmNhbnZhcy5sb2FkKGdldFNoYWRlckZvclR5cGVWYXJJbkxpbmUodGhpcy5tYWluLmVkaXRvciwgdHlwZSwgdmFyaWFibGUsIG5MaW5lKSk7XG4gICAgICAgICAgICAgICAgdW5mb2N1c0FsbCh0aGlzLm1haW4uZWRpdG9yKTtcbiAgICAgICAgICAgICAgICBmb2N1c0xpbmUodGhpcy5tYWluLmVkaXRvciwgbkxpbmUpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbi5kZWJ1Z2dpbmcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tYWluLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWx1bWluYXRlICh2YXJpYWJsZSkge1xuICAgICAgICBpZiAodGhpcy5tYWluLmRlYmJ1Z2luZyAmJiB0aGlzLnZhcmlhYmxlID09PSB0aGlzLnZhcmlhYmxlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcy5jbGVhbigpO1xuXG4gICAgICAgIGxldCBjbSA9IHRoaXMubWFpbi5lZGl0b3I7XG5cbiAgICAgICAgLy8gSGlnaGxpZ2h0IGFsbCBjYWxscyB0byBhIHZhcmlhYmxlXG4gICAgICAgIHRoaXMub3ZlcmxheSA9IHNlYXJjaE92ZXJsYXkodmFyaWFibGUsIHRydWUpO1xuICAgICAgICBjbS5hZGRPdmVybGF5KHRoaXMub3ZlcmxheSk7XG4gICAgICAgIGlmIChjbS5zaG93TWF0Y2hlc09uU2Nyb2xsYmFyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbm5vdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5ub3RhdGUuY2xlYXIoKTsgdGhpcy5hbm5vdGF0ZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmFubm90YXRlID0gY20uc2hvd01hdGNoZXNPblNjcm9sbGJhcih2YXJpYWJsZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjbGVhbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuY2xhc3NOYW1lID09PSAnZ2VfYXNzaW5nX21hcmtlcicpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjbSA9IHRoaXMubWFpbi5lZGl0b3I7XG4gICAgICAgIGNtLmNsZWFyR3V0dGVyKCdicmVha3BvaW50cycpO1xuICAgICAgICBpZiAodGhpcy5vdmVybGF5KSB7XG4gICAgICAgICAgICBjbS5yZW1vdmVPdmVybGF5KHRoaXMub3ZlcmxheSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50eXBlID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMubWFpbi5kZWJidWdpbmcpIHtcbiAgICAgICAgICAgIHRoaXMubWFpbi5zaGFkZXIuY2FudmFzLmxvYWQodGhpcy5tYWluLm9wdGlvbnMuZnJhZ19oZWFkZXIgKyB0aGlzLm1haW4uZWRpdG9yLmdldFZhbHVlKCkgKyB0aGlzLm1haW4ub3B0aW9ucy5mcmFnX2Zvb3Rlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tYWluLmRlYmJ1Z2luZyA9IGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbWFrZU1hcmtlcihodG1sLCBleHRyYUNsYXNzKSB7XG4gICAgbGV0IG1hcmtlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG1hcmtlci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2dlX2Fzc2luZ19tYXJrZXInKTtcbiAgICBtYXJrZXIuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbWFya2VyO1xufVxuXG5mdW5jdGlvbiBzZWFyY2hPdmVybGF5KHF1ZXJ5LCBjYXNlSW5zZW5zaXRpdmUpIHtcbiAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnc3RyaW5nJykge1xuICAgICAgICBxdWVyeSA9IG5ldyBSZWdFeHAocXVlcnkucmVwbGFjZSgvW1xcLVxcW1xcXVxcL1xce1xcfVxcKFxcKVxcKlxcK1xcP1xcLlxcXFxcXF5cXCRcXHxdL2csICdcXFxcJCYnKSwgY2FzZUluc2Vuc2l0aXZlID8gJ2dpJyA6ICdnJyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFxdWVyeS5nbG9iYWwpIHtcbiAgICAgICAgcXVlcnkgPSBuZXcgUmVnRXhwKHF1ZXJ5LnNvdXJjZSwgcXVlcnkuaWdub3JlQ2FzZSA/ICdnaScgOiAnZycpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHRva2VuOiBmdW5jdGlvbihzdHJlYW0pIHtcbiAgICAgICAgICAgIHF1ZXJ5Lmxhc3RJbmRleCA9IHN0cmVhbS5wb3M7XG4gICAgICAgICAgICB2YXIgbWF0Y2ggPSBxdWVyeS5leGVjKHN0cmVhbS5zdHJpbmcpO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoLmluZGV4ID09PSBzdHJlYW0ucG9zKSB7XG4gICAgICAgICAgICAgICAgc3RyZWFtLnBvcyArPSBtYXRjaFswXS5sZW5ndGggfHwgMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3NlYXJjaGluZyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIHN0cmVhbS5wb3MgPSBtYXRjaC5pbmRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0cmVhbS5za2lwVG9FbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4iLCJpbXBvcnQgTWVudUl0ZW0gZnJvbSAnLi4vTWVudUl0ZW0nO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4vTW9kYWwnO1xuaW1wb3J0IHsgc2F2ZU9uU2VydmVyLCBjcmVhdGVPcGVuRnJhbWVBcnR3b3JrIH0gZnJvbSAnLi4vLi4vaW8vc2hhcmUnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFeHBvcnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBjb25zdHJ1Y3RvciAoQ1NTX1BSRUZJWCwgcHJvcGVydGllcykge1xuICAgICAgICBzdXBlcihDU1NfUFJFRklYLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5tYWluID0gcHJvcGVydGllcy5tYWluO1xuXG4gICAgICAgIHRoaXMuc2F2ZSA9IG5ldyBNZW51SXRlbSh0aGlzLmVsLCAnZ2Vfc3ViX21lbnUnLCAnRG93bmxvYWQgZmlsZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgcHJvcGVydGllcy5tYWluLmRvd25sb2FkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY29kZVVSTCA9IG5ldyBNZW51SXRlbSh0aGlzLmVsLCAnZ2Vfc3ViX21lbnUnLCAnQ29kZSBVUkwuLi4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHNhdmVPblNlcnZlcih0aGlzLm1haW4sIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHByb21wdCgnVXNlIHRoaXMgdXJsIHRvIHNoYXJlIHlvdXIgY29kZScsICdodHRwOi8vdGhlYm9va29mc2hhZGVycy5jb20vZWRpdC5waHA/bG9nPScgKyBldmVudC5uYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZU1vZGFsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zaGFkZXJVUkwgPSBuZXcgTWVudUl0ZW0odGhpcy5lbCwgJ2dlX3N1Yl9tZW51JywgJ0FydHdvcmsgVVJMLi4uJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBzYXZlT25TZXJ2ZXIodGhpcy5tYWluLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBwcm9tcHQoJ1VzZSB0aGlzIHVybCB0byBzaGFyZSB5b3VyIGFydHdvcmsnLCAnaHR0cDovL3BsYXllci50aGVib29rb2ZzaGFkZXJzLmNvbS8/bG9nPScgKyBldmVudC5uYW1lKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZU1vZGFsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHNoYXJlT0YgPSBuZXcgTWVudUl0ZW0odGhpcy5lbCwgJ2dlX3N1Yl9tZW51JywgJ0FydHdvcmsgdG8gW29dJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBzaGFyZU9GLmVsLmlubmVySFRNTCA9ICdBcnR3b3JrIHRvIFtvXTogYWRkaW5nIHRvIGNvbGxlY3Rpb24nO1xuICAgICAgICAgICAgc2F2ZU9uU2VydmVyKHRoaXMubWFpbiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY3JlYXRlT3BlbkZyYW1lQXJ0d29yayh0aGlzLm1haW4sIGV2ZW50Lm5hbWUsIGV2ZW50LnVybCwgKHN1Y2Nlc3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlT0YuZWwuaW5uZXJIVE1MID0gJ0FydHdvcmsgdG8gW29dOiBhZGRlZCEnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVPRi5lbC5pbm5lckhUTUwgPSAnQXJ0d29yayB0byBbb106IGZhaWxlZCA6KCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZU9GLmVsLmlubmVySFRNTCA9ICdbb10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVNb2RhbCgpO1xuICAgICAgICAgICAgICAgICAgICB9LCA0MDAwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBzdWJzY3JpYmVNaXhpbiB9IGZyb20gJy4uLy4uL3Rvb2xzL21peGluJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWwge1xuICAgIGNvbnN0cnVjdG9yIChDU1NfUFJFRklYLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1YnNjcmliZU1peGluKHRoaXMpO1xuICAgICAgICB0aGlzLkNTU19QUkVGSVggPSBDU1NfUFJFRklYO1xuXG4gICAgICAgIHByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzIHx8IHt9O1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIHRoaXNbcHJvcF0gPSBwcm9wZXJ0aWVzW3Byb3BdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdfbW9kYWwgZ2VfbW9kYWwnO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuYmdDb2xvcjtcbiAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLmlubmVySFRNTCB8fCAnJztcblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50cykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgY2xvc2UgKCkge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ2Nsb3NlJyk7XG4gICAgfVxuXG4gICAgc2hvd0F0IChjbSkge1xuICAgICAgICBsZXQgY3Vyc29yID0gY20uY3Vyc29yQ29vcmRzKHRydWUsICdwYWdlJyk7XG4gICAgICAgIGxldCB4ID0gY3Vyc29yLmxlZnQ7XG4gICAgICAgIGxldCB5ID0gY3Vyc29yLnRvcDtcblxuICAgICAgICB5ICs9IDMwO1xuXG4gICAgICAgIHRoaXMucHJlc2VudE1vZGFsKHgsIHkpO1xuICAgIH1cblxuICAgIHByZXNlbnRNb2RhbCAoeCwgeSkge1xuICAgICAgICAvLyBMaXN0ZW4gZm9yIGludGVyYWN0aW9uIG91dHNpZGUgb2YgdGhlIG1vZGFsXG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DbGlja091dHNpZGVIYW5kbGVyID0gYWRkRXZlbnQoZG9jdW1lbnQuYm9keSwgJ2NsaWNrJywgdGhpcy5vbkNsaWNrT3V0c2lkZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLm9uS2V5UHJlc3NIYW5kbGVyID0gYWRkRXZlbnQod2luZG93LCAna2V5ZG93bicsIHRoaXMub25LZXlQcmVzcywgdGhpcyk7XG4gICAgICAgIH0sIDApO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS5sZWZ0ID0geCArICdweCc7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0geSArICdweCc7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCArICdweCc7XG5cbiAgICAgICAgaWYgKHRoaXMucG9zaXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmVsKTtcblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ3Nob3cnKTtcbiAgICB9XG5cbiAgICBnZXRNb2RhbENsYXNzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5DU1NfUFJFRklYICsgJ21vZGFsJztcbiAgICB9XG5cbiAgICBvbktleVByZXNzIChldmVudCkge1xuICAgICAgICB0aGlzLnJlbW92ZU1vZGFsKCk7XG4gICAgfVxuXG4gICAgb25DbGlja091dHNpZGUgKGV2ZW50KSB7XG4gICAgICAgIC8vIEhBQ0tZISFcbiAgICAgICAgLy8gQSBjbGljayBldmVudCBmaXJlcyBvbiB0aGUgYm9keSBhZnRlciBtb3VzZWRvd24gLSBtb3VzZW1vdmUsIHNpbXVsdGFuZW91c2x5IHdpdGhcbiAgICAgICAgLy8gbW91c2V1cC4gU28gaWYgc29tZW9uZSBzdGFydGVkIGEgbW91c2UgYWN0aW9uIGluc2lkZSB0aGUgbW9kYWwgYW5kIHRoZW5cbiAgICAgICAgLy8gbW91c2V1cCdkIG91dHNpZGUgb2YgaXQsIGl0IGZpcmVzIGEgY2xpY2sgZXZlbnQgb24gdGhlIGJvZHksIHRodXMsIGNhdXNpbmcgdGhlXG4gICAgICAgIC8vIG1vZGFsIHRvIGRpc2FwcGVhciB3aGVuIHRoZSB1c2VyIGRvZXMgbm90IGV4cGVjdCBpdCB0bywgc2luY2UgdGhlIG1vdXNlIGRvd24gZXZlbnRcbiAgICAgICAgLy8gZGlkIG5vdCBzdGFydCBvdXRzaWRlIHRoZSBtb2RhbC5cbiAgICAgICAgLy8gVGhlcmUgbWlnaHQgYmUgKG9yIHNob3VsZCBiZSkgYSBiZXR0ZXIgd2F5IHRvIHRyYWNrIHRoaXMsIGJ1dCByaWdodCBub3csIGp1c3QgY2FuY2VsXG4gICAgICAgIC8vIHRoZSBldmVudCBpZiB0aGUgdGFyZ2V0IGVuZHMgdXAgYmVpbmcgb24gdGhlIGJvZHkgZGlyZWN0bHkgcmF0aGVyIHRoYW4gb24gb25lIG9mIHRoZVxuICAgICAgICAvLyBvdGhlciBjaGlsZCBlbGVtZW50cy5cbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVuZCB0aGlzIHNwZWNpZmljIGhhY2t5IHBhcnRcbiAgICAgICAgbGV0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgd2hpbGUgKHRhcmdldCAhPT0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmICF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMuZ2V0TW9kYWxDbGFzcygpKSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5nZXRNb2RhbENsYXNzKCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVNb2RhbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIFJlbW92ZXMgbW9kYWwgZnJvbSBET00gYW5kIGRlc3Ryb3lzIHJlbGF0ZWQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICovXG4gICAgcmVtb3ZlTW9kYWwgKCkge1xuICAgICAgICBpZiAodGhpcy5lbCAmJiB0aGlzLmVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVFdmVudChkb2N1bWVudC5ib2R5LCAnY2xpY2snLCB0aGlzLm9uQ2xpY2tPdXRzaWRlSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25DbGlja091dHNpZGVIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgcmVtb3ZlRXZlbnQod2luZG93LCAna2V5ZG93bicsIHRoaXMub25LZXlQcmVzc0hhbmRsZXIpO1xuICAgICAgICB0aGlzLm9uS2V5UHJlc3NIYW5kbGVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgfVxufVxuXG4vKiBFdmVudCBoYW5kbGluZyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZEV2ZW50IChlbGVtZW50LCBldmVudCwgY2FsbGJhY2ssIGNhbGxlcikge1xuICAgIGxldCBoYW5kbGVyO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoY2FsbGVyLCBlKTtcbiAgICB9LCBmYWxzZSk7XG4gICAgcmV0dXJuIGhhbmRsZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFdmVudCAoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBjYWxsYmFjaywgZmFsc2UpO1xufVxuIiwiLypcbk9yaWdpbmFsOiBodHRwczovL2dpdGh1Yi5jb20vdGFuZ3JhbXMvdGFuZ3JhbS1wbGF5L2Jsb2IvZ2gtcGFnZXMvc3JjL2pzL2FkZG9ucy91aS93aWRnZXRzL0NvbG9yUGlja2VyTW9kYWwuanNcbkF1dGhvcjogTG91IEh1YW5nIChAc2Fpa29maXNoKVxuKi9cblxuaW1wb3J0IFBpY2tlciBmcm9tICcuL1BpY2tlcic7XG5pbXBvcnQgQ29sb3IgZnJvbSAnLi90eXBlcy9Db2xvcic7XG5pbXBvcnQgeyBhZGRFdmVudCwgcmVtb3ZlRXZlbnQgfSBmcm9tICcuL1BpY2tlcic7XG5pbXBvcnQgeyBnZXREZXZpY2VQaXhlbFJhdGlvIH0gZnJvbSAnLi4vLi4vdG9vbHMvY29tbW9uJztcblxuaW1wb3J0IHsgc3Vic2NyaWJlSW50ZXJhY3RpdmVEb20gfSBmcm9tICcuLi8uLi90b29scy9pbnRlcmFjdGl2ZURvbSc7XG5cbi8vIFNvbWUgY29tbW9uIHVzZSB2YXJpYWJsZXNcbmxldCBjdXJyZW50VGFyZ2V0O1xubGV0IGN1cnJlbnRUYXJnZXRIZWlnaHQgPSAwO1xubGV0IGRvbUNhY2hlO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb2xvclBpY2tlciBleHRlbmRzIFBpY2tlciB7XG4gICAgY29uc3RydWN0b3IgKGNvbG9yID0gJ3ZlYzMoMS4wLDAuMCwwLjApJywgcHJvcGVydGllcyA9IHt9KSB7XG4gICAgICAgIHN1cGVyKCdnZV9jb2xvcnBpY2tlcl8nLCBwcm9wZXJ0aWVzKTtcblxuICAgICAgICB0aGlzLndpZHRoID0gMjUwOyAvLyBpbiBwaXhlbHNcbiAgICAgICAgdGhpcy5oZWlnaHQgPSAyNTA7IC8vIGluIHBpeGVsc1xuXG4gICAgICAgIHRoaXMuZGlzYyA9IHsgd2lkdGg6IDIwMCwgaGVpZ2h0OiAyMDAgfTtcbiAgICAgICAgdGhpcy5iYXJsdW0gPSB7IHdpZHRoOiAyNSwgaGVpZ2h0OiAyMDAgfTtcblxuICAgICAgICB0aGlzLnNldFZhbHVlKGNvbG9yKTtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgaWYgKCFkb21DYWNoZSkge1xuICAgICAgICAgICAgbGV0IG1vZGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBsZXQgcGF0Y2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxldCBtYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxldCBkaXNjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICBsZXQgY292ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxldCBjdXJzb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxldCBiYXJiZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgbGV0IGJhcndoaXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBsZXQgYmFybHVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgICBsZXQgYmFyY3Vyc29ycyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgbGV0IGxlZnRjdXJzb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxldCByaWdodGN1cnNvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgICAgICBtb2RhbC5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnbW9kYWwgZ2VfcGlja2VyX21vZGFsJztcbiAgICAgICAgICAgIG1vZGFsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuYmdDb2xvcjtcbiAgICAgICAgICAgIHBhdGNoLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdwYXRjaCc7XG4gICAgICAgICAgICBwYXRjaC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmJnQ29sb3I7XG4gICAgICAgICAgICBtYXAuY2xhc3NOYW1lID0gdGhpcy5DU1NfUFJFRklYICsgJ2hzdi1tYXAnO1xuICAgICAgICAgICAgZGlzYy5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnZGlzYyc7XG4gICAgICAgICAgICBkaXNjLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuYmdDb2xvcjtcbiAgICAgICAgICAgIGNvdmVyLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdkaXNjLWNvdmVyJztcbiAgICAgICAgICAgIGN1cnNvci5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnZGlzYy1jdXJzb3InO1xuICAgICAgICAgICAgYmFyYmcuY2xhc3NOYW1lID0gdGhpcy5DU1NfUFJFRklYICsgJ2Jhci1iZyc7XG4gICAgICAgICAgICBiYXJ3aGl0ZS5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnYmFyLXdoaXRlJztcbiAgICAgICAgICAgIGJhcmx1bS5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnYmFyLWx1bWluYW5jZSc7XG4gICAgICAgICAgICBiYXJjdXJzb3JzLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdiYXItY3Vyc29ycyc7XG4gICAgICAgICAgICBsZWZ0Y3Vyc29yLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdiYXItY3Vyc29yLWxlZnQnO1xuICAgICAgICAgICAgcmlnaHRjdXJzb3IuY2xhc3NOYW1lID0gdGhpcy5DU1NfUFJFRklYICsgJ2Jhci1jdXJzb3ItcmlnaHQnO1xuXG4gICAgICAgICAgICBtYXAuaWQgPSAnY3AtbWFwJztcbiAgICAgICAgICAgIGJhcmN1cnNvcnMuaWQgPSAnY3AtYmFyJztcblxuICAgICAgICAgICAgbW9kYWwuYXBwZW5kQ2hpbGQocGF0Y2gpO1xuICAgICAgICAgICAgbW9kYWwuYXBwZW5kQ2hpbGQobWFwKTtcblxuICAgICAgICAgICAgbWFwLmFwcGVuZENoaWxkKGRpc2MpO1xuICAgICAgICAgICAgbWFwLmFwcGVuZENoaWxkKGNvdmVyKTtcbiAgICAgICAgICAgIG1hcC5hcHBlbmRDaGlsZChjdXJzb3IpO1xuICAgICAgICAgICAgbWFwLmFwcGVuZENoaWxkKGJhcmJnKTtcbiAgICAgICAgICAgIG1hcC5hcHBlbmRDaGlsZChiYXJ3aGl0ZSk7XG4gICAgICAgICAgICBtYXAuYXBwZW5kQ2hpbGQoYmFybHVtKTtcbiAgICAgICAgICAgIG1hcC5hcHBlbmRDaGlsZChiYXJjdXJzb3JzKTtcbiAgICAgICAgICAgIGJhcmN1cnNvcnMuYXBwZW5kQ2hpbGQobGVmdGN1cnNvcik7XG4gICAgICAgICAgICBiYXJjdXJzb3JzLmFwcGVuZENoaWxkKHJpZ2h0Y3Vyc29yKTtcblxuICAgICAgICAgICAgZG9tQ2FjaGUgPSBtb2RhbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgY2FjaGVkIGRvY3VtZW50IGZyYWdtZW50XG4gICAgICAgIHRoaXMuZWwgPSBkb21DYWNoZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHN1YnNjcmliZUludGVyYWN0aXZlRG9tKHRoaXMuZWwsIHsgbW92ZTogdHJ1ZSwgcmVzaXplOiBmYWxzZSwgc25hcDogZmFsc2UgfSk7XG5cbiAgICAgICAgLy8gVE9ETzogSW1wcm92ZSB0aGVzZSByZWZlcmVuY2VzXG4gICAgICAgIC8vIFRoZSBjYWNoaW5nIG9mIHJlZmVyZW5jZXMgaXMgbGlrZWx5IHRvIGJlIGltcG9ydGFudCBmb3Igc3BlZWRcbiAgICAgICAgdGhpcy5kb20gPSB7fTtcbiAgICAgICAgdGhpcy5kb20uaHN2TWFwID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuZ2VfY29sb3JwaWNrZXJfaHN2LW1hcCcpO1xuICAgICAgICB0aGlzLmRvbS5oc3ZNYXBDb3ZlciA9IHRoaXMuZG9tLmhzdk1hcC5jaGlsZHJlblsxXTsgLy8gd2VsbC4uLlxuICAgICAgICB0aGlzLmRvbS5oc3ZNYXBDdXJzb3IgPSB0aGlzLmRvbS5oc3ZNYXAuY2hpbGRyZW5bMl07XG4gICAgICAgIHRoaXMuZG9tLmhzdkJhckJHTGF5ZXIgPSB0aGlzLmRvbS5oc3ZNYXAuY2hpbGRyZW5bM107XG4gICAgICAgIHRoaXMuZG9tLmhzdkJhcldoaXRlTGF5ZXIgPSB0aGlzLmRvbS5oc3ZNYXAuY2hpbGRyZW5bNF07XG4gICAgICAgIHRoaXMuZG9tLmhzdkJhckN1cnNvcnMgPSB0aGlzLmRvbS5oc3ZNYXAuY2hpbGRyZW5bNl07XG4gICAgICAgIHRoaXMuZG9tLmhzdkxlZnRDdXJzb3IgPSB0aGlzLmRvbS5oc3ZCYXJDdXJzb3JzLmNoaWxkcmVuWzBdO1xuICAgICAgICB0aGlzLmRvbS5oc3ZSaWdodEN1cnNvciA9IHRoaXMuZG9tLmhzdkJhckN1cnNvcnMuY2hpbGRyZW5bMV07XG5cbiAgICAgICAgdGhpcy5kb20uY29sb3JEaXNjID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuZ2VfY29sb3JwaWNrZXJfZGlzYycpO1xuICAgICAgICB0aGlzLmRvbS5sdW1pbmFuY2VCYXIgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5nZV9jb2xvcnBpY2tlcl9iYXItbHVtaW5hbmNlJyk7XG5cbiAgICAgICAgaWYgKHRoaXMubGlua0J1dHRvbikge1xuICAgICAgICAgICAgbGV0IGxidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGxidXR0b24uaW5uZXJIVE1MID0gJysnO1xuICAgICAgICAgICAgbGJ1dHRvbi5jbGFzc05hbWUgPSB0aGlzLkNTU19QUkVGSVggKyAnbGluay1idXR0b24nO1xuICAgICAgICAgICAgbGJ1dHRvbi5zdHlsZS5jb2xvciA9IHRoaXMuZmdDb2xvcjtcbiAgICAgICAgICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQobGJ1dHRvbik7XG5cbiAgICAgICAgICAgIGxidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdsaW5rQnV0dG9uJywgdGhpcy52YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmxpbmtCdXR0b24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5rQnV0dG9uKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZU1vZGFsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXcgKCkge1xuICAgICAgICAvLyAgUmVuZGVyIGNvbG9yIHBhdGNoXG4gICAgICAgIGxldCBwYXRjaCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLmdlX2NvbG9ycGlja2VyX3BhdGNoJyk7XG4gICAgICAgIHBhdGNoLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMudmFsdWUuZ2V0U3RyaW5nKCdyZ2InKTtcblxuICAgICAgICAvLyAgUmVuZGVyIEhTViBwaWNrZXJcbiAgICAgICAgbGV0IGNvbG9yID0gdGhpcy52YWx1ZS5jb2xvcnM7XG4gICAgICAgIGxldCBjb2xvckRpc2NSYWRpdXMgPSB0aGlzLmRvbS5jb2xvckRpc2Mub2Zmc2V0SGVpZ2h0IC8gMjtcbiAgICAgICAgbGV0IHBpMiA9IE1hdGguUEkgKiAyO1xuICAgICAgICBsZXQgeCA9IE1hdGguY29zKHBpMiAtIGNvbG9yLmhzdi5oICogcGkyKTtcbiAgICAgICAgbGV0IHkgPSBNYXRoLnNpbihwaTIgLSBjb2xvci5oc3YuaCAqIHBpMik7XG4gICAgICAgIGxldCByID0gY29sb3IuaHN2LnMgKiAoY29sb3JEaXNjUmFkaXVzIC0gNSk7XG5cbiAgICAgICAgdGhpcy5kb20uaHN2TWFwQ292ZXIuc3R5bGUub3BhY2l0eSA9IDEgLSBjb2xvci5oc3YudiAvIDI1NTtcbiAgICAgICAgLy8gdGhpcyBpcyB0aGUgZmFzdGVyIHZlcnNpb24uLi5cbiAgICAgICAgdGhpcy5kb20uaHN2QmFyV2hpdGVMYXllci5zdHlsZS5vcGFjaXR5ID0gMSAtIGNvbG9yLmhzdi5zO1xuICAgICAgICB0aGlzLmRvbS5oc3ZCYXJCR0xheWVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoJyArXG4gICAgICAgICAgICBjb2xvci5odWVSR0IuciArICcsJyArXG4gICAgICAgICAgICBjb2xvci5odWVSR0IuZyArICcsJyArXG4gICAgICAgICAgICBjb2xvci5odWVSR0IuYiArICcpJztcblxuICAgICAgICB0aGlzLmRvbS5oc3ZNYXBDdXJzb3Iuc3R5bGUuY3NzVGV4dCA9XG4gICAgICAgICAgICAnbGVmdDogJyArICh4ICogciArIGNvbG9yRGlzY1JhZGl1cykgKyAncHg7JyArXG4gICAgICAgICAgICAndG9wOiAnICsgKHkgKiByICsgY29sb3JEaXNjUmFkaXVzKSArICdweDsnICtcbiAgICAgICAgICAgICdib3JkZXItY29sb3I6ICcgKyAoY29sb3IubHVtaW5hbmNlID4gMC4yMiA/ICcjMzMzOycgOiAnI2RkZCcpO1xuXG4gICAgICAgIGlmIChjb2xvci5sdW1pbmFuY2UgPiAwLjIyKSB7XG4gICAgICAgICAgICB0aGlzLmRvbS5oc3ZCYXJDdXJzb3JzLmNsYXNzTGlzdC5hZGQoJ2dlX2NvbG9ycGlja2VyX2RhcmsnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZG9tLmhzdkJhckN1cnNvcnMuY2xhc3NMaXN0LnJlbW92ZSgnZ2VfY29sb3JwaWNrZXJfZGFyaycpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZG9tLmhzdkxlZnRDdXJzb3IpIHtcbiAgICAgICAgICAgIHRoaXMuZG9tLmhzdkxlZnRDdXJzb3Iuc3R5bGUudG9wID0gdGhpcy5kb20uaHN2UmlnaHRDdXJzb3Iuc3R5bGUudG9wID0gKCgxIC0gY29sb3IuaHN2LnYgLyAyNTUpICogY29sb3JEaXNjUmFkaXVzICogMikgKyAncHgnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJlc2VudE1vZGFsICh4LCB5KSB7XG4gICAgICAgIHN1cGVyLnByZXNlbnRNb2RhbCh4LCB5KTtcblxuICAgICAgICAvLyAvLyBMaXN0ZW4gZm9yIGludGVyYWN0aW9uIG9uIHRoZSBIU1YgbWFwXG4gICAgICAgIHRoaXMub25Ic3ZEb3duSGFuZGxlciA9IGFkZEV2ZW50KHRoaXMuZG9tLmhzdk1hcCwgJ21vdXNlZG93bicsIHRoaXMub25Ic3ZEb3duLCB0aGlzKTtcblxuICAgICAgICBsZXQgY29sb3JEaXNjID0gdGhpcy5kb20uY29sb3JEaXNjO1xuXG4gICAgICAgIGlmIChjb2xvckRpc2MuZ2V0Q29udGV4dCkge1xuICAgICAgICAgICAgLy8gSFNWIGNvbG9yIHdoZWVsIHdpdGggd2hpdGUgY2VudGVyXG4gICAgICAgICAgICBsZXQgZGlza0NvbnRleHQgPSBjb2xvckRpc2MuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICAgIGxldCByYXRpbyA9IGdldERldmljZVBpeGVsUmF0aW8oZGlza0NvbnRleHQpO1xuICAgICAgICAgICAgbGV0IHdpZHRoID0gdGhpcy5kaXNjLndpZHRoIC8gcmF0aW87XG4gICAgICAgICAgICBsZXQgaGVpZ2h0ID0gdGhpcy5kaXNjLmhlaWdodCAvIHJhdGlvO1xuICAgICAgICAgICAgdGhpcy5kb20uY29sb3JEaXNjLndpZHRoID0gd2lkdGggKiByYXRpbztcbiAgICAgICAgICAgIHRoaXMuZG9tLmNvbG9yRGlzYy5oZWlnaHQgPSBoZWlnaHQgKiByYXRpbztcbiAgICAgICAgICAgIGRpc2tDb250ZXh0LnNjYWxlKHJhdGlvLCByYXRpbyk7XG5cbiAgICAgICAgICAgIGRyYXdEaXNrKFxuICAgICAgICAgICAgICAgIGRpc2tDb250ZXh0LFxuICAgICAgICAgICAgICAgIFt3aWR0aCAvIDIsIGhlaWdodCAvIDJdLFxuICAgICAgICAgICAgICAgIFt3aWR0aCAvIDIgLSAxLCBoZWlnaHQgLyAyIC0gMV0sXG4gICAgICAgICAgICAgICAgMzYwLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChjdHgsIGFuZ2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBncmFkaWVudCA9IGN0eC5jcmVhdGVSYWRpYWxHcmFkaWVudCgxLCAxLCAxLCAxLCAxLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsICdoc2woJyArICgzNjAgLSBhbmdsZSArIDApICsgJywgMTAwJSwgNTAlKScpO1xuICAgICAgICAgICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMSwgJyNmZmYnKTtcblxuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZ3JhZGllbnQ7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gZ3JheSBib3JkZXJcbiAgICAgICAgICAgIGRyYXdDaXJjbGUoXG4gICAgICAgICAgICAgICAgZGlza0NvbnRleHQsXG4gICAgICAgICAgICAgICAgW3dpZHRoIC8gMiwgaGVpZ2h0IC8gMl0sXG4gICAgICAgICAgICAgICAgW3dpZHRoIC8gMiwgaGVpZ2h0IC8gMl0sXG4gICAgICAgICAgICAgICAgdGhpcy5iZ0NvbG9yLC8vICcjMzAzMDMwJyxcbiAgICAgICAgICAgICAgICAyIC8gcmF0aW9cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIGx1bWluYW5jZUJhciBiYXJcbiAgICAgICAgICAgIGxldCBjdHggPSB0aGlzLmRvbS5sdW1pbmFuY2VCYXIuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICAgIHRoaXMuZG9tLmx1bWluYW5jZUJhci53aWR0aCA9IHRoaXMuYmFybHVtLndpZHRoO1xuICAgICAgICAgICAgdGhpcy5kb20ubHVtaW5hbmNlQmFyLmhlaWdodCA9IHRoaXMuYmFybHVtLmhlaWdodCAqIHJhdGlvO1xuICAgICAgICAgICAgY3R4LnNjYWxlKHJhdGlvLCByYXRpbyk7XG4gICAgICAgICAgICBsZXQgZ3JhZGllbnQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgMCwgdGhpcy5iYXJsdW0uaGVpZ2h0IC8gcmF0aW8pO1xuXG4gICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgJ3RyYW5zcGFyZW50Jyk7XG4gICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMSwgJ2JsYWNrJyk7XG5cbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBncmFkaWVudDtcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCAzMCwgMjAwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgVXBkYXRlcyBvbmx5IHRoZSBjb2xvciB2YWx1ZSBvZiB0aGUgY29sb3IgcGlja2VyXG4gICAgICogIGFuZCB0aGUgdmlldy4gRGVzaWduZWQgdG8gYmUgY2FsbGVkIGJ5IGV4dGVybmFsIG1vZHVsZXNcbiAgICAgKiAgc28gdGhhdCBpdCBjYW4gdXBkYXRlIGl0cyBpbnRlcm5hbCB2YWx1ZSBmcm9tIGFuIG91dHNpZGUgc291cmNlLlxuICAgICAqICBEb2VzIG5vIERPTSBjcmVhdGlvbiAmIG90aGVyIGluaXRpYWxpemF0aW9uIHdvcmsuXG4gICAgICovXG4gICAgc2V0VmFsdWUgKGNvbG9yKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBuZXcgQ29sb3IoY29sb3IpO1xuICAgIH1cblxuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgICAvKiAtLS0tIEhTVi1jaXJjbGUgY29sb3IgcGlja2VyIC0tLS0tICovXG4gICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gICAgLy8gQWN0aW9ucyB3aGVuIHVzZXIgbW91c2VzIGRvd24gb24gSFNWIGNvbG9yIG1hcFxuICAgIG9uSHN2RG93biAoZXZlbnQpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBldmVudC5zcmNFbGVtZW50O1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGN1cnJlbnRUYXJnZXQgPSB0YXJnZXQuaWQgPyB0YXJnZXQgOiB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgY3VycmVudFRhcmdldEhlaWdodCA9IGN1cnJlbnRUYXJnZXQub2Zmc2V0SGVpZ2h0OyAvLyBhcyBkaWFtZXRlciBvZiBjaXJjbGVcblxuICAgICAgICAvLyBTdGFydHMgbGlzdGVuaW5nIGZvciBtb3VzZW1vdmUgYW5kIG1vdXNldXAgZXZlbnRzXG4gICAgICAgIHRoaXMub25Ic3ZNb3ZlSGFuZGxlciA9IGFkZEV2ZW50KHRoaXMuZWwsICdtb3VzZW1vdmUnLCB0aGlzLm9uSHN2TW92ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMub25Ic3ZVcEhhbmRsZXIgPSBhZGRFdmVudCh3aW5kb3csICdtb3VzZXVwJywgdGhpcy5vbkhzdlVwLCB0aGlzKTtcblxuICAgICAgICB0aGlzLm9uSHN2TW92ZShldmVudCk7XG5cbiAgICAgICAgLy8gSGlkZXMgbW91c2UgY3Vyc29yIGFuZCBiZWdpbnMgcmVuZGVyaW5nIGxvb3BcbiAgICAgICAgdGhpcy5kb20uaHN2TWFwLmNsYXNzTGlzdC5hZGQoJ2dlX2NvbG9ycGlja2VyX25vLWN1cnNvcicpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLy8gQWN0aW9ucyB3aGVuIHVzZXIgbW92ZXMgYXJvdW5kIG9uIEhTViBjb2xvciBtYXBcbiAgICBvbkhzdk1vdmUgKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGxldCByLCB4LCB5LCBoLCBzO1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLmRvbS5oc3ZNYXBDb3ZlciAmJiBjdXJyZW50VGFyZ2V0ID09PSB0aGlzLmRvbS5oc3ZNYXApIHsgLy8gdGhlIGNpcmNsZVxuICAgICAgICAgICAgciA9IGN1cnJlbnRUYXJnZXRIZWlnaHQgLyAyLFxuICAgICAgICAgICAgeCA9IGV2ZW50Lm9mZnNldFggLSByLFxuICAgICAgICAgICAgeSA9IGV2ZW50Lm9mZnNldFkgLSByLFxuICAgICAgICAgICAgaCA9ICgzNjAgLSAoKE1hdGguYXRhbjIoeSwgeCkgKiAxODAgLyBNYXRoLlBJKSArICh5IDwgMCA/IDM2MCA6IDApKSkgLyAzNjAsXG4gICAgICAgICAgICBzID0gKE1hdGguc3FydCgoeCAqIHgpICsgKHkgKiB5KSkgLyByKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUuc2V0KHsgaCwgcyB9LCAnaHN2Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzLmRvbS5oc3ZCYXJDdXJzb3JzICYmIGN1cnJlbnRUYXJnZXQgPT09IHRoaXMuZG9tLmhzdkJhckN1cnNvcnMpIHsgLy8gdGhlIGx1bWluYW5jZUJhclxuICAgICAgICAgICAgbGV0IHYgPSAoY3VycmVudFRhcmdldEhlaWdodCAtIChldmVudC5vZmZzZXRZKSkgLyBjdXJyZW50VGFyZ2V0SGVpZ2h0O1xuICAgICAgICAgICAgdiA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHYpKSAqIDI1NTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUuc2V0KHsgdjogdiB9LCAnaHN2Jyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2NoYW5nZWQnLCB0aGlzLnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBBY3Rpb25zIHdoZW4gdXNlciBtb3VzZXMgdXAgb24gSFNWIGNvbG9yIG1hcFxuICAgIG9uSHN2VXAgKGV2ZW50KSB7XG4gICAgICAgIC8vIFN0b3BzIHJlbmRlcmluZyBhbmQgcmV0dXJucyBtb3VzZSBjdXJzb3JcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zdG9wKCk7XG4gICAgICAgIHRoaXMuZG9tLmhzdk1hcC5jbGFzc0xpc3QucmVtb3ZlKCdnZV9jb2xvcnBpY2tlcl9uby1jdXJzb3InKTtcbiAgICAgICAgdGhpcy5kZXN0cm95RXZlbnRzKCk7XG4gICAgfVxuXG4gICAgLy8gRGVzdHJveSBldmVudCBsaXN0ZW5lcnMgdGhhdCBleGlzdCBkdXJpbmcgbW91c2Vkb3duIGNvbG9ycGlja2VyIGludGVyYWN0aW9uXG4gICAgZGVzdHJveUV2ZW50cyAoKSB7XG4gICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZWwsICdtb3VzZW1vdmUnLCB0aGlzLm9uSHN2TW92ZUhhbmRsZXIpO1xuICAgICAgICB0aGlzLm9uSHN2TW92ZUhhbmRsZXIgPSBudWxsO1xuICAgICAgICByZW1vdmVFdmVudCh3aW5kb3csICdtb3VzZXVwJywgdGhpcy5vbkhzdlVwSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25Ic3ZVcEhhbmRsZXIgPSBudWxsO1xuICAgIH1cblxuICAgIGNsb3NlICgpIHtcbiAgICAgICAgdGhpcy5kZXN0cm95RXZlbnRzKCk7XG4gICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZG9tLmhzdk1hcCwgJ21vdXNlZG93bicsIHRoaXMub25Ic3ZEb3duSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25Ic3ZEb3duSGFuZGxlciA9IG51bGw7XG4gICAgfVxufVxuXG4vLyBnZW5lcmljIGZ1bmN0aW9uIGZvciBkcmF3aW5nIGEgY2FudmFzIGRpc2NcbmZ1bmN0aW9uIGRyYXdEaXNrIChjdHgsIGNvb3JkcywgcmFkaXVzLCBzdGVwcywgY29sb3JDYWxsYmFjaykge1xuICAgIGxldCB4ID0gY29vcmRzWzBdIHx8IGNvb3JkczsgLy8gY29vcmRpbmF0ZSBvbiB4LWF4aXNcbiAgICBsZXQgeSA9IGNvb3Jkc1sxXSB8fCBjb29yZHM7IC8vIGNvb3JkaW5hdGUgb24geS1heGlzXG4gICAgbGV0IGEgPSByYWRpdXNbMF0gfHwgcmFkaXVzOyAvLyByYWRpdXMgb24geC1heGlzXG4gICAgbGV0IGIgPSByYWRpdXNbMV0gfHwgcmFkaXVzOyAvLyByYWRpdXMgb24geS1heGlzXG4gICAgbGV0IGFuZ2xlID0gMzYwO1xuICAgIGxldCBjb2VmID0gTWF0aC5QSSAvIDE4MDtcblxuICAgIGN0eC5zYXZlKCk7XG4gICAgY3R4LnRyYW5zbGF0ZSh4IC0gYSwgeSAtIGIpO1xuICAgIGN0eC5zY2FsZShhLCBiKTtcblxuICAgIHN0ZXBzID0gKGFuZ2xlIC8gc3RlcHMpIHx8IDM2MDtcblxuICAgIGZvciAoOyBhbmdsZSA+IDAgOyBhbmdsZSAtPSBzdGVwcykge1xuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGlmIChzdGVwcyAhPT0gMzYwKSB7XG4gICAgICAgICAgICBjdHgubW92ZVRvKDEsIDEpOyAvLyBzdHJva2VcbiAgICAgICAgfVxuICAgICAgICBjdHguYXJjKDEsIDEsIDEsXG4gICAgICAgICAgICAoYW5nbGUgLSAoc3RlcHMgLyAyKSAtIDEpICogY29lZixcbiAgICAgICAgICAgIChhbmdsZSArIChzdGVwcyAvIDIpICsgMSkgKiBjb2VmKTtcblxuICAgICAgICBpZiAoY29sb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgY29sb3JDYWxsYmFjayhjdHgsIGFuZ2xlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjdHgucmVzdG9yZSgpO1xufVxuXG5mdW5jdGlvbiBkcmF3Q2lyY2xlIChjdHgsIGNvb3JkcywgcmFkaXVzLCBjb2xvciwgd2lkdGgpIHsgLy8gdXNlcyBkcmF3RGlza1xuICAgIHdpZHRoID0gd2lkdGggfHwgMTtcbiAgICByYWRpdXMgPSBbXG4gICAgICAgIChyYWRpdXNbMF0gfHwgcmFkaXVzKSAtIHdpZHRoIC8gMixcbiAgICAgICAgKHJhZGl1c1sxXSB8fCByYWRpdXMpIC0gd2lkdGggLyAyXG4gICAgXTtcbiAgICBkcmF3RGlzayhjdHgsIGNvb3JkcywgcmFkaXVzLCAxLCBmdW5jdGlvbiAoY3R4LCBhbmdsZSkge1xuICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICBjdHgubGluZVdpZHRoID0gd2lkdGg7XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGNvbG9yIHx8ICcjMDAwJztcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgIH0pO1xufVxuIiwiaW1wb3J0IFBpY2tlciBmcm9tICcuL1BpY2tlcic7XG5pbXBvcnQgRmxvYXQgZnJvbSAnLi90eXBlcy9GbG9hdCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsb2F0UGlja2VyIGV4dGVuZHMgUGlja2VyIHtcbiAgICBjb25zdHJ1Y3RvciAobnVtYmVyLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKCdnZV9mbG9hdHBpY2tlcl8nLCBwcm9wZXJ0aWVzKTtcblxuICAgICAgICB0aGlzLndpZHRoID0gdGhpcy53aWR0aCB8fCAyNTA7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgfHwgNDA7XG5cbiAgICAgICAgdGhpcy5wcmV2T2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5zY2FsZSA9IDI7XG5cbiAgICAgICAgdGhpcy5zZXRWYWx1ZShudW1iZXIgfHwgMSk7XG4gICAgICAgIHRoaXMuY3JlYXRlKCk7XG4gICAgfVxuXG4gICAgZHJhdyAoKSB7XG4gICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG5cbiAgICAgICAgLy8gaG9yaXpvbnRhbCBsaW5lXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5kaW1Db2xvcjtcbiAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gMTtcbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbygwLCAwLjUgKyB0aGlzLmhlaWdodCAqIDAuNSk7XG4gICAgICAgIHRoaXMuY3R4LmxpbmVUbygwICsgdGhpcy53aWR0aCwgMC41ICsgdGhpcy5oZWlnaHQgKiAwLjUpO1xuICAgICAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XG5cbiAgICAgICAgLy8gdmVydGljYWwgbGluZVxuICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHRoaXMuZm5Db2xvcjtcbiAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gMTtcbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbyh0aGlzLndpZHRoICogMC41LCAwKTtcbiAgICAgICAgdGhpcy5jdHgubGluZVRvKHRoaXMud2lkdGggKiAwLjUsIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5jdHguY2xvc2VQYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIC8vIFRyaWFuZ2xlIGxpbmVcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5vdmVyUG9pbnQgPyB0aGlzLnNlbENvbG9yIDogdGhpcy5mbkNvbG9yO1xuICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgdGhpcy5jdHgubW92ZVRvKHRoaXMud2lkdGggKiAwLjUsIDUpO1xuICAgICAgICB0aGlzLmN0eC5saW5lVG8odGhpcy53aWR0aCAqIDAuNDgsIDApO1xuICAgICAgICB0aGlzLmN0eC5saW5lVG8odGhpcy53aWR0aCAqIDAuNTIsIDApO1xuICAgICAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgdGhpcy5jdHguZmlsbCgpO1xuXG4gICAgICAgIGxldCB0aW1lcyA9IDM7XG4gICAgICAgIGxldCB1bml0ID0gNDA7XG4gICAgICAgIGxldCBzdGVwID0gdGhpcy53aWR0aCAvIHVuaXQ7XG4gICAgICAgIGxldCBzZWN0aW9ucyA9IHVuaXQgKiB0aW1lcztcblxuICAgICAgICBsZXQgb2Zmc2V0WCA9IHRoaXMub2Zmc2V0WDtcblxuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5vZmZzZXRYIC0gdGhpcy53aWR0aCAqIDAuNSkgPiB0aGlzLndpZHRoICogMC41KSB7XG4gICAgICAgICAgICBvZmZzZXRYID0gKHRoaXMub2Zmc2V0WCAtIHRoaXMud2lkdGggKiAwLjUpICUgKHRoaXMud2lkdGggKiAwLjUpICsgdGhpcy53aWR0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5kaW1Db2xvcjtcbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VjdGlvbnM7IGkrKykge1xuICAgICAgICAgICAgbGV0IGwgPSAoaSAlICh1bml0IC8gMikgPT09IDApID8gdGhpcy5oZWlnaHQgKiAwLjM1IDogKGkgJSAodW5pdCAvIDQpID09PSAwKSA/IHRoaXMuaGVpZ2h0ICogMC4yIDogdGhpcy5oZWlnaHQgKiAwLjE7XG4gICAgICAgICAgICB0aGlzLmN0eC5tb3ZlVG8oaSAqIHN0ZXAgLSBvZmZzZXRYLCB0aGlzLmhlaWdodCAqIDAuNSAtIGwpO1xuICAgICAgICAgICAgdGhpcy5jdHgubGluZVRvKGkgKiBzdGVwIC0gb2Zmc2V0WCwgdGhpcy5oZWlnaHQgKiAwLjUgKyBsKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcblxuICAgICAgICBsZXQgdmFsID0gTWF0aC5yb3VuZCgoKHRoaXMudmFsdWUgLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlKSAqIHRoaXMud2lkdGgpO1xuXG4gICAgICAgIC8vIHBvaW50XG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5vdmVyUG9pbnQgPyB0aGlzLnNlbENvbG9yIDogdGhpcy5mbkNvbG9yO1xuICAgICAgICB0aGlzLmN0eC5saW5lV2lkdGggPSAxO1xuICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgdGhpcy5jdHgubW92ZVRvKHRoaXMub2Zmc2V0WCArIHZhbCwgdGhpcy5oZWlnaHQgKiAwLjUpO1xuICAgICAgICB0aGlzLmN0eC5saW5lVG8odGhpcy5vZmZzZXRYICsgdmFsLCB0aGlzLmhlaWdodCk7XG4gICAgICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcblxuICAgICAgICB0aGlzLm92ZXJQb2ludCA9IGZhbHNlO1xuICAgIH1cblxuICAgIG9uTW91c2VEb3duIChldmVudCkge1xuICAgICAgICB0aGlzLnByZXZPZmZzZXQgPSBldmVudC5vZmZzZXRYO1xuICAgICAgICBzdXBlci5vbk1vdXNlRG93bihldmVudCk7XG4gICAgfVxuXG4gICAgLy8gQWN0aW9ucyB3aGVuIHVzZXIgbW92ZXMgYXJvdW5kIG9uIEhTViBjb2xvciBtYXBcbiAgICBvbk1vdXNlTW92ZSAoZXZlbnQpIHtcbiAgICAgICAgbGV0IHggPSBldmVudC5vZmZzZXRYO1xuXG4gICAgICAgIGxldCB2ZWwgPSB4IC0gdGhpcy5wcmV2T2Zmc2V0O1xuICAgICAgICBsZXQgb2Zmc2V0ID0gdGhpcy5vZmZzZXRYIC0gdmVsO1xuXG4gICAgICAgIGxldCBjZW50ZXIgPSB0aGlzLndpZHRoIC8gdGhpcy5zY2FsZTtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZShvZmZzZXQgLyBjZW50ZXIpO1xuICAgICAgICB0aGlzLnByZXZPZmZzZXQgPSB4O1xuXG4gICAgICAgIC8vIGZpcmUgJ2NoYW5nZWQnXG4gICAgICAgIHZhciBudW1iZXIgPSBuZXcgRmxvYXQodGhpcy5nZXRWYWx1ZSgpKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2VkJywgbnVtYmVyKTtcbiAgICAgICAgdGhpcy5vdmVyUG9pbnQgPSB0cnVlO1xuICAgIH1cblxuICAgIHNldFZhbHVlICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY2VudGVyID0gKHRoaXMud2lkdGggLyB0aGlzLnNjYWxlKTtcbiAgICAgICAgdGhpcy5vZmZzZXRYID0gdGhpcy52YWx1ZSAqIGNlbnRlcjtcbiAgICB9XG59XG5cbiIsIi8qXG5PcmlnaW5hbDogaHR0cHM6Ly9naXRodWIuY29tL3RhbmdyYW1zL3RhbmdyYW0tcGxheS9ibG9iL2doLXBhZ2VzL3NyYy9qcy9hZGRvbnMvdWkvd2lkZ2V0cy9Db2xvclBpY2tlck1vZGFsLmpzXG5BdXRob3I6IExvdSBIdWFuZyAoQHNhaWtvZmlzaClcbiovXG5cbmltcG9ydCB7IGdldERldmljZVBpeGVsUmF0aW8gfSBmcm9tICcuLi8uLi90b29scy9jb21tb24nO1xuaW1wb3J0IHsgc3Vic2NyaWJlTWl4aW4gfSBmcm9tICcuLi8uLi90b29scy9taXhpbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBpY2tlciB7XG4gICAgY29uc3RydWN0b3IgKENTU19QUkVGSVgsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgc3Vic2NyaWJlTWl4aW4odGhpcyk7XG4gICAgICAgIHRoaXMuQ1NTX1BSRUZJWCA9IENTU19QUkVGSVg7XG5cbiAgICAgICAgdGhpcy5iZ0NvbG9yID0gJ3JnYig0NiwgNDgsIDUxKSc7XG4gICAgICAgIHRoaXMuZGltQ29sb3IgPSAncmdiKDEwMCwgMTAwLCAxMDApJztcbiAgICAgICAgdGhpcy5mbkNvbG9yID0gJ3JnYigyMzAsIDIzMCwgMjMwKSc7XG4gICAgICAgIHRoaXMuc2VsQ29sb3IgPSAncmdiKDEzMywgMjA0LCAxOTYpJztcblxuICAgICAgICBwcm9wZXJ0aWVzID0gcHJvcGVydGllcyB8fCB7fTtcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICB0aGlzW3Byb3BdID0gcHJvcGVydGllc1twcm9wXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiAgVGhpcyBpbml0aWFsaXplcyB0aGUgcmVuZGVyZXIuIEl0IHVzZXMgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCkgdG9cbiAgICAgICAgICogIHNtb290aGx5IHJlbmRlciBjaGFuZ2VzIGluIHRoZSBjb2xvciBwaWNrZXIgYXMgdXNlciBpbnRlcmFjdHMgd2l0aCBpdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSB7XG4gICAgICAgICAgICAvLyBTdG9yZXMgYSByZWZlcmVuY2UgdG8gdGhlIGFuaW1hdGlvbiByZW5kZXJpbmcgbG9vcC5cbiAgICAgICAgICAgIGZyYW1lOiBudWxsLFxuXG4gICAgICAgICAgICBkcmF3RnJhbWU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIFN0YXJ0cyBhbmltYXRpb24gcmVuZGVyaW5nIGxvb3BcbiAgICAgICAgICAgIHN0YXJ0OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3RnJhbWUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcmVyLnN0YXJ0KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIFN0b3BzIGFuaW1hdGlvbiByZW5kZXJpbmcgbG9vcFxuICAgICAgICAgICAgc3RvcDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlcmVyLmZyYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBjcmVhdGUgKCkge1xuICAgICAgICB0aGlzLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuZWwuY2xhc3NOYW1lID0gdGhpcy5DU1NfUFJFRklYICsgJ21vZGFsIGdlX3BpY2tlcl9tb2RhbCc7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5iZ0NvbG9yO1xuXG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTmFtZSA9IHRoaXMuQ1NTX1BSRUZJWCArICdjYW52YXMgZ2VfcGlja2VyX2NhbnZhcyc7XG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuYmdDb2xvcjtcblxuICAgICAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcbiAgICAgICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgIGxldCByYXRpbyA9IGdldERldmljZVBpeGVsUmF0aW8odGhpcy5jdHgpO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMud2lkdGggKiByYXRpbztcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgKiByYXRpbztcbiAgICAgICAgdGhpcy5jdHguc2NhbGUocmF0aW8sIHJhdGlvKTtcbiAgICB9XG5cbiAgICBkcmF3ICgpIHtcbiAgICAgICAgLy8gcmVuZGVyIHJ1dGluZVxuICAgIH1cblxuICAgIGNsb3NlICgpIHtcbiAgICAgICAgLy8gQ2xvc2UgcnV0aW5lXG4gICAgICAgIHRoaXMuZGVzdHJveUV2ZW50cygpO1xuICAgICAgICByZW1vdmVFdmVudCh0aGlzLmVsLCAnbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93bkhhbmRsZXIpO1xuICAgICAgICB0aGlzLm9uTW91c2VEb3duSGFuZGxlciA9IG51bGw7XG4gICAgfVxuXG4gICAgZGVzdHJveUV2ZW50cyAoKSB7XG4gICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZWwsICdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25Nb3VzZU1vdmVIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgcmVtb3ZlRXZlbnQod2luZG93LCAnbW91c2V1cCcsIHRoaXMub25Nb3VzZVVwSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25Nb3VzZVVwSGFuZGxlciA9IG51bGw7XG4gICAgfVxuXG4gICAgc2V0VmFsdWUgKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZSAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgIH1cblxuICAgIHNob3dBdCAoY20pIHtcbiAgICAgICAgbGV0IGN1cnNvciA9IGNtLmN1cnNvckNvb3Jkcyh0cnVlLCAncGFnZScpO1xuICAgICAgICBsZXQgeCA9IGN1cnNvci5sZWZ0O1xuICAgICAgICBsZXQgeSA9IGN1cnNvci50b3A7XG5cbiAgICAgICAgeCAtPSB0aGlzLndpZHRoICogMC41O1xuICAgICAgICB5ICs9IDMwO1xuXG4gICAgICAgIC8vIC8vIENoZWNrIGlmIGRlc2lyZWQgeCwgeSB3aWxsIGJlIG91dHNpZGUgdGhlIHZpZXdwb3J0LlxuICAgICAgICAvLyAvLyBEbyBub3QgYWxsb3cgdGhlIG1vZGFsIHRvIGRpc2FwcGVhciBvZmYgdGhlIGVkZ2Ugb2YgdGhlIHdpbmRvdy5cbiAgICAgICAgLy8geCA9ICh4ICsgdGhpcy53aWR0aCA8IHdpbmRvdy5pbm5lcldpZHRoKSA/IHggOiAod2luZG93LmlubmVyV2lkdGggLSAyMCAtIHRoaXMud2lkdGgpO1xuICAgICAgICAvLyB5ID0gKHkgKyB0aGlzLmhlaWdodCA8IHdpbmRvdy5pbm5lckhlaWdodCkgPyB5IDogKHdpbmRvdy5pbm5lckhlaWdodCAtIDIwIC0gdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMucHJlc2VudE1vZGFsKHgsIHkpO1xuICAgIH1cblxuICAgIHByZXNlbnRNb2RhbCAoeCwgeSkge1xuICAgICAgICAvLyBMaXN0ZW4gZm9yIGludGVyYWN0aW9uIG91dHNpZGUgb2YgdGhlIG1vZGFsXG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DbGlja091dHNpZGVIYW5kbGVyID0gYWRkRXZlbnQoZG9jdW1lbnQuYm9keSwgJ2NsaWNrJywgdGhpcy5vbkNsaWNrT3V0c2lkZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLm9uS2V5UHJlc3NIYW5kbGVyID0gYWRkRXZlbnQod2luZG93LCAna2V5ZG93bicsIHRoaXMub25LZXlQcmVzcywgdGhpcyk7XG4gICAgICAgIH0sIDApO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5lbC5zdHlsZS5sZWZ0ID0geCArICdweCc7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0geSArICdweCc7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCArICdweCc7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbCk7XG5cbiAgICAgICAgdGhpcy5vbk1vdXNlRG93bkhhbmRsZXIgPSBhZGRFdmVudCh0aGlzLmVsLCAnbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93biwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5kcmF3RnJhbWUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgUmVtb3ZlcyBtb2RhbCBmcm9tIERPTSBhbmQgZGVzdHJveXMgcmVsYXRlZCBldmVudCBsaXN0ZW5lcnNcbiAgICAgKi9cbiAgICByZW1vdmVNb2RhbCAoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsICYmIHRoaXMuZWwucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWwpO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZUV2ZW50KGRvY3VtZW50LmJvZHksICdjbGljaycsIHRoaXMub25DbGlja091dHNpZGVIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5vbkNsaWNrT3V0c2lkZUhhbmRsZXIgPSBudWxsO1xuICAgICAgICByZW1vdmVFdmVudCh3aW5kb3csICdrZXlkb3duJywgdGhpcy5vbktleVByZXNzSGFuZGxlcik7XG4gICAgICAgIHRoaXMub25LZXlQcmVzc0hhbmRsZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBvbktleVByZXNzIChldmVudCkge1xuICAgICAgICB0aGlzLnJlbW92ZU1vZGFsKCk7XG4gICAgfVxuXG4gICAgb25DbGlja091dHNpZGUgKGV2ZW50KSB7XG4gICAgICAgIC8vIEhBQ0tZISFcbiAgICAgICAgLy8gQSBjbGljayBldmVudCBmaXJlcyBvbiB0aGUgYm9keSBhZnRlciBtb3VzZWRvd24gLSBtb3VzZW1vdmUsIHNpbXVsdGFuZW91c2x5IHdpdGhcbiAgICAgICAgLy8gbW91c2V1cC4gU28gaWYgc29tZW9uZSBzdGFydGVkIGEgbW91c2UgYWN0aW9uIGluc2lkZSB0aGUgbW9kYWwgYW5kIHRoZW5cbiAgICAgICAgLy8gbW91c2V1cCdkIG91dHNpZGUgb2YgaXQsIGl0IGZpcmVzIGEgY2xpY2sgZXZlbnQgb24gdGhlIGJvZHksIHRodXMsIGNhdXNpbmcgdGhlXG4gICAgICAgIC8vIG1vZGFsIHRvIGRpc2FwcGVhciB3aGVuIHRoZSB1c2VyIGRvZXMgbm90IGV4cGVjdCBpdCB0bywgc2luY2UgdGhlIG1vdXNlIGRvd24gZXZlbnRcbiAgICAgICAgLy8gZGlkIG5vdCBzdGFydCBvdXRzaWRlIHRoZSBtb2RhbC5cbiAgICAgICAgLy8gVGhlcmUgbWlnaHQgYmUgKG9yIHNob3VsZCBiZSkgYSBiZXR0ZXIgd2F5IHRvIHRyYWNrIHRoaXMsIGJ1dCByaWdodCBub3csIGp1c3QgY2FuY2VsXG4gICAgICAgIC8vIHRoZSBldmVudCBpZiB0aGUgdGFyZ2V0IGVuZHMgdXAgYmVpbmcgb24gdGhlIGJvZHkgZGlyZWN0bHkgcmF0aGVyIHRoYW4gb24gb25lIG9mIHRoZVxuICAgICAgICAvLyBvdGhlciBjaGlsZCBlbGVtZW50cy5cbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVuZCB0aGlzIHNwZWNpZmljIGhhY2t5IHBhcnRcblxuICAgICAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuXG4gICAgICAgIHdoaWxlICh0YXJnZXQgIT09IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiAhdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLkNTU19QUkVGSVggKyAnbW9kYWwnKSkge1xuICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5DU1NfUFJFRklYICsgJ21vZGFsJykpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlTW9kYWwoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uTW91c2VEb3duIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIC8vIFN0YXJ0cyBsaXN0ZW5pbmcgZm9yIG1vdXNlbW92ZSBhbmQgbW91c2V1cCBldmVudHNcbiAgICAgICAgdGhpcy5vbk1vdXNlTW92ZUhhbmRsZXIgPSBhZGRFdmVudCh0aGlzLmVsLCAnbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMub25Nb3VzZVVwSGFuZGxlciA9IGFkZEV2ZW50KHdpbmRvdywgJ21vdXNldXAnLCB0aGlzLm9uTW91c2VVcCwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5vbk1vdXNlTW92ZShldmVudCk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5zdGFydCgpO1xuICAgIH1cblxuICAgIG9uTW91c2VNb3ZlIChldmVudCkge1xuICAgIH1cblxuICAgIG9uTW91c2VVcCAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zdG9wKCk7XG4gICAgICAgIHRoaXMuZGVzdHJveUV2ZW50cygpO1xuICAgIH1cbn1cblxuLyogRXZlbnQgaGFuZGxpbmcgKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRFdmVudCAoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrLCBjYWxsZXIpIHtcbiAgICBsZXQgaGFuZGxlcjtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjYWxsYmFjay5jYWxsKGNhbGxlciwgZSk7XG4gICAgfSwgZmFsc2UpO1xuICAgIHJldHVybiBoYW5kbGVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRXZlbnQgKGVsZW1lbnQsIGV2ZW50LCBjYWxsYmFjaykge1xuICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgY2FsbGJhY2ssIGZhbHNlKTtcbn1cbiIsImltcG9ydCBQaWNrZXIgZnJvbSAnLi9QaWNrZXInO1xuaW1wb3J0IFZlY3RvciBmcm9tICcuL3R5cGVzL1ZlY3Rvcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZlYzJQaWNrZXIgZXh0ZW5kcyBQaWNrZXIge1xuICAgIGNvbnN0cnVjdG9yIChwb3MsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgc3VwZXIoJ2dlX3ZlYzJwaWNrZXJfJywgcHJvcGVydGllcyk7XG5cbiAgICAgICAgdGhpcy53aWR0aCA9IHRoaXMud2lkdGggfHwgMjAwO1xuICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuaGVpZ2h0IHx8IDIwMDtcblxuICAgICAgICB0aGlzLm1pbiA9IHRoaXMubWluIHx8IC0xO1xuICAgICAgICB0aGlzLm1heCA9IHRoaXMubWF4IHx8IDE7XG4gICAgICAgIHRoaXMuc2l6ZSA9IHRoaXMuc2l6ZSB8fCA2O1xuICAgICAgICB0aGlzLnJhbmdlID0gdGhpcy5tYXggLSB0aGlzLm1pbjtcbiAgICAgICAgdGhpcy5vdmVyUG9pbnQgPSBmYWxzZTtcblxuICAgICAgICBsZXQgY2VudGVyID0gKCh0aGlzLnJhbmdlIC8gMikgLSB0aGlzLm1heCkgKiAtMTtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZShwb3MgfHwgW2NlbnRlcixjZW50ZXJdKTtcbiAgICAgICAgdGhpcy5jcmVhdGUoKTtcbiAgICB9XG5cbiAgICBkcmF3ICgpIHtcbiAgICAgICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcblxuICAgICAgICAvLyBmcmFtZVxuICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHRoaXMuZGltQ29sb3I7XG4gICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IDI7XG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICB0aGlzLmN0eC5saW5lV2lkdGggPSAwLjI1O1xuICAgICAgICBsZXQgc2VjdGlvbnMgPSAyMDtcbiAgICAgICAgbGV0IHN0ZXAgPSB0aGlzLndpZHRoIC8gc2VjdGlvbnM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VjdGlvbnM7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5jdHgubW92ZVRvKGkgKiBzdGVwLCAwKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVUbyhpICogc3RlcCwgdGhpcy5oZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5jdHgubW92ZVRvKDAsIGkgKiBzdGVwKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVUbyh0aGlzLndpZHRoLCBpICogc3RlcCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XG5cbiAgICAgICAgLy8gaG9yaXpvbnRhbCBsaW5lXG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5kaW1Db2xvcjtcbiAgICAgICAgdGhpcy5jdHgubGluZVdpZHRoID0gMS4wO1xuICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgdGhpcy5jdHgubW92ZVRvKDAsIDAuNSArIHRoaXMuaGVpZ2h0ICogMC41KTtcbiAgICAgICAgdGhpcy5jdHgubGluZVRvKHRoaXMud2lkdGgsIDAuNSArIHRoaXMuaGVpZ2h0ICogMC41KTtcbiAgICAgICAgdGhpcy5jdHguY2xvc2VQYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIC8vIHZlcnRpY2FsIGxpbmVcbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbygwLjUgKyB0aGlzLndpZHRoICogMC41LCAwKTtcbiAgICAgICAgdGhpcy5jdHgubGluZVRvKDAuNSArIHRoaXMud2lkdGggKiAwLjUsIHRoaXMuaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5jdHguY2xvc2VQYXRoKCk7XG4gICAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIC8vIC8vIFRyaWFuZ2xlIGxpbmVcbiAgICAgICAgLy8gdGhpcy5jdHguZmlsbFN0eWxlID0gdGhpcy5kaW1Db2xvcjtcbiAgICAgICAgLy8gdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIC8vIHRoaXMuY3R4Lm1vdmVUbyh0aGlzLndpZHRoICogMC41LCA1KTtcbiAgICAgICAgLy8gdGhpcy5jdHgubGluZVRvKHRoaXMud2lkdGggKiAwLjQ4LCAwKTtcbiAgICAgICAgLy8gdGhpcy5jdHgubGluZVRvKHRoaXMud2lkdGggKiAwLjUyLCAwKTtcbiAgICAgICAgLy8gdGhpcy5jdHguY2xvc2VQYXRoKCk7XG4gICAgICAgIC8vIHRoaXMuY3R4LmZpbGwoKTtcblxuICAgICAgICBsZXQgeCA9IE1hdGgucm91bmQoKCh0aGlzLnZhbHVlLnggLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlKSAqIHRoaXMud2lkdGgpO1xuICAgICAgICBsZXQgeSA9IE1hdGgucm91bmQoKCgxIC0gKHRoaXMudmFsdWUueSAtIHRoaXMubWluKSAvIHRoaXMucmFuZ2UpKSAqIHRoaXMuaGVpZ2h0KTtcblxuICAgICAgICBsZXQgaGFsZiA9IHRoaXMuc2l6ZSAvIDI7XG5cbiAgICAgICAgaWYgKHggPCBoYWxmKSB7XG4gICAgICAgICAgICB4ID0gaGFsZjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeCA+IHRoaXMud2lkdGggLSBoYWxmKSB7XG4gICAgICAgICAgICB4ID0gdGhpcy53aWR0aCAtIGhhbGY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHkgPCBoYWxmKSB7XG4gICAgICAgICAgICB5ID0gaGFsZjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeSA+IHRoaXMuaGVpZ2h0IC0gaGFsZikge1xuICAgICAgICAgICAgeSA9IHRoaXMuaGVpZ2h0IC0gaGFsZjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHBvaW50XG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IHRoaXMub3ZlclBvaW50ID8gdGhpcy5zZWxDb2xvciA6IHRoaXMuZm5Db2xvcjtcbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGxldCByYWRpdXMgPSB0aGlzLm92ZXJQb2ludCA/IDQgOiAyO1xuICAgICAgICB0aGlzLmN0eC5hcmMoeCwgeSwgcmFkaXVzLCAwLCAyICogTWF0aC5QSSwgZmFsc2UpO1xuICAgICAgICB0aGlzLmN0eC5maWxsKCk7XG5cbiAgICAgICAgdGhpcy5jdHgucmVzdG9yZSgpO1xuICAgICAgICB0aGlzLm92ZXJQb2ludCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEFjdGlvbnMgd2hlbiB1c2VyIG1vdmVzIGFyb3VuZCBvbiBIU1YgY29sb3IgbWFwXG4gICAgb25Nb3VzZU1vdmUgKGV2ZW50KSB7XG4gICAgICAgIGxldCB4ID0gZXZlbnQub2Zmc2V0WDtcbiAgICAgICAgbGV0IHkgPSBldmVudC5vZmZzZXRZO1xuXG4gICAgICAgIHRoaXMudmFsdWUueCA9ICgodGhpcy5yYW5nZSAvIHRoaXMud2lkdGgpICogeCkgLSAodGhpcy5yYW5nZSAtIHRoaXMubWF4KTtcbiAgICAgICAgdGhpcy52YWx1ZS55ID0gKCgodGhpcy5yYW5nZSAvIHRoaXMuaGVpZ2h0KSAqIHkpIC0gKHRoaXMucmFuZ2UgLSB0aGlzLm1heCkpICogLTE7XG5cbiAgICAgICAgLy8gZmlyZSAnY2hhbmdlZCdcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2VkJywgdGhpcy52YWx1ZSk7XG4gICAgICAgIHRoaXMub3ZlclBvaW50ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBzZXRWYWx1ZSAocG9zKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBuZXcgVmVjdG9yKHBvcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IFBpY2tlciBmcm9tICcuL1BpY2tlcic7XG5pbXBvcnQgVmVjdG9yIGZyb20gJy4vdHlwZXMvVmVjdG9yJztcbmltcG9ydCBNYXRyaXggZnJvbSAnLi90eXBlcy9NYXRyaXgnO1xuaW1wb3J0IHsgYWRkRXZlbnQsIHJlbW92ZUV2ZW50IH0gZnJvbSAnLi9QaWNrZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWZWMzUGlja2VyIGV4dGVuZHMgUGlja2VyIHtcbiAgICBjb25zdHJ1Y3RvciAoZGlyLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKCdnZV92ZWMzcGlja2VyXycsIHByb3BlcnRpZXMpO1xuXG4gICAgICAgIHRoaXMud2lkdGggPSB0aGlzLndpZHRoIHx8IDIwMDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLndpZHRoIHx8IDIwMDtcbiAgICAgICAgdGhpcy5zY2FsZSA9IDUwO1xuXG4gICAgICAgIHRoaXMuc2V0VmFsdWUoZGlyIHx8IFswLCAwLCAxXSk7XG4gICAgICAgIHRoaXMuY3JlYXRlKCk7XG5cbiAgICAgICAgdGhpcy5jYW1lcmEgPSBuZXcgTWF0cml4KCk7XG4gICAgICAgIHRoaXMuc2hhcGVzID0gW107XG4gICAgICAgIHRoaXMuY2VudGVyID0gWzAsIDAsIDBdO1xuXG4gICAgICAgIHRoaXMuc2hhcGVzLnB1c2goe1xuICAgICAgICAgICAgZWRnZUNvbG91cjogdGhpcy5kaW1Db2xvcixcbiAgICAgICAgICAgIG5vZGVzOiBbW3RoaXMud2lkdGggLyAyIC0gNTAsIHRoaXMuaGVpZ2h0IC8gMiwgMTAwXSwgW3RoaXMud2lkdGggLyAyICsgNTAsIHRoaXMuaGVpZ2h0IC8gMiwgMTAwXSxcbiAgICAgICAgICAgICAgICBbdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiAtIDUwLCAxMDBdLCBbdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiArIDUwLCAxMDBdLFxuICAgICAgICAgICAgICAgIFt0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyLCA1MF0sIFt0aGlzLndpZHRoIC8gMiwgdGhpcy5oZWlnaHQgLyAyLCAxNTBdXSxcbiAgICAgICAgICAgIGVkZ2VzOiBbWzAsMV0sIFsyLDNdLCBbNCw1XV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zaGFwZXMucHVzaCh7XG4gICAgICAgICAgICB0ZXh0Q29sb3VyOiB0aGlzLmZuQ29sb3IsXG4gICAgICAgICAgICBub2RlczogW1t0aGlzLndpZHRoIC8gMiArIDY4LCB0aGlzLmhlaWdodCAvIDIsIDEwMF0sIFt0aGlzLndpZHRoIC8gMiAtIDY4LCB0aGlzLmhlaWdodCAvIDIsIDEwMF0sXG4gICAgICAgICAgICAgICAgW3RoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIgKyA2OCwgMTAwXSwgW3RoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIgLSA2OCwgMTAwXSxcbiAgICAgICAgICAgICAgICBbdGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiwgMTY4XSwgW3RoaXMud2lkdGggLyAyLCB0aGlzLmhlaWdodCAvIDIsIDMyXV0sXG4gICAgICAgICAgICB0ZXh0OiBbJ3gnLCAnLXgnLCAneScsICcteScsICd6JywgJy16J11cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRDZW50ZXIodGhpcy53aWR0aCAvIDIsIHRoaXMuaGVpZ2h0IC8gMiwgMTAwKTtcblxuICAgICAgICAvLyBNb3VzZSBldmVudHNcbiAgICAgICAgdGhpcy5kcmFnT2Zmc2V0ID0gWzAsIDBdO1xuICAgICAgICB0aGlzLm92ZXJQb2ludCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHNldENlbnRlciAoeCwgeSwgeikge1xuICAgICAgICBmb3IgKGxldCBzIGluIHRoaXMuc2hhcGVzKSB7XG4gICAgICAgICAgICBsZXQgc2hhcGUgPSB0aGlzLnNoYXBlc1tzXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgbiBpbiBzaGFwZS5ub2Rlcykge1xuICAgICAgICAgICAgICAgIHNoYXBlLm5vZGVzW25dWzBdIC09IHg7XG4gICAgICAgICAgICAgICAgc2hhcGUubm9kZXNbbl1bMV0gLT0geTtcbiAgICAgICAgICAgICAgICBzaGFwZS5ub2Rlc1tuXVsyXSAtPSB6O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2VudGVyID0gW3gsIHksIHpdO1xuICAgIH1cblxuICAgIHZpZXdGcm9tQ2FtZXJhIChub2RlKSB7XG4gICAgICAgIGxldCBBID0gdGhpcy5jYW1lcmEuZ2V0TXVsdChub2RlKTtcbiAgICAgICAgQS5hZGQodGhpcy5jZW50ZXIpO1xuICAgICAgICByZXR1cm4gW0EueCwgdGhpcy5oZWlnaHQgLSBBLnldO1xuICAgIH1cblxuICAgIGRyYXcgKCkge1xuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuXG4gICAgICAgIGZvciAobGV0IHMgaW4gdGhpcy5zaGFwZXMpIHtcbiAgICAgICAgICAgIGxldCBzaGFwZSA9IHRoaXMuc2hhcGVzW3NdO1xuICAgICAgICAgICAgaWYgKHNoYXBlLmVkZ2VDb2xvdXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdTaGFwZUVkZ2VzKHNoYXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaGFwZS5ub2RlQ29sb3VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3U2hhcGVOb2RlcyhzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2hhcGUudGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd1NoYXBlVGV4dChzaGFwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmRyYXdTaGFwZUVkZ2VzKHtcbiAgICAgICAgICAgIGVkZ2VDb2xvdXI6IHRoaXMuZm5Db2xvcixcbiAgICAgICAgICAgIG5vZGVzOiBbWzAsMCwwXSwgdGhpcy5wb2ludF0sXG4gICAgICAgICAgICBlZGdlczogW1swLDFdXVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmRyYXdTaGFwZU5vZGVzKHtcbiAgICAgICAgICAgIG5vZGVDb2xvdXI6IHRoaXMub3ZlclBvaW50ID8gdGhpcy5zZWxDb2xvciA6IHRoaXMuZm5Db2xvcixcbiAgICAgICAgICAgIG5vZGVSYWRpdXM6IHRoaXMub3ZlclBvaW50ID8gNCA6IDIsXG4gICAgICAgICAgICBub2RlczogW3RoaXMucG9pbnRdXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRyYXdTaGFwZUVkZ2VzIChzaGFwZSkge1xuICAgICAgICBsZXQgbm9kZXMgPSBzaGFwZS5ub2RlcztcblxuICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IHNoYXBlLmVkZ2VDb2xvdXI7XG4gICAgICAgIGZvciAobGV0IGUgaW4gc2hhcGUuZWRnZXMpIHtcbiAgICAgICAgICAgIGxldCBjb29yZCA9IHRoaXMudmlld0Zyb21DYW1lcmEobm9kZXNbc2hhcGUuZWRnZXNbZV1bMF1dKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIHRoaXMuY3R4Lm1vdmVUbyhjb29yZFswXSwgY29vcmRbMV0pO1xuICAgICAgICAgICAgY29vcmQgPSB0aGlzLnZpZXdGcm9tQ2FtZXJhKG5vZGVzW3NoYXBlLmVkZ2VzW2VdWzFdXSk7XG4gICAgICAgICAgICB0aGlzLmN0eC5saW5lVG8oY29vcmRbMF0sIGNvb3JkWzFdKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZHJhd1NoYXBlTm9kZXMgKHNoYXBlKSB7XG4gICAgICAgIGxldCByYWRpdXMgPSBzaGFwZS5ub2RlUmFkaXVzIHx8IDQ7XG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IHNoYXBlLm5vZGVDb2xvdXI7XG4gICAgICAgIGZvciAobGV0IG4gaW4gc2hhcGUubm9kZXMpIHtcbiAgICAgICAgICAgIGxldCBjb29yZCA9IHRoaXMudmlld0Zyb21DYW1lcmEoc2hhcGUubm9kZXNbbl0pO1xuICAgICAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICB0aGlzLmN0eC5hcmMoY29vcmRbMF0sIGNvb3JkWzFdLCByYWRpdXMsIDAgLCAyICogTWF0aC5QSSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5jdHguZmlsbCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZHJhd1NoYXBlVGV4dCAoc2hhcGUpIHtcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gc2hhcGUudGV4dENvbG91cjtcbiAgICAgICAgZm9yIChsZXQgbiBpbiBzaGFwZS5ub2Rlcykge1xuICAgICAgICAgICAgbGV0IGNvb3JkID0gdGhpcy52aWV3RnJvbUNhbWVyYShzaGFwZS5ub2Rlc1tuXSk7XG4gICAgICAgICAgICB0aGlzLmN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJztcbiAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxUZXh0KHNoYXBlLnRleHRbbl0sIGNvb3JkWzBdLCBjb29yZFsxXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbk1vdXNlRG93biAoZXZlbnQpIHtcbiAgICAgICAgbGV0IG1vdXNlID0gW2V2ZW50Lm9mZnNldFgsIGV2ZW50Lm9mZnNldFldO1xuICAgICAgICB0aGlzLmRyYWdPZmZzZXQgPSBtb3VzZTtcblxuICAgICAgICBsZXQgcG9zID0gbmV3IFZlY3Rvcih0aGlzLnZpZXdGcm9tQ2FtZXJhKHRoaXMucG9pbnQpKTtcbiAgICAgICAgbGV0IGRpZmYgPSBwb3MuZ2V0U3ViKG1vdXNlKTtcbiAgICAgICAgdGhpcy5vdmVyUG9pbnQgPSBkaWZmLmdldExlbmd0aCgpIDwgMTA7XG5cbiAgICAgICAgc3VwZXIub25Nb3VzZURvd24oZXZlbnQpO1xuICAgICAgICB0aGlzLm9uTW91c2VVcEhhbmRsZXIgPSBhZGRFdmVudCh0aGlzLmVsLCAnZGJsY2xpY2snLCB0aGlzLm9uRGJDbGljaywgdGhpcyk7XG4gICAgfVxuXG4gICAgLy8gQWN0aW9ucyB3aGVuIHVzZXIgbW92ZXMgYXJvdW5kIG9uIEhTViBjb2xvciBtYXBcbiAgICBvbk1vdXNlTW92ZSAoZXZlbnQpIHtcbiAgICAgICAgbGV0IHggPSBldmVudC5vZmZzZXRYO1xuICAgICAgICBsZXQgeSA9IGV2ZW50Lm9mZnNldFk7XG5cbiAgICAgICAgdmFyIGR4ID0gMC4wMSAqICh4IC0gdGhpcy5kcmFnT2Zmc2V0WzBdKTtcbiAgICAgICAgdmFyIGR5ID0gMC4wMSAqICh5IC0gdGhpcy5kcmFnT2Zmc2V0WzFdKTtcblxuICAgICAgICBpZiAodGhpcy5vdmVyUG9pbnQpIHtcbiAgICAgICAgICAgIGxldCBpbnZNID0gdGhpcy5jYW1lcmEuZ2V0SW52KCk7XG4gICAgICAgICAgICBsZXQgdmVsID0gaW52TS5nZXRNdWx0KFtkeCwgLWR5LCAwLjBdKTtcbiAgICAgICAgICAgIHZlbC5tdWx0KDIpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZS5hZGQodmVsKTtcbiAgICAgICAgICAgIHRoaXMucG9pbnQgPSBbdGhpcy52YWx1ZS54ICogdGhpcy5zY2FsZSwgdGhpcy52YWx1ZS55ICogdGhpcy5zY2FsZSwgdGhpcy52YWx1ZS56ICogdGhpcy5zY2FsZV07XG4gICAgICAgICAgICAvLyBmaXJlICdjaGFuZ2VkJ1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2VkJywgdGhpcy52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNhbWVyYS5yb3RhdGVYKGR5KTtcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhLnJvdGF0ZVkoZHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kcmFnT2Zmc2V0ID0gW3gsIHldO1xuICAgIH1cblxuICAgIG9uRGJDbGljayAoZXZlbnQpIHtcbiAgICAgICAgbGV0IG1vdXNlID0gbmV3IFZlY3RvcihbZXZlbnQub2Zmc2V0WCwgZXZlbnQub2Zmc2V0WV0pO1xuICAgICAgICBsZXQgYXhpcyA9IHtcbiAgICAgICAgICAgIHg6IFs2OCwgMCwgMF0sXG4gICAgICAgICAgICBuZWdYOiBbLTY4LCAwLCAwXSxcbiAgICAgICAgICAgIHk6IFswLCA2OCwgMTAwXSxcbiAgICAgICAgICAgIG5lZ1k6IFswLCAtNjgsIDBdXG4gICAgICAgIH07XG4gICAgICAgIGxldCBzZWxlY3RlZCA9ICcnO1xuICAgICAgICBmb3IgKGxldCBpIGluIGF4aXMpIHtcbiAgICAgICAgICAgIGxldCBwb3MgPSBuZXcgVmVjdG9yKHRoaXMudmlld0Zyb21DYW1lcmEoYXhpc1tpXSkpO1xuICAgICAgICAgICAgbGV0IGRpZmYgPSBwb3MuZ2V0U3ViKG1vdXNlKTtcbiAgICAgICAgICAgIGlmIChkaWZmLmdldExlbmd0aCgpIDwgMTApIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jYW1lcmEgPSBuZXcgTWF0cml4KCk7XG5cbiAgICAgICAgaWYgKHNlbGVjdGVkID09PSAneCcpIHtcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhLnJvdGF0ZVkoLTEuNTcwNzk2MzI2NzkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGVjdGVkID09PSAnbmVnWCcpIHtcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhLnJvdGF0ZVkoMS41NzA3OTYzMjY3OSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZWN0ZWQgPT09ICd5Jykge1xuICAgICAgICAgICAgdGhpcy5jYW1lcmEucm90YXRlWCgtMS41NzA3OTYzMjY3OSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZWN0ZWQgPT09ICduZWdZJykge1xuICAgICAgICAgICAgdGhpcy5jYW1lcmEucm90YXRlWCgxLjU3MDc5NjMyNjc5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZHJhdygpO1xuICAgIH1cblxuICAgIGRlc3Ryb3lFdmVudHMgKCkge1xuICAgICAgICBzdXBlci5kZXN0cm95RXZlbnRzKCk7XG4gICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZWwsICdkYmxjbGljaycsIHRoaXMub25EYkNsaWNrKTtcbiAgICAgICAgdGhpcy5vbk1vdXNlTW92ZUhhbmRsZXIgPSBudWxsO1xuICAgIH1cblxuICAgIHNldFZhbHVlIChkaXIpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG5ldyBWZWN0b3IoZGlyKTtcbiAgICAgICAgdGhpcy5wb2ludCA9IFt0aGlzLnZhbHVlLnggKiB0aGlzLnNjYWxlLCB0aGlzLnZhbHVlLnkgKiB0aGlzLnNjYWxlLCB0aGlzLnZhbHVlLnogKiB0aGlzLnNjYWxlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQ29sb3JDb252ZXJ0ZXIgZnJvbSAnLi9Db2xvckNvbnZlcnRlcic7XG5pbXBvcnQgeyBnZXRDb2xvckFzUkdCLCBnZXRWYWx1ZVJhbmdlcywgZ2V0THVtaW5hbmNlLCBsaW1pdFZhbHVlIH0gZnJvbSAnLi9Db2xvckNvbnZlcnRlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbG9yIHtcbiAgICBjb25zdHJ1Y3RvciAoY29sb3IpIHtcbiAgICAgICAgdGhpcy5jb2xvcnMgPSB7fTtcbiAgICAgICAgdGhpcy5zZXQoY29sb3IpO1xuICAgIH1cblxuICAgIHNldCAoY29sb3IsIHR5cGUpIHsgLy8gY29sb3Igb25seSBmdWxsIHJhbmdlXG4gICAgICAgIGlmICh0eXBlb2YgY29sb3IgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICB0eXBlID0gdHlwZSA/IHR5cGUgOiAncmdiJztcbiAgICAgICAgICAgIHRoaXMuY29sb3JzW3R5cGVdID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMzsgbi0tOykge1xuICAgICAgICAgICAgICAgIGxldCBtID0gdHlwZVtuXSB8fCB0eXBlLmNoYXJBdChuKTsgLy8gSUU3XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvcnNbdHlwZV1bbV0gPSBjb2xvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgY29sb3IgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBsZXQgcGFydHMgPSBjb2xvci5yZXBsYWNlKC8oPzojfFxcKXwlKS9nLCAnJykuc3BsaXQoJygnKTtcbiAgICAgICAgICAgIGlmIChwYXJ0c1sxXSkge1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZXMgPSAocGFydHNbMV0gfHwgJycpLnNwbGl0KC8sXFxzKi8pO1xuICAgICAgICAgICAgICAgIHR5cGUgPSB0eXBlID8gdHlwZSA6IChwYXJ0c1sxXSA/IHBhcnRzWzBdLnN1YnN0cigwLCAzKSA6ICdyZ2InKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldCh2YWx1ZXMsIHR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoZ2V0Q29sb3JBc1JHQihjb2xvciksICdyZ2InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb2xvcikge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29sb3IpKSB7XG4gICAgICAgICAgICAgICAgbGV0IG0gPSAnJztcbiAgICAgICAgICAgICAgICB0eXBlID0gdHlwZSB8fCAncmdiJztcblxuICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzW3R5cGVdID0gdGhpcy5jb2xvcnNbdHlwZV0gfHwge307XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IDM7IG4tLTspIHtcbiAgICAgICAgICAgICAgICAgICAgbSA9IHR5cGVbbl0gfHwgdHlwZS5jaGFyQXQobik7IC8vIElFN1xuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IGNvbG9yLmxlbmd0aCA+PSAzID8gbiA6IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzW3R5cGVdW21dID0gcGFyc2VGbG9hdChjb2xvcltpXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9ycy5hbHBoYSA9IHBhcnNlRmxvYXQoY29sb3JbM10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBuIGluIGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzW3R5cGVdW25dID0gbGltaXRWYWx1ZShjb2xvcltuXSAvIGdldFZhbHVlUmFuZ2VzKHR5cGUpW25dWzFdLCAwLCAxKSAqIGdldFZhbHVlUmFuZ2VzKHR5cGUpW25dWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdHlwZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgIT09ICdyZ2InKSB7XG4gICAgICAgICAgICB2YXIgY29udmVydCA9IENvbG9yQ29udmVydGVyO1xuICAgICAgICAgICAgdGhpcy5jb2xvcnMucmdiID0gY29udmVydFt0eXBlICsgJzJyZ2InXSh0aGlzLmNvbG9yc1t0eXBlXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb252ZXJ0KHR5cGUpO1xuICAgICAgICB0aGlzLmNvbG9ycy5odWVSR0IgPSBDb2xvckNvbnZlcnRlci5odWUyUkdCKHRoaXMuY29sb3JzLmhzdi5oKTtcbiAgICAgICAgdGhpcy5jb2xvcnMubHVtaW5hbmNlID0gZ2V0THVtaW5hbmNlKHRoaXMuY29sb3JzLnJnYik7XG4gICAgfVxuXG4gICAgY29udmVydCAodHlwZSkge1xuICAgICAgICBsZXQgY29udmVydCA9IENvbG9yQ29udmVydGVyLFxuICAgICAgICAgICAgcmFuZ2VzID0gZ2V0VmFsdWVSYW5nZXMoKSxcbiAgICAgICAgICAgIGV4Y2VwdGlvbnMgPSB7IGhzbDogJ2hzdicsIGNteWs6ICdjbXknLCByZ2I6IHR5cGUgfTtcblxuICAgICAgICBpZiAodHlwZSAhPT0gJ2FscGhhJykge1xuICAgICAgICAgICAgZm9yIChsZXQgdHlwIGluIHJhbmdlcykge1xuICAgICAgICAgICAgICAgIGlmICghcmFuZ2VzW3R5cF1bdHlwXSkgeyAvLyBubyBhbHBoYXxIRVhcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgIT09IHR5cCAmJiB0eXAgIT09ICdYWVonKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZnJvbSA9IGV4Y2VwdGlvbnNbdHlwXSB8fCAncmdiJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JzW3R5cF0gPSBjb252ZXJ0W2Zyb20gKyAnMicgKyB0eXBdKHRoaXMuY29sb3JzW2Zyb21dKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCAodHlwZSkge1xuICAgICAgICBpZiAodHlwZSAhPT0gJ3JnYicpIHtcbiAgICAgICAgICAgIHZhciBjb252ZXJ0ID0gQ29sb3JDb252ZXJ0ZXI7XG4gICAgICAgICAgICB0aGlzLmNvbG9yc1t0eXBlXSA9IGNvbnZlcnRbJ3JnYjInICsgdHlwZV0odGhpcy5jb2xvcnNbJ3JnYiddKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbG9yc1t0eXBlXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbG9yc1sncmdiJ107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTdHJpbmcgKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09ICdIRVgnKSB7XG4gICAgICAgICAgICB2YXIgY29udmVydCA9IENvbG9yQ29udmVydGVyO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnZlcnRbJ3JnYjInICsgdHlwZV0odGhpcy5jb2xvcnNbJ3JnYiddKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjb2xvciA9IHRoaXMuZ2V0KHR5cGUpO1xuICAgICAgICAgICAgbGV0IHN0ciA9IHR5cGUsXG4gICAgICAgICAgICAgICAgbSA9ICcnO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICd2ZWMnKSB7XG4gICAgICAgICAgICAgICAgc3RyICs9IHRoaXMuY29sb3JzLmFscGhhID8gNCA6IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdHIgKz0gJygnO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAzOyBuKyspIHtcbiAgICAgICAgICAgICAgICBtID0gdHlwZVtuXSB8fCB0eXBlLmNoYXJBdChuKTsgLy8gSUU3XG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICd2ZWMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSAoY29sb3JbbV0pLnRvRml4ZWQoMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gTWF0aC5mbG9vcihjb2xvclttXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuICE9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSAnLCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5jb2xvcnMuYWxwaGEpIHtcbiAgICAgICAgICAgICAgICBzdHIgKz0gJywnICsgKHRoaXMuY29sb3JzLmFscGhhKS50b0ZpeGVkKDMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHN0ciArPSAnKSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1bmlmb3JtVHlwZSAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbG9ycy5hbHBoYSkge1xuICAgICAgICAgICAgcmV0dXJuICd2ZWM0JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJ3ZlYzMnO1xuICAgIH1cblxuICAgIHVuaWZvcm1WYWx1ZSAoKSB7XG4gICAgICAgIHZhciB2ZWMgPSB0aGlzLmdldCgndmVjJyk7XG4gICAgICAgIHZhciBhcnIgPSBbdmVjLnYsIHZlYy5lLCB2ZWMuY107XG4gICAgICAgIGlmICh0aGlzLmNvbG9ycy5hbHBoYSkge1xuICAgICAgICAgICAgYXJyLnB1c2godGhpcy5jb2xvcnMuYWxwaGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfVxuXG4gICAgdW5pZm9ybU1ldGhvZCAodHlwZSkge1xuICAgICAgICBpZiAodGhpcy5jb2xvcnMuYWxwaGEpIHtcbiAgICAgICAgICAgIHJldHVybiAnNGYnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnM2YnO1xuICAgIH1cbn1cbiIsInZhciB2YWx1ZVJhbmdlcyA9IHtcbiAgICByZ2I6IHsgcjogWzAsIDI1NV0sIGc6IFswLCAyNTVdLCBiOiBbMCwgMjU1XSB9LFxuICAgIGhzdjogeyBoOiBbMCwgMV0sIHM6IFswLCAxXSwgdjogWzAsIDI1NV0gfSxcbiAgICBoc2w6IHsgaDogWzAsIDM2MF0sIHM6IFswLCAxMDBdLCBsOiBbMCwgMTAwXSB9LFxuICAgIGNteTogeyBjOiBbMCwgMTAwXSwgbTogWzAsIDEwMF0sIHk6IFswLCAxMDBdIH0sXG4gICAgY215azogeyBjOiBbMCwgMTAwXSwgbTogWzAsIDEwMF0sIHk6IFswLCAxMDBdLCBrOiBbMCwgMTAwXSB9LFxuICAgIExhYjogeyBMOiBbMCwgMTAwXSwgYTogWy0xMjgsIDEyN10sIGI6IFstMTI4LCAxMjddIH0sXG4gICAgWFlaOiB7IFg6IFswLCAxMDBdLCBZOiBbMCwgMTAwXSwgWjogWzAsIDEwMF0gfSxcbiAgICB2ZWM6IHsgdjogWzAsIDFdLCBlOiBbMCwgMV0sIGM6IFswLCAxXSB9LFxuICAgIGFscGhhOiB7IGFscGhhOiBbMCwgMV0gfSxcbiAgICBIRVg6IHsgSEVYOiBbMCwgMTY3NzcyMTVdIH0gLy8gbWF5YmUgd2UgZG9uJ3QgbmVlZCB0aGlzXG59O1xuXG4vLyBodHRwOi8vd3d3LmJydWNlbGluZGJsb29tLmNvbS9pbmRleC5odG1sP0Vxbl9SR0JfWFlaX01hdHJpeC5odG1sIGZvciBtb3JlXG52YXIgWFlaTWF0cml4ID0geyAvLyBPYnNlcnZlciA9IDLCsCAoQ0lFIDE5MzEpLCBJbGx1bWluYW50ID0gRDY1XG4gICAgWDogWzAuNDEyNDU2NCwgMC4zNTc1NzYxLCAwLjE4MDQzNzVdLFxuICAgIFk6IFswLjIxMjY3MjksIDAuNzE1MTUyMiwgMC4wNzIxNzUwXSxcbiAgICBaOiBbMC4wMTkzMzM5LCAwLjExOTE5MjAsIDAuOTUwMzA0MV0sXG4gICAgUjogWzMuMjQwNDU0MiwgLTEuNTM3MTM4NSwgLTAuNDk4NTMxNF0sXG4gICAgRzogWy0wLjk2OTI2NjAsIDEuODc2MDEwOCwgMC4wNDE1NTYwXSxcbiAgICBCOiBbMC4wNTU2NDM0LCAtMC4yMDQwMjU5LCAxLjA1NzIyNTJdXG59O1xuXG52YXIgWFlaUmVmZXJlbmNlID0ge1xuICAgIFg6IFhZWk1hdHJpeC5YWzBdICsgWFlaTWF0cml4LlhbMV0gKyBYWVpNYXRyaXguWFsyXSxcbiAgICBZOiBYWVpNYXRyaXguWVswXSArIFhZWk1hdHJpeC5ZWzFdICsgWFlaTWF0cml4LllbMl0sXG4gICAgWjogWFlaTWF0cml4LlpbMF0gKyBYWVpNYXRyaXguWlsxXSArIFhZWk1hdHJpeC5aWzJdXG59O1xuXG52YXIgbHVtaW5hbmNlID0geyByOiAwLjIxMjYsIGc6IDAuNzE1MiwgYjogMC4wNzIyIH07IC8vIFczQyAyLjBcblxudmFyIF9jb2xvcnM7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbG9yQ29udmVydGVyIHtcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gVkVDIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuICAgIHN0YXRpYyB2ZWMycmdiICh2ZWMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHI6IHZlYy52ICogdmFsdWVSYW5nZXNbJ3JnYiddWydyJ11bMV0sXG4gICAgICAgICAgICBnOiB2ZWMuZSAqIHZhbHVlUmFuZ2VzWydyZ2InXVsnZyddWzFdLFxuICAgICAgICAgICAgYjogdmVjLmMgKiB2YWx1ZVJhbmdlc1sncmdiJ11bJ2InXVsxXVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXRpYyByZ2IydmVjIChyZ2IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHY6IHJnYi5yIC8gdmFsdWVSYW5nZXNbJ3JnYiddWydyJ11bMV0sXG4gICAgICAgICAgICBlOiByZ2IuZyAvIHZhbHVlUmFuZ2VzWydyZ2InXVsnZyddWzFdLFxuICAgICAgICAgICAgYzogcmdiLmIgLyB2YWx1ZVJhbmdlc1sncmdiJ11bJ2InXVsxXVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBIRVggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbiAgICBzdGF0aWMgUkdCMkhFWCAocmdiKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAocmdiLnIgPCAxNiA/ICcwJyA6ICcnKSArIHJnYi5yLnRvU3RyaW5nKDE2KSArXG4gICAgICAgICAgICAocmdiLmcgPCAxNiA/ICcwJyA6ICcnKSArIHJnYi5nLnRvU3RyaW5nKDE2KSArXG4gICAgICAgICAgICAocmdiLmIgPCAxNiA/ICcwJyA6ICcnKSArIHJnYi5iLnRvU3RyaW5nKDE2KVxuICAgICAgICApLnRvVXBwZXJDYXNlKCk7XG4gICAgfVxuXG4gICAgc3RhdGljIEhFWDJyZ2IgKEhFWCkge1xuICAgICAgICBIRVggPSBIRVguc3BsaXQoJycpOyAvLyBJRTdcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHI6IHBhcnNlSW50KEhFWFswXSArIEhFWFtIRVhbM10gPyAxIDogMF0sIDE2KSAvIDI1NSxcbiAgICAgICAgICAgIGc6IHBhcnNlSW50KEhFWFtIRVhbM10gPyAyIDogMV0gKyAoSEVYWzNdIHx8IEhFWFsxXSksIDE2KSAvIDI1NSxcbiAgICAgICAgICAgIGI6IHBhcnNlSW50KChIRVhbNF0gfHwgSEVYWzJdKSArIChIRVhbNV0gfHwgSEVYWzJdKSwgMTYpIC8gMjU1XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIEhVRSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gLy9cblxuICAgIHN0YXRpYyBodWUyUkdCIChodWUpIHtcbiAgICAgICAgdmFyIGggPSBodWUgKiA2LFxuICAgICAgICAgICAgLy8gbW9kID0gfn5oICUgNiwgLy8gTWF0aC5mbG9vcihoKSAtPiBmYXN0ZXIgaW4gbW9zdCBicm93c2Vyc1xuICAgICAgICAgICAgbW9kID0gTWF0aC5mbG9vcihoKSxcbiAgICAgICAgICAgIGkgPSBoID09PSA2ID8gMCA6IChoIC0gbW9kKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHI6IE1hdGgucm91bmQoWzEsIDEgLSBpLCAwLCAwLCBpLCAxXVttb2RdICogMjU1KSxcbiAgICAgICAgICAgIGc6IE1hdGgucm91bmQoW2ksIDEsIDEsIDEgLSBpLCAwLCAwXVttb2RdICogMjU1KSxcbiAgICAgICAgICAgIGI6IE1hdGgucm91bmQoWzAsIDAsIGksIDEsIDEsIDEgLSBpXVttb2RdICogMjU1KVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBIU1YgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbiAgICBzdGF0aWMgcmdiMmhzdiAocmdiKSB7IC8vIGZhc3RlclxuICAgICAgICB2YXIgciA9IHJnYi5yLFxuICAgICAgICAgICAgZyA9IHJnYi5nLFxuICAgICAgICAgICAgYiA9IHJnYi5iLFxuICAgICAgICAgICAgayA9IDAsXG4gICAgICAgICAgICBjaHJvbWEsXG4gICAgICAgICAgICBtaW4sXG4gICAgICAgICAgICBzO1xuXG4gICAgICAgIGlmIChnIDwgYikge1xuICAgICAgICAgICAgZyA9IGIgKyAoYiA9IGcsIDApO1xuICAgICAgICAgICAgayA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIG1pbiA9IGI7XG4gICAgICAgIGlmIChyIDwgZykge1xuICAgICAgICAgICAgciA9IGcgKyAoZyA9IHIsIDApO1xuICAgICAgICAgICAgayA9IC0yIC8gNiAtIGs7XG4gICAgICAgICAgICBtaW4gPSBNYXRoLm1pbihnLCBiKTsgLy8gZyA8IGIgPyBnIDogYjsgPz8/XG4gICAgICAgIH1cbiAgICAgICAgY2hyb21hID0gciAtIG1pbjtcbiAgICAgICAgcyA9IHIgPyAoY2hyb21hIC8gcikgOiAwO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaDogcyA8IDFlLTE1ID8gKChfY29sb3JzICYmIF9jb2xvcnMuaHNsICYmIF9jb2xvcnMuaHNsLmgpIHx8IDApIDpcbiAgICAgICAgICAgICAgICBjaHJvbWEgPyBNYXRoLmFicyhrICsgKGcgLSBiKSAvICg2ICogY2hyb21hKSkgOiAwLFxuICAgICAgICAgICAgczogciA/IChjaHJvbWEgLyByKSA6ICgoX2NvbG9ycyAmJiBfY29sb3JzLmhzdiAmJiBfY29sb3JzLmhzdi5zKSB8fCAwKSwgLy8gPz9fY29sb3JzLmhzdi5zIHx8IDBcbiAgICAgICAgICAgIHY6IHJcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzdGF0aWMgaHN2MnJnYiAoaHN2KSB7XG4gICAgICAgIHZhciBoID0gaHN2LmggKiA2LFxuICAgICAgICAgICAgcyA9IGhzdi5zLFxuICAgICAgICAgICAgdiA9IGhzdi52LFxuICAgICAgICAgICAgLy8gaSA9IH5+aCwgLy8gTWF0aC5mbG9vcihoKSAtPiBmYXN0ZXIgaW4gbW9zdCBicm93c2Vyc1xuICAgICAgICAgICAgaSA9IE1hdGguZmxvb3IoaCksXG4gICAgICAgICAgICBmID0gaCAtIGksXG4gICAgICAgICAgICBwID0gdiAqICgxIC0gcyksXG4gICAgICAgICAgICBxID0gdiAqICgxIC0gZiAqIHMpLFxuICAgICAgICAgICAgdCA9IHYgKiAoMSAtICgxIC0gZikgKiBzKSxcbiAgICAgICAgICAgIG1vZCA9IGkgJSA2O1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByOiBbdiwgcSwgcCwgcCwgdCwgdl1bbW9kXSxcbiAgICAgICAgICAgIGc6IFt0LCB2LCB2LCBxLCBwLCBwXVttb2RdLFxuICAgICAgICAgICAgYjogW3AsIHAsIHQsIHYsIHYsIHFdW21vZF1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSFNMIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAvL1xuXG4gICAgc3RhdGljIGhzdjJoc2wgKGhzdikge1xuICAgICAgICB2YXIgbCA9ICgyIC0gaHN2LnMpICogaHN2LnYsXG4gICAgICAgICAgICBzID0gaHN2LnMgKiBoc3YudjtcblxuICAgICAgICBzID0gIWhzdi5zID8gMCA6IGwgPCAxID8gKGwgPyBzIC8gbCA6IDApIDogcyAvICgyIC0gbCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGg6IGhzdi5oLFxuICAgICAgICAgICAgczogIWhzdi52ICYmICFzID8gKChfY29sb3JzICYmIF9jb2xvcnMuaHNsICYmIF9jb2xvcnMuaHNsLnMpIHx8IDApIDogcywgLy8gPz8/XG4gICAgICAgICAgICBsOiBsIC8gMlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXRpYyByZ2IyaHNsIChyZ2IsIGRlcGVuZGVudCkgeyAvLyBub3QgdXNlZCBpbiBDb2xvclxuICAgICAgICB2YXIgaHN2ID0gQ29sb3JDb252ZXJ0ZXIucmdiMmhzdihyZ2IpO1xuXG4gICAgICAgIHJldHVybiBDb2xvckNvbnZlcnRlci5oc3YyaHNsKGRlcGVuZGVudCA/IGhzdiA6IChfY29sb3JzLmhzdiA9IGhzdikpO1xuICAgIH1cblxuICAgIHN0YXRpYyBoc2wycmdiIChoc2wpIHtcbiAgICAgICAgdmFyIGggPSBoc2wuaCAqIDYsXG4gICAgICAgICAgICBzID0gaHNsLnMsXG4gICAgICAgICAgICBsID0gaHNsLmwsXG4gICAgICAgICAgICB2ID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogKGwgKyBzKSAtIChzICogbCksXG4gICAgICAgICAgICBtID0gbCArIGwgLSB2LFxuICAgICAgICAgICAgc3YgPSB2ID8gKCh2IC0gbSkgLyB2KSA6IDAsXG4gICAgICAgICAgICAvLyBzZXh0YW50ID0gfn5oLCAvLyBNYXRoLmZsb29yKGgpIC0+IGZhc3RlciBpbiBtb3N0IGJyb3dzZXJzXG4gICAgICAgICAgICBzZXh0YW50ID0gTWF0aC5mbG9vcihoKSxcbiAgICAgICAgICAgIGZyYWN0ID0gaCAtIHNleHRhbnQsXG4gICAgICAgICAgICB2c2YgPSB2ICogc3YgKiBmcmFjdCxcbiAgICAgICAgICAgIHQgPSBtICsgdnNmLFxuICAgICAgICAgICAgcSA9IHYgLSB2c2YsXG4gICAgICAgICAgICBtb2QgPSBzZXh0YW50ICUgNjtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcjogW3YsIHEsIG0sIG0sIHQsIHZdW21vZF0sXG4gICAgICAgICAgICBnOiBbdCwgdiwgdiwgcSwgbSwgbV1bbW9kXSxcbiAgICAgICAgICAgIGI6IFttLCBtLCB0LCB2LCB2LCBxXVttb2RdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENNWUsgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG4gICAgLy8gUXVvdGUgZnJvbSBXaWtpcGVkaWE6XG4gICAgLy8gJ1NpbmNlIFJHQiBhbmQgQ01ZSyBzcGFjZXMgYXJlIGJvdGggZGV2aWNlLWRlcGVuZGVudCBzcGFjZXMsIHRoZXJlIGlzIG5vXG4gICAgLy8gc2ltcGxlIG9yIGdlbmVyYWwgY29udmVyc2lvbiBmb3JtdWxhIHRoYXQgY29udmVydHMgYmV0d2VlbiB0aGVtLlxuICAgIC8vIENvbnZlcnNpb25zIGFyZSBnZW5lcmFsbHkgZG9uZSB0aHJvdWdoIGNvbG9yIG1hbmFnZW1lbnQgc3lzdGVtcywgdXNpbmdcbiAgICAvLyBjb2xvciBwcm9maWxlcyB0aGF0IGRlc2NyaWJlIHRoZSBzcGFjZXMgYmVpbmcgY29udmVydGVkLiBOZXZlcnRoZWxlc3MsIHRoZVxuICAgIC8vIGNvbnZlcnNpb25zIGNhbm5vdCBiZSBleGFjdCwgc2luY2UgdGhlc2Ugc3BhY2VzIGhhdmUgdmVyeSBkaWZmZXJlbnQgZ2FtdXRzLidcbiAgICAvLyBUcmFuc2xhdGlvbjogdGhlIGZvbGxvd2luZyBhcmUganVzdCBzaW1wbGUgUkdCIHRvIENNWShLKSBhbmQgdmlzYSB2ZXJzYSBjb252ZXJzaW9uIGZ1bmN0aW9ucy5cblxuICAgIHN0YXRpYyByZ2IyY215IChyZ2IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGM6IDEgLSByZ2IucixcbiAgICAgICAgICAgIG06IDEgLSByZ2IuZyxcbiAgICAgICAgICAgIHk6IDEgLSByZ2IuYlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXRpYyBjbXkyY215ayAoY215KSB7XG4gICAgICAgIHZhciBrID0gTWF0aC5taW4oTWF0aC5taW4oY215LmMsIGNteS5tKSwgY215LnkpLFxuICAgICAgICAgICAgdCA9IDEgLSBrIHx8IDFlLTIwO1xuXG4gICAgICAgIHJldHVybiB7IC8vIHJlZ3VsYXJcbiAgICAgICAgICAgIGM6IChjbXkuYyAtIGspIC8gdCxcbiAgICAgICAgICAgIG06IChjbXkubSAtIGspIC8gdCxcbiAgICAgICAgICAgIHk6IChjbXkueSAtIGspIC8gdCxcbiAgICAgICAgICAgIGs6IGtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzdGF0aWMgY215azJjbXkgKGNteWspIHtcbiAgICAgICAgdmFyIGsgPSBjbXlrLms7XG5cbiAgICAgICAgcmV0dXJuIHsgLy8gcmVndWxhclxuICAgICAgICAgICAgYzogY215ay5jICogKDEgLSBrKSArIGssXG4gICAgICAgICAgICBtOiBjbXlrLm0gKiAoMSAtIGspICsgayxcbiAgICAgICAgICAgIHk6IGNteWsueSAqICgxIC0gaykgKyBrXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIGNteTJyZ2IgKGNteSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcjogMSAtIGNteS5jLFxuICAgICAgICAgICAgZzogMSAtIGNteS5tLFxuICAgICAgICAgICAgYjogMSAtIGNteS55XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIHJnYjJjbXlrIChyZ2IpIHtcbiAgICAgICAgdmFyIGNteSA9IENvbG9yQ29udmVydGVyLnJnYjJjbXkocmdiKTsgLy8gZG9wcGVsdD8/XG4gICAgICAgIHJldHVybiBDb2xvckNvbnZlcnRlci5jbXkyY215ayhjbXkpO1xuICAgIH1cblxuICAgIHN0YXRpYyBjbXlrMnJnYiAoY215aykge1xuICAgICAgICB2YXIgY215ID0gQ29sb3JDb252ZXJ0ZXIuY215azJjbXkoY215ayk7IC8vIGRvcHBlbHQ/P1xuICAgICAgICByZXR1cm4gQ29sb3JDb252ZXJ0ZXIuY215MnJnYihjbXkpO1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBMQUIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIC8vXG5cbiAgICBzdGF0aWMgWFlaMnJnYiAoWFlaKSB7XG4gICAgICAgIHZhciBNID0gWFlaTWF0cml4LFxuICAgICAgICAgICAgWCA9IFhZWi5YLFxuICAgICAgICAgICAgWSA9IFhZWi5ZLFxuICAgICAgICAgICAgWiA9IFhZWi5aLFxuICAgICAgICAgICAgciA9IFggKiBNLlJbMF0gKyBZICogTS5SWzFdICsgWiAqIE0uUlsyXSxcbiAgICAgICAgICAgIGcgPSBYICogTS5HWzBdICsgWSAqIE0uR1sxXSArIFogKiBNLkdbMl0sXG4gICAgICAgICAgICBiID0gWCAqIE0uQlswXSArIFkgKiBNLkJbMV0gKyBaICogTS5CWzJdLFxuICAgICAgICAgICAgTiA9IDEgLyAyLjQ7XG5cbiAgICAgICAgTSA9IDAuMDAzMTMwODtcblxuICAgICAgICByID0gKHIgPiBNID8gMS4wNTUgKiBNYXRoLnBvdyhyLCBOKSAtIDAuMDU1IDogMTIuOTIgKiByKTtcbiAgICAgICAgZyA9IChnID4gTSA/IDEuMDU1ICogTWF0aC5wb3coZywgTikgLSAwLjA1NSA6IDEyLjkyICogZyk7XG4gICAgICAgIGIgPSAoYiA+IE0gPyAxLjA1NSAqIE1hdGgucG93KGIsIE4pIC0gMC4wNTUgOiAxMi45MiAqIGIpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByOiBsaW1pdFZhbHVlKHIsIDAsIDEpLFxuICAgICAgICAgICAgZzogbGltaXRWYWx1ZShnLCAwLCAxKSxcbiAgICAgICAgICAgIGI6IGxpbWl0VmFsdWUoYiwgMCwgMSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcmdiMlhZWiAocmdiKSB7XG4gICAgICAgIHZhciBNID0gWFlaTWF0cml4LFxuICAgICAgICAgICAgciA9IHJnYi5yLFxuICAgICAgICAgICAgZyA9IHJnYi5nLFxuICAgICAgICAgICAgYiA9IHJnYi5iLFxuICAgICAgICAgICAgTiA9IDAuMDQwNDU7XG5cbiAgICAgICAgciA9IChyID4gTiA/IE1hdGgucG93KChyICsgMC4wNTUpIC8gMS4wNTUsIDIuNCkgOiByIC8gMTIuOTIpO1xuICAgICAgICBnID0gKGcgPiBOID8gTWF0aC5wb3coKGcgKyAwLjA1NSkgLyAxLjA1NSwgMi40KSA6IGcgLyAxMi45Mik7XG4gICAgICAgIGIgPSAoYiA+IE4gPyBNYXRoLnBvdygoYiArIDAuMDU1KSAvIDEuMDU1LCAyLjQpIDogYiAvIDEyLjkyKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgWDogciAqIE0uWFswXSArIGcgKiBNLlhbMV0gKyBiICogTS5YWzJdLFxuICAgICAgICAgICAgWTogciAqIE0uWVswXSArIGcgKiBNLllbMV0gKyBiICogTS5ZWzJdLFxuICAgICAgICAgICAgWjogciAqIE0uWlswXSArIGcgKiBNLlpbMV0gKyBiICogTS5aWzJdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIFhZWjJMYWIgKFhZWikge1xuICAgICAgICB2YXIgUiA9IFhZWlJlZmVyZW5jZSxcbiAgICAgICAgICAgIFggPSBYWVouWCAvIFIuWCxcbiAgICAgICAgICAgIFkgPSBYWVouWSAvIFIuWSxcbiAgICAgICAgICAgIFogPSBYWVouWiAvIFIuWixcbiAgICAgICAgICAgIE4gPSAxNiAvIDExNixcbiAgICAgICAgICAgIE0gPSAxIC8gMyxcbiAgICAgICAgICAgIEsgPSAwLjAwODg1NixcbiAgICAgICAgICAgIEwgPSA3Ljc4NzAzNztcblxuICAgICAgICBYID0gWCA+IEsgPyBNYXRoLnBvdyhYLCBNKSA6IChMICogWCkgKyBOO1xuICAgICAgICBZID0gWSA+IEsgPyBNYXRoLnBvdyhZLCBNKSA6IChMICogWSkgKyBOO1xuICAgICAgICBaID0gWiA+IEsgPyBNYXRoLnBvdyhaLCBNKSA6IChMICogWikgKyBOO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBMOiAoMTE2ICogWSkgLSAxNixcbiAgICAgICAgICAgIGE6IDUwMCAqIChYIC0gWSksXG4gICAgICAgICAgICBiOiAyMDAgKiAoWSAtIFopXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIExhYjJYWVogKExhYikge1xuICAgICAgICB2YXIgUiA9IFhZWlJlZmVyZW5jZSxcbiAgICAgICAgICAgIFkgPSAoTGFiLkwgKyAxNikgLyAxMTYsXG4gICAgICAgICAgICBYID0gTGFiLmEgLyA1MDAgKyBZLFxuICAgICAgICAgICAgWiA9IFkgLSBMYWIuYiAvIDIwMCxcbiAgICAgICAgICAgIFgzID0gTWF0aC5wb3coWCwgMyksXG4gICAgICAgICAgICBZMyA9IE1hdGgucG93KFksIDMpLFxuICAgICAgICAgICAgWjMgPSBNYXRoLnBvdyhaLCAzKSxcbiAgICAgICAgICAgIE4gPSAxNiAvIDExNixcbiAgICAgICAgICAgIEsgPSAwLjAwODg1NixcbiAgICAgICAgICAgIEwgPSA3Ljc4NzAzNztcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgWDogKFgzID4gSyA/IFgzIDogKFggLSBOKSAvIEwpICogUi5YLFxuICAgICAgICAgICAgWTogKFkzID4gSyA/IFkzIDogKFkgLSBOKSAvIEwpICogUi5ZLFxuICAgICAgICAgICAgWjogKFozID4gSyA/IFozIDogKFogLSBOKSAvIEwpICogUi5aXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgc3RhdGljIHJnYjJMYWIgKHJnYikge1xuICAgICAgICB2YXIgWFlaID0gQ29sb3JDb252ZXJ0ZXIucmdiMlhZWihyZ2IpO1xuXG4gICAgICAgIHJldHVybiBDb2xvckNvbnZlcnRlci5YWVoyTGFiKFhZWik7XG4gICAgfVxuXG4gICAgc3RhdGljIExhYjJyZ2IgKExhYikge1xuICAgICAgICB2YXIgWFlaID0gQ29sb3JDb252ZXJ0ZXIuTGFiMlhZWihMYWIpO1xuXG4gICAgICAgIHJldHVybiBDb2xvckNvbnZlcnRlci5YWVoycmdiKFhZWik7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGltaXRWYWx1ZSh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICAvLyByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7IC8vIGZhc3Rlcj8/XG4gICAgcmV0dXJuICh2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlIDwgbWluID8gbWluIDogdmFsdWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0THVtaW5hbmNlKHJnYiwgbm9ybWFsaXplZCkge1xuICAgIHZhciBkaXYgPSBub3JtYWxpemVkID8gMSA6IDI1NSxcbiAgICAgICAgUkdCID0gW3JnYi5yIC8gZGl2LCByZ2IuZyAvIGRpdiwgcmdiLmIgLyBkaXZdO1xuXG4gICAgZm9yICh2YXIgaSA9IFJHQi5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgUkdCW2ldID0gUkdCW2ldIDw9IDAuMDM5MjggPyBSR0JbaV0gLyAxMi45MiA6IE1hdGgucG93KCgoUkdCW2ldICsgMC4wNTUpIC8gMS4wNTUpLCAyLjQpO1xuICAgIH1cbiAgICByZXR1cm4gKChsdW1pbmFuY2UuciAqIFJHQlswXSkgKyAobHVtaW5hbmNlLmcgKiBSR0JbMV0pICsgKGx1bWluYW5jZS5iICogUkdCWzJdKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2xvckFzUkdCIChjb2xvcikge1xuICAgIC8vIENyZWF0ZSBhIHRlc3QgZWxlbWVudCB0byBhcHBseSBhIENTUyBjb2xvciBhbmQgcmV0cmlldmVcbiAgICAvLyBhIG5vcm1hbGl6ZWQgdmFsdWUgZnJvbS5cbiAgICBsZXQgdGVzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRlc3Quc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG5cbiAgICAvLyBDaHJvbWUgcmVxdWlyZXMgdGhlIGVsZW1lbnQgdG8gYmUgaW4gRE9NIGZvciBzdHlsZXMgdG8gYmUgY29tcHV0ZWQuXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0ZXN0KTtcblxuICAgIC8vIEdldCB0aGUgY29tcHV0ZWQgc3R5bGUgZnJvbSB0aGUgYnJvd3NlciwgaW4gdGhlIGZvcm1hdCBvZlxuICAgIC8vIHJnYih4LCB4LCB4KVxuICAgIGxldCBub3JtYWxpemVkID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGVzdCkuYmFja2dyb3VuZENvbG9yO1xuXG4gICAgLy8gSW4gY2VydGFpbiBjYXNlcyBnZXRDb21wdXRlZFN0eWxlKCkgbWF5IHJldHVyblxuICAgIC8vICd0cmFuc3BhcmVudCcgYXMgYSB2YWx1ZSwgd2hpY2ggaXMgdXNlbGVzcyg/KSBmb3IgdGhlIGN1cnJlbnRcbiAgICAvLyBjb2xvciBwaWNrZXIuIEFjY29yZGluZyB0byBzcGVjaWZpY2F0aW9ucywgdHJhbnNwYXJlbnRcbiAgICAvLyBpcyBhIGJsYWNrIHdpdGggMCBhbHBoYSAtIHJnYmEoMCwgMCwgMCwgMCkgLSBidXQgYmVjYXVzZVxuICAgIC8vIHRoZSBwaWNrZXIgZG9lcyBub3QgY3VycmVudGx5IGhhbmRsZSBhbHBoYSwgd2UgcmV0dXJuIHRoZVxuICAgIC8vIGJsYWNrIHZhbHVlLlxuICAgIGlmIChub3JtYWxpemVkID09PSAndHJhbnNwYXJlbnQnKSB7XG4gICAgICAgIG5vcm1hbGl6ZWQgPSAncmdiKDAsIDAsIDApJztcbiAgICB9XG5cbiAgICAvLyBHYXJiYWdlIGNvbGxlY3Rpb25cbiAgICB0ZXN0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGVzdCk7XG5cbiAgICByZXR1cm4gbm9ybWFsaXplZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZhbHVlUmFuZ2VzKHR5cGUpIHtcbiAgICBpZiAoIXR5cGUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlUmFuZ2VzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlUmFuZ2VzW3R5cGVdO1xuICAgIH1cbn1cbiIsIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxvYXQge1xuICAgIGNvbnN0cnVjdG9yICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0U3RyaW5nICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUudG9GaXhlZCgzKTtcbiAgICB9XG5cbiAgICB1bmlmb3JtVHlwZSAoKSB7XG4gICAgICAgIHJldHVybiAnZmxvYXQnO1xuICAgIH1cblxuICAgIHVuaWZvcm1WYWx1ZSAoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy52YWx1ZV07XG4gICAgfVxuXG4gICAgdW5pZm9ybU1ldGhvZCAoKSB7XG4gICAgICAgIHJldHVybiAnMWYnO1xuICAgIH1cbn1cbiIsImltcG9ydCBWZWN0b3IgZnJvbSAnLi9WZWN0b3InO1xuXG4vLyBUT0RPOlxuLy8gICAgICAtIGdlbmVyYWxpemUgdGhpcyBmb3IgbWF0MiwgbWF0MyBhbmQgbWF0NFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYXRyaXgge1xuICAgIGNvbnN0cnVjdG9yKG0sIHR5cGUpIHtcbiAgICAgICAgdGhpcy5kaW0gPSAzO1xuICAgICAgICB0aGlzLnZhbHVlID0gW1xuICAgICAgICAgICAgWzEsIDAsIDBdLFxuICAgICAgICAgICAgWzAsIDEsIDBdLFxuICAgICAgICAgICAgWzAsIDAsIDFdXTtcbiAgICAgICAgaWYgKG0pIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KG0sIHR5cGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0IChtLCB0eXBlKSB7XG4gICAgICAgIGlmIChtLnZhbHVlWzBdWzBdKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbS52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuZGltID0gbS5kaW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobVswXVswXSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByb3RhdGVYICh0aGV0YSkge1xuICAgICAgICBsZXQgYyA9IE1hdGguY29zKHRoZXRhKTtcbiAgICAgICAgbGV0IHMgPSBNYXRoLnNpbih0aGV0YSk7XG4gICAgICAgIGxldCBUID0gW1xuICAgICAgICAgICAgWzEsIDAsIDBdLFxuICAgICAgICAgICAgWzAsIGMsIC1zXSxcbiAgICAgICAgICAgIFswLCBzLCBjXV07XG5cbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuZ2V0VHJhbnNmb3JtKFQpO1xuICAgIH1cblxuICAgIHJvdGF0ZVkgKHRoZXRhKSB7XG4gICAgICAgIGxldCBjID0gTWF0aC5jb3ModGhldGEpO1xuICAgICAgICBsZXQgcyA9IE1hdGguc2luKHRoZXRhKTtcbiAgICAgICAgbGV0IFQgPSBbXG4gICAgICAgICAgICBbYywgMCwgc10sXG4gICAgICAgICAgICBbMCwgMSwgMF0sXG4gICAgICAgICAgICBbLXMsIDAsIGNdXTtcblxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5nZXRUcmFuc2Zvcm0oVCk7XG4gICAgfVxuXG4gICAgZ2V0TXVsdCAodikge1xuICAgICAgICBpZiAodlswXVswXSB8fCAodi52YWx1ZSAmJiB2LnZhbHVlWzBdWzBdKSkge1xuICAgICAgICAgICAgLy8gVE9ETzogd2hhdCBJZiB2IGlzIGEgbWF0cml4XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVE9ETzogd2hhdCBJZiB2IGlzIGEgbWF0cml4Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiB2IGlzIGEgdmVjdG9yXG4gICAgICAgICAgICBsZXQgQSA9IG5ldyBWZWN0b3Iodik7XG4gICAgICAgICAgICBsZXQgQiA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBBLmRpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgQi5wdXNoKEEudmFsdWVbMF0gKiB0aGlzLnZhbHVlW2ldWzBdICsgQS52YWx1ZVsxXSAqIHRoaXMudmFsdWVbaV1bMV0gKyBBLnZhbHVlWzJdICogdGhpcy52YWx1ZVtpXVsyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFZlY3RvcihCKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFRyYW5zZm9ybSAobSkge1xuICAgICAgICBsZXQgbmV3TWF0cml4ID0gW107XG4gICAgICAgIGZvciAobGV0IHJvdyBpbiBtKSB7XG4gICAgICAgICAgICBsZXQgdCA9IG1bcm93XTtcbiAgICAgICAgICAgIGxldCBuZXdSb3cgPSBbXTtcbiAgICAgICAgICAgIG5ld1Jvdy5wdXNoKHRbMF0gKiB0aGlzLnZhbHVlWzBdWzBdICsgdFsxXSAqIHRoaXMudmFsdWVbMV1bMF0gKyB0WzJdICogdGhpcy52YWx1ZVsyXVswXSk7XG4gICAgICAgICAgICBuZXdSb3cucHVzaCh0WzBdICogdGhpcy52YWx1ZVswXVsxXSArIHRbMV0gKiB0aGlzLnZhbHVlWzFdWzFdICsgdFsyXSAqIHRoaXMudmFsdWVbMl1bMV0pO1xuICAgICAgICAgICAgbmV3Um93LnB1c2godFswXSAqIHRoaXMudmFsdWVbMF1bMl0gKyB0WzFdICogdGhpcy52YWx1ZVsxXVsyXSArIHRbMl0gKiB0aGlzLnZhbHVlWzJdWzJdKTtcbiAgICAgICAgICAgIG5ld01hdHJpeC5wdXNoKG5ld1Jvdyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ld01hdHJpeDtcbiAgICB9XG5cbiAgICBnZXRJbnYoKSB7XG4gICAgICAgIGxldCBNID0gbmV3IE1hdHJpeCgpO1xuICAgICAgICBsZXQgZGV0ZXJtaW5hbnQgPSB0aGlzLnZhbHVlWzBdWzBdICogKHRoaXMudmFsdWVbMV1bMV0gKiB0aGlzLnZhbHVlWzJdWzJdIC0gdGhpcy52YWx1ZVsyXVsxXSAqIHRoaXMudmFsdWVbMV1bMl0pIC1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlWzBdWzFdICogKHRoaXMudmFsdWVbMV1bMF0gKiB0aGlzLnZhbHVlWzJdWzJdIC0gdGhpcy52YWx1ZVsxXVsyXSAqIHRoaXMudmFsdWVbMl1bMF0pICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlWzBdWzJdICogKHRoaXMudmFsdWVbMV1bMF0gKiB0aGlzLnZhbHVlWzJdWzFdIC0gdGhpcy52YWx1ZVsxXVsxXSAqIHRoaXMudmFsdWVbMl1bMF0pO1xuICAgICAgICBsZXQgaW52ZGV0ID0gMSAvIGRldGVybWluYW50O1xuICAgICAgICBNLnZhbHVlWzBdWzBdID0gKHRoaXMudmFsdWVbMV1bMV0gKiB0aGlzLnZhbHVlWzJdWzJdIC0gdGhpcy52YWx1ZVsyXVsxXSAqIHRoaXMudmFsdWVbMV1bMl0pICogaW52ZGV0O1xuICAgICAgICBNLnZhbHVlWzBdWzFdID0gLSh0aGlzLnZhbHVlWzBdWzFdICogdGhpcy52YWx1ZVsyXVsyXSAtIHRoaXMudmFsdWVbMF1bMl0gKiB0aGlzLnZhbHVlWzJdWzFdKSAqIGludmRldDtcbiAgICAgICAgTS52YWx1ZVswXVsyXSA9ICh0aGlzLnZhbHVlWzBdWzFdICogdGhpcy52YWx1ZVsxXVsyXSAtIHRoaXMudmFsdWVbMF1bMl0gKiB0aGlzLnZhbHVlWzFdWzFdKSAqIGludmRldDtcbiAgICAgICAgTS52YWx1ZVsxXVswXSA9IC0odGhpcy52YWx1ZVsxXVswXSAqIHRoaXMudmFsdWVbMl1bMl0gLSB0aGlzLnZhbHVlWzFdWzJdICogdGhpcy52YWx1ZVsyXVswXSkgKiBpbnZkZXQ7XG4gICAgICAgIE0udmFsdWVbMV1bMV0gPSAodGhpcy52YWx1ZVswXVswXSAqIHRoaXMudmFsdWVbMl1bMl0gLSB0aGlzLnZhbHVlWzBdWzJdICogdGhpcy52YWx1ZVsyXVswXSkgKiBpbnZkZXQ7XG4gICAgICAgIE0udmFsdWVbMV1bMl0gPSAtKHRoaXMudmFsdWVbMF1bMF0gKiB0aGlzLnZhbHVlWzFdWzJdIC0gdGhpcy52YWx1ZVsxXVswXSAqIHRoaXMudmFsdWVbMF1bMl0pICogaW52ZGV0O1xuICAgICAgICBNLnZhbHVlWzJdWzBdID0gKHRoaXMudmFsdWVbMV1bMF0gKiB0aGlzLnZhbHVlWzJdWzFdIC0gdGhpcy52YWx1ZVsyXVswXSAqIHRoaXMudmFsdWVbMV1bMV0pICogaW52ZGV0O1xuICAgICAgICBNLnZhbHVlWzJdWzFdID0gLSh0aGlzLnZhbHVlWzBdWzBdICogdGhpcy52YWx1ZVsyXVsxXSAtIHRoaXMudmFsdWVbMl1bMF0gKiB0aGlzLnZhbHVlWzBdWzFdKSAqIGludmRldDtcbiAgICAgICAgTS52YWx1ZVsyXVsyXSA9ICh0aGlzLnZhbHVlWzBdWzBdICogdGhpcy52YWx1ZVsxXVsxXSAtIHRoaXMudmFsdWVbMV1bMF0gKiB0aGlzLnZhbHVlWzBdWzFdKSAqIGludmRldDtcbiAgICAgICAgcmV0dXJuIE07XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmVjdG9yIHtcbiAgICBjb25zdHJ1Y3RvciAodmVjLCB0eXBlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBbMCwwXTtcbiAgICAgICAgdGhpcy5kaW0gPSAyO1xuICAgICAgICB0aGlzLnNldCh2ZWMsIHR5cGUpO1xuICAgIH1cblxuICAgIHNldCAodmVjLCB0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmVjID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdHlwZSA9IHR5cGUgfHwgJ3ZlYzInO1xuICAgICAgICAgICAgdGhpcy5zZXQoW3ZlY10sIHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2ZWMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBsZXQgcGFydHMgPSB2ZWMucmVwbGFjZSgvKD86I3xcXCl8XFxdfCUpL2csICcnKS5zcGxpdCgnKCcpO1xuICAgICAgICAgICAgbGV0IHN0clZhbHVlcyA9IChwYXJ0c1sxXSB8fCBwYXJ0c1swXS5yZXBsYWNlKC8oXFxbKS9nLCAnJykpLnNwbGl0KC8sXFxzKi8pO1xuICAgICAgICAgICAgdHlwZSA9IHR5cGUgfHwgKHBhcnRzWzFdID8gcGFydHNbMF0uc3Vic3RyKDAsIDQpIDogJ3ZlYycgKyBzdHJWYWx1ZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIGxldCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gc3RyVmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gocGFyc2VGbG9hdChzdHJWYWx1ZXNbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0KHZhbHVlcywgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmVjKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2ZWMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmRpbSA9IHR5cGUgPyBOdW1iZXIodHlwZS5zdWJzdHIoMywgNCkpIDogdmVjLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgZmlsbGVyID0gdmVjLmxlbmd0aCA9PT0gMSA/IHZlY1swXSA6IDA7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUucHVzaCh2ZWNbaV0gfHwgZmlsbGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2ZWMuZGltKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZlYy52YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRpbSA9IHZlYy5kaW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXQgeCAodikge1xuICAgICAgICB0aGlzLnZhbHVlWzBdID0gdjtcbiAgICB9XG5cbiAgICBzZXQgeSAodikge1xuICAgICAgICB0aGlzLnZhbHVlWzFdID0gdjtcbiAgICB9XG5cbiAgICBzZXQgeiAodikge1xuICAgICAgICBpZiAodGhpcy5kaW0gPCAzKSB7XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5kaW0gPCAzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZS5wdXNoKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kaW0gPSAzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsdWVbMl0gPSB2O1xuICAgIH1cblxuICAgIHNldCB3ICh2KSB7XG4gICAgICAgIGlmICh0aGlzLmRpbSA8IDQpIHtcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmRpbSA8IDQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRpbSA9IDQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52YWx1ZVszXSA9IHY7XG4gICAgfVxuXG4gICAgZ2V0IHggKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZVswXSB8fCAwLjA7XG4gICAgfVxuXG4gICAgZ2V0IHkgKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZVsxXSB8fCAwLjA7XG4gICAgfVxuXG4gICAgZ2V0IHogKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZVsyXSB8fCAwLjAgO1xuICAgIH1cblxuICAgIGdldCB3ICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVbM10gfHwgMC4wO1xuICAgIH1cblxuICAgIGdldFN0cmluZyh0eXBlKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlIHx8ICd2ZWMnICsgdGhpcy5kaW07XG5cbiAgICAgICAgbGV0IGxlbiA9IHRoaXMuZGltO1xuICAgICAgICBsZXQgc3RyID0gJyc7XG4gICAgICAgIGxldCBoZWFkID0gdHlwZSArICcoJztcbiAgICAgICAgbGV0IGVuZCA9ICcpJztcblxuICAgICAgICBpZiAodHlwZSA9PT0gJ2FycmF5Jykge1xuICAgICAgICAgICAgaGVhZCA9ICdbJztcbiAgICAgICAgICAgIGVuZCA9ICddJztcbiAgICAgICAgICAgIGxlbiA9IHRoaXMuZGltO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGVuID0gTnVtYmVyKHR5cGUuc3Vic3RyKDMsIDQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0ciA9IGhlYWQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHN0ciArPSB0aGlzLnZhbHVlW2ldLnRvRml4ZWQoMyk7XG4gICAgICAgICAgICBpZiAoaSAhPT0gbGVuIC0gMSkge1xuICAgICAgICAgICAgICAgIHN0ciArPSAnLCc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0ciArPSBlbmQ7XG4gICAgfVxuXG4gICAgdW5pZm9ybVR5cGUgKCkge1xuICAgICAgICByZXR1cm4gJ3ZlYycgKyB0aGlzLmRpbTtcbiAgICB9XG5cbiAgICB1bmlmb3JtVmFsdWUgKCkge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kaW07IGkrKykge1xuICAgICAgICAgICAgYXJyLnB1c2godGhpcy52YWx1ZVtpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9XG5cbiAgICB1bmlmb3JtTWV0aG9kICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGltICsgJ2YnO1xuICAgIH1cblxuICAgIC8vIFZFQ1RPUiBPUEVSQVRJT05TXG5cbiAgICBhZGQgKHYpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IHRoaXMudmFsdWVbaV0gKyB2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IEEgPSBuZXcgVmVjdG9yKHYpO1xuICAgICAgICAgICAgbGV0IGxpbSA9IE1hdGgubWluKHRoaXMuZGltLCBBLmRpbSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IHRoaXMudmFsdWVbaV0gKyBBLnZhbHVlW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3ViICh2KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kaW07IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVbaV0gPSB0aGlzLnZhbHVlW2ldIC0gdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCBBID0gbmV3IFZlY3Rvcih2KTtcbiAgICAgICAgICAgIGxldCBsaW0gPSBNYXRoLm1pbih0aGlzLmRpbSwgQS5kaW0pO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW07IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVbaV0gPSB0aGlzLnZhbHVlW2ldIC0gQS52YWx1ZVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG11bHQgKHYpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgLy8gTXVsaXRwbHkgYnkgc2NhbGFyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGltOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlW2ldID0gdGhpcy52YWx1ZVtpXSAqIHY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBNdWx0aXBseSB0d28gdmVjdG9yc1xuICAgICAgICAgICAgbGV0IEEgPSBuZXcgVmVjdG9yKHYpO1xuICAgICAgICAgICAgbGV0IGxpbSA9IE1hdGgubWluKHRoaXMuZGltLCBBLmRpbSk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IHRoaXMudmFsdWVbaV0gKiBBLnZhbHVlW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGl2ICh2KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIC8vIE11bGl0cGx5IGJ5IHNjYWxhclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRpbTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IHRoaXMudmFsdWVbaV0gLyB2O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gTXVsdGlwbHkgdHdvIHZlY3RvcnNcbiAgICAgICAgICAgIGxldCBBID0gbmV3IFZlY3Rvcih2KTtcbiAgICAgICAgICAgIGxldCBsaW0gPSBNYXRoLm1pbih0aGlzLmRpbSwgQS5kaW0pO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW07IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVbaV0gPSB0aGlzLnZhbHVlW2ldIC8gQS52YWx1ZVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5vcm1hbGl6ZSAoKSB7XG4gICAgICAgIGxldCBsID0gdGhpcy5nZXRMZW5ndGgoKTtcbiAgICAgICAgdGhpcy5kaXYobCk7XG4gICAgfVxuXG4gICAgZ2V0QWRkICh2KSB7XG4gICAgICAgIHZhciBBID0gbmV3IFZlY3Rvcih0aGlzKTtcbiAgICAgICAgQS5hZGQodik7XG4gICAgICAgIHJldHVybiBBO1xuICAgIH1cblxuICAgIGdldFN1YiAodikge1xuICAgICAgICB2YXIgQSA9IG5ldyBWZWN0b3IodGhpcyk7XG4gICAgICAgIEEuc3ViKHYpO1xuICAgICAgICByZXR1cm4gQTtcbiAgICB9XG5cbiAgICBnZXRNdWx0ICh2KSB7XG4gICAgICAgIHZhciBBID0gbmV3IFZlY3Rvcih0aGlzKTtcbiAgICAgICAgQS5tdWx0KHYpO1xuICAgICAgICByZXR1cm4gQTtcbiAgICB9XG5cbiAgICBnZXREaXYgKHYpIHtcbiAgICAgICAgdmFyIEEgPSBuZXcgVmVjdG9yKHRoaXMpO1xuICAgICAgICBBLmRpdih2KTtcbiAgICAgICAgcmV0dXJuIEE7XG4gICAgfVxuXG4gICAgZ2V0TGVuZ3RoU3EgKCkge1xuICAgICAgICBpZiAodGhpcy5kaW0gPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy52YWx1ZVswXSAqIHRoaXMudmFsdWVbMF0gKyB0aGlzLnZhbHVlWzFdICogdGhpcy52YWx1ZVsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMudmFsdWVbMF0gKiB0aGlzLnZhbHVlWzBdICsgdGhpcy52YWx1ZVsxXSAqIHRoaXMudmFsdWVbMV0gKyB0aGlzLnZhbHVlWzJdICogdGhpcy52YWx1ZVsyXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRMZW5ndGggKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMuZ2V0TGVuZ3RoU3EoKSk7XG4gICAgfVxufVxuIiwiLyohIEBzb3VyY2UgaHR0cDovL3B1cmwuZWxpZ3JleS5jb20vZ2l0aHViL0ZpbGVTYXZlci5qcy9ibG9iL21hc3Rlci9GaWxlU2F2ZXIuanMgKi9cbnZhciBzYXZlQXM9c2F2ZUFzfHxmdW5jdGlvbih2aWV3KXtcInVzZSBzdHJpY3RcIjtpZih0eXBlb2YgbmF2aWdhdG9yIT09XCJ1bmRlZmluZWRcIiYmL01TSUUgWzEtOV1cXC4vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe3JldHVybn12YXIgZG9jPXZpZXcuZG9jdW1lbnQsZ2V0X1VSTD1mdW5jdGlvbigpe3JldHVybiB2aWV3LlVSTHx8dmlldy53ZWJraXRVUkx8fHZpZXd9LHNhdmVfbGluaz1kb2MuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLFwiYVwiKSxjYW5fdXNlX3NhdmVfbGluaz1cImRvd25sb2FkXCJpbiBzYXZlX2xpbmssY2xpY2s9ZnVuY3Rpb24obm9kZSl7dmFyIGV2ZW50PW5ldyBNb3VzZUV2ZW50KFwiY2xpY2tcIik7bm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KX0saXNfc2FmYXJpPS9WZXJzaW9uXFwvW1xcZFxcLl0rLipTYWZhcmkvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksd2Via2l0X3JlcV9mcz12aWV3LndlYmtpdFJlcXVlc3RGaWxlU3lzdGVtLHJlcV9mcz12aWV3LnJlcXVlc3RGaWxlU3lzdGVtfHx3ZWJraXRfcmVxX2ZzfHx2aWV3Lm1velJlcXVlc3RGaWxlU3lzdGVtLHRocm93X291dHNpZGU9ZnVuY3Rpb24oZXgpeyh2aWV3LnNldEltbWVkaWF0ZXx8dmlldy5zZXRUaW1lb3V0KShmdW5jdGlvbigpe3Rocm93IGV4fSwwKX0sZm9yY2Vfc2F2ZWFibGVfdHlwZT1cImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiLGZzX21pbl9zaXplPTAsYXJiaXRyYXJ5X3Jldm9rZV90aW1lb3V0PTUwMCxyZXZva2U9ZnVuY3Rpb24oZmlsZSl7dmFyIHJldm9rZXI9ZnVuY3Rpb24oKXtpZih0eXBlb2YgZmlsZT09PVwic3RyaW5nXCIpe2dldF9VUkwoKS5yZXZva2VPYmplY3RVUkwoZmlsZSl9ZWxzZXtmaWxlLnJlbW92ZSgpfX07aWYodmlldy5jaHJvbWUpe3Jldm9rZXIoKX1lbHNle3NldFRpbWVvdXQocmV2b2tlcixhcmJpdHJhcnlfcmV2b2tlX3RpbWVvdXQpfX0sZGlzcGF0Y2g9ZnVuY3Rpb24oZmlsZXNhdmVyLGV2ZW50X3R5cGVzLGV2ZW50KXtldmVudF90eXBlcz1bXS5jb25jYXQoZXZlbnRfdHlwZXMpO3ZhciBpPWV2ZW50X3R5cGVzLmxlbmd0aDt3aGlsZShpLS0pe3ZhciBsaXN0ZW5lcj1maWxlc2F2ZXJbXCJvblwiK2V2ZW50X3R5cGVzW2ldXTtpZih0eXBlb2YgbGlzdGVuZXI9PT1cImZ1bmN0aW9uXCIpe3RyeXtsaXN0ZW5lci5jYWxsKGZpbGVzYXZlcixldmVudHx8ZmlsZXNhdmVyKX1jYXRjaChleCl7dGhyb3dfb3V0c2lkZShleCl9fX19LGF1dG9fYm9tPWZ1bmN0aW9uKGJsb2Ipe2lmKC9eXFxzKig/OnRleHRcXC9cXFMqfGFwcGxpY2F0aW9uXFwveG1sfFxcUypcXC9cXFMqXFwreG1sKVxccyo7LipjaGFyc2V0XFxzKj1cXHMqdXRmLTgvaS50ZXN0KGJsb2IudHlwZSkpe3JldHVybiBuZXcgQmxvYihbXCJcXHVmZWZmXCIsYmxvYl0se3R5cGU6YmxvYi50eXBlfSl9cmV0dXJuIGJsb2J9LEZpbGVTYXZlcj1mdW5jdGlvbihibG9iLG5hbWUsbm9fYXV0b19ib20pe2lmKCFub19hdXRvX2JvbSl7YmxvYj1hdXRvX2JvbShibG9iKX12YXIgZmlsZXNhdmVyPXRoaXMsdHlwZT1ibG9iLnR5cGUsYmxvYl9jaGFuZ2VkPWZhbHNlLG9iamVjdF91cmwsdGFyZ2V0X3ZpZXcsZGlzcGF0Y2hfYWxsPWZ1bmN0aW9uKCl7ZGlzcGF0Y2goZmlsZXNhdmVyLFwid3JpdGVzdGFydCBwcm9ncmVzcyB3cml0ZSB3cml0ZWVuZFwiLnNwbGl0KFwiIFwiKSl9LGZzX2Vycm9yPWZ1bmN0aW9uKCl7aWYodGFyZ2V0X3ZpZXcmJmlzX3NhZmFyaSYmdHlwZW9mIEZpbGVSZWFkZXIhPT1cInVuZGVmaW5lZFwiKXt2YXIgcmVhZGVyPW5ldyBGaWxlUmVhZGVyO3JlYWRlci5vbmxvYWRlbmQ9ZnVuY3Rpb24oKXt2YXIgYmFzZTY0RGF0YT1yZWFkZXIucmVzdWx0O3RhcmdldF92aWV3LmxvY2F0aW9uLmhyZWY9XCJkYXRhOmF0dGFjaG1lbnQvZmlsZVwiK2Jhc2U2NERhdGEuc2xpY2UoYmFzZTY0RGF0YS5zZWFyY2goL1ssO10vKSk7ZmlsZXNhdmVyLnJlYWR5U3RhdGU9ZmlsZXNhdmVyLkRPTkU7ZGlzcGF0Y2hfYWxsKCl9O3JlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpO2ZpbGVzYXZlci5yZWFkeVN0YXRlPWZpbGVzYXZlci5JTklUO3JldHVybn1pZihibG9iX2NoYW5nZWR8fCFvYmplY3RfdXJsKXtvYmplY3RfdXJsPWdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYil9aWYodGFyZ2V0X3ZpZXcpe3RhcmdldF92aWV3LmxvY2F0aW9uLmhyZWY9b2JqZWN0X3VybH1lbHNle3ZhciBuZXdfdGFiPXZpZXcub3BlbihvYmplY3RfdXJsLFwiX2JsYW5rXCIpO2lmKG5ld190YWI9PXVuZGVmaW5lZCYmaXNfc2FmYXJpKXt2aWV3LmxvY2F0aW9uLmhyZWY9b2JqZWN0X3VybH19ZmlsZXNhdmVyLnJlYWR5U3RhdGU9ZmlsZXNhdmVyLkRPTkU7ZGlzcGF0Y2hfYWxsKCk7cmV2b2tlKG9iamVjdF91cmwpfSxhYm9ydGFibGU9ZnVuY3Rpb24oZnVuYyl7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoZmlsZXNhdmVyLnJlYWR5U3RhdGUhPT1maWxlc2F2ZXIuRE9ORSl7cmV0dXJuIGZ1bmMuYXBwbHkodGhpcyxhcmd1bWVudHMpfX19LGNyZWF0ZV9pZl9ub3RfZm91bmQ9e2NyZWF0ZTp0cnVlLGV4Y2x1c2l2ZTpmYWxzZX0sc2xpY2U7ZmlsZXNhdmVyLnJlYWR5U3RhdGU9ZmlsZXNhdmVyLklOSVQ7aWYoIW5hbWUpe25hbWU9XCJkb3dubG9hZFwifWlmKGNhbl91c2Vfc2F2ZV9saW5rKXtvYmplY3RfdXJsPWdldF9VUkwoKS5jcmVhdGVPYmplY3RVUkwoYmxvYik7c2V0VGltZW91dChmdW5jdGlvbigpe3NhdmVfbGluay5ocmVmPW9iamVjdF91cmw7c2F2ZV9saW5rLmRvd25sb2FkPW5hbWU7Y2xpY2soc2F2ZV9saW5rKTtkaXNwYXRjaF9hbGwoKTtyZXZva2Uob2JqZWN0X3VybCk7ZmlsZXNhdmVyLnJlYWR5U3RhdGU9ZmlsZXNhdmVyLkRPTkV9KTtyZXR1cm59aWYodmlldy5jaHJvbWUmJnR5cGUmJnR5cGUhPT1mb3JjZV9zYXZlYWJsZV90eXBlKXtzbGljZT1ibG9iLnNsaWNlfHxibG9iLndlYmtpdFNsaWNlO2Jsb2I9c2xpY2UuY2FsbChibG9iLDAsYmxvYi5zaXplLGZvcmNlX3NhdmVhYmxlX3R5cGUpO2Jsb2JfY2hhbmdlZD10cnVlfWlmKHdlYmtpdF9yZXFfZnMmJm5hbWUhPT1cImRvd25sb2FkXCIpe25hbWUrPVwiLmRvd25sb2FkXCJ9aWYodHlwZT09PWZvcmNlX3NhdmVhYmxlX3R5cGV8fHdlYmtpdF9yZXFfZnMpe3RhcmdldF92aWV3PXZpZXd9aWYoIXJlcV9mcyl7ZnNfZXJyb3IoKTtyZXR1cm59ZnNfbWluX3NpemUrPWJsb2Iuc2l6ZTtyZXFfZnModmlldy5URU1QT1JBUlksZnNfbWluX3NpemUsYWJvcnRhYmxlKGZ1bmN0aW9uKGZzKXtmcy5yb290LmdldERpcmVjdG9yeShcInNhdmVkXCIsY3JlYXRlX2lmX25vdF9mb3VuZCxhYm9ydGFibGUoZnVuY3Rpb24oZGlyKXt2YXIgc2F2ZT1mdW5jdGlvbigpe2Rpci5nZXRGaWxlKG5hbWUsY3JlYXRlX2lmX25vdF9mb3VuZCxhYm9ydGFibGUoZnVuY3Rpb24oZmlsZSl7ZmlsZS5jcmVhdGVXcml0ZXIoYWJvcnRhYmxlKGZ1bmN0aW9uKHdyaXRlcil7d3JpdGVyLm9ud3JpdGVlbmQ9ZnVuY3Rpb24oZXZlbnQpe3RhcmdldF92aWV3LmxvY2F0aW9uLmhyZWY9ZmlsZS50b1VSTCgpO2ZpbGVzYXZlci5yZWFkeVN0YXRlPWZpbGVzYXZlci5ET05FO2Rpc3BhdGNoKGZpbGVzYXZlcixcIndyaXRlZW5kXCIsZXZlbnQpO3Jldm9rZShmaWxlKX07d3JpdGVyLm9uZXJyb3I9ZnVuY3Rpb24oKXt2YXIgZXJyb3I9d3JpdGVyLmVycm9yO2lmKGVycm9yLmNvZGUhPT1lcnJvci5BQk9SVF9FUlIpe2ZzX2Vycm9yKCl9fTtcIndyaXRlc3RhcnQgcHJvZ3Jlc3Mgd3JpdGUgYWJvcnRcIi5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbihldmVudCl7d3JpdGVyW1wib25cIitldmVudF09ZmlsZXNhdmVyW1wib25cIitldmVudF19KTt3cml0ZXIud3JpdGUoYmxvYik7ZmlsZXNhdmVyLmFib3J0PWZ1bmN0aW9uKCl7d3JpdGVyLmFib3J0KCk7ZmlsZXNhdmVyLnJlYWR5U3RhdGU9ZmlsZXNhdmVyLkRPTkV9O2ZpbGVzYXZlci5yZWFkeVN0YXRlPWZpbGVzYXZlci5XUklUSU5HfSksZnNfZXJyb3IpfSksZnNfZXJyb3IpfTtkaXIuZ2V0RmlsZShuYW1lLHtjcmVhdGU6ZmFsc2V9LGFib3J0YWJsZShmdW5jdGlvbihmaWxlKXtmaWxlLnJlbW92ZSgpO3NhdmUoKX0pLGFib3J0YWJsZShmdW5jdGlvbihleCl7aWYoZXguY29kZT09PWV4Lk5PVF9GT1VORF9FUlIpe3NhdmUoKX1lbHNle2ZzX2Vycm9yKCl9fSkpfSksZnNfZXJyb3IpfSksZnNfZXJyb3IpfSxGU19wcm90bz1GaWxlU2F2ZXIucHJvdG90eXBlLHNhdmVBcz1mdW5jdGlvbihibG9iLG5hbWUsbm9fYXV0b19ib20pe3JldHVybiBuZXcgRmlsZVNhdmVyKGJsb2IsbmFtZSxub19hdXRvX2JvbSl9O2lmKHR5cGVvZiBuYXZpZ2F0b3IhPT1cInVuZGVmaW5lZFwiJiZuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYil7cmV0dXJuIGZ1bmN0aW9uKGJsb2IsbmFtZSxub19hdXRvX2JvbSl7aWYoIW5vX2F1dG9fYm9tKXtibG9iPWF1dG9fYm9tKGJsb2IpfXJldHVybiBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYihibG9iLG5hbWV8fFwiZG93bmxvYWRcIil9fUZTX3Byb3RvLmFib3J0PWZ1bmN0aW9uKCl7dmFyIGZpbGVzYXZlcj10aGlzO2ZpbGVzYXZlci5yZWFkeVN0YXRlPWZpbGVzYXZlci5ET05FO2Rpc3BhdGNoKGZpbGVzYXZlcixcImFib3J0XCIpfTtGU19wcm90by5yZWFkeVN0YXRlPUZTX3Byb3RvLklOSVQ9MDtGU19wcm90by5XUklUSU5HPTE7RlNfcHJvdG8uRE9ORT0yO0ZTX3Byb3RvLmVycm9yPUZTX3Byb3RvLm9ud3JpdGVzdGFydD1GU19wcm90by5vbnByb2dyZXNzPUZTX3Byb3RvLm9ud3JpdGU9RlNfcHJvdG8ub25hYm9ydD1GU19wcm90by5vbmVycm9yPUZTX3Byb3RvLm9ud3JpdGVlbmQ9bnVsbDtyZXR1cm4gc2F2ZUFzfSh0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCImJnNlbGZ8fHR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiJiZ3aW5kb3d8fHRoaXMuY29udGVudCk7aWYodHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCImJm1vZHVsZS5leHBvcnRzKXttb2R1bGUuZXhwb3J0cy5zYXZlQXM9c2F2ZUFzfWVsc2UgaWYodHlwZW9mIGRlZmluZSE9PVwidW5kZWZpbmVkXCImJmRlZmluZSE9PW51bGwmJmRlZmluZS5hbWQhPW51bGwpe2RlZmluZShbXSxmdW5jdGlvbigpe3JldHVybiBzYXZlQXN9KX1cbiJdfQ==\n"]}